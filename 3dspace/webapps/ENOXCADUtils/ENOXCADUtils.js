define("DS/ENOXCADUtils/XCADNotification",["DS/Notifications/NotificationsManagerUXMessages","DS/Notifications/NotificationsManagerViewOnScreen"],function(e,t){"use strict";return{_notif_manager:null,init:function(n){null===this._notif_manager&&(this._notif_manager=e,t.setNotificationManager(this._notif_manager),t.setStackingPolicy(5))},sucessMsg:function(e){this._notif_manager||this.init(),this._notif_manager.addNotif({level:"success",message:e,sticky:!1})},infoMsg:function(e){this._notif_manager||this.init(),this._notif_manager.addNotif({level:"info",message:e,sticky:!1})},warningMsg:function(e){this._notif_manager||this.init(),this._notif_manager.addNotif({level:"warning",message:e,sticky:!1})},errorMsg:function(e){this._notif_manager||this.init(),this._notif_manager.addNotif({level:"error",message:e,sticky:!1}),setTimeout(function(){t.removeLastNotificationDisplayed()},5e3)},clearNotifications:function(){t.removeNotifications("","")}}}),define("DS/ENOXCADUtils/views/CADSearch",["UWA/Core","UWA/Controls/Abstract","DS/CoreEvents/ModelEvents","DS/Controls/Button","DS/Controls/ButtonGroup","DS/UIKIT/Tooltip","DS/Core/PointerEvents","DS/Utilities/Dom","i18n!DS/ENOXCADUtils/assets/nls/XCADModelView.json","css!DS/ENOXCADUtils/assets/css/SearchView"],function(e,t,n,i,o,s,l,a,r,c){"use strict";var d=t.extend({renderTo:null,visible:!1,init:function(e){this.renderTo=e.renderTo?e.renderTo:document.body,this.callbacks=e.callbacks?e.callbacks:{},this._parent(e),this._buildSkeleton()},show:function(){!1===this.visible&&(this.elements.container.inject(this.renderTo),this.visible=!0)},hide:function(e=!1){!0===this.visible&&(this.renderTo.removeChild(this.elements.container),this.visible=!1)},cadSearchSync:function(e){e&&e.operation&&("next"===e.operation&&this.callbacks.onNext?this.callbacks.onNext():"previous"===e.operation&&this.callbacks.onPrevious?this.callbacks.onPrevious():"selectAll"===e.operation&&this.callbacks.onSelectAll?this.callbacks.onSelectAll():"close"===e.operation&&this.callbacks.onClose&&this.callbacks.onClose())},setLabel:function(e){this.elements.textInfo&&(this.elements.textInfo.innerHTML=e)},_buildSkeleton:function(){this.elements.container=UWA.createElement("div",{class:"CADSearchContainer"}),this.elements.topBarContainer=UWA.createElement("span",{class:"CADSelectionNavigatiorTopBar"}).inject(this.elements.container),this.elements.textInfo=UWA.createElement("div",{class:"CADSearchLabel wux-afr-label"}).inject(this.elements.topBarContainer),this.elements.navActions=UWA.createElement("span",{class:"CADSelectionNavigateActions"}).inject(this.elements.topBarContainer),this.elements.navBtnGrp=new o({}).inject(this.elements.navActions),this.elements.previousButton=new i({title:r.search_previous,type:"standard",icon:{iconName:"chevron-up",fontIconFamily:1}}),this.elements.previousButton.getContent().addClassName("CADSearch3DPreviousButton CADSearch-controls-button"),this.elements.previousButtonTooltip=new s({target:this.elements.previousButton.elements.button,position:"bottom"}),this.elements.previousButtonTooltip.setBody(r.search_previous),this.elements.nextButton=new i({title:r.search_next,type:"standard",icon:{iconName:"chevron-down",fontIconFamily:1}}),this.elements.nextButton.getContent().addClassName("CADSearch3DNextButton CADSearch-controls-button"),this.elements.nextButtonTooltip=new s({target:this.elements.nextButton.elements.button,position:"bottom"}),this.elements.nextButtonTooltip.setBody(r.search_next),this.elements.navBtnGrp.addChild(this.elements.previousButton),this.elements.navBtnGrp.addChild(this.elements.nextButton),this.elements.selectButton=new i({title:r.search_all,type:"standard",icon:{iconName:"select-on",fontIconFamily:1}}).inject(this.elements.topBarContainer),this.elements.selectButton.getContent().addClassName("CADSearch3DSelectButton CADSearch-controls-button"),this.elements.selectButtonTooltip=new s({target:this.elements.selectButton.elements.button,position:"bottom"}),this.elements.selectButtonTooltip.setBody(r.search_all),this.elements.closeButton=UWA.createElement("span",{class:"fonticon fonticon-wrong CADSearchCloseButton","data-toggle":"tooltip","data-placement":"top",title:r.search_close}).inject(this.elements.topBarContainer),this.elements.closeButton.addClassName("CloseButtonTouch"),this.registerButtonEvents()},registerButtonEvents:function(){var e=this;a.addEventOnElement(this,this.elements.previousButton,l.POINTERHIT,function(t){e.cadSearchSync({operation:"previous"})}),a.addEventOnElement(this,this.elements.nextButton,l.POINTERHIT,function(t){e.cadSearchSync({operation:"next"})}),a.addEventOnElement(this,this.elements.selectButton,l.POINTERHIT,function(t){e.cadSearchSync({operation:"selectAll"})}),a.addEventOnElement(this,this.elements.closeButton,l.POINTERHIT,function(t){e.cadSearchSync({operation:"close"})})}});return UWA.namespace("DS/ENOXCADUtils/views/CADSearch",d)}),define("DS/ENOXCADUtils/models/XCADModalView",["DS/ENOFloatingPanel/ENOFloatingPanel","UWA/Core","i18n!DS/ENOXCADUtils/assets/nls/XCADModelView","css!DS/ENOXCADUtils/assets/css/XCADModalView"],function(e,t,n){"use strict";return{_dlg:void 0,_dlgDiv:void 0,footerStyle:{none:1,okCancel:2},_closeDlg:function(){this._dlg&&(this._dlg.destroy(),this._dlg=void 0,this._dlgDiv=void 0,this.options&&"function"==typeof this.options.onCloseDlg&&this.options.onCloseDlg())},displayDialog:function(i){var o=this;o._dlgDiv&&o._dlg&&o._closeDlg(),o._dlgDiv=t.createElement("div",{styles:{width:"100%",height:"100%",overflow:"hidden"}});var s=t.merge(i,{className:"xcad-modal",title:n.ImportView,body:o._dlgDiv,overlay:!0,closable:!0,animate:!0,resizable:!0,autocenter:!0,visible:!0,footer:i.footerStyle===o.footerStyle.okCancel?'<button type="button" class="btn btn-primary _BTN_OK">'+n.get("xcad.ui.button.ok")+'</button> <button type="button" class="btn btn-default _BTN_CANCEL">'+n.get("xcad.ui.button.cancel")+"</button>":void 0,events:{onClose:o._closeDlg.bind(o)}});o._dlg=new e(s),null!=i.isPaddingReq&&!0===i.isPaddingReq&&o._dlg.elements.body.setStyle("padding","0"),o._dlg.inject(t.extendElement(document.body)),o._dlgDiv.setContent(i.bodyDiv),o._dlg.elements.footer&&(o._dlg.elements.footer.getElement("button._BTN_OK").addEvent("click",function(e){i.onOK(e),o._closeDlg()}),o._dlg.elements.footer.getElement("button._BTN_CANCEL").addEvent("click",function(e){o._closeDlg(),i.onCancel(e)})),o._dlg.elements.container.setStyles({width:i.position._width,height:i.position._height,top:i.position._top,left:i.position._left}),this.options=i},setTitle:function(e){void 0!==this._dlg&&this._dlg.setTitle("string"==typeof e&&e.length?e:"")}}}),define("DS/ENOXCADUtils/utils/XCADModelEvents",["DS/CoreEvents/ModelEvents"],function(e){"use strict";var t=new e;return{getModelEvents:function(){return t},publish:function(e){return t.publish(e)},subscribe:function(e,n){return t.subscribe(e,n)},unsubscribe:function(e){return t.unsubscribe(e)},unsubscribeAll:function(e){return t.unsubscribeAll(e)}}}),define("DS/ENOXCADUtils/XCADIconsPath",["UWA/Class","UWA/Class/Options","text!DS/ENOXCADUtils/assets/IconMap.json"],function(e,t,n){"use strict";return e.singleton(t,{init:function(){},getTypeIconPath:function(e,t,i){var o,s,l=JSON.parse(n),a=l.typeclassIcons[0].typeclasslink,r=l.typeclassIcons[1].cadtypelink,c=!1,d=!1;if(null!=t.cadfiletype){let n=t.cadfiletype;return e+l.cadfiletype[n]}if(null!=t.typeclass?"string"==typeof t.typeclass?""!=t.typeclass?(c=!0,s=t.typeclass.replace(/[^a-zA-Z0-9,_]/g,"").split(",")):d=!0:t.typeclass.length>0?(c=!0,s=t.typeclass):d=!0:d=!0,Boolean(c)){let t;s.includes("TYPE_EMBEDDED_COMPONENT_LIKE")||(t=a.find(e=>s.includes(e.typeclass))),null!=t?(o=e+t.iconPath,d=!1):d=!0}if(Boolean(d)&&""!=t.cadtype){var u=r.find(e=>e.cadtype==t.cadtype);null!=u?o=e+u.iconPath:null!=i&&(o=null==i[t.cadtype]||i[t.cadtype].contains("x3DSpaceResources")?e+"/snresources/images/icons/small/I_UnknownFile22x22.png":e+"/snresources/images/icons/small/"+i[t.cadtype])}return o},updateGridIconPath:function(e,t){var i=JSON.parse(n),o=i.cadoriginlink.find(e=>e.cadorigin==t.cadorigin);null!=o&&(t.cadoriginicon=e+o.iconPath);var s,l=!1;if("string"==typeof t.relclass?""!=t.relclass&&(l=!0,s=t.relclass.replace(/[^a-zA-Z0-9,_]/g,"").split(",")):t.relclass.length>0&&(l=!0,s=t.relclass),Boolean(l))for(var a=0;a<i.relclasslink.length;a++)if(s.includes(i.relclasslink[a].relclass)){t.relicon=e+i.relclasslink[a].iconPath;break}return t}})}),define("DS/ENOXCADUtils/utils/XCAD3DDriveDialog",["UWA/Core","DS/WAFData/WAFData","DS/Windows/Dialog","DS/Controls/Button","DS/Controls/ComboBox","DS/Controls/ModalContainer","DS/TreeModel/TreeNodeModel","DS/Tree/FileTreeView","DS/TreeModel/TreeDocument","DS/Windows/ImmersiveFrame","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","i18n!DS/ENOXCADUtils/assets/nls/XCADModelView"],function(e,t,n,i,o,s,l,a,r,c,d,u){"use strict";var f,m,h,p,g,v,D=0,C=null,b=null,y=new Map,S=null,E=null,w=null,A=[],_=0,N=function(e,t){this.service=e,this.name=t,this.folderList=new Map},x=function(e,t,n,i,o){this.title=e,this.extension=o,this.path=i,this.id=t,this.node=n,this.children=[]};function B(e,t,n,i){var o=new l({label:e,icons:t?[{iconName:"folder-zipped"}]:"folder",children:t?null:[]});i?i.addChild(o):b.addRoot(o);var s=A[D].folderList.get(n);if(s)s.node=o;else{var a=i?y.get(i).path+"\\"+e:e;s=new x(e,n,o,a,t),A[D].folderList.set(n,s),i&&y.get(i).children.push(s)}y.set(o,s)}function I(){b.removeRoots(),y.clear(),B(u.myfiles,null,"DSROOT",null),v||B(u.sharedwithme,null,"sharedwithme",null)}function T(e,t){var n=[],i=[];t.forEach(function(e){if(null!==e.extension&&""!==e.extension){var t="."+e.extension;null!=w&&w.includes(t)&&i.push(e)}else n.push(e)}),n.sort(function(e,t){return e.title>t.title?1:-1}),n.forEach(function(t){B(t.title,null,t.id,e)}),i.sort(function(e,t){return e.title>t.title?1:-1}),i.forEach(function(t){B(t.title,t.extension,t.id,e)})}function O(e,n){let i=n.url+"/resources/3ddrive/v1/bos";i=function(e,t){return e+(e.match(/\?/)?"&":"?tenant="+encodeURIComponent(t))}(i+"/"+e+"/contents",n.platformId);let o={};return new Promise(function(e,n){o.onComplete=function(t){let n="string"==typeof t?JSON.parse(t):t;e(n)},o.onFailure=function(e){n(e)},o.type="json",o.method="GET",o.headers={Accept:"application/json","Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},o.timeout=6e5,t.authenticatedRequest(i,o)})}function P(e){if(e&&e.data&&e.data.nodeModel){var t=e.data.nodeModel,n=y.get(t);if(n&&e.target){var i=n.id,o=A[D].service;if(Array.isArray(t.options.children)&&t.options.children.length<1){var s=y.get(t);if(!(s.children.length>0))return m?O(i,o).then(function(n){Array.isArray(n.items)&&n.items.length>0&&T(t,n.items),e.target.preExpandDone()}).catch(function(t){return e.target.preExpandDone(),!1}):void function(e,t){for(var n=0;n<3;++n){var i=A[D].service.platformId+"_Test_Folder_"+n;B(i,null,i+"_ID",t)}setTimeout(function(){e.target.preExpandDone()},3e3)}(e,t);T(t,s.children),e.target.preExpandDone()}else e.target.preExpandDone()}else e.target.preExpandDone()}}function U(e){if(e){var t=y.get(e);t&&(console.log(t.path),e.isSelected()?(g||(S.disabled=!1),E=e):(g||(S.disabled=!0),E=null))}}function k(){let t=new e.createElement("div",{class:"swx-3ddrivebrowser-treediv"});return b=new r({useAsyncPreExpand:!0}),(C=new a({treeDocument:b})).inject(t),b.onPreExpand(function(e){e&&P(e)}),C.onNodeClick(function(e){e&&e.nodeModel&&(m||e.nodeModel.expand(),U(e.nodeModel))}),b.getXSO().onEmpty(function(){E=null,g||(S.disabled=!0)}),t}function X(){for(var t=0;t<A.length;++t)if(A[t].service.platformId===widget.getValue("x3dPlatformId")){D=t;break}var n=new e.createElement("div",{styles:{padding:"10px"}});new e.createElement("img",{styles:{width:"25px"},src:require.toUrl("DS/ENOXCADUtils/assets/icons/XCADWeb3DDriveIcon.png")}).inject(n);var i=new o({domId:"swx-3ddrivebrowser-combo",elementsList:A.map(e=>e.name),selectedIndex:D,enableSearchFlag:!1});return i.addEventListener("change",function(e){e&&e.dsModel&&(D=e.dsModel.selectedIndex,I())}),i.inject(n),n}function M(t){var o=function(t){var o=new e.createElement("div");X().inject(o),k().inject(o),I(),S=new i({label:u.OKButton,disabled:!0,onClick:function(e){var n=null;if(E){var i=y.get(E);n={fileId:i.id,filePath:i.path,fileName:i.title,tenant:A[D].service}}t(n)}}),(h=new c({identifier:"WebUIPanelDocumentation_WindowsEvents"})).inject(p);var s=new n({immersiveFrame:h,title:u.BrowseDialogTitle,closeButtonFlag:!1,resizableFlag:!0,minWidth:300,width:300,modalFlag:!0,content:o,buttons:{Cancel:new i({onClick:function(e){t()}}),Ok:S}});return s.addEventListener("startResize",function(e){e&&(_=e.srcElement.clientHeight)}),s.addEventListener("stopResize",function(e){if(e){var t=e.srcElement.clientHeight-_;s.height-=t}}),s}(t);return document.getElementById("swx-3ddrivebrowser-combo").style.width="220px",Promise.resolve({browser:o,immersiveframe:h})}function W(t){var n=e.createElement("div",{id:"3dDrive_main_div"});return X().inject(n),k().inject(n),I(),null!=widget.getValue("isODTInfra")&&widget.getValue("isODTInfra")?Promise.resolve({mainDiv:n}):(s.createModal(p,n),null!=document.getElementById("swx-3ddrivebrowser-combo")&&(document.getElementById("swx-3ddrivebrowser-combo").style.width="200px"),Promise.resolve({modalContainer:s}))}return{generate3DDriveBrowser:async function(e,t,n,i,o,s,l){if(A=[],f=t,p=n,g=null!=o&&o,w=i,v=null!=s&&s,m="OnPremise"!=t){var a=null,r=null;null!=l&&Object.keys(l).length>0?(a=[{platformId:f,url:l.url3DDrive}],r=[{tenantName:l.tenantname,url:l.url3DSpace}]):(a=await async function(){return new Promise(function(e){d.getServiceUrl({serviceName:"3DDrive",onComplete:function(t){let n=[];for(let e=0;e<t.length;e++)if(t[e].platformId===f){n.push({platformId:t[e].platformId,url:t[e].url});break}e(n)}})})}(),r=await async function(){return new Promise(function(e){d.getPlatformServices({onComplete:function(t){let n=[];for(let e=0;e<t.length;e++)if(t[e].platformId===f){n.push({tenantName:t[e].displayName,url:t[e]["3DSpace"]});break}e(n)}})})}());for(var c=0;c<a.length;++c){null==a[c].url&&(a[c].url=r[c].url);var h=new N(a[c],r[c].tenantName);A.push(h)}return g?W():M(e)}if(null!=widget.getValue("isODTInfra")&&widget.getValue("isODTInfra"))return A.push(new N(u.Tenant1.service,u.Tenant1.name)),A.push(new N(u.Tenant2.service,u.Tenant2.name)),g?W():M(e)},selectedNode:function(){var e=null;if(E){var t=y.get(E);e={fileId:t.id,filePath:t.path,fileName:t.title,tenant:A[D].service}}return e},selectNodeModel:U}}),define("DS/ENOXCADUtils/utils/PlatformURL",["UWA/Class","UWA/Promise","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","DS/WAFData/WAFData"],function(e,t,n,i){"use strict";var o,s;return e.extend({init:function(){var e=this;n.getPlatformServices({onComplete:function(t){let n=e.getPlatformId();for(let e=0;e<t.length;e++)if(t[e].platformId===n){o=t[e]["3DSpace"];break}e.setSecurityContext().then(function(e){s=e})},onFailure:function(e){console.log("PlatformServices fail",e)}})},setSecurityContext:function(){let e=o+"/resources/pno/person/getsecuritycontext?tenant="+this.getPlatformId();return new t(function(t,n){i.authenticatedRequest(e,{headers:{Accept:"application/json","Content-Type":"application/json"},method:"GET",onComplete:function(e){var n=JSON.parse(e);if(n&&n.SecurityContext){let i=n.SecurityContext,o="";0!==i.indexOf("ctx::")&&(o="ctx::"),t(e=o+i)}},onFailure:function(e){console.log("SecurityContext Error"+e),n(e)}})})},getPlatformId:function(){return"undefined"!=typeof widget&&widget.getValue("x3dPlatformId")?widget.getValue("x3dPlatformId"):"OnPremise"},getLang:function(){return"undefined"!=typeof widget?widget.lang:"en"},get3DSpaceURL:function(){return o},getsecurityContext:function(){return s}})}),define("DS/ENOXCADUtils/loader/XCADLoader",["UWA/Class","DS/ENOXCADUtils/utils/XCADModelEvents","i18n!DS/ENOXCADUtils/assets/nls/XCADModelView","css!DS/ENOXCADUtils/assets/css/XCADLoader"],function(e,t,n){"use strict";var i;return e.extend({init:function(e){i=new UWA.createElement("div",{class:"loader-content",id:"overlay"}),new UWA.createElement("img",{id:"overlayImage",src:require.toUrl("DS/ENOXCADUtils/assets/icons/uikit-loader.gif")}).inject(i),i.inject(e.maindiv),this.subsribeEvents()},subsribeEvents:function(){t.subscribe({event:"xcad-loader-on"},function(){document.getElementById("overlay").style.display="block"}),t.subscribe({event:"xcad-loader-off"},function(){document.getElementById("overlay").style.display="none"})}})});