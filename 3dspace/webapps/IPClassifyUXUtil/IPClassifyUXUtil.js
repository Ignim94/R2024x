define("DS/IPClassifyUXUtil/views/additionalData/manipulationUnitColumns",["UWA/Core","UWA/Class","DS/IPClassifyUtil/DimensionUtils","i18n!DS/IPClassifyUXUtil/assets/nls/IPClassifyUXUtil"],function(e,t,n,i){"use strict";return t.singleton({init:function(e){this._parent(e)},getName:function(){return"manipulationUnitColumns"},isAdditionalColumnsAvailable:function(t,n){if(!1===e.is(n,"function"))throw new Error("A callback function should be defined");this.dataProvider=t,n(!0)},getManagedColumnNames:function(){let e=[],t=this.dataProvider.getManipulationUnitColumns();for(var n=0;n<t.length;++n)e.push(t[n].dataIndex);return e},toBeUpdated:function(t,n){var i=!1;if(t&&0!==Object.keys(t).length){let n=Object.keys(t);if(n&&n.length>0){n=n[0];let s=this.dataProvider.getColumnUnitNls(n);if(s&&t[n]){let a=t[n];!0===e.is(t[n],"array")&&(a=t[n].length>0?t[n][0]:null),a&&-1===a.indexOf(s)&&(i=!0)}}}return i},updateAttributes:function(t,s){var a=this;if(!1===e.is(t,"object")||!1===e.is(t.pids,"array"))throw new Error("The object ids to modify must be specified");if(!1===e.is(s,"function"))throw new Error("A callback function should be defined");let o=this.dataProvider.getManipulationUnitColumns();function l(e){return-1===e.indexOf(" ")}o||s();let r={Data:[]};for(let e=0;e<o.length;++e){let t=o[e];r.Data[e]={},r.Data[e].Dimension=t.convertInfos.dimension,r.Data[e].UnitFrom=t.convertInfos.unit,r.Data[e].UnitTo=t.convertInfos.manipulationUnit,r.Data[e].Values=this.dataProvider.getManipulationUnitVisibleValues(t.dataIndex),r.Data[e].Values=r.Data[e].Values.filter(l),r.Data[e].Values.length>0&&(r.Data[e].Values=r.Data[e].Values.join(";"))}n.convertToPreferdUnits(r).then(function(n){n||s();var l={};for(let s=0;s<t.pids.length;++s){l[t.pids[s]]={};for(let r=0;r<o.length;++r){let c=o[r].dataIndex,d=n[r],u=o[r].convertInfos.manipulationNls;if(d&&c&&u){let n=d.ConvertedValues;n=n?n.split(";"):null;let o=d.ValuesToConvert;o=o?o.split(";"):null;let r=a.dataProvider.getManipulationUnitVisibleValues(c,t.pids[s]);if(n&&e.is(n,"array")&&o&&e.is(o,"array")&&r){let a=null;if(!0===e.is(r,"array")){a=[];for(let e=0;e<r.length;++e){let t=o.indexOf(r[e]);a.push(parseFloat(n[t])+" "+u)}}else{let e=o.indexOf(r[k]);a=parseFloat(n[e])+" "+u}const d=t.nodes[s].getAttributeValue(c),h=d.length>1&&"object"==typeof d;d===i.get("multipleClassificationValue")||h||(l[t.pids[s]][c]=a)}}}}var r={pids:l};r=JSON.stringify(r),s(r)})}})}),define("DS/IPClassifyUXUtil/FileImportPanel",["UWA/Core","UWA/Controls/Abstract","UWA/Class/Promise","DS/Controls/Button","DS/Windows/ImmersiveFrame","DS/Windows/Panel","DS/Windows/Dialog","DS/IPClassifyUtil/IPClassifyAlert","DS/UIKIT/Mask","i18n!DS/IPClassifyUXUtil/assets/nls/IPClassifyUXUtil","css!DS/IPClassifyUXUtil/IPClassifyUXUtil"],function(e,t,n,i,s,a,o,l,r,c){"use strict";return t.extend({name:"ip-classification-import",init:function(t){this._parent(t);var n=this;n.elements.container=e.createElement("div",{class:n.getClassNames("-immersivePanel")});var i=new s({});new o({immersiveFrame:i,title:t.panelHeaderName,content:n.elements.container,autoCloseFlag:!1,height:140,width:500,minHeight:120,minWidth:365,resizableFlag:!0,modalFlag:!0,identifier:"WebUIPanelDocumentation_LibraryImportDialog",icon:t.panelHeaderIcon}).addEventListener("close",function(e){n.options.modelEvents.publish({event:n.options.closePanelEvent,data:{restore:!0}}),n.destroy()}),n._buildBody().then(n._buildFooter.bind(n)).done(function(){n.options.modelEvents.publish({event:n.options.closePanelEvent,data:{html:i,keepOpacity:!0}})})},destroy:function(){this._parent()},_buildBody:function(){var t=this;return new n(function(n,i){t.elements.content=e.createElement("div",{class:t.getClassNames("-content")}).inject(t.elements.container);var s={id:"IpClassifyImportFileInput"};if(t.options.accept&&(s.accept=t.options.accept),t.elements.fileController=new e.Controls.Input.File({attributes:s,button:{tag:"div",text:c.FileImportPanel_choseFile},events:{onChange:function(e){t.options.inputChanged&&t.options.modelEvents.publish({event:t.options.inputChanged,data:e.target.files[0]}),t.resetButtonEmphasize(!0)}}}).inject(t.elements.content),t.elements.fileController.getContent().setStyle("width","auto"),t.options.placeHolder){var a=t.elements.fileController.elements.content.getChildren()[0];a&&(a.setAttribute("style","opacity: 0.8; color: #b4b6ba"),a.textContent=t.options.placeHolder)}n()})},_buildFooter:function(){var t=this;return new n(function(n,s){if(t.elements.footer=e.createElement("div",{class:t.getClassNames("-footer")}).inject(t.elements.container),t.options.validateFile){var a=t.elements.validateButton=new i({label:c.FileImportPanel_validateBtn,emphasize:"primary",touchMode:!0});a.addEventListener("buttonclick",function(){t.processFile(!0)}),a.inject(t.elements.footer)}var o=t.elements.importButton=new i({label:t.options.importButton_label?t.options.importButton_label:c.FileImportPanel_importBtn,emphasize:t.elements.validateButton?"secondary":"primary",touchMode:!0,disabled:!(!t.options.importButton_state||"disabled"!=t.options.importButton_state)});o.addEventListener("buttonclick",function(){t.processFile(!1)}),o.inject(t.elements.footer);var l=t.elements.closeButton=new i({label:t.options.cancelbtn_label?t.options.cancelbtn_label:c.FileImportPanel_cancelbtn,emphasize:"secondary",touchMode:!0});l.addEventListener("click",function(){t.options.modelEvents.publish({event:t.options.closePanelEvent,data:{restore:!0}}),t.destroy()}),l.inject(t.elements.footer),n()})},processFile:function(t,n){var i=this,s=i.elements.fileController.elements.input;if(s&&s.files||(s=document.getElementById("IpClassifyImportFileInput")),n&&(s=n),1===s.files.length){var a=s.files[0];if(e.log("File.type = "+a.type),"text/xml"===a.type||"application/x-zip-compressed"===a.type){var o=new FileReader;o.onload=function(e){if(t)r.mask(i.elements.container,i.options.validationInProgressMsg),i.options.validateFile({selectedFileContent:o.result,fileName:a.name}).then(function(e){l.displayNotification({message:e.message,className:e.success?"success":"error"}),e.success?i.resetButtonEmphasize(!1):i.resetButtonEmphasize(!0),r.unmask(i.elements.container)});else{var n={selectedFileContent:o.result,fileName:a.name};"application/x-zip-compressed"===a.type&&(n={file:a}),i.options.modelEvents.publish({event:i.options.importFileEvent,data:n}),i.options.modelEvents.publish({event:i.options.closePanelEvent,data:{restore:!0}}),i.destroy()}},o.onerror=function(e){l.displayNotification({message:c.FileImportPanel_fileNotAccessible,className:"warning"}),i.elements.fileController.setValue(),i.resetButtonEmphasize(!0)},o.onloadend=function(){e.log("read file - onloadend !!")},o.readAsText(a)}else{var d=t?"an XML":"a ZIP";l.displayNotification({message:c.FileImportPanel_fileNotSupportedXML.replace("{file_type}",d),className:"warning"})}}else{d=t?"an XML":"a ZIP";l.displayNotification({message:c.FileImportPanel_noFileSelected.replace("{file_type}",d),className:"warning"})}},resetButtonEmphasize:function(e){if(!this.elements.validateButton)return!0;e?(this.elements.validateButton.emphasize="primary",this.elements.importButton.emphasize="secondary"):(this.elements.validateButton.emphasize="secondary",this.elements.importButton.emphasize="primary")}})}),define("DS/IPClassifyUXUtil/utils/DictionaryAccess",["UWA/Core","UWA/Promise","DS/Utilities/Utils","DS/FedDictionaryAccess/FedDictionaryAccessAPI","i18n!DS/PADServices/assets/nls/PADServices.json","DS/PADServices/utils/GlobalUtils","DS/PADServices/utils/PlatformURL","DS/PADServices/utils/ClassificationAttributes"],function(e,t,n,i,s,a,o,l){"use strict";var r={nodes2updateId:[],nodes2update:[],grpnodes2updateId:[],grpnodes2update:[],idx:0,idxGrp:0};const c=["ds6w:label","ds6w:type","ds6w:description","ds6w:identifier","ds6w:modified","ds6w:responsible","ds6wg:revision","ds6w:status","owner","ds6w:created"];function d(e,t,n){e[t]||(e[t]=[]),-1===e[t].indexOf(n)&&e[t].push(n)}function u(t,n,i){for(var s=!1,a={grid:e.clone(t.options.grid)},o=0;o<n.length;o++)a.grid[n[o]]&&i[n[o]][a.grid[n[o]]]&&i[n[o]][a.grid[n[o]]]!==a.grid[n[o]]&&(s=!0,a.grid[n[o]]=i[n[o]][a.grid[n[o]]]);return{updated:s,options:a}}var h=n.debounce(function(t){f.idx=0;var n,s,l,c={},d=require("DS/PADServices/utils/AttributesMgtV2"),u=d.getAvailableColumns(),h=d.getColumnsToNotNls(),m=u.filter(function(e){return-1===h.indexOf(e)});for(n=0;n<t.length;n++){l=t[n].getTreeDocument();var g=t[n].options.grid?Object.getOwnPropertyNames(t[n].options.grid):[];for(s=0;s<g.length;s++)if(d.hasNLS(g[s])&&-1!==m.indexOf(g[s])){var v=-1!==g[s].indexOf("-Instance")?g[s].substring(0,g[s].indexOf("-Instance")):g[s];void 0===c[v]&&(c[v]=[]);let e=t[n].options.gridValue&&t[n].options.gridValue[g[s]],i=e||t[n].options.grid[g[s]];if(-1===c[v].indexOf(i))if("object"==typeof i){Object.entries(i).length;for(const[e,t]of Object.entries(i))c[v].push(t)}else c[v].push(i)}}i.getNlsOfPropertiesValues(JSON.stringify(c),{tenantId:o.getPlatformId(),lang:a.getLang(),apiVersion:p,onComplete:function(i){var a=e.is(i,"string")?JSON.parse(i):i;function o(t){var n=!1,i={grid:e.clone(t.options.grid),gridValue:t.options.gridValue?e.clone(t.options.gridValue):{}},o=Object.keys(i.grid);for(s=0;s<o.length;s++){var l=-1!==o[s].indexOf("-Instance")?o[s].substring(0,o[s].indexOf("-Instance")):o[s];a[l]&&a[l][i.grid[o[s]]]&&a[l][i.grid[o[s]]]!==i.grid[o[s]]&&(n=!0,i.gridValue[o[s]]=i.grid[o[s]],i.grid[o[s]]=a[l][i.grid[o[s]]])}return{updated:n,options:i}}if(l)l.setUseChangeTransactionMode(!0),l.withTransactionUpdate(function(){for(n=0;n<t.length;n++){var e=t[n],i=o(e);!0===i.updated&&e.updateOptions(i.options),delete e._manageNLS,e.options.ensureNLS=!1}r.nodes2updateId=[],r.nodes2update=[]}),l.setUseChangeTransactionMode(!1);else{for(n=0;n<t.length;n++){var c=t[n],d=o(c);!0===d.updated&&c.updateOptions(d.options),delete c._manageNLS,c.options.ensureNLS=!1}r.nodes2updateId=[],r.nodes2update=[]}},onFailure:function(e){console.warn("Cannot retrieve NLS"),r.nodes2updateId=[],r.nodes2update=[]}})},200),m=n.debounce(function(t){f.idxGrp=0;var n,s,l={};if(t.length){for(s=t[0].getTreeDocument(),n=0;n<t.length;n++){var c=t[n].options.ds6w;l[c]||(l[c]=[]),-1===l[c].indexOf(t[n].getLabel())&&l[c].push(t[n].getLabel())}i.getNlsOfPropertiesValues(JSON.stringify(l),{tenantId:o.getPlatformId(),lang:a.getLang(),apiVersion:p,onComplete:function(i){var a=e.is(i,"string")?JSON.parse(i):i;function o(i){var s={label:e.clone(i.getLabel())},o=!1,l=t[n].options.ds6w;return a[l]&&a[l][i.getLabel()]&&i.getLabel()!==a[l][i.getLabel()]&&(o=!0,s.label=a[l][i.getLabel()]),{updated:o,options:s}}s&&(s.setUseChangeTransactionMode(!0),s.withTransactionUpdate(function(){for(n=0;n<t.length;n++){var e=t[n],i=o(e);!0===i.updated&&e.updateOptions(i.options),delete e._manageNLS}r.grpnodes2updateId=[],r.grpnodes2update=[]}),s.setUseChangeTransactionMode(!1))},onFailure:function(e){console.warn("Cannot retrieve NLS"),r.grpnodes2updateId=[],r.grpnodes2update=[]}})}},100),p="R2019x",f={__mapAttNameNLS:{},initNLS:function(){return this.retrieveDS6WNLS(c)},getAttNameNLS:function(e){return this.__mapAttNameNLS[e]?this.__mapAttNameNLS[e].label:s.columnsNLS[e]?s.columnsNLS[e]:e},retrieveDS6WNLS:async function(e){return new t((t,n)=>{var s={tenantId:o.getPlatformId(),lang:a.getLang(),apiVersion:p,onComplete:e=>{for(let t=0;t<e.length;t++)this.__mapAttNameNLS[e[t].curi]=e[t];t(this.__mapAttNameNLS)},onFailure:()=>{t()}};i.getResourcesInfo(e.join(","),s)})},retrieveNLS:function(n){return new t(function(t,s){i.getNlsOfPropertiesValues(JSON.stringify(n.nlsData),{tenantId:o.getPlatformId(),lang:a.getLang(),apiVersion:p,onComplete:function(n){var i=e.is(n,"string")?JSON.parse(n):n;t(i)},onFailure:function(e){console.warn("Cannot retrieve NLS"),t({})}})})},retrieveNLSWithSource:function(n){return new t(function(t,s){i.getNlsOfPropertiesValuesBySource(n.nlsData,{tenantId:o.getPlatformId(),lang:a.getLang(),apiVersion:p,onComplete:function(n){var i=e.is(n,"string")?JSON.parse(n):n;t(i)},onFailure:function(e){console.warn("Cannot retrieve NLS"),t({})}})})},updateColumnsWithNLS:function(t,n){const i=this,o=[],r=require("DS/PADServices/utils/AttributesMgtV2"),c=r.getBaseInstanceTypes().length>0;i.completeResponse={},t.forEach(e=>{let t=null;if(t=e.ds6w&&"rel"!==e.ds6wFrom?e.ds6w:e.ds6w&&"rel"===e.ds6wFrom?e.dataIndex:e.xnav_options&&e.xnav_options.name?e.xnav_options.name:e.dataIndex,e.customisation&&!0===e.customisation.titleModified&&(t=null),t){if("actualIndex"===t)return;if(e.text)i.completeResponse[t]={nlsName:e.text,lang:a.getLang()};else if(e.label)i.completeResponse[t]={nlsName:e.label,lang:a.getLang()};else if(-1!==t.indexOf(":")&&"rel"!==e.ds6wFrom)o.push(t);else if("rel"===e.ds6wFrom){if(-1!==t.indexOf(":"))if(c){const e=t.substring(0,t.indexOf("-Instance"));o.includes(e)||o.push(e)}else"ds6w:label-Instance"===t&&(i.completeResponse[t]={nlsName:s.attributesCustomization.instanceName,lang:a.getLang()});"positionMatrix-Instance"===t&&(i.completeResponse[t]={nlsName:s.attributesCustomization.instanceMatrix,lang:a.getLang()})}else e.xnav_options&&!0===e.xnav_options.hardcoded?i.completeResponse[t]={nlsName:s[t],lang:a.getLang()}:s.attributesCustomization[t]?i.completeResponse[t]={nlsName:s.attributesCustomization[t],lang:a.getLang()}:!e.isAdditionalColumn&&r.isAttributeColumn(e.dataIndex)&&console.warn("DictionaryAccess## Unknown attribute type:"+e.dataIndex)}});const d=()=>{t.forEach(e=>{let t=null,n=null;e.ds6w&&"rel"!==e.ds6wFrom?t=e.ds6w:e.ds6w&&"rel"===e.ds6wFrom?-1!==(t=e.dataIndex).indexOf("-Instance")&&(n=t.substring(0,t.indexOf("-Instance"))):t=e.xnav_options&&e.xnav_options.name?e.xnav_options.name:e.dataIndex,e.noTitleColumn?e.text=void 0:t&&i.completeResponse[t]&&i.completeResponse[t].nlsName&&!e.noTitleColumn?e.text=i.completeResponse[t].nlsName:n&&i.completeResponse[n]&&i.completeResponse[n].nlsName&&!e.noTitleColumn?e.text=i.completeResponse[n].nlsName+" ":t&&-1!==t.indexOf("ds6w")&&!0!==e.customisation.titleModified&&(console.warn("DictionaryAccess## ds6w attribute ["+t+"] not found by FedDictionaryAccessAPI.getResourcesInfo"),e.text=t)}),n({status:"success",columns:t})};o.length>0?i.getResourcesInfo(o).then(t=>{e.is(t,"array")&&t.forEach(e=>{let t=e.label;if(e.curi){if(t===e.curi.replace("ds6wg:","")){console.warn("No real label for attribute "+e.curi);const n=t.indexOf(".");n>0&&(t=t.substring(n+1))}}i.completeResponse[e.curi]={nlsName:t,lang:a.getLang(),kind:e.dataType}})}).then(l.getClassificationAttributes).then(e=>{e&&e.length>0&&e.forEach(e=>{e.properties.forEach(e=>{void 0!==i.completeResponse[e.curi]&&(i.completeResponse[e.curi]={nlsName:e.label,lang:a.getLang(),kind:e.dataType})})})}).finally(d):d()},updateNLS:function(e){var t=e.getOccurencePath();-1===r.nodes2updateId.indexOf(t)&&(r.nodes2updateId.push(t),r.nodes2update.push(e),h(r.nodes2update))},updateNLSforexport:function(n,s){var l=s||n.getAllDescendants();return new t(function(t,s){var r=function(e){for(var t={},n=require("DS/PADServices/utils/AttributesMgtV2"),i=n.getAvailableColumns(),s=n.getColumnsToNotNls(),a=i.filter(function(e){return-1===s.indexOf(e)}),o=0;o<e.length;o++)for(var l=e[o],r=Object.keys(l.options.grid),c=0;c<r.length;c++)if(!l.options.gridValue[u]){var u=r[c];n.hasNLS(u)&&-1!==a.indexOf(u)&&"ds6w:reserved"!==u&&"positionMatrix-Instance"!==u&&d(t,u,l.options.grid[u])}return t}(l);i.getNlsOfPropertiesValues(JSON.stringify(r),{tenantId:o.getPlatformId(),lang:a.getLang(),apiVersion:"R2019x",onComplete:function(i){var s=function(e){for(var t={},n=Object.keys(e),i=0;i<n.length;i++)for(var s=e[n[i]],a=Object.keys(s),o=0;o<a.length;o++){var l=a[o],r=s[l];!r||l===r||r.indexOf&&0===r.indexOf("emxFramework")||(t[n[i]]||(t[n[i]]={}),t[n[i]][l]=r)}return t}(e.is(i,"string")?JSON.parse(i):i),a=Object.keys(s);n.setUseChangeTransactionMode(!0),n.withTransactionUpdate(function(){for(var e=0;e<l.length;e++){var t=l[e],n=u(t,a,s);!0===n.updated&&t.updateOptions(n.options)}}),n.setUseChangeTransactionMode(!1),t()},onFailure:function(e){console.warn("Cannot retrieve NLS"),t()}})})},getPropertiesForClass:async function(e){const t=e.classURIs.split("\n");var n=[];for(let e=0;e<t.length;e+=100){const i=t.slice(e,e+100);let s=await this.__splittedPropertiesForClass(i.join("\n"));s&&(n=n.concat(s))}return n},getResourcesInfo:function(e){return new t(function(t,n){var s={tenantId:o.getPlatformId(),lang:a.getLang(),apiVersion:p,onComplete:function(e){t(e)},onFailure:function(n){console.warn("DictionaryAccess## FedDictionaryAccessAPI.getResourcesInfo failed for"+e.join(",")),n&&n.length?t(n):t()}};i.getResourcesInfo(e.join(","),s)})},updateNLSGroupingNode:function(e){var t=e.getGroupID();-1===r.grpnodes2updateId.indexOf(t)&&(r.grpnodes2updateId.push(t),r.grpnodes2update.push(e),m(r.grpnodes2update))},__splittedPropertiesForClass:async function(n){return new t(function(t,s){i.getPropertiesForClass(n,{tenantId:o.getPlatformId(),lang:a.getLang(),apiVersion:p,onComplete:function(n){var i=e.is(n,"string")?JSON.parse(n):n;t(i)},onFailure:function(e){console.warn("FedDictionaryAccessAPI.getPropertiesForClass failed"),s()}})})}};return f}),define("DS/IPClassifyUXUtil/private/ObjectsSearchInput",["UWA/Controls/Abstract","UWA/Class/Events","UWA/Event","i18n!DS/IPClassifyUXUtil/assets/nls/IPClassifyUXUtil","css!DS/IPClassifyUXUtil/IPClassifyUXUtil"],function(e,t,n,i){"use strict";return e.extend(t,{name:"ipobjects-search-input",init:function(e){this._parent(e);this.elements.container=UWA.createElement("div",{class:this.getClassNames(e.className?e.className:"")}),this.elements.inner=UWA.createElement("div",{class:this.getClassNames("-inner")}).inject(this.elements.container);var t=UWA.createElement("div",{class:this.getClassNames("-input-container")}).inject(this.elements.inner);this.elements.input=UWA.createElement("input",{class:this.getClassNames("-input"),type:"text",placeholder:this.options.placeholder?this.options.placeholder:i.get("ObjectsSearchInput_Placeholder")}).inject(t);var n=UWA.createElement("div",{class:this.getClassNames("-right")}).inject(this.elements.inner),s=UWA.createElement("div",{class:this.getClassNames("-clear")+this.getClassNames("-btn")}).inject(n);this.elements.clearBtn=UWA.createElement("div",{class:this.getClassNames("-btnIcon wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-clear"),title:i.get("ObjectsSearchInput_ClearBtn")}).inject(s),this.elements.clearBtn.hide(),this.elements.clearBtn.addEventListener("click",this._onClearSearch.bind(this)),this.elements.input.addEventListener("keyup",this._onSearchInputKeyUp.bind(this)),this.elements.input.addEventListener("paste",this._onSearchInputPaste.bind(this)),this.elements.input.addEventListener("keydown",this._onSearchInputKeyDown.bind(this))},clear:function(e){this._onClearSearch(null,e)},_onSearch:function(e){this.elements.input.blur(),this.dispatchEvent("onSearch",{searchStr:this.elements.input.value})},_onClearSearch:function(e,t){this.elements.input.value="",this.elements.clearBtn.hide(),!0!==t&&this.dispatchEvent("onSearch",{searchStr:this.elements.input.value})},_onSearchInputKeyUp:function(e){this.elements.input.value?(this.elements.clearBtn.setStyle("display","inline-block"),this.dispatchEvent("onSearch",{searchStr:this.elements.input.value})):(this.elements.clearBtn.hide(),this.dispatchEvent("onSearch",{searchStr:this.elements.input.value}))},_onSearchInputPaste:function(e){var t=this;setTimeout(function(){t._onSearchInputKeyUp()}.bind(this),200)},_onSearchInputKeyDown:function(e){"return"===n.whichKey(e)||"Enter"===e.keyIdentifier||"return"===e.keyIdentifier?this._onSearch():"Escape"!==e.keyIdentifier&&"Escape"!=e.code||this.clear(!0),n.stopPropagation(e)}})}),define("DS/IPClassifyUXUtil/ProgressPaneImpl",["UWA/Core","UWA/Controls/Abstract","i18n!DS/IPClassifyUXUtil/assets/nls/ProgressPaneCommands","css!DS/IPClassifyUXUtil/IPClassifyUXUtil","DS/Controls/ProgressBar"],function(e,t,n,i,s){"use strict";var a=e.Controls.Abstract.extend({name:"folder-progress",options:{className:""},init:function(){this._parent(),this.buildSkeleton()},getDestroyTimeout:function(){let e=window.progressPaneTimeout;return e=e||5e3},buildSkeleton:function(){var t=this;this.container=e.createElement("div",{class:t.getClassNames("-progresspane popover")});var i=e.createElement("div",{class:"progresspane-titlebar popover-title"});i.inject(this.container),(t.titleElement=e.createElement("div",{class:"progresspane-title",text:n.PROGRESS})).inject(i),t.titlebarclose=e.createElement("button",{class:"close fonticon fonticon-chevron-down",type:"button"}),t.titlebarclose.inject(i),t.titlebarclose.addEvent("click",function(){t.titlebarclose.classList.contains("fonticon-chevron-down")?t.showMinimizededPanel():t.showMaximizedPanel()}),this.content=e.createElement("div",{class:"progresspane-content popover-content"}),this.content.inject(this.container),this.hide()},showMaximizedPanel:function(){this.titlebarclose.classList.remove("fonticon-chevron-up"),this.titlebarclose.classList.add("fonticon-chevron-down"),this.content.show()},showMinimizededPanel:function(){this.titlebarclose.classList.remove("fonticon-chevron-down"),this.titlebarclose.classList.add("fonticon-chevron-up"),this.content.hide()},show:function(){this.container.show()},hide:function(){this.container.hide(),this.totalSize=0,this.completedSize=0,this.ongoingSizes={},this.titleElement.setText(n.PROGRESS)},createElement:function(t){return e.createElement("div",{class:t})},createJobCancelerNEvent:function(t){let i=e.createElement("span",{class:"progresspane-jobcancel fonticon fonticon-close fonticon-clickable",title:n.Cancel});return i.addEvent("click",function(){t.cancelled=!0,t.progressBar.update(n.Cancelled)}),i},setJobStatus:function(e,t){t.setText(e),t.setAttribute("title",e)},addPendingSize:function(e){this.totalSize+=e},totalSize:0,completedSize:0,ongoingSizes:{},addProgress:function(e,{progressObj:t,max:i,count:o,title:l,cancel:r}){var c=this;c.show();var d=c.createElement("progresspane-job"),u=c.createElement("progresspane-jobtitle");u.innerText=l,u.title=l,u.inject(d);var h=c.createElement("progresspane-pane");h.inject(d);var m=new s({infiniteFlag:!0});m.inject(h);var p=c.createElement("progresspane-jobstatus");if(p.text=n.inProgress,p.title=n.inProgress,p.inject(d),r){var f=c.createJobCancelerNEvent(t);f.inject(d)}d.inject(c.content),c.showMaximizedPanel(),f.hide(),t.progressBar=d;var g=function(){m.hide(),h.hide(),p.show()};t.progressBar.update=function(e){if(e&&e==n.Cancelled||e==n.searchQueryChanged)f.hide(),c.setJobStatus(n.Cancelled,p),g();else if(p.getText()!=n.Cancelled){o=--o;var s=Math.round((i-o)/i*100);m.value=s,u.setText(l),0!=s&&(p.hide(),m.infiniteFlag=!1,m.show(),h.show(),f.show()),o<=1&&f.hide(),0==o&&(c.setJobStatus(n.Completed,p),t.completed=!0)}if(e&&e==n.Cancelled||e==n.searchQueryChanged||0==o){let i=new CustomEvent("onEnd");e==n.searchQueryChanged&&(i.isSearchQueryChanged=!0),t.progressBar.dispatchEvent(i),g(),setTimeout(function(){t.progressBar.destroy()},a.destroyTimeout)}}}});return a.destroyTimeout=5e3,a}),define("DS/IPClassifyUXUtil/tagger/IPTaggerProxyAbstract",[],function(){var e=[];return class{constructor(t){e.push(this),this._model=t,this._isActive=!1,this._wasActives=null,window.widget&&widget.addEvent("onResize",()=>{"minimized"===widget.getView().type?(this._wasActives=this.isActive(),this.activate(!1)):null!==this._wasActives&&this.activate(this._wasActives)})}setTaggerProxy(e){this._filter=e}activate(t){this._filter&&null!=t&&(e.forEach(e=>{t&&e!==this&&e.activate(!t)}),t?this._filter.activate():this._filter.deactivate(),this._isActive=t)}isActive(){return this._isActive}cleanProxy(){this._filter&&this._filter.cleanProxy&&this._filter.cleanProxy()}unsetTags(){this._filter&&this._filter.unsetTags&&this._filter.unsetTags()}getProxy(){return this._filter}}}),define("DS/IPClassifyUXUtil/ActionBar/IPClassifyTabBar",["UWA/Controls/Abstract","UWA/Class/Options","DS/Controls/TabBar"],function(e,t,n){"use strict";return e.extend(t,{name:"IPClassifyTabBarController",init:function(e){this.tabIdCard_container=e.tabIdCard_container,this.dataProvider=e.dataProvider,this.tabBarProvider=e.tabBarProvider,this.tabDetailsShowView={},this._buildSkeleton(e)},_buildSkeleton:function(e){var t=this;this.tabBar=new n({displayStyle:"strip",centeredFlag:!1,showComboBoxFlag:!1,editableFlag:!1,multiSelFlag:!1,reorderFlag:!1}),this.tabBar.inject(t.tabIdCard_container);var i=t.tabBarProvider.getTabBars();for(var s in i)this.tabBar.add(i[s].tabOptions),t.tabDetailsShowView[i[s].tabOptions.value]=i[s].showTreeView;this.tabBar.value=[e.getCurrentWidgetTab()],this.tabBar.addEventListener("tabButtonClick",function(n){n&&n.options&&(e.setCurrentWidgetTab(n.options.value,t.tabDetailsShowView[n.options.value]),e.notifyTabChange(),e.unsubscribeAll(),t.tabBarProvider.updateLayoutOnTabChange(n.options.value))})}})}),define("DS/IPClassifyUXUtil/IPClassifyConfirmationWthCheckBx",["UWA/Class","DS/Controls/Toggle","DS/ENOFloatingPanel/ENOFloatingPanel","i18n!DS/IPClassifyUXUtil/assets/nls/IPClassifyUXUtil","DS/UIKIT/Input/Button"],function(e,t,n,i,s){return e.singleton({name:"Library Confirmation With CheckBox",confirmModal:null,carryOverAttrs:!0,launch:function(e,a,o,l){var r=e.title,c=this;c.carryOverAttrs=!0;var d=UWA.createElement("div",{class:"attrsLostMsgBody"});e.infoTitle&&(d=UWA.createElement("div",{class:"attrsLostMsgBody",styles:{position:"absolute"}}));var u=new t({type:"checkbox",label:e.mainDivContent.checkBoxParams.label,value:0,checkFlag:!0});if(u.addEventListener("change",function(e){c.carryOverAttrs=!c.carryOverAttrs,h&&(c.carryOverAttrs?h.setStyle("display","none"):h.setStyle("display",""))}),e.mainDivContent.divHeaderShow&&UWA.createElement("p",{text:e.mainDivContent.divHeaderShow}).inject(d),u.inject(d),e.mainDivContent.divFooterHide){UWA.createElement("br").inject(d);var h=UWA.createElement("div",{class:"attrsLostMsg"}).inject(d);h.setStyle("display","none"),UWA.createElement("p",{text:e.mainDivContent.divFooterHide,styles:{"font-weight":"bold"}}).inject(h)}if(e.infoTitle)UWA.createElement("span",{id:"InfoPanel",title:e.infoTitle,class:"fonticon fonticon-info",styles:{top:"55%",position:"fixed",right:"1%"}}).inject(d);var m=d,p=document.createElement("div"),f=new s({value:e.confirmLabel||i.confirmation_ok,className:"primary"}).inject(p);new s({value:e.cancelLabel||i.confirmation_cancel}).inject(p).addEvent("onClick",function(e){l&&l(e),g._close()}),f.addEvent("onClick",function(e){a&&a(e),g._close()});var g=new n({className:"command_dialog move",title:r,footer:p,body:m,overlay:!0,closable:!0,animate:!0,resizable:!1,autocenter:!0,visible:!0,events:{onClose:function(){o&&o(event),this.destroy()}},limitParent:!0});g.inject(widget.body)},getChkBoxCheckedFlag:function(){return this.carryOverAttrs}})}),define("DS/IPClassifyUXUtil/ActionBar/IPCommandManager",["DS/Controls/TooltipModel","DS/CoreEvents/Events","DS/RuntimeView/NLSManager","DS/PADUtils/PADContext","DS/IPClassifyUtil/OpenWithMenuBuilder","DS/ApplicationFrame/CommandsManager","DS/WidgetServices/WidgetServices","DS/Menu/Menu","i18n!DS/IPClassifyUXUtil/assets/nls/IPClassifyUXUtil"],(e,t,n,i,s,a,o,l,r)=>{var c=null;a.onCommandStart(e=>{c=e._bkTempSelection?e._bkTempSelection:null,e._bkTempSelection=null});var d={},u=!1,h=[],m=null;function p(e){this._switchRunning||!0!==e.options.checkByCommand||!0!==e._enableByWidget||(h.push(e.getId()),clearTimeout(m),m=setTimeout(()=>{this.getModelEvents().publish({event:"command_visibility_updated",data:{commands:h}}),h=[]},100))}return{init:function(){this._commandInit=null,this._initPromise=new Promise((e,t)=>{this.initialize().then(n=>{var i=n.headers,s=[];for(var a in i){var o=i[a];o.ID=a,s.push(this.loadCommand(o)),s.push(this.loadTooltip(o))}Promise.all(s).then(()=>{e(n)}).catch(t)}).catch(t)}),t.subscribe({event:"/WUX/AFR/CMD//DISABLE"},p.bind(this)),t.subscribe({event:"/WUX/AFR/CMD//ENABLE"},p.bind(this))},getTempSelection:function(){return c},getHeaderCtxMenu:function(e){return function(e){let t=e.noSizeToFit?e.noSizeToFit:[],n=!0;if(e&&e.cellInfos&&e.cellInfos.columnID&&e.collectionView){let i=e.collectionView.getColumnOrGroup(e.cellInfos.columnID);i&&(n=-1===t.indexOf(i.dataIndex))}var i={pin:!0,sizeColumnToFit:n,firstColumnsVisibility:!1,columnsManagement:!0===e.defaultColumnManagement};return e.collectionView.buildDefaultContextualMenu(e,i)}(e)},showLoadingMenu:function(e){var t=null;if(e&&e.data&&e.data.event){var n=[{title:r.Commands_Loading,type:"PushItem",state:"disabled"}];t=l.show(n,{display:void 0,input:"mouse",position:{x:e.data.event.pageX,y:e.data.event.pageY},submenu:"auto"})}return t},getContextualMenu:function(e,t,n){return n.isTree=t,n.noSizeToFit=this.noSizeToFit,new Promise(a=>{var o=null;u||(o=this.showLoadingMenu(n)),this.getToolbarCommands().then(c=>{u=!0;var h=!!n.cellInfos&&n.cellInfos.rowID<0,m=[],p=-1,f=null,g=c.ctxMenu;if(h)m=this.getHeaderCtxMenu(n),f={ColumnVisibility:!0},g=["ColumnVisibility"];else{var v=!n.cellInfos||!0===n.cellInfos.white_Click;if(t||v){var b=e&&e.length>0?e[0]:void 0;f=this._manageSwitchOfCommands(b,v?[]:void 0,!0,g)}else f=this._manageSwitchOfCommands(void 0,e,!0,g)}var C=Promise.resolve(),_=!1;g.forEach(t=>{if(f[t])if(_=!1,"openWith"===t)C=function(e,t){return s.openWithApps(e,{iconOpenWith:{iconName:"open-menu-dot",fontIconFamily:1},nlsOpenWith:r.OpenWith,overrideAppLaunch:t},"FolderWidget_contextual")}(e,n.overrideAppLaunch),p=m.length;else if("DocumentCommands"==t)m.push("DocumentCommands");else{let s=this.getCommand(t);var a=d[t],o=c.headers[t];if(s&&a&&o){var l={iconName:o.icon?o.icon:"alert",fontIconFamily:1},u=r["ctxMenu."+t],h=u||(a.title?a.title:t),g={ID:t,title:h,icon:l,type:"PushItem",action:{callback:()=>{i.get().ctxInfo={nodes:e,options:n},this.launchCommand(t,e,null,"ContextualMenu")}}};null!=o.accelerator&&(g.accelerator=r["ctxMenu."+o.accelerator]),m.push(g)}}else"sep"===t&&m.length>0&&!1===_&&(_=!0,m.push({type:"SeparatorItem"}))});let y=[];this.getAdditionalCtxCommands&&(y=this.getAdditionalCtxCommands(e,t,n)),y.unshift(C),Promise.all(y).then(e=>{let t=e[0];t&&p>-1&&t.forEach(function(e){m.splice(p++,0,e)});for(let t=1;t<e.length;t++){let n=e[t];if(n){let e=-1,t=n.ctxHeader;t?(e=m.indexOf(t))>-1&&(m.splice(e,1),n.forEach(function(t){m.splice(e++,0,t)})):m=n?m.concat(n):m}}m.length>0&&"SeparatorItem"===m[m.length-1].type&&m.pop(),o&&l.hide(),a(m)})})})},getToolbarCommands:function(){return this._initPromise},getTooltip:function(e){return d[e]},_getInstance:function(){return this},loadCommand:function(e){var t=new Promise(t=>{if(e.ClassName){var n=[e.ClassName];require(n,n=>{e.context=null,e.checkByCommand=!0===e.checkByCommand;var i=new n(e);"CATAfrHeaderCheck"===e.Behavior&&i.onStateChange(t=>{this.getModelEvents().publish({event:"toolbar_update_command",data:{commandID:e.ID,data:{icon:{iconName:e.icon,fontIconFamily:1,className:t?"check-active":""}}}})}),t()},t)}else t()});return t.id=e.ClassName,t},loadTooltip:function(t){var i=Promise.resolve(),s=new e({allowUnsafeHTMLShortHelp:!1,allowUnsafeHTMLLongHelp:!0});return d[t.ID]=s,t.HelpResourceFile?(s.loadFromHelpRscFile(t.HelpResourceFile,t.ID),i=new Promise((e,n)=>{(function(e){return new Promise(t=>{var n=e.split("/"),i="i18n!"+n[0];n.splice(0,1),i+="/assets/help/"+n.join("/"),require([i],t,t)})})(t.HelpResourceFile).then(n=>{s.temp={title:n[t.ID+".Title"]},e()}).catch(n)})):t.ResourceFile&&(n.loadResource({resourceFile:t.ResourceFile,language:o.getLanguage()}),i=new Promise(e=>{n.onResourceLoaded({resourceFile:t.ResourceFile},function(){var n=this.getTitle({key:t.ID});s.setProperties({title:n}),s.temp={title:n,tooltip:n},e()})})),i.id=t.ID,i},getModelEvents:function(){},updateCommands:function(e,t){this._switchRunning=!0;let n=this._manageSwitchOfCommands(e,t);this.getModelEvents().publish({event:"check_command_availability",data:{nodes:t,commands:n}}),this._switchRunning=!1,this.getModelEvents().publish({event:"command_availability_updated",data:{nodes:t,treeNode:e}})},launchCommand:function(e,t,n,i){if(!function(e){var t=a.getCommandCheckHeader(e);return t&&t.setState(!t.getState()),!!t}(e)){var s=a.getCommands(e);(s.isEnabled()||"ContextualMenu"==i)&&(s._bkTempSelection=t?Array.isArray(t)?t:[t]:null,s.begin())}},getCommand:function(e){var t=a.getCommands(e);return t=t||a.getCommandCheckHeader(e)},_switchCommand:function(e,t){c=null;var n=this.getCommand(e);if(n)try{n._enableByWidget=t,t?n.enable():n.disable()}catch(n){console.error("Error "+(t?"enabling":"disabling"),e,n)}}}}),define("DS/IPClassifyUXUtil/utils/CancellablePromise",[],function(){class e{constructor(e){this._onCancel=null,this._chained=!1,this._cancelled=!1,this._queriesToCancel=[],e instanceof Promise?this._promise=e:this._promise=new Promise(e?e.bind(this):e=>{}),this._promise.catch(e=>{this._chained||console.log(e)})}_createChained(t){let n=new e(t);return n.addLinkedQuery(this),n}_innerCallback(e){if(!this.isCancelled()&&e){let t=[...arguments];t.shift(),e.apply(this,t)}}getPromise(){return this._promise}then(e,t){this._chained=!0;let n=t?this._innerCallback.bind(this,t):void 0,i=this._promise.then(this._innerCallback.bind(this,e),n);return this._createChained(i)}catch(e){let t=this._promise.catch(this._innerCallback.bind(this,e));return this._createChained(t)}finally(e){let t=this._promise.finally(this._innerCallback.bind(this,e));return this._createChained(t)}onCancel(e){this._onCancel=e}addLinkedQuery(e){e&&(this._cancelled&&e.cancel?e.cancel():this._queriesToCancel.push(e))}addLinkTo(e){return e.addLinkedQuery(this),this}cancel(){this._cancelled=!0,this._queriesToCancel.forEach(e=>{e.cancel&&e.cancel()}),this._queriesToCancel=[],this._onCancel&&this._onCancel()}isCancelled(){return this._cancelled}}return e.resolve=function(t){return new e(e=>e(t))},e.reject=function(t){return new e((e,n)=>n(t))},e.all=function(t){let n=[];t.forEach(e=>{let t=e instanceof Promise?e:e.getPromise();n.push(t)});let i=new e(Promise.all(n));return t.forEach(e=>{i.addLinkedQuery(e)}),i},e}),define("DS/IPClassifyUXUtil/ActionBar/BreadCrumbMenu",["UWA/Controls/Abstract","UWA/Class/Options","DS/UIKIT/DropdownMenu","DS/Controls/Button","DS/IPClassifyUtil/IPClassifyAlert","i18n!DS/IPClassifyUXUtil/assets/nls/IPClassifyUXUtil"],function(e,t,n,i,s,a){"use strict";return e.extend(t,{_dropDownCreated:!1,_dropdownElmt:null,_separator:null,_folderInfo:null,_subFolders:null,_activeIconFont:"",_unactiveIconFont:"",init:function({folderInfo:e,activeIconFont:t,unactiveIconFont:n,modelEvents:i}){this._parent.apply(this,arguments),this._folderInfo=e||null,this._activeIconFont=t||"fonticon-down-dir",this._unactiveIconFont=n||"fonticon-right-dir"},getSubFolder:function(e){return null===this._subFolders||e>=this._subFolders.length?null:this._subFolders[e]},addSubFolder:function(e,t){null===this._subFolders&&(this._subFolders=[]),t?this._subFolders.splice(0,0,e):this._subFolders.push(e),this._dropDownCreated=!1},removeSubFolder:function(e){if(null===this._subFolders||e>=this._subFolders.length)return!1;this._subFolders.splice(e,1);return this._dropDownCreated=!1,this._dropdownElmt&&this._dropdownElmt.isVisible&&this._dropdownElmt.hide(),!0},hide:function(){this._dropdownElmt&&this._dropdownElmt.isVisible&&(this._dropdownElmt.hide(),this._dropDownCreated=!1),this._separator&&this._separator.hide()},show:function(){this._separator&&this._separator.show()},isVisible:function(){return"none"!==this._separator.getStyle("display")},buildPathSeparatorElementBasic:function(){var e=this;return this._separator=UWA.createElement("div",{class:"separatorIdCard fonticon "+this._unactiveIconFont,styles:{cursor:"pointer"},events:{click:function(t){e._dropDownCreated||e._buildDropDownPath()}}}),this._separator},isMenu:function(){return this._unactiveIconFont.indexOf("menu")>=0},buildPathSeparatorElement:function(){if(this.isMenu()){var e=this,t=new i({displayStyle:"lite",icon:{iconName:"menu",fontIconFamily:1}});t.getContent().addEventListener("buttonclick",function(t){e._dropDownCreated||e._buildDropDownPath()}),this._separator=t.getContent()}else this._separator=this.buildPathSeparatorElementBasic();return this._separator},flush:function(){this._clearDropDown,this._dropDownCreated=!1,this._subFolders=null},_clearDropDown:function(){this._dropdownElmt&&(this._dropdownElmt.destroy(),this._dropdownElmt=null)},_buildDropDownPath:function(){var e=this;if(null===this._subFolders&&null===this._folderInfo)return null;this._clearDropDown(),this._subFolders?(e._dropDownCreated=!0,this._buildDomDropdownElmt(this._subFolders)):this._folderInfo.getChildrenInfos({onComplete:function(t){e._dropDownCreated=!0,e._buildDomDropdownElmt(t)},onFailure:function(t){e._dropDownCreated=!1,s.displayNotification({message:a.get("breadcrumb_expandError"),className:"error"})}})},_buildDomDropdownElmt:function(e){var t=this,i=[];e.length>0&&(e.forEach(function(e){i.push({text:e.getLabel(),title:e.getLabel(),handler:function(){t._callExpandAndSelectRequest(e.getID(),e.getType(),e.getLabel())}})}),this._dropdownElmt=new n({target:this._separator,className:"folder_ctx_menu",items:i,position:"bottom left"}),this.isMenu()||this._dropdownElmt.addEvents({onShow:function(){t._separator.removeClassName(t._unactiveIconFont),t._separator.addClassName(t._activeIconFont)},onHide:function(){t._separator.removeClassName(t._activeIconFont),t._separator.addClassName(t._unactiveIconFont)}}),this._checkSizeOverflowDropdownMenu(),this._dropdownElmt.show())},resizeWidgetCallback:function(){this._dropdownElmt&&this._dropDownCreated&&(this._dropDownCreated=!1,this.isVisible()&&this._dropdownElmt.hide())},_checkSizeOverflowDropdownMenu:function(){var e,t,n,i,s,a,o,l,r,c,d;if(!this._dropdownElmt)return!1;a=this._dropdownElmt.elements.container,e=(o=this._dropdownElmt.options).target,n=document.documentElement.clientHeight||window.innerHeight,s=document.documentElement.clientWidth||window.innerWidth,a.isInjected()||(this._dropdownElmt.inject(o.renderTo?o.renderTo:document.body),a.setStyle("display","")),t=a.offsetHeight,i=a.offsetWidth,t>(l=n-(c=e.getOffsets().y+e.offsetHeight)-20>0?n-c-20:n-c)&&(a.setStyle("height",l),a.setStyle("overflow-y","auto"),i+=20,a.setStyle("width",i)),i>(r=s-(d=e.getOffsets().x+e.offsetWidth)-20>0?s-d-20:s-d)&&a.setStyle("width",r)},_callExpandAndSelectRequest:function(e,t,n){this.options.modelEvents.publish({event:"select_breadcrumb_object",data:{id:e,type:t,name:n}})}})}),define("DS/IPClassifyUXUtil/IPConfirmationDialog",["DS/WebappsUtils/WebappsUtils","DS/Windows/Dialog","DS/Controls/Button","css!DS/IPClassifyUXUtil/IPClassifyUXUtil.css"],(e,t,n)=>({confirmDialog:function({className:i,id:s,immersiveFrame:a,title:o,message:l,details:r,type:c,buttonLabels:d}){let u=null,h=u=UWA.createElement("div");if("warning"===c){let t=e.getWebappsAssetUrl("IPClassifyUXUtil","icons/warning.png");UWA.createElement("img",{src:t,width:"35px",height:"30px"}).inject(h),u=UWA.createElement("div",{class:"textContainer"}).inject(h)}return l.split("\n").forEach(e=>{UWA.createElement("div",{class:"confirmMessage",text:e}).inject(u)}),UWA.createElement("div",{text:r}).inject(u),new Promise((e,l)=>{let r=new t({modalFlag:!0,domId:s,immersiveFrame:a,title:o,content:h,activeFlag:!1,buttons:{No:new n({label:d&&d.No,onClick:function(e){r.close(),l()}}),Yes:new n({label:d&&d.Yes,onClick:function(t){r.close(),e()}})}});r.getContent().addClassName("IPConfirmDialog"),i&&r.getContent().addClassName(i)})}})),define("DS/IPClassifyUXUtil/IPClassifyConfirmation",["UWA/Class","DS/ENOFloatingPanel/ENOFloatingPanel","DS/IPClassifyUX/utils/LoadCssUtil","DS/Windows/ImmersiveFrame","DS/Windows/Dialog","DS/Controls/Toggle","DS/Controls/Button","DS/Core/WebUXGlobalEnums","DS/WebappsUtils/WebappsUtils","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/TreeModel/DataModelSet","DS/DataGridView/DataGridView","i18n!DS/IPClassifyUXUtil/assets/nls/IPClassifyUXUtil","DS/UIKIT/Input/Button"],function(e,t,n,i,s,a,o,l,r,c,d,u,h,m,p){return e.singleton({name:"Library Confirmation",confirmModal:null,launch:function(e,n,i,s){var a=e.title,o=e.content?e.content:e.contentTxt?e.contentTxt.escapeHTML():"",l=this,r=o||"Are you sure?",c=document.createElement("div"),d=new p({value:e.confirmLabel||m.confirmation_ok,className:"primary"}).inject(c);!0!==e.noClose&&new p({value:e.cancelLabel||m.confirmation_cancel}).inject(c).addEvent("onClick",function(e){s&&s(e),l.confirmModal._close()});var u=!1;d.addEvent("onClick",function(e){u=!0,n&&n(e),l.confirmModal._close()}),l.confirmModal=new t({className:"command_dialog move",title:a,footer:c,body:r,overlay:!0,closable:!0!==e.noClose,animate:!0,resizable:!1,autocenter:!0,visible:!0,events:{onClose:function(){!u&&i&&i(event),this.destroy()}},limitParent:!0}),l.confirmModal.inject(widget.body)},confirmDialog:function(e,t,c,d,u){var h=this,p=r.getWebappsAssetUrl("IPClassifyUX","css/confirmationPanel.css");n._loadCSS(p),h.immersiveFrame=new i({}),h.components={},h.components.dialogContent=UWA.createElement("div",{class:"dialogContent",styles:{display:"flex","flex-direction":"column",height:"100%"}}),h.components.mainContainer=UWA.createElement("div",{class:"MainContainer",styles:{display:"flex","flex-direction":"column"}}).inject(h.components.dialogContent),h.components.mainContainerContent=UWA.createElement("div",{class:"mainContainerContent",styles:{display:"flex","margin-bottom":"6px"}}).inject(h.components.mainContainer),h.components.mainContainerFooter=UWA.createElement("div",{class:"mainContainerFooter"}).inject(h.components.mainContainer),h.components.warningImageContainer=UWA.createElement("div",{class:"warningImageContainer",styles:{margin:"5px","white-space":"normal"}}).inject(h.components.mainContainerContent),h.components.warningImageSrc=r.getWebappsAssetUrl("IPClassifyUXUtil","icons/warning.png"),h.components.warningImage=UWA.createElement("img",{src:h.components.warningImageSrc,class:"Delete-Dialog-WarningImage",alt:"Warning Image",width:"35px",height:"30px"}).inject(h.components.warningImageContainer),h.components.warningTextContainer=UWA.createElement("div",{class:"warningTextContainer",styles:{display:"flex","flex-direction":"column","flex-grow":"1","white-space":"normal"}}).inject(h.components.mainContainerContent),h.components.warningHeaderMsg1=UWA.createElement("div",{class:"warningHeaderMsg1",text:e.warningMessage?e.warningMessage+"<br>":"",styles:{color:"#3d3d3d","font-size":"12px","flex-grow":"1","margin-bottom":"6px"}}).inject(h.components.warningTextContainer),h.components.warningHeaderMsg1.innerHTML=e.warningMessage?e.warningMessage+"<br>":"",h.components.warningHeaderMsg2=UWA.createElement("div",{class:"warningHeaderMsg2",text:e.warningInfo?e.warningInfo:"",styles:{"white-space":"normal","flex-grow":"1","margin-bottom":"4px"}}).inject(h.components.warningTextContainer),h.components.warningText=UWA.createElement("div",{class:"warningText",styles:{"white-space":"normal","flex-grow":"1"}}).inject(h.components.warningTextContainer),h.components.warningText.innerHTML=e.moreInfo?e.moreInfo:"",h.components.confirmationDiv=UWA.createElement("div",{class:"confirmationBox",styles:{display:"flex","white-space":"normal","flex-grow":"1"}}).inject(h.components.warningTextContainer),h.components.confirmationToggle=new a({type:"checkbox",value:0,checkFlag:!1,domId:"confirmationToggle"}).inject(h.components.confirmationDiv),h.components.confirmationText=UWA.createElement("div",{class:"confirmationText",text:e.confirmationBoxText?e.confirmationBoxText:m.checkboxMsg}).inject(h.components.confirmationDiv),h.components.confirmationText.onclick=function(){0==h.components.confirmationToggle.checkFlag?h.components.confirmationToggle.checkFlag=!0:h.components.confirmationToggle.checkFlag=!1},e.enableConfirmationBox?h.components.confirmationToggle.addEventListener("change",function(e){var t=e.dsModel;h.components.myDialog.buttons.Yes.disabled=!t.checkFlag}):h.components.confirmationDiv.hide(),e.showDGV&&h.prepareDGV(e),h.components.myDialog=new s({immersiveFrame:h.immersiveFrame,domId:"Delete-Dialog",title:e.titleLabel?e.titleLabel:m.confirmation_delete,content:h.components.dialogContent,activeFlag:!1,modalFlag:!0,resizableFlag:!1,buttons:{Yes:new o({label:e.deleteButtonLabel?e.deleteButtonLabel:m.confirmation_delete,domId:"Dialog-DeleteButton",disabled:!!e.enableConfirmationBox,onClick:function(e){e.dsModel.dialog.destroy(),h.immersiveFrame.destroy(),e.dsModel=null,t&&t(d)},role:l.WUXCustomButtonRoleEnum.Validate}),Cancel:new o({label:m.confirmation_cancel,onClick:function(e){c&&c(u),e.dsModel.dialog.destroy(),h.immersiveFrame.destroy(),e.dsModel=null}})}}),h.components.myDialog.width=500,h.components.myDialog.addEventListener("close",e=>{c&&c(u),e.dsModel.dialog&&e.dsModel.dialog.destroy(),h.immersiveFrame.destroy(),e.dsModel=null}),h.immersiveFrame.inject(widget.body)},prepareDGV:function(e){var t=e.data,n=e.cols,i=new u,s=new c({dataModelSet:i});s.prepareUpdate();for(var a=0,o=t.length;a<o;a++){var l=t[a],r=d.createTreeNodeDataModel(i,{label:l.tree,grid:l});s.addChild(r)}s.expandAll(),s.pushUpdate(),this.components.gridView=UWA.createElement("div",{class:"DeleteDialog-gridview",styles:{"min-height":"90px","margin-bottom":"5px",position:"relative",height:"100%"}});var m=new h({identifier:"DeleteDialog-gridview",treeDocument:s,columns:n,showSelectionCheckBoxesFlag:!1,showOutlineFlag:!0});m.maxVisibleRowCount=6,this.components.gridView.inject(this.components.dialogContent),m.inject(this.components.gridView)}})}),define("DS/IPClassifyUXUtil/ajaxRequests/wwwAjaxRequests",["DS/EditPropWidget/ajaxRequests/ServicesAjaxRequests","DS/EditPropWidget/constants/EditPropConstants","DS/WebappsUtils/WebappsUtils","DS/PADServices/utils/GlobalModelEvents","i18n!DS/IPClassifyUXUtil/assets/nls/IPClassifyUXUtil"],function(e,t,n,i,s){"use strict";function a(){return n.getWebappsAssetUrl("IPClassifyUXUtil","icons/I_LinkTemp.png")}return{commitModels:async function(e){var t=e.modelList,n=t.length;if(1===n&&t[0].get("type")&&t[0].get("type").contains("Document Proxy"))require(["DS/ENOXAttachmentsUX/ajaxRequests/DocPropertiesModel"],function(t){t.commitModels(e)});else if(n){let n=t[0],a=n.changedValues.Title,o=n.changedValues.URL,l=a?a.valueDB:null,r=o?o.valueDB:null,c=n.get("objectId"),d=n.getAllAttributes().URL.select;e.headers={Accept:"application/json"},e.model=n,e.withSC=!0,e.withChange="silent",e.source="3DSpace";var s={};if(s.id=d,s.url=r,r){const e=/^[A-Za-z]+:/;s.url=e.test(r)?r:`https://${r}`}s.urlTitle=l,s.members=[c],s.contentID=c,s.securityContext=e.securityContext,require(["DS/FolderEditor/service/FolderServices"],function(t){t.editExternalLink(s).then(t=>{let a={results:[]},o={};if(t.error)a.UXMessage=[t.error.message?t.error.message:""];else{let e=s.url?s.url:n.get("URL").valueDB,l=s.urlTitle?s.urlTitle:n.get("Title").valueDB,r=t.contents[0].id;o[s.contentID]={attributes:{id:r,label:l},options:{grid:{uri:e,id:r,appdata:l,Link:e},resourceid:r,label:l}},n.set("objectId",r),i.publish({event:"updateContentNodes",data:{items:o}}),a.results.push({status:200,body:{physicalid:r,Title:{selectable:"Title",name:"Title",value:[l]},URL:{selectable:"URL",name:"URL",value:[e]},url:"model/bus/"+r,errors:[]}})}e.onComplete(a)}).catch(t=>{console.log(t),e.onComplete({results:[],UXMessage:[""]})})})}},checkFacetsVisibility:function(e){var n={};let i=!1;e.facets.every(e=>!(i=e.name===t.FACET_PROPERTIES));let a=null;i&&!e.model.isMergedModel()?n[t.FACET_PROPERTIES]=!0:a={message:s.www_multisel_forbidden};let o={id:e.model.get("objectId"),facets:n,notification:a};e.onComplete.call(this,o)},getListOfAttributes:function(t){var n=t.modelList,i=n.length;if(1===i&&n[0].get("type")&&n[0].get("type").contains("Document Proxy"))require(["DS/ENOXAttachmentsUX/ajaxRequests/DocPropertiesModel"],function(e){e.getListOfAttributes(t)});else if(1===i&&!n[0].isMergedModel()){let i=n[0],l=i.get("objectId");t.headers={Accept:"application/json"};var o="/resources/v1/FolderManagement/Folder/"+l+"/getlinkProperties";t.model=i,t.withSC=!0,t.withChange="silent",t.source="3DSpace",t.onCompleteWS=(e=>{var n={options:{autoExpand:!1},results:[{computed:{label:{path:"Title",name:"Title",value:[e.Title]}},data:[{path:"Title",nls:s.get("Title"),maxlength:0,name:"Title",readOnly:!1,type:"string",value:[e.Title],mandatory:!0,UIPosition:2},{path:"URL",select:e.OwnerID,nls:s.get("URL"),maxlength:0,name:"URL",readOnly:!1,type:"string",value:[e.URL],mandatory:!0,UIPosition:3}],physicalID:e.id,metatype:"bus",type:"VaultedObjectsLink",type_icon_large_url:a(),PLMParametersAvailable:!1,preview_url:"",success:!0,modifyAccess:!0,groupData:[]}]};t.onComplete(n)}),e.createRequest(t,"GET",o,void 0)}},getPreviewUrl:function(e){var t=[];t.push({id:e.modelList[0]._attributes.objectId,preview:a()}),e.onComplete(t)}}}),define("DS/IPClassifyUXUtil/tagger/IPWebInWinTaggerProxy",["DS/TagNavigatorProxy/TaggerWebInWinProxy","UWA/Core","DS/CoreEvents/ModelEvents"],function(e,t,n){"use strict";return e.extend(n,{init:function(e){e.proxyId=e.widgetId+e.name,this._parent.call(this,e)},_dispatchEvent:function(e){if(!t.is(e,"object")||!t.is(e.notif_name)||void 0===e.notif_parameters)throw console.log("E_INVALIDARG, expect to have parameters.notif_name arg & parameters.notif_parameters in _dispathTowin !!!"),"No parameters.notif_name arg & parameters.notif_parameters given to _dispathTowin method !";console.log("ResultWebInWin._dispathTowin for "+e.notif_name);var n=t.is(e.notif_parameters,"string")?e.notif_parameters:JSON.stringify(e.notif_parameters);"undefined"!=typeof dscef&&dscef.sendString(e.notif_name+"="+n)},getProxyId:function(){return this._proxyId}})}),define("DS/IPClassifyUXUtil/private/CredentialsConverter",[],function(){"use strict";function e(e,t,n,i){return i?e+o+a+o+n:e+o+a+o+t+o+a+o+n}function t(e){var t="",n="",i="",s="";for(var a in e){var o=e[a];switch(a){case"organization":t=o.name,n=o.title?o.title:t;break;case"role":i=o.name,s=o.nls?o.nls:i}}return{org:t,orgNls:n,role:i,roleNls:s}}function n(e,t,n){return"ctx::"+n+"."+t+"."+e}var i=["VPLMProjectLeader","3DSRestrictedLeader","VPLMCreator","3DSRestrictedAuthor","VPLMExperimenter","3DSRestrictedContributor","VPLMViewer","3DSRestrictedReader","VPLMProjectAdministrator","3DSRestrictedOwner","VPLMAdmin"];function s(e,t){var n=10,s=i.indexOf(e.role);t&&(e.cs===t.cs&&(n=2,e.org===t.org&&(n=1,e.role===t.role&&(n=0))));return{secuCtx:n,role:s}}var a="",o=" ";return{computeCredentials:function(i,a,o){var l,r,c,d=i.pid,u=[],h=null;if(i.preferredcredentials){var m=i.preferredcredentials.collabspace;l=m?m.name:null;var p=i.preferredcredentials.organization;r=p?p.name:null;var f=i.preferredcredentials.role;c=f?f.name:null,l&&r&&c&&(h=n(l,r,c))}var g,v,b=function(e){for(var n=[],i=0;i<e.collabspaces.length;i++)for(var s=e.collabspaces[i],a=0;a<s.couples.length;a++){var o=t(s.couples[a]);-1===n.indexOf(o.org)&&n.push(o.org)}return 1===n.length}(i),C=null;a&&(g=a.match("(ctx::)?([^.]*).([^.]*).(.*)"),v=null,g&&(v={role:g[2],org:g[3],cs:g[4]}),C=v);for(var _=null,y=!1,w=0;w<i.collabspaces.length;w++)for(var S=i.collabspaces[w],I=0;I<S.couples.length;I++){var x=t(S.couples[I]),P=n(S.name,x.org,x.role),D=S.title?S.title:S.name,E=e(D,x.orgNls,x.roleNls,b),U=x;U.cs=S.name,U.csNLS=D,U.preferred=P===h,U.priority=s(U,C),y=y||0===U.priority.secuCtx,o&&1===U.priority.secuCtx&&(U.priority.secuCtx=0),(!_||_.priority.secuCtx>U.priority.secuCtx||_.priority.secuCtx===U.priority.secuCtx&&(U.preferred||!_.preferred&&_.priority.role>U.priority.role))&&(_=U),U.translate={label:E,value:P},u.push(U)}return u.sort((e,t)=>e.translate.label.localeCompare(t.translate.label)),{userId:d,defaultMatches:y,credential:_&&_.translate?_.translate.value:null,credentials:u}}}}),define("DS/IPClassifyUXUtil/ProgressPaneExecution",["UWA/Core","DS/IPClassifyUXUtil/ProgressPaneImpl","UWA/Controls/Abstract","i18n!DS/IPClassifyUXUtil/assets/nls/ProgressPaneCommands","DS/IPClassifyUXUtil/utils/CancellablePromise"],function(e,t,n,i,s){"use strict";var a,o=0;return n.singleton({name:"doco-jobs",init:function(){null==a&&(a=new t).inject(widget.body)},latestJobId:0,title:"Remove",_current:[],_queue:[],_nextInLine:0,launchNext:function(){if(this._current.length<6){var e=this._queue.shift();if(e)if(this._nextInLine=e,0==e.progress.cancelled){let t=e.query.call(null,e.params),n=t.then(t=>{e.answers.push(t)}).catch(e=>{console.log(e)});t instanceof s&&(t.onCancel(()=>{}),t.addLinkedQuery({cancel:()=>{e.answers.push({contents:[],inProgress:!0,sorted:!1}),e.progress.progressBar.update(i.Cancelled)}})),n.finally(()=>{e.progress.progressBar.update(),this.launchNext()})}else this._queue.shift(),this.launchNext();else this.finishJob()}},execute:function({title:e,isSearchquery:t,data:n,datas:i,query:s}){n&&(i=[n]);var a=this.createProgress(e,i.length);let o=[];var l=new Promise((e,t)=>{i.forEach(e=>{let t={...arguments[0]};t.progress=a,t.promise=l,t.answers=o,t.params=e,this._queue.push(t)}),a.progressBar.addEventListener("onEnd",n=>{n.isSearchQueryChanged?t():e(o)})});return this.launchNext(),l},launchPanel:function(e,t,n,i){return this.execute({title:e,datas:t,query:e=>n(e,i)})},finishJob:function(){setTimeout(function(){0==a.getContent().getChildren()[1].getChildren().length&&a.hide()},t.destroyTimeout)},cancelProgress:function(e){if(this._queue.length>=1||this._nextInLine){let e=[...this._queue];0==this._queue.length&&this._nextInLine&&!this._nextInLine.progress.completed&&(e=[this._nextInLine]),e.forEach(e=>{e.isSearchquery&&(e.progress.progressBar.update(i.searchQueryChanged),this._queue.shift())})}0==this._queue.length&&this.finishJob()},createProgress:function(e,t){var n=++o,i={count:0,id:n,cancelled:!1};return a.addProgress(n,{progressObj:i,max:t,count:t,title:e,cancel:!0}),i}})}),define("DS/IPClassifyUXUtil/ObjectsSelectionPanel",["UWA/Core","UWA/Controls/Abstract","UWA/Class/Promise","DS/PADServices/utils/GlobalUtils","DS/IPClassifyUXUtil/private/ObjectsSearchInput","DS/UIKIT/Iconbar","DS/Controls/Button","DS/Controls/Loader","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/DataGridView/DataGridView","DS/DataGridView/DataGridViewLayout","DS/Utilities/Utils","DS/Windows/ImmersiveFrame","DS/Windows/Panel","i18n!DS/IPClassifyUXUtil/assets/nls/IPClassifyUXUtil"],function(e,t,n,i,s,a,o,l,r,c,d,u,h,m,p,f){"use strict";return t.extend({name:"ipclassify-objselection",defaultOptions:{selectedObjects:[],modelEvents:null,objectsView:null,objectsModel:null,objectsGrid:null,toolbar:null,dgvOptions:{defaultColumnDef:{width:"auto",typeRepresentation:"string"},showRowBorderFlag:!0,alternateBackgroundFlag:!1,placeholder:"",rowSelection:"none",cellSelection:"none",columns:[]},dgvLayoutOptions:{cellHeight:26,columnHeaderHeight:32,rowsHeader:!1}},init:function(t){this._parent(t),this.objectsToSkip=t.objectsToSkip||[],this.objectDataProvider=t.dataProvider,this.placeHolder=t.dataProvider.fetchPlaceHolder(),this.columnsData=t.dataProvider.fetchColumns(),this.checkBoxColumn=this.columnsData.checkBoxColumn,this.objectIdentifier=this.columnsData.objectIdentifier,this.newAttributeUI=t.newAttributeUI;var n=this;this.isReadOnly=t.isReadOnly;n.elements.container=e.createElement("div",{class:n.getClassNames("-immersivePanel")});var i=new m({});new p({immersiveFrame:i,title:t.panelHeader,content:n.elements.container,position:{my:"center",at:"center",of:i},height:400,width:800,resizableFlag:!0}).addEventListener("close",function(e){n.options.modelEvents.publish({event:n.options.cancelOrCloseEventName,data:{restore:!0}})}),n._buildBody().then(n._buildFooter.bind(n)).done(function(){n.__setToolbarCmds(),e.is(n.elements.loader)||(n.elements.loaderDiv=e.createElement("div",{class:n.getClassNames("-loader")}).inject(n.elements.content),n.elements.loader=(new l).inject(n.elements.loaderDiv),n.elements.loader.getContent().addClassName("ipobjselect-loader")),n.elements.loaderDiv.removeClassName("hidden"),n.elements.nextButton.disabled=!0,n.elements.loader.on(),n._buildObjectsView().then(function(){n.elements.loaderDiv.addClassName("hidden"),n.elements.loader.off()}),n.options.modelEvents.publish({event:n.options.cancelOrCloseEventName,data:{html:i}})})},destroy:function(){this.options.toolbar.destroy(),this.options.objectsGrid.destroy(),this.options.objectsGrid=null,this._parent()},_buildBody:function(){var t=this;return new n(function(n,i){var s=e.createElement("div",{class:t.getClassNames("-toolbar-container")}).inject(t.elements.container);t.elements.content=e.createElement("div",{class:t.getClassNames("-content")}).inject(t.elements.container),t._generateToolbar({renderTo:s}),n()})},_buildFooter:function(){var t=this;return new n(function(n,i){t.elements.footer=e.createElement("div",{class:t.getClassNames("-footer")}).inject(t.elements.container);var s=t.elements.nextButton=new o({label:t.options.okButtonLabel||"Add",emphasize:"primary",touchMode:!0});s.addEventListener("buttonclick",function(){t.options.modelEvents.publish({event:t.options.okEventName,data:{selectedObjects:t.options.selectedObjects}}),t.options.modelEvents.publish({event:t.options.cancelOrCloseEventName,data:{restore:!0}}),t.destroy()}),s.inject(t.elements.footer);var a=t.elements.closeButton=new o({label:t.options.cancelButtonLabel||"Cancel",emphasize:"secondary",touchMode:!0});a.addEventListener("click",function(){t.options.modelEvents.publish({event:t.options.cancelOrCloseEventName,data:{restore:!0}}),t.destroy()}),a.inject(t.elements.footer),n()})},_buildObjectsView:function(){var t=this;return new n(function(n){t.options.objectsView=e.createElement("div",{class:t.getClassNames("-objectsView ipclassify-objselection-chooser-view")});var s=e.createElement("div",{class:t.getClassNames("-objectsView-Dgv ipclassify-objselection-dgv-container")}).inject(t.options.objectsView);t.columnsData&&t.columnsData.columns&&(t.options.dgvOptions.columns=t.columnsData.columns),t.placeHolder&&(t.options.dgvOptions.placeholder=t.placeHolder);var a=e.extend({identifier:"ObjectsSelectionPanel-"+i.uid()},e.clone(t.options.dgvOptions));a.layout=new u(t.options.dgvLayoutOptions);var o=t.options.objectsGrid=new d(a);o.onContextualEvent=function(){return[]},o.getCellTooltip=function(e){var n=t.options.objectsGrid.getColumnOrGroup(e.columnID),i=n.dataIndex;return e.dataIndex=i,-1===e.rowID?{shortHelp:n.tooltip,updateModel:!1}:"tree"==i?{shortHelp:e.nodeModel.getLabel(),updateModel:!1}:{shortHelp:e.nodeModel.options.grid[i],updateModel:!1}}.bind(this),t.options.objectsModel=new r({}),o.treeDocument=t.options.objectsModel,o.getContent().addClassName("ipobjselectdatagridview loading"),o.getContent().inject(s),t.options.objectsView.inject(t.elements.content),o.onReady(function(){t._updateObjectsViewModel().then(function(){o.getContent().removeClassName("loading"),o.sortModel=t.objectDataProvider.initialSortModel(),n()}),o.addEventListener("change",t._changeGridObjects.bind(t))})})},_changeGridObjects:function(e,t){var n=this.options.objectsGrid;if(t&&t.nodeModel&&t.nodeModel.options.grid&&n.layout.getDataIndexFromColumnIndex(t.columnID)===this.checkBoxColumn){for(var i=-1,s=0,a=this.options.selectedObjects.length;-1===i&&s<a;){if(this.options.selectedObjects[s].name===t.nodeModel.getReferenceValue(this.objectIdentifier)){i=s;break}s++}!0===t.nodeModel.options.grid[this.checkBoxColumn]?-1===i&&this.options.selectedObjects.push({name:t.nodeModel.getReferenceValue(this.objectIdentifier)}):-1!==i&&this.options.selectedObjects.splice(i,1),a=this.options.selectedObjects.length,this.elements.nextButton.disabled=0===a}},_generateToolbar:function(t){var n=this,i=h.debounce(function(e){n.options.objectsModel.withTransactionUpdate(function(){var t=e.searchStr,i=!0;n.options.filterInProgress=!0,n.options.objectsModel.search({match:function(e){var s=!0;if(n.currentSelectFilter){var a=e.nodeModel.getReferenceValue(n.checkBoxColumn);"selected"==n.currentSelectFilter&&0==a?s=!1:"unselected"==n.currentSelectFilter&&1==a&&(s=!1)}n.objectDataProvider.searchMatchCriteria(t,e)&&s?(e.nodeModel.show(),t.length>0&&i?(e.nodeModel.select(!0),e.nodeModel.matchSearch(),i=!1):(e.nodeModel.unmatchSearch(),e.nodeModel.unselect())):(e.nodeModel.unmatchSearch(),e.nodeModel.unselect(),e.nodeModel.hide())}}),n.options.filterInProgress=!1}),n.options.objectsModel.getXSO().onPostAdd(function(){}),n.options.objectsModel.getXSO().onPostRemove(function(){})},500);this.elements.toolbar=e.createElement("div",{class:this.getClassNames("-toolbar")}).inject(t.renderTo);var a=e.createElement("div",{class:this.getClassNames("-toolbar-input")}).inject(this.elements.toolbar);this.elements.toolbarIconbar=e.createElement("div",{class:this.getClassNames("-toolbar-iconbar")}).inject(this.elements.toolbar),this.elements.toolbarSearch=new s({events:{onSearch:i}}).inject(a)},__setToolbarCmds:function(){var e=this;e.currentSelectFilter="none";var t,n=function(){e.options.objectsModel.withTransactionUpdate(function(){for(var t=document.querySelector(".ipobjects-search-input-input"),n=e.options.objectsModel.getRoots(),i=e.currentSelectFilter,s=0;s<n.length;s++){var a=!0;switch(t&&""!=t.value&&(a=e.objectDataProvider.searchMatchCriteria(t.value,n[s]._getNodeInfos())),i){case"none":a?n[s].show():n[s].hide();break;case"selected":!0===n[s].getReferenceValue(e.checkBoxColumn)&&a?n[s].show():n[s].hide();break;case"unselected":!1===n[s].getReferenceValue(e.checkBoxColumn)&&a?n[s].show():n[s].hide()}}}),e.options.objectsModel.getXSO().onPostAdd(function(){}),e.options.objectsModel.getXSO().onPostRemove(function(){})},i={fonticon:"filter",text:f.ObjectsSelectionPanel_FilterRows||"Filter Rows",name:"filter",content:{type:"dropdownmenu",options:{items:[{fonticon:"block",text:f.ObjectsSelectionPanel_FilterNone||"Show All",name:"none",selectable:!0,selected:!0},{fonticon:"checkbox-on",text:f.ObjectsSelectionPanel_FilterSelected||"Show selected",name:"selected",selectable:!0},{fonticon:"checkbox-off",text:f.ObjectsSelectionPanel_FilterNotSelected||"Show not selected",name:"unselected",selectable:!0}],events:{onClick:function(t,i){!function(t){e.currentSelectFilter=t;var i=document.querySelector("ul.iconbar-items-wrap.iconbar-items-icons li[name='filter']");i&&("selected"==t||"unselected"==t?i.classList.add("active"):i.classList.remove("active")),n()}(i.name)},onClickOutside:function(t,n){var i=document.querySelector("ul.iconbar-items-wrap.iconbar-items-icons li[name='filter']");i&&("selected"==e.currentSelectFilter||"unselected"==e.currentSelectFilter?i.classList.add("active"):i.classList.remove("active"))}}}}},s={fonticon:"plus",text:f.ObjectsSelectionPanel_NewAttributes||"New Attributes",name:"newAttributes",content:{type:"dropdownmenu",options:{items:[{id:"string",name:"String",text:f.ObjectsSelectionPanel_ATTRIBUTE_string||"String",selectable:!0,selected:!0},{id:"integer",name:"Integer",text:f.ObjectsSelectionPanel_ATTRIBUTE_integer||"Integer",selectable:!0},{id:"real",name:"Double",text:f.ObjectsSelectionPanel_ATTRIBUTE_real||"Real",selectable:!0},{id:"boolean",name:"Boolean",text:f.ObjectsSelectionPanel_ATTRIBUTE_boolean||"Boolean",selectable:!0},{id:"date",name:"Date",text:f.ObjectsSelectionPanel_ATTRIBUTE_date||"Date",selectable:!0},{id:"attrWithDim",name:"DoubleWithDim",text:f.ObjectsSelectionPanel_ATTRIBUTE_attrWithDim||"Attribute with dimension",selectable:!0}],events:{onClick:function(t,n){(new e.newAttributeUI).loadAttrCreatePanel({attrType:n.name,container:e.elements.container,changeGridObjects:e._changeGridObjects.bind(e),grid:e.options.objectsGrid})}}}}},o=(f.ObjectsSelectionPanel_ImportAttributes,{className:"divider"});if(!this.options.toolbar){t=[o,s,o,i];var l={renderTo:this.elements.toolbarIconbar,items:t};this.options.toolbar=new a(l),this.options.toolbar.elements.container.setStyle("display",void 0)}},_updateObjectsViewModel:function(){var e=this;return new n(function(t){e.objectDataProvider.fetchTheObjects().then(function(n){(n.objectsList||[]).forEach(function(t){if(!e.objectsToSkip[t.grid[e.objectIdentifier]]){var n=new c({label:t.label,icons:t.icons,grid:t.grid});e.options.objectsModel.addRoot(n,void 0)}}),t({})})})}})}),define("DS/IPClassifyUXUtil/service/IPClassifyUXUtilWebService",["UWA/Core","DS/WAFData/WAFData","DS/IPClassifyUtil/IPClassifyUtility","DS/PADUtils/PADSettingsMgt","DS/PADUtils/PADUtilsServices","DS/WidgetServices/WidgetServices","DS/IPClassifyUXUtil/utils/CancellablePromise","i18n!DS/IPClassifyUXUtil/assets/nls/IPClassifyUXUtil","DS/ClassificationProp/utils/ClassifPropControl"],function(e,t,n,i,s,a,o,l,r){"use strict";let c=void 0;let d=null;return{getCSRF:function(){return d=d||new Promise((e,t)=>{this._executeQuery("/resources/v1/application/E6WFoundation/CSRF",{type:"json",inSource:"3DSpace"},"getCSRF").then(t=>{if(200!==t.statusCode)throw{err:l.csrfError};e(t.csrf)}).catch(e=>{d=null,t(e)})})},splitIdForSearch:function(e,t,n){n=n||0;let i=e+":(",s=0,a=[];return t.forEach(t=>{s++;let o=i.length;(o+=n+8+t.length)>16e3||s>=1e3?(i+=")",a.push(i),i=e+":(",s=0):i+=(1!==s?" OR ":"")+'"'+t+'"'}),s>0&&(i+=")",a.push(i)),a},getUserPreferencesX:function({repository:e,preferences:t,withTenant:i,formatAnswer:s}){let a=null;return a=this._executeQuery("/resources/AppsMngt/user/getPreferences",{method:"GET",inSource:"3DCompass",withoutTenant:!0,query:{name:t[0]+(i?n.getTenantId():"")},headers:{SecurityContext:void 0}})},setUserPreferences:function({repository:e,preferences:t,withTenant:i}){let s=null;return s=t[0].value.length>8e3?o.reject(l.error_maxLimit_pref):this._executeQuery("/resources/AppsMngt/user/preference",{method:"PUT",inSource:"3DCompass",withoutTenant:!0,headers:{SecurityContext:void 0,"Content-Type":"application/x-www-form-urlencoded"},data:{name:t[0].name+(i?n.getTenantId():""),value:t[0].value}})},getUserPreferences:function(e){let t=e.repository?e.repository:widget.getValue("x3dAppId");return this.getUserPreferencesX({withTenant:e.withTenant,repository:t,preferences:[e.name],formatAnswer:function(e){return e}})},saveUserPreferences:function(e){let t=e.repository?e.repository:widget.getValue("x3dAppId"),n=t+"_"+e.name;this._lastPrefToSave||(this._lastPrefToSave={}),this._lastPrefToSave[n]=e,this._lastRequests||(this._lastRequests={}),this._lastRequests[n]&&this._lastRequests[n].cancel(),this._lastRequests[n]=null;var i=this._lastPrefToSave[n];let s=new o;return i&&(s=this._lastRequests[n]=this.setUserPreferences({withTenant:e.withTenant,repository:t,preferences:[{name:i.name,value:i.value}]}),delete this._lastPrefToSave[n]),s},getObjectContent:function(e){var t={};UWA.extend(t,e);var n=s.get3DSearchUrl()+"/search";t.payload={},t.payload.select_predicate=["physicalid"];var a=new Date,o=Math.random().toString(36).substring(2,9);t.payload.label=("getObjectContent"+o+"_"+a.getTime()).replace(new RegExp(" ","g"),"_").replace(new RegExp(",","g"),"").replace(new RegExp("/","g"),"-");var l=widget.lang?widget.lang:widget.getValue("lang");t.payload.start=0,t.payload.nresults=1e3,t.payload.locale=l,t.payload.tenant=s.getPlatformId(),t.payload.with_Idx_Search="true",t.payload.with_indexing_date="false",t.filters&&(t.payload.refine=t.filters),t.payload.login={"3dspace":{SecurityContext:i.getSetting("pad_security_ctx")}},t.headers={"content-type":"application/json"},t.data=UWA.Json.encode(t.payload),t.method="POST",t.timeout=12e4;let r=t.elementsPerSource;if(t.pid){var c=[...t.pid],d=c;Array.isArray(c)||(d=[c]),r=[{ids:d,source:"3dspace",serviceId:"3DSpace",key:"physicalid"}]}let u=[];return r.forEach(e=>{let t=e.ids,n=e.key;this.splitIdForSearch(n,t).forEach(t=>{u.push({query:t,source:e.source,serviceId:e.serviceId,key:e.key})})}),this._getObjectContent(n,t,u)},_getObjectContent:function(e,t,i){var s=null,a=new o((o,l)=>{let r=i.shift();r?(t.payload.query=r.query,t.payload.source=[r.source],t.data=UWA.Json.encode(t.payload),t.type="json",(s=this._executeQuery(e,t,"getObjectContent")).then(c=>{c.results&&c.results.forEach(e=>{e.query={source:r.source,serviceId:r.serviceId,key:r.key}}),(s=this._getObjectContent(e,t,i)).then(e=>{let t=n.concatJsonValue(e,c);o(t)}).catch(l),a.addLinkedQuery(s)}).catch(l)):o()});return a.addLinkedQuery(s),a.cancel=s?s.cancel:()=>{},a},getscandcollab:function(e){var t=null,i=new Promise((i,s)=>{t=a.get3DSpaceUrlAsync({platformId:e&&e.platformID?e.platformID:n.getTenantId(),onComplete:n=>{var a=e||{},o=n+"/resources/modeler/pno/person?select=preferredcredentials&select=collabspaces";a.query={current:!0},a.method="GET",a.headers={"Content-Type":"application/json"},a.cache=-1,a.withoutSC=!0,(t=this._executeQuery(o,a,"commands")).then(i).catch(s)}})});return i.cancel=(()=>{t&&t.cancel()}),i},_executeQuery:function(e,t,n){let i=[],s=null,l=null;t.inSource&&(s=function(e){let t=null,n=null;return e&&(n=new o(n=>{t=a._getServiceUrlAsync(e,{onComplete:n})})).addLinkedQuery(t),n||o.resolve()}(t.inSource)),t.withCSRF&&(l=this.getCSRF()),i.push(s),i.push(l);let r=new o((s,a)=>{Promise.all(i).then(i=>{let o=i[0],l=i[1];t.headers=t.headers?t.headers:{},o&&(e=o+e),l&&(t.headers[l.name]=l.value);var c;t.onTimeout=function(e){"object"!=typeof e&&(e={message:e}),e.timeout=!0,a(e)},t.onFailure=function(e,n){let i={err:e,serverErr:n};i=t.formatError?t.formatError(i):i,a(i)},t.onComplete=function(e){e=t.formatAnswer?t.formatAnswer(e):e,s(e)},c=this._executeRequest(e,t,n),r.addLinkedQuery(c)}).catch(a)});return r.addLinkedQuery(s),r},_executeQueryWithError:function(e,t,n){var i={};return UWA.extend(i,t),i.onComplete=function(e){let n=function(e){let t=null;return e.hasOwnProperty("errors")&&e.errors.every(e=>{let n="UNKNOWN_META"===e.code;if(n){let n="",i=e.reason.match(/\[([^]*)\]/);if(i){let e=i[1].split(".");n=e[e.length-1]}(t={...l.treeExpandUnknownMeta}).subtitle=l.replace(t.subtitle,{attrName:n})}return!n}),t}(e);n?t.onFailure(n):t.onComplete.apply(this,arguments)},this._executeRequest(e,i,n)},_executeRequest:function(e,n,a){var o=Math.round(1e3*Math.random()).toString(),d=widget.id+"_"+widget.getTitle()+"_";window.top.performance.mark("Request_begin"+o);var u={};UWA.extend(u,n),u.method=u.method?u.method:"GET",UWA.is(u.onTimeout,"function")||(u.onTimeout=function(){var e={type:"timeout",toString:function(){return l.msg_InfoAction_Timeout}};u.onFailure(e)},u.onComplete=function(e){window.top.performance.mark("LibraryRequest_end"+o);var t=window.top.performance.getEntriesByName("LibraryRequest_begin"+o);t&&1===t.length&&(window.top.performance.measure(d+"_Request"+a,"Request_begin"+o,"Request_end"+o),window.top.performance.clearMarks("Request_end"+o),window.top.performance.clearMarks("Request_begin"+o)),n.onComplete&&n.onComplete(e)});var h={Accept:"application/json","Accept-Language":widget.lang?widget.lang:widget.getValue("lang")};if(!n.withoutSC){c||(c=require(["DS/IPClassifyUXUtil/CredentialsView"]));let e="function"==typeof c.getCredential?c.getCredential():null;e||(e=i.getSetting("pad_security_ctx")||r.getContext()),e&&(h.SecurityContext=encodeURIComponent(e))}n.headers?u.headers=UWA.extend(h,n.headers):u.headers=h;var m=null;n.plmNewContextProvider&&"function"==typeof n.plmNewContextProvider&&(m=n.plmNewContextProvider())&&(h.SecurityContext=m),UWA.is(u.query)||(u.query={}),u.query.tenant||!0===n.withoutTenant||(u.query.tenant=s.getPlatformId());var p=e;return 0!==Object.keys(u.query).length&&(p+=(e.indexOf("?")<0?"?":"&")+UWA.Utils.toQueryString(u.query)),t.authenticatedRequest(p,u)}}}),define("DS/IPClassifyUXUtil/tagger/TaggerIPProxy",["DS/IPClassifyUXUtil/tagger/IPTaggerProxyAbstract","DS/WidgetServices/WidgetServices","DS/TagNavigatorProxy/TagNavigatorProxy","DS/IPClassifyUtil/IPClassifyUtility","DS/FedDictionaryAccess/FedDictionaryAccessAPI","DS/IPClassifyUXUtil/tagger/IPWebInWinTaggerProxy","DS/IPClassifyUXUtil/utils/CancellablePromise","DS/IPClassifyUXUtil/service/IPClassifyUXUtilWebService"],function(e,t,n,i,s,a,o,l){function r(){return"BookmarkEditor"+Math.random().toString(36).substring(2,9)}function c(e){if(matchingIds=[],e){var t=e.results;if(t)for(let e=0;e<t.length;++e){let n=t[e].attributes;for(let e=0;e<n.length;++e)if("resourceid"===n[e].name){matchingIds.push(n[e].value);break}}}return matchingIds}function d(e,t){let n=t[e];return n||e}var u="R2019x";function h(e){let n=function(e){var t={};return e&&e.forEach(e=>{if(e.sixw&&"date"!==e.type){let n=e.sixw.lastIndexOf("/"),i=n>0?e.sixw.substring(n+1):e.sixw;e.nlsKey=i;let s=t[i];s||(s=t[i]=[]),Array.isArray(e.object)?e.object.forEach(e=>s.push(e)):s.push(e.object)}}),t}(e);return new Promise(i=>{s.getNlsOfPropertiesValues(JSON.stringify(n),{tenantId:t.getTenantID(),lang:t.getLanguage(),apiVersion:u,onComplete:function(t){!function(e,t){e.forEach(e=>{if(e.nlsKey){let n=t[e.nlsKey];if(n){let t=[];Array.isArray(e.object)?e.object.forEach(e=>{t.push(d(e,n))}):t=d(e.object,n),e.dispValue=t}}})}(e,t),i()},onFailure:function(e){console.warn("IP Cannot retrieve NLS"),i()}})})}return class extends e{constructor(e,s){super(e),this._waitingPromises=[],this._filterTags={},this._onlyLocal=!0===s.onlyLocal,this._additionalProxies={},this._allIds=new Set,this._alreadyManagedIds={},this._isFocusOnObjects=!1,this._name=s.name;let o=!!window.widget&&!0===widget.getValue("noCompass"),l=null;"boolean"!=typeof(l=window.isReplayODT?t.getTenantID():i.getTenantId())&&null!=l||(l="OnPremise");let c={appId:widget.getValue("x3dAppId"),tenant:l,widgetId:window.widget&&widget.id?widget.id:r(),name:this._name,filteringMode:"FilteringOnServer"};for(var d in s)c[d]=s[d];let u=null;o?(window.widgetId||(window.widgetId=r()),c.widgetId=window.widgetId,c.events.addFilterChangeListener=this.onFilterBIFilteringEvent.bind(this),c.events.addCriteriaChangeListener=this.onFilterBIFilteringEvent.bind(this),u=this.taggerProxy=new a(c)):u=this.taggerProxy=n.createProxy(c),window.widget&&widget.addEvent("onResize",()=>{"fullscreen"!==widget.getView().type&&this.focusOnObjects()}),this.setTaggerProxy(u)}activate(e){this.resetTags(),super.activate(e),this.handleEvents()}async _concatFacets(e){var t={},n=e;return n.facets&&await h(n.facets),this._previousTags&&this._previousTags.facets&&(this._previousTags.facets.forEach(e=>{t[e.sixw+e.object]=e}),e.facets&&e.facets.forEach(e=>{let n=t[e.sixw+e.object];n?n.count+=e.count:t[e.sixw+e.object]=e}),n.facets=Object.values(t)),n.result,this._previousTags=n,n}async addTags(e){if(e){let t=new o(async t=>{t(await this._concatFacets(e))});t.then(e=>{this._setTags(e)}),this._waitingPromises.push(t)}}focusOnObjects(e){var t=widget.getView().type;e&&Object.keys(e).length>0&&"fullscreen"===t&&this.facetsComputationActives()?(this._selectionQuery=l.getObjectContent({elementsPerSource:e}),this._selectionQuery.then(async e=>{let t=function(e){var t={},n={};if(e)for(var i=0;i<e.length;i++){var s=e[i],a=s.attributes;let d=s.query,u=d.source,h=d.serviceId,m=d.key;var o=[];let p;for(var l=0;l<a.length;l++){var r=a[l];if("resourceid"==r.name)p=r.value;else if("ds6w_facet"==r.format){var c={};c.field=r.field,c.object=r.value,c.sixw=r.name,c.sources=[u],c.type=r.type,c.count=1,o.push(c)}}t[("physicalid"===m?"pid://":"")+p]=o,n[("physicalid"===m?"pid://":"")+p]=h}return{subjects:t,sources:n}}(e.results),n=e.facets;n&&await h(n),this._filter.setTags(t.subjects,n),this._filter.focusOnSubjects(Object.keys(t.subjects),void 0,t.sources),this._isFocusOnObjects=!0})):this._isFocusOnObjects&&(this._filter.unfocus(),this._isFocusOnObjects=!1,this.resetTags())}clearTags(){this._allIds=new Set,this._alreadyManagedIds={},this.cancelTagQuery(),this._waitingPromises.forEach(e=>{e.cancel()}),this._waitingPromises=[],this.removeTags()}removeTags(){this._setTags({facets:[]}),this._filter.unsetTags()}resetTags(){this._filter.setTags(null,this._previousTags?this._previousTags.facets:[])}_setTags(e){this._previousTags=e,e&&e.facets&&e.facets.length>0?this._filter.setTags(null,e.facets):this._filter.unsetTags()}cancelTagQuery(){this._tagQuery&&this._tagQuery.cancel(),this._tagQuery=null}reloadObjects(){this._allIds.forEach(e=>{this._alreadyManagedIds[e]=!0})}facetsComputationActives(){let e=!0,t=Object.values(this._additionalProxies);return t.length>0&&(e=!1,t.forEach(t=>{e=e||t.facetsComputationActives()})),e}addObjectsTags(e,t){if(!this.facetsComputationActives())return Promise.resolve(e);var n=!0!==t,i=[],s=[];e.forEach(e=>{!0!==this._alreadyManagedIds[e]?(i.push(e),this._alreadyManagedIds[e]=!!n||1):s.push(e),this._allIds.add(e)});let a=Promise.resolve(s);return n&&i.length>0&&(this._tagQuery=l.getObjectContent({pid:i,filters:this._filterTags}),a=new Promise((e,t)=>{this._tagQuery.then(t=>{if(this._filterTags&&Object.keys(this._filterTags).length>0){let n=c(t);e([...s,...n])}this.addTags(t)}).catch(t)})),a}setUpdateMode(e){this._updateMode=e}addTagsFromProxy(e){this._additionalProxies[e._name]=e}deleteTagsFromProxy(e){delete this._additionalProxies[e._name]}hasANDConditionInRefine(e,t){if(t&&e)for(var n in e){let s=t[n];if(s&&s.length>0){let t=e[n],a=!0;if(s.every(e=>(t.every(t=>a=i.compareJsonValue(e,t)),a)),!a)return!0}}return!1}applyFilterIfAny(e){var n=this._filterTags;let i=n||[],s=!1;if(this._additionalProxies){for(var a in this._additionalProxies){let e=this._additionalProxies[a].getFilterTags();e&&(s=s||this.hasANDConditionInRefine(i,e),i={...i,...e})}Object.keys(i).length>0&&(n=i)}if(n&&(e||Object.keys(n).length>0)){var o=[];if(!1!==this._updateMode)o=Object.keys(this._alreadyManagedIds);else for(var a in this._alreadyManagedIds)!0===this._alreadyManagedIds[a]&&o.push(a);var r=Object.keys(n).length>0;let i=s?{results:[],infos:{}}:void 0;this._filterQuery=Promise.resolve(i),!i&&o.length>0&&(this._filterQuery=l.getObjectContent({pid:o,filters:n})),this._previousTags={},this._currentQueryCancel&&(this._currentQueryCancel.cancel(),this._currentQueryCancel=null);let d=this._currentQueryCancel=t.getCancelObject();this._filterQuery.then(t=>{if(!d.isCancelled()){var n=this._updateMode?o:void 0;if(t&&(t.results||r)){n=c(t);var i={};n.forEach(e=>{i[e]=this._alreadyManagedIds[e]}),this._alreadyManagedIds=i,e&&this.addTags(t)}this._model.publish({event:"filterUpdated"+this._name,data:{matchingIds:n,hasFilter:r}})}}).catch(e=>console.log("Can't get object content for tagging"))}}onFilterBIFilteringEvent(e){let t={};!this._onlyLocal&&e.allfilters&&0!==Object.keys(e.allfilters).length?t=e.allfilters:e.localfilters&&0!==Object.keys(e.localfilters).length&&(t=e.localfilters),i.compareJsonValue(t,this._filterTags)?this.resetTags():(this._filterTags=t,this.applyFilterIfAny(!0))}getFilterTags(){return this._filterTags}setLocalFilter(e){this._filterTags=e,this.getProxy().setLocalFilter(e)}isFilterActives(){return!!this._filterTags&&Object.keys(this._filterTags).length>0}handleEvents(){this.isActive()?this._filter.addEvent("onFilterChange",this.onFilterBIFilteringEvent,this):this._filter.removeEvent("onFilterChange",this.onFilterBIFilteringEvent,this)}}}),define("DS/IPClassifyUXUtil/ActionBar/BreadCrumb",["UWA/Controls/Abstract","UWA/Class/Options","DS/UIKIT/Input/Text","DS/IPClassifyUXUtil/ActionBar/BreadCrumbMenu"],function(e,t,n,i){"use strict";return e.extend(t,{_ctxMenu:null,_ctxMenuWidth:14,_breadcrumb:null,_pathCont:null,_divPathSegmented:null,_divPathFullText:null,init:function({pathCont:e,pathNodes:t,evt:i}){this._parent.apply(this,arguments),this._pathCont=e;var s=this;this._divPathSegmented=UWA.createElement("div",{class:"containerPathSegmented"}).inject(this._pathCont),this._divPathFullText=UWA.createElement("div",{class:"containerPathFullText"}).hide().inject(this._pathCont),this._pathFullText=new n({className:"pathFullText",attributes:{multiline:!1,readonly:!0}}).inject(this._divPathFullText),this._pathFullText.elements.input.addEvent("blur",function(){s._divPathFullText.hide(),s._divPathSegmented.show()}),this._buildCtxMenu(),this._breadcrumb=UWA.createElement("div",{class:"containerPathIdCard"}).inject(this._divPathSegmented),t&&t.length>0&&this._buildPathNavigator(t),this._pathCont.addEventListener("click",this._onClickDivPathCont.bind(this),!0)},flush:function(){for(this._ctxMenu.hide();this._breadcrumb.firstChild;)this._breadcrumb.removeChild(this._breadcrumb.firstChild);this._ctxMenu.flush()},_buildPathNavigator:function(e){if(UWA.is(e)){this._divPathFullText.hide(),this._divPathSegmented.show();for(var t=this._pathCont.offsetWidth-this._ctxMenuWidth-50,n=!1,s="",a=0;a<e.length;a++){s=e[a].getLabel()+(s?"\\":"")+s;var o,l=null,r=null,c=0,d=this._createFolderInfoPathElement(e[a]);if(o=d.getDimensions().outerWidth,a<e.length-1&&((l=(r=new i({folderInfo:e[a+1],modelEvents:this.options.modelEvents})).buildPathSeparatorElement()).FolderSeparator=r,l.inject(this._breadcrumb,"top"),c=l.getDimensions().outerWidth),o+c<t&&!n)t=t-o-c;else{n=!0,this._ctxMenu.isVisible()||this._ctxMenu.show(),l&&l.destroy();var u=d.nextSibling;u&&u.hasClassName("separatorIdCard")&&u.destroy(),d.remove(),this._ctxMenu.addSubFolder(e[a])}}this._pathFullText.setValue(s),this._resize()}},_buildCtxMenu:function(){this._ctxMenu=new i({folderInfo:null,modelEvents:this.options.modelEvents,activeIconFont:"fonticon-menu",unactiveIconFont:"fonticon-menu"});var e=this._ctxMenu.buildPathSeparatorElement();e.inject(this._divPathSegmented,"top"),this._ctxMenuWidth=e.getDimensions().outerWidth,this._ctxMenu.hide()},_resize:function(){var e,t=null;if(this._isOverflowed())for(this._ctxMenu.isVisible()||this._ctxMenu.show();this._isOverflowed()&&this._breadcrumb.hasChildNodes()&&(t=this._breadcrumb.firstChild);)t.FolderInfo&&(this._ctxMenu.addSubFolder(t.FolderInfo,!0),(e=t.nextSibling)&&e.hasClassName("separatorIdCard")&&e.destroy(),t.remove());else for(var n=!0,s=this._breadcrumb.getElementsByClassName("subLabelTextIdCard").length>0;n;)if(this._ctxMenu.isVisible()||(n=!1),t=this._ctxMenu.getSubFolder(0)){if(s){var a=new i({folderInfo:t,modelEvents:this.options.modelEvents});(e=a.buildPathSeparatorElement()).FolderSeparator=a,e.inject(this._breadcrumb,"top")}var o=this._createFolderInfoPathElement(t);s=!0,this._isOverflowed()?(e&&e.destroy(),o.remove(),n=!1):this._ctxMenu.removeSubFolder(0)}else this._ctxMenu.hide(),n=!1;this._ctxMenu.isVisible()&&this._ctxMenu.resizeWidgetCallback();var l,r,c,d=this._breadcrumb.getElementsByClassName("separatorIdCard");for(c=d.length,l=0;l<c;++l)(r=d[l].FolderSeparator)&&r.resizeWidgetCallback();return this._pathFullText.getContent().setStyle("width",this._divPathSegmented.getDimensions().width),!0},_isOverflowed:function(){var e=this._pathCont.getParent(".idcard_middle");return this._breadcrumb.clientWidth+this._ctxMenuWidth>.5*e.clientWidth-50},_createFolderInfoPathElement:function(e){var t=this,n=UWA.createElement("div",{class:"subLabelTextIdCard",styles:{cursor:"pointer"},events:{click:function(e){t._callExpandAndSelectRequest(this.FolderInfo.getID(),this.FolderInfo.getType(),this.FolderInfo.getLabel())}}}).inject(this._breadcrumb,"top");return n.FolderInfo=e,n.setText(e.getLabel()),n},_callExpandAndSelectRequest:function(e,t,n){this.options.modelEvents.publish({event:"select_breadcrumb_object",data:{id:e,type:t,name:n}})},_onClickDivPathCont:function(e){return e.currentTarget===e.target&&this.switchPathForCopy(),!1},switchPathForCopy:function(){if(this._divPathFullText&&this._divPathFullText.isHidden()){this._divPathFullText.show(),this._divPathSegmented.hide();var e=this._pathFullText.elements.input;e.focus(),e.select()}}})}),define("DS/IPClassifyUXUtil/ActionBar/IPToolbar",["UWA/Controls/Abstract","DS/UIKIT/Tooltip","DS/UIKIT/Popover","DS/IPClassifyUtil/IPClassifyUtility","DS/IPClassifyUX/events/IPClassifyEvents","DS/IPClassifyUXUtil/ActionBar/BreadCrumb","DS/Utilities/TouchUtils","DS/Tweakers/GeneratedToolbar","DS/Controls/LineEditor","DS/WebappsUtils/WebappsUtils","DS/Notifications/NotificationsManagerViewOnScreen","i18n!DS/IPClassifyUXUtil/assets/nls/IPClassifyUXUtil","css!DS/IPClassifyUXUtil/IPClassifyUXUtil"],(e,t,n,i,s,a,o,l,r,c,d,u)=>{function h(e){return-1===e.icon.search(".png")?{iconName:e.icon,fontIconFamily:1}:{iconPath:c.getWebappsAssetUrl("FolderEditor","icons/"+e.icon)}}function m(e,t,n){var i=[];return e.forEach(e=>{var s=e.id,a=!0;if(e.submenu){var o=m.call(this,e.submenu,t,n);(a=o.length>0)&&((e={...e}).submenu=o)}else if(s){var l=this.getCommandManager().getCommand(s);l&&(!n||n.indexOf(s)>=0)&&(a=void 0!==t?t:l.isEnabled())}a&&i.push(e)}),i}var p={getExpandIcon:function(e){return{iconName:e?"expand-left":"expand-right",fontIconFamily:1}},getExpandTooltip:function(e){return e?u.collapse:u.expand},getExpandButtonEntry:function(e,t){return{id:"expandOneID",dataElements:{typeRepresentation:"functionIcon",icon:this.getExpandIcon(t),tooltip:this.getExpandTooltip(t),label:this.getExpandTooltip(t),position:"near",category:"Actions",value:t=>{"expand-left"===t.context.nodeModel.getAttributeValue("semantics").icon.iconName?e.publish({event:"welcome-panel-collapse"}):e.publish({event:"welcome-panel-expand"})}}}},getInformationIcon:function(e){return{iconName:"info",fontIconFamily:1,className:!0===e?"info":""}},getInformationEntry:function(e,t){return{id:"info",dataElements:{typeRepresentation:"functionIcon",icon:this.getInformationIcon(t),tooltip:u.information,label:u.information,value:function(t){var n="info"===t.context.nodeModel.getAttributeValue("semantics").icon.className;e.publish({event:"information-panel-"+(n?"close":"open")})}}}},getSearchEntry:function(){return[{id:"searchButton",dataElements:{typeRepresentation:"functionIcon",tooltip:u.searchInFolder_search,label:u.searchInFolder_search,icon:{iconName:"search",fontIconFamily:1},value:this._toggleSearch.bind(this),position:"far",possibleValues:""}}]}};return e.extend({getCommandManager:()=>{throw new Error("getCommandManager should be overrided")},addSubscriptionToken:function(e){this._subscriptionTokens.push(e)},_subscribe:function(e,t){let n=this.options.modelEvents.subscribe(e,t);this._subscriptionTokens.push(n)},init:function({leftOpened:e,rightOpened:a,modelEvents:o,searchInCurrentTab:c}){d.slide({top:28}),this._parent.apply(this,arguments),this._subscriptionTokens=[],c&&widget&&(widget.addEvent("onSearch",e=>{this.switchSearch(!0),this.elements._inputText.value=e}),widget.addEvent("onResetSearch",()=>{this.switchSearch(!1)}));var h=this.getClassNames();this.elements.container=UWA.createElement("div",{class:h+" ToolbarContainer"}),this.elements.flexToolbar=UWA.createElement("div",{class:"IPToolbar"}),this.elements.flexToolbar.inject(this.elements.container);let m={entries:[]};if(this.hasStableCommands=!1,0==this.isTreeViewVisible()||this.shouldMove()){let e=l.prototype.createTreeDocument(m),t=new l({overflowManagement:"dropdown",direction:"horizontal",items:e});this.toolbars={left:t}}else{m.entries.push(p.getExpandButtonEntry(o,e));let t=l.prototype.createTreeDocument(m),n=new l({overflowManagement:"dropdown",direction:"horizontal",items:t});var f=UWA.createElement("div",{class:"pageToolBarCommands_container centerMe"}).inject(this.elements.flexToolbar);n.inject(f),this.toolbars={left:n}}var g=UWA.createElement("div",{class:"idcard_middle"}).inject(this.elements.flexToolbar),v=UWA.createElement("div",{class:"breadCrumbCommands_container centerMe"}).inject(g);let b={path:{},search:{}},C=UWA.createElement("div",{class:"fonticon fonticon-attention fonticon-warning idcard_title_alertIcon"}).inject(v);C.hide(),this.options.modelEvents.subscribe({event:"update_toolbar_warning"},e=>{let t=b[e.type];e.key&&(e.message?t[e.key]=e:delete t[e.key]);let n=Object.keys(t).length;if(n>0){let e="",i="";for(let s in t)e+=(n>1?"- ":"")+t[s].message+i,i=i||"\n";C.setAttribute("title",e),C.show()}else C.hide()}),this.elements.titleIdCard_container=UWA.createElement("div",{class:"title_IdCard"}).inject(v),this.buildTabBar&&this.buildTabBar(this.elements.titleIdCard_container),this.elements.searchSumIdCard_container=UWA.createElement("div",{class:"title_IdCard"}).hide().inject(v);var _=UWA.createElement("span",{class:"idcard_title_titleSearch"}).inject(this.elements.searchSumIdCard_container),y=UWA.createElement("span",{class:"idcard_title_DateSearch"}).inject(this.elements.searchSumIdCard_container);if(this.elements.elementRightCommands=UWA.createElement("div",{class:"rightCommands_container centerMe"}).inject(g),this.elements.elementRightCommands.addEventListener("click",this._clickOnRightCommandContainer.bind(this),!0),this.elements._inputText=new r({visibleFlag:!1,displayClearFieldButtonFlag:!0,placeholder:this._textPlaceholder,autoCommitFlag:!0}),this.elements._inputText.getContent().addClassName("inputSearch"),this.elements._inputText.addEventListener("change",e=>{var t=this.elements._inputText.value;if(t.length>=0){if(!this._isSearchInputVisible()||t===this._textPlaceholder||t===this._prevInputValue)return;this._prevInputValue=t,null!=this._timerLastKey&&clearTimeout(this._timerLastKey),this._timerLastKey=setTimeout(()=>{o.publish({event:"searchValueSet",data:t})},1e3)}}),this.elements._inputText.addEventListener("keydown",e=>{"esc"===UWA.Event.whichKey(e)&&(clearTimeout(this._timerLastKey),o.publish({event:"searchValueSet",data:null}),this.switchSearch(!1))}),this.getSearchWithinController&&this.getSearchWithinController()){var w=this;s.onContentSearchResult(function(e){if(e){var s=document.querySelectorAll(".search_close");if(s&&s.length>0){var a=Array.prototype.slice.call(s);a&&a.forEach(function(e){e.remove()})}var l=UWA.createElement("span",{class:"close-btn my-btn fonticon fonticon-close search_close"}).inject(w.elements.searchSumIdCard_container);new t({position:"bottom",target:l,body:u.exit_search}),l.addEventListener("click",function(){w._hideSearchInput(!0),o.publish({event:"searchValueSet",data:null})});var r=e.numberHits;w.elements.titleIdCard_container.hide(),w.elements.searchSumIdCard_container.show();var c=u.replace(u.searchResultSum,{numberHits:r,s:r>1?"s":"",bookmarkname:w._currentPathNodes[0]._label});_.setText(c);var d=e.dateIndex,h="";if(d){var m=new Date;h=(m-d)/1e3/3600>24||d.getDay()!=m.getDay()?d.toLocaleString():d.toLocaleTimeString(),h=u["Last index:"]+" "+h}if(y.setText(h),w.elements.searchSumIdCard_container.offsetWidth<_.offsetWidth+y.offsetWidth){_.setText(""),y.setText("");var p=UWA.createElement("span",{class:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-clock"}).inject(_);p.setStyle("color","black");var f="hover focus";i.isTouchDevice()&&(f="touch"),new n({target:p,trigger:f,animate:"true",position:"bottom",body:c+". "+h,title:""})}}else w.elements.titleIdCard_container.show(),w.elements.searchSumIdCard_container.hide(),w.updateDisplayPath()})}this.elements._middleSep=UWA.createElement("div",{class:"toolbar_sep centerMe"}),this.elements._middleSep.inject(this.elements.flexToolbar),this.elements._middleSep.hide(),this.elements.inputFlexContainer=UWA.createElement("div",{class:"searchFlex centerMe"}),this.elements._inputText.inject(this.elements.inputFlexContainer),this.elements.inputFlexContainer.inject(this.elements.flexToolbar),this.elements.elementStableCommands=UWA.createElement("div",{class:"stableAreaCommands_container centerMe"}).inject(this.elements.flexToolbar),this._subscribe("searchInputDisplayed",()=>{this.updateDisplayPath()}),this._subscribe({event:"command_availability_updated"},e=>{this.manageSearchVisibility(e),this.updateCommandsVisibility()}),this._subscribe({event:"command_visibility_updated"},e=>{e&&this.updateCommandsVisibility(e.commands,void 0,!0)}),this._subscribe({event:"check_command_availability"},e=>{this.updateSeparatorVisibility(e.commands)}),this._subscribe({event:"toolbar_update_command"},e=>{this.updateCommand(e.commandID,e.data)}),this._subscribe({event:"searchUpdated"},e=>{if(e){this.elements.flexToolbar.addClassName("isSearchActive");var t=e?e.nhits:0;this.elements.titleIdCard_container.hide(),this.elements.searchSumIdCard_container.show();var n=u.replace(u.searchResultSum,{numberHits:t,s:t>1?"s":"",bookmarkname:e.objectName});_.setText(n),_.setAttribute("title",n);var i=e.lastIndexation,s="";if(i){var a=new Date;s=(a-i)/1e3/3600>24||i.getDay()!=a.getDay()?i.toLocaleString():i.toLocaleTimeString();s=u["Last index:"]+" "+s}_.setAttribute("title",n+"\n"+s),y.setText(s)}else this.elements.flexToolbar.removeClassName("isSearchActive"),this.elements._inputText.value="",this.elements.titleIdCard_container.show(),this.elements.searchSumIdCard_container.hide(),this.updateDisplayPath()}),this.getCommandManager().getToolbarCommands().then(e=>{this.initializeCommands(e,a).then(e=>{var t=e.unstable;let n=l.prototype.createTreeDocument({entries:t||[]}),i=new l({overflowManagement:"dropdown",direction:"horizontal",items:n});this.toolbars.unstable=i;var s=e.stable;let a=l.prototype.createTreeDocument({entries:s||[]}),o=new l({overflowManagement:"dropdown",direction:"horizontal",items:a});this.toolbars.stable=o,s&&s.length>0&&(this.hasStableCommands=!0),this.getCommandManager().updateCommands(),i.inject(this.elements.elementRightCommands),o.inject(this.elements.elementStableCommands),widget.dispatchEvent("ontoolbarReady"),this.options.modelEvents.publish({event:"toolbar_ready_WebInWin",data:""})})}).catch(function(e){console.log("Error: "+e)})},destroy:function(){this._subscriptionTokens.forEach(e=>{this.options.modelEvents.unsubscribe(e)}),this._subscriptionTokens=[],this._parent()},setTooltip:function(e,t){var n=e.dataElements?e.dataElements:e;n.tooltip=this.getCommandManager().getTooltip(t.ID),n.tooltip.temp?e.dataElements?e.dataElements.label=n.tooltip.temp.title:(e.title=n.tooltip.temp.title,e.tooltip.temp.tooltip&&(e.tooltip=n.tooltip.temp.tooltip)):n.tooltip.title&&(e.title=n.tooltip.title)},createMenu:function(e,t){var n=null,i=null,s=[];return t.Commands.forEach(t=>{var a=null,o=null,l=null,r=null;if(t.Commands?(a=this.createMenu(e,t),n=n||a.command,i=i||a.details,t.Name&&(l=(l=u["CommandSection."+t.Name])||t.Name),t.icon&&(r=t.icon)):(l=(o=e[t])?o.Name:"",n=n||t,i=i||o),o||a){var c=t.Name?t.Name:a&&a.menu.length>0?a.menu[0].id+"_group":t,d={id:c,type:"PushItem"};if(l&&(d.title=l,d.tooltip=l),o&&(this.setTooltip(d,o),o.icon&&"none"!=o.displayIcon&&(d.icon=h(o)),d.action={callback:this.getCommandManager().launchCommand.bind(this.getCommandManager(),o.ID,null)}),a&&(d.submenu=a.menu,a.details&&(d.icon=h(a.details))),"subscribe"===c){var m={};m.icon=r||"bell-list",d.icon=h(m)}s.push(d)}}),{details:i,command:n,menu:s}},getEntryForCommand:function(e){},initializeCommands:function(e,t){var n={},i=1;if(e){var s=e.headers;for(var a in e.toolbar)n[a]=[],e.toolbar[a].forEach(e=>{var o=this.getEntryForCommand(e);if("sep"===e)i++;else if("Search"===e){i++,p.getSearchEntry.bind(this)().forEach(e=>{e.dataElements.category=i,e.dataElements.position="far",n[a].push(e)}),0!=this.needSep()&&i++}else if("Information"===e&&0!=this.getInfoVisibility()){var l=p.getInformationEntry(this.options.modelEvents,t);l.dataElements.category=i,l.dataElements.position="far",n[a].push(l)}else if(o)o.dataElements.category=i,o.dataElements.position="far",n[a].push(o);else if("layout"===e.type){var r=[],c=e,d=null,m="layout",f=null,g=null;(C=this.createMenu(s,e)).menu.forEach(e=>{r.push({value:e.id,label:e.title,icon:e.icon,id:e.id,tooltip:e.tooltip})}),g=e.default?r.find(t=>t.id===e.default.id):r[0];var v={id:S=e.Name?e.Name:c,dataElements:{typeRepresentation:m,position:"far",disabled:!1,category:i,value:g,possibleValues:r,tooltip:u["CommandSection.display"],label:u["CommandSection.display"],onNodeUpdate:e=>{let t=e.getAttributeValue("data"),n=t.id||t;this.getCommandManager().launchCommand.call(this.getCommandManager(),n,null)}}};n[a].push(v)}else{var b="menu"===e.type;b&&(e.Name="menu");c=e,d=null;var C,_=!!e.Commands,y=(m="functionIcon",null);f=null;if(_)if(e.Commands.length>0)m=b?"threeDotsMenu":"functionMenuIcon",y={menu:(C=this.createMenu(s,e)).menu},d=C.details,c=C.command,e.isAppSpecific&&e.Name&&this._commandManager&&this._commandManager.getToolTipFromNls?f=this._commandManager.getToolTipFromNls(e.Name):e.Name&&(f=(f=u["CommandSection."+e.Name])||e.Name),b||"SelectAll"===c||C.menu.forEach(t=>{let n=t.action;n&&(t.action={callback:()=>{n.callback(),this.options.modelEvents.publish({event:"toolbar_update_command",data:{commandID:e.Name,data:{icon:t.icon}}})}})});else e.isExternal=!0,m="functionMenuIcon",(d=e)&&(f=u["CommandSection."+e.Name],y={menu:e.Commands});else(d=s[e])&&(f=d.Name,y=this.getCommandManager().launchCommand.bind(this.getCommandManager(),d.ID,null));if(d){var w=b?"menu-dot":d.icon,S=e.Name?e.Name:c+(b||_?"_group":"");"SelectAll"===c&&(w="select-off",m="functionMenuIconCount"),d.icon=w;var I=h(d);if("CATAfrHeaderCheck"===d.Behavior)(v=this.getCommandManager().getCommand(S))&&v.getState()&&(I.className="check-active");(v={id:S,dataElements:{typeRepresentation:m,icon:e.icon?h({icon:e.icon}):I,position:"far",category:i}}).isExternal=e.isExternal,f&&(v.dataElements.tooltip=f,v.dataElements.label=f),b||_||this.setTooltip(v,d),y&&(v.dataElements.value=y),n[a].push(v)}}})}return Promise.resolve(n)},isSearchAvailable:function(){},_isSearchAvailableAsync:async function(){let e=this.isSearchAvailable.apply(this,arguments);return e.cancel&&(this._searchCheck&&this._searchCheck.cancel(),this._searchCheck=e),e},isAdvanceSearchAvailable:function(e){this.toolbars.stable&&this._libraryCSO&&(!1!==e&&"Library"==this._libraryCSO.getCurrentObject().getType()?this.toolbars.stable.updateNodeModel("searchButton",{possibleValues:[{value:this._toggleSearch.bind(this),icon:{iconName:"search",fontIconFamily:1},label:u.searchInFolder_search,title:u.searchInFolder_search},{value:this._advanceSearch.bind(this),icon:{iconName:"search-book",fontIconFamily:1},label:u.advance_search_within}]}):this.toolbars.stable.updateNodeModel("searchButton",{possibleValues:"",grid:{data:this._toggleSearch.bind(this)}}))},manageSearchVisibility:async function(e){await this._isSearchAvailableAsync(e?e.treeNode:null)?this.showSearch():this.hideSearch()},hideSearch:function(){this.showSearch(!1),this._hideSearchInput(!0)},showSearch:function(e){this.updateCommandsVisibility(["searchButton"],!1!==e),this.getSearchWithinController&&this.isAdvanceSearchAvailable(e),this.toolbars.stable&&widget.body.getSize().width>0&&(this.elements.elementStableCommands.setStyles({visibility:"hidden",position:"absolute",width:"100%"}),this.elements.inputFlexContainer.setStyle("visibility","hidden"),this.elements.elementRightCommands.setStyle("visibility","hidden"),setTimeout(()=>{var e=this.getStableAreaWidth();e||(e=this.toolbars.stable.elements.farContainer.clientWidth+10);this.elements.elementStableCommands.setStyles({visibility:"visible",position:"relative","flex-basis":e,width:"auto"}),this.elements.inputFlexContainer.setStyle("visibility","visible"),this.elements.elementRightCommands.setStyle("visibility","visible")}))},updateLeftPanelIcon:function(e){this.toolbars.left.updateNodeModel("expandOneID",{grid:{semantics:{icon:p.getExpandIcon(e)}},tooltip:p.getExpandTooltip(e),label:p.getExpandTooltip(e)})},updateRightPanelIcon:function(e){this.toolbars.stable.updateNodeModel("info",{grid:{semantics:{icon:p.getInformationIcon(e)}}})},updateSelectionCount:function(e){const t=0===e?{title:"",shortHelp:"Select"}:{title:"Selected",shortHelp:e};this.toolbars&&this.toolbars.stable&&this.toolbars.stable.updateNodeModel("select",{tooltip:t,count:e,grid:{semantics:{icon:{iconName:e?"select-on":"select-off",fontIconFamily:1}}}})},updateCommandsVisibility:function(e,t,n){setTimeout(()=>{this.elements.container&&this._updateCommandsVisibility(e,t,n)},0)},_updateCommandsVisibility:function(e,t,n){if(this.toolbars)for(var i in this.toolbars){var s=this.toolbars[i];s.prepareUpdateView(),s.items.getAllDescendants().forEach(i=>{if(!i.options.isExternal){var a=i.options.id;let u=null;u=i.options.icon?i.options.icon:i.options.grid.semantics.icon;var o=null,l=i.options.grid.data.menu;if(!l||e&&!n){if(!e||e.indexOf(a)>=0){var r=this.getCommandManager().getCommand(a);flag=void 0!==t?t:r?r.isEnabled():null,null!==flag&&s.updateNodeModel(a,{visibleFlag:flag})}}else{var c=i.options.menuSave;if(c||(c=i.options.menuSave=i.options.grid.data.menu),e){var d=[];i.options.menuSave.forEach(t=>{var n=t.id,i=e.indexOf(n)>=0;i||l.every(e=>(i=n===e.id,t=e,!i)),i&&d.push(t)}),c=d}if(o=m.call(this,c,t,e)){let e=[],t=!1;o.forEach(n=>{let i=!0;n.icon&&n.icon.iconName&&u&&i&&!["menu","select","revise"].includes(a)&&(u.iconName==n.icon.iconName?(t=!1,i=!1):t=!0),e.push(n)}),t&&e.length>0&&this.options.modelEvents.publish({event:"toolbar_update_command",data:{commandID:a,data:{icon:e[0].icon}}})}s.updateNodeModel(a,{grid:{data:{menu:o}}})}!o||e&&!n||s.updateNodeModel(a,{visibleFlag:0!==o.length})}}),s.pushUpdateView()}},getToolbarCommand:function(e){var t=null,n=null;if(this.toolbars)for(var i in this.toolbars){var s=this.toolbars[i];if(s.items.getAllDescendants().every(n=>{var i=n.options.id;return e===i&&(t=n),!t}),t){n=s;break}}return{command:t,toolbar:n}},_updateCommand:function(e,t){this.getCommandManager().getToolbarCommands().then(()=>{var n=this.getToolbarCommand(e);if(n.command){var i=n.command,s=n.toolbar,a=i.options.id;if("layout"===i.getAttributeValue("typeRep")&&t.grid&&"string"==typeof t.grid.data&&i.options.possibleValues){let e=i.options.possibleValues.find(e=>e.id===t.grid.data);e&&(t.grid.data=e)}s.updateNodeModel(a,t)}}).catch(function(e){console.log("Error: "+e)})},updateCommand:function(e,t){setTimeout(()=>{this._updateCommand(e,t)},0)},searchHasFocus:function(){return document.activeElement===this.elements._inputText.elements.inputField},getSearchValue:function(){return this.elements._inputText?this.elements._inputText.value:null},updateSeparatorVisibility:function(e){e&&-1!==Object.entries(e).find(e=>1==e)&&this.hasStableCommands?this.elements._middleSep.show():this.elements._middleSep.hide()},_isSearchInputVisible:function(){let e=!1;return this.elements._inputText&&(e=this.elements._inputText.visibleFlag),e},_toggleSearch:function(){let e=this._isSearchInputVisible();this.switchSearch(!e)},_advanceSearch:function(){var e={CSOProvider:this.options.libraryCSODataProvider,LibraryDataProvider:this.options.libraryDataProvider};this.getSearchWithinController().loadUI(e,this)},switchSearch:function(e){e?this._showSearchInput():this._hideSearchInput(!0)},_focusOnSearchText:function(){setTimeout(()=>{this.elements._inputText.getContent().getElement("input").focus()},0)},_hideSearchInput:function(e){e&&this.getSearchValue()&&this.clearSearchValue(),this.elements._inputText&&(this._isSearchInputVisible()&&this.options.modelEvents.publish({event:"searchValueSet",data:null}),this.elements._inputText.value="",this.elements._inputText.visibleFlag=!1)},_showSearchInput:function(){this.elements._inputText.visibleFlag=!0,this._focusOnSearchText()},clearSearchValue:function(){this._prevInputValue=null},createPathInfo:function(e){},isTreeViewVisible:function(){},shouldMove:function(){},getInfoVisibility:function(){},needSep:function(){},getStableAreaWidth:function(){},setCurrentLocation:function({objectPath:e}){if(0!=this.isTreeViewVisible()){var t,n,i;if(this._currentPathNodes=[],(i=e)&&i.length>0)for(t=i.length-1;t>=0;--t)n=i[t],this._currentPathNodes.push(this.createPathInfo(n));this._buildNavPath(this._currentPathNodes)}},_changePlaceholder:function(e){var t=u.replace(u.SearchInFolder,{folderName:e});this._textPlaceholder=t,this.elements._inputText.placeholder=this._textPlaceholder},_buildNavPath:function(e){this._breadCrumb?(this._breadCrumb.flush(),this._breadCrumb._buildPathNavigator(e)):this._breadCrumb=new a({pathCont:this.elements.titleIdCard_container,pathNodes:e,modelEvents:this.options.modelEvents}),e.length>0&&this._changePlaceholder(e[0].getLabel())},updateDisplayPath:function(){let e=this.elements._inputText,t=e.getContent().hasAttribute("focused");this.elements.flexToolbar.clientWidth<600?(e.inject(this.elements.container),this.elements.container.addClassName("smallContainer")):(e.inject(this.elements.inputFlexContainer),this.elements.container.removeClassName("smallContainer")),t&&e.focus(),this._breadCrumb&&this._breadCrumb._resize(this._currentPathNodes)},_clickOnRightCommandContainer:function(e){var t=e.clientX,n=this.toolbars.unstable.elements.farContainer.getBoundingClientRect().x;this._breadCrumb&&t<n&&this._breadCrumb.switchPathForCopy()}})}),define("DS/IPClassifyUXUtil/PlatformCredSelector",["UWA/Core","DS/Controls/ComboBox","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/IPClassifyUXUtil/IPClassifyConfirmation","DS/IPClassifyUXUtil/service/IPClassifyUXUtilWebService","DS/IPClassifyUXUtil/private/CredentialsConverter","DS/PADUtils/PADUtilsServices","DS/PADUtils/PADSettingsMgt","DS/IPClassifyUtil/IPClassifyAlert","i18n!DS/IPClassifyUXUtil/assets/nls/IPClassifyUXUtil","css!DS/IPClassifyUXUtil/IPClassifyUXUtil"],function(e,t,n,s,a,o,r,c,d,u,h){return PlatformCredSelector={setCredential:function(e,t){widget.setValue("pad_security_ctx",e.value),d.setSetting("pad_security_ctx",e.value),function(e){d.dispatchEvent("onPad_security_ctx",e)}(e.label),u.displayNotification({message:h.replace(h.credentialChanged,{credential:e.label}),className:"primary"})},render:async function(m,p){var f=this;let g=e.createElement("div");e.createElement("p",{text:m?h.replace(h.platformSelection_message,{name:c.getPlatformId()}):h.credentialSelection_message}).inject(g);let v=null,b=[],C=null,_=[];await new Promise((i,a)=>{if(m){if(!(b=c.getTenantsPreference())||0==b.length)return d.dispatchEvent("onNoPlatform"),void a();let u=-1,m=[];new Promise((t,n)=>{for(let i=0;i<b.length;++i)o.getscandcollab({platformID:b[i].value}).then(s=>{let a=e.is(s,"string")?JSON.parse(s):s,o=r.computeCredentials(a);o&&o.credentials&&o.credentials.length>0?(m=o.credentials,u=i,t()):i===b.length-1&&(d.dispatchEvent("onNoSecurityContext"),n())})}).then(function(){var c=this;(u<0||0===m.length)&&(d.dispatchEvent("onNoSecurityContext"),a()),v=b[u].value,c._tenantTreeDocument=new n;for(let e=u;e<b.length;++e){var p=new s({label:b[e].label,value:b[e].value});c._tenantTreeDocument.addRoot(p)}c._platformComboBox=new t({elementsTree:c._tenantTreeDocument,enableSearchFlag:!1}),c._platformComboBox.addEventListener("change",function(t){let n=c._tenantTreeDocument.getRoots()[c._platformComboBox.selectedIndex];v=n.options.value,c._credentialsComboBox.elementsTree.removeRoots(),o.getscandcollab({platformID:v}).then(t=>{let n=e.is(t,"string")?JSON.parse(t):t,i=r.computeCredentials(n);if(i&&i.credentials&&i.credentials.length>0){_=i.credentials;for(let e=0;e<_.length;++e){var a=new s({label:_[e].translate.label,value:_[e].translate.value});c._credentialsComboBox.elementsTree.addRoot(a)}c._credentialsComboBox.selectedIndex=0,c._credentialsComboBox._applySelectedIndex()}})}),c._platformComboBox.getContent().addClassName("comboBox-PlatformCredSelector"),c._platformComboBox.inject(g),e.createElement("p",{text:h.credentialSelector,class:"para-PlatformCredSelector"}).inject(g),C=m[0],_=m,l.call(c),i()}).catch(a)}else o.getscandcollab().then(t=>{let n=e.is(t,"string")?JSON.parse(t):t,s=r.computeCredentials(n);s&&s.credentials&&s.credentials.length>0?(C=s.credentials[0],_=s.credentials,l(),i()):(d.dispatchEvent("onNoSecurityContext"),a())});function l(){var e=this;e._credentialTreeDocument=new n;for(let t=0;t<_.length;++t){var i=new s({label:_[t].translate.label,value:_[t].translate.value});e._credentialTreeDocument.addRoot(i)}e._credentialsComboBox=new t({elementsTree:e._credentialTreeDocument,enableSearchFlag:!1}),e._credentialsComboBox.addEventListener("change",function(t){let n=e._credentialTreeDocument.getRoots()[e._credentialsComboBox.selectedIndex];C={translate:{label:n.options.label,value:n.options.value}}}),e._credentialsComboBox.getContent().addClassName("comboBox-PlatformCredSelector"),e._credentialsComboBox.inject(g)}}),await new Promise(e=>{a.launch({title:m?h.platformSelection_title:h.credentialSelection_title,content:g,confirmLabel:h.confirmation_continue,noClose:!0},function(){if(v&&(d.updateTenantSettings(v,b,!0),u.displayNotification({message:h.replace(h.tenantChanged,{tenant:v}),className:"primary"})),C){let e=-1;for(i=0,l=widget.preferences.length;i<l;i++)if("pad_security_ctx"===widget.preferences[i].name){e=i;break}var t=[];_.forEach(e=>t.push(e.translate)),widget.addPreference({name:"pad_security_ctx",index:e,type:"list",label:"pad_security_ctx",defaultValue:C.translate,options:t}),f.setCredential(C.translate)}p&&p.onRefresh&&p.onRefresh({reInitialize:!0}),e()})})}}}),define("DS/IPClassifyUXUtil/private/CredentialsManager",["DS/IPClassifyUXUtil/private/CredentialsConverter","DS/IPClassifyUXUtil/service/IPClassifyUXUtilWebService"],function(e,t){"use strict";var n=null;return{getAvailableCredentials:function(i,s){if(i&&n&&(n.cancel(),n=null),!n){var a=null;(n=new Promise((n,o)=>{(a=t.getscandcollab()).then(t=>{var a=UWA.is(t,"string")?JSON.parse(t):t,o=e.computeCredentials(a,i,s);n(o)}).catch(o)})).cancel=(()=>{a&&a.cancel(),n=null})}return n}}}),define("DS/IPClassifyUXUtil/CredentialsView",["DS/IPClassifyUXUtil/private/CredentialsManager","DS/IPClassifyUtil/IPClassifyAlert","DS/PADUtils/PADSettingsMgt","DS/IPClassifyUXUtil/PlatformCredSelector","DS/WidgetServices/WidgetServices","i18n!DS/IPClassifyUXUtil/assets/nls/IPClassifyUXUtil"],function(e,t,n,i,s,a){function o(){return widget.getValue("pad_security_ctx")}function l(){var e=widget.getValue("pad_security_ctx");e=e?e.replace("ctx::",""):e,widget.setValue("xPref_CREDENTIAL",e)}function r(e){l(),n.dispatchEvent("onPad_security_ctx",e)}n.addEvent("onPad_tenant",function(){CredentialUI.render()});var c=null,d=!1;let u=!1;return CredentialUI={getCredential:o,getCredentialWhenReady:function(){return new Promise(e=>{this.getCredential()?e():n.addEventOnce("onPad_security_ctx",e)})},getLabelOfCredential:function(t){return new Promise((n,i)=>{e.getAvailableCredentials().then(function(e){var i=null;e.credentials.every(function(e){return e.translate.value===t&&(i=e.translate.label),null===i}),n(i)}).catch(i)})},setCredential:function(e,i){return new Promise(s=>{let o=Promise.resolve();u&&e&&(o=this.getLabelOfCredential(e)),o.then(function(o){widget.setValue("pad_security_ctx",e),n.setSetting("pad_security_ctx",e),r(e),o&&t.displayNotification({message:a.replace(i||a.credentialChanged,{credential:o}),className:"primary"}),s()}).catch(function(e){console.log(e),t.displayNotification({message:a.setCredentialError,className:"error"}),s()})})},render:async function(h){u=!0;var m=this.getCredential(),p=window.top.dsUserLogin,f=p!==widget.getValue("dsUser");f&&widget.setValue("pad_security_ctx",void 0),widget.setValue("dsUser",p),l();try{let l=await e.getAvailableCredentials(m,f);var g=[];l.credentials.forEach(e=>g.push(e.translate));var v,b,C=this.getCredential();m=C||m,0===l.credentials.length&&(m="",n.dispatchEvent("onNoSecurityContext"));var _=-1;for(v=0,b=widget.preferences.length;v<b;v++)if("pad_security_ctx"===widget.preferences[v].name){_=v;break}d||(d=!0,widget.addEvent("onEdit",function(){c||(c=o())}),widget.addEvent("endEdit",function(){var e=o();e!==c&&r(e),c=null})),widget.addPreference({name:"pad_security_ctx",index:_,type:"list",label:"pad_security_ctx",options:g}),widget.setValue("pad_security_ctx",m);var y=Promise.resolve();if(l.credential){let e=g.filter(e=>e.value===m).length<=0,t=!(!window||!0!==window.isReplayODT);if(h&&h.widgetCBOnPopup&&m&&e&&!s.isNatifEnvironnement()&&!t){"function"==typeof h.widgetCBOnPopup&&h.widgetCBOnPopup();try{await i.render(!1,h)}catch(e){console.log(e),this.setCredential("")}}else if(m!==l.credential||f){var w=null;m&&!l.defaultMatches&&(w=a.badCredentialChanged),y=this.setCredential(l.credential,w)}}await y,c&&widget.dispatchEvent("onEdit")}catch(e){console.log(e),t.displayNotification({title:a.credentialError.title,subtitle:a.credentialError.subtitle,className:"error"})}}}});