define("DS/ENOXCAD_Save/utils/XCAD_LocalStorage",function(){"use strict";return{set:function(e,t,n){var o=this.generateKey(e,n);try{localStorage.setItem(o,JSON.stringify(t))}catch(e){console.log("XCAD_LocalStorage Notification SaveError")}},get:function(e,t){var n=this.generateKey(e,t),o=localStorage.getItem(n);return""!==o?JSON.parse(o):o},remove:function(e,t){var n=this.generateKey(e,t);return localStorage.removeItem(n)},generateKey:function(e,t){for(var n=["xcad"],o=0;o<t.length;o++)n.push(t[o]);return n.push(e),n.join("-")}}}),define("DS/ENOXCAD_Save/controllers/XCAD_ToggleRightPanelCmd",function(){"use strict";return{_InfoButton:null,_id:null,init:function(e,t){this._isEnable=!1,this._id=e,this._InfoButton=t,console.log("init : ENOUPSToggleRightPanelCmd"),widget.XCAD_MainController.ToolBarCommands[this._id]=this,this._InfoButton.addEventListener("buttonclick",function(e){widget.XCAD_MainController.toogleRightPanel()})},updateAvailability:function(e){}}}),define("DS/ENOXCAD_Save/controllers/XCAD_FilterCmd",function(){"use strict";return{_FilterCheckBox:null,_id:null,_isEnable:null,init:function(e,t){this._FilterCheckBox=t,this._id=e,this._isEnable=!0,widget.XCAD_MainController.ToolBarCommands[this._id]=this;var n=this;this._FilterCheckBox.addEventListener("change",function(){n.execute(n._FilterCheckBox.checkFlag)})},setFilterOption:function(e){this._FilterCheckBox.checkFlag=e},execute:function(e){console.log("execute : ("+this._id+")"),widget.XCAD_MainController.filterNotModified!==e&&widget.XCAD_MainController.ShowOnlyModifiedContentList(e)},updateAvailability:function(e){this._isEnable="Bookmark"!==widget.XCAD_MainController.ActiveCommandId,this._isEnable?this._FilterCheckBox.elements.container.dsModel.disabled=!1:this._FilterCheckBox.elements.container.dsModel.disabled=!0}}}),define("DS/ENOXCAD_Save/views/XCAD_Mask",["UWA/Core","DS/Controls/Loader","i18n!DS/ENOXCAD_Save/assets/nls/ENOXCADWebSaveColumns"],function(e,t,n){"use strict";return{mask:function(o,i){var a;this.isMasked(o)&&this.unmask(o),o.addClassName("XCADmasked"),a=e.createElement("div",{class:"XCADmask"}),this.loader=new t({text:e.is(i,"string")?i:n.get("loading"),showButtonFlag:!1}),i=e.createElement("div",{class:"mask-wrapper",html:{tag:"div",class:"mask-content",html:[this.loader]}}).inject(a),this.loader.on(),a.inject(o)},unmask:function(e){var t=e.getElement(" > .XCADmask");t&&(t.destroy(),this.loader&&(this.loader.off(),this.loader.destroy(),this.loader=null)),e.removeClassName("XCADmasked")},isMasked:function(e){return e.hasClassName("masked")}}}),define("DS/ENOXCAD_Save/controllers/XCAD_DuplicateCmd",function(){"use strict";return{_DuplicateButton:null,_id:null,_isEnable:null,init:function(e,t,n){this._isEnable=!1,this._id=e,this._DuplicateButton=t,this._ShowPrefixDialog=n,console.log("init : "+this._id),widget.XCAD_MainController.ToolBarCommands[this._id]=this,this._DuplicateButton.elements.button.dsModel.disabled=!0;var o=this;this._DuplicateButton.addEventListener("buttonclick",function(e){o.execute()})},execute:function(){console.log("execute : "+this._id),this._ShowPrefixDialog?widget.XCAD_MainController.showDuplicateDialog(this._id):widget.XCAD_MainController.onDuplicateOk("")},updateAvailability:function(e){if(this._isEnable=Object.keys(e).length>0,this._isEnable)for(var t in e)if(void 0!==e[t]._options.Available_Commands&&null!==e[t]._options.Available_Commands&&-1===e[t]._options.Available_Commands.indexOf(this._id)||"Bookmark"===widget.XCAD_MainController.ActiveCommandId){this._isEnable=!1;break}this._isEnable?this._DuplicateButton.elements.button.dsModel.disabled=!1:this._DuplicateButton.elements.button.dsModel.disabled=!0}}}),define("DS/ENOXCAD_Save/views/XCAD_RightView",["DS/WebappsUtils/WebappsUtils","DS/Controls/Toggle","i18n!DS/ENOXCAD_Save/assets/nls/ENOXCADWebSaveRightViewNls"],function(e,t,n){"use strict";return{_previewMainDiv:null,_saveInfoview:null,_saveOptionsview:null,_ENOUPSRightDiv:null,_ttNew:null,_tMod:null,_tExc:null,_tInc:null,_toogleUnreserve:null,_toogleAsyncSave:null,_tooglePGP:null,_tooglePMR:null,_toogleKeepIteration:null,_contextualBookmarkInfo:null,_BookmarkLabelView:null,_WorkUnderInfo:null,_ChangeActionLabel:null,_NoDefaultBookmarkWarningView:null,_NotAllObjectsInBookmarkView:null,_NotAllLockedWarningView:null,_NotAllWithReadAccessWarningview:null,_pathToModule:null,_toogleAddComment:null,_AddCommentTextarea:null,_toogleExposePublication:null,_toogleApplyMaterial:null,init:function(){this._pathToModule=e.getWebappsBaseUrl(),this._ENOUPSRightDiv=new UWA.Element("div",{class:"PreviewSaveInfoViewContainer"});this._previewMainDiv=new UWA.Element("div",{class:"ContextualInfo"}).inject(this._ENOUPSRightDiv),new UWA.Element("img",{id:"idBase64",class:"PreviewImg",src:"data:image/png;base64,Qk1CAAAAAAAAAD4AAAAoAAAAAQAAAAEAAAABAAEAAAAAAAQAAADDDgAAww4AAAAAAAAAAAAAAAAAAP///wCAAAAA",alt:"Preview"}).inject(this._previewMainDiv),new UWA.Element("hr",{class:"Separator"}).inject(this._ENOUPSRightDiv),this._saveInfoview=new UWA.Element("div",{class:"SaveInfo",id:"SaveStats"});var o=document.createElement("div");o.appendChild(document.createTextNode(n.get("Save_stats"))),o.appendChild(document.createElement("br")),this._tNew=document.createTextNode("New : "),o.appendChild(this._tNew);var i=document.createElement("br");o.appendChild(i),this._tMod=document.createTextNode("Modified : "),o.appendChild(this._tMod);var a=document.createElement("br");o.appendChild(a),this._tExc=document.createTextNode("Excluded : "),o.appendChild(this._tExc);var l=document.createElement("br");o.appendChild(l),this._tInc=document.createTextNode("Included : "),o.appendChild(this._tInc);var s=document.createElement("br");o.appendChild(s),this._saveInfoview.appendChild(o),this._saveInfoview.inject(this._ENOUPSRightDiv);var d=widget.XCAD_MainController._UIConfig.saveoptions,r=this;r._saveOptionsview=new UWA.Element("div",{class:"saveoptions",id:"SaveOptions"}).inject(r._ENOUPSRightDiv),d.forEach(function(e){var o=!0;if("false"==e.visible&&(o=!1),e.version<=widget.XCAD_MainController._Version&&"checkbox"===e.uitype){var i=new t({label:n.get(e.id),touchMode:!1,visibleFlag:o}).inject(r._saveOptionsview,"bottom");switch(i.getContent().id=e.id,e.id){case"PGP_checkbox":r._tooglePGP=i,r._tooglePGP.addEventListener("change",function(){widget.XCAD_MainController.onChangePGPCheck(r._tooglePGP.checkFlag)});break;case"PMR_checkbox":r._tooglePMR=i,r._tooglePMR.addEventListener("change",function(){widget.XCAD_MainController.onChangePMRCheck(r._tooglePMR.checkFlag)});break;case"KeepIteration_checkbox":r._toogleKeepIteration=i,r._toogleKeepIteration.addEventListener("change",function(){widget.XCAD_MainController.onChangeKeepIterationOption(r._toogleKeepIteration.checkFlag)});break;case"Unreserve_checkbox":r._toogleUnreserve=i,r._toogleUnreserve.addEventListener("change",function(){widget.XCAD_MainController.onChangeUnreserveCheck(r._toogleUnreserve.checkFlag)});break;case"Async_checkbox":r._toogleAsyncSave=i,r._toogleAsyncSave.addEventListener("change",function(){widget.XCAD_MainController.onChangeIsAsyncSave(r._toogleAsyncSave.checkFlag)});break;case"ExposePublication_checkbox":r._toogleExposePublication=i,r._toogleExposePublication.addEventListener("change",function(){widget.XCAD_MainController.onChangeExposePublicationOption(r._toogleExposePublication.checkFlag)});break;case"ApplyMaterial_checkbox":r._toogleApplyMaterial=i,r._toogleApplyMaterial.addEventListener("change",function(){widget.XCAD_MainController.onChangeApplyMaterialOption(r._toogleApplyMaterial.checkFlag)});break;case"SaveComment_checkbox":r._toogleAddComment=i,r._toogleAddComment.addEventListener("change",function(){!0===r._toogleAddComment.checkFlag&&!0===r._toogleAddComment.visibleFlag?(r._AddCommentTextarea=new UWA.Element("textarea",{class:"textarea",type:"text",rows:"20",cols:"40",maxlength:"256",placeholder:n.get("AddComment_textbox"),styles:{visibility:"visible"}}).inject(r._saveOptionsview,"bottom"),r._AddCommentTextarea.addEventListener("change",function(){widget.XCAD_MainController.onAddCommentEditor(r._AddCommentTextarea.value)}),r._AddCommentTextarea.focus()):null!==r._AddCommentTextarea&&r._AddCommentTextarea.remove(),widget.XCAD_MainController.onAddCommentChange(r._toogleAddComment.checkFlag)})}}})},updateSaveInfo:function(e,t,o,i){this._tNew.textContent=n.get("Nb_New",{nbNew:e}),this._tMod.textContent=n.get("Nb_Mod",{nbMod:t}),this._tExc.textContent=n.get("Nb_Exc",{nbExc:o}),this._tInc.textContent=n.get("Nb_Inc",{nbInc:i})},UpdateBookmarkContextualInfo:function(e){"undefined"!==e&&""!==e?(null===this._contextualBookmarkInfo?(this._contextualBookmarkInfo=new UWA.Element("div",{class:"BookmarkInfo"}),new UWA.Element("img",{class:"contextual_bookmark_icon",id:"bookmarkIcon",src:this._pathToModule+"ENOXCAD_Save/assets/icons/32/I_UPSBookmark.png"}).inject(this._contextualBookmarkInfo),this._BookmarkLabelView=document.createTextNode(e),this._contextualBookmarkInfo.appendChild(this._BookmarkLabelView)):this._BookmarkLabelView.textContent=e,this._contextualBookmarkInfo.inject(this._previewMainDiv),this._contextualBookmarkInfo.style.visibility="visible"):null!==this._contextualBookmarkInfo&&(this._contextualBookmarkInfo.style.visibility="hidden",this._contextualBookmarkInfo.remove())},UpdateWorkUnderInfo:function(e){if("undefined"!==e&&""!==e){if(null===this._WorkUnderInfo){this._WorkUnderInfo=new UWA.Element("div",{class:"WorkUnder",styles:{visibility:"hidden"}}),new UWA.Element("img",{class:"WorkUnder_icon",id:"WorkUnder",src:this._pathToModule+"ENOXCAD_Save/assets/icons/32/I_ENOUPSSaveUnderChange.png"}).inject(this._WorkUnderInfo);var t=document.createTextNode(n.get("Work_Under"));this._WorkUnderInfo.appendChild(t);var o=document.createElement("br");this._WorkUnderInfo.appendChild(o),this._ChangeActionLabel=document.createTextNode(e),this._WorkUnderInfo.appendChild(this._ChangeActionLabel)}else this._ChangeActionLabel.textContent=e;this._WorkUnderInfo.style.visibility="visible",this._WorkUnderInfo.inject(this._ENOUPSRightDiv)}else null!==this._WorkUnderInfo&&this._WorkUnderInfo.remove()},DisplayNoDefaultBookmarkWarning:function(e){if(e){if(null===this._NoDefaultBookmarkWarningView){this._NoDefaultBookmarkWarningView=new UWA.Element("div",{styles:{visibility:"hidden"}}),new UWA.Element("img",{class:"warning_icon",id:"warningBookmark",src:this._pathToModule+"ENOXCAD_Save/assets/icons/32/I_XCADWarning.png"}).inject(this._NoDefaultBookmarkWarningView);var t=document.createTextNode(n.get("No_DefaultBookmark"));this._NoDefaultBookmarkWarningView.appendChild(t)}this._NoDefaultBookmarkWarningView.style.visibility="visible",this._NoDefaultBookmarkWarningView.inject(this._ENOUPSRightDiv)}else null!==this._NoDefaultBookmarkWarningView&&this._NoDefaultBookmarkWarningView.remove()},DisplayNotAllObjectsInBookmarkWarning:function(e){if(e){if(null===this._NotAllObjectsInBookmarkView){this._NotAllObjectsInBookmarkView=new UWA.Element("div",{styles:{visibility:"hidden"}}),new UWA.Element("img",{class:"warning_icon",id:"warningBookmark2",src:this._pathToModule+"ENOXCAD_Save/assets/icons/32/I_XCADWarning.png"}).inject(this._NotAllObjectsInBookmarkView);var t=document.createTextNode(n.get("Not_AllObjectsInBookmark"));this._NotAllObjectsInBookmarkView.appendChild(t)}this._NotAllObjectsInBookmarkView.style.visibility="visible",this._NotAllObjectsInBookmarkView.inject(this._ENOUPSRightDiv)}else null!==this._NotAllObjectsInBookmarkView&&this._NotAllObjectsInBookmarkView.remove()},DisplayNotAllLockedWarning:function(e){if(e){if(null===this._NotAllLockedWarningView){this._NotAllLockedWarningView=new UWA.Element("div",{styles:{visibility:"hidden"}}),new UWA.Element("img",{class:"warning_icon",id:"warningUnlocked",src:this._pathToModule+"ENOXCAD_Save/assets/icons/32/I_XCADWarning.png"}).inject(this._NotAllLockedWarningView);var t=document.createTextNode(n.get("Not_AllLocked"));this._NotAllLockedWarningView.appendChild(t)}this._NotAllLockedWarningView.style.visibility="visible",this._NotAllLockedWarningView.inject(this._ENOUPSRightDiv)}else null!==this._NotAllLockedWarningView&&this._NotAllLockedWarningView.remove()},DisplayNoReadAcceddWarning:function(e){if(e){if(null===this._NotAllWithReadAccessWarningview){this._NotAllWithReadAccessWarningview=new UWA.Element("div",{styles:{visibility:"hidden"}}),new UWA.Element("img",{class:"warning_icon",id:"warningUnlocked",src:this._pathToModule+"ENOXCAD_Save/assets/icons/32/I_XCADWarning.png"}).inject(this._NotAllWithReadAccessWarningview);var t=document.createTextNode(n.get("No_ReadAccess"));this._NotAllWithReadAccessWarningview.appendChild(t)}this._NotAllWithReadAccessWarningview.style.visibility="visible",this._NotAllWithReadAccessWarningview.inject(this._ENOUPSRightDiv)}else null!==this._NotAllWithReadAccessWarningview&&this._NotAllWithReadAccessWarningview.remove()},onUpdatePreview:function(e){document.getElementById("idBase64").setAttribute("src","data:image/png;base64, "+e)},onRemovePreview:function(){document.getElementById("idBase64").setAttribute("src","data:image/png;base64, Qk1CAAAAAAAAAD4AAAAoAAAAAQAAAAEAAAABAAEAAAAAAAQAAADDDgAAww4AAAAAAAAAAAAAAAAAAP///wCAAAAA")}}}),define("DS/ENOXCAD_Save/views/XCAD_WarningView",["UWA/Core","DS/Controls/Button","DS/Windows/Dialog"],function(e,t,n){"use strict";return function(o,i){var a=new e.Element("div",{styles:{height:"100%",width:"100%"},html:"<p>"+i+"</p>"});new n({title:o,modalFlag:!0,content:a,immersiveFrame:widget.XCAD_MainController.myImmersiveFrame,buttons:{Ok:new t({onClick:function(e){e.dsModel.dialog.close()}})}}).getContent().id="XCADWarning_dialog"}}),define("DS/ENOXCAD_Save/controllers/XCAD_InteractionsWEB_CAD",["UWA/Core","DS/Core/Core","DS/ApplicationFrame/FrameWindow","DS/ApplicationFrame/ContextualUIManager","DS/WebappsUtils/WebappsUtils","DS/Utilities/Dom","DS/Tree/TreeListView","DS/TreeModel/TreeNodeModel","DS/TreeModel/TreeDocument","DS/ENOXCAD_Save/views/XCAD_Mask","i18n!DS/ENOXCAD_Save/assets/nls/ENOXCADWebSaveColumns"],function(e,t,n,o,i,a,l,s,d,r,c){"use strict";return{init:function(){"undefined"!=typeof dscef&&(dscef.XCADReceivedString=function(e){var t,n,o;switch(console.log('XCAD_InteractionsWEB_CAD - Message received from CAD : "'+JSON.stringify(e)+'"'),void 0!==r&&r.unmask(widget.body),"object"==typeof e&&(t=e.operation,n=e.operationVersion,o=e.content),widget.XCAD_MainController.UpdateActiveCommand(null),t){case"init":widget.XCAD_MainController._Version=n,void 0!==o&&widget.XCAD_MainController.init(o.nodes,o.SaveScope,o.WorkUnder,o.restrictedCharactersForFileName,o.myAppsBaseUrl,o.userId,o.lang,o.ShowPGP,o.tenantId,o.KeepIterationActivated,o.DisableBookmarkChooser,o.ExposePublicationActivated,o.ShowPMR,o.ApplyMaterialVisible);break;case"reloadWebModel":void 0!==o&&widget.XCAD_MainController.loadNodes(o.nodes);break;case"updateWebModel":void 0!==o&&widget.XCAD_MainController.updateNodes(o.nodes);break;case"DisplayDerivedOutputs":void 0!==o&&widget.XCAD_MainController.showDerivedOutputSidePanel(o.derivedOutputs);break;case"DisplayChangeMaturity":void 0!==o&&widget.XCAD_MainController.LaunchChangeMaturityPanel(o.addItems);break;case"DisplayWarning":void 0!==o&&widget.XCAD_MainController.displayWarning(o.AllIncludedLocked,o.AllIncludedWithReadAccess,o.DefaultBookmarkSet,o.AllObjectInBookmark);break;case"UpdatePreview":void 0!==o&&widget.XCAD_MainController.onUpdatePreview(o.previewBase64);break;case"DisplayNewFilenameDialog":void 0!==o&&widget.XCAD_MainController.showNewFileNameSidePanel(o.displayUUID,o.UUID);break;case"UpdateForSelectedNodes":void 0!==o&&(void 0!==o.previewBase64&&widget.XCAD_MainController.onUpdatePreview(o.previewBase64),widget.XCAD_MainController.UpdateCommandsAvailability(o.nodes));break;default:console.error("XCAD_InteractionsWEB_CAD - Error : unknown operation ("+t+")")}})},sendMessageToCad:function(e,t,n){var o={operation:e,operationVersion:t,content:n},i=JSON.stringify(o);"undefined"!=typeof dscef?("readyForInit"!==e&&"changeFilterNotModified"!==e&&"LaunchBookmark"!==e&&"ChangeIsAsyncSave"!==e&&"ChangeUnreserveCheck"!==e&&"ChangePGPCheck"!==e&&"ChangePMRCheck"!==e&&"ChangeKeepIteration"!==e&&"AddComment"!=e&&"IsAddCommentChecked"!=e&&"ChangeExposePublication"!==e&&"ChangeApplyMaterial"!==e&&"onMaturityUIReady"!=e&&"OnChangeMaturityIncludeChildren"!=e&&"OnChangeMaturityTransitionEnd"!=e&&"OnChangeMaturityCanceled"!=e&&"DerivedOutputOK"!==e&&"WebSavePanelLoaded"!==e&&"LaunchBookmarkEditorWidget"!==e&&"OnRemoveSelection"!==e&&void 0!==r&&r.mask(widget.body,c.get("Operation_"+e)),dscef.sendString(i)):"readyForInit"!==e||widget.XCAD_MainController._IsODTMode?"GetDerivedOutputsList"!==e||widget.XCAD_MainController._IsODTMode||this.fakeGetDerivedOutputsList():this.fakeInit(),console.log('Message sent to CAD : "'+i+'"')},fakeInit:function(){widget.XCAD_MainController.init([{AssignedBookmark:"",Available_Commands:null,CADType:"assembly",IsTemporaryDoc:!1,NodeId:"StringID:0",grid:{Action:"",Bookmarks:"",CAD_Type:"",Description:"",EntItemNumber:"",Filename:"Product1.CATProduct",Maturity:"",Name:"",Project:"",Reserve:"",Reserved_By:"",Revision:"",Revision_List:[],Save:"XCADIncluded",Status:["XCADStatusNew","XCADErrWarningUndefined"],Title:"Product1",Type:"Physical Product",Type_List:[]}}],2,"CA-4592950-00000001","\\/","https://vdevpril209dsy.ux.dsone.3ds.com:443/3DSpace","all","en",!0)},fakeGetDerivedOutputsList:function(){widget.XCAD_MainController.showDerivedOutputSidePanel([{name:"DO_NotChecked",icon:"I_UPSUnChecked"},{name:"DO_Checked",icon:"I_UPSCheckBox"},{name:"CheckedMix",icon:"I_UPSPartialCheck"}])}}}),define("DS/ENOXCAD_Save/controllers/XCAD_ChangeSaveScopeCmd",["DS/ENOXCAD_Save/controllers/XCAD_InteractionsWEB_CAD"],function(e){"use strict";return{_SaveScopeCombobox:null,_id:null,_isEnable:null,init:function(e,t,n){this._SaveScopeCombobox=t,this._id=e,this._isEnable=n,widget.XCAD_MainController.ToolBarCommands[this._id]=this;var o=this;this._SaveScopeCombobox.addEventListener("change",function(e){o.execute(e)})},setSaveScope:function(e){this._SaveScopeCombobox.selectedIndex=e},execute:function(t){if(console.log("execute : ChangeSaveScopeCmd ("+this._id+")"),widget.XCAD_MainController.saveScope!==t.dsModel.selectedIndex){widget.XCAD_MainController.saveScope=t.dsModel.selectedIndex;var n={saveScope:t.dsModel.selectedIndex};e.sendMessageToCad("changeSaveScope","1.0",n)}},updateAvailability:function(e){var t="Bookmark"===widget.XCAD_MainController.ActiveCommandId;this._SaveScopeCombobox.elements.container.dsModel.disabled=!!t||!this._isEnable}}}),define("DS/ENOXCAD_Save/views/XCAD_NewBranchView",["UWA/Core","DS/Core/Core","DS/ApplicationFrame/ContextualUIManager","DS/WebappsUtils/WebappsUtils","DS/Utilities/Dom","DS/Controls/LineEditor","DS/Controls/Button","DS/ENOXCAD_Save/controllers/XCAD_InteractionsWEB_CAD","DS/Windows/Dialog","i18n!DS/ENOXCAD_Save/assets/nls/ENOXCADWebSaveToolBarNls"],function(e,t,n,o,i,a,l,s,d,r){"use strict";return function(t,n,o){var i,c=!1;if(1===t&&"embeddedComponent"!=o){c=!0,i=new e.Element("div",{styles:{height:"100%",width:"100%"},html:"<p>"+r.get("NewBranchLineEditorForTitle")+"</p>"});var u=new a({value:n,touchMode:!1,requireFlag:!0,placeholder:"",requiredFlag:!0,autoCommitFlag:!0,sizeInCharNumber:40})}else i=new e.Element("div",{styles:{height:"100%",width:"100%"},html:"<p>"+r.get("NewBranchLineEditorForPrefix")+"</p>"}),u=new a({value:"",touchMode:!1,requireFlag:!0,placeholder:r.get("PrefixHolder"),requiredFlag:!1,autoCommitFlag:!0,sizeInCharNumber:40});u.inject(i),u.getContent().id="XCADNewBranch_lineeditor";var C=new d({title:r.get("BranchDialogTitle"),modalFlag:!0,content:i,immersiveFrame:widget.XCAD_MainController.myImmersiveFrame,buttons:{Cancel:new l({onClick:function(e){var t=e.dsModel.dialog;console.log("on Cancel button : dialog title = "+t.title),t.close()}}),Ok:new l({onClick:function(e){var t=e.dsModel.dialog;console.log("on OK button : branch prefix= "+u.value);var n={selectedNodesId:Object.keys(widget.XCAD_MainController.selectedNodes),value:u.value,isTitle:c};s.sendMessageToCad("NewBranch","1.0",n),t.close()}})}});C.getContent().id="XCADNewBranch_dialog";var _="[:!]+";_=_.replace("\\","\\\\"),u.addEventListener("change",function(e){var t=!1;t=u.value.length>=0&&" "==u.value.substr(0,1)||RegExp(_).test(u.value),C.buttons.Ok.disabled=t})}}),define("DS/ENOXCAD_Save/views/XCAD_SetDerivedOutputView",["UWA/Core","DS/Core/Core","DS/ApplicationFrame/ContextualUIManager","DS/WebappsUtils/WebappsUtils","DS/Utilities/Dom","DS/Controls/Button","DS/Controls/ButtonGroup","DS/Windows/Dialog","DS/ENOXCAD_Save/controllers/XCAD_InteractionsWEB_CAD","DS/Controls/Toggle","DS/Controls/Tab","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/TreeModel/DataModelSet","DS/DataGridView/DataGridView","DS/Windows/ImmersiveFrame","DS/Controls/Expander","DS/ENOXCAD_Save/utils/XCAD_LocalStorage","i18n!DS/ENOXCAD_Save/assets/nls/ENOXCADWebSaveToolBarNls"],function(e,t,n,o,i,a,l,s,d,r,c,u,C,_,h,g,v,m,p){"use strict";return function(e){if(widget.XCAD_MainController._Version<7){var t=new UWA.Element("div",{class:"wux-control-inline-container",style:{"vertical-align":"top"}}),n=document.createElement("h1"),o=document.createTextNode("Checkbox values : ");n.appendChild(o),t.appendChild(n),(M=new c({displayStyle:"strip",newTabButtonFlag:!1})).getContent().getChildren().find(e=>e.className.includes("wux-controls-tab-strip")).addClassName("DOTabConatainer");for(var i=0;i<e.length;i++){var d=e[i],_=d.type,g=d.derivedOutputsList;if(0!==g.length){for(var A=new UWA.Element("div",{class:"wux-control-inline-container",style:{"vertical-align":"top"}}),D=new l({type:"checkbox"}).inject(A),f=0;f<g.length;f++)D.addChild(new r({type:"checkbox",label:g[f].name,checkFlag:"XCAD_DO_UnChecked"!==g[f].icon,mixedState:"XCAD_DO_MixedState"===g[f].icon,disabled:"XCAD_DO_CheckedEnforced"===g[f].icon,value:""}));D.addEventListener("change",function(e){o.textContent="Checkbox values : "+e.dsModel.value.toString()}),M.add({label:_,content:A,isSelected:0===i,value:_})}}return(k=new s({title:p.get("DerivedOutputDialogTitle"),modalFlag:!0,content:M,immersiveFrame:widget.XCAD_MainController.myImmersiveFrame,buttons:{Cancel:new a({onClick:function(e){var t=e.dsModel.dialog;console.log("on Cancel button : dialog title = "+t.title),t.close()}}),Ok:new a({onClick:function(e){for(var t=e.dsModel.dialog,n=t.content.elements.container.dsModel,o=[],i=0;i<n.getPageCount();i++){var a=n.getPageContentFromIndex(i).getChildren()[0].dsModel.elements.container.getChildren(),l=[];for(var s in a)if(a.hasOwnProperty(s)){var d=a[s].dsModel,r="";r=!1===d.checkFlag?"XCAD_DO_UnChecked":!0===d.disabled?"XCAD_DO_CheckedEnforced":!0===d.mixedState?"XCAD_DO_MixedState":"XCAD_DO_Checked",l.push({name:d.label,icon:r})}o.push({type:n.getPageValueFromIndex(i),derivedOutputsList:l})}widget.XCAD_MainController.onSetDerivedOutputOk(o),t.close()}})}})).getContent().addClassName("DODialogContainer"),k.getContent().id="XCADDerivedOutputs_dialog",k}{var b={};let t="";var S,w,M,k,y=[];(M=new c({displayStyle:"strip",newTabButtonFlag:!1})).getContent().getChildren().find(e=>e.className.includes("wux-controls-tab-strip")).addClassName("DOTabConatainer");for(var E=0;E<e.length;E++){var N,O=[],X=e[E],I=X.type,x=X.backgroundDerivedOutputList;b[E]=I,S=b[0];for(i=0;i<x.length;i++){var B={icon:x[i].icon,id:x[i].id};O.push(B),"XCAD_DO_Checked"===x[i].icon?x[i].icon="true":"XCAD_DO_UnChecked"===x[i].icon&&(x[i].icon="false")}var T=new u;T.prepareUpdate();i=0;for(var P=x.length;i<P;i++){var U=x[i],W=new C({label:U.Title,grid:U});T.addRoot(W)}T.pushUpdate(),T.onNodeModelUpdate(function(e){if(e.data.nodeModel){e.data.attributes;var t=e.target.getAttributeValue("id"),n=e.target.getAttributeValue("icon");!0===n?n="XCAD_DO_Checked":!1===n&&(n="XCAD_DO_UnChecked");for(var o=0;o<y.length;o++){var i=y[o].type,a=y[o].backgroundDerivedOutputList;if(i===S){for(var l=0;l<a.length;l++)a[l].id===t&&(a[l].icon=n);y[o].backgroundDerivedOutputList=a}}}});var F=[{dataIndex:"icon",typeRepresentation:"boolean",editionPolicy:"EditionInPlace",alignment:"center",pinned:"left",width:20,getCellSemantics:function(e){if("XCAD_DO_CheckedEnforced"===e.nodeModel.getAttributeValue("icon"))return{disabled:!0}}},{dataIndex:"name",text:p.get("DOAsyncColumnTargetFormatText"),typeRepresentation:"string",editableFlag:!1,alignment:"left",width:87},{dataIndex:"parameters",text:p.get("DOAsyncColumnParametersText"),typeRepresentation:"string",alignment:"left",editableFlag:!1,resizableFlag:!0,allowUnsafeHTMLContent:!0,getCellValue:function(e){var t="",n=[],o=e.nodeModel.getAttributeValue("parameters");if(""!=o&&(n=o.split(",")),0!=n.length)for(var i=0;i<n.length;i++){var a=n[i],l=a.indexOf(":");t=t+"<b>"+(a.substring(0,l+1)+" ")+"</b>"+a.substring(l+1)+"  "}return t}},{dataIndex:"unifiedFormat",text:p.get("DOAsyncColumnUnifiedFormatText"),editableFlag:!1,alignment:"left",width:90}],R=new UWA.Element("div",{class:"DerivedOutput-container",style:{"vertical-align":"top"}}),L=new UWA.Element("div",{class:"Sync-container",style:{"vertical-align":"top"}}),V=new UWA.Element("div",{class:"AsyncDO-container",style:{"vertical-align":"top"}});new h({class:"myDataGridViewId",treeDocument:T,columns:F,showAlternateBackgroundFlag:!1,showBackgroundFlag:!1,showRowIndexFlag:!1,showRowHeaderBackgroundFlag:!1,defaultColumnDef:{minWidth:20,editableFlag:!0,sortableFlag:!1,resizableFlag:!0},layoutOptions:{columnsHeader:!0,rowsHeader:!1,rowSpacing:1}}).inject(V);var j=X.derivedOutputsList;N=j;for(D=new l({type:"checkbox"}).inject(L),f=0;f<j.length;f++)D.addChild(new r({type:"checkbox",label:j[f].name,checkFlag:"XCAD_DO_UnChecked"!==j[f].icon,disabled:"XCAD_DO_CheckedEnforced"===j[f].icon,value:""}));D.addEventListener("buttonclick",function(e){for(var t=e.dsModel,n=0;n<y.length;n++){var o=y[n].type,i=y[n].derivedOutputsList;if(o===S){for(var a=0;a<i.length;a++)i[a].name===t.label&&(!0===t.checkFlag?i[a].icon="XCAD_DO_Checked":!1===t.checkFlag&&(i[a].icon="XCAD_DO_UnChecked"));y[n].SyncderivedOutputs_Icon_Dico=i}}}),0===E&&(t=I);var H={IsSyncExpanded:!1,IsAsyncExpanded:!1},G=m.get("SyncAsyncExpanderPreferences",widget.XCAD_MainController.localStorageOptions);null===G&&((G={})[I]=H),null!==G&&(void 0!==G[I]?H=G[I]:G[I]=H),m.set("SyncAsyncExpanderPreferences",G,widget.XCAD_MainController.localStorageOptions);var K=new v({header:p.get("DOSyncExpanderHeader"),body:L,style:"simple",expandedFlag:H.IsSyncExpanded}).inject(R),q=new v({header:p.get("DOAsyncExpanderHeader"),body:V,style:"simple",expandedFlag:H.IsAsyncExpanded}).inject(R);0===x.length&&(q.visibleFlag=!1),0===j.length&&(K.visibleFlag=!1),M.add({label:I,content:R,isSelected:0===E}),M.addEventListener("tabButtonClick",function(e){var n=e.options.value;S=b[n],t=S}),K.getContent().addEventListener("expand",function(){null!==(G=m.get("SyncAsyncExpanderPreferences",widget.XCAD_MainController.localStorageOptions))&&null!=G[t]&&(G[t].IsSyncExpanded=!0,m.set("SyncAsyncExpanderPreferences",G,widget.XCAD_MainController.localStorageOptions))}),K.getContent().addEventListener("collapse",function(){null!==(G=m.get("SyncAsyncExpanderPreferences",widget.XCAD_MainController.localStorageOptions))&&null!=G[t]&&(G[t].IsSyncExpanded=!1,m.set("SyncAsyncExpanderPreferences",G,widget.XCAD_MainController.localStorageOptions))}),q.getContent().addEventListener("expand",function(){null!==(G=m.get("SyncAsyncExpanderPreferences",widget.XCAD_MainController.localStorageOptions))&&void 0!==G[t]&&(G[t].IsAsyncExpanded=!0,m.set("SyncAsyncExpanderPreferences",G,widget.XCAD_MainController.localStorageOptions))}),q.getContent().addEventListener("collapse",function(){null!==(G=m.get("SyncAsyncExpanderPreferences",widget.XCAD_MainController.localStorageOptions))&&void 0!==G[t]&&(G[t].IsAsyncExpanded=!1,m.set("SyncAsyncExpanderPreferences",G,widget.XCAD_MainController.localStorageOptions))}),console.log("SyncDO:"+N),console.log("AsyncDO:"+N),w={type:I,derivedOutputsList:N,backgroundDerivedOutputList:O},y.push(w)}return(k=new s({title:p.get("DerivedOutputDialogTitle"),modalFlag:!0,content:M,resizableFlag:!0,minHeight:200,buttons:{Cancel:new a({onClick:function(e){var t=e.dsModel.dialog;console.log("on Cancel button : dialog title = "+t.title),console.log(y),t.close()}}),Ok:new a({onClick:function(e){var t=e.dsModel.dialog;t.content.elements.container.dsModel;widget.XCAD_MainController.onSetDerivedOutputOk(y),t.close()}})}})).getContent().addClassName("DODialogContainer"),k.getContent().id="XCADDerivedOutputs_dialog",k}}}),define("DS/ENOXCAD_Save/views/XCAD_TreeListView",["DS/WebappsUtils/WebappsUtils","DS/Utilities/Dom","DS/DataGridView/DataGridView","DS/Controls/TooltipModel","DS/Controls/Toggle","DS/ENOXCAD_Save/controllers/XCAD_InteractionsWEB_CAD","DS/Controls/ComboBox","i18n!DS/ENOXCAD_Save/assets/nls/ENOXCADWebSaveToolBarNls","i18n!DS/ENOXCAD_Save/assets/nls/ENOXCADWebSaveColumns","text!DS/ENOXCAD_Save/assets/XCAD_CATIAV5ColumnsModel.json","DS/ENOXCAD_Save/utils/XCAD_LocalStorage"],function(e,t,n,o,i,a,l,s,d,r,c){"use strict";return function(i){var l=JSON.parse(r),u=widget.XCAD_MainController._columnsJson;widget.XCAD_MainController._Version<"6.1"&&(l=l.filter(e=>"Owner"!=e.dataIndex&&"Organization"!=e.dataIndex));var C=[];if(0!=u&&null!=u)for(var _=u.content.Columns,h=0;h<_.length;h++){for(var g=!0,v=0;v<l.length;v++)l[v].dataIndex===_[h].id&&(C.push(l[v]),g=!1);if(g){var m={text:_[h].label,dataIndex:_[h].id,isEditable:"false",typeRepresentation:"string"};C.push(m)}}else C=l;var p=new n({treeDocument:i.model,columns:C,identifier:"xCADSaveDataGrid",showRowIndexFlag:!1,showRowBorderFlag:!1,showSelectionCheckBoxesFlag:!1,showRowHeaderBackgroundFlag:!1,rowGroupingEnabledFlag:!1,cellSelection:"none",rowSelection:"multiple",columnsHeader:!0,rowHeader:!1,defaultColumnDef:{width:"auto",resizableFlag:!0,sortableFlag:!0},selectionBehavior:{unselectAllOnEmptyArea:!0,unselectAllOnEscapeKey:!0,selectOnContextualEvent:!1},layoutOptions:{rowsHeader:!1},getCellTooltip:function(e){var t="",n="",o="";if(!e.isHeader){if(null!=e.nodeModel&&"Status"==C[e.columnID].dataIndex){for(var i=0;i<e.nodeModel.options.grid.Status.length;i++){if(2==e.nodeModel.options.grid.Status[i].length){var a=e.nodeModel.options.grid.Status[i];n=a[0],o=a[1]}else n=e.nodeModel.options.grid.Status[i];""!==n&&-1===n.indexOf("Undefined")&&(0!==i&&(t+="\n"),t+=d.get(n))}return{shortHelp:t+=o,updateModel:!1}}return null!=e.nodeModel&&"Reserve"==C[e.columnID].dataIndex?(e.nodeModel&&e.nodeModel.options&&e.nodeModel.options.grid&&e.nodeModel.options.grid.Reserve&&-1===e.nodeModel.options.grid.Reserve.indexOf("undefined")&&(t=d.get(e.nodeModel.options.grid.Reserve)),{shortHelp:t,updateModel:!1}):null!=e.nodeModel&&"Action"==C[e.columnID].dataIndex?(e.nodeModel&&e.nodeModel.options&&e.nodeModel.options.grid&&e.nodeModel.options.grid.Action&&-1===e.nodeModel.options.grid.Action.indexOf("undefined")&&(t=d.get(e.nodeModel.options.grid.Action)),{shortHelp:t,updateModel:!1}):null!=e.nodeModel&&"Save"==C[e.columnID].dataIndex?(e.nodeModel&&e.nodeModel.options&&e.nodeModel.options.grid&&e.nodeModel.options.grid.Save&&-1===e.nodeModel.options.grid.Save.indexOf("undefined")&&(t=d.get(e.nodeModel.options.grid.Save)),{shortHelp:t,updateModel:!1}):null!=e.nodeModel&&"Bookmarks"==C[e.columnID].dataIndex?(e.nodeModel&&e.nodeModel.options&&e.nodeModel.options.grid&&e.nodeModel.options.grid.Bookmarks&&-1===e.nodeModel.options.grid.Bookmarks.indexOf("undefined")&&(t=d.get(e.nodeModel.options.grid.Bookmarks)),{shortHelp:t,updateModel:!1}):null!=e.nodeModel&&"tree"==C[e.columnID].dataIndex?(e.nodeModel&&e.nodeModel.options&&e.nodeModel.options.grid&&e.nodeModel.options.grid.Title&&(t=e.nodeModel.options.grid.Title),{shortHelp:t,updateModel:!1}):{shortHelp:e.cellModel,updateModel:!1}}},onContextualEvent:function(t){var n=[];if(t&&t.collectionView){var o=!0;n=t.collectionView.buildDefaultContextualMenu(t,{insertRow:!1,expandCollapse:!0,pin:!0,firstColumnsVisibility:!1,columnsManagement:!0}),t&&t.collectionView&&t.cellInfos.nodeModel&&!t.collectionView.isHeader&&(Object.keys(widget.XCAD_MainController.selectedNodes).length<=1&&(o=void 0!==widget.XCAD_MainController.selectedNodes[t.cellInfos.nodeModel._options.NodeId]),t.cellInfos.rowID>-1&&!0===o&&!1===widget.XCAD_MainController._isCtxEventAsync?widget.XCAD_MainController._UIConfig.commands.forEach(function(t){var o=!0;"false"==t.visible&&(o=!1);var i=!0;if("undefined"!=t.CtxMenu&&"false"===t.CtxMenu&&(i=!1),i&&o&&t.version<=widget.XCAD_MainController._Version&&"undefined"!==widget.XCAD_MainController.ToolBarCommands[t.id]){var a=e.getWebappsBaseUrl()+"ENOXCAD_Save/assets/icons/32/"+t.icon;n.push({type:"PushItem",icon:"url("+a+")",title:s.get(t.id),state:widget.XCAD_MainController.ToolBarCommands[t.id]._isEnable?"enabled":"disabled",action:{callback:function(){widget.XCAD_MainController.ToolBarCommands[t.id].execute()}}})}}):(t.cellInfos.nodeModel.select(!0),widget.XCAD_MainController._NodePositionForCtxMenuDisplay=t.cellInfos,widget.XCAD_MainController._CtxMenuEvent=t.data.event,widget.XCAD_MainController._isCtxEventAsync=!0))}return n}});p.registerReusableCellContent({id:"Status",buildContent:function(){var e=t.createElement("span"),n=t.createElement("img");e.appendChild(n);var o=t.createElement("img");return e.appendChild(o),e}}),p.onCustomViewsSave=function(e,t){var n=e;c.set("CustomGridViews",n,widget.XCAD_MainController.localStorageOptions),c.set("CurrentCustomViewIndex",t,widget.XCAD_MainController.localStorageOptions)};var A,D=c.get("CustomGridViews",widget.XCAD_MainController.localStorageOptions),f=c.get("CurrentCustomViewIndex",widget.XCAD_MainController.localStorageOptions);if(A="number"==typeof f?f>=0:f,D&&A){let e=p.getCustomViewsManager();D.forEach(t=>e.addCustomView(t)),e.setCurrentCustomView(f)}return p.onReady(function(){widget.XCAD_MainController.disableOnWidthColumnUpdateCallbak=!1;var e={Version:widget.XCAD_MainController._Version};a.sendMessageToCad("readyForInit","",e),widget.XCAD_MainController.BuildToolBarView()}),C.forEach(function(e){var t=e.text;e.text=d.get(t)}),C&&C.forEach(function(t){if("Revision"===t.dataIndex)t.getCellSemantics=function(e){return{possibleValues:e.nodeModel.options.grid.Revision_List}},t.setCellValue=function(e,t){e.nodeModel.options.grid.Revsion!==t&&(void 0!==e.nodeModel.options.Available_Commands&&-1!==e.nodeModel.options.Available_Commands.indexOf("Revise")?widget.XCAD_MainController.ToolBarCommands.Revise.execute():widget.XCAD_MainController.ToolBarCommands.Revise.resetRevision(t))};else if("Bookmarks"===t.dataIndex)t.getCellValue=function(e){var t="";return""!==e.nodeModel.options.AssignedBookmark?(t="<b>"+e.nodeModel.options.AssignedBookmark+"</b>",""!==e.nodeModel.options.grid.Bookmarks&&(t=t+"|"+e.nodeModel.options.grid.Bookmarks)):t=e.nodeModel.options.grid.Bookmarks,t};else if("Type"===t.dataIndex){var n=function(e){return function(e){return-1!==e.nodeModel.options.grid.Status.indexOf("XCADStatusNew")}(e)&&void 0!==e.nodeModel.options.grid.Type_List&&e.nodeModel.options.grid.Type_List.length>1};t.getCellTypeRepresentation=function(e){var t;return e.nodeModel&&(t=n(e)?"enumString":"string"),t},t.getCellSemantics=function(e){if(n(e))return{possibleValues:e.nodeModel.options.grid.Type_List}},t.getCellValue=function(e){return e.nodeModel.options.grid.Type},t.setCellValue=function(e,t){if(n(e)&&e.nodeModel.options.grid.Type!==t){var o={selectedNodesId:[e.nodeModel._options.NodeId],selectedType:t},i=widget.XCAD_MainController._Version;a.sendMessageToCad("ChangeType",i,o),e.nodeModel.updateOptions({grid:{Type:t}})}},t.getCellEditableState=function(e){if(e&&e.nodeModel)return!!n(e)}}else if("Status"===t.dataIndex)t.onCellRequest=function(t){var n="",i="",a="",l=t.cellView.collectionView.reuseCellContent("Status");l.children[0].src="",l.children[1].src="";for(var s="",r=0;r<t.nodeModel.options.grid.Status.length;r++){if(2==t.nodeModel.options.grid.Status[r].length){var c=t.nodeModel.options.grid.Status[r];i=c[0],a=c[1]}else i=t.nodeModel.options.grid.Status[r];""!==i&&-1===i.indexOf("Undefined")&&(-1===i.indexOf("Warning")&&-1===i.indexOf("Error")?s=e.getWebappsAssetUrl("ENOXCAD_Save","icons/32/I_"+i+".png"):-1!==i.indexOf("Warning")?s=e.getWebappsAssetUrl("ENOXCAD_Save","icons/32/I_XCADWarning.png"):-1!==i.indexOf("Error")&&(s=e.getWebappsAssetUrl("ENOXCAD_Save","icons/32/I_XCADError.png")),""!==s&&(l.children[r].src=s,t.cellView.setReusableContent(l),s="")),""!==i&&-1===i.indexOf("Undefined")&&(0!==r&&(n+="\n"),n=n+d.get(i)+" "+a)}l.tooltipInfos=new o({shortHelp:n,allowUnsafeHTMLShortHelp:!0})};else if("Action"===t.dataIndex)t.getCellValue=function(t){var n="";return""!==t.nodeModel.options.grid.Action&&-1===t.nodeModel.options.grid.Action.indexOf("Undefined")&&(n=e.getWebappsAssetUrl("ENOXCAD_Save","icons/32/I_"+t.nodeModel.options.grid.Action+".png")),n};else if("Save"===t.dataIndex)t.getCellValue=function(e){if(e.nodeModel){if("XCADIncluded"===e.nodeModel.options.grid.Save)return!0;if("XCADExcluded"===e.nodeModel.options.grid.Save||"XCADForceExcluded"===e.nodeModel.options.grid.Save)return!1}},t.setCellValue=function(e,t){if(e.nodeModel){if(e.nodeModel.select(!0),"XCADForceExcluded"===e.nodeModel.options.grid.Save)return;let n=t?"XCADIncluded":"XCADExcluded";e.nodeModel.updateOptions({grid:{Save:n}})}e.nodeModel&&("XCADIncluded"===e.nodeModel._options.CheckFlag?i.ToolBarCommands.hasOwnProperty("Exclude")&&i.ToolBarCommands.Exclude.execute():i.ToolBarCommands.hasOwnProperty("Include")&&i.ToolBarCommands.Include.execute())},t.getCellSemantics=function(e){if("XCADForceExcluded"==e.nodeModel.options.CheckFlag)return{disabled:!0}};else if("Reserve"===t.dataIndex){var l;t.getCellValue=function(t){return l="","undefined"!==t.nodeModel.options.grid.Reserve&&""!==t.nodeModel.options.grid.Reserve&&(l=e.getWebappsAssetUrl("ENOXCAD_Save","icons/32/"+t.nodeModel.options.grid.Reserve+".png")),l}}}),p}}),define("DS/ENOXCAD_Save/views/XCAD_Triptych",["UWA/Core","DS/CoreEvents/ModelEvents","DS/ENOXTriptych/js/ENOXTriptych","DS/ENOXCAD_Save/controllers/XCAD_InteractionsWEB_CAD","DS/ENOXCAD_Save/views/XCAD_RightView"],function(e,t,n,o,i){"use strict";return function(o){var a=UWA.extend(new n,{_modelEvents:null,_options:null,_divleft:null,_divmain:null,_divright:null,showPGPCheckBox:function(){i._tooglePGP.visibleFlag=!0},showPMRCheckBox:function(){i._tooglePMR.visibleFlag=!0},showIterationCheckBox:function(){i._toogleKeepIteration.visibleFlag=!0},showPublicationCheckBox:function(){i._toogleExposePublication.visibleFlag=!0},showMaterialCheckBox:function(){i._toogleApplyMaterial.visibleFlag=!0},toogleRightPanel:function(){this._modelEvents.publish({event:"triptych-toggle-panel",data:"right"})},updateStatsInfo:function(e,t,n,o){i.updateSaveInfo(e,t,n,o)},updateSaveAsync:function(e){i._toogleAsyncSave.checkFlag=e},updatePGPSave:function(e){i._tooglePGP.checkFlag=e},updatePMRSave:function(e){i._tooglePMR.checkFlag=e},updateIterSave:function(e){i._toogleKeepIteration.checkFlag=e},updatePublicationExpose:function(e){i._toogleExposePublication.checkFlag=e},updateApplyMaterial:function(e){i._toogleApplyMaterial.checkFlag=e},updateUnreserveCheck:function(e){i._toogleUnreserve.checkFlag=e},updateBookmarkLabel:function(e){i.UpdateBookmarkContextualInfo(e)},updateAddCommentCheck:function(e){i._toogleAddComment&&(i._toogleAddComment.checkFlag=e)},SetWorkUnderInfo:function(e){i.UpdateWorkUnderInfo(e)},DisplayNotLockedWarning:function(e){i.DisplayNotAllLockedWarning(e)},DisplayReadAccessWarning:function(e){i.DisplayNoReadAcceddWarning(e)},DisplayNoDefaultBookmarkSetWarning:function(e){i.DisplayNoDefaultBookmarkWarning(e)},DisplayNotAllObjectsInBookmarkWarning:function(e){i.DisplayNotAllObjectsInBookmarkWarning(e)},onUpdatePreview:function(e){i.onUpdatePreview(e)},onRemovePreview:function(){i.onRemovePreview()},Show:function(){this._container.style.visibility="visible"},Hide:function(){this._container.style.visibility="hidden"}});return a._modelEvents=new t,a._options={left:{minWidth:200,resizable:!0,originalSize:350,originalState:"close",overMobile:!1,withClose:!0},right:{minWidth:230,resizable:!0,originalSize:270,originalState:"open",overMobile:!1,withClose:!1},container:e.createElement("div",{class:"triptych"}).inject(widget.body),withtransition:!0,modelEvents:a._modelEvents},a._divmain=e.createElement("div",{styles:{width:"100%"}}),null!==o&&o.inject(a._divmain),i.init(),a._divright=i._ENOUPSRightDiv,a.init(a._options,a._divleft,a._divmain,a._divright),a}}),define("DS/ENOXCAD_Save/controllers/XCAD_NewRevCmd",["DS/ENOXCAD_Save/controllers/XCAD_InteractionsWEB_CAD"],function(e){"use strict";return{_RevButton:null,_id:null,_isEnable:null,init:function(e,t){this._isEnable=!1,this._RevButton=t,this._id=e,console.log("init : "+this._id),widget.XCAD_MainController.ToolBarCommands[this._id]=this;var n=this;this._RevButton.addEventListener("buttonclick",function(e){n.execute()})},execute:function(){console.log("execute : "+this._id);var t={selectedNodesId:Object.keys(widget.XCAD_MainController.selectedNodes)};e.sendMessageToCad("NewRev","1.0",t)},resetRevision:function(t){console.log("ResetRevision : "+this._id);var n={selectedNodesId:Object.keys(widget.XCAD_MainController.selectedNodes),prevRev:t};e.sendMessageToCad("ResetRev","1.0",n)},updateAvailability:function(e){for(var t in this._isEnable=Object.keys(e).length>0,e)if(void 0!==e[t]._options.Available_Commands&&null!==e[t]._options.Available_Commands&&-1===e[t]._options.Available_Commands.indexOf(this._id)||"Bookmark"===widget.XCAD_MainController.ActiveCommandId){this._isEnable=!1;break}this._isEnable?this._RevButton.elements.button.dsModel.disabled=!1:this._RevButton.elements.button.dsModel.disabled=!0}}}),define("DS/ENOXCAD_Save/controllers/XCAD_SaveAsNewCmd",["DS/ENOXCAD_Save/controllers/XCAD_InteractionsWEB_CAD"],function(e){"use strict";return{_SaveAsNewButton:null,_id:null,_isEnable:null,init:function(e,t){this._isEnable=!1,this._SaveAsNewButton=t,this._id=e,console.log("init : "+this._id),widget.XCAD_MainController.ToolBarCommands[this._id]=this;var n=this;this._SaveAsNewButton.addEventListener("buttonclick",function(e){n.execute()})},execute:function(){console.log("execute : "+this._id);var t={selectedNodesId:Object.keys(widget.XCAD_MainController.selectedNodes)};e.sendMessageToCad("SaveAsNew","1.0",t)},updateAvailability:function(e){for(var t in this._isEnable=Object.keys(e).length>0,e)if(void 0!==e[t]._options.Available_Commands&&null!==e[t]._options.Available_Commands&&-1===e[t]._options.Available_Commands.indexOf(this._id)||"Bookmark"===widget.XCAD_MainController.ActiveCommandId){this._isEnable=!1;break}this._isEnable?this._SaveAsNewButton.elements.button.dsModel.disabled=!1:this._SaveAsNewButton.elements.button.dsModel.disabled=!0}}}),define("DS/ENOXCAD_Save/controllers/XCAD_SaveAsNewBranchCmd",["DS/ENOXCAD_Save/views/XCAD_NewBranchView","DS/ENOXCAD_Save/controllers/XCAD_InteractionsWEB_CAD"],function(e,t){"use strict";return{_NewBranchButton:null,_id:null,_isEnable:null,_Dialog:null,init:function(e,t,n){this._isEnable=!1,this._id=e,this._NewBranchButton=t,this._ShowTitleDialog=n,console.log("init : "+this._id),widget.XCAD_MainController.ToolBarCommands[this._id]=this,this._NewBranchButton.elements.button.dsModel.disabled=!0;var o=this;this._NewBranchButton.addEventListener("buttonclick",function(e){o.execute()})},execute:function(){console.log("execute : "+this._id);var n=Object.keys(widget.XCAD_MainController.selectedNodes).length,o="",i="";if(1===n){var a=Object.keys(widget.XCAD_MainController.selectedNodes)[0],l=widget.XCAD_MainController.selectedNodes[a];o=l._options.grid.Title,i=l._options.CADType}if(this._ShowTitleDialog)this._Dialog=new e(n,o,i),widget.XCAD_MainController.ActiveCommandId=this._id;else{var s=null;s=1===n&&"embeddedComponent"!=i?{selectedNodesId:Object.keys(widget.XCAD_MainController.selectedNodes),value:o,isTitle:!0}:{selectedNodesId:Object.keys(widget.XCAD_MainController.selectedNodes),value:"",isTitle:!1},t.sendMessageToCad("NewBranch","1.0",s)}},updateAvailability:function(e){if(this._isEnable=Object.keys(e).length>0,this._isEnable)for(var t in e)if(void 0!==e[t]._options.Available_Commands&&null!==e[t]._options.Available_Commands&&-1===e[t]._options.Available_Commands.indexOf(this._id)||"Bookmark"===widget.XCAD_MainController.ActiveCommandId){this._isEnable=!1;break}this._isEnable?this._NewBranchButton.elements.button.dsModel.disabled=!1:this._NewBranchButton.elements.button.dsModel.disabled=!0}}}),define("DS/ENOXCAD_Save/controllers/XCAD_IncludeCmd",["DS/ENOXCAD_Save/controllers/XCAD_InteractionsWEB_CAD"],function(e){"use strict";return{_IncludeButton:null,_id:null,_isEnable:null,init:function(e,t){this._isEnable=!1,this._IncludeButton=t,this._id=e,console.log("init : "+this._id),widget.XCAD_MainController.ToolBarCommands[this._id]=this;var n=this;this._IncludeButton.addEventListener("buttonclick",function(e){n.execute()})},execute:function(){console.log("execute : "+this._id);var t={selectedNodesId:Object.keys(widget.XCAD_MainController.selectedNodes)};e.sendMessageToCad(this._id,"1.0",t)},updateAvailability:function(e){for(var t in this._isEnable=Object.keys(e).length>0,e)if(void 0!==e[t]._options.Available_Commands&&null!==e[t]._options.Available_Commands&&-1===e[t]._options.Available_Commands.indexOf(this._id)||"Bookmark"===widget.XCAD_MainController.ActiveCommandId){this._isEnable=!1;break}this._isEnable?this._IncludeButton.elements.button.dsModel.disabled=!1:this._IncludeButton.elements.button.dsModel.disabled=!0}}}),define("DS/ENOXCAD_Save/controllers/XCAD_ExcludeCmd",["DS/ENOXCAD_Save/controllers/XCAD_InteractionsWEB_CAD"],function(e){"use strict";return{_ExcludeButton:null,_id:null,_isEnable:null,init:function(e,t){this._isEnable=!1,this._ExcludeButton=t,this._id=e,console.log("init : "+this._id),widget.XCAD_MainController.ToolBarCommands[this._id]=this;var n=this;this._ExcludeButton.addEventListener("buttonclick",function(e){n.execute()})},execute:function(){console.log("execute : "+this._id);var t={selectedNodesId:Object.keys(widget.XCAD_MainController.selectedNodes)};e.sendMessageToCad(this._id,"1.0",t)},updateAvailability:function(e){for(var t in this._isEnable=Object.keys(e).length>0,e)if(void 0!==e[t]._options.Available_Commands&&null!==e[t]._options.Available_Commands&&-1===e[t]._options.Available_Commands.indexOf(this._id)||"Bookmark"===widget.XCAD_MainController.ActiveCommandId){this._isEnable=!1;break}this._isEnable?this._ExcludeButton.elements.button.dsModel.disabled=!1:this._ExcludeButton.elements.button.dsModel.disabled=!0}}}),define("DS/ENOXCAD_Save/views/XCAD_DuplicateView",["UWA/Core","DS/Core/Core","DS/ApplicationFrame/ContextualUIManager","DS/WebappsUtils/WebappsUtils","DS/Utilities/Dom","DS/Controls/LineEditor","DS/Controls/Button","DS/ENOXCAD_Save/controllers/XCAD_InteractionsWEB_CAD","DS/Windows/Dialog","i18n!DS/ENOXCAD_Save/assets/nls/ENOXCADWebSaveToolBarNls"],function(e,t,n,o,i,a,l,s,d,r){"use strict";return function(){var t=new e.Element("div",{styles:{height:"100%",width:"100%"},html:"<p>"+r.get("DuplicateLineEditor")+"</p>"}),n=new a({value:"",touchMode:!0,requireFlag:!0,placeholder:r.get("PrefixHolder"),requiredFlag:!0,autoCommitFlag:!0,sizeInCharNumber:40});n.inject(t),n.getContent().id="XCADDuplicate_lineeditor";var o=new d({title:r.get("SaveAsDuplicateDialogTitle"),modalFlag:!0,content:t,immersiveFrame:widget.XCAD_MainController.myImmersiveFrame,buttons:{Cancel:new l({onClick:function(e){var t=e.dsModel.dialog;console.log("on Cancel button : dialog title = "+t.title),t.close()}}),Ok:new l({onClick:function(e){var t=e.dsModel.dialog;console.log("on OK button : Duplicate prefix= "+n.value),widget.XCAD_MainController.onDuplicateOk(n.value),t.close()}})}});o.getContent().id="XCADDuplicate_dialog";var i="[:!]+";i=i.replace("\\","\\\\"),n.addEventListener("change",function(e){var t=!1;t=n.value.length>=0&&" "==n.value.substr(0,1)||RegExp(i).test(n.value),o.buttons.Ok.disabled=t})}}),define("DS/ENOXCAD_Save/controllers/XCAD_UnReserveCmd",["DS/ENOXCAD_Save/controllers/XCAD_InteractionsWEB_CAD"],function(e){"use strict";return{_UnReserveButton:null,_id:null,_isEnable:null,init:function(e,t){this._isEnable=!1,this._UnReserveButton=t,this._id=e,console.log("init : "+this._id),widget.XCAD_MainController.ToolBarCommands[this._id]=this,this._UnReserveButton.elements.button.dsModel.disabled=!0;var n=this;this._UnReserveButton.addEventListener("buttonclick",function(e){n.execute()})},execute:function(){console.log("execute : "+this._id);var t={selectedNodesId:Object.keys(widget.XCAD_MainController.selectedNodes)};e.sendMessageToCad("Unreserve","1.0",t)},updateAvailability:function(e){if(this._isEnable=Object.keys(e).length>0,this._isEnable)for(var t in e)if("XCADIncluded"!==e[t]._options.grid.Save||"I_UPSLockedByMe"!==e[t]._options.grid.Reserve&&"I_UPSLocked"!==e[t]._options.grid.Reserve||"Bookmark"===widget.XCAD_MainController.ActiveCommandId){this._isEnable=!1;break}this._isEnable?this._UnReserveButton.elements.button.dsModel.disabled=!1:this._UnReserveButton.elements.button.dsModel.disabled=!0}}}),define("DS/ENOXCAD_Save/controllers/XCAD_ReserveCmd",["DS/ENOXCAD_Save/controllers/XCAD_InteractionsWEB_CAD"],function(e){"use strict";return{_ReserveButton:null,_id:null,_isEnable:null,init:function(e,t){this._isEnable=!1,this._id=e,this._ReserveButton=t,console.log("init : "+this._id),widget.XCAD_MainController.ToolBarCommands[this._id]=this,this._ReserveButton.elements.button.dsModel.disabled=!0;var n=this;this._ReserveButton.addEventListener("buttonclick",function(e){n.execute()})},execute:function(){console.log("execute : "+this._id);var t={selectedNodesId:Object.keys(widget.XCAD_MainController.selectedNodes)};e.sendMessageToCad("Reserve","1.0",t)},updateAvailability:function(e){if(this._isEnable=Object.keys(e).length>0,this._isEnable)for(var t in e)if(void 0!==e[t]._options.Available_Commands&&null!==e[t]._options.Available_Commands&&-1===e[t]._options.Available_Commands.indexOf(this._id)||"Bookmark"===widget.XCAD_MainController.ActiveCommandId){this._isEnable=!1;break}this._isEnable?this._ReserveButton.elements.button.dsModel.disabled=!1:this._ReserveButton.elements.button.dsModel.disabled=!0}}}),define("DS/ENOXCAD_Save/controllers/XCAD_BookmarkCmd",["DS/ENOXCAD_Save/controllers/XCAD_InteractionsWEB_CAD","DS/ENOXCAD_Save/utils/XCAD_LocalStorage"],function(e,t){"use strict";return{_BookmarkButton:null,_id:null,_isEnable:null,_popover:null,init:function(e,t){this._BookmarkButton=t,this._id=e,widget.XCAD_MainController._disableBookmarkChooser?(this._isEnable=!0,this._BookmarkButton.elements.button.dsModel.disabled=!1):this._isEnable=!1,console.log("init : "+this._id),widget.XCAD_MainController.ToolBarCommands[this._id]=this;var n=this;this._BookmarkButton.addEventListener("buttonclick",function(e){n.execute()})},execute:function(){var n=this;if(widget.XCAD_MainController._disableBookmarkChooser){var o={selectedNodesId:Object.keys(widget.XCAD_MainController.selectedNodes)};e.sendMessageToCad("LaunchBookmarkEditorWidget","1.0",o),console.log("AssignBookmark : "+o)}else widget.XCAD_MainController.UpdateActiveCommand(this),require(["DS/FolderActive/FolderActive","DS/PlatformAPI/PlatformAPI"],function(o,i){!0===widget.XCAD_MainController._IsODTMode&&i.publish("bookmark.OnViewReady","bookmark.OnViewReady"),null===n._popover&&(n._popover=n._popover||new o({container:n._BookmarkButton.elements.button,fixPosition:"bottom right",toggleManual:!0}),n._popover.addEvent("onSetActive",function(o){n._popover.hidePopover();var i=o.getID?o.getID():"",a=o.getLabel?o.getLabel():"";if(""!==i){var l={selectedNodesId:Object.keys(widget.XCAD_MainController.selectedNodes),bookmarkID:i,bookmarkLabel:a};e.sendMessageToCad("AssignBookmark","1.0",l);var s=[];s.push(i),t.set("bookmark_lastselected",s,widget.XCAD_MainController.localStorageOptions),console.log("AssignBookmark : "+l)}else widget.XCAD_MainController.UpdateActiveCommand(null)}),n._popover.addEvent("onCancel",function(e){widget.XCAD_MainController.UpdateActiveCommand(null)})),n._popover.showPopover(),n._popover.nestedMenuInContext.setActiveNode("","");var a;null!==(a=t.get("bookmark_lastselected",widget.XCAD_MainController.localStorageOptions))&&a.length&&n._popover.selectObjects(a),console.log("execute : "+n._id)})},enbaleBookmarkBtn:function(){this._isEnable=!0,null!=this._BookmarkButton&&(this._BookmarkButton.elements.button.dsModel.disabled=!1)},updateAvailability:function(e){if(!widget.XCAD_MainController._disableBookmarkChooser){if(widget.XCAD_MainController._Version<=5)this._isEnable=Object.keys(e).length>0;else for(var t in this._isEnable=!1,e)if(void 0!==e[t]._options.Available_Commands&&null!=e[t]._options.Available_Commands&&-1!=e[t]._options.Available_Commands.indexOf(this._id)){this._isEnable=!0;break}this._isEnable?this._BookmarkButton.elements.button.dsModel.disabled=!1:(this._BookmarkButton.elements.button.dsModel.disabled=!0,null!==this._popover&&this._popover.hidePopover(),widget.XCAD_MainController.ActiveCommand=null,widget.XCAD_MainController.ActiveCommandId="",widget.XCAD_MainController.ToolBarCommands.hasOwnProperty("SaveScope")&&widget.XCAD_MainController.ToolBarCommands.SaveScope.updateAvailability(e),widget.XCAD_MainController.ToolBarCommands.hasOwnProperty("Filter")&&widget.XCAD_MainController.ToolBarCommands.Filter.updateAvailability(e))}}}}),define("DS/ENOXCAD_Save/controllers/XCAD_SetDerivedOutputCmd",["DS/ENOXCAD_Save/controllers/XCAD_InteractionsWEB_CAD"],function(e){"use strict";return{_DerivedOutpuButton:null,_id:null,_SaveAsNewButton:null,_isEnable:null,init:function(e,t){this._isEnable=!1,this._id=e,this._DerivedOutpuButton=t,console.log("init : ENOUPSSetDerivedOutputCmd"+this._id),widget.XCAD_MainController.ToolBarCommands[this._id]=this;var n=this;this._DerivedOutpuButton.addEventListener("buttonclick",function(e){n.execute()})},execute:function(){console.log("execute : "+this._id);var t={selectedNodesId:Object.keys(widget.XCAD_MainController.selectedNodes)};e.sendMessageToCad("GetDerivedOutputsList","1.0",t)},updateAvailability:function(e){for(var t in this._isEnable=Object.keys(e).length>0,e)if(void 0!==e[t]._options.Available_Commands&&null!==e[t]._options.Available_Commands&&-1===e[t]._options.Available_Commands.indexOf(this._id)||"Bookmark"===widget.XCAD_MainController.ActiveCommandId){this._isEnable=!1;break}this._isEnable?this._DerivedOutpuButton.elements.button.dsModel.disabled=!1:this._DerivedOutpuButton.elements.button.dsModel.disabled=!0}}}),define("DS/ENOXCAD_Save/controllers/XCAD_MaturityCmd",["UWA/Class","DS/ENOXCAD_Save/controllers/XCAD_InteractionsWEB_CAD","DS/Windows/Dialog","i18n!DS/ENOXCAD_Save/assets/nls/ENOXCADWebSaveColumns","UWA/Core","DS/Controls/Button"],function(e,t,n,o,i,a){"use strict";return{_MaturityButton:null,_id:null,_isEnable:null,_onMaturityUIReady:null,_onMaturityTransitionStart:null,_onMaturityTransitionEnd:null,_onMaturityCanceled:null,isWebInWin:!1,_SelectedItem:null,_maturityPanel:null,init:function(e,t){this._isEnable=!1,this._MaturityButton=t,this._id=e,console.log("init : ENOUPSMaturityCmd"+this._id),widget.XCAD_MainController.ToolBarCommands[this._id]=this,this._MaturityButton.elements.button.dsModel.disabled=!0;var n=this;this._MaturityButton.addEventListener("buttonclick",function(e){n.execute()})},onMaturityUIReady:function(){console.log("MaturityCmd -> onMaturityUIReady");t.sendMessageToCad("OnChangeMaturityUIReady","1.0",{})},onMaturityTransitionStart:function(){console.log("MaturityCmd -> onMaturityTransitionStart")},onIncludeChildrenChanged:function(e){console.log("MaturityCmd -> onIncludeChildrenChanged");var n={onIncludeChildren:e};t.sendMessageToCad("OnChangeMaturityIncludeChildren","1.0",n)},onMaturityTransitionEnd:function(e){console.log("MaturityCmd -> onMaturityTransitionEnd");var n={onCompleted:e};t.sendMessageToCad("OnChangeMaturityTransitionEnd","1.0",n)},onMaturityCanceled:function(){t.sendMessageToCad("OnChangeMaturityCanceled","1.0",{})},onCompleted:function(){console.log("MaturityCmd -> onCompleted")},execute:function(e){var t=widget.XCAD_MainController.selectedNodes;if(widget.XCAD_MainController.CheckModifiedContent(t)){var l=o.get("WarningMaturity"),s=new i.Element("div",{styles:{height:"100%",width:"100%"},html:"<p>"+l+"</p>"}),d=this;new n({title:o.get("WarningMaturityTitle"),modalFlag:!0,content:s,immersiveFrame:widget.XCAD_MainController.myImmersiveFrame,buttons:{Cancel:new a({onClick:function(e){var t=e.dsModel.dialog;console.log("on Cancel button : dialog title = "+t.title),t.close()}}),Ok:new a({onClick:function(e){e.dsModel.dialog.close(),d.StartInitMaturityPanel()}})}}).getContent().id="XCADMaturityWarning_dialog"}else this.StartInitMaturityPanel()},StartInitMaturityPanel:function(){var e={selectedNodesId:Object.keys(widget.XCAD_MainController.selectedNodes)};t.sendMessageToCad("InitMaturity","1.0",e),console.log("InitMaturity : "+e)},LaunchChangeMaturityPanel:function(e){var t=this;require(["DS/MaturityWidget/MaturityWidget","DS/PlatformAPI/PlatformAPI"],function(n,o){var i;!0===widget.XCAD_MainController._IsODTMode&&o.publish("ChangeMaturity.OnViewReady","ChangeMaturity.OnViewReady"),i="string"!=typeof e?e:JSON.parse(e),console.log("LaunchChangeMaturityPanel with the selected items: "+i);var a=null;i&&i.hasOwnProperty("results")&&(a=i.results);var l=null;i&&i.hasOwnProperty("workUnder")&&(l=i.workUnder);if(a&&Array.isArray(a)&&a.length>0)for(var s=0;s<a.length;s++)a[s].hasOwnProperty("phid")&&(a[s].physicalid=a[s].phid);var d=i.availablePlatforms;t.externalSettings=d;var r=null;if(null!==l){var c=l.change;r={id:c.id,name:c.name,title:c.title,description:c.description,severity:c.severity}}t.change=r,widget.XCAD_MainController._IsODTMode||(t._maturityPanel=new n(t)),t._maturityPanel&&(t._maturityPanel.addEvent("onMaturityUIReady",t.onMaturityUIReady),t._maturityPanel.addEvent("onMaturityTransitionStart",t.onMaturityTransitionStart),t._maturityPanel.addEvent("onMaturityTransitionEnd",t.onMaturityTransitionEnd),t._maturityPanel.addEvent("onMaturityCanceled",t.onMaturityCanceled),t._maturityPanel.addEvent("onIncludeChildrenChanged",t.onIncludeChildrenChanged),t._maturityPanel.executeCmd(a,t,t.onCompleted))})},updateAvailability:function(e){if(this._isEnable=Object.keys(e).length>0,this._isEnable)for(var t in e)if(void 0!==e[t]._options.Available_Commands&&null!=e[t]._options.Available_Commands&&-1==e[t]._options.Available_Commands.indexOf(this._id)||"Bookmark"==widget.XCAD_MainController.ActiveCommandId){this._isEnable=!1;break}this._isEnable?this._MaturityButton.elements.button.dsModel.disabled=!1:this._MaturityButton.elements.button.dsModel.disabled=!0}}}),define("DS/ENOXCAD_Save/views/XCAD_NewFileNameView",["UWA/Core","DS/Core/Core","DS/ApplicationFrame/ContextualUIManager","DS/WebappsUtils/WebappsUtils","DS/Utilities/Dom","DS/Controls/LineEditor","DS/Controls/Button","DS/ENOXCAD_Save/controllers/XCAD_InteractionsWEB_CAD","DS/Windows/Dialog","i18n!DS/ENOXCAD_Save/assets/nls/ENOXCADWebSaveToolBarNls"],function(e,t,n,o,i,a,l,s,d,r){"use strict";return function(t,n,o){var i=new e.Element("div",{styles:{height:"100%",width:"100%"},html:"<p>"+r.get("RenameLineEditor")+"</p>"}),c=new a({value:t,touchMode:!0,requireFlag:!0,placeholder:"Enter new file name here...",requiredFlag:!0,autoCommitFlag:!0,sizeInCharNumber:30});if("undefined"!==o&&""!==o){new e.Element("div",{styles:{float:"right","padding-top":10}}).inject(i).appendChild(document.createTextNode(o));var u=new e.Element("div",{styles:{float:"left"}}).inject(i);c.inject(u)}else c.inject(i);c.getContent().id="XCADRename_lineeditor";var C=new d({title:r.get("RenameDialogTitle"),modalFlag:!0,content:i,immersiveFrame:widget.XCAD_MainController.myImmersiveFrame,buttons:{Cancel:new l({onClick:function(e){var t=e.dsModel.dialog;console.log("on Cancel button : dialog title = "+t.title),t.close()}}),Ok:new l({onClick:function(e){var t=e.dsModel.dialog;console.log("on OK button : New file name = "+c.value),widget.XCAD_MainController.onNewFileNameOk(c.value),t.close()}})}});C.getContent().id="XCADRename_dialog";var _="[]+";void 0!==n&&(_="["+n+"]+"),_=_.replace("\\","\\\\"),c.addEventListener("change",function(e){var t=RegExp(_).test(c.value);C.buttons.Ok.disabled=t||0===c.value.length||c.value.length>=206});s.sendMessageToCad("WebSavePanelLoaded","1.0",{})}}),define("DS/ENOXCAD_Save/controllers/XCAD_NewFileNameCmd",["DS/ENOXCAD_Save/controllers/XCAD_InteractionsWEB_CAD"],function(e){"use strict";return{_NewFileNameButton:null,_id:null,_isEnable:null,init:function(e,t){this._isEnable=!1,this._NewFileNameButton=t,this._id=e,this._NewFileNameButton.elements.button.dsModel.disabled=!0,widget.XCAD_MainController.ToolBarCommands[this._id]=this;var n=this;this._NewFileNameButton.addEventListener("buttonclick",function(e){n.execute()})},execute:function(){if(widget.XCAD_MainController._IsODTMode)widget.XCAD_MainController.showNewFileNameSidePanel(!1,"");else{var t={selectedNodesId:Object.keys(widget.XCAD_MainController.selectedNodes)},n=widget.XCAD_MainController._Version;e.sendMessageToCad("CheckAutomaticRenameActivation",n,t)}},updateAvailability:function(e){if(this._isEnable=1===Object.keys(e).length,this._isEnable)for(var t in e)if(void 0!==e[t]._options.Available_Commands&&null!==e[t]._options.Available_Commands&&-1===e[t]._options.Available_Commands.indexOf(this._id)||"Bookmark"===widget.XCAD_MainController.ActiveCommandId){this._isEnable=!1;break}this._isEnable?this._NewFileNameButton.elements.button.dsModel.disabled=!1:this._NewFileNameButton.elements.button.dsModel.disabled=!0}}}),define("DS/ENOXCAD_Save/views/XCAD_ToolBar",["UWA/Core","DS/WebappsUtils/WebappsUtils","DS/Controls/ComboBox","DS/Controls/Button","DS/ENOXCAD_Save/controllers/XCAD_InteractionsWEB_CAD","DS/ENOXCAD_Save/controllers/XCAD_ChangeSaveScopeCmd","DS/ENOXCAD_Save/controllers/XCAD_FilterCmd","DS/ENOXCAD_Save/controllers/XCAD_NewFileNameCmd","DS/ENOXCAD_Save/controllers/XCAD_NewRevCmd","DS/ENOXCAD_Save/controllers/XCAD_DuplicateCmd","DS/ENOXCAD_Save/controllers/XCAD_ReserveCmd","DS/ENOXCAD_Save/controllers/XCAD_UnReserveCmd","DS/ENOXCAD_Save/controllers/XCAD_SaveAsNewCmd","DS/ENOXCAD_Save/controllers/XCAD_MaturityCmd","DS/ENOXCAD_Save/controllers/XCAD_BookmarkCmd","DS/ENOXCAD_Save/controllers/XCAD_SetDerivedOutputCmd","DS/ENOXCAD_Save/controllers/XCAD_ToggleRightPanelCmd","DS/ENOXCAD_Save/controllers/XCAD_IncludeCmd","DS/ENOXCAD_Save/controllers/XCAD_ExcludeCmd","DS/ENOXCAD_Save/controllers/XCAD_SaveAsNewBranchCmd","DS/Controls/TooltipModel","i18n!DS/ENOXCAD_Save/assets/nls/ENOXCADWebSaveToolBarNls","DS/Controls/Toggle"],function(e,t,n,o,i,a,l,s,d,r,c,u,C,_,h,g,v,m,p,A,D,f,b){"use strict";return{init:function(i,S){console.log("init : ToolBar");var w=e.createElement("div",{class:"toolbar-container"});widget.body.children[0].insertAdjacentElement("afterEnd",w);var M=e.createElement("div",{class:"Toolbaroptions"}).inject(w),k=e.createElement("div",{class:"ToolBarCommands"}).inject(w),y=t.getWebappsBaseUrl();widget.XCAD_MainController._UIConfig.displayoptions.forEach(function(t){var o=!0;if("false"==t.visible&&(o=!1),t.version<=widget.XCAD_MainController._Version&&o){var s=!0;switch("undefined"!==t.disabled&&"true"==t.disabled&&(s=!1),t.id){case"SaveScope":var d=new n({elementsList:[f.get("ActiveDoc"),f.get("CurrentEdit"),f.get("Session")],selectedIndex:i,enableSearchFlag:!1,actionOnClickFlag:!1,touchMode:!1}).inject(M);d.getContent().addClassName("comboxbox-container"),a.init(t.id,d,s);break;case"Filter":var r=e.createElement("div",{class:"filtercontainer"}).inject(M),c=new b({type:"switch",label:f.get(t.id),checkFlag:S,touchMode:!1}).inject(r);l.init(t.id,c)}}}),widget.XCAD_MainController._UIConfig.commands.forEach(function(t){var n=!0;if("false"==t.visible&&(n=!1),t.version<=widget.XCAD_MainController._Version&&n){var i=y+"ENOXCAD_Save/assets/icons/32/"+t.icon;switch(t.id){case"Include":var a=e.createElement("div",{id:"include_btn",class:"button"}).inject(k),l=new o({disabled:!0,icon:i,displayStyle:"icon",type:"standard",touchMode:!1}).inject(a);l.elements.icon.style.width="22px",l.elements.icon.style.height="22px",l.tooltipInfos=new D({shortHelp:f.get(t.id),mouseRelativePosition:!0}),m.init(t.id,l);break;case"Exclude":var b=e.createElement("div",{id:"exclude_btn",class:"button"}).inject(k),S=new o({disabled:!0,icon:i,displayStyle:"icon",type:"standard",touchMode:!1}).inject(b);S.elements.icon.style.width="22px",S.elements.icon.style.height="22px",S.tooltipInfos=new D({shortHelp:f.get(t.id),mouseRelativePosition:!0}),p.init(t.id,S);break;case"Revise":e.createElement("div",{class:"ToolBarDivider enox-collection-toolbar-divider"}).inject(k);var w=e.createElement("div",{id:"revise_btn",class:"button"}).inject(k),M=new o({disabled:!0,icon:i,displayStyle:"icon",type:"standard",touchMode:!1}).inject(w);M.elements.icon.style.width="22px",M.elements.icon.style.height="22px",M.tooltipInfos=new D({shortHelp:f.get(t.id),mouseRelativePosition:!0}),d.init(t.id,M);break;case"NewBranch":var E=e.createElement("div",{id:t.id+"_btn",class:"button"}).inject(k),N=new o({disabled:!0,icon:i,displayStyle:"icon",type:"standard",touchMode:!1}).inject(E);N.elements.icon.style.width="22px",N.elements.icon.style.height="22px",N.tooltipInfos=new D({shortHelp:f.get(t.id),mouseRelativePosition:!0});var O=!0;"undefined"!==t.ShowTitleDialog&&"false"==t.ShowTitleDialog&&(O=!1),A.init(t.id,N,O);break;case"Duplicate":var X=e.createElement("div",{id:"duplicate_btn",class:"button"}).inject(k),I=new o({disabled:!0,icon:i,displayStyle:"icon",type:"standard",touchMode:!1}).inject(X);I.elements.icon.style.width="22px",I.elements.icon.style.height="22px",I.tooltipInfos=new D({shortHelp:f.get(t.id),mouseRelativePosition:!0});var x=!0;"undefined"!==t.ShowPrefixDialog&&"false"==t.ShowPrefixDialog&&(x=!1),r.init(t.id,I,x);break;case"SaveAsNew":var B=e.createElement("div",{id:"saveasnew_btn",class:"button"}).inject(k),T=new o({disabled:!0,icon:i,displayStyle:"icon",type:"standard",touchMode:!1}).inject(B);T.elements.icon.style.width="22px",T.elements.icon.style.height="22px",T.tooltipInfos=new D({shortHelp:f.get(t.id),mouseRelativePosition:!0}),C.init(t.id,T);break;case"Maturity":var P=e.createElement("div",{id:"maturity_btn",class:"button"}).inject(k),U=new o({disabled:!1,icon:i,displayStyle:"icon",type:"standard",touchMode:!1}).inject(P);U.elements.icon.style.width="22px",U.elements.icon.style.height="22px",U.tooltipInfos=new D({shortHelp:f.get(t.id),mouseRelativePosition:!0}),_.init(t.id,U);break;case"Lock":e.createElement("div",{class:"ToolBarDivider enox-collection-toolbar-divider"}).inject(k);var W=e.createElement("div",{id:"reserve_btn",class:"button"}).inject(k),F=new o({disabled:!0,icon:i,displayStyle:"icon",type:"standard",touchMode:!1}).inject(W);F.tooltipInfos=new D({shortHelp:f.get(t.id),mouseRelativePosition:!0}),F.elements.icon.style.width="22px",F.elements.icon.style.height="22px",c.init(t.id,F);break;case"Unreserve":var R=e.createElement("div",{id:"unreserve_btn",class:"button"}).inject(k);e.createElement("div",{class:"ToolBarDivider enox-collection-toolbar-divider"}).inject(k);var L=new o({disabled:!0,icon:i,displayStyle:"icon",type:"standard",touchMode:!1}).inject(R);L.elements.icon.style.width="22px",L.elements.icon.style.height="22px",L.tooltipInfos=new D({shortHelp:f.get(t.id),mouseRelativePosition:!0}),u.init(t.id,L);break;case"RenameFile":E=e.createElement("div",{id:"rename_btn",class:"button"}).inject(k);var V=new o({disabled:!0,icon:i,displayStyle:"icon",type:"standard",touchMode:!1}).inject(E);V.elements.icon.style.width="22px",V.elements.icon.style.height="22px",V.tooltipInfos=new D({shortHelp:f.get(t.id),mouseRelativePosition:!0}),s.init(t.id,V);break;case"EditDerivedOutputSelection":var j=e.createElement("div",{id:"do_btn",class:"button"}).inject(k),H=new o({disabled:!0,icon:i,displayStyle:"icon",type:"standard",touchMode:!1}).inject(j);H.elements.icon.style.width="22px",H.elements.icon.style.height="22px",H.tooltipInfos=new D({shortHelp:f.get(t.id),mouseRelativePosition:!0}),g.init(t.id,H);break;case"Bookmark":var G=e.createElement("div",{id:"bookmark_btn",class:"button"}).inject(k),K=new o({disabled:!0,icon:i,displayStyle:"icon",type:"standard",touchMode:!1}).inject(G);K.elements.icon.style.width="22px",K.elements.icon.style.height="22px",K.tooltipInfos=new D({shortHelp:f.get(t.id),mouseRelativePosition:!0}),h.init(t.id,K),e.createElement("div",{class:"ToolBarDivider enox-collection-toolbar-divider"}).inject(k);break;case"Info":var q=e.createElement("div",{id:"info_btn",class:"button"}).inject(k),z=new o({disabled:!1,checkFlag:!0,icon:i,displayStyle:"icon",type:"check",touchMode:!1}).inject(q);z.elements.icon.style.width="22px",z.elements.icon.style.height="22px",z.tooltipInfos=new D({shortHelp:f.get(t.id),mouseRelativePosition:!0}),v.init(t.id,z);break;default:console.log("Unkown toolbar command.")}}})}}}),define("DS/ENOXCAD_Save/controllers/XCAD_MainController",["css!../../c/UWA/assets/css/standalone","css!DS/ENOXCAD_Save/ENOXCAD_Save","DS/Core/Core","DS/WebappsUtils/WebappsUtils","DS/TreeModel/TreeNodeModel","DS/TreeModel/DataModelSet","DS/TreeModel/TreeDocument","DS/ENOXCAD_Save/controllers/XCAD_InteractionsWEB_CAD","DS/ENOXCAD_Save/views/XCAD_Triptych","DS/ENOXCAD_Save/views/XCAD_TreeListView","DS/Windows/ImmersiveFrame","DS/ENOXCAD_Save/views/XCAD_ToolBar","DS/ENOXCAD_Save/utils/XCAD_LocalStorage","../../c/UWA/js/UWA_Standalone_Alone","DS/ENOXCAD_Save/views/XCAD_NewFileNameView","DS/ENOXCAD_Save/views/XCAD_DuplicateView","DS/ENOXCAD_Save/views/XCAD_SetDerivedOutputView","DS/ENOXCAD_Save/views/XCAD_WarningView","DS/PlatformAPI/PlatformAPI","text!DS/ENOXCAD_Save/assets/XCAD_CATIAV5_ServerCompatibility_Info.json"],function(e,t,n,o,i,a,l,s,d,r,c,u,C,_,h,g,v,m,p,A){"use strict";n.setFullscreen(),widget.XCAD_MainController={triptych:{},treeListView:null,saveOptionsView:null,previewBookmarksView:null,model:null,filterNotModified:!1,saveScope:0,xso:{},localStorageOptions:[],disableOnmoveColumnCallbak:!1,disableOnWidthColumnUpdateCallbak:!1,disableOnsortColumnCallbak:!1,allNodes:[],selectedNodes:{},ToolBarCommands:{},treeListViewColumnsDataIndex:[],ActiveCommandId:null,restrictedCharactersForFileName:"",myImmersiveFrame:null,_dataModelSet:null,_nIncludedNodes:0,_nExcludedNodes:0,_nModifiedNodes:0,_nNewNodes:0,_IsODTMode:!1,_NodePositionForCtxMenuDisplay:null,_CtxMenuEvent:null,_isCtxEventAsync:!1,_InternalVersion:"",_Version:"1.0",_UIConfig:{},_disableBookmarkChooser:!1,_columnsJson:null,onLoad:function(){if(!(""===window.location.search&&!1===this._IsODTMode||void 0!==widget.ENOUPS_saveWidgetIsLoaded&&!1!==widget.ENOUPS_saveWidgetIsLoaded)){widget.ENOUPS_saveWidgetIsLoaded=!0;var e=this,t=JSON.parse(A);this._InternalVersion=t.version;var n=this.getQueryVariable("CADVersion");0!=n&&(n<=this._InternalVersion?this._Version=n:this._Version=this._InternalVersion);var o=this.getQueryVariable("CAD");o||(o="CATIAV5");var i="text!DS/ENOXCAD_Save/assets/"+("XCAD_"+o+"_CmdsAndOptions_UIDecl.json");e._dataModelSet=new a;var u=this.getQueryVariable("ColumnsInfo"),C="undefined";0!=u?C=this.decodeString(u):!1===this._IsODTMode&&(this._columnsJson=!1),"undefined"!=C&&(this._columnsJson=JSON.parse(C)),require([i],function(t){e._UIConfig=JSON.parse(t),e.model=new l({dataModelSet:e._dataModelSet,useAsyncPreExpand:!0}),e.treeListView=new r(e),window._tree=e.treeListView,document.body.addEventListener("keydown",function(t){var n=(t=t||window.event).which||t.keyCode,o=t.ctrlKey?t.ctrlKey:17===n;65==n&&o&&(t.preventDefault(),console.log("Ctrl+A is pressed."),null!=e.treeListView&&null!=e.treeListView.getDocument()&&e.treeListView.getTreeDocument().selectAll())},!1),e.myImmersiveFrame=new c({}).inject(widget.body,"top"),e.triptych=new d(e.treeListView),e.xso=e.model.getXSO(),e.xso.onChange(function(){var t=e.xso.get();1===t.length?e.triptych.updateBookmarkLabel(t[0]._options.AssignedBookmark):e.triptych.updateBookmarkLabel("")}),e.xso.onPostAdd(function(t){t.forEach(function(t){e.selectedNodes[t._options.NodeId]=t});var n={selectedNodesId:Object.keys(e.selectedNodes)};s.sendMessageToCad("OnSelectedNodes","1.0",n)}),e.xso.onPostRemove(function(t){for(var n in e.triptych.updateBookmarkLabel(""),t.forEach(function(t){e.triptych.onRemovePreview(),delete e.selectedNodes[t._options.NodeId]}),e.ToolBarCommands)e.ToolBarCommands.hasOwnProperty(n)&&e.ToolBarCommands[n].updateAvailability(e.selectedNodes)}),e.xso.onEmpty(function(e){s.sendMessageToCad("OnRemoveSelection","1.0",{})}),s.init()})}},getQueryVariable:function(e){for(var t=window.location.search.substring(1).split("&"),n=0;n<t.length;n++){var o=t[n].split("=");if(o[0]==e)return o[1]}return!1},decodeString:function(e){var t=e;return t=(t=(t=(t=(t=(t=(t=(t=(t=t.replaceAll("%3A",":")).replaceAll("%2F","/")).replaceAll("%7B","{")).replaceAll("%2C",",")).replaceAll("%7D","}")).replaceAll("%22",'"')).replaceAll("%5B","[")).replaceAll("%5D","]")).replaceAll("%20"," ")},BuildToolBarView:function(){u.init(this.saveScope,this.filterNotModified),this._IsODTMode&&p.publish("toolbarview.OnViewReady","toolbarview.OnViewReady")},loadNodes:function(e){var t=this;(new Date).getTime();for(var n in null==t._dataModelSet&&(t._dataModelSet=new a),this.ResetSaveStats(),this.model.prepareUpdate(),null!==this.model?this.model.empty():this.model=new l({useAsyncPreExpand:!0}),this.allNodes=[],e.forEach(function(e){var n=t.getCADTypeIconPath(e.CADType,e.IsTemporaryDoc),o=new i({label:e.grid.Title,icons:[n],NodeId:e.NodeId,Available_Commands:e.Available_Commands,AssignedBookmark:e.AssignedBookmark,CADType:e.CADType,IsTemporaryDoc:e.IsTemporaryDoc,CheckFlag:e.grid.Save,grid:e.grid});t.filterNotModified&&-1!==o._options.grid.Status.indexOf("XCADStatusCachedInfo")?o.hide():o.show(),t.allNodes[e.NodeId]=o,t.model.addChild(o),t.UpdateSaveStats(null,o._options)}),this.model.pushUpdate(),t.ToolBarCommands)t.ToolBarCommands.hasOwnProperty(n)&&t.ToolBarCommands[n].updateAvailability(t.selectedNodes);t.triptych.updateStatsInfo(t._nNewNodes,t._nModifiedNodes,t._nExcludedNodes,t._nIncludedNodes),0!==this._nExcludedNodes&&require(["i18n!DS/ENOXCAD_Save/assets/nls/ENOXCADWebSaveColumns"],function(e){t.showWarning(e.get("Warning_title"),e.get("ForceExclude_Warning"))})},setODTMode:function(e){this._IsODTMode=e},setODTWebSaveVersion:function(e){this._Version=e},getCADTypeIconPath:function(e,t){var n;return n=o.getWebappsBaseUrl(),-1!==e.indexOf("multiCAD")?n+"ENOXCAD_Save/assets/icons/32/I_UPSiges.png":t?"component"==e?n+"ENOXCAD_Save/assets/icons/32/I_3DPart.png":"embeddedComponent"==e?n+"ENOXCAD_Save/assets/icons/32/I_UPSembeddedComponent.png":n+"ENOXCAD_Save/assets/icons/32/I_UPSVPMReference.png":n+"ENOXCAD_Save/assets/icons/32/I_UPS"+e+".png"},UpdateSaveStats:function(e,t){null!==t&&("XCADIncluded"===t.grid.Save?-1!==t.grid.Status.indexOf("XCADStatusNew")||"XCADActionDuplicate"===t.grid.Action||"XCADActionNewBranch"===t.grid.Action?null===e?this._nNewNodes++:"XCADExcluded"===e._options.CheckFlag||"XCADForceExcluded"===e._options.CheckFlag?(this._nNewNodes++,-1===e._options.grid.Status.indexOf("XCADStatusCachedInfo")&&this._nExcludedNodes--):-1!==e._options.grid.Status.indexOf("XCADStatusModified")?(this._nModifiedNodes--,this._nNewNodes++):"XCADActionDuplicate"!==e._options.grid.Action&&"XCADActionNewBranch"!==e._options.grid.Action&&-1===e._options.grid.Status.indexOf("XCADStatusNew")&&(this._nIncludedNodes--,this._nNewNodes++):-1!==t.grid.Status.indexOf("XCADStatusModified")?null===e?this._nModifiedNodes++:"XCADExcluded"!==e._options.CheckFlag&&"XCADForceExcluded"!==e._options.CheckFlag||(this._nExcludedNodes--,this._nModifiedNodes++):-1!==t.grid.Status.indexOf("XCADStatusExists")&&(null===e?this._nIncludedNodes++:"XCADExcluded"===e._options.CheckFlag||"XCADForceExcluded"===e._options.CheckFlag?(this._nIncludedNodes++,-1===e._options.grid.Status.indexOf("XCADStatusCachedInfo")&&this._nExcludedNodes--):-1!==e._options.grid.Status.indexOf("XCADStatusModified")&&(this._nModifiedNodes--,this._nIncludedNodes++)):"XCADExcluded"!==t.grid.Save&&"XCADForceExcluded"!==t.grid.Save||(null===e?-1===t.grid.Status.indexOf("XCADStatusCachedInfo")&&this._nExcludedNodes++:"XCADIncluded"===e._options.CheckFlag&&(-1!==e._options.grid.Status.indexOf("XCADStatusNew")||"XCADActionDuplicate"===e._options.grid.Action||"XCADActionNewBranch"===e._options.grid.Action?(this._nNewNodes--,-1===t.grid.Status.indexOf("XCADStatusCachedInfo")&&this._nExcludedNodes++):-1!==e._options.grid.Status.indexOf("XCADStatusModified")?(this._nModifiedNodes--,-1===t.grid.Status.indexOf("XCADStatusCachedInfo")&&this._nExcludedNodes++):"XCADIncluded"===e._options.CheckFlag&&(this._nIncludedNodes--,-1===t.grid.Status.indexOf("XCADStatusCachedInfo")&&this._nExcludedNodes++))))},CheckModifiedContent(e){for(var t in e)if(-1!==e[t]._options.grid.Status.indexOf("XCADStatusModified"))return!0;return!1},ResetSaveStats:function(){this._nIncludedNodes=0,this._nModifiedNodes=0,this._nExcludedNodes=0,this._nNewNodes=0},ShowOnlyModifiedContentList:function(e){this.filterNotModified=e,this.model.prepareUpdate(),this.model.getRoots().forEach(function(t){-1!==t._options.grid.Status.indexOf("XCADStatusCachedInfo")&&(e?t.hide():t.show())}),this.model.pushUpdate(),C.set("filterNotModified",e,this.localStorageOptions);s.sendMessageToCad("WebSavePanelLoaded","1.0",{})},updateNodes:function(e){this.model.prepareUpdate();var t=this;for(var n in e.forEach(function(e){var n=t.getCADTypeIconPath(e.CADType,e.IsTemporaryDoc),o=t.selectedNodes[e.NodeId];void 0===o&&(o=t.allNodes[e.NodeId]),void 0===o?(o=new i({label:e.grid.Title,icons:[n],Available_Commands:e.Available_Commands,CheckFlag:e.grid.Save,grid:e.grid}),t.allNodes[e.NodeId]=o,t.model.addRoot(o),t.UpdateSaveStats(null,o._options)):(t.UpdateSaveStats(o,e),o.updateOptions({label:e.grid.Title,icons:[n],Available_Commands:e.Available_Commands,AssignedBookmark:e.AssignedBookmark,CADType:e.CADType,IsTemporaryDoc:e.IsTemporaryDoc,CheckFlag:e.grid.Save,grid:e.grid})),t.filterNotModified&&-1!==o._options.grid.Status.indexOf("XCADStatusCachedInfo")?o.hide():o.show()}),this.model.pushUpdate(),this.ToolBarCommands)this.ToolBarCommands.hasOwnProperty(n)&&this.ToolBarCommands[n].updateAvailability(this.selectedNodes);this.triptych.updateStatsInfo(t._nNewNodes,t._nModifiedNodes,t._nExcludedNodes,t._nIncludedNodes);var o=this.xso.get();1===o.length&&this.triptych.updateBookmarkLabel(o[0]._options.AssignedBookmark);s.sendMessageToCad("WebSavePanelLoaded","1.0",{})},UpdateCommandsAvailability:function(e){this.model.prepareUpdate();var t=this;for(var n in e.forEach(function(e){var n=t.selectedNodes[e.NodeId];"undefined"!==n&&n.updateOptions({Available_Commands:e.Available_Commands}),t.filterNotModified&&-1!==n._options.grid.Status.indexOf("XCADStatusCachedInfo")?n.hide():n.show()}),this.model.pushUpdate(),this.ToolBarCommands)this.ToolBarCommands.hasOwnProperty(n)&&this.ToolBarCommands[n].updateAvailability(this.selectedNodes);if(1==this._isCtxEventAsync){this._isCtxEventAsync=!1;var o=widget.XCAD_MainController._NodePositionForCtxMenuDisplay.cellView.getContent();this._dispatchMouseEvent(o,"contextmenu",null,this._CtxMenuEvent)}var i=this.xso.get();1===i.length&&this.triptych.updateBookmarkLabel(i[0]._options.AssignedBookmark);s.sendMessageToCad("WebSavePanelLoaded","1.0",{})},displayWarning:function(e,t,n,o){this.triptych.DisplayNotLockedWarning(!e),this.triptych.DisplayReadAccessWarning(!t),this.triptych.DisplayNoDefaultBookmarkSetWarning(!n),this.triptych.DisplayNotAllObjectsInBookmarkWarning(!o)},init:function(e,t,n,o,i,a,l,d,r,c,u,_,h,g){window.top.dsUserLogin=a,window.COMPASS_CONFIG||(window.COMPASS_CONFIG={}),window.COMPASS_CONFIG.myAppsBaseUrl=i,window.COMPASS_CONFIG.userId=a,window.COMPASS_CONFIG.lang=l,widget.setValue("x3dPlatformId",r),this.localStorageOptions.push(a),this.restrictedCharactersForFileName=o,this.ToolBarCommands.hasOwnProperty("SaveScope")&&(this.saveScope=t,this.ToolBarCommands.SaveScope.setSaveScope(this.saveScope)),this.ToolBarCommands.hasOwnProperty("Filter")&&(this.filterNotModified=C.get("filterNotModified",this.localStorageOptions),this.ToolBarCommands.Filter.setFilterOption(this.filterNotModified)),this.loadNodes(e),this.triptych.Show(),""!==n&&this.triptych.SetWorkUnderInfo(n);var v=C.get("asyncSave",this.localStorageOptions);this.triptych.updateSaveAsync(v);var m=C.get("unreserveAfterSave",this.localStorageOptions);if(this.triptych.updateUnreserveCheck(m),this.triptych.updateStatsInfo(this._nNewNodes,this._nModifiedNodes,this._nExcludedNodes,this._nIncludedNodes),d&&(this.triptych.updatePGPSave(!1),this.triptych.showPGPCheckBox()),h&&(this.triptych.updatePMRSave(!1),this.triptych.showPMRCheckBox()),c){var p=C.get("iterationSave",this.localStorageOptions);this.triptych.updateIterSave(p),this.triptych.showIterationCheckBox()}if("undefined"!=u&&(this._disableBookmarkChooser=u,this.ToolBarCommands.hasOwnProperty("Bookmark")&&this._disableBookmarkChooser&&this.ToolBarCommands.Bookmark.enbaleBookmarkBtn()),_){this.triptych.updatePublicationExpose(!1),this.triptych.showPublicationCheckBox()}if(g){this.triptych.updateApplyMaterial(!1),this.triptych.showMaterialCheckBox()}var A=C.get("IsAddCommentChecked",this.localStorageOptions);this.triptych.updateAddCommentCheck(A);s.sendMessageToCad("WebSavePanelLoaded","1.0",{})},UpdateActiveCommand:function(e){for(var t in this.ActiveCommand=e,this.ActiveCommandId=null!==e?e._id:"",this.ToolBarCommands)this.ToolBarCommands.hasOwnProperty(t)&&this.ToolBarCommands[t].updateAvailability(this.selectedNodes)},showNewFileNameSidePanel:function(e,t){this.ActiveCommandId="idNewFileNameCmd";var n=Object.keys(this.selectedNodes)[0],o=this.selectedNodes[n]._options.grid.Filename.replace(/\.[^/.]+$/,"");console.log('fileNameWithOutExt = "'+o+'"'),new h(o,this.restrictedCharactersForFileName,e?t:"")},showWarning:function(e,t){new m(e,t)},showDuplicateDialog:function(e){this.ActiveCommandId=e;new g},onNewFileNameOk:function(e){var t={selectedNodesId:Object.keys(this.selectedNodes),newFileName:e};s.sendMessageToCad("newFileName","1.0",t)},onDuplicateOk:function(e){var t={selectedNodesId:Object.keys(this.selectedNodes),prefixDup:e};s.sendMessageToCad("duplicate","1.0",t)},LaunchChangeMaturityPanel:function(e){widget.XCAD_MainController.ToolBarCommands.hasOwnProperty("Maturity")&&widget.XCAD_MainController.ToolBarCommands.Maturity.LaunchChangeMaturityPanel(e)},showDerivedOutputSidePanel:function(e){this.ActiveCommandId="ENOUPSSetDerivedOutputCmd";new v(e);s.sendMessageToCad("WebSavePanelLoaded","1.0",{})},onSetDerivedOutputOk:function(e){var t={derivedOutputs_Icon_Dico:e};s.sendMessageToCad("DerivedOutputOK","1.0",t)},toogleRightPanel:function(){this.triptych.toogleRightPanel()},onUpdatePreview:function(e){document.getElementById("idBase64").setAttribute("src","data:image/png;base64, "+e)},onChangeIsAsyncSave:function(e){var t={isAsyncSave:e};s.sendMessageToCad("ChangeIsAsyncSave","1.0",t),C.set("asyncSave",e,this.localStorageOptions)},onChangeUnreserveCheck:function(e){var t={bUnreserve:e};s.sendMessageToCad("ChangeUnreserveCheck","1.0",t),C.set("unreserveAfterSave",e,this.localStorageOptions)},onChangePGPCheck:function(e){var t={bSavePGP:e};s.sendMessageToCad("ChangePGPCheck","1.0",t)},onChangePMRCheck:function(e){var t={bSavePMR:e};s.sendMessageToCad("ChangePMRCheck","1.0",t)},onChangeKeepIterationOption:function(e){var t={bKeepIteration:e};s.sendMessageToCad("ChangeKeepIteration","1.0",t),C.set("iterationSave",e,this.localStorageOptions)},onChangeExposePublicationOption:function(e){var t={bExposePublication:e};s.sendMessageToCad("ChangeExposePublication","1.0",t)},onChangeApplyMaterialOption:function(e){var t={bApplyMaterial:e};s.sendMessageToCad("ChangeApplyMaterial","1.0",t)},OnSelectRootNodesForODTs:function(e){var t=this.model.getRoots()[e];"undefined"!==t&&t.select()},_dispatchMouseEvent:function(e,t,n,o){o||(o={});var i={left:0,top:0};e.getBoundingClientRect?i=e.getBoundingClientRect():e.getContent&&e.getContent()&&e.getContent().getBoundingClientRect&&(i=e.getContent().getBoundingClientRect()),(o.moveX||o.moveY)&&(o.clientX=o.moveX+i.left,o.clientY=o.moveY+i.top),o.clientX||o.screenX||(o.clientX=i.left),o.clientY||o.screenY||(o.clientY=i.top);var a=new MouseEvent(t,o);return a.isSimulated=!0,e.dispatchEvent(a),a},OnUnSelectRootNodesForODTs:function(e){for(var t=this.model.getRoots(),n=0;n<e.length;n++){var o=t[e[n]];"undefined"!==o&&o.unselect()}},onAddCommentEditor:function(e){var t={AddComment:e};s.sendMessageToCad("AddComment","1.0",t)},onAddCommentChange:function(e){var t={IsAddCommentChecked:e};s.sendMessageToCad("IsAddCommentChecked","1.0",t),C.set("IsAddCommentChecked",e,this.localStorageOptions)}},widget.launched?widget.XCAD_MainController.onLoad():widget.onLoad=widget.XCAD_MainController.onLoad});