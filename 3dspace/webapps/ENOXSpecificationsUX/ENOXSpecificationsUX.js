define("DS/ENOXSpecificationsUX/data/Connector3DSpace",["UWA/Core","UWA/Utils","UWA/Promise","DS/ENOXAttachmentsUX/data/Constants","DS/DocumentManagement/DocumentManagement","DS/WAFData/WAFData","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","DS/DocumentCommonInfra/TrackerAPI","i18n!DS/ENOXAttachmentsUX/assets/nls/ENOXAttachmentsUX"],function(t,e,n,o,a,r,i,s,c){"use strict";return function(){var r={options:{},init:function(t,e){if(r.controller=t,r.options=e||{},!(r.options&&r.options.fetchSecurityContext&&r.options.platformUrls&&r.options.platformUrls["3DSpace"]&&r.options.platformUrls.platformId)){n=new Date-t.ctrl.specificationsPaneStartTime;throw s.sendTrackerPageEvent({category:"docm.specificationsPane.ready",action:"click",label:"Specifications Ready",pd:{},pv:{totalTimeTaken:n,failure:0}}),new Error("Connector Options incomplete")}var n=new Date-t.ctrl.specificationsPaneStartTime;s.sendTrackerPageEvent({category:"docm.specificationsPane.ready",action:"click",label:"Specifications Ready",pd:{},pv:{totalTimeTaken:n,success:1}}),r.ready=!0,r.controller.connectorReady(r.options)},loadAttachments:function(i){if(!this.ready){var l=new Date-d;throw s.sendTrackerPageEvent({category:"docm.specifications.ready",action:"auto",label:"Specifications Ready",pd:{parentId:void 0},pv:{totalTimeTaken:l,status:-1}}),new Error("Connector not ready")}var d=new Date;if(i){var p=e.getUUID();if(r.controller.loadToken=p,i.noParent&&t.is(i.objectIds,"array"))a.getDocuments(i.objectIds,{tenant:r.options.platformUrls.platformId,securityContext:r.options.fetchSecurityContext(),tenantUrl:r.options.platformUrls["3DSpace"],additionalURLParams:"$fields=indexedImage,indexedTypeicon,isDocumentType,organizationTitle,isLatestRevision,!parentId",onComplete:function(t){var e=r.controller.ctrl.options.parentObject;if(i.objectIds==e.objectIds){if(t.success){if(!Array.isArray(t.data))return;var n=new Date-d;s.sendTrackerPageEvent({category:"docm.specifications.ready",action:"click",label:"Specifications Ready",pd:{parentId:void 0,parentObjs:i.objectIds,parentRelName:i.parentRelName},pv:{totalTimeTaken:n,success:1,numOfDocs:t.data.length,noParent:!0}}),r.controller.loadToken==p&&r.controller.addAttachmentsToUI(t.data)}r.controller.finishLoadingAttachments()}},onFailure:function(t){r.controller.finishLoadingAttachments();var e=new Date-d;s.sendTrackerPageEvent({category:"docm.specifications.ready",action:"click",label:"Specifications Ready",pd:{parentId:void 0,parentObjs:i.objectIds,parentRelName:i.parentRelName},pv:{totalTimeTaken:e,failure:0,numOfDocs:void 0}}),t.error&&r.controller.showNotification("error",c.get("FAILED_TO_LOAD_SPECIFICATIONS"),t.error)}});else{var m=n.deferred(),f=n.deferred();t.Promise.all([m.promise,f.promise]).then(function(){r.controller.finishLoadingAttachments();var t=new Date-window.loadAttachmentsStartTime;s.sendTrackerPageEvent({category:"docm.specifications.completeLoad",action:"click",label:"Specifications Complete Load",pd:{},pv:{totalTimeTaken:t,success:1,numOfDocs:r.controller.attachments.getRoots().length}})});var u={relInfo:{parentId:i.parentId,parentRelName:i.relationName||o.SPECIFICATION_DOCUMENT,parentDirection:"from"},tenant:r.options.platformUrls.platformId,securityContext:r.options.fetchSecurityContext(),tenantUrl:r.options.platformUrls["3DSpace"],additionalURLParams:"$fields=indexedImage,indexedTypeicon,isDocumentType,organizationTitle,isLatestRevision,!parentId",onComplete:function(t,e){var n=r.controller.ctrl.options.parentObject;if(e.relInfo.parentId==n.parentId&&e.relInfo.parentRelName==(n.relationName||o.SPECIFICATION_DOCUMENT)){if(!Array.isArray(t.data))return;var a=new Date-d;s.sendTrackerPageEvent({category:"docm.specifications.ready",action:"auto",label:"Specifications Ready",pd:{parentId:i.parentId,parentObjs:i.objectIds,parentRelName:i.parentRelName},pv:{totalTimeTaken:a,success:1,numOfDocs:t.data.length}}),t.data.forEach(function(t){t.relName=u.relInfo.parentRelName}),r.controller.loadToken==p&&r.controller.addAttachmentsToUI(t.data),m.resolve()}},onFailure:function(t){console.error(t);var e=new Date-d;s.sendTrackerPageEvent({category:"docm.specifications.ready",action:"click",label:"Specifications Ready",pd:{parentId:i.parentId,parentObjs:i.objectIds,parentRelName:i.parentRelName},pv:{totalTimeTaken:e,failure:0,numOfDocs:0}}),t.error&&r.controller.showNotification("error",c.get("FAILED_TO_LOAD_SPECIFICATIONS"),t.error),m.resolve()}};a.getDocumentsFromParent(u);var T={relInfo:{parentId:i.parentId,parentRelName:o.REL_PLMDOCCONNECTION,parentDirection:"from"},tenant:r.options.platformUrls.platformId,securityContext:r.options.fetchSecurityContext(),tenantUrl:r.options.platformUrls["3DSpace"],additionalURLParams:"$fields=indexedImage,indexedTypeicon,isDocumentType,organizationTitle,isLatestRevision,!parentId",onComplete:function(t,e){var n=r.controller.ctrl.options.parentObject;if(e.relInfo.parentId==n.parentId&&e.relInfo.parentRelName==o.REL_PLMDOCCONNECTION){if(!Array.isArray(t.data))return;t.data.forEach(function(t){t.relName=o.REL_PLMDOCCONNECTION});var a=new Date-d;s.sendTrackerPageEvent({category:"docm.specifications.PLMDMT.ready",action:"auto",label:"Specifications PLMDT Ready",pd:{parentId:i.parentId,parentObjs:i.objectIds,parentRelName:o.REL_PLMDOCCONNECTION},pv:{totalTimeTaken:a,success:1,numOfDocs:t.data.length}}),r.controller.loadToken==p&&r.controller.addAttachmentsToUI(t.data),f.resolve()}},onFailure:function(t){var e=new Date-d;s.sendTrackerPageEvent({category:"docm.specifications.PLMDMT.ready",action:"click",label:"Specifications PLMDMT Ready",pd:{parentId:i.parentId,parentObjs:i.objectIds,parentRelName:o.REL_PLMDOCCONNECTION},pv:{totalTimeTaken:e,failure:0,numOfDocs:0}}),console.error(t),t.error&&r.controller.showNotification("error",c.get("FAILED_TO_LOAD_SPECIFICATIONS"),t.error),f.resolve()}};a.getDocumentsFromParent(T)}}},uploadAttachments:function(t,e,n){require(["DS/DocumentCreateNew/CreateNew","DS/Windows/ImmersiveFrame"],function(a,i){var s=new i;s.inject(widget.body),new a({tenantUrl:r.options.platformUrls["3DSpace"],securityContext:r.options.fetchSecurityContext(),tenant:r.options.platformUrls.platformId,immersiveFrame:s,parentObject:e,parentRelName:e.relationName||o.SPECIFICATION_DOCUMENT,connector:r,supportedTypes:n,credentialsPrefName:r.options.credentialsPrefName||o.PAD_CURRENT_SECURITY_CONTEXT,onUploadStart:function(){s.destroy()},onCancel:function(){s.destroy()},onError:function(t){r.controller.showNotification("error",c.get("UPLOAD_FAILED"),t.subtitle,t.message||""),s.destroy()}}).create(t)})},attachAttachments:function(e,n){if(e.length>0){for(var s=r.controller.attachments.getRoots(),l=0;l<s.length;l++){var d=s[l];if(e.includes(d.options.data.id)){r.controller.showNotification("error",c.get("TYPE_ATTACH_FAILED",{type:d.options.data.dataelements.typeNLS}),c.get("X_IS_ALREADY_ATTACHED",{title:d.options.data.dataelements.title||d.options.data.dataelements.secondaryTitle||d.options.data.dataelements.name}));var p=e.indexOf(d.options.data.id);p>-1&&e.splice(p,1)}}a.getDocuments(e,{tenant:r.options.platformUrls.platformId,securityContext:r.options.fetchSecurityContext(),tenantUrl:r.options.platformUrls["3DSpace"],additionalURLParams:"$fields=indexedImage,indexedTypeicon,isDocumentType,organizationTitle,isLatestRevision,!parentId",onComplete:function(e){if(e.success)for(var a=0;a<e.data.length;a++){var s=e.data[a];e.data[a].relName=o.SPECIFICATION_DOCUMENT;var l=!0;if(n&&n.parentId&&s.id==n.parentId){r.controller.showNotification("error",c.get("TYPE_ATTACH_FAILED",{type:s.dataelements.typeNLS}),c.get("CANNOT_ATTACH_X_TO_ITSELF",{title:s.dataelements.title||s.dataelements.secondaryTitle||s.dataelements.name})),l=!1;break}if(l)if(!r.controller.options.supportedTypes.includedTypes.includes("*")&&!r.controller.options.supportedTypes.includedTypes.includes(s.type)||r.controller.options.supportedTypes.excludedTypes.includes(s.type))r.controller.showNotification("error",c.get("DOCUMENT_NOT_ALLOWED",{type:s.dataelements.typeNLS}),c.get("X_CANNOT_BE_ATTACHED",{type:s.type}));else if(n.noParent){var d={onFailure:function(e){console.error(e),t.is(e,"string")&&r.controller.showNotification("error",c.get("FAILED_TO_ATTACH_ATTACHMENT"),e)},onSuccess:function(t){r.controller.addAttachmentsToUI([t]),r.controller.showNotification("success",c.get("DOCUMENT_ATTACHED",{type:t.dataelements.typeNLS}),c.get("X_ATTACHED_SUCCESSFULLY",{title:t.dataelements.title||t.dataelements.secondaryTitle||t.dataelements.name}))}};r.controller.events.publish({event:"attach-document-requested",data:{document:s,parentObject:n,callback:d}})}else i(s,n)}},onFailure:function(e){if(e.error)if((e.error.match(/\n/g)||[]).length>2){for(var n=e.error.split("\n"),o=[],a=2;a<n.length;a++)o.push(n[a]);o=o.join("<br/>"),r.controller.showNotification("error",n[0],n[1],o,void 0,!0)}else r.controller.showNotification("error",c.get("DOCUMENT_ATTACH_FAILED"),e.error);else t.is(e,"string")?r.controller.showNotification("error",c.get("DOCUMENT_ATTACH_FAILED"),e):r.controller.showNotification("error",c.get("DOCUMENT_ATTACH_FAILED"))}})}},detachAttachments:function(t,e){if(e.noParent){var n={onSuccess:function(e){t.forEach(function(t){e.forEach(function(e){t.options.data.id==e&&(r.controller.attachments.removeRoot(t),r.controller.showNotification("success",c.get("DOCUMENT_DETACHED",{type:t.options.data.dataelements.typeNLS}),c.get("X_DETACHED_SUCCESSFULLY",{title:t.options.data.dataelements.title||t.options.data.dataelements.secondaryTitle||t.options.data.dataelements.name})))})})}};r.controller.events.publish({event:"detach-attachments-requested",data:{ids:r.controller.helper.restrict(t,"options.data.id"),parentObject:e,callback:n}})}else for(var o=0;o<t.length;o++){l(t[o],e)}},getUpdatedAttachment:function(e,n){a.getDocuments([e.id],{tenant:r.options.platformUrls.platformId,securityContext:r.options.fetchSecurityContext(),tenantUrl:r.options.platformUrls["3DSpace"],additionalURLParams:"$fields=indexedImage,indexedTypeicon,isDocumentType,organizationTitle,isLatestRevision,!parentId",onComplete:function(t){if(t.success){if(!Array.isArray(t.data))return;t.data.forEach(function(t){t.relName=e.relName||o.SPECIFICATION_DOCUMENT}),n(t.data)}},onFailure:function(e){e.error?r.controller.showNotification("error",c.get("FAILED_TO_GET_UPDATED_ATTACHMENT"),e.error):t.is(e,"string")?r.controller.showNotification("error",c.get("FAILED_TO_GET_UPDATED_ATTACHMENT"),e):r.controller.showNotification("error",c.get("FAILED_TO_GET_UPDATED_ATTACHMENT"))}})},getUpdatedAttachments:function(e,n,o){a.getDocuments(e.map(function(t){return t.id}),{tenant:r.options.platformUrls.platformId,securityContext:r.options.fetchSecurityContext(),tenantUrl:r.options.platformUrls["3DSpace"],additionalURLParams:"$fields=indexedImage,indexedTypeicon,isDocumentType,organizationTitle,isLatestRevision,!parentId",onComplete:function(t){if(t.success){if(!Array.isArray(t.data))return;n(t.data)}},onFailure:function(e){t.is(o,"function")?o(e):e.error?r.controller.showNotification("error",c.get("FAILED_TO_GET_UPDATED_ATTACHMENT"),e.error):t.is(e,"string")?r.controller.showNotification("error",c.get("FAILED_TO_GET_UPDATED_ATTACHMENT"),e):r.controller.showNotification("error",c.get("FAILED_TO_GET_UPDATED_ATTACHMENT"))}})},ready:!1,uploadAttachment:function(e,n,o){if(r.ready){var i={customDocumentObject:e.custom_attributes?{dataelements:e.custom_attributes}:void 0,tenant:r.options.platformUrls.platformId,securityContext:o,tenantUrl:r.options.platformUrls["3DSpace"],additionalHeaders:t.is(r.options.getWorkUnderHeaders,"function")?r.options.getWorkUnderHeaders():{},onFailure:function(t){if(t.error)if((t.error.match(/\n/g)||[]).length>2){for(var o=t.error.split("\n"),a=[],i=2;i<o.length;i++)a.push(o[i]);a=a.join("<br/>"),r.controller.showNotification("error",o[0],o[1],a,void 0,!0)}else r.controller.showNotification("error",c.get("UPLOAD_FAILED"),t.error);else e.dataelements||(e.dataelements={title:e.title}),r.controller.showNotification("error",c.get("UPLOAD_FAILED"),t.error?t.error:c.get("X_UPLOAD_FAILED",{title:e.dataelements.title||e.dataelements.secondaryTitle||e.dataelements.name}));r.controller.events.publish({event:"upload-attachment-failure",data:{document:e,parentObject:n}}),r.controller.jobs.finishJob(s)},onProgress:function(t){r.controller.events.publish({event:"upload-attachment-progress",data:{document:e,parentObject:n}}),s.update(t)},onComplete:function(t){t.data&&(t.data[0].dataelements.isDocumentType="TRUE");var o=t.data;o.forEach(function(t){t.delayLoadThumbnails=!0,e.relInfo&&(t.relName=e.relInfo.parentRelName)});var a=function(t){t[0].dataelements.parentId&&r.controller.options.parentObject.parentId?t[0].dataelements.parentId.includes(r.controller.options.parentObject.parentId)&&r.controller.addAttachmentsToUI(t):r.controller.addAttachmentsToUI(t),1==t.length?r.controller.showNotification("success",c.get("DOCUMENT_ATTACHED",{type:t[0].dataelements.typeNLS}),c.get("X_ATTACHED_SUCCESSFULLY",{title:t[0].dataelements.title||t[0].dataelements.secondaryTitle||t[0].dataelements.name})):t.length>1&&r.controller.showNotification("success",c.get("DOCUMENTS_ATTACHED"),c.get("X_DOCUMENTS_ATTACHED_SUCCESSFULLY",{num:t.length}))},i={event:"upload-attachment-complete",data:{documents:o,parentObject:n}};n.noParent&&(i.data.callback=a),r.controller.events.publish(i),r.controller.jobs.finishJob(s),n.noParent||a(o)}},s={title:c.get("UPLOADING_X",{title:e.title}),ui:!0,process:function(){a.createDocument(e,i)}};r.controller.jobs.addJob(s)}}};function i(e,n){if(r.ready){var i={relInfo:{parentId:n.parentId,parentRelName:n.relationName||o.SPECIFICATION_DOCUMENT,parentDirection:"from"},tenant:r.options.platformUrls.platformId,securityContext:r.options.fetchSecurityContext(),tenantUrl:r.options.platformUrls["3DSpace"],additionalHeaders:t.is(r.options.getWorkUnderHeaders,"function")?r.options.getWorkUnderHeaders():{},onFailure:function(t){if(t.error)if((t.error.match(/\n/g)||[]).length>2){for(var o=t.error.split("\n"),a=[],i=2;i<o.length;i++)a.push(o[i]);a=a.join("<br/>"),r.controller.showNotification("error",o[0],o[1],a,void 0,!0)}else r.controller.showNotification("error",c.get("TYPE_ATTACH_FAILED",{type:e.dataelements.typeNLS}),t.error);else r.controller.showNotification("error",c.get("TYPE_ATTACH_FAILED",{type:e.dataelements.typeNLS}),c.get("X_ATTACH_FAILED",{title:e.dataelements.title||e.dataelements.secondaryTitle||e.dataelements.name}));r.controller.events.publish({event:"attach-attachment-failure",data:{document:e,parentObject:n}}),r.controller.jobs.finishJob(s)},onProgress:function(t){r.controller.events.publish({event:"attach-attachment-progress",data:{document:e,parentObject:n}}),s.update(t)},onComplete:function(t){r.controller.events.publish({event:"attach-attachment-complete",data:{document:e,parentObject:n}}),r.controller.jobs.finishJob(s),e.relName=i.relInfo.parentRelName,n.parentId&&r.controller.options.parentObject.parentId?n.parentId.includes(r.controller.options.parentObject.parentId)&&r.controller.addAttachmentsToUI([e]):r.controller.addAttachmentsToUI([e]),r.controller.showNotification("success",c.get("DOCUMENT_ATTACHED",{type:e.dataelements.typeNLS}),c.get("X_ATTACHED_SUCCESSFULLY",{title:e.dataelements.title||e.dataelements.secondaryTitle||e.dataelements.name}))}},s={title:c.get("ATTACHING_X",{title:e.dataelements.title||e.dataelements.secondaryTitle||e.dataelements.name}),ui:!1,process:function(){a.connectDocumentToParent(e.id,i)}};r.controller.jobs.addJob(s)}}function l(e,n){if(r.ready){var i={relInfo:{parentId:n.parentId,parentRelName:e.options.data.relName||o.SPECIFICATION_DOCUMENT,parentDirection:"from"},tenant:r.options.platformUrls.platformId,securityContext:r.options.fetchSecurityContext(),tenantUrl:r.options.platformUrls["3DSpace"],additionalHeaders:t.is(r.options.getWorkUnderHeaders,"function")?r.options.getWorkUnderHeaders():{},onFailure:function(o){if(r.controller.events.publish({event:"detach-attachment-failure",data:{id:r.controller.helper.restrict(e,"options.data.id"),parentObject:n}}),r.controller.jobs.finishJob(s),o.error)if((o.error.match(/\n/g)||[]).length>2){for(var a=o.error.split("\n"),i=[],l=2;l<a.length;l++)i.push(a[l]);i=i.join("<br/>"),r.controller.showNotification("error",a[0],a[1],i,void 0,!0)}else r.controller.showNotification("error",c.get("FAILED_TO_DETACH_ATTACHMENT",{type:e.options.data.dataelements.typeNLS}),o.error);else t.is(o,"string")?r.controller.showNotification("error",c.get("FAILED_TO_DETACH_ATTACHMENT",{type:e.options.data.dataelements.typeNLS}),o):r.controller.showNotification("error",c.get("FAILED_TO_DETACH_ATTACHMENT",{type:e.options.data.dataelements.typeNLS}))},onProgress:function(t){r.controller.events.publish({event:"detach-attachment-progress",data:{id:r.controller.helper.restrict(e,"options.data.id"),parentObject:n}}),s.update(t)},onComplete:function(t){r.controller.jobs.finishJob(s),t.success&&r.controller.attachments.getRoots().forEach(function(e){t.data.forEach(function(t){e.options.data.id==t.id&&(r.controller.events.publish({event:"detach-attachment-complete",data:{id:r.controller.helper.restrict(e,"options.data.id"),parentObject:n}}),r.controller.attachments.removeRoot(e),r.controller.showNotification("success",c.get("DOCUMENT_DETACHED",{type:e.options.data.dataelements.typeNLS}),c.get("X_DETACHED_SUCCESSFULLY",{title:e.options.data.dataelements.title||e.options.data.dataelements.secondaryTitle||e.options.data.dataelements.name})))})})}},s={title:c.get("DETACHING_X",{title:e.options.data.dataelements.title||e.options.data.dataelements.secondaryTitle||e.options.data.dataelements.name}),ui:!1,process:function(){a.disconnectDocumentFromParent(e.options.data.id,i)}};r.controller.jobs.addJob(s)}}return r}}),define("DS/ENOXSpecificationsUX/SpecificationsPane",["UWA/Core","DS/ENOXAttachmentsUX/data/Controller","DS/ENOXSpecificationsUX/data/Connector3DSpace","DS/ENOXAttachmentsUX/views/Topbar","DS/ENOXAttachmentsUX/views/UploadPane","DS/ENOXAttachmentsUX/views/GridPane","DS/ENOXAttachmentsUX/views/TilePane","DS/ENOXAttachmentsUX/views/ProgressPane","text!DS/ENOXAttachmentsUX/assets/config.json","DS/ENOXAttachmentsUX/data/DnDManager","DS/CoreEvents/ModelEvents","DS/UIKIT/Mask","DS/ENOXAttachmentsUX/utils/Overlay","i18n!DS/ENOXAttachmentsUX/assets/nls/ENOXAttachmentsUX","css!DS/ENOXAttachmentsUX/ENOXAttachmentsUX.css"],function(t,e,n,o,a,r,i,s,c,l,d,p,m,f,u){"use strict";c=JSON.parse(c);var T={actionBarRestrict:["attachURL"]};return c.actionbar=c.actionbar.filter(t=>!T.actionBarRestrict.includes(t.name)),c.actionbar.forEach(function(t){t.text=f.get(t.nls),t.title=f.get(t.nls),t.content&&t.content.options&&t.content.options.items&&t.content.options.items.forEach(function(t){t.text=f.get(t.nls),t.description=f.get(t.nls)})}),c.headers.forEach(function(t){t.text=f.get(t.nls)}),c.contextMenu.forEach(function(t){t.text=f.get(t.nls),t.title=f.get(t.nls)}),t.Controls.Abstract.extend({name:"enox-attachments",options:{className:""},_options:{},modelEvents:void 0,init:function(e){this.specificationsPaneStartTime=new Date,this.modelEvents=e.events||new d,this.config=t.clone(c),this._parent(e),this._options=e,this.buildSkeleton()},buildSkeleton:function(){this.elements.container=t.createElement("div",{class:this.getClassNames()}),this.options.parentObject?this.startLoading():this.showNoParentSelected(),this.elements.content=t.createElement("div",{class:this.getClassNames("-content")}),this.elements.content.inject(this.elements.container),this.options.attachmentsType="specifications",new e(this),new o(this),this.buildContentPanes(),new s(this),new l(this),this._options.delayInitialize?console.log("Waiting for initialize to be called"):this.initialize()},buildContentPanes:function(){this.elements.panes=t.createElement("div",{class:this.getClassNames("-panes")}),this.elements.panes.inject(this.elements.content),new a(this),new r(this),new i(this)},setParentObject:function(t,e){var n=!1;"true"==e&&(n=!0),this.options.parentObject=t,this.finishLoading(),n?this.showNotSupportedParent():this.options.parentObject?this.startLoading():this.showNoParentSelected(),this.controller.clearAll(),n||this.controller.loadAttachments()},setConnectorOptions:function(e){t.merge(this.options.connectorOptions,e)},setSupportedTypes:function(e){t.merge(this.options.supportedTypes,e),t.merge(this.options.searchOptions,this.options.supportedTypes)},initialize:function(){this.controller.initialize(this,this._options.connector||new n)},attachSpecifications:function(t){this.controller.attachAttachments(t)},startLoading:function(){p.mask(this.elements.container)},finishLoading:function(){p.unmask(this.elements.container),m.unoverlay(this.elements.container)},showNoParentSelected:function(){m.overlay(this.elements.container,f.get("NOPARENTOBJECT"))},showNotSupportedParent:function(){m.overlay(this.elements.container,f.get("NOTSUPPORTEDSELECTION"))},destroy:function(){this.controller.destroy(),this._parent()},onRemoved:function(){this.destroy()},setSelection:function(t){this.controller.attachments.processDescendants({processNode:function(e){t.includes(e.nodeModel.options.data.id)?e.nodeModel.select():e.nodeModel.unselect()},onlyVisibleNodes:!1})},getSelection:function(){return this.controller.helper.restrict(this.controller.attachments.getSelectedNodes(),"options.data.id")}})});