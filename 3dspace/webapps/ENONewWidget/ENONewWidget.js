define("DS/ENONewWidget/ENONew/Controller/ENONewController",["UWA/Controls/Abstract","DS/ENONewWidget/ENONew/Controller/ENONewDialogController","DS/ENONewWidget/ENONew/Events","DS/Controls/Button","DS/ENONewWidget/ajaxRequests/ENONewServices","DS/ENONewWidget/utils/Notification","DS/ENOBusinessRuleClient/Services","DS/ENOCollabToolsUI/tracker/ENOCollabTracker","i18n!DS/ENONewWidget/assets/nls/ENONewWidgetNls"],function(e,t,i,n,a,o,r,s,c){return e.extend({skeleton:null,defaultAttributes:{},init:function(e,t){console.log("ENONew Controller init");this.createOptsModel=t,this.id=e.id,this.context=e.context,this.labelTopBar=e.labelTopBar,this.commandName=e.commandName,this.overlay=e.overlay,this.responseFormat=e.responseFormat,this.facets=e.facets,this.viewType=e.viewType,this.activatelock=e.activatelock,this.activateDraftMode=e.activateDraftMode,this.activateCreateAnother=e.activateCreateAnother,this._parent(e),this.objInfo={type:e.type,options:e.options,events:e.events},this.silentMode=e.silentMode,this.notification=e.notification,this.Services=new a(e.context,{parsedResult:e.parsed}),this.buttons={};var i=this.objInfo.events;for(eventID in i){var n=i[eventID];this.addEvent(eventID,n)}this.silentMode?this.silentCreation():this._setup()},getUI:function(e){var i=this;return new UWA.Promise(function(e){i.dialog||(i.dialog=new t),e(i.dialog)})},_setup:function(){var e=this,t=e.getUI(),i={type:this.objInfo.type,preferedType:this.objInfo.options.preferedType,subTypes:!this.createOptsModel||this.createOptsModel.get("showSubtype")},n=e._getTypeInfo(i),a=this.Services.getSecurityContextList();UWA.Promise.all([a,n,t]).then(function(t){console.log("ENONew PromiseAll SecurityContext, typeInfo"),e.postFetchAttributes(t[1],"launch"),e.defaultAttributes.SecurityContext=t[0],e.defaultAttributes.Type=t[1].Type,e.attributes=t[1].attributes,e.interfaces=t[1].interfaces,e.isUXBLDeployed=t[1].isUXModifyDeployed,e.basicAttributes=t[1].basicAttributes,t[1].reInitOnSecCtxChange&&e.defaultAttributes.SecurityContext&&(e.defaultAttributes.SecurityContext.reInitOnSecCtxChange=!0),t[1].prefs&&(e.prefs=t[1].prefs),e.displayDialog();var i={UXName:"New",UXSub:"Generic",numberObjects:1,actionStatus:s.success,pd16:e.options.options.typeName};e.lastTrackerEvent=s.createInitActionEvent(i),s.checkAndTrackPageEvent(e.lastTrackerEvent)}).catch(function(t){e.handleError(t),e.destroyComponent();var i={UXName:"New",UXSub:"Generic",numberObjects:1,actionStatus:s.failure,pd16:e.options.options.typeName};e.lastTrackerEvent=s.createInitActionEvent(i),s.checkAndTrackPageEvent(e.lastTrackerEvent)})},silentCreation:function(){var e=this,t={type:this.objInfo.type,subTypes:!1},i=e._getTypeInfo(t,!0),n=this.Services.getPreferedSecurityContext();UWA.Promise.all([n,i]).then(function(t){var i=t[0],n=t[1],a={eventID:"createClose",securityContext:i};e._create(n,a)}).catch(function(t){e.handleError(t),e.destroyComponent()})},displayDialog:function(){var e=this,t={defaultAttributes:this.defaultAttributes,attributes:this.attributes,interfaces:this.interfaces,prefs:this.prefs,isUXBLDeployed:this.isUXBLDeployed,basicAttributes:this.basicAttributes};this.context&&(this.context.service&&(t.service=this.context.service),this.context.tenant&&(t.tenant=this.context.tenant));var i={overlay:this.overlay,activatelock:this.activatelock,activateDraftMode:this.activateDraftMode,activateCreateAnother:this.activateCreateAnother,title:this.labelTopBar?this.labelTopBar:c.get("new")+" "+e.getCurrentTypeNLS(),persistId:"ENONew_"+(this.id?this.id:this.buildID()),facets:this.facets,viewType:this.viewType};this.defaultAttributes&&this.defaultAttributes.SecurityContext&&(i.securityContext=this.defaultAttributes.SecurityContext.value);var n={onChangeAttribute:function(t){console.log("ENONew Controller onchnage"),e._onChangeAttribute(t)},runBLForUI:function(t,i){console.log("ENONew controller runBLForUI"),e.runBLForUI(t,i)},onClose:function(){e.destroyComponent()}};this.dialog.setup(t,i,this.buttons,n,function(t,i,n){e.onSubmit(t,i,n)})},refreshDialog:function(){var e={defaultAttributes:this.defaultAttributes,attributes:this.attributes,interfaces:this.interfaces,isUXBLDeployed:this.isUXBLDeployed,basicAttributes:this.basicAttributes};this.dialog.reloadContent(e),this.dialog.resetButtons()},reloadDialog:function(e){var t=this,i={type:e};this._getTypeInfo(i).then(function(e){t.attributes=e.attributes,t.interfaces=e.interfaces,t.isUXBLDeployed=e.isUXModifyDeployed,t.basicAttributes=e.basicAttributes,t.refreshDialog()}).catch(function(e){t.handleError(e),t.destroyComponent()})},onSubmit:function(e,t,i){this.defaultAttributes=e.defaultAttributes;var n,a,o=e.defaultAttributes;for(var r in o){var s=o[r],c=s.name;if("Type"===c){n=s.value;var l=s.persistData;for(var u in l){var d=l[u];d.name===n&&(e.subTypes=[d])}}else"SecurityContext"===c&&(a=s.value)}t.securityContext=a,e.type=n,delete e.defaultAttributes,this._create(e,t,i)},_getTypeInfo:function(e,t){var i=e.type?e.type:this.objInfo.type,n=e.preferedType?e.preferedType:this.objInfo.options.preferedType,a=!!e.subTypes&&e.subTypes,o=e.securityContext?e.securityContext:void 0,r={type:i,preferedType:n,typeName:this.objInfo.options.typeName,parentOrigin:this.objInfo.options.parentOrigin,domainAttributes:this.objInfo.options.domainAttributes,subTypes:a,activatelock:!(!this.activatelock||!this.activatelock.show)||void 0,activateDraftMode:!(!this.activateDraftMode||!this.activateDraftMode.show)||void 0,initAttributes:this.objInfo.options.attributes?this.objInfo.options.attributes:void 0,runUXBL:!0};return this.objInfo.options.preferedType=n||i,this.Services.getTypeInfo1(r,o,t)},_onChangeAttribute:function(e){var t=this;if(e)for(var i in console.log(e),e){if("New-Type"===i){var n=e[i].valueDB,a={preferedType:n};t.dialog.disableFormSubmit(!0),t._getTypeInfo(a).then(function(e){t.defaultAttributes.Type.value=n,t.attributes=e.attributes,t.interfaces=e.interfaces,t.isUXBLDeployed=e.isUXModifyDeployed,t.basicAttributes=e.basicAttributes,t.postFetchAttributes(e,"onChangeType"),t.refreshDialog()}).catch(function(e){t.dispatchEvent("onFailure",[e]),t.destroyComponent()})}if("New-SecurityContext"===i){if(t.defaultAttributes.SecurityContext.reInitOnSecCtxChange){var o=e[i].valueDB;t.dialog.disableFormSubmit(!0),t._getTypeInfo({securityContext:o}).then(function(e){t.defaultAttributes.SecurityContext.value=o,t.attributes=e.attributes,t.interfaces=e.interfaces,t.isUXBLDeployed=e.isUXModifyDeployed,t.basicAttributes=e.basicAttributes,t.postFetchAttributes(e,"onChangeSecurityContext"),t.refreshDialog()}).catch(function(e){t.dispatchEvent("onFailure",[e]),t.destroyComponent()})}}else if("3DPartTemplate"===i){var r=e[i],s=r.valueDB,c=r.authorizedValues.includes(s);t.PartTemplate3D=c?s:""}}},runBLForUI:function(e,t){console.log("vma12: runBLForUI");var i=this.objInfo.type;this.objInfo.options&&this.objInfo.options.preferedType&&(i=this.objInfo.options.preferedType);var n={type:i,attributes:e.attribute,interfaces:e.interfaces};this.clientBLService||(this.clientBLService=new r(this.context)),this.clientBLService.runBusinessRuleForUI(2,[n],function(e){t(e)},function(){t()})},lockUnlockCreatedObject:function(e,t,i){return UWA.Promise(e=>{e()})},_create:function(e,t,i){var n=this;if(e){t=t||{};var a={};a.typeName=this.objInfo.options.typeName,a.aggregating_context=this.objInfo.options.parentPIDs,a.select=this.objInfo.options.select,a.folderID=this.objInfo.options.folderID,this.objInfo.options.selectedIDs&&(a.selectedIDs=this.objInfo.options.selectedIDs),a.activeFolder=this.objInfo.options.activeFolder;var o={queryParams:a,securityContext:t.securityContext};i&&(e.prefs={},i.footerCreateBtnState&&(e.prefs.createOption=i.footerCreateBtnState),i.toolbarIsLockEnabled&&(e.prefs.lockOption=i.toolbarIsLockEnabled),n.activateDraftMode.preference=i.footerCreateBtnState,n.activatelock.preference=i.toolbarIsLockEnabled),n.Services.createContent(e,o,function(a,o){setTimeout(function(){var r=n.lockUnlockCreatedObject(i,a,t);UWA.Promise.all([r]).then(i=>{n.onSuccessOfCreation(a,o,function(){"create"===t.eventID?n.reloadDialog(e.type):"createClose"===t.eventID&&n.destroyComponent();var i={typeObjects:e.type,numberObjects:1,actionStatus:s.success,pd16:n.options.options.typeName};n.lastTrackerEvent=s.createValidationEventFromEvent(i,n.lastTrackerEvent),s.checkAndTrackPageEvent(n.lastTrackerEvent)})}).catch(function(e){console.log("Lock/Unlock has failed")})},0)},function(i){n.handleError(i),"create"===t.eventID?n.reloadDialog(e.type):"createClose"===t.eventID&&n.destroyComponent();var a={typeObjects:e.type,actionStatus:s.failure,pd16:n.options.options.typeName};n.lastTrackerEvent=s.createValidationEventFromEvent(a,n.lastTrackerEvent),s.checkAndTrackPageEvent(n.lastTrackerEvent)})}},onSuccessOfCreation:function(e,t,i){var n=this;if("success"===e.status){if(n.responseFormat){if(2==n.responseFormat&&(e.parsedResult=JSON.parse(e.parsedResult),"FAILURE"!==e.parsedResult.result&&(e.parsedResult.rawAttr=JSON.parse(e.parsedResult.rawAttr),e.parsedResult.instances))){var a=e.parsedResult.instances;for(var o in a){var r=a[o];r.hasOwnProperty("to[CAD SubComponent].physicalid")?(r.relationphysicalid=r["to[CAD SubComponent].physicalid"],delete r["to[CAD SubComponent].physicalid"]):r.hasOwnProperty("to[VPMInstance].physicalid")&&(r.relationphysicalid=r["to[VPMInstance].physicalid"],delete r["to[VPMInstance].physicalid"]),r.hasOwnProperty("instanceName")&&(r.relationname=r.instanceName,delete r.instanceName)}}}else{var s=e.result,c=[];for(var l in s){var u=s[l],d={identifier:u.identifier?u.identifier:u.physicalid,source:t,type:u.type};u.relations&&(d.relations=u.relations),c.push(d)}e.result=c}n.dialog?n.dialog.postCreation(e,function(t){t&&(e.facetData=t),n.handleFacetErrors(e),n.dispatchEvent("onSuccess",[e]),i()}):(n.dispatchEvent("onSuccess",[e]),i())}else n.dialog?n.dialog.postCreation(e,function(){n.handleError(e),i()}):(n.handleError(e),i())},handleError:function(e){var t=e.result;if(void 0!==t&&this.notification)for(var i in t){var n=t[i];if(n.errors)for(ind1 in n.errors){var a=n.errors[ind1];this.setNotification("error",a)}}this.dispatchEvent("onFailure",[e])},handleFacetErrors:function(e){var t=e.facetData;if(t&&this.notification){var i,n={errorCode:"ENONEW_ERROR_8001"};if(Object.keys(t).forEach(function(e){var n=t[e],a=n.info;if(a&&a.errors&&a.errors.length>0){var o=a.errors[0];"ENONEW_FACETS_POSTCREATION"===o.errorCode&&o.errorMessages&&(i||(i=[]),i.push(n.facetNLS+" : "+o.errorMessages[0]))}}),i){n.errorMessages=i;var a="error";"success"===e.status&&(a="error"),this.setNotification(a,n)}}},getCurrentTypeNLS:function(){var e="";if(this.commandName)e=this.commandName;else if(this.defaultAttributes.Type){var t=this.defaultAttributes.Type.value,i=this.defaultAttributes.Type.range,n=this.defaultAttributes.Type.rangeNLS,a=i.indexOf(t);a>=0&&a<n.length&&(e=n[a])}return e},setNotification:function(e,t){var i=t.errorCode,n=t.errorTitle?t.errorTitle:c[i+"_Title"],a=t.errorSubtitle?t.errorSubtitle:c[i+"_Subtitle"],o="";if(t.errorMessages&&0!=t.errorMessages.length)for(var r in t.errorMessages){o&&(o+="<br>"),o+=t.errorMessages[r]}else o=c[i+"_Msg"];"ENONEW_ERROR_5001"!==i&&"InvalidAccess"!==i||t.errorTitle||(n=c.cantCreateObject+": "+this.getCurrentTypeNLS()),"ENONEW_ERROR_0003"!==i&&"ENONEW_ERROR_1003"!==i&&"ENONEW_ERROR_1002"!==i||(n=c.ObjCreationFailed),"ENONEW_ERROR_4005"!==i&&"ENONEW_ERROR_0002"!==i||(n+=": "+this.getCurrentTypeNLS()),"ENONEW_ERROR_0007"===i&&(n+=this.commandName?": "+this.commandName:"."),"ENONEW_ERROR_1004"===i&&(n=c.cantCreateObject1+": "+this.getCurrentTypeNLS(),a=c.contactYourAdmin),"ENONEW_ERROR_8001"===i&&(n=c.get(i+"_Title",{type:this.getCurrentTypeNLS()})),n||"error"!==e||(n=n=c.ObjCreationFailed);var s={level:e,title:n,subtitle:a,message:o};this._setNotification(s)},_setNotification:function(e){o.display(e)},update:function(e){this.dialogView.updateView(e)},destroyComponent:function(){var e={newType:this.objInfo.options.typeName,preferedType:this.objInfo.options.preferedType,lockStatus:this.activatelock.preference,draftStatus:this.activateDraftMode.preference,activateCreateAnother:this.dialog&&this.dialog.myDialog&&this.dialog.myDialog.checkboxInfos.checkFlag};this.dispatchEvent("onCancel",[e]),i.dispatchEvent("onNewInfraExit",[e]),this.dialog&&this.dialog.destroy(),this.destroy()},_raiseNotif:function(e,t){this.dispatchEvent("onNotification",{msg:e,eventID:t})},getSaveBtn:function(){var e=this,t=new n({label:c.saveBtn,onClick:function(i){if(!e.dialog.onEscKeyDown){var n=e.objInfo.options.preferedType;n&&""!=n&&null!=n&&null!=n||(n=e.objInfo.type);var a=n;if(n){var o=e.defaultAttributes.Type.range,r=e.defaultAttributes.Type.rangeNLS,s=o.indexOf(n);s>=0&&s<r.length&&(a=r[s])}a&&require(["DS/UIKIT/SuperModal"],function(i){new i({closable:!0,animate:!1,overlay:!0}).confirm({title:c.saveSettingsTitle,message:c.get("confirmsaveSettingsMsg",{type:a}),callback:function(i){if(t.label=c.saveBtnLoading,i){var o=e.PartTemplate3D;if(o){var r={type:n,UUID:o};e.Services.set3DPartTemplate(r,void 0,function(t){e.dialog._addNotif({msg:c.get("confirmsaveSuccessMsg",{type:a}),eventID:"success"})},function(t){e.dialog._addNotif({msg:c.get("confirmsaveErrorMsg",{type:a}),eventID:"error"})})}else e.dialog._addNotif({msg:c.get("confirmsaveErrorMsg",{type:a}),eventID:"error"})}t.label=c.saveBtn}})})}}});return t},postFetchAttributes:function(e,t){if(e&&e.attributes.volatileAttributes){var i=e.attributes.volatileAttributes;for(var n in i){var a=i[n];if("3DPartTemplate"===a.name&&(this.PartTemplate3D=a.value,"launch"===t)){var o=this.getSaveBtn();o.visibleFlag=!1,this.buttons.Close=o}}}},buildID:function(){var e="ID_";return this.objInfo.options.typeName&&(e+=this.objInfo.options.typeName),this.objInfo.type&&(e+=this.objInfo.type),this.Services&&(e+=this.Services.tenant),e.replaceAll(" ","_")}})}),define("DS/ENONewWidget/ENONew/View/Facet/ENONewFacetBase",["DS/EditPropWidget/facets/Common/FacetsBase"],function(e){return e.extend({init:function(e,t){this.sharedOptions=t,this.facetValidation=!0,this._parent(e)},updateFacet:function(){console.log("ENONewFacetBase : updateFacet() "+this.options.tabId)},setFacetValidation:function(e){this.facetValidation=e,this.getOccurrence().setValidation(e)},getFacetvalidation:function(){return this.facetValidation},publishInfo:function(e,t){e&&t&&this.getOccurrence().addInfo(this.options.tabId,e,t)},fetchInfo:function(e,t){if(e)return this.getOccurrence().getInfo(e,t)},listenToPublishedInfo:function(e,t){var i=this;setTimeout(()=>{i.getOccurrence().subscribeInfo(e,t)})},postCreation:function(e){var t=this;return console.log("onComplete : "+this.options.tabId),new UWA.Promise(function(e){e({name:t.options.tabId})})},destroy:function(){this._parent()}})}),define("DS/ENONewWidget/utils/ENONewConstants",[],function(){"use strict";return{ATTRIBUTES:"attributes",INTERFACES:"interfaces",PUBLIC_ATTRIBUTES:"publicAttributes",EXTN_ATTRIBUTES:"extensionAttributes",VOLATILE_ATTRIBUTES:"volatileAttributes",TYPES:{INTEGER:"integer",REAL:"real",TIMESTAMP:"timestamp",PERSON:"person",BOOLEAN:"boolean",ENUM:"enum"},DIALOG:{TAB_VIEW:"tabView",WIZARD_VIEW:"wizardView",LIST_VIEW:"listView"},DOMAIN_ATTRIBUTES:"domainAttributes"}}),define("DS/ENONewWidget/command/NewContentDialog",["UWA/Class","DS/Windows/ImmersiveFrame","DS/Windows/Panel","DS/Controls/Expander","DS/Controls/Button","DS/Controls/LineEditor","i18n!DS/ENONewWidget/assets/nls/ENONewWidgetNls","css!DS/ENONewWidget/ENONewWidget.css"],function(e,t,i,n,a,o,r){var s,c=r.newContentLabel;return e.extend({init:function(){s=new t({identifier:"ENONew_NewContentDialog_Frame"})},injectImmersiveFrame(e){e||(e=new UWA.Element("div")).inject(widget.body),s.inject(e)},display(e,t,i){var n,a=new UWA.Element("div");if(a.inject(widget.body),s.inject(a),e){var o=0;Object.keys(e).forEach(function(t){e[t]&&(o+=e[t].length)}),console.log("ENONewInfra NewContentDialog: noOfTypesToList="+o)}if(e&&0!=o){console.log("ENONew : Not prepared");var c={label:r.get("Type"),UIType:"Expander",items:[],expanded:!0};if(e){var l={};for(var u in e){var d=e[u];d&&d.length>0&&d.forEach(function(e){if(e){var i={UIType:"Command",label:e.nls,icon:t.iconBaseURL?t.iconBaseURL+e.icon:e.icon,newType:u,objType:e.name},n=e.package,a=l[n];a||(a={UIType:"Expander",label:n,items:[],expanded:!0},l[n]=a,c.items.push(a)),a.items.push(i)}})}}for(var f in l)l[f];n=this.displayDialog([c],t,function(e){var t=e.dsModel.value;t&&i({type:t.objType,newType:t.newType,commandName:t.label})})}else n=this.buildInputTypeField(t,i);return n},displayDialog:function(e,t,o){var r=new UWA.Element("div");function l(e){var t=new UWA.Element("div",{class:"expander_container grid-cell-expander"}),i=e.label?e.label:"",a=!!e.expanded&&e.expanded,o=new UWA.Element("div",{class:"expander_content grid-container-content"}),r=e.items;f(r).inject(o);var s=new n({header:i,body:o,style:"simple",expandedFlag:a});return s.inject(t),s}r.inject(widget.body);var u,d,f=function(e){var t,i,n,r,s,c;if(e)for(var u in t=new UWA.Element("div"),e){var d,f=e[u];"Expander"===f.UIType?d=l(f):"Command"===f.UIType?(i=f,n=void 0,r=void 0,s=void 0,c=void 0,n=new UWA.Element("div",{class:"command_content grid-cell-btn"}),r=i.label?i.label:"",s=i.icon?i.icon:"",(c=i.launcherOptions?i.launcherOptions:"")||(c=i),new a({value:c,label:r,icon:s,displayStyle:"lite",onClick:o,styles:{display:"block",width:"fit-content"}}).inject(n),d=n):(console.log("NewContent : Incomplete data"),console.log(f)),d&&d.inject(t)}else console.log("NewContent : No data");return t},p=f(e),h=t.labelTopBar?t.labelTopBar:c;t.dimension&&(u=void 0!==t.dimension.height?t.dimension.height:-1,d=void 0!==t.dimension.width?t.dimension.width:-1);var v=void 0===t.resizable||t.resizable,m=new i({allowedDockAreas:WUXDockAreaEnum.NoneDockArea,immersiveFrame:s,title:h,content:p,height:u,width:d,resizableFlag:v,position:{my:"center",at:"center",of:s},identifier:"ENONew_NewContentDialog_Dialog"});return s.inject(r),m},buildDialog:function(e){var t,n,a=e.identifier?e.identifier:"ENONew_NewContentDialog",o=e.labelTopBar?e.labelTopBar:c;e.dimension&&(t=void 0!==e.dimension.height?e.dimension.height:-1,n=void 0!==e.dimension.width?e.dimension.width:-1);var r=void 0===e.resizable||e.resizable,l=e.content?e.content:void 0;return new i({identifier:a,allowedDockAreas:WUXDockAreaEnum.NoneDockArea,immersiveFrame:s,title:o,content:l,height:t,width:n,resizableFlag:r,position:{my:"center",at:"center",of:s}})},buildInputTypeField(e,t){var i=this,n=new UWA.Element("div",{class:"command_content_vma12 input_type"}),r=new UWA.Element("div",{class:"lineContainer input_type"});r.inject(n),new UWA.Element("span",{text:"Dictionary Type"}).inject(r);var s=new o({placeholder:"Enter a value",value:i.lineEditorValue?i.lineEditorValue:"VPMReference"});s.inject(r),s.addEventListener("change",function(e){i.lineEditorValue=e.dsModel.value});var c=new UWA.Element("div",{class:"lineContainer button_create"});c.inject(n);var l=function(){t({type:s.value,newType:"Default"})},u=(new a({value:"Create",label:"Create",onClick:l,emphasize:"primary",styles:{display:"block",width:"fit-content"}}).inject(c),this.buildDialog({content:n}));return u.addEventListener("keydown",function(e){13==e.keyCode&&l()}),u},destroyDialog:function(){s.destroyAllWindows()}})}),define("DS/ENONewWidget/utils/Notification",["UWA/Core","DS/WebappsUtils/Console","DS/Notifications/NotificationsManagerUXMessages","DS/Notifications/NotificationsManagerViewOnScreen"],function(e,t,i,n){"use strict";var a={notificationsManager:null,display:function(e){null===a.notificationsManager&&(a.notificationsManager=i,n.setNotificationManager(a.notificationsManager),n.setStackingPolicy(9));var t={level:e.level,title:e.title,subtitle:e.subtitle,message:e.message?e.message:"",sticky:"error"===e.level};a.notificationsManager.addNotif(t)}};return a}),define("DS/ENONewWidget/command/NewContentOptions",["UWA/Class"],function(e){return e.extend({init(){this.prefType},getNewTypeList:function(){return{typeList:[],showSubtype:!1}},getCreateOptions:function(e){return this.launcherOptions||(this.launcherOptions={type:e.type,context:{service:"3DSpace"},silentMode:!1,notification:!0,options:{typeName:e.newType,parentPIDs:[],selectedIDs:[],domainAttributes:[]},events:{onSuccess:function(){console.log("Creation Successful")},onFailure:function(){console.log("Creation Error")},onCancel:function(e){console.log("Creation dialog closed")}}}),this.launcherOptions},getLoginContext:()=>({header:{SecurityContext:""},tenant:"",service:"",serviceBaseUrl:""})})}),define("DS/ENONewWidget/command/NewContentCmdMap",["UWA/Class"],function(e){var t={MockDocument:{cmdRequire:"DS/ENOCollabSharingCmds/commands/Sample/ENONewMockDocumentCmd"},PhysicalProductCBDAssembly:{cmdRequire:"DS/ENOCollabSharingCmds/commands/ENONew/NewECcompCBDAssembly"},PhysicalProductCBDBoard:{cmdRequire:"DS/ENOCollabSharingCmds/commands/ENONew/NewECcompCBDBoard"},PhysicalProductPLMPCBPhysicalComponent:{cmdRequire:"DS/ENOCollabSharingCmds/commands/ENONew/NewECcompPLMPCBPhysicalComponent"},assembly:{cmdRequire:"DS/ENOCollabSharingCmds/commands/ENONew/NewProduct"},component:{cmdRequire:"DS/ENOCollabSharingCmds/commands/ENONew/NewPart"},drawing:{cmdRequire:"DS/ENOCollabSharingCmds/commands/ENONew/NewDrawing"}};return e.singleton({getCmdDetails:e=>t[e],getRegisteredCmd(){}})}),define("DS/ENONewWidget/utils/ENONewFacetConstants",[],function(){return{ENONewFACET_CLASSIFICATION:"classificationFacet",ENONewFACET_REVISION:"revisionFacet",ENONewFACET_RELEASE_SNAPSHOT_TEMPLATE:"releaseSnapshotFacet",ENONewFACET_MATERIAL:"MaterialFacet",ENONewFACET_Files:"filesFacet"}}),define("DS/ENONewWidget/ajaxRequests/LifecycleServicesSettings",["UWA/Class","UWA/Class/Options","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices"],function(e,t,i){"use strict";return e.singleton(t,{folder_json:null,tenant:"",options:{wintop:!1},init:function(e){this._parent()},getTenant:function(){return this.tenant},setTenant:function(e){this.tenant=e},getInstance:function(e){try{this.init(e)}catch(e){}for(var t in e)this.options[t]=e[t];return this},get3DSpaceUrl:function(e){var t=location.protocol+"//"+location.hostname;return e&&(e.serverUrl=t,e.serverUri="3DSpace"),t+"/3DSpace"},get3DSpaceBaseUrl:function(e){if(!UWA.is(this.getOption("platform_services"),"array"))throw new Error("Platform services not initialize yet");var t;try{for(var i=0;i<this.getOption("platform_services").length;i++)if(this.getOption("platform_services")[i].platformId==e){t=this.getOption("platform_services")[i]["3DSpace"];break}}catch(e){t=this.get3DSpaceUrl()}return t},get3DSpaceWSUrl:function(e,t,i){e&&""!=e||(e=widget.getValue("x3dPlatformId")||"OnPremise");var n=this.get3DSpaceBaseUrl(e)+t+(t.indexOf("?")<0?"?":"&")+"tenant="+e;return null!=i&&null!=i&&(n=n+"&"+i),n},getServerURL:function(){var e="";return i.getPlatformServices({onComplete:function(t){e=t[0]["3DSpace"]}}),e},getPlatformUrl:function(e,t){var i=location.protocol+"//"+location.hostname,n=e;return t&&(t.serverUrl=i,t.serverUri=n),i+"/"+n},getPlatformBaseUrl:function(e,t){if(!UWA.is(this.getOption("platform_services"),"array"))throw new Error("Platform services not initialize yet");var i;try{for(var n=0;n<this.getOption("platform_services").length;n++)if(this.getOption("platform_services")[n].platformId==t){i=this.getOption("platform_services")[n][e];break}}catch(e){i=this.getPlatformUrl()}return i},getPlatformWSUrl:function(e,t,i,n){null!=t&&null!=t&&""!=t||(t="OnPremise");var a=this.getPlatformBaseUrl(e,t)+i+"?tenant="+t;return null!=n&&null!=n&&(a=a+"&"+n),a},service_initialization:function(e,t){var n=this,a=!1;try{UWA.is(this.getOption("platform_services"),"array")||(a=!0)}catch(e){a=!0}a?t?(n.setOption("platform_services",t),e()):i.getPlatformServices({onComplete:function(t){n.setOption("platform_services",t),void 0!==window.widget&&window.widget&&void 0!==window.widget.getValue("x3dPlatformId")&&window.widget.getValue("x3dPlatformId")&&window.widget.getValue("x3dPlatformId").trim().length>0?n.tenant=window.widget.getValue("x3dPlatformId"):n.tenant=t[0].platformId,e()},onFailure:function(t){e()}}):e()},getHeaders:function(e){var t={Accept:"application/json","Content-Type":"application/json","Accept-Language":widget.lang};return e&&(t.SecurityContext=e),t}})}),define("DS/ENONewWidget/ajaxRequests/ENONewAjaxRequests",["DS/WAFData/WAFData"],function(e){return{_get:function(t,i,n){var a=Date.now().toString(),o="timestamp"+a;t.params[o]=a;var r=t.service+"?tenant="+t.tenant;-1!=r.indexOf("?")?r+="&":r+="?";var s=t.params;for(var c in s){var l=s[c];l instanceof Array?l.forEach(function(e){r+=c+"="+e+"&"}):r+=c+"="+l+"&"}var u=this.getHeaders(t.header);e.authenticatedRequest(r,{method:"GET",headers:u,timeout:864e5,type:"json",onComplete:function(e){i(e)},onFailure:function(e,t){var i=e.message;i.startsWith("NetworkError:")&&i.contains("401")?n({result:[{errors:[{errorCode:"InvalidAccess"}]}]}):n({result:[{errors:[{errorCode:"NetworkError"}]}]})},onTimeout:function(){n({result:[{errors:[{errorCode:"NetworkError"}]}]})}})},_post:function(t,i,n,a){var o=JSON.stringify(t),r=i.service+"?tenant="+i.tenant;for(var s in-1!=r.indexOf("?")?r+="&":r+="?",i.params){var c=i.params[s];c instanceof Array?c.forEach(function(e){r+=s+"="+e+"&"}):r+=s+"="+c+"&"}var l=this.getHeaders(i.header);e.authenticatedRequest(r,{method:"POST",headers:l,timeout:864e5,data:o,type:"json",onComplete:function(e){n(e)},onFailure:function(e,t){var i=e.message;i.startsWith("NetworkError:")&&i.contains("401")?a({result:[{errors:[{errorCode:"InvalidAccess"}]}]}):a({result:[{errors:[{errorCode:"NetworkError"}]}]})},onTimeout:function(){a({result:[{errors:[{errorCode:"NetworkError"}]}]})}})},getHeaders:function(e){var t={Accept:"application/json","Content-Type":"application/json","Accept-Language":widget.lang};for(var i in e){var n=e[i];"SecurityContext"===i&&(n=encodeURIComponent(n)),t[i]=n}return t}}}),define("DS/ENONewWidget/utils/ENONewClientBLUtil",[],function(){"use strict";var e=["name","description"];return{getUIAttributesForBL:function(t,i){var n=this,a=[];if(t){if(t.attributes){var o=t.attributes;Object.keys(o).forEach(t=>{"publicAttributes"===t||"extensionAttributes"===t?o[t].forEach(t=>{let o=n.getValue(t,i[t.name]);if(!t.basicAttribute||e.includes(t.name)){var r={name:t.name};t.basicAttribute&&(r.basicAttribute=!0),UWA.is(o)&&(r.value=o,UWA.is(t.unitName)&&(r.unitName=t.unitName,r.dimensionType=t.dimensionType)),t.forUI&&(r.forUI=!0,null!=t.isReadOnly&&(r.isReadOnly=t.isReadOnly),null!=t.visible&&(r.visible=t.visible),null!=t.range&&(r.range=t.range),null!=t.blAccess&&(r.blAccess=t.blAccess),null!=t.notif&&(r.notif=t.notif)),a.push(r)}}):"internalAttributes"===t&&o[t].forEach(e=>{var t={name:e.name,value:e.value};e.value&&e.unitName&&(t.unitName=e.unitName,t.dimensionType=e.dimensionType),e.basicAttribute&&(t.basicAttribute=!0),a.push(t)})})}t.basicAttributes&&Object.keys(t.basicAttributes).forEach(e=>{var i=a.find(t=>t.name===e);if(!i){var n=t.basicAttributes[e];i={name:e,value:n,basicAttribute:!0},a.push(i)}})}return a},updateUIAttributeForBL:function(e,t){for(var i=!1,n=0;n<e.length;n++){var a=e[n];if(Object.hasOwn(t,a.name)){var o=this.getValue(a,t[a.name]);this.isSame(e[n].value,o)||(e[n].value=o,i=!0);break}}return i},setModifiedAttributes:function(e,t,i,n){var a=this,o={},r=e.attributes;if(n)for(var s=0;s<n.length;s++){var c=n[s];if(c){var l=!1,u=t.find(e=>e.name===c.name);if(u&&r&&Object.keys(r).forEach(e=>{var t=r[e].find(e=>e.name===c.name);if(t)if(l=!0,"publicAttributes"===e||"extensionAttributes"===e){var i=a.pullResultforUI(c,t,u);Object.keys(i).length>0&&(o[c.name]=i)}else"internalAttributes"===e&&a.putUpdatedValue(c,t,u)}),!l){var d={name:c.name,type:"string"};u||(u={name:c.name,type:"string"}),a.putUpdatedValue(c,d,u),UWA.is(u.value,"array")&&(d.multivalued=!0),c.basicAttribute&&(d.basicAttribute=!0),t.push(u),r.internalAttributes||(r.internalAttributes=[]),r.internalAttributes.push(d)}UWA.is(c.notif)&&(u.notif=c.notif)}}return{updateUIAttribute:o,notifs:[]}},pullResultforUI:function(e,t,i){var n={};if(UWA.is(e.range)&&!this.isSame(i.range,e.range)){var a=[],o=[];if(t.range&&t.rangeNLS&&t.range.length==t.rangeNLS.length)for(var r=0;r<e.range.length;r++){var s=e.range[r],c=t.range.findIndex(e=>e===s);c>-1?(a.push(t.range[c]),o.push(t.rangeNLS[c])):(a.push(s),o.push(s))}else o=a=e.range;i.range=a,n.authorizedValues=e.range,n.authorizedValuesNLS=e.rangeNLS}UWA.is(e.visible)&&(this.isSame(i.visible,e.visible)||(i.visible=e.visible,n.visible=e.visible)),UWA.is(e.isReadOnly)&&(this.isSame(i.isReadOnly,e.isReadOnly)||(i.isReadOnly=e.isReadOnly,n.readOnly=e.isReadOnly));var l=this.putUpdatedValue(e,t,i);return l&&(n.value=l.value),n},putUpdatedValue:function(e,t,i){if(UWA.is(e.value)&&!this.isSame(i.value,e.value))return t&&(t.range&&t.range.length>0&&!t.range.includes(e.value)||(t.value=e.value,t.modified=!0)),i.value=e.value,{value:e.value}},getValue:function(e,t){var i=null;if(t?(i=t.valueDB)||(i=t.value):(i=e.valueDB)||(i=e.value),UWA.is(i,"array")){for(var n=[],a=0;a<i.length;a++)n.push(String(i[a]));i=n}else i=String(i);return i},isSame:function(e,t){return typeof e==typeof t&&(UWA.is(e,"array")&&UWA.is(t,"array")?e.length==t.length&&!(e.filter((e,i)=>{if(t[i]!=e)return!0}).length>0):e==t)}}}),define("DS/ENONewWidget/validation/FileName",["UWA/Class"],function(e){"use strict";var t={name:"CATIAV5",require:"DS/ENOXCADCATIAV5UI/ENOXCADFileNameValidation"};return{validate:function(e,i){var n=e.value,a=t.require;console.log("require "+a),require([a],function(e){e.checkfilenameValidity(n,function(e){var t;null!=e&&(console.log("ENOXCADFileNameValidation : "+e),t={message:e,eventID:"warning"}),i(t)})})}}}),define("DS/ENONewWidget/utils/Utils",[],function(){"use strict";function e(){}return e.prototype={isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},forEach:function(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),this.isArray(e))for(var i=0,n=e.length;i<n;i++)t.call(null,e[i],i,e);else for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.call(null,e[a],a,e)}},new e}),define("DS/ENONewWidget/utils/ENONewAttributeUtil",["DS/EditPropWidget/models/EditPropAttributeModel","i18n!DS/ENONewWidget/assets/nls/ENONewWidgetNls"],function(e,t){"use strict";function i(e,t){if(e){console.log("vma save local pref : "+e);var i="ENONew";t&&(i+="_"+t),i+="_"+e;var n=localStorage.getItem(i);return console.log(i),n}}return{_buildAttributesModel:function(t,n,a){var o=[];if(UWA.is(t,"array"))for(var r in t){var s=t[r],c=s.name,l=s.nls,u=s.type,d=s.value,f=s.value,p=s.isReadOnly,h=s.visible,v=s.extension,m=s.range,g=s.authorizedValuesRequired,N=s.rangeNLS,w=s.rangeGroup,b=s.icons,E=s.forbiddenChar,y=s.dimension,C=s.unitName,S=s.dimensionType,O=s.maxlength,D=s.multiline,A=s.multivalued,I=s.positionUI,T=s.positionGroup,x=s.modified,F=s.mandatory,_=s.visibility,U=s.defaultAttribute,W=s.storeLocalPreference,L=s.validationService,B=s.sortedOptions,k=s.dropdownMode,M=s.applysort,P=s.forUI;if(h||P){u||(u="string");var V=u;if("string"===(u=u.toLowerCase()))V="text";else if("integer"===u)V="integer";else if("real"===u)V="real";else if("boolean"===u)V="boolean";else if("date"===u||"timestamp"===u){if(""!=d){d.contains("GMT")||(d=parseInt(d));var j=new Date(d);f=this._convertDateToStandard(j,!0).valueDB}V="timestamp"}var R=c;R=v?v+"-"+R:R,U&&(R="New-"+c);var z=new e({path:R,name:c,label:l,value:d,valueDB:f,type:V,readOnly:p});"3DPartTemplate"==c&&z.set("autocomplete",!0),("boolean"!==V||A&&"boolean"===V)&&m&&(m&&z.set("authorizedValues",m),N&&z.set("authorizedValuesNLS",N),w&&z.set("authorizedValuesGroup",w),b&&z.set("authorizedValuesIcon",b),g&&z.set("authorizedValuesRequired",g),z.set("customSelect",!0)),UWA.is(h,"boolean")&&z.set("visible",h),E&&z.set("forbiddenChar",E),B&&z.set("sortedOptions",B),L&&z.set("validationService",L),O>0&&z.set("maxlength",O),_&&z.set("visibility",_),D&&z.set("multiline",D),x&&z.set("modified",x),A&&z.set("multivalue",A),F&&z.set("mandatory",F),U&&z.set("defaultAttribute",U),k&&z.set("dropdownMode",k),M&&z.set("applySort",M),P&&z.set("forUIBL",P),F||z.set("facet","ExtensionsFacet");var q=2;U?q=6:a&&(q=9),T&&(q=T);var X=1;v&&(q="4."+v),I||0===I||(X=2,I=0,z.set("masked",!1));var H=q+"-"+X+"-"+I;if(z.set("positionUI",H),W){z.set("storeLocalPreference",W);var K=i(R,"attribute");K&&(m&&m.includes(K)||!m)&&K!=f&&(z.set("valueDB",K),z.set("isModified",!0))}null!=y&&(z.set("dimension",y),z.set("unitName",C),z.set("dimensionType",S))}null!=z&&o.push(z)}return o},_parseAttributeModels:function(e,t){if(t&&e){if(e.hasOwnProperty("value")&&e.value!==t.valueDB){var n=t.valueDB;"number_wux"!=t.tw_type&&"number"!=t.tw_type||!UWA.is(n,"number")||(n=""+n),e.value=n,e.modified=!0}if(e.storeLocalPreference)!function(e,t,n){if(e&&t){console.log("vma save local pref : "+e+" = "+t);var a="ENONew";n&&(a+="_"+n),a+="_"+e,console.log(a),localStorage.setItem(a,t),console.log(i(e,n))}}(t.getIdentifier(),t.valueDB,"attribute")}},_convertDateToStandard:function(e,t){if(!e)return{value:"",valueDB:""};var i=t?e:new Date,n=e.getUTCFullYear(),a=e.getUTCMonth()+1,o=e.getUTCDate(),r=i.getUTCHours(),s=i.getUTCMinutes(),c=i.getUTCSeconds();return a<10&&(a="0"+a),o<10&&(o="0"+o),r<10&&(r="0"+r),s<10&&(s="0"+s),c<10&&(c="0"+c),i.setYear(n),i.setMonth(e.getMonth()),i.setDate(o),{value:i.toLocaleString(widget.lang),valueDB:n+"/"+a+"/"+o+"@"+r+":"+s+":"+c+":GMT"}}}}),define("DS/ENONewWidget/ENONew/Events",["UWA/Class","UWA/Class/Events"],function(e,t){return e.singleton(t,{init(){this._parent(),console.log("ENONew Event init")},dispatchEvent(){this._parent.apply(this,arguments)},addEvent(){this._parent.apply(this,arguments)}})}),define("DS/ENONewWidget/ENONewWidget",[],function(){}),define("DS/ENONewWidget/command/NewContentAppOptions",["UWA/Class"],function(e){return e.singleton({setAppContext(e){e?(this.AppContext=e,this.isAppContextSet=!0):isAppContextSet=!1},getAppContext(){return this.AppContext},isAppContextSet:!1})}),define("DS/ENONewWidget/ENONew/Model/CreateOptions",["UWA/Class/Model"],function(e){return e.extend({defaults:{isNewContentCmd:!1,showSubtype:!0},init(e){this._parent.apply(this,arguments),console.log("ENONew Model init"),this.isNewContentCmd="ENONewContentHdr"===e.ID},setup(e){this._parent.apply(this,arguments),console.log("inside setup")},validate(e,t){e&&this.isNewContentCmd}})}),define("DS/ENONewWidget/command/sample/ENONewDummyCmdOptions",["DS/ENONewWidget/command/NewContentOptions"],function(e){return e.singleton({getCreateOptions:function(e){return this.launcherOptions||(this.launcherOptions={context:{service:"3DSpace"},silentMode:!1,notification:!0,options:{parentPIDs:e.parentPIDs,selectedIDs:[],domainAttributes:[{name:"DummyBookmark"}]}},this.events&&(this.launcherOptions.events=this.events)),this.launcherOptions}})}),define("DS/ENONewWidget/ENONew/ENONewEngine",["UWA/Core","UWA/Controls/Abstract","DS/WidgetServices/WidgetServices","DS/ENONewWidget/ENONew/Controller/ENONewController","DS/ENONewWidget/ENONew/Model/CreateOptions","DS/ENONewWidget/utils/ENONewConstants"],function(e,t,i,n,a,o){var r=["DummyBookmark","UsageDimension"];return t.extend({objInfo:{id:"",context:{header:{SecurityContext:""},tenant:"",service:"",serviceBaseUrl:""},labelTopBar:"",commandName:"",overlay:!0,type:"",silentMode:!1,responseFormat:0,notification:!0,activatelock:{show:!1,preference:""},activateDraftMode:{show:!1,preference:""},activateCreateAnother:!1,options:{preferedType:"",typeName:"",select:[],parentPIDs:[],selectedIDs:[],parentOrigin:[],folderID:[],activeFolder:!1,attributes:{},domainAttributes:[{name:"",value:[]}]},facets:[],viewType:"listView",events:{onSuccess:function(){},onFailure:function(){},onCancel:function(){}}},_getController:function(e,t){return this.controller?this.controller:new n(e,t)},init:function(e,t,n){if(console.log("ENONew Engine init"),t&&i.setWidgetObject(t),this._parent(e),e){this.context=e.context,this.objInfo.id=void 0!==e.id?e.id:"",this.objInfo.context=e.context?e.context:{},e.options||(e.options={}),this.objInfo.type=e.type,this.objInfo.silentMode=!0===e.silentMode,this.objInfo.responseFormat=e.responseFormat?e.responseFormat:0,this.objInfo.responseFormat&&(this.objInfo.parsed=!0),this.objInfo.labelTopBar=e.labelTopBar,this.objInfo.commandName=e.commandName,this.objInfo.overlay=0!=e.overlay,this.objInfo.notification=0!=e.notification,this.objInfo.activateCreateAnother=!0===e.activateCreateAnother,this.objInfo.facets=e.facets?e.facets:[],this.objInfo.viewType=e.viewType?e.viewType:o.DIALOG.LIST_VIEW,e.activatelock||(e.activatelock={}),this.objInfo.activatelock={show:1==e.activatelock.show,preference:e.activatelock.preference},e.activateDraftMode||(e.activateDraftMode={}),this.objInfo.activateDraftMode={show:1==e.activateDraftMode.show,preference:e.activateDraftMode.preference};var s=this.objInfo.options;for(var c in s){if(c===o.DOMAIN_ATTRIBUTES){var l=e.options[c],u=[];l&&(l.forEach(function(e){if(e&&e.name&&r.includes(e.name)){var t={name:e.name};e.value&&(t.value=e.value),u.push(t)}}),e.options[c]=u)}s[c]=e.options[c]}this.objInfo.type||(this.objInfo.type=s.typeName);var d=this.objInfo.events;if(e.events)for(var f in d)d[f]=e.events[f];var p=n instanceof a&&n.isValid()?n:void 0;this.controller=this._getController(this.objInfo,p)}}})}),define("DS/ENONewWidget/ENONew/View/Facet/ENONewFacetHelper",["DS/ENONewWidget/utils/ENONewFacetConstants","i18n!DS/ENONewWidget/assets/nls/ENONewWidgetNls","i18n!DS/ENONewWidget/assets/nls/ENONewFacetNls"],function(e,t,i){var n={facetObject:{require:"",alwaysCalled:!0,facet:{name:"",text:"",icon:""},options:{data:{}}},getFacetDefinition:function(t){return(n={},n[e.ENONewFACET_CLASSIFICATION]={require:"DS/ClassificationsFacet/PLMNewClassificationFacet",alwaysCalled:!0,facet:{name:e.ENONewFACET_CLASSIFICATION,text:i.get(e.ENONewFACET_CLASSIFICATION),icon:"classification-book"},dependee:[]},n[e.ENONewFACET_REVISION]={require:"DS/CfgWebAppXRevisionCommands/facets/PLMNewRevisionFacet",alwaysCalled:!1,facet:{name:e.ENONewFACET_REVISION,text:i.get(e.ENONewFACET_REVISION),icon:"flow-branch-list"},dependee:[]},n[e.ENONewFACET_RELEASE_SNAPSHOT_TEMPLATE]={require:"DS/XSRCommonComponents/facets/template/ReleaseSnapshotFacet",alwaysCalled:!1,facet:{name:e.ENONewFACET_RELEASE_SNAPSHOT_TEMPLATE,text:i.get(e.ENONewFACET_RELEASE_SNAPSHOT_TEMPLATE),icon:"picture"},dependee:[]},n[e.ENONewFACET_MATERIAL]={require:"DS/XSRCommonComponents/facets/material/Materialfacet",alwaysCalled:!1,facet:{name:e.ENONewFACET_MATERIAL,text:i.get(e.ENONewFACET_MATERIAL),icon:"material"},dependee:[]},n[e.ENONewFACET_Files]={require:"DS/DocumentCreateNew/PLMNewFilesTab/PLMNewFilesTab",alwaysCalled:!0,facet:{name:e.ENONewFACET_Files,text:i.get(e.ENONewFACET_Files),icon:"docs"},dependee:[]},n)[t];var n},getFacetList:function(e,t,i){var a=[],o=this.getDefaultFacet();return o.options.data=e,i.buttons&&(o.options.buttons=i.buttons),a.push(o),t&&t.forEach(function(e){var t=n.getFacetDefinition(e.name);t&&(t.options=null!=e.facetoptions?e.facetoptions:{},i.securityContext&&(t.options.securityContext=i.securityContext),a.push(t))}),a},getDefaultFacet:function(){return{require:"DS/ENONewWidget/ENONew/View/Facet/ENOListViewFacet",facet:{name:this.getDefaultFacetName(),text:i.get("defaultFacetCreate"),icon:"attributes"},options:{}}},getDefaultFacetName:function(){return"ENOCreate"}};return n}),define("DS/ENONewWidget/ENONewLauncher",["UWA/Controls/Abstract","DS/ENONewWidget/ajaxRequests/LifecycleServicesSettings"],function(e,t){return t.service_initialization(function(){}),e.extend({CreateNew:function(e,t){e&&require(["DS/ENONewWidget/ENONew/ENONewEngine"],function(i){new i(e,void 0,t)})}})}),define("DS/ENONewWidget/command/NewContentCommandBase",["DS/ApplicationFrame/Command","DS/ENONewWidget/ENONewLauncher","DS/ENONewWidget/command/NewContentAppOptions","DS/ENONewWidget/ENONew/Model/CreateOptions","i18n!DS/ENONewWidget/assets/nls/ENONewWidgetNls"],function(e,t,i,n,a){"use strict";return e.extend({init:function(e){if(this._parent(e),i.isAppContextSet)this.ENONewContext=i.getAppContext(),console.log("NewContentCommandBase init NewContentAppOptions : "+e.ID+" "+e.className);else if(e.context){var a=e.context.getENONewContext;UWA.is(a,"function")&&(this.ENONewContext=e.context.getENONewContext(),console.log("NewContentCommandBase init options.context : "+e.ID+" "+e.className))}this.launcher=new t,this.createOptModel=new n(e)},launchCreateNew(e){this.launcher&&this.launcher.CreateNew(e,this.createOptModel)},execute(){var e=this.getCreateOptions({newType:this.getType()});this.launchCreateNew(e)},getCreateOptions(e){var t,i,n=this.ENONewContext;if(n&&n.getCreateOptions&&UWA.is(n.getCreateOptions,"function")&&(i=n.getCreateOptions(e)),this.getOptions&&UWA.is(this.getOptions,"function")&&(t=this.getOptions(e)),t){if(i)for(var a in i){var o=i[a];if("events"===a)t[a]||(t[a]={}),Object.assign(t[a],o);else if(null!=o||null!=o)if(UWA.is(o,"object")&&"options"===a)if(t[a])for(var r in o){var s=o[r];s&&(t[a][r]=s)}else t[a]=o;else t[a]=o}}else i&&(t=i);return this.getType&&UWA.is(this.getType,"function")&&(t||(t={}),t.options||(t.options={}),t.options.typeName=this.getType()),t},getCommandLabel:()=>a.get("new")})}),define("DS/ENONewWidget/command/sample/ENONewDummyCmd",["DS/ENONewWidget/command/NewContentCommandBase"],function(e){"use strict";return e.extend({defaults:{type:"VMADocument"},getType(){return this.defaults.type}})}),define("DS/ENONewWidget/command/sample/ENONewMockDocumentCmd",["DS/ENONewWidget/command/NewContentCommandBase"],function(e){"use strict";return e.extend({defaults:{type:"MockDocument"},getType(){return this.defaults.type}})}),define("DS/ENONewWidget/ajaxRequests/WebReq",["UWA/Class","DS/WAFData/WAFData","DS/ENONewWidget/utils/Utils","DS/ENONewWidget/ajaxRequests/LifecycleServicesSettings"],function(e,t,i,n){var a=e.singleton({defaults:{type:"json",timeout:6e4},init:function(){["delete","get","head","options"].forEach(function(e){this[e]=function(t,i){return this.request(UWA.merge(i||{},{url:t,method:e}))}},this),["post","put","patch"].forEach(function(e){this[e]=function(t,i,n){let a={...n||{}};return this.request(UWA.merge(a,{url:t,method:e,data:i}))}},this)},request:function(e){return"string"==typeof e?e={url:arguments[0]}:(e=e||{}).data&&"string"!=typeof e.data&&(e.data=JSON.stringify(e.data)),UWA.Utils.parseUrl(e.url).protocol||(e.url=n.get3DSpaceWSUrl(e.tenant,e.url,null)),(e=UWA.merge(e,this.defaults)).method=e.method?e.method.toLowerCase():"get",e.headers=e.headers||n.getHeaders(e.securityContext),e.securityContext||delete e.headers.SecurityContext,this._dispatchPromise(e)},_dispatchPromise:function(e){var i=this;return new UWA.Promise(function(n,a){t.authenticatedRequest(i._createURL(e),{method:e.method,headers:e.headers,timeout:e.timeout,data:e.data,type:e.type,onComplete:function(e){n(e)},onFailure:function(e,t,n){a({error:e,response:t,headers:n,errorMessage:i._parseError(e,t)})},onTimeout:function(){a({isTimeout:!0})}})})},onWebServiceError:function(e,t,i,n,a){UWA.is(t,"string")&&t.startsWith("NetworkError:")&&e({result:[{errors:[{errorCode:"NetworkError"}]}]})},_parseError:function(e,t){if(t&&t.error)return JSON.stringify(t.error)},_createURL:function(e){var t=e.url;return i.forEach(e.params,function(e,i){t+=(-1===t.indexOf("?")?"?":"&")+i+"="+e}),t}});return a.init(),a}),define("DS/ENONewWidget/ENONew/View/ENOListView",["UWA/Core","UWA/Controls/Abstract","DS/EditPropWidget/facets/Properties/Properties","DS/EditPropWidget/models/EditPropAttributeModel","DS/EditPropWidget/models/EditPropModel","DS/EditPropWidget/utils/AttributesUtils","DS/ENONewWidget/utils/ENONewAttributeUtil","DS/ENONewWidget/utils/ENONewClientBLUtil","DS/ENONewWidget/utils/ENONewConstants","i18n!DS/ENONewWidget/assets/nls/ENONewWidgetNls","css!DS/ENONewWidget/ENONewWidget.css"],function(e,t,i,n,a,o,r,s,c,l){return t.extend({init:function(t){this.customEvents=[],this.floatingAttributes={},this.attributesForValidationService=[],this.persistAttribute={},this.enableNotif=!1,this.identifier=t.identifier,this.skeleton=e.createElement("div",{class:"Attributes_container","data-rec-id":"Attributes_container_rec-id",styles:{width:"100%",height:"100%",display:"flex","flex-direction":"column"}});var n=t.events;for(eventID in n){var a=n[eventID];this.addEvent(eventID,a)}this.onComplete=t.onComplete,this.buttons=t.buttons;var o=new i({setCloseButton:!1,editMode:!0,readOnly:!1,scroller:!1,identifier:this.identifier,webUxTweakers:!0,events:{onCancel:function(){},onNotification:function(e){}}}).inject(this.skeleton);this.propUI=o;o.setAccordionProperties({ExtensionsFacet:{name:"ExtensionsFacet",nameNLS:"Extensions",weight:-10}})},buildModel:function(e){this.data=e,this.propModel=new a;var t=this._buildAttributesModel(e);this.setPropModel(t),this.UIAttributesforBL=null},setPropModel:function(e){var t,i=this,a=this.propModel;if(e){for(var o in this.customEvents){var r=this.customEvents[o];a.addEvent(r.eventID,r.callback.bind(r))}t=a.set(e)}if(a.addEvent("onEnterKeyDown",function(e){i.dispatchEvent("onEnterKeyDown",[e])}),this.data.isUXBLDeployed&&a.addEvent("validateValue",function(e){if(console.log(e),e.forUIBL){var t={},n={name:e.name,value:e.value,valueDB:e.valueDB};t[e.get("name")]=n,i.persistAttribute[e.getIdentifier()]=n,i.runClientBL(a,t)}}),t){a.addEvent("onChange",function(e){console.log("ENONew onChange");var t=e._changed;for(var i in console.log(t),t){var n=t[i];n.isModified||(n.isModified=!0),n.isUIModified=!0}}),a.addEvent("onChange:New-Type",function(){console.log("ENONew Type Changed"),i.dispatchEvent("onChangeAttribute",[this._changed])}),a.addEvent("onChange:New-SecurityContext",function(){console.log("ENONew SecurityContext Changed"),i.dispatchEvent("onChangeAttribute",[this._changed])}),a.get("3DPartTemplate")&&a.addEvent("onChange:3DPartTemplate",function(e,t){console.log("ENONew 3DPartTemplate Changed"),i.dispatchEvent("onChangeAttribute",[this._changed])});var s=a.get("ExtensionsFacet-Filename")?"ExtensionsFacet-Filename":!!a.get("Filename")&&"Filename";if(s){var c=a.get("PLMEntity.V_Name")?"PLMEntity.V_Name":!!a.get("ExtensionsFacet-PLMEntity.V_Name")&&"ExtensionsFacet-PLMEntity.V_Name";c||(c=a.get("V_Name")?"V_Name":!!a.get("ExtensionsFacet-V_Name")&&"ExtensionsFacet-V_Name");var l=!1;a.addEvent("onChange:"+c,function(){if(!l){var e=a.get(s),t=a.get(c);if(e&&e.visible){var i=new n(e);i.set("value",t.get("value")),i.set("valueDB",t.get("valueDB")),a.set(i.getIdentifier(),i),l=!1}}}),a.addEvent("onChange:"+s,function(){l=!0})}}return t},loadView:function(e){this.propUI.initData([this.propModel]),this.propModel.clearChangedValue(),this._resizeHandler(),this.manageAccordion(this.propUI),this.enableNotif=!0,this.focusFirstLine(),this.showUXnotifs()},refresh:function(){this.enableNotif=!1,this.propUI.addData([this.propModel]),this.manageAccordion(this.propUI),this.enableNotif=!0},focusFirstLine:function(){var e=this;setTimeout(function(){var t=e.propUI.elements.formSection.elements.accordion.items[0].name;e.propUI.elements.formSection.elements._organizers[t].focusLine(0,0)})},runClientBL:function(t,i){var n=this;return this.existingClientBL||(this.existingClientBL=new e.Promise(function(e){var a=!1;if(i){var o=!1;n.UIAttributesforBL?o=s.updateUIAttributeForBL(n.UIAttributesforBL,i):(n.UIAttributesforBL=s.getUIAttributesForBL(n.data,i),o=!0),o?(console.log("client BL triggered"),n.dispatchEvent("runBLForUI",[{attribute:n.UIAttributesforBL,interfaces:n.data.interfaces},function(i){if(i.result){var o=s.setModifiedAttributes(n.data,n.UIAttributesforBL,t,i.result);Object.keys(o.updateUIAttribute).length>0&&(console.log("update ui postUXBL",o.updateUIAttribute),n.propUI.updateFormSection(o.updateUIAttribute))}n.UIAttributesforBL.forEach(e=>{if(e.notif&&e.notif.sev&&e.notif.msg&&t){1==e.notif.sev&&(a=!0);var i=t.getAttributeFromField("name",e.name)[0].label+": "+e.notif.msg;n._showUXnotifs(e.notif.sev,i,e.name)}}),n.existingClientBL=null,e(a)}])):setTimeout(function(){n.existingClientBL=null,e()})}else setTimeout(function(){n.UIAttributesforBL&&n.UIAttributesforBL.forEach(e=>{if(e.notif&&1==e.notif.sev&&e.notif.msg&&t){a=!0;var i=t.getAttributeFromField("name",e.name)[0].label+": "+e.notif.msg;n._showUXnotifs(e.notif.sev,i,e.name)}}),n.existingClientBL=null,e(a)})})),this.existingClientBL},showUXnotifs:function(){var e=this,t=e.data.attributes;Object.keys(t).forEach(i=>{var n=t[i];Object.keys(n).forEach(t=>{var i=n[t];if(i.notif&&i.notif.msg&&i.notif.sev){var a=i.nls+": "+i.notif.msg;e._showUXnotifs(i.notif.sev,a,i.name)}})})},_showUXnotifs:function(e,t,i){var n;1==e?n="error":2==e?n="warning":3==e&&(n="info"),this._addNotif({eventID:n,msg:t,id:i})},updateResizeHandler:function(){var e=this.propUI.elements.formSection.elements.accordion.items[0];e&&this.propUI.elements.formSection.elements._organizers[e.name]._forms[0].dispatchEvent("resetDisplay1")},manageAccordion:function(e){var t=e.elements.formSection.elements.accordion;if(t){var i;t._expanderItems[0]&&t._expanderItems[0].elements.header.hide();t._expanderItems[1]&&(i=t._expanderItems[1]),i&&(!0===i.expandedFlag?i.header=l.collapseExtension:i.header=l.expandExtension,t.getContent().addEventListener("expand",function(e){if("ExtensionsFacet"===e.options.expanderTarget.domId){var t=l.collapseExtension;e.dsModel._expanderItems[e.options.expanderIndex].header=t}}),t.getContent().addEventListener("collapse",function(e){if("ExtensionsFacet"===e.options.expanderTarget.domId){var t=l.expandExtension;e.dsModel._expanderItems[e.options.expanderIndex].header=t}}))}},destroy:function(){console.log("ENONew destroy")},_addNotif:function(e){console.log(e),this.enableNotif&&this.dispatchEvent("onFacetNotification",[e])},onSubmit:function(t){var i=this;this.runClientBL(i.propModel).then(function(n){if(n)t(!1);else{var a=function(n){!0===e.is(n,"array")&&n.forEach(function(e){i._addNotif({customClass:e.customClass,eventID:e.eventID,msg:e.message})}),t(!1)},r=[];i.propModel.getAttributeFromField().forEach(function(e){e.visible&&r.push(e)}),i.propModel.lockModel(!0);var s=o.validateAttributes(i.propModel,r);s?a(s):i.validationFromService(function(){var e=i._parseModel(i.data,i.propModel);t(e)},a)}})},validationFromService:function(t,i){var n=this.attributesForValidationService,a=[];for(var o in n){var r=n[o],s=this.propModel.get(r);if(s&&s.visible){var c=new e.Promise(function(e,t){var i=s.validationService,n={name:s.name,value:s.valueDB};require([i],function(t){t.validate(n,function(t){e(t)})})});a.push(c)}}e.Promise.all(a).then(function(e){console.log(e);var n=[];for(var a in e){var o=e[a];o&&n.push(o)}0==n.length?t():i(n)}).catch(function(e){console.log("vma validation service failed, proceeding for object creation"),t()})},_buildAttributesModel:function(e){var t=this,i={},n=[],a=e.defaultAttributes,o=[];for(var s in a){var l=a[s];o.push(l)}if(o.length>0){var u=r._buildAttributesModel(o);n=n.concat(u)}var d=e[c.ATTRIBUTES],f=e[c.INTERFACES];if(d){var p=d[c.PUBLIC_ATTRIBUTES];if(p){u=r._buildAttributesModel(p,f);n=n.concat(u)}var h=d[c.EXTN_ATTRIBUTES];if(h){u=r._buildAttributesModel(h,f);n=n.concat(u)}var v=d[c.VOLATILE_ATTRIBUTES];if(v){u=r._buildAttributesModel(v,f,!0);n=n.concat(u)}for(var m in n){var g=n[m];if(this.persistAttribute[g.getIdentifier()]){var N=this.persistAttribute[g.getIdentifier()];g.set("value",N.value),g.set("valueDB",N.valueDB),g.set("isModified",!0)}var w=g.visibility;if(w)for(var s in w){var b={attrID:g.getIdentifier(),list:w[s],eventID:"onChange:"+s,callback:function(e,i){var n=this;console.log("onchange "+i.valueDB);var a=i.valueDB,o=!1;n.list.includes(a)&&(o=!0),setTimeout(function(){t.addAttributeOnUI(n.attrID,o)},0)}};this.customEvents.push(b)}i[g.getIdentifier()]=g,g.validationService&&this.attributesForValidationService.push(g.getIdentifier())}}return i},addAttributeOnUI:function(e,t){var i=this.propModel;if(i&&i.get(e)&&(i.get(e).visible=t,this.propUI.elements.formSection.toggleFormOrgLine(e,t),"3DPartTemplate"===e)){var n=this.buttons.Close;n&&(n.visibleFlag=t)}},_parseModel:function(e,t){if(t&&e){var i={},n=t.getAttributeFromField(),a=e.attributes,o=e.defaultAttributes;for(attrId in n)if(attrModel=n[attrId],attrModel.isModified){var s=attrModel.name,c=null,l=!1;if(attrModel.defaultAttribute)for(var u in o)(c=o[u]).name===s&&r._parseAttributeModels(c,attrModel);else if(a){var d=function(e,t){for(ind in t)if((c=t[ind]).name===e&&(l=!0),l)break};for(AttrGrp in a){if(d(s,a[AttrGrp]),l)break;c=null}null!=c&&r._parseAttributeModels(c,attrModel)}if(attrModel.isUIModified){var f={name:attrModel.name,value:attrModel.value,valueDB:attrModel.valueDB};this.persistAttribute[attrModel.getIdentifier()]=f}}i.attributes=a,i.defaultAttributes=o;var p=e.interfaces;return p&&(i.interfaces=p),i}},getUI:function(){return this.propUI},getContentSize:function(){var e=this.propUI.getContent();if(e)return e.getSize()},_resizeHandler:function(){var e=this;this.propUI.elements.formSection.elements.container.addEvent("resize",function(){e.isLoaded=!0,e.updateResizeHandler();var t=e.getContentSize();e.dispatchEvent("onResize",[t])})}})}),define("DS/ENONewWidget/ENONew/View/Facet/ENOListViewFacet",["UWA/Core","DS/UIKIT/Scroller","DS/ENONewWidget/ENONew/View/Facet/ENONewFacetBase","DS/ENONewWidget/ENONew/View/ENOListView","DS/ENONewWidget/ENONew/View/Facet/ENONewFacetHelper"],function(e,t,i,n,a){return i.extend({init:function(t){var i=this;this._parent(t),console.log("vma12 : Create facet init"),this.skeleton=e.createElement("div",{class:"CreateFacet_container"});var a=t.events.onResize;t.events.onResize=function(e){a("ENOCreate",e)};var o=t.events.onChangeAttribute;t.events.onChangeAttribute=(e=>{for(var t in e)if("New-SecurityContext"===t){var n=e[t];i.publishInfo("currentSecurityContext",{value:n.valueDB,valueNLS:n.value})}else if("New-Type"===t){n=e[t];i.publishInfo("currentObjectType",{value:n.valueDB})}o(e)}),setTimeout(function(){if(i.publishInfo("tenant",t.tenant),i.publishInfo("service",t.service),t.data&&t.data.defaultAttributes&&(t.data.defaultAttributes.Type&&i.publishInfo("currentObjectType",{value:t.data.defaultAttributes.Type.value}),t.data.defaultAttributes.SecurityContext)){var e=t.data.defaultAttributes.SecurityContext.value,n=e,a=-1;t.data.defaultAttributes.SecurityContext.range&&(a=t.data.defaultAttributes.SecurityContext.range.indexOf(e)),a>-1&&t.data.defaultAttributes.SecurityContext.rangeNLS&&(n=t.data.defaultAttributes.SecurityContext.rangeNLS[a]),i.publishInfo("currentSecurityContext",{value:e,valueNLS:n})}}),this.listview=new n(t),this.listview.propUI.inject(this.skeleton),this.listview.buildModel(t.data),this.listview.loadView()},updateFacet:function(e){var t=this;setTimeout(function(){if(e.data&&e.data.defaultAttributes&&(e.data.defaultAttributes.Type&&t.publishInfo("currentObjectType",{value:e.data.defaultAttributes.Type.value}),e.data.defaultAttributes.SecurityContext)){var i=e.data.defaultAttributes.SecurityContext.value,n=i,a=-1;e.data.defaultAttributes.SecurityContext.range&&(a=e.data.defaultAttributes.SecurityContext.range.indexOf(i)),a>-1&&e.data.defaultAttributes.SecurityContext.rangeNLS&&(n=e.data.defaultAttributes.SecurityContext.rangeNLS[a]),t.publishInfo("currentSecurityContext",{value:i,valueNLS:n})}}),this.listview.buildModel(e.data),this.listview.loadView()},_getUI:function(){return this.skeleton},getUI:function(){return this.skeleton},onSubmit:function(e,t){this.listview.onSubmit(t)},onComplete:function(t){return new e.Promise(function(e){e({name:a.getDefaultFacetName()})})},destroy:function(){this.listview.destroy(),this._parent()}})}),define("DS/ENONewWidget/ENONew/View/ENOWizardView",["UWA/Class/Events","UWA/Class/Promise","UWA/Controls/Abstract","UWA/Core","DS/EditPropWidget/models/OccurrenceModel","DS/ENONewWidget/ENONew/View/Facet/ENONewFacetHelper"],function(e,t,i,n,a,o){return i.extend(e,{name:"DS/ENONewWidget/ENONew/View/facet/wizardView",isLoaded:null,init:function(e){var t=this;for(var i in this.options=e,t._parent(e),t.navigator={container:null,toggler:null},t.content={container:null},t.activeView="",t.activeMode="multi-step",this._sharedOptions={},this.facets=e.facets,e.events)this.addEvent(i,e.events[i]);var r=new a;this.setContext(r),r.addInfo=function(e,t,i){},r.getInfo=function(e,t){},r.subscribeInfo=function(e,t){var i=t===o.getDefaultFacetName()?"":t||"";r.addEvent("publishinfo."+i,e)},r.setValidation=function(){t.dispatchEvent("refreshValidationStatus")},t.setupDefaultFacet(),t.addEvent("onTabChange",e.events.onTabChange),this.skeleton=n.createElement("div",{class:"create-view-body multi-step",styles:{width:"100%",height:"100%"}})},setupDefaultFacet:function(){var e=this,t=this._getFacetFromName(o.getDefaultFacetName());t.options.events={};var i=!0;t.options.events.onResize=function(t){if(i){i=!1;var n=e.navigator.container.getSize(),a={height:t.height+n.height+8,width:n.width};e.dispatchEvent("onResize",[a]),e.setRopeLength(e.activeView)}e.isLoaded=!0},t.options.events.onChangeAttribute=function(t){e.dispatchEvent("onChangeAttribute",[t])},t.options.events.onEnterKeyDown=function(){e.dispatchEvent("onEnterKeyDown")},t.options.events.onFacetNotification=function(t){e.dispatchEvent("onFacetNotification",[t])}},loadView:function(e){var t=this;t.navigator.container=n.createElement("nav",{class:"create-view-navigator-container"}).inject(t.skeleton),n.createElement("div",{class:"evolve-container",html:[n.createElement("div",{class:"evolve-rope-placeholder"}),n.createElement("div",{class:"evolve-rope"})]}).inject(t.navigator.container);var i=n.createElement("nav",{class:"create-view-navigator"}).inject(t.navigator.container);t.facets.forEach(function(e){if(e.facet){var n=t._tabItem(e.facet);e.navItem=n,n.container.inject(i)}}),t.content.container=n.createElement("div",{class:"create-view-content"}).inject(t.skeleton),t.facetContainer=n.createElement("div",{class:"wizardFacetContainer",styles:{width:"100%",height:"100%"}}).inject(t.content.container),t.addEvent("facetLoaded",t=>{t&&o.getDefaultFacetName()===t.facet.name&&e()}),t.switchView(o.getDefaultFacetName())},getContext:function(){return this._sharedContext},setContext:function(e){this._sharedContext=e},refreshView:function(){this.switchView(o.getDefaultFacetName())},_tabItem:function(e){var t=this,i={};return i.container=n.createElement("a",{id:e.name,class:"nav-item"}),i.container.addEventListener("dragover",function(){t.switchView(e.name)}),i.activeIndicator=n.createElement("div",{class:"nav-item-active-indicator"}).inject(i.container),n.createElement("span",{class:"fonticon fonticon-expand-down"}).inject(i.activeIndicator),i.circle=n.createElement("div",{class:"nav-item-circle"}).inject(i.container),n.createElement("span",{class:"fonticon fonticon-"+e.icon}).inject(i.circle),i.label=n.createElement("div",{class:"nav-item-label",html:e.text}).inject(i.container),i},switchView:function(e){var t=this,i=this.activeView;if(t.navigator&&t.navigator.container&&e){var n=t.navigator.container.getElements("a"),a=!1;n.forEach(function(n){!1===a?n.removeClassName("filled").addClassName("filled"):n.removeClassName("filled"),n.id===i&&n.removeClassName("active"),n.id===e&&(n.addClassName("active"),t.setRopeLength(e),a=!0)})}var o=this._getFacetFromName(i);o&&o.content&&o.content.hide();var r=this._getFacetFromName(e);r&&r.content?r.content.show():t._loadFacet(r,!0,function(){r.content&&r.content.setContext(this._sharedContext),console.log("Done loading facet")}),t.activeView=e,t.dispatchEvent("onTabChange",[r])},setRopeLength:function(e){if(e){var t=this._getFacetFromName(e).navItem.circle;if(t){var i=t.getDimensions().outerWidth,n=(t.getPosition().x-10+i)/this.navigator.container.getSize().width*100;this.navigator.container.getElement(".evolve-rope").setStyles({width:n+"%",height:"2px"})}}},loadFacet:function(e,t,i){this._loadFacet(e,t,i)},_loadFacet:function(e,t,i){var n=this;if(e&&"loading"!==e.content)if(e.content)i.call(n);else{e.content="loading";var a=++window.top.perfoIncrem;window.top.performance.mark("start_prereqFacet:"+a),require([e.require],function(o){window.top.performance.mark("end_prereqFacet:"+a),e.content=null;var r=n.activeView,s=e.facet.name===r;if(!t||s){var c=e.options?e.options:{},l=c.events?c.events:{};c.events=l,e.options=c,e.options.tabId=e.facet.name,e.options.eventThread=n.options.eventThread+"."+e.facet.name,e.content=new o(e.options,n._sharedOptions);var u=e.content.getUI(),d="function"==typeof u.addClassName?u:u.container?u.container:u.elements?u.elements.container:null;d&&d.addClassName("ENONew_wizard_Container ENONew_wizard_"+e.facet.name),e.content.getUI().inject(n.facetContainer),s||e.content.hide(),n.dispatchEvent("facetLoaded",e),i.call(n)}})}},_getFacetFromName:function(e){return this.facets.find(t=>t.facet.name===e)},_getFacetIndexFromName:function(e){return this.facets.findIndex(t=>t.facet.name===e)},getActiveFacet:function(){return this._getFacetFromName(this.activeView)},isFirstFacet:function(e){return 0===this._getFacetIndexFromName(e)},isLastFacet:function(e){return this._getFacetIndexFromName(e)===this.facets.length-1},switchToRelativeFacet:function(e){var t=this.activeView,i=this._getFacetIndexFromName(t),n=this.facets[i+e];this.switchView(n.facet.name)}})}),define("DS/ENONewWidget/ENONew/View/ENOTabView",["UWA/Core","UWA/Controls/Abstract","DS/EditPropWidget/constants/EditPropConstants","DS/EditPropWidget/UI/IDCardSkeleton","DS/EditPropWidget/models/OccurrenceModel","DS/ENONewWidget/ENONew/View/Facet/ENONewFacetHelper"],function(e,t,i,n,a,o){return t.extend({init:function(t){this.opts=t,this._parent(t),this.sharedInfo={},this.skeleton=e.createElement("div",{class:"ENONewTab_container",styles:{width:"100%",height:"100%"}}),this.facets=t.facets,this.setupDefaultFacet()},setupDefaultFacet:function(){var e=this,t=this._getFacetFromName(o.getDefaultFacetName());t.options.events={};t.options.events.onResize=function(t,i){if(o.getDefaultFacetName()===t&&e.idCardSkeleton.currentFacetName===t){var n={height:e.idCardSkeleton.elements.container.getSize().height,width:i.width};e.dispatchEvent("onResize",[n]),e.isLoaded=!0}},t.options.events.onChangeAttribute=function(t){e.dispatchEvent("onChangeAttribute",[t])},t.options.events.onEnterKeyDown=function(){e.dispatchEvent("onEnterKeyDown")},t.options.events.onFacetNotification=function(t){e.dispatchEvent("onFacetNotification",[t])},t.options.events.runBLForUI=function(){e.dispatchEvent("runBLForUI",arguments)}},_getFacetFromName:function(e){return this.facets.find(t=>t.facet.name===e)},buildModel:function(e){console.log(e)},loadView:function(e){var t=this,r={name:"ENONew tab_content",className:"ENONew_TabView_MasterContain",typeOfDisplay:i.ONLY_EDIT_PROPERTIES,selectionType:i.NO_SELECTION,readOnly:!1,extraNotif:!1,showIdCard:!1,closeButton:!1,showTopBar:!1};r.sharedContext=new a,r.sharedContext.addInfo=function(e,i,n){if(e&&i){t.sharedInfo[e]||(t.sharedInfo[e]={}),t.sharedInfo[e][i]=n;var a=e===o.getDefaultFacetName()?"":e;r.sharedContext.dispatchEvent("publishinfo."+a,[i,n])}},r.sharedContext.getInfo=function(e,i){if(e)return i||(i=o.getDefaultFacetName()),t.sharedInfo[i][e]},r.sharedContext.subscribeInfo=function(e,t){var i=t===o.getDefaultFacetName()?"":t||"";r.sharedContext.addEvent("publishinfo."+i,e)},r.sharedContext.setValidation=function(){t.dispatchEvent("refreshValidationStatus")},this.idCardSkeleton=new n(this.facets,r),this.idCardSkeleton.elements.container.inject(this.skeleton),this.idCardSkeleton.subscribeEvt("facetLoaded",t=>{t&&o.getDefaultFacetName()===t.facet.name&&e()}),this.idCardSkeleton._manageFacetVisibility(),this.idCardSkeleton.elements.tabs.addEventListener("tabButtonClick",function(e){var i=e.options.value,n=t._getFacetFromName(i);t.dispatchEvent("onTabChange",[n])})},loadFacet:function(e,t,i){this.idCardSkeleton._loadFacet(e,t,i)},refreshView:function(){this.idCardSkeleton.selectFacet(o.getDefaultFacetName())},getUI:function(){return this._getUI()},_getUI:function(){return this.skeleton}})}),define("DS/ENONewWidget/ENONew/Controller/ENONewDialogController",["UWA/Controls/Abstract","DS/Windows/ImmersiveFrame","DS/Controls/ComboBox","DS/Controls/Button","DS/Windows/Dialog","DS/Controls/ModalLoader","DS/ENONewWidget/ENONew/Events","DS/ENONewWidget/ENONew/View/ENOListView","DS/ENONewWidget/ENONew/View/ENOTabView","DS/ENONewWidget/ENONew/View/ENOWizardView","DS/ENONewWidget/ENONew/View/Facet/ENONewFacetHelper","i18n!DS/ENONewWidget/assets/nls/ENONewWidgetNls"],function(e,t,i,n,a,o,r,s,c,l,u,d){return e.extend({init:function(e){this._parent(e),this.immersiveFrame=new t({}),this.immersiveFrame.inject(widget.body),this.userPrefs={},this.footerButtons={}},setup:function(e,t,i,n,a){var o=this;for(eventID in o.dialogContainer=UWA.createElement("div",{class:"ENONewInfra DialogContainer"}),o.elements.dialogContainer=o.dialogContainer,n=n||{}){var r=n[eventID];this.addEvent(eventID,r)}if(o.ServiceCallback=a,this.viewType="listView",t){o.prefs=e.prefs,t.facets&&t.facets.length&&t.viewType&&(this.viewType=t.viewType,this.facets=u.getFacetList(e,t.facets,{securityContext:t.securityContext,buttons:o.footerButtons})),this.identifier=t.persistId?t.persistId:"ENONew_Id";var s=o.getDefaultButtons(this.viewType,t);s&&Object.assign(o.footerButtons,s),i&&Object.assign(o.footerButtons,i);var c=o.buildContent(e,t),l=o.buildToolbar(t,e.prefs);UWA.Promise.all([l,c]).then(function(e){var i=UWA.createElement("div",{class:"ENONewInfra ToolbarContainer"});i.inject(o.dialogContainer),o.elements.toolbarContainer=i,o.toolbar=e[0],o.toolbar&&o.toolbar.inject(i);var n=UWA.createElement("div",{class:"ENONewInfra ContentContainer"});n.inject(o.dialogContainer),o.elements.contentContainer=n,e[1].skeleton.inject(n);var a={identifier:o.identifier,title:t.title?t.title:d.CreateNew,modalFlag:t.overlay,content:o.dialogContainer,width:580,position:{my:"top",at:"top",offsetY:90,collision:"fit"},checkboxInfos:{label:d.get("repeatCheckbox"),checkFlag:t.activateCreateAnother,tooltipInfos:{shortHelp:d.get("repeatToolTip")}},buttons:o.footerButtons,escapeButton:o.footerButtons.Discard};o.myDialog=o.buildDialog(a),o.manageButtons(),t.activateDraftMode&&t.activateDraftMode.show&&(o.footerButtons.createBtnCombo=o.buildDraftModeButton({preference:t.activateDraftMode.preference,optionsList:o.prefs?o.prefs.createBtn:[]}),o.footerButtons.createBtnCombo&&(o.footerButtons.Ok.hide(),o.footerButtons.createBtnCombo.inject(o.myDialog.elements._buttonsDiv,"top")))}).catch(function(e){console.log(e)})}},buildDialog:function(e){var t=this;e.resizableFlag=!0,e.immersiveFrame=this.immersiveFrame,e.activeFlag=!0;var i=new a(e);return i.addEventListener("close",function(){t.dispatchEvent("onClose")}),this.disableBtnClickOnEnter=!1,i.addEventListener("keydown",function(e){13===e.keyCode?t.disableBtnClickOnEnter=!0:27===e.keyCode&&(t.onEscKeyDown=!0)}),i.addEventListener("keyup",function(e){13===e.keyCode?(t.onEnterKeyDown=!1,t.disableBtnClickOnEnter=!1):27===e.keyCode&&(t.onEscKeyDown=!1,t.dispatchEvent("onClose"))}),i},buildContent:function(e,t,i){var n=this,a=!0;return new UWA.Promise(function(t){if("listView"===n.viewType)n.View=new s({identifier:n.identifier,events:{onChangeAttribute:function(e){n.dispatchEvent("onChangeAttribute",[e])},onFacetNotification:function(e){n._addNotif(e)},onEnterKeyDown:function(){n.onEnterKeyDown=!0},runBLForUI:function(){n.dispatchEvent("runBLForUI",arguments)},onResize:function(e){var t="resize";a&&(a=!1,t="ready",n.View.focusFirstLine(),setTimeout(function(){n.myDialog.minHeight=n.myDialog.elements._footerDiv.offsetHeight+80}));var i=parseInt(n.myDialog.elements._contentDiv.getStyle("padding").replace("px","")),o=e.height+n.elements.toolbarContainer.getSize().height+n.myDialog.elements._footerDiv.getSize().height+i;r.dispatchEvent("onCreationDialogAction",[{action:t,dimension:{width:e.width,height:o}},"undefined"!=typeof dscef?n:void 0])}},buttons:n.footerButtons}),n.View.buildModel(e),n.View.loadView(),t(n.View);else{var i={identifier:n.identifier,facets:n.facets,buttons:n.footerButtons,events:{onTabChange:function(e){n.manageButtons(e)},onChangeAttribute:function(e){n.dispatchEvent("onChangeAttribute",[e])},onFacetNotification:function(e){n._addNotif(e)},onEnterKeyDown:function(){n.onEnterKeyDown=!0},runBLForUI:function(){n.dispatchEvent("runBLForUI",arguments)},onResize:function(e){var t="resize";a&&(a=!1,t="ready",setTimeout(function(){n.myDialog.minHeight=n.myDialog.elements._footerDiv.offsetHeight+80}));var i=parseInt(n.myDialog.elements._contentDiv.getStyle("padding").replace("px","")),o=e.height+n.elements.toolbarContainer.getSize().height+n.myDialog.elements._footerDiv.getSize().height+i;r.dispatchEvent("onCreationDialogAction",[{action:t,dimension:{width:e.width,height:o}},"undefined"!=typeof dscef?n:void 0]),n.myDialog._getDimensionsFromPreferences()},refreshValidationStatus:function(){n.evaluateValidationStatus()}}};"tabView"===n.viewType?n.View=new c(i):"wizardView"===n.viewType&&(n.View=new l(i)),n.View.loadView(()=>{t(n.View)})}})},buildToolbar:function(e,t){var i=this;return new UWA.Promise(function(n){if(e&&e.activatelock&&e.activatelock.show){var a=!1;function o(e){return"LOCK"===e?{class:"ENONew-lock-class",icon:"key",label:d.get("locked")}:{class:"ENONew-lock-open-class",icon:"lock-open",label:d.get("unlocked")}}e.activatelock.preference?a=e.activatelock.preference:t&&t.lockState&&(a=t.lockState),i.userPrefs.isLock=a,require(["DS/Tweakers/GeneratedToolbar"],function(e){let t=o(a);var r={entries:[{id:"toolbarLock_Btn",onNodeUpdate:function(){},dataElements:{typeRepresentation:"function",icon:{iconName:t.icon,fontIconFamily:1,className:t.class},position:"far",category:"2",label:t.label,value:function(e){let t="key"===e.context.nodeModel.getAttributeValue("semantics").icon.iconName?"UNLOCK":"LOCK",n=o(t);i.userPrefs.isLock=t,e.context.nodeModel.setLabel(n.label),e.context.toolbar.updateNodeModel("toolbarLock_Btn",{grid:{semantics:{icon:{iconName:n.icon,fontIconFamily:1,className:n.class}}}})}}}]},s=e.prototype.createTreeDocument(r);s.onNodeModelUpdate(function(e){if("lock_btn"===e.data.nodeModel._ID&&e.data.attributes.hasOwnProperty("data")){var t=o(e.data.nodeModel.getAttributeValue("data"));e.target.setLabel(t.label)}});var c=new e({executionContext:s,overflowManagement:"dropdown",direction:"horizontal",items:s});n(c)})}else n()})},showDialog:function(){this.myDialog.show()},addLoadingOverlay(e){this.myDialog&&o.displayModalLoader(this.myDialog.elements._contentDiv,e)},removeLoadingOverlay(e){this.myDialog&&o.removeModalLoader(this.myDialog.elements._contentDiv,e)},reloadContent:function(e){if("listView"===this.viewType)this.View.buildModel(e),this.View.loadView();else{this.View.refreshView();var t=u.getDefaultFacetName();this.View.facets.forEach(function(i){if(i.content&&UWA.is(i.content.updateFacet,"function")){var n=i.options;e&&i.facet.name===t&&(n.data=e),i.content.updateFacet(n)}})}},onSubmitDialog:function(e){var t=this,i=function(i){i?"create"!==e&&"createClose"!==e||t.ServiceCallback&&"function"==typeof t.ServiceCallback&&t.ServiceCallback(i,{eventID:e},t.getUserPreferences()):t.resetButtons()};"listView"===this.viewType?this.View.onSubmit(i):this.onSubmit(e,i)},getUserPreferences:function(){if(this.userPrefs&&Object.keys(this.userPrefs).length){var e={};return UWA.is(this.userPrefs.isLock)&&(e.toolbarIsLockEnabled=this.userPrefs.isLock),UWA.is(this.userPrefs.createBtn)&&(e.footerCreateBtnState=this.userPrefs.createBtn),e}},_addNotif:function(e){var t=e.msg,i=e.eventID,n=e.id?e.id:e.eventID;switch(i){case"error":t=t||e.json,this._addError(t,n);break;case"warning":this._addWarning(t,n);break;case"success":this._addSuccess(t,n);break;default:this._addInfo(t,n)}},_addInfo:function(e,t){var i=this;this._getErrorManager(function(n){var a=n.addInfo(e,t);i.dispatchEvent("onNotification",a)})},_addWarning:function(e,t){var i=this;this._getErrorManager(function(n){var a=n.addWarning(e,t);i.dispatchEvent("onNotification",a)})},_addSuccess:function(e,t){var i=this;this._getErrorManager(function(n){var a=n.addSuccess(e,t);i.dispatchEvent("onNotification",a)})},_addError:function(e,t){var i=this;this._getErrorManager(function(n){var a=n.addError(e,t);i.dispatchEvent("onNotification",a)})},_getErrorManager:function(e){var t=this;this.errorOverlay?e.call(null,this.errorOverlay):require(["DS/ErrorWidget/ErrorWidget"],function(i){t.errorOverlay||(t.errorOverlay=new i(widget,t.myDialog.elements.container,{className:"newcontent_errorManager"})),e.call(null,t.errorOverlay)})},getDefaultButtons:function(e,t){var i=this,n={},a=[];return"listView"===e||"tabView"===e?a=["Ok","Discard"]:"wizardView"===e&&(a=["Ok","Reset","RestoreDefaults","Discard"]),a.forEach(function(e){n[e]=i.buildButton(e,t)}),n},buildDraftModeButton(e){var t,n=this;if(e&&e.optionsList&&e.optionsList.length){var a=[],o="";e.optionsList.forEach(t=>{a.push(t.nls),t.name===e.preference&&(o=t.nls)}),n.userPrefs.createBtn=e.preference,(t=new i({name:"createClose",emphasize:"primary",enableSearchFlag:!1,actionOnClickFlag:!0,elementsList:a,value:o})).addEventListener("click",function(i){if(!n.disableBtnClickOnEnter||n.disableBtnClickOnEnter&&n.onEnterKeyDown){if(n.disableBtnClickOnEnter&&n.onEnterKeyDown&&"wizardView"===n.viewType)return void n.footerButtons.RestoreDefaults.onClick();n.userPrefs.createBtn=e.optionsList[t.selectedIndex].name,this.permanentDisable=!0,n.disableFormSubmit(!0),i.dsModel.label=d.creatingButton,n.myDialog.checkboxInfos&&n.myDialog.checkboxInfos.checkFlag?n.onSubmitDialog("create"):n.onSubmitDialog("createClose")}}),t.elements.mainElement.addClassName("wux-ui-state-primary"),t.elements.expander.addClassName("wux-ui-state-primary"),t.elements.expander.setStyle("margin-left",0)}return t},manageButtons:function(e){if("wizardView"===this.viewType&&this.View){var t=this.View.getActiveFacet(),i=this.View.isFirstFacet(t.facet.name),n=this.View.isLastFacet(t.facet.name);this.footerButtons.Reset.visibleFlag=!i,this.footerButtons.RestoreDefaults.visibleFlag=!n,this.footerButtons.Ok.visibleFlag=n}},evaluateValidationStatus:function(){for(var e=!0,t=0;t<this.View.facets.length;t++){var i=this.View.facets[t];if(i.content&&!i.content.facetValidation){e=!1;break}}e?this.resetButtons():(this.permanentDisable=!0,this.disableFormSubmit(!0,!0))},buildButton:function(e,t){var i,a=this;switch(e){case"Apply":i=new n({id:"create",label:d.createBtn,onClick:function(e){this.permanentDisable=!0,a.disableFormSubmit(!0),e.dsModel.label=d.creatingButton,a.onSubmitDialog("create")}});break;case"Ok":i=new n({name:"createClose",label:d.createCloseBtn,onClick:function(e){if(!a.disableBtnClickOnEnter||a.disableBtnClickOnEnter&&a.onEnterKeyDown){if(a.disableBtnClickOnEnter&&a.onEnterKeyDown&&"wizardView"===a.viewType)return void a.footerButtons.RestoreDefaults.onClick();this.permanentDisable=!0,a.disableFormSubmit(!0),e.dsModel.label=d.creatingButton,a.myDialog.checkboxInfos&&a.myDialog.checkboxInfos.checkFlag?a.onSubmitDialog("create"):a.onSubmitDialog("createClose")}}});break;case"draftModeButton":i=a.buildDraftModeButton(t.activateDraftMode);break;case"Discard":i=new n({name:"close",label:d.closeBtn,onClick:function(e){a.dispatchEvent("onClose")}});break;case"Reset":i=new n({name:"previous",label:d.previousBtn,onClick:function(e){UWA.is(a.View.switchToRelativeFacet,"function")&&a.View.switchToRelativeFacet(-1)}});break;case"RestoreDefaults":i=new n({name:"next",label:d.nextBtn,onClick:function(e){UWA.is(a.View.switchToRelativeFacet,"function")&&a.View.switchToRelativeFacet(1)}})}return i},disableFormSubmit:function(e,t){if(t||this.addLoadingOverlay(),this.footerButtons)for(var i in this.permanentDisable&&(e=!0),this.footerButtons){var n=this.footerButtons[i];"Ok"!=n.value&&"Apply"!=n.value&&"createBtnCombo"!==i||(n.disabled=e)}this.myDialog.elements&&this.myDialog.elements._checkbox&&(this.myDialog.elements._checkbox.disabled=!0)},resetButtons:function(){if(this.removeLoadingOverlay(),this.footerButtons){for(var e in this.footerButtons){var t=this.footerButtons[e];t.disabled=!1,"Ok"===t.value?t.label=d.get("createCloseBtn"):"Apply"===t.value&&(t.label=d.get("createBtn"))}this.myDialog.elements&&this.myDialog.elements._checkbox&&(this.myDialog.elements._checkbox.disabled=!1)}},onSubmit:function(e,t){this.View.facets[0].content.onSubmit(e,t)},postCreation:function(e,t){var i=this;if("listView"===this.viewType)t();else{var n=e.result,a={},o={},r={},s=new Set;this.facetDependency?r=this.facetDependency:(this.View.facets.forEach(function(e){e.dependee&&e.dependee.length>0?(r[e.facet.name]||(r[e.facet.name]={}),r[e.facet.name].to=new Set(e.dependee),e.dependee.forEach(function(t){r[t]||(r[t]={});var i=r[t];i.from||(i.from=new Set),i.from.add(e.facet.name)})):s.add(e.facet.name)}),this.facetDependency=r),this.independentFacetList?s=this.independentFacetList:this.independentFacetList=s,function e(){var c=[];s.forEach(function(e){var t=i.View._getFacetFromName(e);if(t.content&&UWA.is(t.content.postCreation,"function")){var r=JSON.parse(JSON.stringify(n)),s=t.content.postCreation(r,o);s&&(s.then(function(e){i.markComplete(t.facet,e,a,o)}),c.push(s))}}),UWA.Promise.allSettled(c).then(function(n){var o=new Set;s.forEach(e=>{if(r[e]){var t=r[e].from;t&&t.forEach(t=>{var i=r[t].to;i&&(i.delete(e),0==i.size&&o.add(t))})}}),(s=o).size>0?e():(i.facetDependency&&UWA.Object.keys(i.facetDependency).length>0&&console.error("ENONew Facet dependency not resolved completely"),i.closeView(a),t(a))}).catch(function(e){console.log("ENONew : postCreation failed"),t(a)})}()}},markComplete:function(e,t,i,n){var a=e.name;if(console.log("markComplete:"+a),console.log(t),t){var o={facetNLS:e.text,info:t};i[a]=o,t.errors&&(n[a]={},Object.assign(n[a],JSON.parse(JSON.stringify(t.errors))))}},closeView:function(e){console.log("closeView"),console.log(e)},destroy:function(){this.myDialog&&this.myDialog.destroy(),this.immersiveFrame&&this.immersiveFrame.destroy(),this._parent()}})}),define("DS/ENONewWidget/utils/CredentialList",["DS/ENONewWidget/ajaxRequests/WebReq"],function(e){"use strict";const t=e=>e.reduce(function(e,i){return e.concat(Array.isArray(i)?t(i):i)},[]);return{loadCredentials:i=>new UWA.Class.Promise((n,a)=>{e.get("/resources/modeler/pno/person",{tenant:i,params:{current:"true",select:"collabspaces&select=preferredcredentials"}}).then(e=>n((e=>{let i=[];if(!UWA.is(e.collabspaces,"array"))return i;let n=[...new Set(t(e.collabspaces.map(e=>e.couples.map(e=>e.organization.name))))].length>1;return e.collabspaces.forEach(e=>{e.couples.forEach(t=>{var a=null==t.role.nls||""==t.role.nls?t.role.name:t.role.nls,o=t.role.name,r=t.organization.name,s=t.organization.title,c=e.name,l=e.title?e.title:e.name;let u=n?l+" ● "+s+" ● "+a:l+" ● "+a,d="ctx::"+o+"."+r+"."+c;i.push({displayName:u,ctx:d})})}),i.sort((e,t)=>e.displayName.localeCompare(t.displayName,void 0,{numeric:!0,sensitivity:"base"}))})(e)))}),filterCredentials:(t,i,n)=>new UWA.Class.Promise((a,o)=>{e.post("/resources/lifecycle/util/filterValidSCs",((e,t)=>{let i={Command:t,SecurityContexts:e.map(e=>e.ctx)};return JSON.stringify(i)})(i,n),{tenant:t}).then(e=>{e.status&&"success"===e.status?a((e=>e.filter(e=>!(e=>{let t=e.match(/(ctx::)([^.]+)/);return t.length>2&&"VPLMAdmin"===t[2]})(e)))(e.data)):o(e.error?e.error:"/resources/lifecycle/util/filterValidSCs - failed!")}).catch(o)})}}),define("DS/ENONewWidget/utils/DefaultCredential",["DS/ENONewWidget/ajaxRequests/WebReq","DS/ENONewWidget/ajaxRequests/LifecycleServicesSettings","DS/WAFData/WAFData"],function(e,t,i){"use strict";let n=(n,a,o)=>{var r=t.get3DSpaceWSUrl(n,"/resources/pno/person/getsecuritycontext",null);i.authenticatedRequest(r,{type:"json",method:"GET",proxy:"passport",headers:t.getHeaders(),timeout:6e5,onComplete:function(e){var t="";if(null!=e&&""!=e&&e.hasOwnProperty("SecurityContext")&&null!=e.SecurityContext){(t=e.SecurityContext.replace("ctx::","")).trim().length>0&&(t="ctx::"+e.SecurityContext),a(t)}},onFailure:function(t,i){console.error("getSecurityContext:Failure..."+t),e.onWebServiceError(o,t,i)},ontimeout:function(){console.error("getSecurityContext: A connection timeout occurred.")}})},a=e=>{if("function"==typeof widget.hasPreference&&widget.hasPreference("xPref_CREDENTIAL")){var t=widget.getPreference("xPref_CREDENTIAL");if(void 0!==t.value&&null!==t.value&&t.hasOwnProperty("value"))return"ctx::"+t.value}return"function"==typeof widget.hasPreference&&null!=widget.getPreference("pad_security_ctx")?widget.getPreference("pad_security_ctx").value:null};return{loadDefaultContexCredential:e=>((e,t)=>{var i=a(e);return i?new UWA.Class.Promise.resolve(i):new UWA.Class.Promise(function(t,i){n(e,function(e){t(e)},function(e){i(e)})})})(e.tenant,e.context).then(e=>UWA.Promise.resolve((e=>e.startsWith&&e.startsWith("ctx::")?e:"ctx::"+e)(e)))}}),define("DS/ENONewWidget/ajaxRequests/ENONewServices",["UWA/Controls/Abstract","DS/ENONewWidget/utils/CredentialList","DS/ENONewWidget/utils/DefaultCredential","DS/ENONewWidget/ajaxRequests/LifecycleServicesSettings","DS/ENONewWidget/ajaxRequests/ENONewAjaxRequests","DS/ENOCollabToolsUI/tracker/ENOCollabTrackerBackEnd","i18n!DS/ENONewWidget/assets/nls/ENONewWidgetNls"],function(e,t,i,n,a,o,r){return Services=e.extend({init:function(e,t){this._parent(e),e&&(e.tenant?this.tenant=e.tenant:this.tenant=n.getTenant(),e.serviceBaseUrl?this.service=e.serviceBaseUrl:e.service&&(this.service=n.getPlatformBaseUrl(e.service,this.tenant)),this.service||(this.service=n.getPlatformBaseUrl("3DSpace",this.tenant)),e.header&&(this.header=e.header,e.header.SecurityContext&&(this.prefSecCont=e.header.SecurityContext)),t&&(this.parsedResult=!!t.parsedResult))},getTypeInfo1:function(e,t,i){var n=this;t&&(this.prefSecCont=t);var o=this.header?this.header:{},r={service:this.service+"/resources/v1/collabServices/authoring/createContent/typeInfo",tenant:this.tenant};return Object.keys(e).forEach(t=>(void 0===e[t]||null===e[t])&&delete e[t]),new UWA.Promise(function(t,s){n.getPreferedSecurityContext().then(function(c){n.prefSecCont=c,o.SecurityContext=n.prefSecCont,r.header=o,a._post(e,r,function(e){e&&"success"===e.status?t(n.parseTypeInfo(e,i)):s(e)},function(e){console.log("vma rejected"),s(e)})}).catch(function(e){console.log("vma security context failure"),console.log(e)})})},parseTypeInfo:function(e,t){var i={};this.rawTypeInfo=e.result;var n=e.result[0];if(t)return n;var a=n.type,o=n.subTypes;if(o=UWA.is(o,"array")?o:[]){var s=[],c=[];for(var l in o){var u=o[l];s.push(u.name),c.push(u.nls)}var d=s.length>1,f={name:"Type",nls:r.Type,type:"String",value:a,range:s,rangeNLS:c,positionUI:1,positionGroup:6,visible:d,defaultAttribute:!0,sortedOptions:!0,mandatory:!0,persistData:o,dropdownMode:"click"};i.Type=f}return i.attributes=n.attributes,i.interfaces=n.interfaces,i.reInitOnSecCtxChange=1==n.reInitOnSecCtxChange,i.prefs=n.prefs,i.isUXModifyDeployed=n.isUXModifyDeployed,i.basicAttributes=n.basicAttributes,i},createContent:function(e,t,i,n){var r=this,s=this.service+"/resources/v1/collabServices/authoring/createContent/Create",c={tenant:this.tenant,service:s},l=this.header?this.header:{};for(var u in l.SecurityContext=t.securityContext,c.header=l,e){var d=e[u];this.rawTypeInfo[0][u]=d}var f={create:this.rawTypeInfo};o.enrichRequestWithMetrics(f,{UXName:"New"});var p={typeName:"",select:[],aggregating_context:[],parsed:this.parsedResult,folderID:[],selectedIDs:[],activeFolder:!1};if(e){if(t.queryParams){for(var u in p)val=t.queryParams[u],val&&(p[u]=val);c.params=p}a._post(f,c,function(e){i(e,r.service)},n)}},lockUnlockObject(e,t,i,n){var o="/resources/v1/collabServices/reservation/op/"+(e&&"LOCK"===e?"reserve":"unreserve"),r=this.header?this.header:{},s=this.service+o,c={tenant:this.tenant,service:s,params:{isMultiSel:0,select:"physicalid"},header:r},l={branchorcontent:"type"};if(t&&t.result){var u=[];t.result.forEach(function(e){e.type&&(u.push("model/bus/"+e.physicalid),0)}),l.urls=u}r.SecurityContext=i.securityContext?i.securityContext:this.prefSecCont,a._post(l,c,function(e){n(e)},function(e){n(e)})},getSecurityContextList:function(){var e=this,i=this.getPreferedSecurityContext(),n=t.loadCredentials(e.tenant);return new UWA.Promise(function(t){UWA.Promise.all([i,n]).then(function(i){i.length<2||!UWA.is(i[1],"array")?console.error("Missing credentials"):t(function(t){var i=this.prefSecCont;i&&""!=i||(i=t[0]),e.preferedSecCtx=i;var n=t[1],a=[],o=[];for(var s in n){var c=n[s];a.push(c.ctx),o.push(c.displayName)}var l=a.length>1;return{name:"SecurityContext",nls:r.SecurityContext,type:"String",value:i,range:a,rangeNLS:o,visible:l,positionUI:1,positionGroup:8,defaultAttribute:!0,sortedOptions:!0,mandatory:!0,dropdownMode:"click"}}(i))})})},getPreferedSecurityContext:function(){var e=this;return this.prefSecCont?new UWA.Promise(function(t){t(e.prefSecCont)}):i.loadDefaultContexCredential({tenant:this.tenant,context:this.context})},set3DPartTemplate:function(e,t,i,n){var o=this.service+"/resources/v1/modelerServices/authoring/op/set3DPartTemplateExpression",r={securityContext:this.prefSecCont,tenant:this.tenant,service:o},s={data:[e]};e&&a._post(s,r,i,n)},getListofTypes:function(e,t,i){var n=this.header?this.header:{},o=this.service+"/resources/v1/collabServices/authoring/createContent/listOfTypes",r={tenant:this.tenant,service:o};e&&(this.prefSecCont?(n.SecurityContext=this.prefSecCont,r.header=n,a._post(e,r,t,i)):this.getPreferedSecurityContext().then(function(o){this.prefSecCont=o,n.SecurityContext=this.prefSecCont,r.header=n,a._post(e,r,t,i)}).catch(function(e){console.log("vma security context failure"),console.log(e)}))}}),Services}),define("DS/ENONewWidget/command/NewContentCmd",["DS/ENONewWidget/command/NewContentCmdMap","DS/ENONewWidget/command/NewContentCommandBase","DS/ENONewWidget/ENONewLauncher","DS/ENONewWidget/command/NewContentDialog","DS/ENONewWidget/ajaxRequests/ENONewServices","DS/ENONewWidget/ajaxRequests/LifecycleServicesSettings"],function(e,t,i,n,a,o){"use strict";return t.extend({init:function(e){this._parent(e);var t,o=this.ENONewContext;o?(o.getNewTypeList||(this.existingImpl=!0,o.updatedListOfTypes&&UWA.is(o.updatedListOfTypes,"function")?this.updatedListOfTypes=o.updatedListOfTypes:console.log("updatedListOfTypes function is invalid"),o.getLaunchOptions&&UWA.is(o.getLaunchOptions,"function")?this.getLaunchOptions=o.getLaunchOptions:console.log("getLaunchOptions function is invalid")),o.getLoginContext&&UWA.is(o.getLoginContext,"function")&&(t=o.getLoginContext())):console.log("ENONewContext object is empty"),this.dialog=new n,this.launcher=new i,this.services=new a(t),this.isCreateDialogOpen=!1,this.enable(),this.specializedCommands={}},execute:function(){var e,t=this;if(!this.isCreateDialogOpen)if(this.disable(),this.existingImpl){var i=this.updatedListOfTypes();i=i||this.ENONewContext.panelContent.data;var n=this.ENONewContext.options?this.ENONewContext.options:{};(e=this.dialog.displayDialog(i,n,function(e){var i=e.dsModel;if(console.log("btn clicked : "+i.label),i){var n=i.value;n?t.launchPanel(n):console.log("Failed to get type Info")}else console.log("Failed to get view Model")}))&&(e.addEventListener("close",function(e){t.isCreateDialogOpen=!1,t.dialog.destroyDialog(),t.enable()}),t.isCreateDialogOpen=!0)}else{var a=this.getNewTypeList();this.showSubtype=a.showSubtype,this.getTypeList(a,function(i){var n=o.get3DSpaceBaseUrl(o.getTenant())+"/snresources/images/icons/small/";(e=t.dialog.display(i,{iconBaseURL:n},function(e){t.launchTypeCmd(e),t.closeNewContentPanel()}))&&(e.addEventListener("close",function(e){t.closeNewContentPanel()}),t.isCreateDialogOpen=!0)})}},getType(){return this._type},getNewTypeList(){var e=this.ENONewContext;if(e&&e.getNewTypeList&&UWA.is(e.getNewTypeList,"function"))return e.getNewTypeList(this.options)},getTypeList(e,t){e&&e.typeList?this.services.getListofTypes(e,function(e){console.log("vma12:Success:getTypeList"),t(e.result)},function(){console.log("vma12:Fail:getTypeList")}):t()},launchTypeCmd(t){var i=this;if(this._type=t.type,this.typeDetails=t,t.newType){if(this.specializedCommands[t.newType]){var n=this.specializedCommands[t.newType].commandInstance;return n.createOptModel.set("showSubtype",!i.showSubtype),n.execute(t),n}var a=e.getCmdDetails(t.newType);if(a)i.specializedCommands[t.newType]=a,require([a.cmdRequire],function(e){var n=new e(i.options);return i.specializedCommands[t.newType].commandInstance=n,n.createOptModel.set("showSubtype",!i.showSubtype),n.execute(t),n});else{this._type="Default";var o=this.getCreateOptions({type:t.type,newType:"Default"});this.launchCreateNew(o)}}else console.error("Command launch failed")},addObjectInLifecycleWidget(e){var t;e&&(t=[],e.forEach(function(e){var i={objectId:e.identifier,displayName:e.V_name,objectType:e.type};t.push(i)}),this.options.context.addNewObject1({data:{items:t}}))},getOptions(e){var t=this;return{context:{},type:e.type,options:{typeName:e.newType},events:{onSuccess:function(e){t.addObjectInLifecycleWidget(e.result)},onFailure:function(e){},onCancel:function(e){}}}},closeNewContentPanel(){this.isCreateDialogOpen=!1,this.dialog&&this.dialog.destroyDialog(),this.enable()},launchPanel:function(e){var t=this.getLaunchOptions(e);this.launcher.CreateNew(t),this.isCreateDialogOpen=!1,this.dialog.destroyDialog(),this.enable()}})}),define("DS/ENONewWidget/command/sample/NewContentInputTypeCmd",["DS/ENONewWidget/command/NewContentCmd"],function(e){"use strict";return e.extend({getNewTypeList:()=>[],getTypeList(e,t){t()},launchTypeCmd(e){this._type=e.newType;var t=this.getCreateOptions(e);this.launchCreateNew(t)}})});