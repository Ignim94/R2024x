define("DS/CATRgnWidgetCommons/restClient/DocumentServices",["require","exports","DS/DocumentManagement/DocumentManagement","DS/RGNServices/WAFDataUtil"],function(e,t,n,i){"use strict";function o(e,t,n,i){return new Promise((o,s)=>{n=Object.assign({securityContext:t,tenant:e.tenant,tenantUrl:e.url,onComplete:o,onFailure:s},n),i(n)})}Object.defineProperty(t,"__esModule",{value:!0}),t.getDocumentsVersion=t.getDocumentTicket=t.getDocumentFilesInfo=t.getDocument=t.unreserveDocument=t.download=t.replaceFile=t.addFileToDocument=void 0,t.addFileToDocument=function(e,t,i,s){const r={id:i,fileInfo:{file:s}};return o(e,t,{},e=>n.addFileToDocument(r,e))},t.replaceFile=function(e,t,i,s,r){const a={id:i,fileInfo:{file:r}};return o(e,t,{},e=>n.modifyDocument(a,e))},t.download=function(e,t,i,s){return o(e,t,{autoDownload:!0},e=>n.downloadDocument(i,s,!1,e))},t.unreserveDocument=async function(e,t,n){return i.authenticatedRequest("PUT",`${e.url}/resources/v1/modeler/documents/${t}/unreserve`,"json",n)},t.getDocument=async function(e,t,n){return i.authenticatedRequest("GET",`${e.url}/resources/v1/modeler/documents/${t}`,"json",n)},t.getDocumentFilesInfo=async function(e,t,n){return i.authenticatedRequest("GET",`${e.url}/resources/v1/modeler/documents/${t}/files`,"json",n)},t.getDocumentTicket=async function(e,t,n,o){return i.authenticatedRequest("PUT",`${e.url}/resources/v1/modeler/documents/${t}/files/${n}/DownloadTicket`,"json",o)},t.getDocumentsVersion=async function(e,t){return new Promise((i,o)=>{t=Object.assign({getVersions:t.getVersions,onComplete:e=>i(e),onFailure:o},t),n.getObjects([e],t)})}}),define("DS/CATRgnWidgetCommons/restClient/ReportServices",["require","exports","DS/RGNServices/WAFDataUtil"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.save=t.postEditing=t.generationStatus=t.generateReports=t.getStatus=t.updateReport=t.createReports=t.getReportsBulkDetails=t.getReportsBulk=t.getReportDetails=t.getReport=void 0,t.getReport=async function(e,t,i){return n.authenticatedRequest("GET",`${e.url}/resources/v1/modeler/dsrgn/report/${i}`,"json",t).then(e=>({status:e.status,report:e.reports[0]}))},t.getReportDetails=async function(e,t,i){return n.authenticatedRequest("GET",`${e.url}/resources/v1/modeler/dsrgn/report/${i}?inputDetails=true`,"json",t).then(e=>({status:e.status,report:e.reports[0]}))},t.getReportsBulk=async function(e,t,i){return n.authenticatedRequest("POST",`${e.url}/resources/v1/modeler/dsrgn/report/private:bulkGet`,"json",t,{type:"json",payload:i})},t.getReportsBulkDetails=async function(e,t,i){return n.authenticatedRequest("POST",`${e.url}/resources/v1/modeler/dsrgn/report/private:bulkGet?inputDetails=true`,"json",t,{type:"json",payload:i})},t.createReports=function(e,t,i){return n.authenticatedRequest("POST",`${e.url}/resources/v1/modeler/dsrgn/report`,"json",t,{type:"json",payload:i},6e4)},t.updateReport=function(e,t,i,o){return n.authenticatedRequest("PATCH",`${e.url}/resources/v1/modeler/dsrgn/report/${i}`,"json",t,{type:"json",payload:o},6e4)},t.getStatus=async function(e,t,i){return n.authenticatedRequest("GET",`${e.url}/resources/v1/modeler/dsrgn/report/${i}/status`,"json",t)},t.generateReports=async function(e,t,i,o,s){const r=`${e.url}/resources/v1/modeler/dsrgn/report/generate?enablePostEdition=${o}&withChanges=${i}`;return n.authenticatedRequest("POST",r,"json",t,{type:"json",payload:s},6e4)},t.generationStatus=async function(e,t,i){return n.authenticatedRequest("POST",`${e.url}/resources/v1/modeler/dsrgn/report/generation/status`,"json",t,{type:"json",payload:i},6e4)},t.postEditing=async function(e,t,i){return e=e.endsWith("/")?e.slice(0,-1):e,n.authenticatedRequest("GET",`${e}/resources/v1/modeler/dsrgn/report/${t}/postediting`,"json",i,void 0,6e4)},t.save=async function(e,t,i,o){return e=e.endsWith("/")?e.slice(0,-1):e,n.authenticatedRequest("Post",`${e}/resources/v1/modeler/dsrgn/report/${t}/postediting/save`,"json",o,{type:"json",payload:i},6e4)}}),define("DS/CATRgnWidgetCommons/restClient/TemplateServices",["require","exports","DS/RGNServices/WAFDataUtil"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getI18N=t.unlockTemplate=t.updateTemplate=t.createTemplates=t.areTemplatesUsed=t.getTemplatesBulk=t.getTemplate=void 0,t.getTemplate=async function(e,t,i){return n.authenticatedRequest("GET",e.url+"/resources/v1/modeler/dsrgn/template/"+i,"json",t).then(({status:e,templates:[t]})=>({status:e,template:t}))},t.getTemplatesBulk=async function(e,t,i){return n.authenticatedRequest("POST",e.url+"/resources/v1/modeler/dsrgn/template/private:bulkGet","json",t,{type:"json",payload:i})},t.areTemplatesUsed=async function(e,t,i){return n.authenticatedRequest("POST",e.url+"/resources/v1/modeler/dsrgn/template/checkIfUsed","json",t,{type:"json",payload:i})},t.createTemplates=function(e,t,i){return n.authenticatedRequest("POST",e.url+"/resources/v1/modeler/dsrgn/template","json",t,{type:"json",payload:i})},t.updateTemplate=function(e,t,i,o){return n.authenticatedRequest("PATCH",e.url+`/resources/v1/modeler/dsrgn/template/${i}`,"json",t,{type:"json",payload:o})},t.unlockTemplate=async function(e,t,i){return n.authenticatedRequest("Post",`${e.url}/resources/rgn/template/unlock/${t}`,"json",i,{type:"json",payload:{type:"json",payload:"DUMMY_PAYLOAD"}})},t.getI18N=async function(e,t){return n.authenticatedRequest("get",`${e}/resources/rgn/template/i18n`,"json",t)}}),define("DS/CATRgnWidgetCommons/interfaces/Interfaces",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})}),define("DS/CATRgnWidgetCommons/LoaderManager",["require","exports","DS/Controls/Loader","DS/Controls/ModalContainer"],function(e,t,n,i){"use strict";return class{constructor(e){this.container=e}displayLoader(e=""){return 0===document.getElementsByClassName("wux-controls-modalContainer").length&&(this.loader=new n,i.createModal(this.container,this.loader.elements.container),this.loader.on(e),this.loader.visibleFlag=!0),this.loader}hideLoader(e=""){var t;(null===(t=null==this?void 0:this.loader)||void 0===t?void 0:t.visibleFlag)&&(this.loader.off(e),i.removeModal(this.container))}async showLoader(e,t=""){this.displayLoader(t);try{return await e()}finally{this.hideLoader(t)}}}}),define("DS/CATRgnWidgetCommons/skeleton/SkeletonHelper",["require","exports","UWA/Core","DS/Skeleton/SkeletonLayout"],function(e,t,n,i){"use strict";const o=30,s=100,r=30;let a;return class{constructor(e){const t=e||{};a=new i({leftContainerContent:new n.Element("div",{id:"LeftContent"}),rightContainerContent:new n.Element("div",{id:"RightContent"}),navigationContainerContent:new n.Element("div",{id:"NavBarContent"}),centerContainerContent:new n.Element("div",{id:"CenterContent"}),statusContainerContent:new n.Element("div",{id:"StatusBarContent"}),idCardContainerContent:new n.Element("div",{id:"IdCardContent"}),navigationContainerHeight:o,statusContainerHeight:r,idCardContainerHeight:s,leftContainerWidth:document.body.clientWidth/4,leftContainerMinWidth:50,leftContainerMaxWidth:300,rightContainerWidth:document.body.clientWidth/4,rightContainerMinWidth:50,rightContainerMaxWidth:300,identifier:"SkeletonLayout"}),this.hideLeftContainer(null==t.hideLeftPanel||t.hideLeftPanel),this.hideRightContainer(null==t.hideRightPanel||t.hideRightPanel),this.hideNavigationBarContainer(null!=t.hideNavigationBar&&t.hideNavigationBar),this.hideIdCardContainer(null!=t.hideIDCard&&t.hideIDCard),this.hideStatusContainer(null!=t.hideStatusBar&&t.hideStatusBar)}getSkeleton(){return a}hideLeftContainer(e){a.leftContainerCollapsedFlag=e}hideRightContainer(e){a.rightContainerCollapsedFlag=e}hideNavigationBarContainer(e){a.navigationContainerVisibleFlag=!e}hideIdCardContainer(e){a.idCardContainerVisibleFlag=!e}hideStatusContainer(e){a.statusContainerVisibleFlag=!e}setLeftContainerContent(e){e.inject(a.leftContainerContent)}getLeftContainerContent(){return a.leftContainerContent}setRightContainerContent(e){e.inject(a.rightContainerContent)}getRightContainerContent(){return a.rightContainerContent}setNavigationBarContent(e){e.inject(a.navigationContainerContent)}getNavigationBarContent(){return a.navigationContainerContent}setIDCardContent(e){e.inject(a.idCardContainerContent)}getIDCardContent(){return a.idCardContainerContent}setStatusBarContent(e){e.inject(a.statusContainerContent)}getStatusBarContent(){return a.statusContainerContent}setCenterContent(e){e.inject(a.centerContainerContent)}getCenterContent(){return a.centerContainerContent}}}),define("DS/CATRgnWidgetCommons/ListManager",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getList=t.saveList=t.RGD_TEMPLATES=t.RGR_OUTPUFORMATS=t.RGR_REPORTS=void 0,t.RGR_REPORTS="RGR_Reports",t.RGR_OUTPUFORMATS="RGR_OutputFormats",t.RGD_TEMPLATES="RGD_Templates",t.saveList=function(e,t,n){n.setValue(e,t)},t.getList=function(e,t){var n;return null!==(n=t.getValue(e))&&void 0!==n?n:[]}}),define("DS/CATRgnWidgetCommons/interfaces/Facade",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WebClientFactory=t.WidgetClientFactory=void 0;t.WidgetClientFactory=class{getSecurityContext(){var e;return"ctx::"+(null===(e=widget.getValue)||void 0===e?void 0:e.call(widget,"xPref_CREDENTIAL"))}getTenant(){var e;return(null===(e=widget.getValue)||void 0===e?void 0:e.call(widget,"x3dPlatformId"))||"OnPremise"}};t.WebClientFactory=class{constructor(e,t){this.securityContext=e.startsWith("ctx::")?e:"ctx::"+e,this.tenant=t}getSecurityContext(){return this.securityContext}getTenant(){return this.tenant}}}),define("DS/CATRgnWidgetCommons/interfaces/RgnWidgetSettingsInterface",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})}),define("DS/CATRgnWidgetCommons/Placeholder",["require","exports","UWA/Core","DS/UIKIT/Input/Button","DS/RGNServices/FederatedSearch","i18n!DS/CATRgnWidgetCommons/assets/nls/CATRgnWidgetCommons"],function(e,t,n,i,o,s){"use strict";return class{constructor(e){const t=(e=e||{}).placeholderText||s.placeholderDefaultText,r=e.placeholderButtonLabel||s.placeholderDefaultButtonLabel,a=e.placeholderPrecond,d=e.onFederatedSearchComplete,l=e.onFederatedSearchCancel;this.content=new n.Element("div",{styles:{position:"inherit",width:"100%",height:"100%",display:"flex","flex-direction":"column","align-items":"center","justify-content":"center"}}),new n.Element("div",{styles:{flex:1}}).inject(this.content),new n.Element("span",{class:"fonticon fonticon-2x fonticon-drag-drop",styles:{"margin-bottom":"5px",color:"#b4b6ba"}}).inject(this.content),new n.Element("div",{class:"font-3ds-regular",styles:{color:"#b4b6ba"},html:t}).inject(this.content);const u=new n.Element("div",{styles:{display:"flex","flex-direction":"horizontal","align-items":"center",margin:"8px 0px 12px"}}).inject(this.content);new n.Element("div",{styles:{width:"50px",margin:"5px","border-top":"2px solid #D5E8F2"}}).inject(u),new n.Element("div",{styles:{"font-weight":"600",color:"#D5E8F2"},html:s.or}).inject(u),new n.Element("div",{styles:{width:"50px",margin:"5px","border-top":"2px solid #D5E8F2"}}).inject(u),new i({value:r,icon:"search",className:"primary",events:{onClick:()=>{o.search(a,d,l)}}}).inject(this.content),new n.Element("div",{styles:{flex:1}}).inject(this.content)}inject(e){this.content.inject(e)}}}),define("DS/CATRgnWidgetCommons/restClient/OtscriptServices",["require","exports","DS/RGNServices/WAFDataUtil"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fetchOTScriptFiles=t.saveOTScriptFiles=void 0,t.saveOTScriptFiles=function(e,t,i){return n.authenticatedRequest("POST",e.url+"/resources/rgn/ots","json",t,{type:"json",payload:i})},t.fetchOTScriptFiles=async function(e,t){return n.authenticatedRequest("GET",e.url+"/resources/rgn/ots/admin/otscriptFiles","json",t)}}),define("DS/CATRgnWidgetCommons/utils/AsyncExecutor",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AsyncExecutor=void 0;t.AsyncExecutor=class{constructor(e,t){this.poolSize=e,this.parent=t,this.running=0,this.queue=[],this.paused=-1}submit(e){return new Promise((t,n)=>{!this.isPaused()&&this.running<this.poolSize?this.run(t,n,e):this.queue.push(()=>this.run(t,n,e))})}isPaused(){return-1!==this.paused}pause(e){this.isPaused()||setTimeout(()=>this.resume(),e)}resume(){for(let e=0;e<this.poolSize-this.running&&this.queue.length>0;e++){const e=this.queue.shift();e&&e()}}async run(e,t,n){try{this.running++,e(await(this.parent?this.parent.submit(n):n()))}catch(e){t(e)}finally{if(this.running--,!this.isPaused()){const e=this.queue.shift();e&&e()}}}}}),define("DS/CATRgnWidgetCommons/UI/BasicUIElements",["require","exports","UWA/Core","DS/Controls/Editor","DS/Controls/LineEditor","DS/Controls/ComboBox"],function(e,t,n,i,o,s){"use strict";function r(e,t){return new n.Element("p",{text:t,class:"label"}).inject(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.ComboBox=t.TextAreaEditor=t.InputEditor=void 0;t.InputEditor=(({container:e,label:t,placeholder:n,requiredFlag:i=!1,onChange:s},a)=>{t&&r(e,t),new o({placeholder:n,selectAllOnFocus:!0,displayClearFieldButtonFlag:!0,requiredFlag:i}).inject(e).addEventListener(a,s)});t.TextAreaEditor=(({container:e,label:t,placeholder:n,requiredFlag:o=!1,onChange:s})=>{t&&r(e,t),new i({placeholder:n,nbRows:4,newLineMode:"enter",class:"w-100",resizableFlag:!0,requiredFlag:o}).inject(e).addEventListener("change",s)});t.ComboBox=(({container:e,label:t,elementsList:i,onChange:o,defaultValue:a})=>{t&&r(e,t);const d={elementsList:i&&i.length?i:[],enableSearchFlag:!1};if(a){const e=i.indexOf(a);e>=0&&n.extend(d,{selectedIndex:e})}new s(d).inject(e).addEventListener("change",o)})}),define("DS/CATRgnWidgetCommons/ModelElement",["require","exports","UWA/Core","DS/TreeModel/TreeNodeModel"],function(e,t,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ModelElement=t.MetaType=void 0,function(e){e.Report="RP",e.OutputFormat="OF",e.Template="RM",e.FileVersions="FV",e.Jobs="Jobs",e.Upload="Up"}(t.MetaType||(t.MetaType={}));t.ModelElement=class{constructor(e,t,n){const i=e.title||e.name||"";this.info=e,this.info.display=i,this.options=t,this.webClientOptions=n}getNode(){var e;const t=n.clone(function(e){const t={thumbnail:e.options.picture,label:e.info.title||e.info.name||"",icons:[e.options.imageUrl],badges:{},contextualMenu:[],statusbarIcons:[],statusbarIconsTooltips:[],statusbarIconsAction:[],grid:e.info,subLabel:e.info.current+" | "+e.info.dispType+" | "+e.info.revision+" | "+e.info.name,emptyStatusbarVisibleFlag:!1,getContextualMenu:e.options.getContextualMenu};return e.options.getAttributeValueForFiltering&&n.extend(t,{getAttributeValueForFiltering:n=>e.options.getAttributeValueForFiltering?e.options.getAttributeValueForFiltering(t,n):void 0}),t}(this)),o=null!==(e=this.options.contextualActions)&&void 0!==e?e:[];for(const e in o)e&&t.contextualMenu.push(e);return new i(t)}}}),define("DS/CATRgnWidgetCommons/restClient/OutputFormatServices",["require","exports","DS/RGNServices/WAFDataUtil"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.areOfsUsed=t.updateOutputFormat=t.createOutputFormats=t.getOutputFormatsBulk=t.getOutputFormat=t.getOutputFormatLibrary=t.supportedExtensions=void 0,t.supportedExtensions=function(){return["docx","xlsx","pdf.zip","rtf","html","html.zip","xml","csv","txt"]},t.getOutputFormatLibrary=function(e,t){return n.authenticatedRequest("GET",e.url+"/resources/v1/modeler/dsrgn/outputformat/library","json",t)},t.getOutputFormat=async function(e,t,i){return n.authenticatedRequest("GET",e.url+"/resources/v1/modeler/dsrgn/outputformat/"+i,"json",t).then(({status:e,outputFormats:[t]})=>({status:e,outputFormat:t}))},t.getOutputFormatsBulk=async function(e,t,i){return n.authenticatedRequest("POST",e.url+"/resources/v1/modeler/dsrgn/outputformat/private:bulkGet","json",t,{type:"json",payload:i})},t.createOutputFormats=function(e,t,i){return n.authenticatedRequest("POST",e.url+"/resources/v1/modeler/dsrgn/outputformat","json",t,{type:"json",payload:i})},t.updateOutputFormat=function(e,t,i,o){return n.authenticatedRequest("PATCH",e.url+"/resources/v1/modeler/dsrgn/outputformat/"+i,"json",t,{type:"json",payload:o})},t.areOfsUsed=async function(e,t,i){return n.authenticatedRequest("POST",e.url+"/resources/v1/modeler/dsrgn/outputformat/checkIfUsed","json",t,{type:"json",payload:i})}}),define("DS/CATRgnWidgetCommons/utils/RGNConstants",["require","exports"],function(e,t){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.RGN_GRID_VIEW=t.RGR_APP_ID=t.RGD_APP_ID=t.getReportStatus=t.ReportStatus=void 0,function(e){e[e.Running=0]="Running",e[e.None=1]="None",e[e.NeedPostEdition=2]="NeedPostEdition",e[e.NeedPostEditionAndWithChanges=3]="NeedPostEditionAndWithChanges",e[e.Succeeded=4]="Succeeded",e[e.Completed=5]="Completed",e[e.Failed=6]="Failed",e[e.Aborted=7]="Aborted",e[e.Created=8]="Created",e[e.Submitted=9]="Submitted",e[e.ServerError=10]="ServerError"}(n=t.ReportStatus||(t.ReportStatus={})),t.getReportStatus=function(e){return n[e]},t.RGD_APP_ID="CATRTW_AP",t.RGR_APP_ID="CATRGW_AP",t.RGN_GRID_VIEW="RGNGridView"}),define("DS/CATRgnWidgetCommons/restClient/InternalServices",["require","exports","DS/RGNServices/WAFDataUtil"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getRunningJobList=t.getConfigurationsAttachedTo=t.abortJob=void 0,t.abortJob=async function(e,t,i){return n.authenticatedRequest("DELETE",`${e.url}/resources/v1/modeler/dsrgn/internal/report/${i}/job`,"json",t)},t.getConfigurationsAttachedTo=async function(e,t,i){return n.authenticatedRequest("POST",e.url+"/resources/v1/modeler/dsrgn/internal/configurations/attachedTo","json",t,{type:"json",payload:i})},t.getRunningJobList=async function(e,t,i=!1){return n.authenticatedRequest("GET",`${e.url}/resources/v1/modeler/dsrgn/internal/job/jobList?isSuperUser=${i}`,"json",t)}}),define("DS/CATRgnWidgetCommons/UI/Tooltips",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TooltipBuilder=void 0;t.TooltipBuilder=class{buildTooltip(e){return["title","type","revision","name"].filter(t=>Object.prototype.hasOwnProperty.call(e,t)).map(t=>e[t]).join(" | ")}}}),define("DS/CATRgnWidgetCommons/restClient/PeopleServices",["require","exports","DS/RGNServices/WAFDataUtil"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPersonInfos=t.getCurrentUser=void 0,t.getCurrentUser=async function(e,t){return n.authenticatedRequest("GET",`${e.url}/resources/modeler/pno/person?current=true`,"json",t)},t.getPersonInfos=async function(e,t,i){return n.authenticatedRequest("GET",`${e.url}/resources/modeler/pno/person/${i}`,"json",t)}}),define("DS/CATRgnWidgetCommons/restClient/PostEditionServices",["require","exports","DS/RGNServices/WAFDataUtil"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.save=t.postEditing=void 0,t.postEditing=async function(e,t,i){const o=e.url.endsWith("/")?e.url.slice(0,-1):e.url;return n.authenticatedRequest("GET",`${o}/resources/v1/modeler/dsrgn/report/${t}/postediting`,"json",i,void 0,6e4)},t.save=async function(e,t,i,o){const s=e.url.endsWith("/")?e.url.slice(0,-1):e.url;return n.authenticatedRequest("Post",`${s}/resources/v1/modeler/dsrgn/report/${t}/postediting/save`,"json",o,{type:"json",payload:i},6e4)}}),define("DS/CATRgnWidgetCommons/TableView",["require","exports","UWA/Core","DS/DataGridView/DataGridView","DS/CATRgnWidgetCommons/Placeholder","DS/CATRgnWidgetCommons/utils/RGNConstants"],function(e,t,n,i,o,s){"use strict";return class{constructor(e,t,n,i=!0,o=!0){this.displayPlaceHolder=i,this.displayContextualMenu=o,this.model=e,this.options=t,this.widgetSettings=n}inject(e){const t=this,r=this.options.columns,a=new o({...this.options});this.datagrid=new i({identifier:s.RGN_GRID_VIEW,columns:r,defaultColumnDef:{editableFlag:!1},showContextualMenuColumnFlag:!!this.displayContextualMenu,treeDocument:this.model,placeholder:this.displayPlaceHolder?a:void 0,cellDragEnabledFlag:!0,onDragStartCell:this.options.onDragStartCell,getCellTooltip:this.options.getCellTooltip,onContextualEvent:function(e){var n,i;let o=[];if(e&&e.collectionView){const s={insertRow:!1,expandCollapse:!1};if(o=e.collectionView.buildDefaultContextualMenu(e,s),e.cellInfos&&e.cellInfos.rowID>-1){const s=null===(n=null==e?void 0:e.cellInfos.nodeModel)||void 0===n?void 0:n.options.getContextualMenu({...t.options,data:null==e?void 0:e.cellInfos.nodeModel.options.grid,widgetSettings:this.widgetSettings,dataIndex:null===(i=e.collectionView.getColumnOrGroup(e.cellInfos.columnID))||void 0===i?void 0:i.dataIndex});null==s||s.forEach(e=>{o.push(e)})}}return o}.bind(this)}).inject(e),this.datagrid.cellSelection="none",this.datagrid.registerReusableCellContent({id:"statusId",buildContent:function(){return new n.Element("div",{styles:{width:"inherit"}})}}),this.datagrid.registerReusableCellContent({id:"generationStatus",buildContent:function(){return new n.Element("div",{class:"statusGenerationContainer"})}})}getDataGrid(){return this.datagrid}}}),define("DS/CATRgnWidgetCommons/DisplayManager",["require","exports","UWA/Core","DS/CATRgnWidgetCommons/TableView","DS/CATRgnWidgetCommons/ModelElement","i18n!DS/CATRgnWidgetCommons/assets/nls/CATRgnWidgetCommons","DS/CATRgnWidgetCommons/utils/RGNConstants"],function(e,t,n,i,o,s,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.QueryDisplayer=t.getDataIndex=void 0;const a="templateInfo";function d(e){var t,n;return null!==(n=null===(t=e.cellView.collectionView.getColumnOrGroup(e.columnID))||void 0===t?void 0:t.dataIndex)&&void 0!==n?n:void 0}t.getDataIndex=d;t.QueryDisplayer=class{constructor(e,t){this.options=e,this.options.displayer=this,this.options.onDragStartCell=this._onDragStartCell.bind(this),this.model=e.model,this.tileViewCtnr=n.createElement("div",{class:"rgn-tile-view"}),this.tableViewCtnr=n.createElement("div",{class:"rgn-table-view"}),this.tableViewCtnr.style.display="none",this.tableView=new i(this.model,this.options,t),this.tableView.inject(this.tableViewCtnr),this.widgetSettings=t}build(e){this.container=e,this.tileViewCtnr.inject(this.container),this.tableViewCtnr.inject(this.container)}switchView(e){switch(e){case"tile":this.tileViewCtnr.style.display="block",this.tableViewCtnr.style.display="none";break;case"table":default:this.tableViewCtnr.style.display="block",this.tileViewCtnr.style.display="none"}}show(){return this.container.style.display="block",this}isVisible(){return"block"===this.container.style.display}hide(){return this.container.style.display="none",this}onCellDoubleClick(e){}getDisplayedView(){return"table"}searchInWidget(e){this.model.getRoots().forEach(t=>{!function(t){var n,i,a;let d=t.current;e=e.toLowerCase();for(let[n,i]of Object.entries(t))if(i="string"==typeof i?i.toLowerCase():i,"id"!==n&&"message"!==n&&i&&i.includes&&"string"==typeof i&&i.includes(e))return!0;if("IN_WORK"===d&&(d=t.current.toLowerCase().replace(/_/g," ")).includes(e))return!0;switch(t.metaType){case o.MetaType.Report:{const o=r.ReportStatus[null===(n=t.generation)||void 0===n?void 0:n.status],d=t.uptodate;let l="",u="";if(o===r.ReportStatus.Succeeded&&(l=s.downloadReport.toLowerCase(),u=!1===d?s.notUptodate.toLowerCase():s.generationCompleted.toLowerCase()),o!==r.ReportStatus.NeedPostEditionAndWithChanges&&o!==r.ReportStatus.NeedPostEdition||(u=s.needPostEdition.toLowerCase(),l=s.postEdit.toLowerCase()),o===r.ReportStatus.Failed&&(u=s.noGeneration.toLowerCase(),l=s.generateReport.toLowerCase()),(null===(a=null===(i=t.template)||void 0===i?void 0:i.title)||void 0===a?void 0:a.includes(e))||u.includes(e)||l.includes(e))return!0;break}case o.MetaType.OutputFormat:case o.MetaType.Template:}return!1}(t.options.grid)?t.hide():t.show()})}resetSearchInWidget(){this.model.getRoots().forEach(e=>{e.show()})}_onDragStartCell(e,t){var n,i,o,s;const l=this.widgetSettings.widgetId,u=this.widgetSettings.appId,c=this.widgetSettings.version,g=this.widgetSettings.platformId,p=null===(o=null===(i=null===(n=null==t?void 0:t.cellView)||void 0===n?void 0:n.collectionView)||void 0===i?void 0:i.getColumnOrGroup(null==t?void 0:t.columnID))||void 0===o?void 0:o.dataIndex,m=[],h=t.draggedNodes||(null===(s=t.nodeModel)||void 0===s?void 0:s.getTreeDocument().getSelectedNodes());null==h||h.forEach(e=>{var n;const i=d(t);if("targetDocument"===i||"filename"===i||"action"===i){const t=e.options.grid.targetDocument,n={envId:g,objectId:null==t?void 0:t.id,objectType:null==t?void 0:t.policy,displayName:null==t?void 0:t.name,serviceId:"3DSpace"};m.push(n)}if("action"==d(t)){const t=e.options.grid;if(t.targetDocument&&r.ReportStatus[null===(n=t.generation)||void 0===n?void 0:n.status]===r.ReportStatus.Succeeded){const t=e.options.grid.targetDocument,n={envId:g,objectId:null==t?void 0:t.id,objectType:null==t?void 0:t.policy,displayName:null==t?void 0:t.name,serviceId:"3DSpace"};m.push(n)}}else{const t=e.options.grid.template,n=e.options.grid,i={envId:g,objectId:p===a?t.id:n.id,objectType:p===a?t.type:n.type,displayName:p===a?t.title:n.title};m.push(i)}});const v=JSON.stringify({protocol:"3DXContent",version:c,source:u,widgetId:l,action:"extract",data:{items:m}});e.dataTransfer.setData("Text",v)}}}),define("DS/CATRgnWidgetCommons/restClient/CloudViewServices",["require","exports","DS/PlatformAPI/PlatformAPI","DS/CATRgnWidgetCommons/restClient/CommonServices","DS/RGNServices/WAFDataUtil"],function(e,t,n,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCompatibleReportsFromInputs=void 0,t.getCompatibleReportsFromInputs=async function(e,t,s){const r=n.getUser(),a=r?r.login:"",d={SecurityContext:t.getSecurityContext()},l=(s.language,{input_physical_ids:e,primitives:[{navigate_from_sr:{id:1,filter:{role:["328","330"]}},navigate_from_rel:{id:2}}],attributes:["name","label","revision","owner","type","originated","ds6w:responsible"],patterns:{ReportsFromInputs:[{id:"1"},{id:"2"}]},version:3,label:`RGN Report Wizard - ${a} - ${Date.now()}`}),u=await i.service3DSpace(t);return o.authenticatedRequest("POST",`${u.url}/cvservlet/navigate?SecurityContext=${d.SecurityContext}`,"json",(new i.HeadersBuilder).createHeader(t.getSecurityContext()),{type:"json",payload:l})}}),define("DS/CATRgnWidgetCommons/RecentsManager",["require","exports","DS/PlatformAPI/PlatformAPI","DS/CATRgnWidgetCommons/restClient/SearchServices"],function(e,t,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RecentsManager=void 0;const o=100;function s(e){const t=localStorage.getItem(e),n=t?JSON.parse(t):{version:"1.1",items:[]};switch(n.version){case"1.0":n.items.reverse(),n.version="1.1";case"1.1":return n;default:throw new Error(`Unsupported recents version ${n.version}`)}}t.RecentsManager=class{constructor(e,t){const i=n.getUser();this.key=`${e}_Recents_${t.getTenant()}_${i.login}`}async pushContent(e){if(0==e.length)return;const t=s(this.key),n=new Set(e.map(e=>e.id));t.items=t.items.filter(e=>!n.has(e.id));const i=t.items.length+e.length-o;i>0&&t.items.splice(t.items.length-i,i);const r=e.map(e=>({id:e.id,kind:e.metaType}));t.items=r.concat(t.items),localStorage.setItem(this.key,JSON.stringify(t))}async getContent(e){const t=s(this.key);return e&&e.length>0?t.items.filter(t=>e.includes(t.kind)):t.items}async loadItemsWithFacets(e){var t,n,o,s;const r=await this.getContent(e),a=Array.from(new Set(r.map(e=>e.id))),d=0==a.length?void 0:await i.getObjectsInfos(a),l=new Set(null===(t=null==d?void 0:d.results)||void 0===t?void 0:t.map(e=>i.getAttributeValue(e,"resourceid"))),u=a.length==l.size&&a.every(e=>l.has(e))?void 0:await i.getRecentObjects(),c=new Map;(null!==(n=null==u?void 0:u.results)&&void 0!==n?n:[]).reduce((e,t)=>e.set(i.getAttributeValue(t,"resourceid"),t),c),(null!==(o=null==d?void 0:d.results)&&void 0!==o?o:[]).reduce((e,t)=>e.set(i.getAttributeValue(t,"resourceid"),t),c);const g=[],p=[];for(const e of r){const t=c.get(e.id);if(t){const n=i.getFirstAttributeNodeNamed(t,["ds6w:what/ds6w:type","ds6w:type"]),o=null!==(s=null==n?void 0:n.value)&&void 0!==s?s:"",r="string"==typeof(null==n?void 0:n.dispValue)?null==n?void 0:n.dispValue:o;g.push({...e,title:i.getAttributeValue(t,"ds6w:label"),modified:new Date(i.getAttributeValue(t,"ds6w:when/ds6w:modified")),type:o,dispType:"string"==typeof r?r:o})}else p.push(e)}return{withFacets:g,withoutFacets:p}}}}),define("DS/CATRgnWidgetCommons/RgnWidgetSettings",["require","exports","DS/CATRgnWidgetCommons/utils/AsyncExecutor","DS/CATRgnWidgetCommons/ListManager","DS/CATRgnWidgetCommons/restClient/DictionnaryServices"],function(e,t,n,i,o){"use strict";t.RgnWidgetSettings=void 0;const s=window.widget,r=5;return class{constructor(){this.widget=s,this.appId=s.data.appId,this.widgetId=s.id,this.version=s.metas.version,this.widgetBody=s.body,this.platformId=s.getValue("x3dPlatformId")||"OnPremise",this.language=s.lang,this.listManager=i,s.onDestroy||(s.onDestroy={}),this.onDestroy=s.onDestroy,this.asyncExecutor=new n.AsyncExecutor(r)}setValue(e,t){s.setValue(e,t)}getValue(e){return s.getValue(e)}addEvent(e,t){s.addEvent(e,t)}getPreference(e){return s.getPreference(e)}addPreference(e){s.addPreference(e)}loadDictionary(){var e;this.dictionaryNls=o.getDictionaryNLS(null!==(e=s.lang)&&void 0!==e?e:"en").then(e=>this.dictionaryLoaded=e)}getCredentials(){return new Promise(e=>{const t=s.getValue("xPref_CREDENTIAL");t?(this.credentials=t,e(t)):s.addEvent("onUpdatePreferences",t=>{t.forEach(t=>{"xPref_CREDENTIAL"===t.name&&(this.credentials=t.value,e(t.value))})})})}}}),define("DS/CATRgnWidgetCommons/TaggerProxyFilter",["require","exports","DS/TagNavigatorProxy/TagNavigatorProxy","DS/TreeModel/BaseFilter","DS/CATRgnWidgetCommons/restClient/SearchServices","i18n!DS/CATRgnWidgetCommons/assets/nls/CATRgnWidgetCommons"],function(e,t,n,i,o,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TaggerProxyFilter=void 0;t.TaggerProxyFilter=class{constructor(e,t){this._cachedSubjects={},this.webClientOptions=t,this.widgetSettings=e.widgetSettings,this._proxy=n.createProxy({widgetId:this.widgetSettings.widgetId,tenant:this.webClientOptions.getTenant(),filteringMode:"WithFilteringServices",disableAutoComplete:!1,proxyDisplayName:"Report"}),this._proxy.addEvent("onFilterSubjectsChange",e=>this.onFilterSubjectsChange(e)),this.model=e.model,this.model&&(this.model.getFilterManager().registerFilter("6wTags",r),this.model.addEventListener("removeChild",e=>{this.removeDataFromProxy(e.data.nodeModel.options.grid)}),this.model.addEventListener("nodeModelUpdate",e=>{var t;this.modifyDataInProxy(Object.keys(null!==(t=e.data.attributes)&&void 0!==t?t:[]),e.data.nodeModel.options.grid)}))}onFilterSubjectsChange(e){console.log(e);const t=e.filteredSubjectList||[];this.model.setFilterModel({physicalid:{filterId:"6wTags",filterModel:{filteredIds:t}}})}removeDataFromProxy(e){delete this._cachedSubjects[e.id],this._proxy.setSubjectsTags(this._cachedSubjects)}async addDataToProxy(e){e.forEach(e=>{var t,n,i,o;this._cachedSubjects[e.id]=[],null===(t=this._cachedSubjects[e.id])||void 0===t||t.push({sixw:"ds6w:what/ds6w:status",object:`Report Model.${e.current}`,dispValue:s[`lifeCycle.${e.current.toUpperCase()}`]},{sixw:"ds6w:who/ds6w:responsible",object:e.ownerFullName}),e.fileName&&(null===(n=this._cachedSubjects[e.id])||void 0===n||n.push({sixw:"ds6w:what/ds6w:docExtension",object:null!==(o=null===(i=/\.(.*)/.exec(e.fileName))||void 0===i?void 0:i[1])&&void 0!==o?o:""}))}),this._cachedSubjects=await this.filterFacets(e,this._cachedSubjects),this._proxy.setSubjectsTags(this._cachedSubjects)}async filterFacets(e,t){var n;return null===(n=(await o.getObjectsInfos(e.map(e=>e.id))).results)||void 0===n||n.map(e=>{const n=o.getAttributeValue(e,"resourceid");e.attributes.filter(e=>"ds6w_facet"===e.format).map(e=>{var i,o;(null===(i=t[n])||void 0===i?void 0:i.find(t=>t.sixw===e.name))||null===(o=t[n])||void 0===o||o.push({sixw:e.name,object:e.value,dispValue:e.dispValue})})}),t}async modifyDataInProxy(e,t){let n,i,o;e.forEach(e=>{var r,a,d;if("current"==e?(n="ds6w:what/ds6w:status",i=`Report Model.${t.current}`,o=s[`lifeCycle.${t.current.toUpperCase()}`]):"fileName"==e&&(n="ds6w:what/ds6w:docExtension",i=t.fileName?null===(r=/\.(.*)/.exec(t.fileName))||void 0===r?void 0:r[1]:""),i&&n){const e=null===(a=this._cachedSubjects[t.id])||void 0===a?void 0:a.find(e=>e.sixw===n);e?(e.object=i,e.dispValue=o):null===(d=this._cachedSubjects[t.id])||void 0===d||d.push({sixw:n,object:i})}}),this._proxy.setSubjectsTags(this._cachedSubjects)}};const r=i.inherit({isDataFiltered:function(e){const t=e.getAttributeValue("id");return!(!this.filterModel||!this.filterModel.filteredIds)&&-1===this.filterModel.filteredIds.indexOf(t)},isEmpty:function(){return void 0===this.filterModel.filteredIds}})}),define("DS/CATRgnWidgetCommons/restClient/CommonServices",["require","exports","DS/RGNServices/RGNServices","DS/RGNServices/WAFDataUtil","DS/CATRgnWidgetCommons/restClient/SchemaServices","DS/RGNServices/Alert","DS/CATRgnWidgetCommons/restClient/PeopleServices","DS/LifecycleCmd/MessageMediator","DS/PlatformAPI/PlatformAPI","i18n!DS/CATRgnWidgetCommons/assets/nls/CATRgnWidgetCommons"],function(e,t,n,i,o,s,r,a,d,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPersonFullName=t.listenLifeCycleEvents=t.getNLSTypeFromInput=t.getNLSType=t.getTemplateTypesAndNls=t.hasRgdLicense=t.getService=t.service3DSpace=t.createHeaders=t.getCSRFToken=t.isBulkGetPartialSucessStatus=t.isPartialSuccessStatus=t.HeadersBuilder=void 0;class u{constructor(e={}){this.headers=e}addSecurityContext(e){return this.headers.SecurityContext=e,this}add3DSpaceCsrfToken(e){return this.headers[e.name]=e.value,this}addLanguage(){return void 0!==window.widget&&window.widget.lang&&(this.headers||(this.headers={}),this.headers["Accept-Language"]=window.widget.lang),this}build(){return this.headers}createHeader(e){return this.addSecurityContext(e).addLanguage().build()}createHeaderWithCsrfToken(e,t){return this.addSecurityContext(e).add3DSpaceCsrfToken(t).addLanguage().build()}}async function c(e){var t;if(!e){const i=(null===(t=widget.getValue)||void 0===t?void 0:t.call(widget,"x3dPlatformId"))||"OnPremise";e=await n.get3DSpaceURL(i)}return i.authenticatedRequest("GET",`${e}/resources/v1/application/CSRF`,"json",{}).then(e=>e.csrf)}t.HeadersBuilder=u,t.isPartialSuccessStatus=function(e){return 207==e.code},t.isBulkGetPartialSucessStatus=function(e){return 207==e.code},t.getCSRFToken=c,t.createHeaders=async function(e,t,n){return(new u).createHeaderWithCsrfToken(e.getSecurityContext(),await c(n))},t.service3DSpace=async function(e){return{url:await n.get3DSpaceURL(e.getTenant()),tenant:e.getTenant()}},t.getService=async function(e){var t;const i=(null===(t=widget.getValue)||void 0===t?void 0:t.call(widget,"x3dPlatformId"))||"OnPremise";return{url:await n.getServiceURL(e,i),tenant:i}},t.hasRgdLicense=async function(e,t){return i.authenticatedRequest("GET",e.url+"/resources/v1/modeler/dsrgn/internal/hasLicense/rgd","json",t)},t.getTemplateTypesAndNls=async function(e,t){const n=await e;let i=["Report Model"];const s=await o.getTemplateTypeProperties(t);return s.derivative.length>0&&(i=i.concat(s.derivative.split(","))),i.map(e=>{var t;return{value:e,label:null!==(t=n[`Type.${e}`])&&void 0!==t?t:""}})},t.getNLSType=function(e,t){return null==t?void 0:t[`Type.${e}`]},t.getNLSTypeFromInput=function(e,t){var n,i;if(t)switch(e.nature){case"primitive":return l[e.type];case"plmrel":return null!==(n=t[`Relationship.${e.type}`])&&void 0!==n?n:e.type;case"plmbus":return null!==(i=t[`Type.${e.type}`])&&void 0!==i?i:e.type}},t.listenLifeCycleEvents=function(e,t){a.addEvent("LC_CmdMgr_postExecCmd",n=>{switch(n.cmd.name){case"delete_command":{const i=n.cmd.context.getSelectedNodes().map(e=>e.getLabel());d.publish(`DeletedObjectsEvent/${t}`,{deletedObjects:i,originWidgetId:e});break}}}),d.subscribe(`DeletedObjectsEvent/${t}`,e=>{e.originWidgetId!==widget.id&&s.error(l.interWidgetDeletion+JSON.stringify(e.deletedObjects))})},t.getPersonFullName=async function(e,t,n){const i=await r.getPersonInfos(e,t,n);return`${i.firstname} ${i.lastname}`}}),define("DS/CATRgnWidgetCommons/restClient/DictionnaryServices",["require","exports","DS/RGNServices/WAFDataUtil","DS/CATRgnWidgetCommons/restClient/CommonServices"],function(e,t,n,i){"use strict";async function o(){const e=await i.getService("3DSpace"),t=(await n.authenticatedRequest("GET",e.url+"/resources/dictionary/Dictionary?tenant="+e.tenant,"json",{})).Dictionary.Types,o=new Map;return Object.values(t).map(e=>{e.Parent&&o.set(e.Name,e.Parent)}),o}function s(e,t){const n=new Set;for(let i=t;""!=i&&void 0!==i&&!n.has(i);i=e.get(i))n.add(i);return Array.from(n.values())}Object.defineProperty(t,"__esModule",{value:!0}),t.getTypeParentsFromMap=t.getTypeParents=t.computeTypeHierarchy=t.getDictionaryNLS=t.getTypeAttributes=t.getTypeInfo=void 0,t.getTypeInfo=async function(e,t){const o=await i.service3DSpace(t);return n.authenticatedRequest("POST",o.url+"/resources/dictionary/getTypeInfo?parentInfo=true&tenant="+o.tenant,"json",{},{type:"json",payload:e})},t.getTypeAttributes=async function(e,t){const o=await i.service3DSpace(t);return n.authenticatedRequest("GET",o.url+"/resources/dictionary/class/"+e+"/attributes?inherited=true","json",{})},t.getDictionaryNLS=async function(e){const t=await i.getService("3DSpace");return n.authenticatedRequest("GET",t.url+"/resources/dictionary/DictionaryNLS?tenant="+t.tenant+"&lang="+e,"json",{}).then(e=>e.DictionaryNLS)},t.computeTypeHierarchy=o,t.getTypeParents=async function(e){return s(await o(),e)},t.getTypeParentsFromMap=s}),define("DS/CATRgnWidgetCommons/restClient/SearchServices",["require","exports","DS/RGNServices/WAFDataUtil","DS/CATRgnWidgetCommons/restClient/DictionnaryServices","DS/CATRgnWidgetCommons/restClient/CommonServices","module","DS/PlatformAPI/PlatformAPI","DS/Logger/Logger"],function(e,t,n,i,o,s,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getObjectsType=t.getCompatibleTemplatesFromInputTypes=t.getObjectsInfos=t.getRecentObjects=t.getAttributeValue=t.getFirstAttributeNodeNamed=void 0;const d=r.getUser(),l=d?d.login:"",u=a.getLogger(s);function c(e,t){return e.attributes.find(e=>t.includes(e.name))}async function g(e){const t=await o.getService("3DSearch"),i={query:e.map(e=>"physicalid:"+e).join(" OR "),label:"RGN - "+l+" - "+Date.now(),select_file:["icon","thumbnail_2d"],select_predicate:["ds6w:label","ds6w:type","ds6w:modified","ds6w:what/ds6w:typeQualifiedName","ds6w:when/ds6w:modified","ds6w:identifier"],tenant:t.tenant,with_nls:!0};return n.authenticatedRequest("POST",t.url+"/search","json",{},{type:"json",payload:i})}t.getFirstAttributeNodeNamed=c,t.getAttributeValue=function(e,t){var n,i;return null!==(i=null===(n=c(e,[t]))||void 0===n?void 0:n.value)&&void 0!==i?i:""},t.getRecentObjects=async function(){const e=await o.getService("3DSearch"),t={label:"RGN - "+l+" - "+Date.now(),select_file:["icon","thumbnail_2d"],select_predicate:["ds6w:label","ds6w:type","ds6w:modified"],tenant:e.tenant,with_nls:!0};return n.authenticatedRequest("POST",e.url+"/recent","json",{},{type:"json",payload:t})},t.getObjectsInfos=g,t.getCompatibleTemplatesFromInputTypes=async function(e){let t=[];try{await Promise.all(e.map(async e=>{const n=await i.getTypeParents(e);t=t.concat(n)}))}catch(n){t=e,u.debug("Dictionary Services are not working. ",n)}const s=(t=(t=[...new Set(t)]).map(e=>'ds6wg_58_input_32_type:"'+e+'"')).join(" OR "),r=await o.getService("3DSearch"),a={query:s,select_predicate:["ds6w:label","ds6wg:revision","ds6w:identifier","originated"],label:"RGN Report Wizard - "+l+" - "+Date.now(),tenant:r.tenant};return n.authenticatedRequest("POST",r.url+"/search","json",{},{type:"json",payload:a})},t.getObjectsType=async function(e){const t=(await g(e)).results;return t?t.map(e=>{let t="";return e.attributes.some(e=>"ds6w:what/ds6w:type"===e.name&&(t=e.value,!0)),t}):[]}}),define("DS/CATRgnWidgetCommons/restClient/SchemaServices",["require","exports","DS/RGNServices/WAFDataUtil","DS/CATRgnWidgetCommons/restClient/CommonServices"],function(e,t,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getOutputFormatPolicies=t.getTemplateTypeProperties=void 0,t.getTemplateTypeProperties=async function(e){const t=await(0,i.service3DSpace)(e);return n.authenticatedRequest("GET",`${t.url}/resources/rgn/template/type/properties`,"json",{})},t.getOutputFormatPolicies=function(e){return n.authenticatedRequest("GET",`${e.url}/resources/rgn/outputformat/policies`,"json",{}).then(e=>e.filter(e=>"Version"!==e))}}),define("DS/CATRgnWidgetCommons/CollectionUtils",["require","exports","DS/RGNServices/Alert","i18n!DS/CATRgnWidgetCommons/assets/nls/CATRgnWidgetCommons","DS/CATRgnWidgetCommons/ModelElement","DS/CATRgnWidgetCommons/restClient/TemplateServices","DS/CATRgnWidgetCommons/restClient/CommonServices","DS/CATRgnWidgetCommons/restClient/ReportServices","DS/CATRgnWidgetCommons/restClient/OutputFormatServices","module","DS/Logger/Logger","UWA/Core"],function(e,t,n,i,o,s,r,a,d,l,u,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CollectionUtils=void 0;const g=30;t.CollectionUtils=class{constructor(e){var t;this.list=[],this.model=e.model,this.recents=e.recents,this.key=e.key,this.webClientOptions=e.webClientOptions,this.logger=u.getLogger(l),this.widgetSettings=e.widgetSettings,(t=this).model.subscribe({event:"addChild"},e=>{const n=e;t.addElement(n);const i=e.target.getTreeDocument().getRoots().length;i>g&&e.target.getTreeDocument().getNthRoot(i-1).remove()}),t.model.subscribe({event:"removeRoot"},e=>{const n=e.data.nodeModel.options.grid;t.removeElement(n.id)}),t.model.subscribe({event:"removeChild"},e=>{const n=e.data.nodeModel.options.grid;t.removeElement(n.id)}),t.model.subscribe({event:"attributeChanged"},async e=>{var l,u,g,p,m;const h=await r.service3DSpace(t.webClientOptions),v=await r.createHeaders(t.webClientOptions,!0),C="tree"===e.data.changedAttribute?"title":null!==(l=e.data.changedAttribute)&&void 0!==l?l:"",f=null!==(u=e.data.changedAttributeValue)&&void 0!==u?u:"",y=t.getElementById(e.data.nodeModel.options.grid.id),S={};let w;if(S[C]=f,""!=C)try{switch(null==y?void 0:y.metaType){case o.MetaType.Template:w=await s.updateTemplate(h,v,y.id,S);break;case o.MetaType.Report:{w=await a.updateReport(h,v,y.id,S);const t=await a.getStatus(h,v,y.id),n=await a.generationStatus(h,v,[y.id]),i={grid:{title:null===(g=w.reports[0])||void 0===g?void 0:g.title,uptodate:t.uptodate,generation:null===(p=n.reports[0])||void 0===p?void 0:p.generation}},o=null===(m=w.reports[0])||void 0===m?void 0:m.targetDocument,s=y;if(o&&s.targetDocument&&"title"==C){const e=Object.entries(s.targetDocument).map(([e])=>[e,Object.prototype.hasOwnProperty.call(o,e)?o[e]:void 0]);c.extend(i.grid,{targetDocument:Object.fromEntries(e)})}e.data.nodeModel.updateOptions(i);break}case o.MetaType.OutputFormat:w=await d.updateOutputFormat(h,v,y.id,S)}(null==w?void 0:w.status.success)&&n.info(i.UPDATE_SUCCESSFUL)}catch(e){n.error(i.UPDATE_FAILED)}}),t.model.subscribe({event:"nodeModelUpdate"},e=>{var n;const i=t.getElementById(e.data.nodeModel.options.grid.id),o=Object.keys(null!==(n=e.data.attributes)&&void 0!==n?n:[]);i&&o.forEach(t=>{var n,o,s,r,a,d,l,u,c,g,p,m,h,v,C,f;switch(t){case"current":i.current=null!==(s=null===(o=null===(n=e.data)||void 0===n?void 0:n.attributes)||void 0===o?void 0:o[t])&&void 0!==s?s:"unknown";break;case"description":i.description=null!==(d=null===(a=null===(r=e.data)||void 0===r?void 0:r.attributes)||void 0===a?void 0:a[t])&&void 0!==d?d:"";break;case"tree":i.title=null!==(c=null===(u=null===(l=e.data)||void 0===l?void 0:l.attributes)||void 0===u?void 0:u[t])&&void 0!==c?c:"",e.data.nodeModel.updateOptions({grid:{title:null===(p=null===(g=e.data)||void 0===g?void 0:g.attributes)||void 0===p?void 0:p[t]}});break;case"status":case"message":{const n=i;n.generation&&(n.generation[t]=null!==(v=null===(h=null===(m=e.data)||void 0===m?void 0:m.attributes)||void 0===h?void 0:h[t])&&void 0!==v?v:"unknown");break}case"targetDocument":i.targetDocument=null===(f=null===(C=e.data)||void 0===C?void 0:C.attributes)||void 0===f?void 0:f[t]}})}),t.model.subscribe({event:"empty"},()=>{}),t.model.subscribe({event:"sortChildren"},()=>{})}addElement(e){const t=e.data.nodeModel.options.grid;this.removeElementFromList(t.id),e.target.getTreeDocument().getNthRoot(0).options.grid.id===e.data.nodeModel.options.grid.id?this.list.unshift(t):this.list.push(t),this.recents.pushContent([t]),this.widgetSettings.listManager.saveList(this.key,this.getIds(),this.widgetSettings)}getElements(){return this.list}getIds(){return this.list.map(e=>e.id)}getElementById(e){return this.list.find(t=>t.id==e)}removeElement(e){this.removeElementFromList(e),this.widgetSettings.listManager.saveList(this.key,this.getIds(),this.widgetSettings)}removeElementFromList(e){const t=this.list.findIndex(t=>t.id==e);t>=0&&t<this.list.length&&this.list.splice(t,1)}}}),define("DS/CATRgnWidgetCommons/ModelManager",["require","exports","DS/TreeModel/TreeDocument","DS/CATRgnWidgetCommons/CollectionUtils","DS/CATRgnWidgetCommons/ModelElement","DS/RGNServices/Alert","DS/CATRgnWidgetCommons/restClient/CommonServices"],function(e,t,n,i,o,s,r){"use strict";return class{constructor(e,t,o,s){this.model=new n({useAsyncPreExpand:!0}),this.webClientOptions=o,this.settings=s,this.collection=new i.CollectionUtils({model:this.model,recents:t,key:e,webClientOptions:this.webClientOptions,widgetSettings:s})}getModel(){return this.model}getCollection(){return this.collection}getFromModel(e){return this.collection.getElementById(e)}async addToModel(e,t,n,i){const s=[];e.forEach(async e=>{const n=this.model.getRoots().find(t=>t.options.grid.id===e.id);void 0!==n&&this.model.removeRoot(n),s.push(new o.ModelElement(e,t,this.webClientOptions).getNode())}),this.model.prepareUpdate(),n?this.model.addChild(s,0):this.model.addChild(s),this.model.pushUpdate(),this.loadDispType(i)}async loadDispType(e){const t=await e,n=new Set;for(const e of this.getModel().getRoots()){const i=e.options.grid,o=r.getNLSType(i.type,t);i.dispType||(o?null==e||e.updateOptions({grid:{dispType:o}}):n.add(i.type))}if(0!=n.size){const e=`The type "${[...n].join(", ")}" wasn't found in the dictionnary`;s.error(e),console.error(e)}}removeFromModel(e){this.model.prepareUpdate(),e.forEach(e=>{this.model.removeRoot(e)}),this.model.pushUpdate()}setTaggerProxyFilter(e){this.tagger=e}}});