define("DS/ENOCharacteristicsWebApp/controls/SearchConfiguration",["UWA/Core","UWA/Utils/InterCom","UWA/Class/Model"],function(e,t,i){"use strict";var s=function(e){this.socketName="search_socket_"+(new Date).getTime(),this.socket=new t.Socket(this.socketName,{dispatchRetryInterval:5}),this.socket.subscribeServer("SearchComServer"),this.listener=this.objectsSelected.bind(this),this.socket.addListener("Selected_Objects_search",this.listener)};return s.prototype.destroy=function(){var e={};e.widget_id=widget.id,this.socket.dispatchEvent("unregisterSearchContext",e),this.socket.unsubscribeServer("SearchComServer"),this.socket.removeListener("Selected_Objects_search",this.listener),this.socket.disconnect()},s.prototype.options=function(e,t,i,s,r){var c={};if(c.title=e,c.multiSel=!0,c.mode="furtive",c.app_socket_id=this.socketName,"undefined"!=typeof widget&&(c.widget_id=widget.id),c.default_with_precond=!0,c.show_precond=!1,c.idcard_activated=!1,c.default_search_criteria="",c.charCategory=i,t){c.precond="(",(t=t.split(",")).forEach(function(e,i){0!==i&&(c.precond+=" OR "),c.precond+='flattenedtaxonomies:"types/'+e.trim()+'"',c.precond+=" AND ",t[0].indexOf("Characteristic Master")>=0?c.precond+="current==Released":c.precond+="(current==Release OR current==RELEASED)",c.precond+=" AND latestrevision==TRUE"});var o="";if(r.length>0){for(var n="",a=0;a<r.length;a++)n+=0==a?"NOT mxid:":" AND NOT mxid:",n+=r[a];o=" AND ("+n+")"}c.precond+=o,c.precond+=")"}return s&&(c.default_search_criteria=s),c},s.prototype.activate=function(e,t,i,s,r,c){var o=this.options(e,t,i,r,c);this.callback=s;var n={};n.widget_id=widget.id,this.socket.dispatchEvent("unregisterSearchContext",n),this.socket.dispatchEvent("RegisterContext",o),this.socket.addListener("onCloseTransient",function(){this.socket.removeListener("onCloseTransient"),this.socket.dispatchEvent("UnregisterContext",n)}.bind(this)),this.socket.dispatchEvent("InContextSearch",o)},s.prototype.isAvailable=function(){return e.is(this.socket)},s.prototype.objectsSelected=function(e){var t=[];if(this.callback){for(var s=0;s<e.length;s++){var r={},c=new i(e[s]);r.id=c.get("id"),r.owner=c.get("ds6w:originator"),r.name=c.get("ds6w:identifier"),r.policy=c.get("ds6w:policy"),r.originated=c.get("ds6w:created"),r["attribute[Title]"]=c.get("ds6w:label"),r.type=c.get("ds6w:type"),t.push(r)}this.callback(t)}},s});