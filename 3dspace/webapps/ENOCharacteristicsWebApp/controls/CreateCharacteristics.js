define("DS/ENOCharacteristicsWebApp/controls/CreateCharacteristics",["DS/UIKIT/Input/Text","UWA/Core","DS/UIKIT/Form","DS/UIKIT/Input/Button","DS/UIKIT/Alert","DS/UIKIT/Modal","DS/UIKIT/Input/ButtonGroup","DS/UIKIT/Input/Date","DS/UIKIT/Input/Toggle","DS/UIKIT/Input/Select","DS/ENOFrameworkPlugins/jQuery","DS/ENOCharacteristicsWebApp/utils/RequestUtils","DS/ENOCharacteristicsWebApp/utils/Constants","i18n!DS/ENOCharacteristicsWebApp/assets/nls/ENOCharacteristicsWebAppNLS","DS/ENOCharacteristicsWebApp/controls/SearchConfiguration","DS/ENOCharacteristicsWebApp/utils/AlertManager","DS/UIKIT/Mask","DS/ENOCharacteristicsWebApp/utils/UIUtil"],function(e,t,a,i,l,n,s,o,r,d,c,u,m,h,p,g,I,v){"use strict";return a.extend({urlRoot:u.getGLSWebServiceURL()+m.CHARACTERISTICS_ENDPOINT,mChartcsModalWindow:void 0,severityButtonGroup:null,minimal:null,currentModelObjectForRefresh:void 0,createOrEditFlag:!0,mRootModel:null,mFormField:null,mTestMethodType:null,mInputValues:{ObjectID:""},init:function(e,t,a){a.mRootItemModelObserver.listenTo(e,"DS.GLS.UpdateTestMethodField",this.updateTestMethodField.bind(this)),this.mTestMethodType=u.getEnableTestMethodSpecificationFlag(),this.mTitle="Results - Test Methods in Released state",this.mSearchConfig=new p(this.mTitle),this.mTestMethodIds=[],this.mRootModel=e,this._parent({className:"horizontal",grid:"2 12",fields:[{type:"html",name:"CreateCharBody",id:"CreateCharBody",html:"<div id='CharFormDiv'></div>"}],events:{onInvalid:function(){}}}),this.pushFormContent(t,a)},processDisplayUnit:function(e){var t=[];if(e&&UWA.is(e,"array"))for(var a=0;a<e.length;a++){var i={},l=e[a][a][1],n=e[a][a][0];i.value=l,i.label=n,e[a][a][2]&&"PREFERRED"===e[a][a][2]&&t.length>0?t.splice(0,0,i):t.push(i)}return t},createBody:function(t,a,l){var n=null;this.dimensionSelect=null;var s,o=null,p=null,g=null,I=null,v=null,T=null,x={},C=[],M=null,R=null;this.dimensionPreferenceJson=[],this.displayUnits=[];for(var f=0;f<t.length;f++)M=t[f][f].substring(1,t[f][f].indexOf(",")),R=t[f][f].substring(t[f][f].indexOf(",")+2,t[f][f].indexOf("]")),(x={}).value=R,x.label=M,C.push(x);for(f=0;f<C.length;f++)(s={}).value=C[f].value,s.label=C[f].label,this.dimensionPreferenceJson.push(s);this.dimensionPreferenceJson[0].selected=!0;var S=this.mRootModel.mDimensionModel.getDisplayUnitForDiemension(this.dimensionPreferenceJson[0].value);this.displayUnits=this.processDisplayUnit(S);var b=this,w=this;return UWA.createElement("div",{html:[{tag:"table",class:"form",html:[{tag:"tr",html:[{tag:"td",class:"createLabelRequired",text:h.Name},{tag:"td",class:"createInputField",html:[n=new e({name:"nameInput",placeholder:"",id:"nameInput",disabled:!0})]},{tag:"td",class:"createInputField",html:[new r({type:"checkbox",value:h.AutoName,checked:!0,id:"autoNameCheckBox",events:{onClick:function(){n.isDisabled()?n.enable():(n.disable(),c("#nameInput").val(""))}}})]}]},{tag:"tr",html:[{tag:"td",class:"createLabelRequired",text:h.Title},{tag:"td",class:"createInputField",html:[new e({name:"titleInput",placeholder:"",id:"titleInput"})]}]},{tag:"tr",html:[{tag:"td",class:"createLabel",text:h.Description},{tag:"td",class:"createInputField",html:[new e({name:"descriptionInput",multiline:!0,placeholder:"",resize:"none",id:"descriptionInput"})]}]},l,{tag:"tr",html:[{tag:"td",class:"createLabel",text:h.Priority},{tag:"td",class:"createInputField",html:[new e({name:"priorityInput",placeholder:"",id:"priorityInput",value:0})]}]},{tag:"tr",html:[{tag:"td",class:"createLabelRequired",text:h.Dimension},{html:[this.dimensionSelect=new d({name:"dimensionSelect",id:"dimensionSelect",placeholder:!1,options:b.dimensionPreferenceJson,events:{onChange:function(){var e,t=this,a=t.getValue("dimensionSelect");a=a instanceof Array?a[0]:a;try{e=w.mRootModel.mDimensionModel.getDisplayUnitForDiemension(a);var i=w.processDisplayUnit(e);o.remove(),o.add(i),S=i}catch(e){var l=u.getGLSWebServiceURL()+m.CHARACTERISTICS_ENDPOINT;u.send3DSpaceRequest(l+m.CHARACTERISTICS_GET_DISPLAY_UNIT+"?dimension="+a,"GET",{type:"json",headers:{"Content-type":"application/x-www-form-urlencoded"}},function(e){for(var t={},a=[],i=null,l=null,n=0;n<e.length;n++)i=e[n][n][0],l=e[n][n][1],(t={}).value=l,t.label=i,a.push(t);e.length>0&&(a[0].selected=!0),o.remove(),o.add(a),S=a},function(e){t.dataError})}var n=c("#displayUnitSelect").closest("div");n.show(),p.hide(),o.enable(),g.enable(),v.enable(),T.enable(),c("#minimalRow").show(),c("#maximalRow").show(),c("#multipleRow").show(),c("#lowerSpecificationLimit").show(),c("#lowerRoutineReleaseLimit").show(),c("#upperRoutineReleaseLimit").show(),c("#upperSpecificationLimit").show(),c("#nominalValueSelect").replaceWith('<input type="text" id="NominalText" class="dynamicTextBox">'),C("NominalText"),C("MinimalText"),C("MaximalText"),C("MultipleText"),c("#lowerSpecificationText").val(""),c("#upperSpecificationText").val(""),c("#lowerRoutineReleaseLimitText").val(""),c("#upperRoutineReleaseLimitText").val(""),"SubjectivityParameter"===a?(c("#nominalValueLabelId").attr("class","createLabelRequired"),c("#multiValueLabelId").attr("class","createLabelRequired")):(c("#nominalValueLabelId").attr("class","createLabel"),c("#multiValueLabelId").attr("class","createLabel"));for(var s=g.getOptions(),r=g.getSelection()[0].value,d={value:m.MULTIPLE_VALUE,label:h.MultipleValue},I=0;I<s.length;I++)if("Simple Value"===s[I].value&&r!==s[I].value){g.setValue(I);break}if(a===m.STRING_PARAMETER?g.add(d):g.remove(d),"BooleanParameter"===a){o.disable(),g.disable(),c("#minimalRow").hide(),c("#maximalRow").hide(),c("#multipleRow").hide(),c("#lowerSpecificationLimit").hide(),c("#lowerRoutineReleaseLimit").hide(),c("#upperRoutineReleaseLimit").hide(),c("#upperSpecificationLimit").hide();var x=c("<select ></select>").attr("id","nominalValueSelect").attr("class","select-choices form-control").attr("name","nominalValueSelect");x.append("<option value='true'>TRUE</option>").append("<option value='false'>FALSE</option>"),c("#NominalText").replaceWith(x)}else if("RealParameter"===a||"IntegerParameter"===a)n.hide(),p.show();else if("CMYKFormattedStringParameter"===a)o.disable(),g.disable(),v.check(!0),T.check(!0),v.disable(),T.disable(),c("#NominalText").attr("placeholder","Ex- [0,0,0,0]");else if("HEXFormattedStringParameter"===a)o.disable(),g.disable(),v.check(!0),T.check(!0),v.disable(),T.disable(),c("#NominalText").attr("placeholder","Ex- #FFFF00");else if("RGBFormattedStringParameter"===a)o.disable(),g.disable(),v.check(!0),T.check(!0),v.disable(),T.disable(),c("#NominalText").attr("placeholder","Ex- [125,250,110]");else if("StringParameter"===a||"SubjectivityParameter"===a)o.disable(),"SubjectivityParameter"===a&&g.disable(),c("#minimalRow").hide(),c("#maximalRow").hide(),c("#lowerSpecificationLimit").hide(),c("#lowerRoutineReleaseLimit").hide(),c("#upperRoutineReleaseLimit").hide(),c("#upperSpecificationLimit").hide();else if("COLORParameter"===a){c("#NominalText").replaceWith('<td><input type="text" size="5" id="redNominalText" class="createInputField"></td><td><input type="text" size="5" id="greenNominalText" class="createInputField"></td><td><input type="text" size="5" id="blueNominalText" class="createInputField"></td>'),c("#MinimalText").replaceWith('<td><input type="text" size="5" id="redMinimalText" class="createInputField"></td><td><input type="text" size="5" id="greenMinimalText" class="createInputField"></td><td><input type="text" size="5" id="blueMinimalText" class="createInputField"></td>'),c("#MaximalText").replaceWith('<td><input type="text" size="5" id="redMaximalText" class="createInputField"></td><td><input type="text" size="5" id="greenMaximalText" class="createInputField"></td><td><input type="text" size="5" id="blueMaximalText" class="createInputField"></td>'),c("#MultipleText").replaceWith('<td><input type="text" size="5" id="redMultipleText" class="createInputField"></td><td><input type="text" size="5" id="greenMultipleText" class="createInputField"></td><td><input type="text" size="5" id="blueMultipleText" class="createInputField"></td>')}function C(e){var t=c(document.createElement("input")).attr({type:"text",class:"form-control form-control-root",name:"singleText",id:e});c("#"+e).replaceWith("<td>"+c(t)[0].outerHTML+"</td>"),c("#red"+e).replaceWith("<td>"+c(t)[0].outerHTML+"</td>"),c("#blue"+e).hide(),c("#green"+e).hide()}}}})]},{tag:"td",html:[new i({name:"dimensionChooser",id:"dimensionChooser",value:"",icon:"fonticon-dot-3",events:{onClick:function(){var e=w.mRootModel.mDimensionModel.mDimensionSet;b.pushDimensionChooserContent(e)}}})]}]},{tag:"tr",html:[{tag:"td",id:"displayUnit",class:"createLabel",text:h.DisplayUnit},{html:[o=new d({name:"displayUnitSelect",id:"displayUnitSelect",placeholder:!1,options:this.displayUnits,events:{onChange:function(){var e=b.getValue("displayUnitSelect");if("COLORParameter"===b.getValue("dimensionSelect")){function t(e){var t=c(document.createElement("input")).attr({type:"text",size:"5",name:e,id:e});c("#red"+e).replaceWith(t),c("#blue"+e).hide(),c("#green"+e).hide()}function a(e){var t=c(document.createElement("input")).attr({type:"text",size:"5",name:"red"+e,id:"red"+e}),a=c(document.createElement("input")).attr({type:"text",size:"5",name:"green"+e,id:"green"+e}),i=c(document.createElement("input")).attr({type:"text",size:"5",name:"blue"+e,id:"blue"+e});c("#"+e).replaceWith("<td>"+c(t)[0].outerHTML+"</td>","<td>"+c(a)[0].outerHTML+"</td>","<td>"+c(i)[0].outerHTML+"</td>")}e===h.HEXA||e===h.Pantone?(t("NominalText"),t("MinimalText"),t("MaximalText"),t("MultipleText")):(a("NominalText"),a("MinimalText"),a("MaximalText"),a("MultipleText"))}}}})]},{html:[p=new e({name:"displayUnitText",id:"displayUnitText",className:"form-control form-control-root",placeholder:""})]}]},{tag:"tr",class:"heading",html:[{tag:"td",colspan:"5",class:"heading1",text:h.Values}]},{tag:"tr",html:[{tag:"td",class:"createLabelRequired",text:h.ValuationType},{html:[g=new d({name:"valuationType",id:"valuationType",placeholder:!1,options:[{value:"None",label:h.None},{value:"Simple Value",label:h.SimpleValue,selected:!0}],events:{onChange:function(){var e=c("#valuationType").val();c("#dimensionSelect").val()===m.STRING_PARAMETER&&e===m.MULTIPLE_VALUE?c("#multiValueLabelId")[0].innerHTML=h.Values:c("#multiValueLabelId")[0].innerHTML=h.MultipleValues,"None"===e?(c("#nominalRow").hide(),c("#multipleRow").hide()):e===m.MULTIPLE_VALUE?(c("#multipleRow").show(),c("#nominalRow").hide()):(c("#nominalRow").show(),c("#multipleRow").show())}}})]}]},{tag:"tr",id:"nominalRow",html:[{tag:"td",id:"nominalValueLabelId",class:"createLabel",text:h.Value},{tag:"td",class:"createInputField",id:"NominalTexttd",html:[new e({name:"nominalValueText",placeholder:"",id:"NominalText"})]}]},{tag:"tr",id:"lowerSpecificationLimit",html:[{tag:"td",class:"createLabel",text:h.LowerSpecificationLimit},{tag:"td",id:"LowerSpecificationLimittd",class:"createInputField",html:[new e({name:"lowerSpecificationLimit",placeholder:"",id:"lowerSpecificationText"})]}]},{tag:"tr",id:"lowerRoutineReleaseLimit",html:[{tag:"td",class:"createLabel",text:h.LowerRoutineReleaseLimit},{tag:"td",id:"LowerRoutineReleaseLimit",class:"createInputField",html:[new e({name:"lowerRoutineReleaseLimit",placeholder:"",id:"lowerRoutineReleaseLimitText"})]}]},{tag:"tr",id:"minimalRow",html:[{tag:"td",class:"createLabel",text:h.MinimalValue},{tag:"td",id:"MinimalTexttd",class:"createInputField",html:[new e({name:"minimalValueText",placeholder:"",id:"MinimalText"})]},{tag:"td",class:"createInputField",html:[v=new r({type:"checkbox",value:"",label:h.Included,checked:!0,name:"minimalValueInclude",id:"minimalValueInclude"})]}]},{tag:"tr",id:"maximalRow",html:[{tag:"td",class:"createLabel",text:h.MaximalValue},{tag:"td",id:"MaximalTexttd",class:"createInputField",html:[new e({name:"maximalValueText",placeholder:"",id:"MaximalText"})]},{tag:"td",class:"createInputField",html:[T=new r({type:"checkbox",value:"",label:h.Included,checked:!0,name:"maximalValueInclude",id:"maximalValueInclude"})]}]},{tag:"tr",id:"upperRoutineReleaseLimit",html:[{tag:"td",class:"createLabel",text:h.UpperRoutineReleaseLimit},{tag:"td",id:"UpperRoutineReleaseLimittd",class:"createInputField",html:[new e({name:"upperRoutineReleaseLimit",placeholder:"",id:"upperRoutineReleaseLimitText"})]}]},{tag:"tr",id:"upperSpecificationLimit",html:[{tag:"td",class:"createLabel",text:h.UpperSpecificationLimit},{tag:"td",id:"UpperSpecificationLimittd",class:"createInputField",html:[new e({name:"upperSpecificationLimit",placeholder:"",id:"upperSpecificationText"})]}]},{tag:"tr",id:"multipleRow",html:[{tag:"td",id:"multiValueLabelId",class:"createLabel",text:h.MultipleValues},{tag:"td",id:"AuthorizedValuesField",html:[{tag:"table",html:[{tag:"tr",html:[{tag:"td",class:"createInputField",colspan:"3",html:[I=new d({nativeSelect:!0,id:"multipleValuesSelect",name:"multiSelectText",placeholder:"     ",multiple:!0,options:[{value:"",selected:!0}],events:{onClick:function(){b.getValue("dimensionSelect");c("#MultipleText").val(c("#multipleValuesSelect").val())}}})]}]},{tag:"tr",html:[{tag:"td",class:"createInputField",id:"",html:[new e({placeholder:"",id:"MultipleText"})]},{tag:"td",class:"createInputField",html:[new i({value:"",icon:"fonticon-plus-circled",events:{onClick:function(){b.getValue("dimensionSelect");for(var e=c("#MultipleText").val(),t=I.getOptions(),a=!1,i=0;i<t.length;i++)t[i].value===e&&(a=!0,alert(h.DuplicateValueAlert));if(!1===a){var l=I.getSelection();""!==l[0].value&&I.remove(l[0].value),I.add(e),c("#MultipleText").val("")}}}})]},{tag:"td",class:"createInputField",html:[new i({value:"",icon:"fonticon-minus-circled",events:{onClick:function(){b.getValue("dimensionSelect");var e=c("#multipleValuesSelect").val();I.remove(e),c("#MultipleText").val("")}}})]}]}]}]}]},{tag:"tr",html:[{tag:"td",class:"createLabel",text:h.CharacteristicsNotes},{tag:"td",class:"createInputField",html:[new e({multiline:!0,placeholder:"",resize:"none",name:"notesInput",id:"notesInput"})]}]},{tag:"tr",html:[{tag:"td",class:"createLabel",text:h.MeasurementPrecision},{html:[new d({placeholder:"",name:"precisionInput",options:[{value:"",selected:!0},{value:"0.1"},{value:"0.01"},{value:"0.001"},{value:"0.0001"},{value:"0.00001"}]})]}]},{tag:"tr",html:[{tag:"td",class:"createLabel",text:h.MissedTargetAction},{html:[new d({placeholder:!1,name:"missedTargetAction",options:[{value:"No Action Required",label:h.NoActionRequired,selected:!0},{value:"Hold and Retest",label:h.HoldandRetest},{value:"Ship and Monitor",label:h.ShipandMonitor}]})]}]},{tag:"tr",html:[{tag:"td",class:"createLabel",text:h.AppliestoInProcess},{html:[new d({placeholder:!1,name:"appliesToInProcess",options:[{value:"TRUE",label:h.TRUE},{value:"FALSE",label:h.FALSE,selected:!0}]})]}]},{tag:"tr",html:[{tag:"td",class:"createLabel",text:h.AppliestoBulk},{html:[new d({placeholder:!1,name:"appliesToBulk",options:[{value:"TRUE",label:h.TRUE},{value:"FALSE",label:h.FALSE,selected:!0}]})]}]},{tag:"tr",html:[{tag:"td",class:"createLabel",text:h.AppliestoFinalPackage},{html:[new d({placeholder:!1,name:"appliesToFinalPackage",options:[{value:"TRUE",label:h.TRUE},{value:"FALSE",label:h.FALSE,selected:!0}]})]}]},{tag:"tr",html:[{tag:"td",class:"createLabel",text:h.OverwriteAllowedOnChild},{html:[new d({placeholder:!1,name:"overwriteAllowedOnChild",options:[{value:"TRUE",label:h.TRUE,selected:!0},{value:"FALSE",label:h.FALSE}]})]}]},{tag:"tr",html:[{tag:"td",class:"createLabel",text:h.TestMethod},{tag:"td",id:"testMethodTD",class:"createInputField",html:[new e({name:"testMethodText",placeholder:h.AddTestMethod,id:"testMethodText"})]},{tag:"td",class:"createInputField",html:[new i({name:"testMethodsChooser",id:"testMethodsChooser",value:"",icon:"fonticon-dot-3",events:{onClick:function(){if("undefined"!=typeof widget){var e=b.mTestMethodIds;b.mSearchConfig.activate("",u.getTestMethodsTypesActualValue(),"current==Release",b.addTMtoCharacteristics.bind(b),"",e)}else{var t="/characteristic/CharacteristicMaster3dSearchIntermediate.jsp?field=TYPES="+u.getEnableTestMethodSpecificationFlag()+":POLICY=policy_IPMSpecification,policy_Document,policy_ServiceDefinitionContent,policy_ServiceImplementationContent:CURRENT=policy_IPMSpecification.state_Release,policy_Document.state_RELEASED,policy_ServiceDefinitionContent.state_Exists,policy_ServiceImplementationContent.state_Exists:LATESTREVISION=true&table=AEFGeneralSearchResults&showInitialResults=true&selection=multiple&submitAction=refreshCaller&showRMB=false&txtExcludeOIDs="+b.mTestMethodIds.toString()+"&submitURL=../characteristic/CharacteristicMasterAddExistingOnPart.jsp&mode=AddTestMethodToChar";document.getElementById("ENOCharSearchFrame").src="../.."+t}}}}),"&nbsp;&nbsp;",new i({name:"testMethodsClear",id:"testMethodsClear",value:h.ClearAll,events:{onClick:function(){b.mTestMethodIds=[],b.addTMtoCharacteristics(null)}}})]}]},{tag:"tr",id:"externalTestMethod",html:[{tag:"td",class:"createLabel",text:h.ExternalTestMethod},{tag:"td",id:"ExternalTestMethodtd",class:"createInputField",html:[new e({name:"externalTestMethod",multiline:!0,placeholder:"",resize:"none",id:"externalTestMethodText"})]}]}]}]})},updateTestMethodField:function(e){var t;t=window.app.testMethods?window.app.testMethods.details:e,this.addTMtoCharacteristics(t)},addTMtoCharacteristics:function(t){var a=this.elements.container.getElement("#testMethodTD"),i="";if(null!==t){(i=a.getChildren()[0].value)&&!i.endsWith(", ")&&(i=i.concat(", "));for(var l=0;l<t.length;l++)-1==this.mTestMethodIds.indexOf(t[l].id)&&(this.mTestMethodIds.push(t[l].id),i=i+t[l].name+", ");i=i.substring(0,i.length-2)}a.empty(),window.testMethodId=[];new e({name:"testMethodText",placeholder:"Add Test Methods",id:"testMethodText",title:i,value:i,disabled:!0}).inject(a),a.setAttribute("title",i)},createDimensionChooserContent:function(e){var t=c(".dimensionChooserModal").children().children().children()[1];c(t).addClass("dimensionChooserBody");for(var a=0;a<e.length;a++){var i=c(document.createElement("input")).attr({type:"radio",class:"dimension",value:e[a].id,checked:!1});c(".dimensionChooserBody").append(i).append(c("<label />",{text:e[a].standard})).append(c("<br>"))}c(".dimension").click(function(){var e=c(this).next().text();c(".dimension").each(function(){c(this).prop("checked")&&c(this).next().text()!==e&&c(this).attr("checked",!1)})})},formFieldContent:function(){return new a({className:"horizontal",grid:"2 10",fields:[{type:"html",name:"CreateCharBody",id:"CreateCharBody",html:"<div id='CharFormDiv'></div>"}],events:{onInvalid:function(){}}})},dimensionChooserFieldContent:new a({className:"horizontal",grid:"2 10",fields:[{type:"html",name:"dimensionChooserBody",id:"dimensionChooserBody",html:"<div id='dimensionChooserDiv'></div>"}],events:{onInvalid:function(){alert("Form not instantaniated")}}}),doneButton:function(e,t){var a=this;return new i({value:h.OK,className:"info",events:{onClick:function(){a.addCharacteristic(e,t)}}})},checkForBadNamedChar:function(e){for(var t=!0,a="",i="",l="",n=0;n<e.length;n++){if("nameInput"===(l=e[n]))a=m.NAME_BAD_CHARS.replace(/\s/g,""),i=document.getElementById(l).value;else if("descriptionInput"===l||"notesInput"===l)i=document.getElementById(l).value,a=m.BAD_CHARS_FOR_DESC.replace(/\s/g,"");else{var s=document.getElementById(l);null!==s&&(i=s.value),a=m.BAD_CHARS.replace(/\s/g,"")}if(""!==i&&!(t=v.checkForBadCharacter(i,a)))return document.getElementById(l).focus(),t}return t},checkForValidValue:function(e){for(var t=0;t<e.length;t++){var a=document.getElementById("dimensionSelect").value;if("StringParameter"!==a&&"BooleanParameter"!==a&&"SubjectivityParameter"!==a&&"CMYKFormattedStringParameter"!==a&&"HEXFormattedStringParameter"!==a&&"RGBFormattedStringParameter"!==a){var i=e[t],l=document.getElementById(i.valueDOMID).value;if(isNaN(l)){var n=h.replace(h.get("InvalidValueAlert"),{label:i.label});return alert(n),!1}}}return!0},addCharacteristic:function(e,t){var a=[{valueDOMID:"NominalText",label:h.Value},{valueDOMID:"MinimalText",label:h.MinimalValue},{valueDOMID:"MaximalText",label:h.MaximalValue},{valueDOMID:"lowerSpecificationText",label:h.LowerSpecificationLimit},{valueDOMID:"upperSpecificationText",label:h.UpperSpecificationLimit},{valueDOMID:"lowerRoutineReleaseLimitText",label:h.LowerRoutineReleaseLimit},{valueDOMID:"upperRoutineReleaseLimitText",label:h.UpperRoutineReleaseLimit}];if(this.manager=t,c("#nameInput").attr("class").indexOf("disabled")<0&&""===c("#nameInput").val().trim())return alert(h.NameFieldRequiredMessage),void c("#nameInput").focus();if(""===c("#titleInput").val())return alert(h.TitleFieldRequiredMessage),void c("#titleInput").focus();if(""===c("#charCategoryInput").val())return alert(h.CharacteristicCategoryFieldRequiredMessage),void c("#charCategoryInput").focus();u.getGLSWebServiceURL(),m.CHARACTERISTICS_ENDPOINT;this.mInputValues.ObjectID=e,"true"===c("#nameInput").prop("disabled")?this.mInputValues.name="":this.mInputValues.name=this.getValue("nameInput"),this.mInputValues.Title=this.getValue("titleInput");var i=this.getValue("valuationType");if(i="None"===i?"0":"Simple Value"===i?"1":"2",this.mInputValues.valuation=i,this.dimension=this.getValue("dimensionSelect"),this.mInputValues.dimension=this.dimension,"BooleanParameter"===this.dimension?(this.mInputValues.nominal=c("#nominalValueSelect").val(),this.mInputValues.minimal="",this.mInputValues.maximal=""):"COLORParameter"===this.dimension&&this.dimension!==h.HEXA&&this.dimension!==h.Pantone?(this.mInputValues.nominal=c("#redNominalText").val()+","+c("#blueNominalText").val()+","+c("#greenNominalText").val(),this.mInputValues.minimal=c("#redMinimalText").val()+","+c("#blueMinimalText").val()+","+c("#greenMinimalText").val(),this.mInputValues.maximal=c("#redMaximalText").val()+","+c("#blueMaximalText").val()+","+c("#greenMaximalText").val()):(this.mInputValues.nominal=c("#NominalText").val(),this.mInputValues.minimal=c("#MinimalText").val(),this.mInputValues.maximal=c("#MaximalText").val()),!this.checkForValidValue(a))return!1;if(this.mInputValues.displayUnit=this.getValue("displayUnitSelect"),"IntegerParameter"!==this.dimension&&"RealParameter"!==this.dimension||(this.mInputValues.displayUnit=this.getValue("displayUnitText")),this.mInputValues.charCategory=this.getValue("charCategoryInput"),this.mInputValues.priority=this.getValue("priorityInput"),1==c("#multipleValuesSelect > option").length)this.mInputValues.multiple=[];else{for(var l=[],n=c("#multipleValuesSelect").find("option").get(),s=0,o=0;o<n.length;o++)""!==n[o].value&&(l[s]=n[o].value,s++);this.mInputValues.multiple=l}this.mInputValues.externalTestMethod=this.getValue("externalTestMethod"),this.mInputValues.lowerSpecificationLimit=this.getValue("lowerSpecificationLimit"),this.mInputValues.upperSpecificationLimit=this.getValue("upperSpecificationLimit"),this.mInputValues.lowerRoutineReleaseLimit=this.getValue("lowerRoutineReleaseLimit"),this.mInputValues.upperRoutineReleaseLimit=this.getValue("upperRoutineReleaseLimit"),this.mInputValues.missedTargetAction=this.getValue("missedTargetAction"),this.mInputValues.notes=this.getValue("notesInput"),this.mInputValues.description=this.getValue("descriptionInput"),this.mInputValues.precisionInput=this.getValue("precisionInput"),this.mInputValues.overwriteAllowedOnChild=this.getValue("overwriteAllowedOnChild"),this.mInputValues.minIncluded=this.getValue("minimalValueInclude"),this.mInputValues.maxIncluded=this.getValue("maximalValueInclude"),this.mInputValues.appliesToInProcess=this.getValue("appliesToInProcess"),this.mInputValues.appliesToBulk=this.getValue("appliesToBulk"),this.mInputValues.appliesToFinalPackage=this.getValue("appliesToFinalPackage");if(!1===this.checkForBadNamedChar(["nameInput","titleInput","descriptionInput","notesInput","charCategoryInput"]))return!1;this.mInputValues;var r=this;window.app,r.mTestMethodIds.length>0&&(this.mInputValues.testMethods=r.mTestMethodIds,r.mTestMethodIds=[]),I.mask(this.mChartcsModalWindow.elements.content),u.send3DSpaceRequest(this.urlRoot+m.CHARACTERISTICS_CREATE,"POST",{type:"text",headers:{"Content-type":"application/json; charset=UTF-8"},data:JSON.stringify(this.mInputValues)},function(e){I.unmask(r.mChartcsModalWindow.elements.content);var a=JSON.parse(e);r.addCharactristicToModel(a[0],t),r.mInputValues.testMethods=[]},function(e,t){I.unmask(r.mChartcsModalWindow.elements.content),alert(JSON.parse(t).message)})},addCharactristicToModel:function(e,t){var a={rootNode:this.mRootModel.addCharacteristics(e).Category.mTreeNodeModel.getParent(),reOrderAcrossCategory:!1};t.updateSequenceOrder(a),this.mChartcsModalWindow.hide()},cancelButton:function(){var e=this;return new i({value:h.Cancel,className:"default",events:{onClick:function(){e.mChartcsModalWindow.hide()}}})},dimensionChooserDoneButton:function(){var e=this;return new i({value:h.OK,className:"info",events:{onClick:function(){var t=c("input[class=dimension]:checked").val(),a=c("input[class=dimension]:checked").next().text();if(""!=a){var i=[{value:t,label:a,selected:!0}];e.dimensionSelect.add(i),e.CharDimensionChooserModal.hide(),e.dimensionChooserFieldContent.reset(),e.dimensionChooserFieldContent.unvalidate()}else alert(h.PleaseSelectADimension)}}})},dimensionChooserCancelButton:function(){var e=this;return new i({value:h.Cancel,className:"default",events:{onClick:function(){e.CharDimensionChooserModal.hide(),e.dimensionChooserFieldContent.reset(),e.dimensionChooserFieldContent.unvalidate()}}})},pushFormContent:function(a,i){this.charContainer=i.elements.container,this.isInstantiatedIn3DD=i.elements.CharacteristicsToolbarControl.isInstantiatedIn3DD,this.mChartcsModalWindow=null,this.mRootModel=i.mRootItem;var l=this;this.mChartcsModalWindow=new n({closable:!0,animate:!0,header:"<h4>"+h.CreateCharacteristics+"</h4>",body:this,footer:[this.doneButton(this.mRootModel.mObjectId,i),this.cancelButton()],events:{onHide:function(){l.mTestMethodIds=[],l.reset(),l.unvalidate()}}}),this.isInstantiatedIn3DD?this.mChartcsModalWindow.inject(document.body).show():this.mChartcsModalWindow.inject(this.charContainer).show();var s=t.extendElement(document.body).getElement("#CharFormDiv");s.innerHTML="";l=this;u.send3DSpaceRequest(this.urlRoot+m.CHARACTERISTICS_GET_ATTRIBUTE_RANGES,"GET",{type:"json",headers:{"Content-type":"application/x-www-form-urlencoded"},data:{attribute:m.ATTRIBUTE_CHARACTERISTIC_CATEGORY}},function(n){var o=n[0].ActualRanges.length,r=navigator.systemLanguage||navigator.browserLanguage||navigator.userLanguage||navigator.language;if(0==o)var u={tag:"tr",html:[{tag:"td",class:"createLabelRequired",text:h.Category},{tag:"td",class:"createInputField",html:[new e({name:"charCategoryInput",placeholder:"",id:"charCategoryInput"})]}]};else{for(var m=[],p=0;p<o;p++){var g=n[0].ActualRanges[p],I=n[0].TranslatedRanges[p];m.push({value:g,label:I})}"ja"==r&&"createInputField-ja";u={tag:"tr",html:[{tag:"td",class:"createLabelRequired",text:h.Category},{class:"ja"==r?"inputField-ja":"",html:[new d({placeholder:!1,name:"charCategoryInput",options:m})]}]}}l.createBody(a,i,u).inject(s),c("#displayUnitText").hide();t.extendElement(document.body).getElement("#EditCharFormElem")},function(e,t){g.displayErrorResponse(i.mAlert,t)})},pushDimensionChooserContent:function(e){this.CharDimensionChooserModal=null;var a=this;this.CharDimensionChooserModal=new n({closable:!0,className:"dimensionChooserModal",animate:!0,header:"<h4>"+h.Dimension+"</h4>",body:this.dimensionChooserFieldContent,footer:[this.dimensionChooserDoneButton(),this.dimensionChooserCancelButton()],events:{onHide:function(){a.CharDimensionChooserModal.hide(),a.CharDimensionChooserModal.destroy()}}}),this.CharDimensionChooserModal.inject(document.body).show();var i=t.extendElement(document.body).getElement("#dimensionChooserDiv");this.createDimensionChooserContent(e).inject(i)}})});