define("DS/ENOCharacteristicsWebApp/utils/TableViewPreference",["UWA/Core","UWA/Class","DS/ENOCharacteristicsWebApp/utils/Constants","DS/ENOCharacteristicsWebApp/utils/RequestUtils","DS/ENOCharacteristicsWebApp/utils/AlertManager","DS/ENOCharacteristicsWebApp/utils/UIUtil"],function(i,e,t,n,s,r){"use strict";return e.singleton({init:function(){return this},getColumnOrder:function(i,e,t){var n,s,r,l,d,a=!1,o=[],h={};for(UWA.is(e)||(e=this.preferences_grid.getManager()),n=s=this.getStartIndexForPreference(t);n<i.length;++n)h[d=i[n].dataIndex]=i[n];for(n=0;n<e.getNumberOfRows();n++)l=h[d=(r=e.getRowModel(n)).dataIndex],r.dataIndex!==i[n+s].dataIndex&&(a=!0),"string"===UWA.typeOf(r.colVisibility)&&(r.colVisibility=UWA.Json.decode(r.colVisibility)),r.colVisibility.isVisible!==h[d].isVisible&&(l.isVisible=r.colVisibility.isVisible,a=!0),r.width!==h[d].width&&(l.width=r.width,a=!0),r.minWidth!==h[d].minWidth&&(l.minWidth=r.minWidth,a=!0),o.push(l);return{isChanged:a,Columns:o}},setWidgetPreferences:function(i,e,l){var d,a,o,h=[];for(d=0;d<e.length;d++)o=e[d],(a={}).dataIndex=o.dataIndex,a.isVisible=o.isVisible,a.width=r.getValidColumnWidth(o.width),a.minWidth=r.getValidColumnMinWidth(o.minWidth),h[h.length]=a;if(l)widget.setValue(i,UWA.Json.encode(h));else{var u={preferenceName:i,preferenceValue:h},c=JSON.stringify(u);n.send3DSpaceRequest(n.getGLSWebServiceURL()+t.CHARACTERISTICS_ENDPOINT+t.CHARACTERISTICS_SET_COLUMN_PREFERENCES,"POST",{type:"text",headers:{"Content-type":"application/json; charset=UTF-8"},data:c},function(i){},function(i,e){s.displayErrorResponse(null,e)})}},sortViewColumns:function(i,e,t){var n,s,l,d,a,o,h;for(l=this.getStartIndexForPreference(t),n=0;n<i.length;n++)s=i[n],d=e.getColumnIDFromDataIndex(s.dataIndex),UWA.is(d)&&(0===e._listOfColumnsPreviousWidth[d]&&(e._listOfColumnsPreviousWidth[d]=100),a=r.getValidColumnWidth(s.width),o=r.getValidColumnMinWidth(s.minWidth),!0===(h=s.isVisible)?e.showColumn(d):e.hideColumn(d),e.setColumnOptions(d,{width:a,minWidth:o,isVisible:h}),d!=l&&e.moveColumn(d,l),l++)},getStartIndexForPreference:function(i){return i?2:3}})});