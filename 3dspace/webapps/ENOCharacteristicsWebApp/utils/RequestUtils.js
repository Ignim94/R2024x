define("DS/ENOCharacteristicsWebApp/utils/RequestUtils",["UWA/Class","UWA/Data","DS/WAFData/WAFData","DS/PlatformAPI/PlatformAPI","DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext","DS/ENOCharacteristicsWebApp/utils/Constants"],function(e,t,n,i,a,s){"use strict";return e.singleton({ReadModesEnum:{SERVER:1,CACHE:2},WriteModesEnum:{SERVER:1,CACHE:2},glsAppPath:"characteristicmodeller",glsAppVersion:"v1",m3DSpaceURL:"../..",mUserLogin:"",m3DSpaceCSRFToken:null,securityContext:null,workUnderChange:null,enableTestMethodSpecificationFlag:null,testMethodsTypesActualValue:null,mLanguage:null,init:function(){return this},configure:function(e,t){this.m3DSpaceURL=e,this.mUserLogin=t},getGLSWebServiceURL:function(){return"resources/"+this.glsAppVersion+"/"+this.glsAppPath+"/"},get3DSpaceURL:function(){return this.m3DSpaceURL},getMandatoryIcon:function(){return this.getAppsBaseUrl()+"/webapps/ENOCharacteristicsWebApp/assets/icons/32/MandatoryCharacteristic.png"},getAppsBaseUrl:function(){var e=i.getApplicationConfiguration("app.urls.myapps");return null!=e&&null!=e||(e=this.m3DSpaceURL),e},getUserLogin:function(){return this.mUserLogin},setInitializedin3DD:function(e){this.initialzedin3DD=e},set3DSpaceCSRFToken:function(e){this.m3DSpaceCSRFToken=e},setTimeout:function(e){this.timeout=e},getTimeout:function(){return this.timeout},get3DSpaceCSRFToken:function(){return this.m3DSpaceCSRFToken},getInitializedin3DD:function(){return this.initialzedin3DD},setEnableTestMethodSpecificationFlag:function(e){this.enableTestMethodSpecificationFlag=e},setWorkUnderChange:function(e){e&&(this.workUnderChange=e)},getWorkUnderChange:function(){return this.workUnderChange},setSecurityContext:function(e){this.securityContext=e},getEnableTestMethodSpecificationFlag:function(){return this.enableTestMethodSpecificationFlag},setTestMethodsTypesActualValue:function(e){this.testMethodsTypesActualValue=e},getTestMethodsTypesActualValue:function(){return this.testMethodsTypesActualValue},send3DSpaceRequest:function(e,t,n,i,a){this.sendRequest(this.m3DSpaceURL+"/"+e,t,n,i,a)},send3DSpaceRequestSimple:function(e,t){this.sendRequestSimple(this.m3DSpaceURL+"/"+e,t)},sendRequest:function(e,t,n,i,a){n.method=t,n.onComplete=i,n.onFailure=a,this.sendRequestSimple(e,n)},sendRequestSimple:function(e,t){if(t.headers||(t.headers={},t.headers["Content-type"]="text/html"),t.type||(t.type="text"),t.data||(t.data=""),t.timeout||(t.timeout=this.timeout),this.m3DSpaceCSRFToken)if(t.headers["X-Requested-With"]="csrf protection",t.headers["X-Request"]=this.m3DSpaceCSRFToken,t.headers.SecurityContext=this.securityContext,this.getInitializedin3DD())this.getWorkUnderHeaders(),t.headers=this.addAdditionaWorkUnderlHeader(t.headers);else if(this.workUnderChange){!0!==e.contains(s.CHARACTERISTICS_GET_CONNECTED_TM)&&(t.headers["DS-Change-Authoring-Context"]="pid:"+this.workUnderChange)}return n.authenticatedRequest(e,t)},getChange:function(){return this.authorizedChange=a.get(),this.authorizedChange},addAdditionaWorkUnderlHeader:function(e){return Object.assign(e,this.getWorkUnderHeaders())},getWorkUnderHeaders:function(){return this.getChange(),this.authorizedChange&&this.authorizedChange.AuthoringContextHeader?Object.assign({},this.authorizedChange.AuthoringContextHeader):{}},getLanguage:function(){if(this.mLanguage)return this.mLanguage;try{if(window.parent&&window.parent.dsLang)return window.parent.dsLang;if(widget)return widget.lang}catch(e){}var e="en";return(e=navigator.browserLanguage?navigator.browserLanguage:navigator.language).indexOf("fr")>-1?"fr":e.indexOf("en")>-1?"en":e.indexOf("es")>-1?"es":e.indexOf("it")>-1?"it":e.indexOf("de")>-1?"de":e.indexOf("ja")>-1?"ja":e.indexOf("zh")>-1?"zh":"en"},getFieldSeparator:function(){if(this.fieldSeparator)return this.fieldSeparator},initLanguage:function(e){var t=this;this.send3DSpaceRequestSimple(this.getGLSWebServiceURL()+"application/language",{method:"GET",type:"json",headers:{"Content-type":"application/json"},onComplete:function(n){require.config({config:{i18n:{locale:n.language}}}),t.mLanguage=n.language,e()}})},sendDataRequest:function(e,n){t.request(e,n)}})});