define("DS/ENOXCADDataExchangeUI/XCADExchangeUI",["UWA/Utils/InterCom","DS/i3DXCompassServices/i3DXCompassPubSub"],function(e,t){var i=null;return{widget:null,initwidget:function(e){this.widget=e.widget,this.widget.addEvent("onLoad",this.onLoad.bind(this)),this.widget.addEvent("onRefresh",this.onRefresh.bind(this))},onLoad:function(){var n=this,o=!1;null===i&&(i=new e.Socket("exchange_socket_ENOUXEH_AP")).subscribeServer("com.ds.compass",window.parent),i.addListener("isENOUXEHAPlaunched",function(e){o=!0,t.publish("exchange:ENOUXEH:app:open",{isAPPopen:!0})}),Boolean(o)||("ExportApp"===sessionStorage.getItem("XCADExchangeCmd")?require(["DS/ENOXCADExport/ENOXCADExportCmd"],function(e){let t=sessionStorage.getItem("isplmcsaEnabled");e.onLoad({isplmcsaEnabled:t,widget:n.widget})}):"ImportApp"===sessionStorage.getItem("XCADExchangeCmd")&&require(["DS/ENOXCADDataImport/ENOXCADImportCmd"],function(e){e.onLoad({widget:n.widget})}))},onRefresh:function(){console.log("Widget onRefresh")}}}),define("DS/ENOXCADDataExchangeUI/utils/ImportSelection",["UWA/Class/View","DS/Controls/Button","DS/Controls/Toggle","DS/Controls/LineEditor","DS/Controls/TooltipModel","DS/Windows/ImmersiveFrame","DS/Windows/Dialog","DS/ENOXCADUtils/utils/XCADModelEvents","DS/ENOXCADUtils/utils/XCAD3DDriveDialog","DS/ENOXCADUtils/XCADNotification","i18n!DS/ENOXCADDataExchangeUI/assets/nls/DataExchangeUINLS","css!DS/ENOXCADDataExchangeUI/utils/ImportSelection"],function(e,t,i,n,o,l,a,s,r,d,c){"use strict";var u,m,D,p,g,f,v,b,E,C,h,w;return e.extend({tagName:"div",className:"xcadimport-selectionview",setup:function(e){if(m=e.tenantid,null!=e.extension){C=[];for(let t=0;t<e.extension.length;t++){let i="."+e.extension[t];C.push(i)}}w=null!=e.isstandalone&&e.isstandalone,h=null!=e.servicejson?e.servicejson:null,p=!1,D=!1,"OnPremise"!=m&&1==widget.getValue("isplmcsaEnabled")&&(D=!0),u=new l({identifier:"selectionview_immersiveFrame"}),this.renderUI()},renderUI:function(){var e=this;let i=UWA.createElement("div",{id:"importselection_main_div"});D&&e.create3DDriveFieldSetContent(i),e.createFileDiskFieldSetContent(i);let n=!0;D&&(n=!1);let o={Ok:E=new t({domId:"selectionview_button_export",label:c["xcadimport.select.button.label"],emphasize:"primary",disabled:n,onClick:function(e){let t;if(Boolean(p)){let e=r.selectedNode(),o=e.fileName;var i=o.lastIndexOf(".");if(i>-1){var n=o.substring(i);C.includes(n.toLowerCase())&&(t={operation:"fileselection",version:"1.0",data:{filestorage:"3DDrive",physicalid:e.fileId,tenantid:e.tenant.platformId,filename:o}})}}else t={operation:"fileselection",version:"1.0"},w||(t.filepath=g.value);null!=t?w?s.publish({event:"ENOXCADDataImport/RenderDrive",data:t}):(s.publish({event:"ENOXCAD-PowerByHome/ToWin",data:t}),s.publish({event:"XCADImportCmd/LaunchImportUI"})):d.warningMsg(c["xcadimport.zip.selection"])}})};if(!w){let i=new t({domId:"selectionview_button_cancel",label:c["xcadimport.cancel.button.label"],emphasize:"secondary",disabled:!1,onClick:function(t){e.closeDialog()}});o.Cancel=i}(f=new a({domId:"xcad-import-modal-dialog",immersiveFrame:u,title:c["xcadimport.modal.title"],content:i,resizableFlag:"horizontal",buttons:o,identifier:"xcadimport_modalDialog",closeButtonFlag:!1,modalFlag:!0})).addEventListener("close",function(){f.visibleFlag=!1}),u.inject(UWA.extendElement(document.body))},createFileDiskFieldSetContent:function(e){let l=!0;Boolean(D)&&(l=!1);let a=new i({domId:"selectionview_filedisk_radio",type:"radio",label:c["xcadimport.disk.radio.label"],value:0,checkFlag:l}).inject(e);D&&a.addEventListener("click",this.fileToggleAction.bind(this,this)),g=new n({domId:"selectionview_filedisk_editor",sizeInCharNumber:40}).inject(e),new t({domId:"selectionview_filedisk_button",displayStyle:"lite-borders",icon:{iconPath:require.toUrl("DS/ENOXCADExport/assets/icons/32/I_Open.png")},tooltipInfos:new o({shortHelp:c["browse.Folder.DialogTitle"],mouseRelativePosition:!0,position:"top"}),showLabelFlag:!1,onClick:function(e){s.subscribe({event:"PowerByHome/ToWeb-ENOXCAD"},function(e){"browsefile"===e.operation&&"succees"===e.data.status&&(g.value=e.data.path,E.disabled=!1)}),s.publish({event:"ENOXCAD-PowerByHome/ToWin",data:{operation:"browsefile",version:"1.0"}})}}).inject(e)},create3DDriveFieldSetContent:function(e){var t=this;p=!0,new i({domId:"selectionview_3DDrive_radio",type:"radio",label:c["xcadimport.drive.label"],value:0,checkFlag:!0}).inject(e).addEventListener("click",t.diskToggleAction.bind(this,t)),b=UWA.createElement("div",{id:"div_3dDrive"}).inject(e),w&&null!=h?new Promise(function(e){r.generate3DDriveBrowser(e,m,b,C,!0,!1,h).then(function(e){null!=e&&(v=e.modalContainer)})}):new Promise(function(e){r.generate3DDriveBrowser(e,m,b,C,!0).then(function(e){null!=e&&(v=e.modalContainer,t.enabledisableButtons(["#selectionview_filedisk_editor","#selectionview_filedisk_button"],!1))})})},fileToggleAction:function(e,t){p=!1,e.enabledisableButtons(["#div_3dDrive",".wux-controls-modalContainer"],!1),w||(e.enabledisableButtons(["#selectionview_filedisk_editor","#selectionview_filedisk_button"],!0),""==g.value&&(E.disabled=!0))},diskToggleAction:function(e,t){p=!0,e.enabledisableButtons(["#div_3dDrive",".wux-controls-modalContainer"],!0),w||(e.enabledisableButtons(["#selectionview_filedisk_editor","#selectionview_filedisk_button"],!1),E.disabled=!1)},enabledisableButtons:function(e,t){for(let i of e)t?(document.querySelector(i).style.pointerEvents="auto",document.querySelector(i).style.opacity="1.1",document.querySelector(i).setData("isButtonEnabled",t)):(document.querySelector(i).style.pointerEvents="none",document.querySelector(i).style.opacity="0.4",document.querySelector(i).setData("isButtonEnabled",t))},closeDialog:function(){null!=v&&v.removeModal(b),u.destroy()}})}),define("DS/ENOXCADDataExchangeUI/cmd/XCADImportCmd",["UWA/Utils/InterCom","DS/ApplicationFrame/Command","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","DS/i3DXCompassServices/i3DXCompassPubSub","DS/ENOXCADUtils/utils/XCADModelEvents","DS/ENOXCADDataExchangeUI/utils/ImportSelection","i18n!DS/ENOXCADDataExchangeUI/assets/nls/DataExchangeUINLS"],function(e,t,i,n,o,l,a){"use strict";var s,r,d,c=null;return t.extend({init:function(t){this._parent(t),this.enable();let a="undefined"!=typeof widget&&null!=widget.getValue("current_tenant")?widget.getValue("current_tenant"):"onPremises";i.getPlatformServices({onComplete:function(e){for(let t=0;t<e.length;t++)if(e[t].displayName===a){s=e[t].platformId;break}},onFailure:function(e){console.log("PlatformServices fail",e)}}),null===c&&(c=new e.Socket).subscribeServer("com.ds.compass",window.parent),n.subscribe("exchange:ENOUXEH:app:open",function(e){d=!1}),"OnPremise"!=s&&o.subscribe({event:"PowerByHome/ToWeb-ENOXCAD"},function(e){"packageextns"===e.operation&&null!=e.data.extensions&&(r=new l({tenantid:s,extension:e.data.extensions}))})},execute:function(){d=!0,o.subscribe({event:"XCADImportCmd/LaunchImportUI"},function(){let e=null!=widget.getValue("isODTInfra")&&widget.getValue("isODTInfra");Boolean(e)||r.closeDialog(),o.publish({event:"ENOXCAD-Launch-Import"})}),c.dispatchEvent("isENOUXEHAPlaunched",{msg:"ExchangeApOpen"},"exchange_socket_ENOUXEH_AP"),setTimeout(function(){Boolean(d)?"OnPremise"!=s&&1==widget.getValue("isplmcsaEnabled")?o.publish({event:"ENOXCAD-PowerByHome/ToWin",data:{operation:"packageextns",version:"1.0"}}):r=new l({tenantid:s}):require(["DS/ENOXCADUtils/XCADNotification"],function(e){let t=a.exchange_app_close+" X-CAD Design Exchange "+a.exchange_app_close_info;e.infoMsg(t)})},600)}})});