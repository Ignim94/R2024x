define("DS/ENOXCADDataImport/utils/ImportWSProxy",["UWA/Core","DS/WAFData/WAFData"],function(e,t){let i=function(e,i,n){return new Promise(function(o,a){i.onComplete=function(e){let t=function(e){return"string"==typeof e?JSON.parse(e):e}(e),i=t;n&&(i=n(t)),o(i)},i.onFailure=function(e){a(e)},i.onTimeout=function(e){console.log("webservice timeout"),a(e)},i.data&&(i.data=JSON.stringify(i.data)),function(e,i,n){let o=null;o=t.authenticatedRequest(e,i)}(e,i)})};return{getCadTypeMapping:function(){let e=xcadimportinfra.X3D_URL_3DSPACE+"/resources/xcaddataexch/services/cadtypemapping?integration="+xcadimportinfra.X3D_INTEGRATION+"&tenant="+xcadimportinfra.X3D_PLATFORM_ID+"&securitycontext="+xcadimportinfra.X3D_SECURITY_CONTEXT,t={type:"json",method:"GET",headers:{Accept:"application/json","content-type":"application/json"},timeout:6e5};return i(e,t)},getPlatformStatus:function(e,t){let n=xcadimportinfra.X3D_URL_3DSPACE+"/resources/xcaddataexch/services/computeplatformstatus?&tenant="+xcadimportinfra.X3D_PLATFORM_ID,o={type:"json",method:"POST"};return o.headers={Accept:"application/json","content-type":"application/json",SecurityContext:xcadimportinfra.X3D_SECURITY_CONTEXT},o.timeout=6e5,o.data={integration:xcadimportinfra.X3D_INTEGRATION,ces:e},t.length>0&&(o.data.mces=t),i(n,o)}}}),define("DS/ENOXCADDataImport/utils/JSONDataMapper",["UWA/Class/Options","UWA/Class"],function(e,t){return t.singleton(e,{init:function(){},parseData:function(e){let t=e.busTypeMapping,i=e.relTypeMapping,n=e.structureArray,o=e.nodesArray,a=e.instanceArray,l=e.familyArray,d=e.circularlinksArray,r=e.drawingOfArray,s=[];if(xcadimportinfra.OPERATION_STATE.isstandalone){let e=[];for(const t of o)xcadimportinfra.CHECK_SELECTION&&null!=t.info&&null!=t.info.selected&&null!=t.info.download&&/false/.test(t.info.selected)&&/false/.test(t.info.download)||e.push(t);if(e.length>0){o=[...e.filter((t,i)=>i===e.findIndex(e=>t.phid===e.phid))]}n=n.filter((e,t)=>t===n.findIndex(t=>e.phid===t.phid&&e.parent===t.parent))}for(let e=0;e<o.length;e++){if(null!=o[e].info){let t=o[e].info;delete o[e].info,Object.assign(o[e],t)}let i=this.getPurposeNLS(o[e].purposekey);o[e].purpose=i;let n=o[e].cadtype,a=t.find(e=>e.type==n);o[e].typeclass=a.class,o[e].openpackage=!1}for(let e=0;e<n.length;e++){if(null!=n[e].relname){let t=i.find(t=>t.type==n[e].relname);n[e].relclass=t.class}else n[e].relclass="";let t;if(n[e].relicon="",null!=(t=l.length>0&&null!=n[e].type?o.find(t=>t.rowid==n[e].rowid):o.find(t=>t.phid==n[e].phid))){let i=Object.assign(n[e],t);s.push(i)}}if(a.length>0)for(let e=0;e<a.length;e++){let t=o.find(t=>t.phid==a[e].phid);if(null!=t){let i=Object.assign(a[e],t),n=s.find(t=>t.phid==a[e].parent);null!=n&&(null==n.instances&&Object.assign(n,{instances:[]}),n.instances.push(i))}}if(l.length>0){var c=[].concat(s);for(let e=0;e<l.length;e++){let t,i;if(null!=l[e].noderowid){let n=o.find(t=>t.rowid==l[e].rowid);null!=n&&(t=Object.assign(l[e],n),i=s.find(t=>t.rowid==l[e].noderowid))}else{let n=o.find(t=>t.phid==l[e].phid);null!=n&&(t=Object.assign(l[e],n),i=c.find(t=>t.phid==l[e].parent))}null!=i&&(c.splice(c.indexOf(i),1),null==i.family&&(Object.assign(i,{family:[]}),i.family.push(t)))}if(c.length>0)for(let e=0;e<c.length;e++)if(null==c[e].family){let t=s.find(t=>t.instancename==c[e].instancename),i=s.find(t=>t.phid==c[e].phid);null!=t&&null!=i&&(Object.assign(t,{family:[]}),t.family=[].concat(i.family))}}if(d.length>0)for(let e=0;e<d.length;e++){let t=o.find(t=>t.phid==d[e].phid);if(null!=t){let i=Object.assign(d[e],t),n=s.find(t=>t.phid==d[e].parent);null!=n&&(null==n.circularlinks&&Object.assign(n,{circularlinks:[]}),n.circularlinks.push(i),n.cycliclinkicon="check")}}if(r.length>0)for(let e=0;e<r.length;e++){let t=o.find(t=>t.phid==r[e].parent);if(null!=t){let i=s.find(t=>t.phid==r[e].phid);if(null!=i)null==i.relclass&&(i.relclass=""),null==i.relicon&&(i.relicon=""),i.cadfiletype="swdrawing",null==i.drawingof&&Object.assign(i,{drawingof:[]}),i.drawingof.push(t);else if(null!=r[e].phid){let i=o.find(t=>t.phid==r[e].phid);null==i.relclass&&(i.relclass=""),null==i.relicon&&(i.relicon=""),i.cadfiletype="swdrawing",Object.assign(i,{drawingof:[t]}),s.push(i)}}}return s},getPurposeNLS:function(e){let t;return t="readonly"===e?UWA.i18n("cust_readonly"):"exclude"===e?UWA.i18n("cust_exclude"):"edit"===e?UWA.i18n("for_edit"):"forceexclude"===e?UWA.i18n("key_forceexclude"):e},createSkeletonOfDataGrid:function(e){function t(e,t,i){if(-1!=e){if(!i[e].child)return i[e].child=[t];i[e].child.push(t)}}if(xcadimportinfra.OPERATION_STATE.isstandalone){let t=e.filter(e=>e.relclass.includes("REL_CAD_DOCUMENT_LIKE"));t.length>0&&(e=[...e.filter(e=>!e.relclass.includes("REL_CAD_DOCUMENT_LIKE")),...t])}xcadimportinfra.OPERATION_STATE.treeorder&&e.sort((e,t)=>parseInt(e.treeorder)>parseInt(t.treeorder)?1:-1);const i=[];let n=[...e];for(let o=0;o<e.length;o++)if(""!=e[o].parent&&"Y"!==e[o].rootnode)if(null==e[o].child&&(e[o].child=[]),xcadimportinfra.OPERATION_STATE.isstandalone){let i=e.reduce((t,i,n)=>(i.phid===e[o].parent&&t.push(n),t),[]);0==i.length?(i=n.reduce((t,i,n)=>(i.phid===e[o].parent&&t.push(n),t),[])).forEach(i=>{("Y"===n[i].rootnode||n[i].parent!=e[o].phid)&&t(i,e[o],n)}):i.forEach(i=>{("Y"===e[i].rootnode||e[i].parent!=e[o].phid)&&t(i,e[o],e)}),e[o].relclass.includes("REL_CAD_DOCUMENT_LIKE")&&(e.splice(o,1),o--)}else{t(e.findIndex(t=>t.phid===e[o].parent),e[o])}else i.push(e[o]),null==e[o].child&&(e[o].child=[]);return i}})}),define("DS/ENOXCADDataImport/utils/ElementODTInfra",["DS/ENOXCADUtils/utils/XCADModelEvents"],function(e){"use strict";function t(){return"object"==typeof t.instance?t.instance:(t.instance=this,this)}function i(t,i){let n={operation:"elementactionodt",action:t};null!=i.data&&(n.data=i.data),e.publish({event:"webinwin:web:notification",data:n})}return t.prototype.elementAction=async function(e,t,n){switch(e.action){case"openpkgvisible":let o="failure";t.treeDocument.getAllDescendants().some(e=>!0===e.options.grid.iscellvisisble)&&(o="success"),i(e.action,{data:{status:o}});break;case"selectopenpkg":let a=await async function(e,t){return new Promise(i=>{let n="failure";t.getTreeDocument().search({match:function(t){t.nodeModel.options.grid.iscellvisisble&&(/true/.test(e.selectall)?(t.nodeModel.updateOptions({grid:{openpackage:!0}}),n="success"):t.nodeModel.getLabel()===e.title&&(t.nodeModel.updateOptions({grid:{openpackage:!0}}),n="success"))}}),i(n)})}(e.data,t);i(e.action,{data:{status:a}});break;case"clickopenbtn":document.querySelector("#button-open-opensession").click();break;case"consecutiveimport":document.querySelector("#import-modify-files-checkbox").click(),i(e.action,{data:{status:"success"}});break;case"importdump":let l=await async function(e,t){return new Promise(i=>{let n=[],o=1,a=e.treeDocument.getAllDescendants();a.filter(e=>"Y"===e.getAttributeValue("rootnode")).forEach(e=>{e.options.grid.row_id=o.toString(),o+=1});for(let t of a){let i=e.treeDocument.getAllDescendants().filter(e=>e.getAttributeValue("parent")===t.getAttributeValue("phid"));if(i.length>0)for(let e=0;e<i.length;e++){let n=i[e];if(null==n.options.grid.row_id){let i=e+1;n.options.grid.row_id=t.getAttributeValue("row_id")+"|"+i}}let o=null!=t.getAttributeValue("col3dexpstat")?t.getAttributeValue("col3dexpstat").toLowerCase():"";n.push({rowid:t.getAttributeValue("row_id"),phid:t.getAttributeValue("phid"),openpackage:t.getAttributeValue("openpackage"),title:t.getAttributeValue("title"),rev:null!=t.getAttributeValue("rev")?t.getAttributeValue("rev"):"",purpose:t.getAttributeValue("purposekey"),"3dexpstatus":o,supplierstatus:t.getAttributeValue("colsuppstat").toLowerCase()})}i({customsettings:{isopen_btn_enabled:t},structure:n})})}(t,n);i(e.action,{data:l})}},new t}),define("DS/ENOXCADDataImport/utils/CompareResponseData",["UWA/Class/Options","UWA/Class"],function(e,t){return t.singleton(e,{init:function(){},buildData:function(e,t,i){var n=!0,o=[...e];function a(e,t,a){if(Boolean(e)){if(n&&o.splice(o.indexOf(t),1),"edit"===t.purposekey&&(t.import=!0),t.treeorder=a.treeorder,t.filepath=a.dirname,t.bustype=a.bustype,t.opensession="openfrompackage",null!=t.keyforfilesync&&"ceStamp"===t.keyforfilesync)l.push({id:a.phid,st:t.ceStamp,type:a.bustype});else if(null!=t.macroceStamp&&0===t.macroceStamp.length)l.push({id:a.phid,st:t.ceStamp,type:a.bustype});else{let e=a.phid;if(null!=t.composerid&&t.composerid.length>0){e=i.find(e=>e.cadid===t.composerid).phid}null!=t.macroceStamp?d.push({id:a.phid,st:t.macroceStamp,type:a.bustype,agg:e}):l.push({id:a.phid,st:t.ceStamp,type:a.bustype})}r.push(t)}else a.import=!1,a.filepath=a.dirname,a.purpose="",a.purposekey="",a.rootnode="N",a.opensession="openfrompackage",r.push(a)}let l=[],d=[],r=[],s=!1;for(let i=0;i<t.length;i++){let l=!0,d=!xcadimportinfra.CHECK_SELECTION||null==t[i].selected||"true"===t[i].selected.toLowerCase();if(Boolean(d)){let d=o.find(e=>e.hashcode==t[i].hashcode);if(xcadimportinfra.OPERATION_STATE.isstandalone)if(0==o.length&&(d=e.find(e=>e.hashcode==t[i].hashcode)),null==d){t.filter(e=>e.hashcode==t[i].hashcode).length>1?(d=e.find(e=>e.hashcode==t[i].hashcode),n=!1):n=!0}else n=!0;null!=d?(d.supplierstatus=UWA.i18n("status_unchanged"),d.colsuppstat="Unchanged",s=!0):(n=!0,null!=(d=o.find(e=>e.phid==t[i].phid))?(d.supplierstatus=UWA.i18n("status_modified"),d.colsuppstat="Modified",s=!0):(l=!(!xcadimportinfra.OPERATION_STATE.isstandalone||!/true/.test(t[i].selected)||[...new Set(r.map(e=>e.phid))].includes(t[i].phid))||!xcadimportinfra.OPERATION_STATE.isstandalone)&&(t[i].supplierstatus=UWA.i18n("status_new"),t[i].colsuppstat="New",s=!1)),l&&a(s,d,t[i])}}if(o.length>0&&xcadimportinfra.OPERATION_STATE.isstandalone){[...o].forEach(e=>{let i=t.find(t=>t.hashcode==e.hashcode);null!=i?(e.supplierstatus=UWA.i18n("status_unchanged"),e.colsuppstat="Unchanged",s=!0):null!=(i=t.find(t=>t.phid==e.phid))?(e.supplierstatus=UWA.i18n("status_modified"),e.colsuppstat="Modified",s=!0):(e.supplierstatus=UWA.i18n("status_new"),e.colsuppstat="New",s=!1),null!=i&&a(s,e,i)})}if(l=[...new Map(l.map(e=>[e.id,e])).values()],d=[...new Map(d.map(e=>[e.id,e])).values()],xcadimportinfra.OPERATION_STATE.isstandalone){let e=r.filter(e=>e.typeclass.includes("TYPE_EMBEDDED_COMPONENT_LIKE")&&e.composerid);if(e.length>0){let t=[...new Set(e.map(e=>e.composerid))];this.updateECNode(r,t)}}return{resultArray:r,ceStampArray:l,macroceStampArray:d}},updateECNode:function(e,t){t.forEach(t=>{let i=e.find(e=>e.phid===t);e.filter(e=>e.composerid===t).forEach(t=>{let n=e.findIndex(e=>e.phid===t.phid);e[n].supplierstatus=i.supplierstatus,e[n].colsuppstat=i.colsuppstat})})}})}),define("DS/ENOXCADDataImport/utils/XMLToJsonChekinResConversion",["UWA/Class/Options","UWA/Class"],function(e,t){return t.singleton(e,{relationshipList:null,checkcadids:[],checkphids:[],cyclicNodes:[],cyclicNodeData:{},cyclicInsNodes:[],cyclicInsNodeData:{},compNodes:[],compInsData:{},parentNode:[],parentNodeData:{},_nodeDataArray:null,_insDataArray:null,relName:null,_cyclicArrayList:null,init:function(){},transform:function(e){this._nodeDataArray=[],this._insDataArray=[];let t=function e(t){"use strict";var i,n,o,a,l,d,r={};if(1===t.nodeType){if(t.attributes.length>0)for(r={},n=0;n<t.attributes.length;n+=1)r[(o=t.attributes.item(n)).nodeName]=o.nodeValue}else 3===t.nodeType?r=t.nodeValue:4==t.nodeType&&(r=t.nodeValue);if(t.hasChildNodes())for(i=0;i<t.childNodes.length;i+=1)void 0===r[l=(a=t.childNodes.item(i)).nodeName]?r[l]=e(a):(void 0===r[l].push&&(d=r[l],r[l]=[],r[l].push(d)),r[l].push(e(a)));return r}((new DOMParser).parseFromString(e,"text/xml"));return this.checkDataNodes(t)},checkDataNodes:function(e){var t,i="",n={jsondata:{}};if(this.cyclicNodeData.cyclicNodes=new Array,this.cyclicInsNodeData.cyclicInsNodes=new Array,null!=e.response.info.request.cadobjectlist.cadobject){this.relationshipList=e.response.info.request.relationshiplist.relationship;let o=e.response.info.request.cadobjectlist.cadobject,a=e.response.info.request.structure,l=JSON.parse(e.response.info.mappinginfo["#cdata-section"]);n.jsondata.exportmap=l;let d=l.exportdata[0].mappinginfo.mapping;i=this.jsonforGridView(d,a,o),t=e.response.result}else i=e.response.info.reason,t=e.response.result;return n.jsondata.result=t,n.jsondata.data=i,n},jsonforGridView:function(e,t,i){var n,o=this,a=o.getJsonParentChild(t,e,i);return""!=e?"FileToFile"==e?n=o.getJsonNodeStructureForGrid(a,i,"instance"):"NotFileToFile"===e&&(n=o.getJsonNodeStructureForGrid(o.compInsData.compNodes,i,"family")):n=o.getJsonNodeStructureForGrid(a,i,""),n},getJsonParentChild:function(e,t,i){var n=this,o={};o.fstructure=new Array;var a={};a.structure=new Array,n.parentNodeData.parentNode=new Array,n._cyclicArrayList=new Array;let l=e.active.cadobject,d=e.family.cadobject;if(null!=d&&(n.compInsData.compNodes=new Array,"FileToFile"===t?n.familyNodeArray(d,!0,o.fstructure,i):"NotFileToFile"===t&&n.familyNodeArray(d,!1,o.fstructure,i)),null!=l){if(null==l.length){var r="|"+l.cadid+"|"+Date.now();if(a.structure.push({cadid:l.cadid,familyId:l.familyid,parentid:"",rowId:r}),null!=l.cadobject){let e=[];e.push(l.cadid),n.parentChildArray(l,e,a.structure)}}else{let e=[];for(var s=0;s<l.length;s++){r="|"+l[s].cadid+"|"+Date.now();e.includes(l[s].cadid)||(a.structure.push({cadid:l[s].cadid,parentid:"",rowId:r}),null!=l[s].cadobject&&(e.push(l[s].cadid),n.parentChildArray(l[s],e,a.structure)))}}""==t&&n._cyclicArrayList.length>0&&n.buildCyclicNodeData(a.structure,i)}return o.fstructure.concat(a.structure)},familyNodeArray:function(e,t,i,n){var o=this;let a=[],l=[];if(null==e.length){if("true"===e.firstentry&&null==e.childrenprocessed){var d="|"+e.cadid+"|"+Date.now();if(o.checkcadids.push(e.cadid),i.push({cadid:e.cadid,parentid:"",rowId:d,familyId:""}),null!=e.cadobject){let t=[];t.push(e.cadid),a.push(e.cadid),o.parentChildArray(e,t,i)}}}else for(var r=0;r<e.length;r++)if(Boolean(t)){if("true"===e[r].firstentry&&null==e[r].childrenprocessed)if(a.length>0&&a.includes(e[r].cadobject.cadid))o.cyclicInsNodeData.cyclicInsNodes.push({id:e[r].cadobject.cadid,parent:e[r].cadid,rid:e[r].cadobject.relationship.rid,familyId:""});else{d="|"+e[r].cadid+"|"+Date.now();if(o.checkcadids.push(e[r].cadid),i.push({cadid:e[r].cadid,parentid:"",rowId:d}),null!=e[r].cadobject){let t=[];t.push(e[r].cadid),a.push(e[r].cadid),o.parentChildArray(e[r],t,i)}}}else if("true"===e[r].firstentry&&null!=e[r].childrenprocessed){var s=e[r].cadobject;if(l.length>0&&l.includes(s.cadid))o.cyclicInsNodeData.cyclicInsNodes.push({id:s.cadid,parent:e[r].cadid,rid:s.relationship.rid,familyId:s.familyid});else{d="|"+e[r].cadid+"|"+Date.now();o.compInsData.compNodes.push({cadid:e[r].cadid,parentid:"",rowId:d,familyId:""}),l.length>0&&l.splice(0,l.length),l.push(e[r].cadid),s.length,o.parentChildFamilyInstanceArray(e[r].cadid,s)}}},parentChildFamilyInstanceArray:function(e,t){if(null==t.length){var i=t.relationship.rid+"|"+t.cadid+"|"+Date.now();this.compInsData.compNodes.push({cadid:t.cadid,parentid:e,rowId:i,rid:t.relationship.rid,familyId:t.familyid}),null!=t.cadobject&&this.parentChildFamilyInstanceArray(e,t)}else for(var n=0;n<t.length;n++){i=t[n].relationship.rid+"|"+t[n].cadid+"|"+Date.now();this.compInsData.compNodes.push({cadid:t[n].cadid,parentid:e,rowId:i,rid:t[n].relationship.rid,familyId:t[n].familyid}),t[n].cadobject instanceof Object&&this.parentChildFamilyInstanceArray(e,t[n])}},parentChildArray:function(e,t,i){var n=this,o=e.cadid,a=e.cadobject;if(null==a.length){let e=n.parentNodeData.parentNode.find(e=>e.childid==a.cadid);if(t.includes(a.cadid))if(null!=e&&e.parentid==o)n.buildDataStructure(a,o,i);else{n.buildDataStructure(a,o,i);let e=a.relationship.rid+"|"+a.cadid;n._cyclicArrayList.push(e)}else t.push(a.cadid),n.buildDataStructure(a,o,i);n.parentNodeData.parentNode.push({childid:a.cadid,parentid:o}),null!=a.cadobject&&n.parentChildArray(a,t,i)}else for(var l=0;l<a.length;l++){let e=n.parentNodeData.parentNode.find(e=>e.childid==a[l].cadid);if(t.includes(a[l].cadid))if(null!=e&&e.parentid==o)n.buildDataStructure(a[l],o,i);else{n.buildDataStructure(a[l],o,i);let e=a[l].relationship.rid+"|"+a[l].cadid;n._cyclicArrayList.push(e)}else t.push(a[l].cadid),n.buildDataStructure(a[l],o,i);n.parentNodeData.parentNode.push({childid:a[l].cadid,parentid:o}),a[l].cadobject instanceof Object&&n.parentChildArray(a[l],t,i)}},buildDataStructure:function(e,t,i){var n=e.relationship.rid+"|"+e.cadid+"|"+Date.now();i.push({cadid:e.cadid,parentid:t,rowId:n,rid:e.relationship.rid})},buildCyclicNodeData:function(e,t){this.buildParentChildSkeleton(e);for(let t=0;t<e.length;t++)if(""!=e[t].parentid){let i=e[t].rid+"|"+e[t].cadid;if(this._cyclicArrayList.includes(i)){let i=e.find(i=>i.rid===e[t].rid);null!=i&&(this.cyclicNodeData.cyclicNodes.push({id:i.parentid,parent:i.cadid,rid:i.rid}),xcadimportinfra.OPERATION_STATE.isstandalone||e.splice(e.indexOf(i),1))}}},buildParentChildSkeleton:function(e){for(var t,i={},n=e,o=[],a=0;t=n[a++];){var l=t.cadid,d=t.parentid;l in i?i[l]=2:-1!==Object.keys(i).indexOf(d)?i[l]=2:i[l]=1}for(a=0;a<Object.entries(i).length;a++)1==Object.entries(i)[a][1]&&o.push({id:Object.entries(i)[a][0]});for(a=0;a<o.length;a++){var r=o[a].id;for(let t=0;t<e.length;t++)if(""===e[t].parentid&&e[t].cadid!==r){e.splice(e.indexOf(e[t]),1);let i=e.find(e=>e.parentid===r);if(null!=i){let e=i.rid+"|"+i.cadid;this._cyclicArrayList.includes(e)&&this._cyclicArrayList.splice(this._cyclicArrayList.indexOf(e),1)}}}},getJsonNodeStructureForGrid:function(e,t,i){var n=this;var o={mappinginfo:{}},a={};a.structure=new Array;var l={};l.nodes=new Array;var d={};d.insNodes=new Array;var r={};r.familyNodes=new Array;var s={};s.drawingOfNodes=new Array;var c={};c.linkNodes=new Array;for(var p=0;p<e.length;p++){let o,c=e[p].cadid,u=e[p].rowId;null!=e[p].familyId&&(o=e[p].familyId);let f,h,m,g="";null!=n.relationshipList&&(n.relationshipList instanceof Array&&null!=e[p].rid?f=n.relationshipList.find(t=>t.rid==e[p].rid):n.relationshipList.rid==e[p].rid&&(f=n.relationshipList.rid)),null!=f&&(m=f.cadrelationship,h=f.reluuid,g=null!=f.treeorder?f.treeorder:"");let D="";if(""!=e[p].parentid){let i=t.find(t=>t.cadid==e[p].parentid);null!=i&&(D=null!=i.phid?i.phid:i.cadid)}if(null!=t.length){let p=t.find(e=>e.cadid==c);if(null!=o&&(p=t.find(e=>e.cadid==o)),null!=p&&(n.buildNodesJson(p,u,l.nodes),"componentInstance"!==p.type&&"assemblyInstance"!==p.type||(p=t.find(e=>e.cadid==p.familyid)),null!=i))if("instance"===i){let i;if(null!=(i=null!=o?t.find(e=>e.cadid==o):t.find(e=>e.familyid==c))){n.buildStructureJson(p,D,u,g,m,h,a.structure);let e=i.cadid+"|"+Date.now();n.buildLinkTypeJson(i,p.phid,e,u,d.insNodes),n.buildNodesJson(i,e,l.nodes)}else{let o=t.find(e=>e.cadid==c);if("Drawing"!=o.bustype){let e=o.cadid+"|"+Date.now();i=t.find(e=>e.cadid==o.familyid),n.buildLinkTypeJson(o,i.phid,e,u,d.insNodes),a.structure.some(e=>e.phid===i.phid)||n.buildStructureJson(p,D,u,g,m,h,a.structure);let r=i.cadid+"|"+Date.now();n.buildNodesJson(i,r,l.nodes)}else{n.buildStructureJson(p,D,u,g,m,h,a.structure);let i="",d=e.find(e=>e.parentid==c);if(null!=d){let e=t.find(e=>e.cadid==d.cadid);i=t.find(t=>t.cadid==e.familyid).phid}let r=o.cadid+"|"+Date.now();n.buildLinkTypeJson(o,i,r,u,s.drawingOfNodes),n.buildNodesJson(o,r,l.nodes)}}}else if("family"===i){n.buildStructureJson(p,D,u,g,m,h,a.structure);let e=t.find(e=>e.cadid==c),i=e.familyid,o=t.find(e=>e.cadid==i),d=o.cadid+"|"+Date.now();n.buildLinkTypeJson(o,e.cadid,d,u,r.familyNodes),i===o.phid&&(i=e.phid),n.buildNodesJson(o,d,l.nodes)}else n.buildStructureJson(p,D,u,g,m,h,a.structure)}else if(t.cadid==c){n.buildStructureJson(t,D,u,g,m,h,a.structure),n.buildNodesJson(t,u,l.nodes);break}}if(o.mappinginfo.structure=a.structure,o.mappinginfo.nodes=l.nodes,n.cyclicInsNodeData.cyclicInsNodes.length>0){for(let e=0;e<n.cyclicInsNodeData.cyclicInsNodes.length;e++){let i=n.cyclicInsNodeData.cyclicInsNodes[e],o=t.find(e=>e.cadid==i.parent),a=t.find(e=>e.cadid==i.id);i.phid=a.phid,i.parent=o.phid,delete i.id}o.mappinginfo.circularlinks=n.cyclicInsNodeData.cyclicInsNodes,c.linkNodes.push("circularlinks")}else if(n.cyclicNodeData.cyclicNodes.length>0){for(let e=0;e<n.cyclicNodeData.cyclicNodes.length;e++){let i=n.cyclicNodeData.cyclicNodes[e],o=t.find(e=>e.cadid==i.parent),a=t.find(e=>e.cadid==i.id);i.phid=a.phid,i.parent=o.phid,delete i.id}o.mappinginfo.circularlinks=n.cyclicNodeData.cyclicNodes,c.linkNodes.push("circularlinks")}return d.insNodes.length>0&&(c.linkNodes.push("instances"),o.mappinginfo.instances=d.insNodes),r.familyNodes.length>0&&(c.linkNodes.push("family"),o.mappinginfo.family=r.familyNodes),s.drawingOfNodes.length>0&&(c.linkNodes.push("drawingof"),o.mappinginfo.drawingof=s.drawingOfNodes),c.linkNodes.length>0&&(o.mappinginfo.additionallinks=c.linkNodes),o},buildStructureJson:function(e,t,i,n,o,a,l){let d=e.phid;null==e.phid&&(d=e.cadid),xcadimportinfra.OPERATION_STATE.isstandalone?l.push({phid:d,parent:t,rowid:i,relname:o,reluuid:a,type:"",treeorder:n}):this.checkphids.includes(d)||(this.checkphids.push(d),l.push({phid:d,parent:t,rowid:i,relname:o,reluuid:a,type:"",treeorder:n}))},buildNodesJson:function(e,t,i){let n=e.phid;if(null==e.phid&&(n=e.cadid),!this._nodeDataArray.includes(e.cadid)){this._nodeDataArray.push(e.cadid);let o=xcadimportinfra.NLS_3DEXP_TYPES;i.push({phid:n,rowid:t,title:e.title,type:o[e.mx_type],cadtype:e.type,bustype:e.bustype,hashcode:e.hashcode,filename:e.filename,uuid:e.uuid,dirname:e.dirname,selected:e.selected})}},buildLinkTypeJson:function(e,t,i,n,o){this._insDataArray.includes(e.phid)||(this._insDataArray.push(e.phid),o.push({rowid:i,noderowid:n,phid:e.phid,parent:t}))}})}),define("DS/ENOXCADDataImport/views/ExpandSelect",["UWA/Class/View","DS/Utilities/Dom","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/TreeModel/DataModelSet","DS/DataGridView/DataGridView"],function(e,t,i,n,o,a){var l,d,r;return e.extend({tagName:"div",id:"xcadimport-expandselect",className:"xcadimport-expandselect",items:new Array,setup:function(e){this.items=e.items||new Array,this.handler=e.handler||function(){console.log("No event tied")},this.setupListView()},render:function(e){return e&&e.container&&this.container.inject(e.container),this},setupListView:function(){d=new o,r=new i({dataModelSet:d}),l=new a({id:"xcadimport-expandselect-datagridview",treeDocument:r,cellSelection:"none",rowSelection:"none",columns:[{id:"attribute",text:"attribute",dataIndex:"attribute",getCellSemantics:function(e){if(e.nodeModel){if("expandall"===e.nodeModel.getAttributeValue("expandid"))return{icon:"flow-tree-expand-down"};if("collapseall"===e.nodeModel.getAttributeValue("expandid"))return{icon:"flow-tree-expand-up"}}}}],defaultColumnDef:{width:"auto",typeRepresentation:"string",editableFlag:!1,resizableFlag:!0,sortableFlag:!1}}).inject(this.container),this.customizeLayout(),this.items.forEach(function(e){var t={attribute:e.value,expandid:e.id},i=n.createTreeNodeDataModel(d,{grid:t});r.addChild(i)}),t.addEventOnElement(l,l,"click",this.handler)},customizeLayout:function(){l.showRowIndexFlag=!1,l.showSelectionCheckBoxesFlag=!1,l.layout.collectionView.showAlternateBackgroundFlag=!1,l.layout.collectionView.showRowHeaderBackgroundFlag=!1,l.layout.rowsHeader=!1,l.layout.columnsHeader=!1,l.layout.rowsIndex=!1,l.layout.collectionView.showRowBorderFlag=!0},reset:function(){r.selectAll()}})}),define("DS/ENOXCADDataImport/views/AdditionalLinksFacet",["UWA/Core","UWA/Class","DS/Handlebars/Handlebars","UWA/Controls/Abstract","DS/Controls/Accordeon","DS/Controls/ModalContainer","text!DS/ENOXCADDataImport/assets/templates/linkTable.html"],function(e,t,i,n,o,a,l){"use strict";var d,r=require("DS/EditPropWidget/facets/Common/FacetsBase");require("DS/EditPropWidget/constants/EditPropConstants");return t.extend(n,r,{init:function(e){this._parent(e),d=e.xso.get()[0].options,this._initUI()},_initUI:function(){this.elements.container=e.createElement("div",{class:"additionaLinksPanel"}),this.setupData()},setupData:function(){let t=e.createElement("div",{id:"link_data_Container",class:"link-data-content"});this.elements.container.appendChild(t);let n=i.compile(l),r=[],s=d.grid.instances,c=d.grid.circularlinks,p=d.grid.family;if(null!=s&&s.length>0){let t=this.fetchData(d.grid.instances),i=e.createElement("div",{id:"instanceLinkContainer"});i.setHTML(n(t)),r.push({header:e.i18n("key_instances"),content:i,expandedFlag:!0})}if(null!=c&&c.length>0){let t=this.fetchData(d.grid.circularlinks),i=e.createElement("div",{id:"circularLinkContainer"});i.setHTML(n(t)),r.push({header:e.i18n("key_circularlinks"),content:i,expandedFlag:!0})}if(null!=p&&p.length>0){let t=this.fetchData(d.grid.family),i=e.createElement("div",{id:"familyLinkContainer"});i.setHTML(n(t)),r.push({header:e.i18n("key_family"),content:i,expandedFlag:!0})}let u=new o({domId:"xcadimport_link_accordeon",items:r,style:"simple",exclusive:!1});a.createModal(t,u)},fetchData:function(t){let i={label_title:e.i18n("import.title"),label_rev:e.i18n("import.revision"),label_type:e.i18n("import.type"),cellValue:[]};return t.forEach(e=>i.cellValue.push({value_title:e.title,value_rev:e.rev,value_type:e.type})),i}})}),define("DS/ENOXCADDataImport/views/PropetiesView",["UWA/Class/View","DS/Utilities/Utils","DS/ENOXCADUtils/utils/XCADModelEvents","DS/EditPropWidget/EditPropWidget","DS/EditPropWidget/constants/EditPropConstants","DS/EditPropWidget/models/EditPropModel","DS/ENOXCADUtils/XCADIconsPath"],function(e,t,i,n,o,a,l){"use strict";var d,r;return e.extend({_context:null,slideInfoPanel:"",_state:null,_propertiesWdg:null,setup:function(e){this.slideInfoPanel=UWA.createElement("div",{id:"slideInfoPanel",class:"slideInfo"}).inject(document.getElementById("sidebar")),this._context=e,r=e,this.launchInfoPanelDialog()},launchInfoPanelDialog:function(){var e=this,i=this._context.getNodesXSO(),a=t.debounce(function(){!0===e._state&&e._selectionChange()},100);i.onPostAdd(a),i.onPostRemove(a),i.onEmpty(a),document.contains(document.querySelector(".enxpropertiestab"))&&document.querySelector(".enxpropertiestab").destroy();var l=[o.FACET_PROPERTIES,o.FACET_RELATIONS];e._propertiesWdg=new n({className:"enxpropertiestab",readOnly:!0,typeOfDisplay:o.ALL,selectionType:o.NO_SELECTION,facets:l,actions:[{name:"action_close_panel",text:UWA.i18n("close.button.label"),icon:"close",handler:function(){e._state=!1,e._propertiesWdg.remove(),xcadimportinfra.setupPropertiesView(null,!0,!0)}}]}),d={require:"DS/ENOXCADDataImport/views/AdditionalLinksFacet",alwaysVisible:!0,services:["3DSpace"],inheritance:!0,content:null,facet:{name:"additionallinks",icon:"link",text:UWA.i18n("import.infopanel.facet.addlink")},options:{xso:this._context.getNodesXSO(),renderDiv:".explorer-root"}},e._selectionChange(),e._propertiesWdg.inject(this.slideInfoPanel),UWA.createElement("div",{id:"resizerInfoDiv",class:"resizer"}).inject(this.slideInfoPanel)},_selectionChange:function(){var e=this;e._state=!0;let t=this._context.getNodesXSO().get();if(1===t.length){let i=!0,n=new a({metatype:"businessobject",objectId:t[0].options.grid.phid,source:"3DSpace"});if(xcadimportinfra.OPERATION_STATE.showadditionallinks){document.contains(document.querySelector("#link_data_Container"))&&(document.querySelector("#link_data_Container").style.display="none");let n=t[0].options.grid.instances,a=t[0].options.grid.circularlinks,l=t[0].options.grid.family;null!=n&&n.length>0||null!=a&&a.length>0||null!=l&&l.length>0?(d.alwaysVisible=!0,e._propertiesWdg.addFacets([d]),document.contains(document.querySelector("#link_data_Container"))&&(document.querySelector("#link_data_Container").style.display="block"),null!=t[0].options.grid.platformstatus?"NOTEXISTS"===t[0].options.grid.col3dexpstat&&(e._propertiesWdg.removeFacets([o.FACET_PROPERTIES]),e._propertiesWdg.removeFacets([o.FACET_RELATIONS]),i=!1):(i=!1,e._propertiesWdg.removeFacets([o.FACET_PROPERTIES]),e._propertiesWdg.removeFacets([o.FACET_RELATIONS])),setTimeout(function(){let e=UWA.createElement("span",{id:"addlink",text:r.getNodesXSO().get()[0].options.grid.title});document.querySelector(".title-section .title").appendChild(e)},100)):(d.alwaysVisible=!1,e._propertiesWdg.removeFacets([d]))}Boolean(i)?e._propertiesWdg.initDatas([n]):(document.contains(document.querySelector(".EditProp_MainError"))&&(document.querySelector(".EditProp_MainError").style.display="none"),document.contains(document.querySelector(".IDCardMainInterface"))&&(document.querySelector(".IDCardMainInterface").style.display="block"))}else 0===t.length&&e._propertiesWdg.initDatas([])}})}),define("DS/ENOXCADDataImport/views/ImportToolBar",["UWA/Class/View","DS/UIKIT/SuperModal","DS/Controls/Abstract","DS/Controls/Toolbar","DS/Controls/TooltipModel","DS/Controls/Popup","DS/ENOXCADDataImport/views/ExpandSelect","DS/ENOXCADUtils/utils/XCADModelEvents"],function(e,t,i,n,o,a,l,d){"use strict";var r,s,c,p,u,f,h,m,g;return e.extend({tagName:"div",className:"xcadimport-homeview-tbar",id:"xcadimport-homeview-tbar",setup:function(e){s=this.options.dataGridView,this.options.dataGridView.getModel(),(r=new n({})).inject(this.container),this.setupRightBarActions()},setupRightBarActions:function(){var e=this;let t=UWA.createElement("span",{id:"sortingViewBtn",class:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-sorting xcadimport-homeview-tbar-action"});if((p=new i({tooltipInfos:new o({title:UWA.i18n("toolbar.action.sort"),shortHelp:UWA.i18n("toolbar.action.ascsort.help"),mouseRelativePosition:!0,position:"top"})})).getContent().appendChild(t),r.add("element",{element:p.getContent(),position:"far",index:3}),p.addEventListener("click",e.sortAction.bind(null,e)),xcadimportinfra.OPERATION_STATE.controlexpandbtn&&(h=UWA.createElement("span",{id:"expandBtn",class:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-flow-tree-expand-down xcadimport-homeview-tbar-action"}),(g=new i({tooltipInfos:new o({shortHelp:UWA.i18n("import.toolbar.action.expand"),mouseRelativePosition:!0,position:"top"})})).getContent().appendChild(h),r.add("element",{element:g.getContent(),position:"far",index:0}),e.expandAction()),xcadimportinfra.OPERATION_STATE.traverseupdownkey){let t=UWA.createElement("div",{id:"updown-seperator",class:"toolbar-seperator"});r.add("element",{element:t,position:"far",index:3}),u=!0;let n=UWA.createElement("span",{id:"downBtn",class:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-double-chevron-down xcadimport-homeview-tbar-action tbar-updown-action"}),a=new i({tooltipInfos:new o({shortHelp:UWA.i18n("toolbar.action.down.help"),mouseRelativePosition:!0,position:"top"})});a.getContent().appendChild(n),r.add("element",{element:a.getContent(),position:"far",index:3}),a.addEventListener("click",e.downCheckBoxSelection.bind(null,e));let l=UWA.createElement("span",{id:"upBtn",class:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-double-chevron-up xcadimport-homeview-tbar-action tbar-updown-action"}),d=new i({tooltipInfos:new o({shortHelp:UWA.i18n("toolbar.action.up.help"),mouseRelativePosition:!0,position:"top"})});d.getContent().appendChild(l),r.add("element",{element:d.getContent(),position:"far",index:3}),d.addEventListener("click",e.upCheckBoxSelection.bind(null,e))}if(xcadimportinfra.OPERATION_STATE.showtoplevelassembly){let t=UWA.createElement("span",{id:"linkBtn",class:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-tree-view-root xcadimport-homeview-tbar-action"});(c=new i({tooltipInfos:new o({title:UWA.i18n("toolbar.action.link"),shortHelp:UWA.i18n("toolbar.action.link.help"),mouseRelativePosition:!0,position:"top"})})).getContent().appendChild(t),r.add("element",{element:c.getContent(),position:"far",index:3}),c.addEventListener("click",e.topAsmDisplayAction.bind(null,e))}},downCheckBoxSelection:function(e,t){u?(s.setFindStr("cell_checkbox_visible",!0,0,void 0,!0),u=!1):s.goToNextMatchingCell()},upCheckBoxSelection:function(e,t){u?(s.setFindStr("cell_checkbox_visible",!0,0,void 0,!0),u=!1):s.goToPreviousMatchingCell()},expandAction:function(){var e=[{id:"expandall",value:UWA.i18n("import.expandselect.expandall")},{id:"collapseall",value:UWA.i18n("import.expandselect.collapseall")}];m=new l({items:e,handler:function(e,t){let i=s.getTreeDocument().getSelectedNodes();for(let e=0;e<i.length;e++)"expandall"===t.nodeModel.options.grid.expandid?i[e].expandAll():"collapseall"===t.nodeModel.options.grid.expandid&&i[e].collapseAll()}}),f&&f.destroy(),(f=new a({domId:"xcadimport-expand-popup",target:g,offset:{x:-100,y:22},trigger:"click"})).addEventListener("show",function(){h.addClassName("xcadimport-expandicon-pressed")}),f.addEventListener("hide",function(){h.removeClassName("xcadimport-expandicon-pressed")}),f.setBody(m.getContent())},topAsmDisplayAction:function(e,t){let i=!1;t.target.classList.contains("selected")?(c.tooltipInfos.shortHelp=UWA.i18n("toolbar.action.link.help"),document.querySelector("#linkBtn").classList.value="wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-tree-view-root xcadimport-homeview-tbar-action",t.target.classList.remove("selected"),i=!0):(c.tooltipInfos.shortHelp=UWA.i18n("toolbar.action.linkall.help"),document.querySelector("#linkBtn").classList.value="wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-tree-view-all xcadimport-homeview-tbar-action",t.target.classList.add("selected")),s.treeDocument.getAllDescendants().forEach(function(e){Boolean(i)?e.show():"N"===e.options.grid.rootnode&&e.hide()})},sortAction:function(e,t){xcadimportinfra.IS_SORTING_ASC?(xcadimportinfra.IS_SORTING_ASC=!1,s.sortModel=[{dataIndex:"tree",sort:"asc"}],p.tooltipInfos.shortHelp=UWA.i18n("toolbar.action.ascsort.help"),document.querySelector("#sortingViewBtn").classList.value="wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-alpha-sorting-a-z xcadimport-homeview-tbar-action"):(xcadimportinfra.IS_SORTING_ASC=!0,s.sortModel=[{dataIndex:"tree",sort:"desc"}],p.tooltipInfos.shortHelp=UWA.i18n("toolbar.action.descsort.help"),document.querySelector("#sortingViewBtn").classList.value="wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-alpha-sorting-z-a xcadimport-homeview-tbar-action"),t.target.classList.contains("selected")||t.target.classList.add("selected")},nodeSelection:function(e){xcadimportinfra.OPERATION_STATE.controlexpandbtn&&(e.length>0?xcadimportinfra.enabledisableButtons(["#expandBtn"],!0):xcadimportinfra.enabledisableButtons(["#expandBtn"],!1))}})}),define("DS/ENOXCADDataImport/views/ImportDataGridView",["UWA/Class","UWA/Promise","UWA/Core","DS/Utilities/Dom","DS/Controls/Button","DS/Controls/Toggle","DS/Controls/TooltipModel","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/TreeModel/DataModelSet","DS/DataGridView/DataGridView","DS/ENOXCADUtils/XCADIconsPath","DS/ENOXCADUtils/views/CADSearch","DS/ENOXCADUtils/utils/XCADModelEvents","DS/ENOXCADDataImport/views/ImportToolBar"],function(e,t,i,n,o,a,l,d,r,s,c,p,u,f,h){"use strict";var m,g,D,y,w,S,A,b,x,E;return e.extend({_cadsearchview:null,_selectedIdx:null,init:function(){xcadimportinfra.resizeWindow()},setUpView:function(e){var t=this;t.setDataGridView(),t.createToolbar(),t.createFooterButton(),xcadimportinfra.OPERATION_STATE.controlexpandbtn&&xcadimportinfra.enabledisableButtons(["#expandBtn"],!1),x=xcadimportinfra.PROPAGATION_RULE,E=xcadimportinfra.BUS_TYPE_MAPPING,f.subscribe({event:"xcadimport:onSearch"},function(e){t.callSearchEvent(e)}),f.subscribe({event:"xcadimport:onResetSearch"},function(){t.closeSearch(!0)})},_gridViewCheckbox:function(e){document.querySelectorAll(".wux-layouts-datagridview-column-header-cell .wux-datagridview-selection-checkbox")[0].style.display=e},fillGridData:function(e){var t=this;xcadimportinfra.OPERATION_STATE.treeview?(b=!0,m.withTransactionUpdate(function(){e.forEach(function(e){let i=t.insertinGrid(e);!function e(i,n){if(null!=i.child)for(var o=0;o<i.child.length;o++){let a=i.child[o],l=t.insertinGrid(a);n.addChild(l),e(a,l)}}(e,i),m.addChild(i)})}),xcadimportinfra.OPERATION_STATE.treeexpandonelevel?m.expandNLevels(1):m.expandAll(),xcadimportinfra.OPERATION_STATE.defaultsortasc&&(xcadimportinfra.IS_SORTING_ASC=!1,D.sortModel=[{dataIndex:"tree",sort:"asc"}],document.querySelector("#sortingViewBtn").classList.value="wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-alpha-sorting-a-z xcadimport-homeview-tbar-action")):(b=!1,m.withTransactionUpdate(function(){e.forEach(function(e){let i=t.insertinGrid(e);m.addChild(i)})}),t.updateButtonContext()),setTimeout(()=>{D.treeDocument.getAllDescendants().some(e=>!0===e.options.grid.iscellvisisble)?t._gridViewCheckbox("block"):t._gridViewCheckbox("none")},100)},insertinGrid:function(e){p.updateGridIconPath(xcadimportinfra.X3D_URL_3DSPACE,e);let t=r.createTreeNodeDataModel(g,{label:e.title,icons:[{iconPath:p.getTypeIconPath(xcadimportinfra.X3D_URL_3DSPACE,e,xcadimportinfra.ICON_NONPS_TYPES)}],grid:e});return t.onSelect(function(){let e=arguments[0].target.getTreeDocument().getSelectedNodes();y.nodeSelection(e)}),t.onUnselect(function(){let e=arguments[0].target.getTreeDocument().getSelectedNodes();y.nodeSelection(e)}),t},updateButtonContext:function(){let e=D.treeDocument.getAllDescendants().every(e=>"EXISTS"===e.options.grid.col3dexpstat),t=D.treeDocument.getAllDescendants().every(e=>"Unchanged"===e.options.grid.colsuppstat);Boolean(e)&&Boolean(t)?(w.disabled=!1,S="openfrom3dexp",A=!0):D.treeDocument.getAllDescendants().every(e=>"NOTEXISTS"===e.options.grid.col3dexpstat)?(w.disabled=!1,S="openasnew",A=!0):(w.disabled=!1,S="openfrompackage",A=!1)},setDataGridView:function(){g=new s,m=new d({dataModelSet:g}),(D=new c({identifier:"dataGridView",treeDocument:m,cellSelection:"none",rowSelection:"multiple",columnSelection:"single",columns:[{id:"openpackage",text:"",dataIndex:"openpackage",typeRepresentation:"boolean",editionPolicy:"EditionInPlace",editableFlag:!0,columnSelection:!0,width:"30",minWidth:"10",getCellValueAsStringForFind:function(e){return e.nodeModel.options.grid.iscellvisisble?"cell_checkbox_visible":"cell_checkbox_notvisible"},getCellSemantics:function(e){e.nodeModel&&(xcadimportinfra.OPERATION_STATE.isstandalone?Boolean(D.treeDocument.getAllDescendants().every(e=>0==e.options.grid.openpackage))?w.disabled=!0:w.disabled=!1:!0===e.nodeModel.options.grid.openpackage&&(w.disabled=!1,S="openfrompackage",A=!1))},hasCellValue:function(e){if(e.nodeModel){let t=e.nodeModel.options.grid.purposekey,i=e.nodeModel.options.grid.colsuppstat,n=e.nodeModel.options.grid.col3dexpstat,o=null!=e.nodeModel.options.grid.isimportmodfiles&&e.nodeModel.options.grid.isimportmodfiles;if(xcadimportinfra.OPERATION_STATE.isstandalone&&"New"===i&&!o&&e.nodeModel.getParents().some(e=>"MODIFIED"===e.options.grid.col3dexpstat&&"Modified"===e.options.grid.colsuppstat))return e.nodeModel.options.grid.iscellvisisble=!1,!1;if("readonly"===t||"exclude"===t||"forceexclude"===t)return e.nodeModel.options.grid.iscellvisisble=!1,!1;if("Unchanged"===i||"Deleted"===i)return e.nodeModel.options.grid.iscellvisisble=!1,!1;if(null!=n){if(!o&&("MODIFIED"===n||"NOTEXISTS"===n))return e.nodeModel.options.grid.iscellvisisble=!1,!1;if("Unchanged"===i&&"EXISTS"===n)return e.nodeModel.options.grid.iscellvisisble=!1,!1}e.nodeModel.options.grid.iscellvisisble=!0}return!0}},{id:"title",text:i.i18n("import.title"),dataIndex:"tree",selectableFlag:!1},{id:"rev",text:i.i18n("import.revision"),dataIndex:"rev",selectableFlag:!1},{id:"purpose",text:i.i18n("import.exportview"),dataIndex:"purpose",selectableFlag:!1,minWidth:60,maxWidth:250,getCellKPIColor:function(e){if(e.nodeModel&&xcadimportinfra.OPERATION_STATE.isstandalone){let t=e.nodeModel.options.grid.purposekey;if("edit"===t)return"#57B847";if("readonly"===t)return"#EA4F37"}}},{id:"platformstatus",text:i.i18n("import.platformview"),dataIndex:"platformstatus",selectableFlag:!1,minWidth:60,maxWidth:250,getCellKPIColor:function(e){if(e.nodeModel){let t=e.nodeModel.options.grid.col3dexpstat;if("EXISTS"===t)return"#57B847";if("MODIFIED"===t)return"#E87B00";if("NOTEXISTS"===t)return"#EA4F37"}}},{id:"supplierstatus",text:i.i18n("import.supplierview"),dataIndex:"supplierstatus",selectableFlag:!1,minWidth:60,maxWidth:250,getCellKPIColor:function(e){if(e.nodeModel){let t=e.nodeModel.options.grid.colsuppstat;if("New"===t)return"#42A2DA";if("Unchanged"===t)return"#57B847";if("Modified"===t)return"#E87B00";if("Deleted"===t)return"#EA4F37"}}}],defaultColumnDef:{width:"auto",editableFlag:!1,resizableFlag:!0,refineFlag:!0,filterFlag:!0,sortableFlag:!1},showmodelChangesFlag:!0,showRowBorderFlag:!0,getCellTooltip:function(e){if(e.nodeModel){if(0!=e.columnID)return{shortHelp:e.cellModel,updateModel:!1}}else if(null==e.nodeModel)return""===e.cellModel?{shortHelp:i.i18n("import.open.package"),updateModel:!1}:{shortHelp:e.cellModel,updateModel:!1}}})).layout.columnHeaderHeight=35,D.layout.cellHeight=35,D.layout.collectionView.showAlternateBackgroundFlag=!1,D.layout.rowsHeader=!1,D.showRowIndexFlag=!1;var e=new i.Element("div",{id:"gridContainer",class:"import-grid-container"});e.inject(document.getElementById("centreContainer")),D.inject(e),D.addEventListener("change",this._updateSelectionCells.bind(this));var t=D.getColumnsXSO();t.onPostAdd(function(e){D.getTreeDocument().search({match:function(e){e.nodeModel.getAttributeValue("iscellvisisble")&&e.nodeModel.updateOptions({grid:{openpackage:!0}})}})}),t.onPostRemove(function(e){D.getTreeDocument().search({match:function(e){e.nodeModel.getAttributeValue("iscellvisisble")&&e.nodeModel.updateOptions({grid:{openpackage:!1}})}})})},hidePlatformColumn:function(){D.columns.find(e=>"platformstatus"===e.id).visibleFlag=!1},_updateSelectionCells:function(e,t){if(t&&t.nodeModel&&t.nodeModel.options.grid)switch(D.layout.getDataIndexFromColumnIndex(t.columnID)){case"openpackage":let e=t.nodeModel.options.grid.openpackage;this.checkSelection(t.nodeModel,e,!1)}},checkSelection:function(e,t,i){function n(e,t,i){if(Boolean(xcadimportinfra.IS_PROP_RULE)){let n=e.options.grid.cadtype,a=!1;if(null!=n&&null!=x.cadtype&&x.cadtype.includes(n)&&x.cadtype.includes(t))a=!0;else if(null!=n&&null!=x.cadtype_class){let e=E.find(e=>e.class.includes(x.cadtype_class));e.type.toLowerCase()===n.toLowerCase()&&e.type.toLowerCase()===t.toLowerCase()&&(a=!0)}Boolean(a)&&null!=e&&(Boolean(i)&&(e=e.getParent()),o(e))}}function o(e){e.updateOptions({grid:{openpackage:t}})}function a(e){if(null!=e.options.grid.composerid){let t=D.getTreeDocument().getAllDescendants().filter(t=>t.options.grid.phid===e.options.grid.composerid);for(let e of t)o(e);let i=D.getTreeDocument().getAllDescendants().filter(t=>t.options.grid.composerid===e.options.grid.composerid);for(let e of i)n(e,e.options.grid.cadtype,!0)}else{let t=D.getTreeDocument().getAllDescendants().filter(t=>t.options.grid.composerid===e.options.grid.phid);for(let e of t)o(e)}let t=D.getTreeDocument().getAllDescendants().filter(t=>t.options.grid.phid===e.options.grid.phid);for(let e of t)o(e)}if(Boolean(t))if(Boolean(b)){let l=[];if("New"===e.options.grid.colsuppstat&&(e.isRoot()||null==e.getParent()||e.getParent().options.grid.openpackage==t||o(e.getParent())),!i&&xcadimportinfra.OPERATION_STATE.isstandalone&&(l.push(e.options.grid.phid),a(e)),null!=e.getChildren()&&e.getChildren().length>0){let i=e.getAllDescendants();for(let e of i)"New"===e.options.grid.colsuppstat&&null!=e.getParent()&&e.getParent().options.grid.openpackage!=t?o(e.getParent()):(o(e),n(e,e.options.grid.cadtype,!1)),xcadimportinfra.OPERATION_STATE.isstandalone&&!l.includes(e.getParent().options.grid.phid)&&(l.push(e.getParent().options.grid.phid),a(e.getParent()))}}else{let i=e.options.grid.cadtype;null!=e.getParent()&&e.getParent().options.grid.openpackage!=t&&(n(e.getParent(),i,!1),this.checkSelection(e.getParent(),t,!0))}else{if(Boolean(b)){"New"===e.options.grid.colsuppstat&&null!=e.getParent()&&e.getParent().options.grid.openpackage!=t&&o(e.getParent())}if(!i&&xcadimportinfra.OPERATION_STATE.isstandalone&&a(e),null!=e.getChildren()&&e.getChildren().length>0)for(let i=0;i<e.getChildren().length;i++)e.getChildren()[i].options.grid.openpackage!=t&&(Boolean(b)&&"New"===e.getChildren()[i].options.grid.colsuppstat&&o(e.getChildren()[i]),null==e.getChildren()[i].options.grid.composerid&&n(e.getChildren()[i],e.getChildren()[i].options.grid.cadtype,!1),this.checkSelection(e.getChildren()[i],t,!0))}},createToolbar:function(){let e=document.getElementById("topContainer"),t=i.createElement("div").inject(e);(y=new h({dataGridView:D})).inject(t)},createFooterButton:function(){var e=this;let t="button-opensession";xcadimportinfra.OPERATION_STATE.footercancelbtn&&(t="button-open-opensession");let n=document.getElementById("footerdiv");if(w=new o({domId:t,label:i.i18n("import.open.button.label"),emphasize:"primary",disabled:!0,onClick:function(t){let i={operation:"openfromimportpanel",version:"1.0",data:{sessionstatus:S,sessiondata:[]}};D.getTreeDocument().search({match:function(t){let n=t.nodeModel,o=n.options.grid.openpackage;Boolean(A)?o=!0:Boolean(n.options.grid.iscellvisisble)||(o="na");let a=n.options.grid.filepath+"\\"+n.options.grid.filename,l=n.options.grid.phid;"openfrompackage"===S&&"New"===n.options.grid.colsuppstat&&(l="");let d="boolean"==typeof o?o.toString():o,r={phid:l,filepath:a,isrootnode:"Y"===n.options.grid.rootnode,parentphid:n.options.grid.parent,colsuppstat:n.options.grid.colsuppstat,col3dexpstat:e.convertStatus(n.options.grid.col3dexpstat),purposeatexp:e.convertStatus(n.options.grid.purposekey),coluserselecton:d};xcadimportinfra.IS_FILE_RENAMING&&(r.orig_filename=null!=n.options.grid.filename?n.options.grid.filename:"",r.def_filename=null!=n.options.grid.def_filename?n.options.grid.def_filename:"",r.tgt_filename=null!=n.options.grid.tgt_filename?n.options.grid.tgt_filename:""),i.data.sessiondata.push(r)}}),i.data.sessiondata.length>0&&f.publish({event:"webinwin:web:notification",data:i})}}).inject(n),xcadimportinfra.OPERATION_STATE.footercancelbtn&&new o({domId:"button-opensession",label:i.i18n("import.cancel.button.label"),emphasize:"secondary",disabled:!1,onClick:function(e){f.publish({event:"webinwin:web:notification",data:{operation:"cancelview",version:"1.0"}})}}).inject(n),null!=xcadimportinfra.OPERATION_STATE.consecutiveimport&&xcadimportinfra.OPERATION_STATE.consecutiveimport){let t=new a({type:"checkbox",domId:"import-modify-files-checkbox",label:i.i18n("import.footer.importmodfiles")});function d(){const e=document.querySelector("#import-modify-files-checkbox"),t=document.querySelector("#button-opensession").offsetWidth,i=document.querySelector("#button-open-opensession").offsetWidth;let n=window.innerWidth;n=n-(t+i)-20,e.style.width=n+"px"}t.tooltipInfos=new l({shortHelp:i.i18n("import.footer.importmodfiles")}),t.inject(n),setTimeout(()=>{let e=document.querySelector("#import-modify-files-checkbox>.wux-icon").clientWidth,t=document.querySelector("#import-modify-files-checkbox>.wux-label").clientWidth;document.querySelector("#import-modify-files-checkbox").style.width=(e+t+30).toString()+"px"},600),d(),window.addEventListener("resize",d),t.addEventListener("change",()=>{D.getTreeDocument().search({match:function(e){if("MODIFIED"===e.nodeModel.options.grid.col3dexpstat&&"Modified"===e.nodeModel.options.grid.colsuppstat){let i={isimportmodfiles:t.checkFlag};if(t.checkFlag?i.openpackage=null!=e.nodeModel.options.grid.openpkgref&&e.nodeModel.options.grid.openpkgref:(i.openpkgref=e.nodeModel.options.grid.openpackage,i.openpackage=!1),e.nodeModel.updateOptions({grid:i}),null!=e.nodeModel.getChildren())for(let t of e.nodeModel.getChildren())"New"===t.options.grid.colsuppstat&&t.updateOptions({grid:i})}}}),D.treeDocument.getAllDescendants().some(e=>!0===e.options.grid.iscellvisisble)?(e._gridViewCheckbox("block"),D.treeDocument.getAllDescendants().some(e=>!0===e.options.grid.openpackage)&&(w.disabled=!1)):(e._gridViewCheckbox("none"),w.disabled=!0)})}},convertStatus:function(e){let t;switch(e){case"readonly":t="Read-only";break;case"edit":t="For Edit";break;case"exclude":t="Exclude";break;case"forceexclude":t="Force Exclude";break;case"EXISTS":t="Existing";break;case"NOTEXISTS":t="Not Exists";break;case"MODIFIED":t="Modified"}return t},callSearchEvent:function(e){var t=this;if(D.setFindStr(e,!0,0,void 0,!0),D.matchingStringCount>1&&(t.initCADSearch(),null!=t._cadsearchview)){t._selectedIdx=1;let e=t._selectedIdx+"/"+D.matchingStringCount;t._cadsearchview.setLabel(e),t._cadsearchview.show()}},initCADSearch:function(){var e=this;null===e._cadsearchview&&(e._cadsearchview=new u({renderTo:document.body,callbacks:{onPrevious:function(){e.focusChange({event:"previous"})},onNext:function(){e.focusChange({event:"next"})},onSelectAll:function(){e.findAutoSelect(D.findStr)},onClose:function(){e.closeSearch(!0)}}}))},focusChange:function(e){var t=this;if(null!==t._cadsearchview){"previous"==e.event&&t._selectedIdx>1&&(D.goToPreviousMatchingCell(),t._selectedIdx--),"next"==e.event&&t._selectedIdx<D.matchingStringCount&&(D.goToNextMatchingCell(),t._selectedIdx++);let i=t._selectedIdx+"/"+D.matchingStringCount;t._cadsearchview.setLabel(i)}},findAutoSelect:function(e){var t=this;D.onFindAutoSelect.call(D,{autoSelect:{autoSelect:{value:!0,modified:!0}}},function(e){t.closeSearch(!1)})},closeSearch:function(e){this._cadsearchview&&(this._cadsearchview.hide(),delete this._cadsearchview),Boolean(e)&&D.closeFind()},getDataGrid:function(){return D},isOpenBtnEnabled:function(){return!w.disabled}})}),define("DS/ENOXCADDataImport/views/ImportView",["UWA/Class","UWA/Core","DS/Controls/ModalContainer","DS/Controls/Loader","DS/ENOXCADDataImport/utils/ImportWSProxy","DS/ENOXCADDataImport/views/ImportDataGridView","DS/ENOXCADDataImport/utils/XMLToJsonChekinResConversion","DS/ENOXCADDataImport/utils/CompareResponseData","DS/ENOXCADDataImport/utils/JSONDataMapper","DS/ENOXCADUtils/utils/XCADModelEvents","DS/ENOXCADUtils/XCADNotification"],function(e,t,i,n,o,a,l,d,r,s,c){var p,u,f,h;return e.extend({_busTypeMapping:null,_relTypeMapping:null,_initJson:null,initializeView:function(e){this._initJson=e.initJson,u={operation:"initfordataexchange",version:"1.0",data:{}},f=new n,i.createModal(document.getElementById("mainContainer"),f.elements.container),this.setInfraData(),this.callWebservice()},render:function(e){return this},render3Ddrive:function(e){let t=null!=e.isplmCSAEnabled&&/true/.test(e.isplmCSAEnabled);if("OnPremise"!==e.tenantId&&t){s.subscribe({event:"ENOXCADDataImport/RenderDrive"},function(e){s.publish({event:"webinwin:web:notification",data:e}),h.closeDialog()}),widget.setValue("isplmcsaEnabled",t),widget.setValue("x3dPlatformId",e.tenantId);let i=null!=e.packageextns&&e.packageextns.length>0?e.packageextns:["zip"],n=e.url3DSpace.replace("space","drive"),o={tenantname:"DSSANDBOX - "+e.tenantId,url3DSpace:e.url3DSpace,url3DDrive:n};require(["DS/ENOXCADDataExchangeUI/utils/ImportSelection"],function(t){h=new t({tenantid:e.tenantId,extension:i,isstandalone:!0,servicejson:o})})}},setInfraData:function(){let e=this._initJson.data.infra;f.on(t.i18n("import.loading.label")),xcadimportinfra.X3D_SECURITY_CONTEXT=e.securitycontext,xcadimportinfra.X3D_LANG=e.lang,xcadimportinfra.X3D_INTEGRATION=e.integration,xcadimportinfra.X3D_URL_3DSPACE=e.url3DSpace},callWebservice:function(){var e=this;o.getCadTypeMapping().then(function(t){e._busTypeMapping=t.bustype,e._relTypeMapping=t.reltype;let i=t.nls_3dexptypes,n=t.icons_nonPStypes;xcadimportinfra.BUS_TYPE_MAPPING=e._busTypeMapping,xcadimportinfra.NLS_3DEXP_TYPES=i,xcadimportinfra.ICON_NONPS_TYPES=n,u.data.status="success",u.data.message="Init Message",s.publish({event:"webinwin:web:notification",data:u})},function(e){u.data.status="failure",u.data.message=e,s.publish({event:"webinwin:web:notification",data:u})}).then(function(){null!=e._initJson.data.checkindata&&"xml"===e._initJson.data.checkindata.type&&e.passXMLData(e._initJson.data.checkindata.checkinresponse)})},passXMLData:function(e){let n={operation:"importresults",version:"1.0",data:{}},u=null,h=null,m=l.transform(e);if("success"===m.jsondata.result){let e=m.jsondata.data.mappinginfo;u=this.buildDataGridMapper(e),null!=m.jsondata.exportmap.packagename&&function(e){xcadimportinfra.OPERATION_STATE.isstandalone&&(e=t.i18n("import.package.label")+": "+e),document.querySelector("#headerContainer").classList.add("header-container");let i=new t.Element("span",{class:"header-package-name",html:e});document.querySelector("#headerContainer").setContent(i)}(m.jsondata.exportmap.packagename),xcadimportinfra.IS_FILE_RENAMING=null!=m.jsondata.exportmap.supportedfeatures&&null!=m.jsondata.exportmap.supportedfeatures.filerenaming&&/true/.test(m.jsondata.exportmap.supportedfeatures.filerenaming);let l=m.jsondata.exportmap.exportdata[0].mappinginfo;h=this.buildDataGridMapper(l),xcadimportinfra.OPERATION_STATE.isstandalone&&(h=h.filter(e=>{switch(e.purposekey){case"exclude":case"forceexclude":return!1}return!0}));let g=d.buildData(h,u,l.nodes),D=g.resultArray;if(xcadimportinfra.OPERATION_STATE.isstandalone){let e=[];D=D.filter(t=>(!e.includes(t.phid)||"Y"!==t.rootnode)&&(e.includes(t.phid)||e.push(t.phid),!0))}let y=!1;o.getPlatformStatus(g.ceStampArray,g.macroceStampArray).then(function(e){Array.from(e).forEach(i=>{D.filter(e=>e.phid===i.id).forEach(n=>{if(null!=i.status){if(xcadimportinfra.OPERATION_STATE.isstandalone&&n.typeclass.includes("TYPE_EMBEDDED_COMPONENT_LIKE")){let t=e.find(e=>e.id===n.parent);i.status=t.status}n.col3dexpstat=i.status,"EXISTS"===i.status?n.platformstatus=t.i18n("status_existing"):"NOTEXISTS"===i.status?n.platformstatus=t.i18n("status_notexist"):"MODIFIED"===i.status&&(n.platformstatus=t.i18n("status_modified"))}})})}).catch(e=>{y=!0,console.log(e)}).finally(()=>{if((p=new a).setUpView(),Boolean(y)&&p.hidePlatformColumn(),D.length>0)if(xcadimportinfra.OPERATION_STATE.treeview){let e=r.createSkeletonOfDataGrid(D);p.fillGridData(e)}else p.fillGridData(D);f.off(t.i18n("import.loading.label")),i.removeModal(document.getElementById("mainContainer")),D.length>0?c.sucessMsg(t.i18n("load_data_success")):c.infoMsg(t.i18n("import.file.status")),n.data.status="success",n.data.message="Data Loaded Successfully",s.publish({event:"webinwin:web:notification",data:n})})}else n.data.status="failure",n.data.message=m.jsondata.data,c.errorMsg(m.jsondata.data),s.publish({event:"webinwin:web:notification",data:n})},buildDataGridMapper:function(e){let t=e.structure,i=e.nodes,n=[],o=[],a=[],l=[];return null!=e.instances&&(n=e.instances),null!=e.family&&(o=e.family),null!=e.circularlinks&&(a=e.circularlinks),null!=e.drawingof&&(l=e.drawingof),r.parseData({busTypeMapping:this._busTypeMapping,relTypeMapping:this._relTypeMapping,structureArray:t,nodesArray:i,instanceArray:n,familyArray:o,circularlinksArray:a,drawingOfArray:l})},getDataGrid:function(){return p.getDataGrid()},isOpenBtnEnabled:function(){return p.isOpenBtnEnabled()}})}),define("DS/ENOXCADDataImport/utils/XCADImportInfra",["UWA/Drivers/Alone","UWA/Core","DS/ENOXCADDataImport/views/ImportView","DS/ENOXCADUtils/XCADNotification","DS/ENOXCADDataImport/views/PropetiesView","DS/ENOXCADDataImport/utils/ElementODTInfra","text!DS/ENOXCADDataImport/assets/Settings.json","i18n!DS/ENOXCADDataImport/assets/nls/ImportNLS"],function(e,t,i,n,o,a,l,d){var r,s,c,p;UWA.i18n(d),window.xcadimportinfra={X3D_PLATFORM_ID:"",X3D_SECURITY_CONTEXT:"",X3D_LANG:"",X3D_INTEGRATION:"",X3D_URL_3DSPACE:"",IS_SORTING_ASC:!0,IS_PROP_RULE:!1,OPERATION_STATE:"",BUS_TYPE_MAPPING:"",NLS_3DEXP_TYPES:"",ICON_NONPS_TYPES:"",PROPAGATION_RULE:"",IS_FILE_RENAMING:!1,_isFileSelection:!1,CHECK_SELECTION:!1,get:function(e){return widget.getValue(e)},set:function(e,t){widget.setValue(e,t)},defineProtocol:function(e){switch(e.operation){case"fileselection":parseFloat(e.version)>=1&&(xcadimportinfra._isFileSelection=!0,(r=new i).render(),r.render3Ddrive(e.data));break;case"initfordataexchange":if(parseFloat(e.version)>=1){if(function(e){let t=JSON.parse(l),i=Object.keys(t).find(t=>e.includes(t));xcadimportinfra.OPERATION_STATE=t[i]}(e.data.infra.integration.toLowerCase()),null!=e.data.customsettings){let t=e.data.customsettings;xcadimportinfra.OPERATION_STATE.consecutiveimport=null!=t.consecutiveimport&&/true/.test(t.consecutiveimport),xcadimportinfra.CHECK_SELECTION=null!=t.checkselection&&/true/.test(t.checkselection)}null!=e.data.isplmCSAEnabled&&xcadimportinfra.set("isplmCSAEnabled",!0),null!=e.data.propagation_rule?(xcadimportinfra.IS_PROP_RULE=!0,xcadimportinfra.PROPAGATION_RULE=e.data.propagation_rule):xcadimportinfra.IS_PROP_RULE=!1;let t=[];if(xcadimportinfra.OPERATION_STATE.supportextension&&null!=e.data.extension)for(let i=0;i<e.data.extension.length;i++){let n="."+e.data.extension[i];t.push(n)}xcadimportinfra.X3D_PLATFORM_ID=e.data.infra.tenantid,xcadimportinfra.updateWidgetInfra(e.data.infra.securitycontext),xcadimportinfra.setbodyDiv(),xcadimportinfra._isFileSelection||(r=new i).render(),r.initializeView({initJson:e})}break;case"checkinresponse":1==parseFloat(e.version)&&"xml"==e.data.type&&r.passXMLData(e.data.response);break;case"exchangenotification":1==parseFloat(e.version)&&("success"===e.data.status?n.infoMsg(e.data.message):n.errorMsg(e.data.message));break;case"elementactionodt":a.elementAction(e,r.getDataGrid(),r.isOpenBtnEnabled())}},updateWidgetInfra:function(e){let t;if(0==e.indexOf("ctx::")){let i=(e=e.split("::"))[e.length-1];t=(i=i.split("."))[i.length-1]}else t=(e=e.split("."))[e.length-1];if(widget.setTitle(t),"OnPremise"!==xcadimportinfra.X3D_PLATFORM_ID){let e=widget.getTitle().concat(" ("+xcadimportinfra.X3D_PLATFORM_ID+")");widget.setTitle(e)}},enabledisableButtons:function(e,t){for(let i of e)t?(document.querySelector(i).style.pointerEvents="auto",document.querySelector(i).style.opacity="1.1",document.querySelector(i).setData("isButtonEnabled",t)):(document.querySelector(i).style.pointerEvents="none",document.querySelector(i).style.opacity="0.4",document.querySelector(i).setData("isButtonEnabled",t))},setupPropertiesView:function(e,t,i){if(document.contains(document.getElementById("slideInfoPanel"))&&i&&(t&&(document.getElementById("infoBtn").classList.remove("selected"),document.getElementById("sidebar").classList.toggle("collapsed"),document.getElementById("centreContainer").classList.remove("divmaxwidth"),document.getElementById("centreContainer").style.width="100%"),document.getElementById("resizerInfoDiv").remove(),document.getElementById("slideInfoPanel").remove()),null!=e){new o(e);xcadimportinfra.resizeDivOnDrag()}},resizeDivOnDrag:function(){var e,t,i,n=document.querySelector("#sidebar"),o=document.querySelector(".resizer"),a=document.querySelector(".centrepanel");function l(o){n.style.width=t-o.clientX+e+"px",a.style.width=i+o.clientX-e+"px"}function d(e){document.documentElement.removeEventListener("mousemove",l,!1),document.documentElement.removeEventListener("mouseup",d,!1),document.getElementById("centreContainer").style.width=a.style.width,p=a.style.width}o.addEventListener("mousedown",function(o){e=o.clientX,t=parseInt(document.defaultView.getComputedStyle(n).width,10),parseInt(document.defaultView.getComputedStyle(n).left,10),i=parseInt(document.defaultView.getComputedStyle(a).width,10),document.documentElement.addEventListener("mousemove",l,!1),document.documentElement.addEventListener("mouseup",d,!1)},!1)},centrePanelNewWidth:function(){return p},setCentrePanelNewWidth:function(e){p=e},resizeWindow:function(){window.addEventListener("resize",function(){null!=s&&(c=s);if(s=Math.min(window.innerWidth,document.documentElement.clientWidth),null!=c&&c!=s&&(console.log("Window new width =>"+s),document.contains(document.getElementById("resizerInfoDiv")))){let e,t,i,n=document.querySelector("#sidebar"),o=document.querySelector("#centreContainer");i=parseInt(s,10),e=parseInt(document.defaultView.getComputedStyle(n).width,10);let a=(t=parseInt(document.defaultView.getComputedStyle(o).width,10))+e;if(a>i){let l=(a-i)/2;n.style.width=e-l+"px",o.style.width=t-l+"px"}else if(a<i){let l=(i-a)/2;n.style.width=e+l+"px",o.style.width=t+l+"px"}p=o.style.width}})},setbodyDiv:function(){this._mainContainer=UWA.createElement("div",{id:"mainContainer",html:[{tag:"div",id:"headerContainer"},{tag:"div",id:"topContainer"},{tag:"div",id:"centreContainer",class:"centrepanel"},{tag:"div",id:"sidebar",class:"collapsed"},{tag:"div",id:"footerdiv",class:"footerpanel"}]}),widget.setBody(this._mainContainer)}}}),define("DS/ENOXCADDataImport/ENOXCADDataImport",["DS/MessageBus/MessageBus","DS/PlatformAPI/PlatformAPI","DS/ENOXCADDataImport/utils/XCADImportInfra","DS/ENOXCADUtils/utils/XCADModelEvents","css!DS/ENOXCADDataImport/ENOXCADDataImport"],function(e,t,i,n){return{onLoad:function(){this.publish(),this.subscribe(),widget.addEvent("onSearch",this.onSearch.bind(this)),widget.addEvent("onResetSearch",this.onResetSearch.bind(this));n.publish({event:"webinwin:web:notification",data:{operation:"xcadimportpageready",version:"1.0",data:{status:"success",message:"Page is ready"}}})},onSearch:function(e){n.publish({event:"xcadimport:onSearch",data:e})},onResetSearch:function(){n.publish({event:"xcadimport:onResetSearch"})},publish:function(){n.subscribe({event:"webinwin:web:notification"},function(e){"undefined"!=typeof dscef?dscef.sendString(JSON.stringify(e)):t.publish("webinwin:web:notification",JSON.stringify(e))})},subscribe:function(){n.subscribe({event:"webinwin:win:notification"},function(e){"string"==typeof e&&(e=JSON.parse(e)),xcadimportinfra.defineProtocol(e)})}}}),define("DS/ENOXCADDataImport/ENOXCADImportCmd",["DS/MessageBus/MessageBus","DS/PlatformAPI/PlatformAPI","DS/ENOXCADDataImport/utils/XCADImportInfra","DS/ENOXCADUtils/utils/XCADModelEvents","css!DS/ENOXCADDataImport/ENOXCADDataImport"],function(e,t,i,n){return{widget:null,onLoad:function(e){null!=e&&(this.widget=e.widget,this.widget.addEvent("onSearch",this.onSearch.bind(this)),this.widget.addEvent("onResetSearch",this.onResetSearch.bind(this)));this.subscribe(),this.publish();n.publish({event:"webinwin:web:notification",data:{operation:"xcadimportpageready",version:"1.0",data:{status:"success",message:"Page is ready"}}})},onSearch:function(e){n.publish({event:"xcadimport:onSearch",data:e})},onResetSearch:function(){n.publish({event:"xcadimport:onResetSearch"})},publish:function(){n.subscribe({event:"webinwin:web:notification"},function(e){t.publish("webinwin:web:notification",JSON.stringify(e))})},subscribe:function(){t.subscribe("webinwin:win:notification",function(e){var t=UWA.is(e,"string")?JSON.parse(e):e;null!=t.data&&null!=t.data.tokenid&&"ENOXCAD"===t.data.tokenid&&xcadimportinfra.defineProtocol(t)}),t.subscribe("webinwin:win:xcadnotification",function(e){var t=UWA.is(e,"string")?JSON.parse(e):e;xcadimportinfra.defineProtocol(t)})}}});