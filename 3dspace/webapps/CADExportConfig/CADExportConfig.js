define("DS/CADExportConfig/CADExportConfig",["DS/CADExportConfig/utils/ExportValidator","DS/CADExportConfig/utils/Constants","DS/CADExportConfig/utils/RetrieveFormats","i18n!DS/CADExportConfig/assets/nls/CADExportConfigNLS"],function(e,t,o,a){var l;return UWA.i18n(a),{preprocess:function(t,o,a){let l={url3DSpace:t.platformServices["3DSpace"],securityContext:t.securityContext,resolve:o,reject:a};e.computeNodes(t.selectedNodes,t.expandedNodes).then(e.validateCadMasterRoles()).then(e.validateECasRoot(t.selectedNodes,t.expandedNodes)).then(e.validateNodes(l))},transform:function(o){let a=null!=window.widget&&window.widget.getValue("x3dAppId")?window.widget.getValue("x3dAppId"):null!=window.widget&&window.widget.getValue("appId")?window.widget.getValue("appId"):"X3DSEAR_AP",r=this.objects.filter(e=>e.resourceid&&e.type||e.Path);const n={drawingcheck:this.force};let d=[],i=[];null!=this.parameters&&null!=this.parameters.dvout&&(n.doformatcheck=this.parameters.dvout.doformat,this.parameters.dvout.doformat&&(null!=this.parameters.dvout.format3D&&(d=[...this.parameters.dvout.format3D],n.format3d=d),null!=this.parameters.dvout.format2D&&(i=[...this.parameters.dvout.format2D],n.format2d=i))),sessionStorage.setItem(l,JSON.stringify(n));let s=null!=this.expander.expanddomain.expandLevel?this.expander.expanddomain.expandLevel.toString():"-1",p={appid:a,appdata:{data:r,computedselected:e.sSelectNodes},options:[{key:"incldrawing",value:this.force},{key:"title",value:this.title},{key:"expandlevel",value:s},{key:"envId",value:o.platformServices.platformId},{key:"contextId",value:o.securityContext},{key:"doFormat3D",value:d},{key:"doFormat2D",value:i}]};null!=o.platformServices["3dregistry"]&&p.options.push({key:"3dregistry",value:o.platformServices["3dregistry"]});let u=[],c=Array.from(r);return c.forEach(e=>{let o=e.resourceid,a=e.type;if(t.CAD_3DSHAPE===a){let e=c.find(e=>e.to===o);null!=e&&u.push({physicalid:o,parentphid:e.from,type:a})}}),u.length>0&&(p.appdata.referencedata=[],p.appdata.referencedata=u),p},fields:function(e,t,a){o.generateFormats(e).then(function(e){let a=!1,r=!1,n=[],d=[];if(o.getCadMaster().trim().length>0&&(l=o.getCadMaster().trim(),null!=sessionStorage.getItem(l))){let e=JSON.parse(sessionStorage.getItem(l));a=null!=e.drawingcheck&&e.drawingcheck,r=null!=e.doformatcheck&&e.doformatcheck,n=null!=e.format3d?e.format3d:[],d=null!=e.format2d?e.format2d:[]}let i=[{key:"title",label:UWA.i18n("cadexportconfig.text.title"),value:"Export"+(new Date).getTime(),type:"DS/Controls/LineEditor"},{key:"force",label:UWA.i18n("cadexportconfig.toggle.drawing"),value:a,type:"DS/Controls/Toggle",options:{type:"switch",value:a,checkFlag:a}},{key:"expander",type:"DS/Controls/Accordeon",options:{expandedFlag:!0},children:[{key:"expanddomain",label:UWA.i18n("cadexportconfig.field.select.expandlevel"),icon:"expand-all",fields:[{key:"expandlevel"}]}]}];null!=e&&e.isrender&&i.push({key:"parameters",type:"DS/Controls/Accordeon",options:{expandedFlag:!0},children:[{key:"dvout",label:UWA.i18n("download.derived.outputs"),icon:"derived-output",fields:[{key:"doformat",label:UWA.i18n("derived.format.toggle"),value:r,type:"DS/Controls/Toggle",options:{type:"switch",value:r,checkFlag:r},successors:function(){if(this.doformat){let t=[];return e.format3d.length>0&&t.push({key:"format3D",label:UWA.i18n("combo.field.3dformat"),type:"DS/WUXAutoComplete/AutoComplete",options:{elementsTree:e.format3d,allowFreeInputFlag:!1,placeholder:UWA.i18n("label.select3DFormat")},value:n}),e.format2d.length>0&&t.push({key:"format2D",label:UWA.i18n("combo.field.2dformat"),type:"DS/WUXAutoComplete/AutoComplete",options:{elementsTree:e.format2d,allowFreeInputFlag:!1,placeholder:UWA.i18n("label.select2DFormat")},value:d}),t}}}]}]}),t(i)})}}});