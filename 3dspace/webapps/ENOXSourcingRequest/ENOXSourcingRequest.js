define("DS/ENOXSourcingRequest/models/ComponentRequest",["DS/ENOXSourcingUXInfra/service/ENOXSourcingService","DS/ENOXSourcingUXInfra/Constants/ENOXSourcingConstants"],function(e,t){"use strict";var i=function(e){this.source="sourcing",this.controller=e};return i.prototype.init=function(){},i.prototype.deleteComponentRequest=function(t){var i={endpoint:"/resources/v1/modeler/dssourcing/sourcingrequests"};return i.source=this.source,i.deleteData=t.deleteData,e.deleteServicePromise(i)},i.prototype.listComponentRequests=function(t){var i={};if(i.endpoint="/resources/v1/modeler/dssourcing/sourcingrequests?$top="+t.top+"&$skip="+t.skip+"&$include=filters,interface-details,request-template,request-assignee.requestCategory,context-project,route-templates,request-assignee,context-product,context-plant&$fields=request-template.requestCategory,request-template.title&$definition=true",t.filter&&(i.endpoint+="&$filterkey="+t.filter),t.relatedItemFilter){let e=t.hasInputItem?"hasInputItem":"hasAnswerItem";t[e]&&(i.endpoint+="&$"+e+"="+t[e])}return this.controller.app.typesConfigurator.objectTypes&&this.controller.app.typesConfigurator.objectTypes.request&&(i.endpoint+="&type="+this.controller.app.typesConfigurator.objectTypes.request),i.source=this.source,e.getDataPromise(i)},i.prototype.updateComponentRequest=function(t){return t.endpoint="/resources/v1/modeler/dssourcing/sourcingrequests/"+t.id,t.includeParams?t.endpoint=t.endpoint+"?"+t.includeParams+"&$definition=full":t.endpoint+="?&$definition=full",t.source=this.source,e.updateServicePromise(t)},i.prototype.getLifeCycleDataProviderPromise=function(t){var i={endpoint:"/resources/lifecycle/maturity/getStateGraph"};return i.lifeCycleData=t.getLifecyclePayload,i.source=this.source,e.performLifeCycleAction(i)},i.prototype.performLifeCycleAction=function(t){var i={endpoint:"/resources/lifecycle/maturity/promote"};return i.source=this.source,i.lifeCycleData=t.lifeCycleData,e.performLifeCycleAction(i)},i.prototype.performLifeCycleComponentAction=function(t){var i={endpoint:"/resources/lifecycle/maturity/promote"};return i.source=this.source,i.lifeCycleData=t.lifeCycleData,e.performLifeCycleAction(i)},i.prototype.getComponentRequest=function(t){var i={};return i.endpoint="/resources/v1/modeler/dssourcing/sourcingrequests/"+t.id+"?"+t.includeParams+"&$definition=full",i.source=this.source,e.getDataPromise(i)},i.prototype.getDetails=function(t){var i={};let o=t.id?t.id:t.data.id;return i.endpoint="/resources/v1/modeler/dssourcing/sourcingrequests/"+o+"?$include=interface-details&$definition=full",i.source=this.source,e.getDataPromise(i)},i.prototype.attachDocument=function(t){var i={};let o=t.data.params.id;return i.endpoint="/resources/v1/modeler/dssourcing/sourcingrequests/"+o+"/documents",i.source=this.source,i.attachDocumentData=t.attachDocumentData,e.performPatchPromise(i)},i.prototype.detachDocument=function(t){var i={};let o=t.data.params.id;return i.endpoint="/resources/v1/modeler/dssourcing/sourcingrequests/"+o+"/documents/"+t.data.params.documentId,i.source=this.source,e.performDeletePromise(i)},i.prototype.submitAction=function(t){var i={};let o=t.id?t.id:t.data.id;return i.endpoint="/resources/v1/modeler/dssourcing/sourcingrequests/"+o+"/submit",i.lifeCycleData={},i.source=this.source,e.performLifeCycleAction(i)},i.prototype.getDocuments=function(t){var i={};let o=t.id?t.id:t.data.id;return i.endpoint="/resources/v1/modeler/dssourcing/sourcingrequests/"+o+"/documents",i.source=this.source,e.getDataPromise(i)},i.prototype.attachRequestComponents=function(t,i){var o={};let n=t.id?t.id:t.data.id;return o.endpoint="/resources/v1/modeler/dssourcing/sourcingrequests/"+n+"/impacted-items",o.source=this.source,o.attachDocumentData=i,e.performPatchPromise(o)},i.prototype.attachResponseComponents=function(t,i){var o={};let n=t.id?t.id:t.data.id;return o.endpoint="/resources/v1/modeler/dssourcing/sourcingrequests/"+n+"/answer-items",o.source=this.source,o.attachDocumentData=i,e.performPatchPromise(o)},i.prototype.detachResposeComponents=function(t,i){var o={};let n=t.id?t.id:t.data.id;return o.endpoint="/resources/v1/modeler/dssourcing/sourcingrequests/"+n+"/answer-items/"+i.id,o.source=this.source,e.performDeletePromise(o)},i.prototype.attachInProcessComponents=function(t,i){var o={};let n=t.id?t.id:t.data.id;return o.endpoint="/resources/v1/modeler/dssourcing/sourcingrequests/"+n+"/inprocess-items",o.source=this.source,o.attachDocumentData=i,e.performPatchPromise(o)},i.prototype.detachInProcessComponents=function(t,i){var o={};let n=t.id?t.id:t.data.id;return o.endpoint="/resources/v1/modeler/dssourcing/sourcingrequests/"+n+"/inprocess-items/"+i.id,o.source=this.source,e.performDeletePromise(o)},i.prototype.detachRequestComponents=function(t,i){var o={};let n=t.id?t.id:t.data.id;return o.endpoint="/resources/v1/modeler/dssourcing/sourcingrequests/"+n+"/impacted-items/"+i.id,o.source=this.source,e.performDeletePromise(o)},i.prototype.getRequestCategory=function(t){return t.endpoint="/resources/v1/modeler/dssourcing/requestCategory",t.source=this.source,e.getDataPromise(t)},i.prototype.getProxyObjectId=function(t){return t.endpoint="/resources/dssourcing/ProxyObject",t.source=this.source,t.postData=t.data,e.performPostPromise(t)},i.prototype.getMEIDetails=function(t){return t.source="3DSpace",t.endpoint="/resources/v1/modeler/dssrc/dssrc:ManufacturerEquivalentItem/"+t.id+"?$mask=dsmvsrc:ManufacturerEquivalentItem.Details&$fields=dsmveno:CustomerAttributes",e.getService(t)},i.prototype.getQualificationDetails=function(t){return t.endpoint="/resources/v1/modeler/dssourcing/qualifications/"+t.data.params.qualificationId,t.endpoint=t.endpoint+"?$include=target,Context",t.source=this.source,e.getDataPromise(t)},i.prototype.getDocuments=function(t){var i={};return i.endpoint="/resources/v1/modeler/dssourcing/qualifications/"+t.data.respParams.id+"/documents",i.source=this.source,e.getDataPromise(i)},i.prototype.getMEIInterfaceDetails=function(t){return t.source="3DSpace",t.endpoint="/resources/v1/modeler/dssrc/dssrc:ManufacturerEquivalentItem/"+t.id+"?$mask=dsmvsrc:ManufacturerEquivalentItem.Details&$fields=dsmvsrc:computed.interfaceDetails",e.getDataPromise(t)},i.prototype.getQualificationsListPageMEI=function(t){return t.endpoint="/resources/v1/modeler/dssourcing/generalqualifications",t.include&&(t.endpoint=t.endpoint+"?"+t.include),t.source=this.source,e.performPostPromise(t)},i.prototype.close=function(t){let i=t.id?t.id:t.data.id;return t.endpoint="/resources/v1/modeler/dssourcing/sourcingrequests/"+i+"/close?$include=interface-details,request-template,request-assignee,object-route,context-project,context-product,context-plant,context-user,route-templates&$definition=full",t.source=this.source,e.updateServicePromise(t)},i.prototype.approve=function(t){let i=t.id?t.id:t.data.id;return t.endpoint="/resources/v1/modeler/dssourcing/sourcingrequests/"+i+"/approve?$include=interface-details,request-template,request-assignee,object-route,context-project,context-product,context-plant,context-user&$definition=full",t.source=this.source,e.updateServicePromise(t)},i.prototype.sendNotificationPastDueDate=function(t){return t.endpoint="/resources/v1/modeler/dssourcing/sourcingrequests/notify",t.source=this.source,t.postData=t.notificationPayload,e.performPostPromise(t)},i.prototype.sendNeedForClarification=function(t){let i=t.id?t.id:t.data.id;return t.endpoint="/resources/v1/modeler/dssourcing/sourcingrequests/"+i+"/requestClarification?$include=interface-details,request-template,request-assignee,object-route,context-project,context-product,context-plant,context-user&$definition=full",t.source=this.source,t.postData=t.addData,e.performPostPromise(t)},i.prototype.submitClarification=function(t){let i=t.id?t.id:t.data.id;return t.endpoint="/resources/v1/modeler/dssourcing/sourcingrequests/"+i+"/submitClarification?$include=interface-details,request-template,request-assignee,object-route,context-project,context-product,context-plant,context-user&$definition=full",t.source=this.source,t.postData=t.addData,e.performPostPromise(t)},i.prototype.listRequestTemplates=function(t){return t.endpoint="/resources/v1/modeler/dssourcing/sourcingrequesttemplates?$fields=requestCategory&$mask=dssourcing:RequestTemplate",t.source=this.source,e.getDataPromise(t)},i.prototype.getLibraries=function(t){return t.endpoint="/resources/v1/modeler/dslib/dslib:Library/search?$mask=dslib:LibraryDetailsMask&$top=1000",t.source="3DSpace",e.getDataPromise(t)},i.prototype.getClasses=function(t){return t.endpoint="/resources/v1/modeler/dslib/dslib:Class/"+t.id+"?$mask=dslib:ExpandClassesDetailsMask&$depth=20",t.source="3DSpace",e.getDataPromise(t)},i.prototype.getRequestTemplate=function(t){let i=t.id?t.id:t.data.params.id;return t.endpoint="/resources/v1/modeler/dssourcing/sourcingrequesttemplates/"+i+"?$definition=full",this.controller.app.typesConfigurator.objectTypes&&this.controller.app.typesConfigurator.objectTypes.template&&(t.endpoint+="&type="+this.controller.app.typesConfigurator.objectTypes.template),t.source=this.controller.model.source,e.getDataPromise(t)},i.prototype.getObjectInfo=function(i){var o={endpoint:"/resources/v3/e6w/service/ObjectInfo/read"};return o.postData=i,o.source=t.SERVICE_3DSPACE,e.performPostPromise(o)},i.prototype.gettypeshierarchy=function(i){var o={};return o.source=t.SERVICE_3DSPACE,o.endpoint="/resources/enong/dico/gettypeshierarchy",o.postData={types:i},e.performPostPromise(o)},i}),define("DS/ENOXSourcingRequest/views/Source/OpenSource",["DS/UIKIT/Mask","DS/ENOXSourcingUXInfra/CommonUtils/CommonUtils","DS/ENOXSourcingUXInfra/DetailsView/DetailsView","DS/ENOXSourcingUXInfra/PropertiesView/PropertiesView"],function(e,t,i,o){"use strict";var n=function(e){this.controller=e.controller,this.helper=e.controller.helper,this.options=e.options,this.subscribeToEvents(),this.NLS=this.controller.NLS};return n.prototype.render=function(){var t=this;t.propertiesModel=new UWA.Class.Model({modifyAccess:t.helper.canModify({crState:t.options.crData.maturityState}),stateAccess:!0,fields:t.options.fields,save:function(i){if(t.helper.validatePropertiesSave(i)){e.mask(widget.body,t.NLS.updating_source);let a={crID:t.options.crID,formValues:{}};for(var o in i)i[o].getValue&&Array.isArray(i[o].getValue())?a.formValues[o]=i[o].getValue()[0]:(i[o].value||i[o].getValue)&&(a.formValues[o]=i[o].getValue?i[o].getValue():i[o].value);i.document_ID&&(a.formValues.document_ID=i.document_ID.fieldController.getIdentifier()),a.crID=t.options.crData.id,a.sourceID=t.options.data.respParams[0].grid.id,a.propModel=t.propertiesModel,a.propView=n,a.updateSourceList=t.options.updateSourceList,t.controller.update(a)}else widget.notificationUtil.showError(t.NLS.atleast_one_field_to_be_filled)}});var n=new o({model:t.propertiesModel}),a={showTabView:!0};a.tabConfiguration=[{label:t.NLS.properties,content:n.render(),index:"1",value:"properties",isSelected:!0,icon:{iconName:"attributes",fontIconFamily:1}}],a.idCardDetails=t.getIdCardOptions(t.options.data.respParams[0].grid),t.options.detailsViewOptions=a,(new i).init(t.options),t.controller.sourceInfoHelper.makeAttachmentFieldsDroppable(n.fieldElements.document_ID.fieldController.getWrapperDiv().getParent(".form-group").getParent(".form-group").getParent(),n.fieldElements.document_ID),t.controller.sourceInfoHelper.makeSourcingFieldsDroppable(n.getContent().getElementsByClassName("outerDiv")[0],t.helper.getPropertyFieldsInputElements(n))},n.prototype.getIdCardOptions=function(e){return{name:this.options.fields[0].value,thumbnail:require.toUrl(e.image),attributes:[{name:this.NLS.owner,value:e.owner},{name:this.NLS.creation_date,value:t.getDateStringForDisplay(e.creationDate)},{name:this.NLS.modified_date,value:t.getDateStringForDisplay(e.modificationDate)}],withActionsButton:!1}},n.prototype.subscribeToEvents=function(){var e=this;e.options.openSourceEvent.subscribe({event:"cr-updated"},function(){e.controller.app._applicationChannel.publish({event:"information-panel-close"})})},n}),define("DS/ENOXSourcingRequest/models/Source",["DS/ENOXSourcingUXInfra/service/ENOXSourcingService"],function(e){"use strict";var t=function(){this.source="sourcing"};return t.prototype.create=function(t){return t.endpoint="/resources/v1/modeler/dssourcing/sourcingrequests/"+t.crID+"/source-information",t.source=this.source,e.createServicePromise(t)},t.prototype.update=function(t){return t.endpoint="/resources/v1/modeler/dssourcing/sourcingrequestsources/"+t.id+"?$simpleJSON=true",t.source=this.source,e.updateServicePromise(t)},t.prototype.getDetails=function(t){return t.endpoint="/resources/v1/modeler/dssourcing/sourcingrequestsources/"+t.id+"?$include=documents",t.source=this.source,e.getDataPromise(t)},t.prototype.delete=function(t){var i={};return i.endpoint="/resources/v1/modeler/dssourcing/sourcingrequests/"+t.crID+"/source-information",i.source=this.source,i.deleteData=t.deleteData,e.deleteServicePromise(i)},t}),define("DS/ENOXSourcingRequest/config/appConfigurator",["DS/ENOXSourcingUXInfra/Constants/ENOXSourcingConstants"],function(e){"use strict";return{_modelersRoot:"DS/ENOXSourcingUXInfra/modelers/",_modelersList:["ComponentRequest","ManufacturerEquivalentItem","RequestTemplate"],_controllersRoot:["DS/ENOXSourcingRequest/controllers/"],_controllersList:[{name:"ComponentRequestController",label:"componentRequestController"},{name:"SourceController",label:"sourceController"}],_serviceViewControllersList:[{name:"controllers/ModalWindowController",label:"modalWindowController",initializeController:!1},{name:"SupplyNetworkSearchView/SupplyNetworkSearchController",label:"supplyNetworkSearchController",initializeController:!0}],_viewControllersRoot:[],_viewControllersList:[],routeControllersRoot:["DS/ENOXSourcingUXInfra/controllers/"],routeControllersList:[{name:"ListViewRouteController",label:"listViewRouteController"},{name:"DetailsViewRouteController",label:"detailsViewRouteController"}],_wizardConfigurator:{_wizardStepsList:["type","category","documents","details","summary"],_wizardViews:[{name:"CreateRequestForm",path:"DS/ENOXSourcingUXInfra/components/CreateRequestForm/CreateRequestForm"},{name:"SingleTileSelector",path:"DS/ENOXSourcingUXInfra/components/SingleTileSelector/SingleTileSelector"},{name:"HierarchicalView",path:"DS/ENOXSourcingUXInfra/components/HierarchicalView/HierarchicalView"},{name:"CreateCollectionView",path:"DS/ENOXSourcingUXInfra/components/CreateCollectionView/CreateCollectionView"},{name:"RequestCreationSummary",path:"DS/ENOXSourcingUXInfra/components/SummarizeAndSubmit/SummarizeAndSubmit"}],_wizardDataprovider:"compRequest"},widgetPreferences:[{name:"defaultRoute",type:"hidden",defaultValue:"home.ComponentRequests"},{name:"lastVisitedRouteName",type:"hidden",defaultValue:"xpflLastVisitedRoute"}],welcomePanelActivities:[{id:"quickaccess",actions:[{id:"modal-wizard-type",nlsKey:"new_request",isNotHighlightable:!0,fonticon:"fonticon fonticon-survey-add",className:"action-new"},{id:"ComponentRequests",nlsKey:"my_requests",fonticon:"fonticon fonticon-survey",className:"action-new"}]}],nlsSources:[{path:"DS/ENOXSourcingRequest/assets/nls/ENOXSourcingRequest",appName:"ENOXSourcingRequest"},...e.REQUEST_ADMIN_APPS_i18Ns,{path:"DS/ENOXSourcingUXInfra/assets/nls/ENOXSourcingUXInfra",appName:"Common"}]}}),define("DS/ENOXSourcingRequest/components/Wizard/RequestTypeChooser",["UWA/Class/View","DS/ENOXSourcingUXInfra/components/ModalWindowWrapper/ModalWindowWrapper","DS/ENOXSourcingUXInfra/components/SingleTileSelector/SingleTileSelector","DS/ENOXSourcingUXInfra/Constants/ENOXSourcingConstants"],function(e,t,i,o){"use strict";return e.extend({init:function(e){this.model=e,this.data=this.model.get("data").data,this.params=this.model.get("params"),this.app=this.model.get("app"),this._parent(this)},setup:function(){this.container.addClassName(this.getClassNames("-container"))},update:function(){let e=this.outerDiv.parentElement.parentElement.getBoundingClientRect();this.outerDiv.style.height=e.height+"px"},render:function(){let e=this,n=[];if(0===e.data.length)return void widget.notificationUtil.showError(e.app.i18NProvider.released_templates_not_found);if(0===(n=e.data.filter(e=>e.islast===o.TRUE&&e.state===o.RELEASED)).length)return void widget.notificationUtil.showError(e.app.i18NProvider.released_templates_not_found);let a=[];for(let t in e.app.typesConfigurator)e.app.typesConfigurator.hasOwnProperty(t)&&"appName"!==t&&"objectTypes"!==t&&"templateType"in e.app.typesConfigurator[t]&&a.push({label:e.app.i18NProvider[t],grid:{name:e.app.i18NProvider[t],value:t}});if(1===a.length)return void e.app.router.navigate(e.params.wizardRoute,{type:a[0].grid.value,typesConfigurator:e.app.typesConfigurator,requestTemplateData:e.data},{reload:!0});let r=new i({app:e.app,clickCallback:(t,i)=>{if(i){let t=e.app.typesConfigurator[i.nodeModel.getAttributeValue("value")];if(0===n.filter(e=>e.type===t.templateType).length)return void widget.notificationUtil.showError(e.app.i18NProvider.released_templates_not_found);e.app.router.navigate(e.params.wizardRoute,{type:i.nodeModel.getAttributeValue("value"),typesConfigurator:e.app.typesConfigurator},{reload:!0}),s.destroy()}},model:{tiles:a}}),s=new t({app:{widget:widget},height:"25vh",draggable:!0,resizable:!0,escapeToClose:!1,onHideCB:()=>s.destroy()}).getModal();s.show(),s.setHeader(e.app.i18NProvider.select_request_type),r.render().inject(s.getBody())}})}),define("DS/ENOXSourcingRequest/views/Dashboard/DashboardView",["UWA/Class/View","DS/Utilities/Dom","DS/UIKIT/Scroller","DS/Controls/TooltipModel","DS/ENOXSourcingUXInfra/components/Charts/HalfDonutChartView","DS/ENOXSourcingUXInfra/components/Charts/BarChartView","DS/ENOXSourcingUXInfra/components/Charts/LineChartView","DS/ENOXSourcingUXInfra/Constants/ENOXSourcingConstants","css!DS/ENOXSourcingRequest/views/Dashboard/DashboardView"],function(e,t,i,o,n,a,r,s){"use strict";return e.extend({name:"xsrc-comp-request-dashboard",tagName:"div",className:function(){return this.getClassNames("-container")},setup:function(e){let t=this,{app:i,data:o={},helper:l,view:c,filtersApplied:d}=e;Object.assign(this,{app:i,data:o,helper:l,view:c,filtersApplied:d});let u=this.app.i18NProvider;t.filtersApplied=this.filtersApplied?this.filtersApplied:[],this.statusView=new n({data:this.getChartDataPromise(o,this.helper.groupFacetByProperty,[s.FACETS.current,u],u["In Work"])},{loading_text:u.loading_data},this.chartClickCallBack.bind(this,"requestStatus")),this.requestCategoryView=new n({data:this.getChartDataPromise(o,this.helper.groupFacetByProperty,[s.FACETS.requestCategory,u],u.others)},{loading_text:u.loading_data},this.chartClickCallBack.bind(this,"requestCategory")),this.componentCategoryView=new n({data:this.getChartDataPromise(o,this.helper.groupFacetByProperty,[s.FACETS.componentCategory,u],u.others)},{loading_text:u.loading_data},this.chartClickCallBack.bind(this,"componentCategory"));let p={name:u.request_count,unit:u.requests,loading_text:u.loading_data,line_chart_label:u.line_chart_label};this.assigneeView=new a({data:this.getChartDataPromise(o,this.helper.groupFacetByProperty,[s.FACETS.assignee,u])},p,this.chartClickCallBack.bind(this,"assignee")),this.burnDownView=new r({data:this.getChartDataPromise(o,this.helper.getBurnDownData,[s.FACETS.requestSubmitDate,s.FACETS.requestCloseDate])},p,this.chartClickCallBack.bind(this,"requestSubmitDate")),this.container.addEvent("resize",function(){t.render()})},render:function(){this.container.empty(),this.NLS=this.app.i18NProvider,this.mainDiv=UWA.createElement("div",{class:"chart-container"});let e=UWA.createElement("div",{class:"chart-row"}).inject(this.mainDiv);return this.createContainers("xsrc-requestCategory-chart","book-open",this.NLS.component_request_category,this.requestCategoryView,e),this.createContainers("xsrc-componentCategory-chart","book-open",this.NLS.category_classification,this.componentCategoryView,e),this.createContainers("xsrc-maturity-chart","users",this.NLS.request_status,this.statusView,e),this.createContainers("xsrc-assignee-chart","users",this.NLS.bar_chart_title,this.assigneeView,this.mainDiv),this.createContainers("xsrc-burn-down-chart","hourglass",this.NLS.line_chart_title,this.burnDownView,this.mainDiv,!0),new i({element:this.mainDiv}).inject(this.container),this.getData(this.data),this.container},getChartDataPromise:function(e,t,i,o){return new Promise(n=>{e.then(e=>{n(t(e.facets,i,e.infos.nresults,o))})})},createContainers:function(e,i,n,a,r,s){let l=UWA.createElement("div",{class:`${e} xsrc-dashboard-section xsrc-dashboard-info xsrc-chart`}).inject(r),c=UWA.createElement("label",{text:n}).inject(t.generateIcon(`${i} wux-ui-3ds`).inject(l));s&&t.generateIcon({iconName:"info wux-ui-3ds",className:"infoIcon",tooltipInfos:new o({shortHelp:this.NLS.exclude_in_draft,mouseRelativePosition:!1,position:"right"})}).inject(c),a.render().inject(l)},getData:function(e){let t=this;e.then(e=>{t.fedSearchData=t.helper.formatFedSearchData(e.results).map(e=>({id:e.resourceid,requestStatus:e[s.FACETS.current]?e[s.FACETS.current]:t.NLS["In Work"],assignee:e[s.FACETS.assignee],requestCategory:t.NLS[e[s.FACETS.requestCategory]],componentCategory:e[s.FACETS.componentCategory]?e[s.FACETS.componentCategory]:t.NLS.others,requestSubmitDate:e[s.FACETS.requestSubmitDate],requestCloseDate:e[s.FACETS.requestCloseDate]})),t.completeDataSet=Object.assign([],t.fedSearchData),t.filtersApplied.length>0&&t.updateChart()})},chartClickCallBack:function(e,t){this.filtersApplied.some(e=>e.name===t)?this.filtersApplied=this.filtersApplied.filter(e=>e.name!==t):this.filtersApplied.push({categoryName:e,name:t}),this.updateChart(),this.view.collectionViewEvents.publish({event:"dashboard-filter-applied",data:{filteredData:this.fedSearchData,chartData:this.updatedData,filtersApplied:this.filtersApplied}})},updateChart:function(){let e=this;e.fedSearchData=e.completeDataSet.filter(function(t){return 0===e.filtersApplied.filter(function(e){return"requestSubmitDate"===e.categoryName?new Date(t[e.categoryName]).getDate()+"/"+new Date(t[e.categoryName]).getMonth()+"/"+new Date(t[e.categoryName]).getFullYear()!=new Date(e.name).getDate()+"/"+new Date(e.name).getMonth()+"/"+new Date(e.name).getFullYear():t[e.categoryName]!==e.name}).length}),e.updatedData={requestStatusData:e.helper.groupFacetForFilter("requestStatus",e.fedSearchData),componentCategoryData:e.helper.groupFacetForFilter("componentCategory",e.fedSearchData),requestCategoryData:e.helper.groupFacetForFilter("requestCategory",e.fedSearchData),assigneeData:e.helper.groupFacetForFilter("assignee",e.fedSearchData),lineChartData:e.helper.getUpdatedBurnDownData(e.helper.groupFacetForFilter("requestSubmitDate",e.fedSearchData))},e.statusView.chart.series[0].setData(e.updatedData.requestStatusData),e.requestCategoryView.chart.series[0].setData(e.updatedData.requestCategoryData),e.componentCategoryView.chart.series[0].setData(e.updatedData.componentCategoryData),e.assigneeView.chart.series[0].setData(e.updatedData.assigneeData),e.burnDownView.chart.series[0].setData(e.updatedData.lineChartData),e.statusView.chart.setTitle({text:e.fedSearchData.length}),e.requestCategoryView.chart.setTitle({text:e.fedSearchData.length}),e.componentCategoryView.chart.setTitle({text:e.fedSearchData.length})}})}),define("DS/ENOXSourcingRequest/config/routerConfig",[],function(){"use strict";return{routes:[{name:"home",path:"/home"},{name:"home.ComponentRequests",path:"/ComponentRequests",routeController:"listViewRouteController",dataController:"componentRequestController",titleNLS:"my_requests",showTitle:!1},{name:"home.ComponentRequestDetails",path:"/ComponentRequestDetails",routeController:"detailsViewRouteController",dataController:"componentRequestController"},{name:"modal",path:"/modal",children:[{name:"wizard",path:"/wizard",children:[{name:"type",path:"/type"},{name:"category",path:"/category"},{name:"documents",path:"/documents"},{name:"details",path:"/details"},{name:"summary",path:"/summary"}]}]},{name:"home.dummyRoute",path:"/dummyRoute"}],options:{defaultRoute:"home.ComponentRequests",defaultParams:{},trailingSlash:!1,useTrailingSlash:void 0,autoCleanUp:!0,strictQueryParams:!0,allowNotFound:!1}}}),define("DS/ENOXSourcingRequest/helpers/ComponentRequestHelper",["DS/ENOXSourcingUXInfra/service/ENOXSourcingPlatformServices","DS/ENOXSourcingUXInfra/service/ENOXSourcingService","DS/ENOXSourcingUXInfra/Constants/ENOXSourcingConstants","DS/ENOXSourcingUXInfra/DateUtil/DateUtil","DS/ENOXSourcingUXInfra/Utilities/Utility","DS/ENOXSourcingUXInfra/CommonUtils/CommonUtils","DS/ENOXSourcingUXInfra/Search/SearchUtility","DS/ENOXSourcingUXInfra/Search/ENOXDashboardSearchUtility","DS/TreeModel/TreeNodeModel"],function(e,t,i,o,n,a,r,s,l){"use strict";const c=function(e,t){return new RegExp(e).test(t)};var d=function(e){this.lengthyExtensionAttributes={"SRC Manufacturer Part Number":"false","SRC Part Source":"false"},this.utility=new n,this.controller=e,this.searchUtil=new r,this.NLS=this.controller.app.i18NProvider};return d.prototype.processUpdateValues=function(e){return{data:[e]}},d.prototype.preProcessForSearch=function(t){var o=this;let n={};n.sources=[...new Set(t.map(e=>e.Proxy_Service?e.Proxy_Service:i.SOURCE_SOURCING))],i.ONPREMISE===e.getPlatformId()&&(n.sources=[i.SOURCE_3DSPACE]);let a=[...new Set(t.map(e=>e.type))];return n.types=[...new Set(a.map(e=>o.relatedItemsActualTypes(e)))],n.objIds=[...new Set(t.map(e=>e.Proxy_Id?e.Proxy_Id:e.id))],n},d.prototype.processForRelatedItems=function(e,t=[]){let o=this.processItems(e),n=[];return n=t.some(e=>e.type===i.TYPE_COMPONENT_REQUEST)?this.processComponentRequestsForRelatedItems(t):this.processSources(t),[...o,...n]},d.prototype.processItems=function(e){var t=this,o=[];return e.map(function(e){if(e){var n={title:e["ds6w:label"],tree:e["ds6w:label"],id:e.proxyId,actualId:e.resourceid,owner:e["ds6w:who/ds6w:responsible"],type:t.relatedItemsTypes(e),actualType:e["ds6w:what/ds6w:type"],service:e.sourceid.substr(0,e.sourceid.indexOf(":")),organization:e["ds6w:who/ds6w:responsible/ds6w:manufacturer_displayValue"],modificationDate:e["ds6w:when/ds6w:modified"],creationDate:e["ds6w:when/ds6w:created"],image:e.preview_url,maturityState:e["ds6w:what/ds6w:status_displayValue"]?e["ds6w:what/ds6w:status_displayValue"]:e["ds6w:what/ds6w:status"],name:e.name_displayValue?e.name_displayValue:e.name?e.name:"",revision:e["ds6wg:revision_displayValue"]?e["ds6wg:revision_displayValue"]:e["ds6wg:revision"]?e["ds6wg:revision"]:"",description:e["ds6w:description_displayValue"]?e["ds6w:description_displayValue"]:e["ds6w:description"]?e["ds6w:description"]:""};e["ds6wg:ManufacturerEquivalentItemExtension.ManufacturerPartNumber"]&&(n.additionalDragData={objectTaxonomies:[i.MEI_EXTENSION]},n.image="ENOXSourcingUXInfra/assets/icons/MEI-Thumbnail.png"),n.maturityState||(n.maturityState=e["ds6w:status_displayValue"]),-1!==n.maturityState.indexOf(".")&&(n.maturityState=n.maturityState.substring(n.maturityState.indexOf(".")+1));var r=[{label:t.NLS.title,data:n.title},{label:t.NLS.type,data:n.type},{label:t.NLS.revision,data:n.revision},{label:t.NLS.maturity_state,data:n.maturityState},{label:t.NLS.name,data:n.name},{label:t.NLS.description,data:n.description},{label:t.NLS.owner,data:n.owner},{label:t.NLS.created,data:a.getDateStringForDisplay(n.creationDate)},{label:t.NLS.modified,data:a.getDateStringForDisplay(n.modificationDate)}],s=n.revision?" | "+n.revision+" | ":" | ",l=n.description?" | "+n.description:"",c=n.type+s+n.maturityState+"\n"+n.name+l,d={grid:n,label:n.title,subLabel:c,thumbnail:require.toUrl(n.image),tooltip:r};o.push(d)}}),o},d.prototype.processComponentRequestsForRelatedItems=function(e){let t=this;var o=[];return e.map(function(e){if(e){var n={title:e.title,tree:e.title,id:e.id,actualId:e.id,owner:e.owner,type:t.NLS.SRCComponentRequest,actualType:i.TYPE_COMPONENT_REQUEST,service:e.source,modificationDate:e.modified,creationDate:e.originated,image:"ENOXComponentRequestManagement/assets/icons/NewComponentRequest-Thumbnail.png",maturityState:e.stateDisplay,name:e.name?e.name:"",revision:e.revision?e.revision:"",description:e.description?e.description:""};e.ownerInfo&&(n.owner=(e.ownerInfo.firstname+" "+e.ownerInfo.lastname).trim()?e.ownerInfo.firstname+" "+e.ownerInfo.lastname:e.ownerInfo.name);var r=[{label:t.NLS.title,data:n.title},{label:t.NLS.type,data:n.type},{label:t.NLS.revision,data:n.revision},{label:t.NLS.maturity_state,data:n.maturityState},{label:t.NLS.name,data:n.name},{label:t.NLS.description,data:n.description},{label:t.NLS.owner,data:n.owner},{label:t.NLS.created,data:a.getDateStringForDisplay(n.creationDate)},{label:t.NLS.modified,data:a.getDateStringForDisplay(n.modificationDate)}],s=n.revision?" | "+n.revision+" | ":" | ",l=n.description?" | "+n.description:"",c=n.type+s+n.maturityState+"\n"+n.name+l,d={grid:n,label:n.title,subLabel:c,thumbnail:require.toUrl(n.image),tooltip:r};o.push(d)}}),o},d.prototype.processSources=function(e){var t=this,o=[];return e.map(function(e){if(e){t.utility.sortArrayAlphabeticallyBasedOnProperty(e.children,"type");let u=e[i.SRC_MANUFACTURER]||e[i.SRC_SUPPLIER_NAME],p=e[i.SRC_MANUFACTURER_PART_NUMBER];e.children.every(function(e){if([i.SRC_MANUFACTURER,i.SRC_SUPPLIER_NAME,i.SRC_MANUFACTURER_PART_NUMBER].includes(e.name))return!0;let o=e.value;return o&&"boolean"===e.type&&t.NLS[o.toUpperCase()]&&(o=t.NLS[o.toUpperCase()]),o&&"timestamp"===e.type&&(o=a.getDateStringForDisplay(o)),u?!p&&(p=o,!0):(u=o,!0)}),u||(u=p,p="");var n={title:e.name,tree:e.name,name:e.type,id:e.id,type:t.NLS.source_information,actualType:i.TYPE_SOURCE,typeDisplay:e.typeDisplay,modificationDate:e.modified,creationDate:e.originated,organization:e[i.SRC_MANUFACTURER]||e[i.SRC_SUPPLIER_NAME],image:"ENOXSourcingRequest/assets/icons/I_SourceObjectTile.png",additionalDragData:{"SRC Manufacturer":e["SRC Manufacturer"],"SRC Manufacturer Part Number":e["SRC Manufacturer Part Number"],"SRC Part Source":e["SRC Part Source"],"SRC Part Source URL":e["SRC Part Source URL"]},revision:e.revision?e.revision:"",maturityState:e.stateDisplay?e.stateDisplay:e.state?e.state:""};e.ownerInfo&&(n.owner=(e.ownerInfo.firstname+" "+e.ownerInfo.lastname).trim()?e.ownerInfo.firstname+" "+e.ownerInfo.lastname:e.ownerInfo.name);var r=n.revision?" | "+n.revision+" | ":" | ",s=u?" | "+u:"",l=p?" | "+p:"",c=n.typeDisplay+r+n.maturityState+"\n"+n.title+s+l,d={grid:n,label:n.title,subLabel:c,thumbnail:require.toUrl(n.image),tooltip:t.getSourceTooltip(e)};o.push(d)}}),o},d.prototype.getSourceTooltip=function(e){let t=this;var i=[];return e.children.forEach(function(e){let o={label:e.nlsName,data:e.value};o.data&&"boolean"===e.type&&t.NLS[o.data.toUpperCase()]&&(o.data=t.NLS[o.data.toUpperCase()]),o.data&&"timestamp"===e.type&&(o.data=a.getDateStringForDisplay(o.data)),i.push(o)}),i.push({label:t.NLS.ID,data:e.name},{label:t.NLS.title,data:e.title},{label:t.NLS.type,data:e.typeDisplay},{label:t.NLS.revision,data:e.revision},{label:t.NLS.maturity_state,data:e.stateDisplay},{label:t.NLS.owner,data:e.ownerInfo.firstname&&e.ownerInfo.lastname?e.ownerInfo.firstname+" "+e.ownerInfo.lastname:e.ownerInfo.name},{label:t.NLS.created,data:a.getDateStringForDisplay(e.originated)},{label:t.NLS.modified,data:a.getDateStringForDisplay(e.modified)}),i},d.prototype.relatedItemsActualTypes=function(e){var t=e.type||e;return t===i.DOCUMENT_PROXY?i.DOCUMENT:t===i.MEI_PROXY||t===i.ENG_ITEM_PROXY?i.VPMREFERENCE:t},d.prototype.relatedItemsTypes=function(e){var t=e["ds6w:what/ds6w:type"],o=e["ds6wg:ManufacturerEquivalentItemExtension.ManufacturerPartNumber"];let n=this;return t===i.DOCUMENT?n.NLS.document:t===i.VPMREFERENCE?o?n.NLS.manufacturer_equivalent_item:n.NLS.engineering_item:t===i.TYPE_COMPONENT_REQUEST?n.NLS.SRCComponentRequest:t===i.TYPE_QUALIFICATION_LIST[0]?n.NLS.general_qualification:t===i.TYPE_QUALIFICATION_LIST[1]?n.NLS.engineering_equivalent_qualification:t===i.TYPE_QUALIFICATION_LIST[2]?n.NLS.context_qualification:n.NLS.manufacturing_equivalent_qualification},d.prototype.getAllowedDropActualTypesAnswerItems=function(e){var t=[];return e&&e.length>0&&e.map(function(e){e&&(e===i.QUALIFICATION?t=t.concat(i.TYPE_QUALIFICATION_LIST):e===i.ENG_ITEM?t.push(i.VPMREFERENCE):e===i.MEI?t.push(i.MEI_EXTENSION):e===i.DOCUMENT?t.push(i.DOCUMENT):e===i.COMPONENT_REQUEST&&t.push(i.TYPE_COMPONENT_REQUEST))}),t},d.prototype.getAllowedDropActualTypesInputItems=function(){var e=[];return e.push(i.VPMREFERENCE),e.push(i.MEI_EXTENSION),e.push(i.TYPE_COMPONENT_REQUEST),e},d.prototype.getDroppedObjProxyType=function(e,t){let o="",n=e["ds6w:what/ds6w:type"]?e["ds6w:what/ds6w:type"]:e["ds6w:type"],a=e["ds6wg:ManufacturerEquivalentItemExtension.ManufacturerPartNumber"];return t&&(n=t),n&&(i.TYPE_QUALIFICATION_LIST.includes(n)||n===i.TYPE_QUALIFICATION?o=i.TYPE_QUALIFICATION:n===i.VPMREFERENCE?(o=i.ENG_ITEM_PROXY,a&&(o=i.MEI_PROXY)):n===i.DOCUMENT&&(o=i.DOCUMENT)),o},d.prototype.isAllowedForDrop=function(e,t){let o=!1,a=t.allowedTypes,r=t.ctxObjectID,s=e["ds6w:what/ds6w:type"]?e["ds6w:what/ds6w:type"]:e["ds6w:type"],l=e["ds6wg:ManufacturerEquivalentItemExtension.ManufacturerPartNumber"],c=[];return new Promise(t=>{this.utility=new n,this.utility.gettypeshierarchy(s).then(function(n){(c=a.filter(e=>-1!==n.types_hierarchies[0].hierarchy.indexOf(e))).length>0?o=!0:a.includes(s)?(o=!0,s===i.VPMREFERENCE&&l&&!a.includes(i.MEI_EXTENSION)&&(o=!1)):a.includes(i.MEI_EXTENSION)&&(s!==i.VPMREFERENCE||l?s===i.VPMREFERENCE&&l&&(o=!0):o=!1),r===e.resourceid&&(o=!1),t([o,c[0]])})})},d.prototype.processRequestCategoryNLS=function(e,t){let o=this;if(e.data&&t){var n={};return n[i.COMPONENT_INTRODUCTION_REQUEST]=o.NLS[i.COMPONENT_INTRODUCTION_REQUEST],t.data.map(function(e){n[e.name]=e.displayName?e.displayName:e.name}),e.data.map(function(e){if(e["request-template"]&&e["request-template"][0]){var t=e["request-template"][0].requestCategory;e["request-template"][0].requestCategory=n[t]?n[t]:t}}),e}return[]},d.prototype.getAppNLSbyType=function(e){let t=this.controller.app.typesConfigurator.appName?this.controller.app.typesConfigurator.appName:this.controller.app.typesConfigurator[e].appName;return this.controller.app.i18NGrouped[t]},d.prototype.getRelatedItemsAllowedStates=function(e,t,o){let n=this.controller.app.typesConfigurator[e];return this.getRelatedItemDataByRequestCategory(o.requestCategoryActual,this.controller.app.typesConfigurator[n.templateType],t).map(e=>i[e.toUpperCase()])},d.prototype.processData=function(e){var t=this;let o=e.data,n=e.definitions,a=t.controller.app.typesConfigurator[o.type],r=t.controller.app.typesConfigurator[a.templateType],s=i.REQUEST_CATEGORIES_ACTUAL.filter(e=>o.interfacesApplied.includes(e))[0];var l=t.getRouteTemplatesExistence(o,s,r),c=o.srcStatus,d={title:o.title?o.title:o.name,name:o.name,description:o.description,id:o.id,type:t.NLS[o.type],policy:o.policy,displayType:t.NLS[o.type],actualType:o.type,requestCategory:"",image:a.icons.tile,typeIcon:a.icons.type,maturityState:o.state,maturityStateDisplay:o.stateDisplay,modified:o.modified,created:o.originated,submitted:o.submitted,owner:o.owner,ownerIdentifier:o.ownerIdentifier,isOwner:o.isOwner,isRequestAssignee:o.isRequestAssignee,modifyAccess:o.modifyAccess,deleteAccess:o.deleteAccess,islast:t.NLS[o.islast],changeAccess:o.changesov,requestTemplate:"",requestTemplateId:"",requestTemplateAssigneeId:"",requestAssignee:"",requestAssigneeIdentifier:"",requestAssigneeId:"",requestAssigneeType:"",dueDate:o.dueDate,dueDateDisplay:o.dueDateDisplay,comments:o.comments,interfaceAttributeDetails:[],statusAttribute:c,statusAttributeDisplay:t.NLS[c],closureComments:o.closureComments,completedBy:o.completedBy,closureDate:o.closureDate,componentCategory:t.getRelatedDataValue(o,"component-classification","Proxy_Title","title"),componentCategoryId:t.getRelatedDataValue(o,"component-classification","Proxy_Id","physicalid"),collabSpace:o.collabSpace?o.collabSpace:"",organization:o.organization?o.organization:"",requestCategoryActual:s,revision:o.revision?o.revision:"",ownerId:o.ownerInfo?o.ownerInfo.id:""};a.contexts.forEach(e=>{d[e.name]=t.getRelatedDataValue(o,e.fieldName,e.titlekey),d[e.name+"ID"]=t.getRelatedDataValue(o,e.fieldName,e.idKey),d[e.name+"Service"]=t.getRelatedDataValue(o,e.fieldName,e.serviceKey)});let u=o["object-route"]?o["object-route"]:[];if(t.getWorkflowDataByRequestCategory(d.requestCategoryActual,r).forEach(e=>{let i=u.filter(t=>e.stateName===t.relelements.baseState);d[e.stateName]=t.manageRouteVisibleValues(i[0]?i[0].name:l[e.stateName]),d[e.stateName+" ID"]=i[0]?i[0].physicalid:""}),d.dueDateDisplay&&(d.dueDateDisplay=new Date(o.dueDateDisplay).toISOString()),n&&(d.definitions=n),o.interfacesApplied&&o.interfacesApplied.length>0){let e=i.REQUEST_CATEGORIES_ACTUAL,t=[];o.interfacesApplied.forEach(function(i){e.includes(i)||t.push(i)}),d.interfacesApplied=t.join()}o["context-user"]&&(d.currentUser=o["context-user"][0].id),o["request-template"]&&o["request-template"].forEach(function(e){d.requestTemplate=e.title+" ("+e.revision+")",d.requestTemplateId=e.physicalid,d.requestCategory=e.requestCategory,d.hasAnswerItems=e.hasAnswerItems,d.supportedInProcessItemTypes=e.supportedInProcessItemTypes,d.sourceType=e.source,d.inputItemsActions=r["input-items"].actions,d.requestTemplateAssigneeId=e["request-assignee"]?e["request-assignee"][0].id:"",e["request-assignee"]&&e["request-assignee"][0]["group-member"]&&(d.groupMembers=e["request-assignee"][0]["group-member"])}),o["request-assignee"]&&o["request-assignee"].forEach(function(e){e.type===i.TYPE_PERSON||e.type===i.TYPE_GROUP?(d.requestAssignee=(e.firstName+" "+e.lastName).trim()?e.firstName+" "+e.lastName:e.title,d.requestAssigneeType=e.type,d.requestAssigneeIdentifier=e.name,d.requestAssigneeId=e.id):e.type===i.TYPE_GROUP_PROXY&&(d.assigneeUUID=e.name,d.requestAssigneeType=e.type,d.requestAssignee=e.title,d.requestAssigneeId=e.id)}),o.ownerInfo&&(d.ownerFullName=(o.ownerInfo.firstname+" "+o.ownerInfo.lastname).trim()?o.ownerInfo.firstname+" "+o.ownerInfo.lastname:o.ownerInfo.name),d.extensionDetails=[];let p=o["interface-details"];if(p&&p.length>0){d.interfaceAttributeDetails=t.processForInterfaceFields(p);let e=[];p.forEach(function(t){let i={label:t.displayName?t.displayName:t.id,id:t.id?t.id:"",name:t.id?t.id:"",options:t.children};t.children&&t.children.forEach(function(e){d[e.id]=e.value}),e.push(i)}),d.extensionDetails=e}return{grid:d,label:d.title,thumbnail:require.toUrl(d.image),id:d.id}},d.prototype.getWorkflowDataByRequestCategory=function(e,t){return(t["request-category-configs"][e]?t["request-category-configs"][e]:t["request-category-configs"].default).workflow.map(e=>({stateName:e,labelNLSKey:e+"_label",placeholderNLSKey:e+"_placeholder"}))},d.prototype.getRelatedItemDataByRequestCategory=function(e,t,i){return(t["request-category-configs"][e]?t["request-category-configs"][e]:t["request-category-configs"].default)[i].allowedRequestStates},d.prototype.getWorkflowPolicyByRequestCategory=function(e,t){return(t["request-category-configs"][e]?t["request-category-configs"][e]:t["request-category-configs"].default).workflowPolicy},d.prototype.getRouteTemplatesExistence=function(e,t,i){let o=this.getWorkflowDataByRequestCategory(t,i),n=Object.assign({},...o.map(e=>({[e.stateName]:!1})));if(e&&e["request-template"]&&e["request-template"].length>0){let t=e["request-template"][0]["route-templates"];t&&t.map(function(e){n[e.requestState]=!0})}return n},d.prototype.processForInterfaceFields=function(e){var t=this,o=[],n=i.REQUEST_CATEGORIES_ACTUAL;return e.forEach(e=>{n.includes(e.id)&&e.children.forEach(e=>{var i={type:e.type,label:e.displayName,placeholder:t.NLS.ENTER_VALUE,name:e.id,value:e.value,from:"interface",disable:!0};if(e.range){i.type="select";var n=e.range,a=[],r=e.default;n.forEach(function(t,o){var n=t.trim(),s={label:e.displayRanges[o]?e.displayRanges[o]:n,value:n};n===r&&(s.selected="true"),a.push(s),i.options=a})}"string"===e.type&&t.lengthyExtensionAttributes[e.id]&&(i.isLengthy="true"===t.lengthyExtensionAttributes[e.id]),o.push(i)})}),o},d.prototype.buildGetLifecyclePayload=function(e){return{data:[{id:e.data.respParams.id,physicalid:e.data.respParams.id,type:e.data.respParams.type,identifier:e.data.respParams.id,source:"Sourcing",relativePath:"/resources/v1/modeler/dssourcing/sourcingrequests"}]}},d.prototype.processForList=function(e){var t=this;return new Promise(i=>{e.data&&i(e.data.map(e=>t.processData({data:e}),t))})},d.prototype.getSearchPayload=function(t,i){var o=i||"General Class";return{nresults:t.length,label:"test",locale:widget.lang,select_predicate:["ds6w:label","physicalid","name","ds6w:created","ds6w:modified","ds6w:responsible","ds6wg:revision","partnumber","ds6w:type"],select_file:["icon","thumbnail_2d"],query:'flattenedtaxonomies:"types/'+o+'"',source:["3dspace"],tenant:e.getPlatformId(),resourceid_in:t}},d.prototype.getActualDataFromSearch=function(e,t){if(!e.results)return{};var i=e.results.filter(e=>{return e.attributes.filter(e=>"physicalid"===e.name&&e.value===t).length>0}),o={};return i.length>0&&i[0].attributes.forEach(e=>{e.dispValue?o[e.name]=e.dispValue:o[e.name]=e.value}),o},d.prototype.getActualDataForTarget=function(e,t){var i=[];return e&&e.member&&(i=e.member.filter(e=>e.id===t)),i},d.prototype.manageRouteVisibleValues=function(e){let t=this;var i=e;return"boolean"==typeof e&&(i=i?t.NLS.not_started:t.NLS.not_defined),i},d.prototype.processPartSupplyData=function(e){var t=e;return e&&(t={partNumber:e.partNumber,name:e.modelName,navigationURL:e.navigationURL,modelDescription:e.modelDescription?e.modelDescription:"",supplierCategory:e.supplierCategory,Title:e.modelName,description:e.modelDescription?e.modelDescription:"",supplierId:e.supplierId}),t},d.prototype.processXInfraData=function(e){return e.member?e.member.map(e=>this.processXInfraItem(e),this):[]},d.prototype.processXInfraItem=function(e){return{image:"ENOXSourcingUXInfra/assets/icons/MEI-Thumbnail.png",title:e.title,name:e.name,description:e.description,id:e.id,type:e.type,state:e.state,status_value:e.status_value,stateDisplay:e.state,created:e.created,modified:e.modified?e.modified:e.modified_value,owner:e.owner,organization:e.manufacturer,collabspace:e.collabspace,organizationResponsible:e.organization,partNumber:e.manufacturerPartNumber,partSource:e.partSource,partSourceURL:e.partSourceURL,qualificationStatus:e.qualificationStatus,qualificationId:e.qualificationId,qualificationType:e.qualificationType,revision:e.revision,modifyAccess:e.modifyAccess,marketStatus:e.marketStatus,usageAuthorization:e.usageAuthorization,isOrderable:e.isOrderable,qualificationState:e.qualificationState,qualificationStateDisplay:this.NLS[e.qualificationState],cestamp:e.cestamp,mei_id:e.mei_id,mei_proxy_id:e.mei_proxy_id,customerAttributes:e.customerAttributes}},d.prototype.processQualificationData=function(e,i){var o=this;return this.totalTime=performance.now(),new Promise(n=>{if(e.data){var a=[];e.data.map(e=>{var t=e.relateddata.Context?e.relateddata.Context[0]:null,i=e.relateddata.target?e.relateddata.target[0]:null;t&&!a.includes(t.dataelements.Proxy_Id)&&a.push(t.dataelements.Proxy_Id),i&&!a.includes(i.dataelements.Proxy_Id)&&a.push(i.dataelements.Proxy_Id)});var r=o.getSearchPayload(a);a.length>0?t.getFederatedSearchDataPromise({searchPayLoad:r}).then(function(t){n(o.dataProcessorForQualifications(e,t,i))}):n([])}else n([])})},d.prototype.getSearchPayload=function(t,o){var n=o?'flattenedtaxonomies:"types/'+o+'"':'flattenedtaxonomies:"types/'+i.VPMREFERENCE+'" OR "types/'+i.TYPE_PLANT+'" OR "types/'+i.TYPE_PROJECT_SPACE+'" OR "types/'+i.TYPE_MODEL+'" OR '+i.DELFMIFUNCTIONREFERENCE_QUERY;return{nresults:t.length>1e3?999:t.length,label:"test",with_nls:!1,locale:widget.lang,select_predicate:["ds6w:label","physicalid","name","ds6w:description","ds6w:identifier","ds6w:status","ds6w:created","ds6w:modified","ds6w:responsible","ds6w:who/ds6w:responsible/ds6w:manufacturer","ds6wg:EnterpriseExtension.V_PartNumber","bo.ManufacturerEquivalentItemExtension.ManufacturerName","ds6wg:ManufacturerEquivalentItemExtension.ManufacturerPartNumber","ds6wg:revision","partnumber","ds6w:type"],select_file:["icon","thumbnail_2d"],query:n,source:["3dspace"],tenant:e.getPlatformId(),resourceid_in:t}},d.prototype.dataProcessorForQualifications=function(e,t,o,n){var a=this,r=e.data.map(e=>{var o=e.relateddata.Context?e.relateddata.Context[0]:null,r=o?a.getActualDataFromSearch(t,o.dataelements.Proxy_Id):{},s=e.relateddata.target?e.relateddata.target[0]:null,l={};l=n?s?a.getActualDataForTarget(n,s.dataelements.Proxy_Id):{}:s?a.getActualDataFromSearch(t,s.dataelements.Proxy_Id):{};let c="",d=[],u="",p="";e.relateddata.PreReq&&e.relateddata.PreReq.length>0&&(c=e.relateddata.PreReq[0].id,u=e.relateddata.PreReq[0].dataelements.name,p=e.relateddata.PreReq[0].dataelements.Revision),e.relateddata.prereqof&&e.relateddata.prereqof.length>0&&e.relateddata.prereqof.forEach(e=>{d.push(e.id)});let m="",f="",h=e.relateddata.Context;(e.type===i.TYPE_QUALIFICATION_LIST[2]||e.type===i.TYPE_QUALIFICATION_LIST[1]||e.type===i.TYPE_QUALIFICATION_LIST[3])&&h&&h[0]&&(m=h[0].type?h[0].type:h[0].dataelements.type,f=h[0].dataelements.Proxy_Service);var g={id:e.id,type:e.type,qual_type:e.type,qualId:e.id,typeNLS:a.NLS[e.type],displayType:a.NLS[e.type],actualType:e.type,qualificationType:e.type,contextType:a.getContextTypeForContextQualification(e),contextTypeActual:m,contextTypeSource:f,preReqOfIDs:d,preReqId:c,preReqName:u?u+" ("+p+")":"",name:e.dataelements.name,tree:e.dataelements.name,revision:e.dataelements.revision,maturityState:e.dataelements.state,qualificationMaturityDisplay:a.NLS[e.dataelements.state],qualificationMaturity:e.dataelements.state,preferred:e.type===i.TYPE_QUALIFICATION_LIST[0]?"":e.dataelements["SRC Preferred"],preferredDisplay:e.type===i.TYPE_QUALIFICATION_LIST[0]?"":"TRUE"===e.dataelements["SRC Preferred"]?a.NLS.yes:a.NLS.no,orderable:e.dataelements["SRC Is Orderable"],isOrderable:e.dataelements["SRC Is Orderable"],comments:e.dataelements["SRC Comments"],restriction:e.dataelements.Restriction,qualificationComments:e.dataelements["SRC Comments"],description:e.dataelements.description,modifyAccess:e.dataelements.modifyAccess,deleteAccess:e.dataelements.deleteAccess,changeAccess:e.dataelements.changesov,owner:e.dataelements.owner,ownerIdentifier:e.dataelements.ownerIdentifier,modified:e.dataelements.modified,created:e.dataelements.originated,lastTimeBuy:e.dataelements["Last Time Buy"],manufacturer_part_number:"",mei_title:"",manufacturer:"",enterpriseItem:a.getFormattedRevision(r),engRevision:r["ds6wg:revision"],thumbnail:require.toUrl("ENOXComponentQualification/assets/icons/Qualification-Thumbnail.png"),image:require.toUrl("ENOXComponentQualification/assets/icons/Qualification-Thumbnail.png"),mei_id:s?s.dataelements.Proxy_Id:"",mei_proxy_id:s?s.id:"",eng_id:o?o.dataelements.Proxy_Id:"",approved:e.dataelements["SRC Approved"],approvedDisplay:a.NLS[e.dataelements["SRC Approved"]],contextObj:h,organization:e.dataelements.organization?e.dataelements.organization:"",collabSpace:e.dataelements.collabSpace?e.dataelements.collabSpace:"",effectivityStartDate:e.dataelements["Effectivity Start Date"],effectivityEndDate:e.dataelements["Effectivity End Date"]};n&&l.length>0?(g.manufacturer_part_number=l[0].manufacturerPartNumber,g.mei_title=l[0].title,g.manufacturer=l[0].manufacturer):(g.manufacturer_part_number=l["ds6wg:ManufacturerEquivalentItemExtension.ManufacturerPartNumber"],g.mei_title=l["ds6w:label"],g.manufacturer=l["ds6w:who/ds6w:responsible/ds6w:manufacturer"]);var S=e.relateddata["interface-details"];if(S&&S.length>0){var y=[];S.forEach(function(e){var t={label:e.dataelements.displayName?e.dataelements.displayName:e.dataelements.description?e.dataelements.description:e.id,options:e.children,name:e.id};y.push(t)}),g.extensionDetails=y}var w=[{label:a.NLS.name,data:g.name},{label:a.NLS.maturity_state,data:g.maturityState},{label:a.NLS.revision,data:g.revision},{label:a.NLS.comments,data:g.comments},{label:a.NLS.manufacturer_equivalent_item,data:g.mei_title?g.mei_title:""},{label:a.NLS.engineering_item,data:g.enterpriseItem?g.enterpriseItem:""}],C={grid:g,label:g.name,subLabel:g.qualificationMaturityDisplay,thumbnail:g.thumbnail,description:g.revision,tooltip:w,id:g.id};return g.comments&&(C.description+="|"+g.comments),C});return o&&o.fromQualificationList&&(r=r.filter(function(e){return void 0!==e.grid.mei_title})),r},d.prototype.getContextTypeForContextQualification=function(e){let t=this;return e.type===i.TYPE_QUALIFICATION_LIST[2]&&e.relateddata.Context&&e.relateddata.Context[0]?(e=e.relateddata.Context[0]).type===i.TYPE_PROJECT_SPACE_ITEM_PROXY||e.type===i.TYPE_PROJECT_SPACE?t.NLS.project:e.type===i.TYPE_PLANT_ITEM_PROXY||e.type===i.TYPE_PLANT?t.NLS.plant:e.type===i.TYPE_MODEL_PROXY||e.type===i.TYPE_MODEL_VERSION_PROXY||e.type===i.TYPE_MODEL||e.type===i.TYPE_MODEL_VERSION?t.NLS.product:e.type===i.ENG_ITEM_PROXY||e.dataelements.type===i.VPMREFERENCE||e.dataelements.type===i.ENG_ITEM_PROXY?t.NLS.engineering_item:e.type:""},d.prototype.getFormattedRevision=function(e){var t=e["ds6w:label"]?e["ds6w:label"]:"";return t&&e["ds6wg:revision"]&&(t=t+" ("+e["ds6wg:revision"]+")"),t},d.prototype.isDueDateExceeded=function(e,t){var i=!1;if(void 0!==e){var o=new Date,n=String(o.getDate()).padStart(2,"0"),a=String(o.getMonth()+1).padStart(2,"0"),r=o.getFullYear();o=a+"/"+n+"/"+r,e=e.split(" ")[0],new Date(o)>new Date(e)&&"TRUE"===t&&(i=!0)}return i},d.prototype.processNotifyList=function(e){return{data:[{id:e.data.id,recipient:e.data.owner}]}},d.prototype.getRelatedDataValue=function(e,t,i,o){return e[t]&&e[t][0]?e[t][0][i]&&0!==e[t][0][i].length?e[t][0][i]:e[t][0][o]:""},d.prototype.isRejected=function(e){return c(/^Rejected - /,e.options.grid.comments)},d.prototype.isCancelled=function(e){return c(/^Cancelled - /,e.options.grid.comments)},d.prototype.isNotCancelledOrRejected=function(e){return!this.isCancelled(e)&&!this.isRejected(e)},d.prototype.getRequestCategory=function(e){return e.options.grid.requestCategory},d.prototype.getSubLabel=function(e){let{type:t,revision:i,maturityStateDisplay:o}=e.options.grid,n={type:t,revision:i,maturityStateDisplay:o};return Object.values(n).filter(e=>e).join(" | ")},d.prototype.enableApproveCommand=function(e,t){return(e===i.STATE_EVALUATION_REVIEW||e===i.STATE_IMPACTREVIEW||e===i.STATE_COMPONENTCONFIRMATION)&&t===i.TRUE},d.prototype.enableNeedForClarificationCommand=function(e,t){return e===i.TRUE||t===i.TRUE},d.prototype.enableSubmitClarificationCommand=function(e){return e===i.TRUE},d.prototype.getDescription=function(e){let{name:t,description:i}=e.options.grid,o={name:t,description:i};return Object.values(o).filter(e=>e).join(" | ")},d.prototype.getStatusbarIcons=function(e){let t=[],{dueDate:i,requestAssignee:o,componentCategory:n}=e.options.grid;return i&&this.isNotCancelledOrRejected(e)&&t.push(this.getDueDateIcon(e)),o&&t.push("users"),this.controller.app.typesConfigurator[e.options.grid.actualType].contexts.forEach(i=>{e.options.grid[i.name]&&t.push(i.icon)}),n&&t.push("library-class"),t},d.prototype.getDueDateIcon=function(e){let{dueDate:t,maturityState:i}=e.options.grid,n=new Date(Date.parse(t));return"Completed"!==i&&(o.isPast(n)||o.isWithinDays(n,7))?"clock-attention":"clock"},d.prototype.getCustomTooltip=function(e){let{title:t,type:i,revision:o,maturityStateDisplay:n,name:r,description:s,ownerFullName:l,created:c,modified:d}=e.options.grid;return function(e){let t="";return e.forEach(function(e){""!==e.data&&void 0!==e.data&&(""!==t&&(t+="\n"),t=t+e.label+": "+e.data)}),t}([{label:this.NLS.title,data:t},{label:this.NLS.type,data:i},{label:this.NLS.revision,data:o},{label:this.NLS.MATURITY,data:n},{label:this.NLS.name,data:r},{label:this.NLS.description,data:s},{label:this.NLS.owner,data:l},{label:this.NLS.created,data:a.getDateStringForDisplay(c)},{label:this.NLS.modified,data:a.getDateStringForDisplay(d)}])},d.prototype.getStatusbarIconsTooltips=function(e){let t=this,i=[],o=t.getAppNLSbyType(e.options.grid.actualType),{dueDate:n,requestAssignee:r,componentCategory:s}=e.options.grid;return n&&this.isNotCancelledOrRejected(e)&&i.push(t.NLS.due_date+": "+a.getDateStringForDisplay(n,{removeTime:!0})),r&&i.push(t.NLS.request_assignee+": "+r),t.controller.app.typesConfigurator[e.options.grid.actualType].contexts.forEach(t=>{e.options.grid[t.name]&&i.push(o[t.tooltipNLSKey]+": "+e.options.grid[t.name])}),s&&i.push(o.category_classification+": "+s),i},d.prototype.setStatusbarStyle=function(e){let t=e.cellView,i=t?t.contentView:void 0,n=i?i.elements:void 0,a=i.statusbarIcons,r=n?n.statusbaricons:void 0,{maturityState:s,dueDate:l}=e.cellModel.options.grid,c=new Date(Date.parse(l));return r&&r.length>0&&a&&(-1!==a.indexOf("clock")?"Completed"===s?r[a.indexOf("clock")].addClassName("xsourcing-completed"):r[a.indexOf("clock")].removeClassName("xsourcing-completed"):-1!==a.indexOf("clock-attention")&&(o.isPast(c)?r[a.indexOf("clock-attention")].addClassName("xsourcing-late"):r[a.indexOf("clock-attention")].removeClassName("xsourcing-late"),o.isWithinDays(c,7)?r[a.indexOf("clock-attention")].addClassName("xsourcing-within-threshold"):r[a.indexOf("clock-attention")].removeClassName("xsourcing-within-threshold"))),e},d.prototype.updateNeedForClarrificationMenu=function(e,t,o,n,a,r){var s=this;function l(e,t){return[i.STATE_SUBMITTED,i.STATE_EVALUATION,i.STATE_IMPACTIDENTIFICATION,i.STATE_COMPONENTIDENTIFICATION].includes(t)?e.push({text:s.NLS.need_for_clarification,name:i.STATE_NEED_FOR_CLARIFICATION,fonticon:"bell",disabled:!s.enableNeedForClarificationCommand(o,n)}):t===i.STATE_NEED_FOR_CLARIFICATION&&(e=[]).push({text:s.NLS.submit_clarification,name:i.SUBMIT_CLARIFICATION,fonticon:"bell",disabled:!s.enableSubmitClarificationCommand(a)}),e}if(r){let i=e.idCardDetails.dropdown.items;return e.idCardDetails.dropdown.items=l(i,t),e}{let i=e.items;return e.items=l(i,t),e}},d.prototype.updateNeedForClarrificationListRMB=function(e,t,o,n,a){var r=this;if(o.id=t.id,[i.STATE_SUBMITTED,i.STATE_EVALUATION,i.STATE_IMPACTIDENTIFICATION,i.STATE_COMPONENTIDENTIFICATION].includes(t.maturityState)){let s={type:"PushItem",title:r.NLS.need_for_clarification,state:r.enableNeedForClarificationCommand(t.isRequestAssignee,t.modifyAccess)?"enabled":"disabled",fonticon:{content:"wux-ui-3ds wux-ui-3ds-bell"},action:{callback:function(){n.actionCallbackHandler(n,o,a,{commandNLS:r.NLS.need_for_clarification,commandName:i.STATE_NEED_FOR_CLARIFICATION})}}};e.splice(e.length-1,0,s)}else if(t.maturityState===i.STATE_NEED_FOR_CLARIFICATION){let s={type:"PushItem",title:r.NLS.submit_clarification,state:r.enableSubmitClarificationCommand(t.isOwner)?"enabled":"disabled",fonticon:{content:"wux-ui-3ds wux-ui-3ds-bell"},action:{callback:function(){n.actionCallbackHandler(n,o,a,{commandNLS:r.NLS.submit_clarification,commandName:i.SUBMIT_CLARIFICATION})}}};e.splice(1,e.length-2),e.splice(e.length-1,0,s)}return e},d.prototype.processToolbarFilters=function(e=[],t,i){var o=[],n=e.length>0?e.filter(e=>"filters"===e.name):[];return 1===n.length&&n[0].range&&n[0].range.item.length>0&&n[0].range.item.forEach(function(e){o.push({text:e.display,title:e.display,id:"filter_"+e.value,selectable:!0,selected:t.filter?t.filter===e.value:!!e.default,handler:function(){i.filterComponentRequests(t,e.value)}})}),o},d.prototype.processInputAndDocuments=function(e,t){let i=[],o=[];e.data[0]["impacted-items"]&&e.data[0]["impacted-items"].forEach(e=>{i.push(e.Proxy_Id)}),e.data[0]["reference-document"]&&e.data[0]["reference-document"].forEach(e=>{o.push(e.Proxy_Id)}),e.data[0]["specification-document"]&&e.data[0]["specification-document"].forEach(e=>{o.push(e.Proxy_Id)}),0===i.length&&i.push("No Input Items"),0===o.length&&o.push("No documents");let n={view:t.view,inputItems:i,documents:o,parentObjectid:e.data[0].id,evtObj:t};return this.controller.app.answerItemData=n,n},d.prototype.resizeAutocomplete=function(e,t,i){e.style.width=i._searchComponent._autocomplteWrapper.style.width,t.getInputField().setStyle("min-height",i._searchComponent._autocomplteWrapper.clientHeight),e.style.position=i._searchComponent._autocomplteWrapper.style.position,e.style.top=i._searchComponent._autocomplteWrapper.style.top,e.style.left=i._searchComponent._autocomplteWrapper.style.left},d.prototype.visibilityToggler=function(e,t){e.style.display="inline-block",t.forEach(e=>{e.style.display="none"})},d.prototype.processDataForRelationsTab=function(e){return new Promise(t=>{let o=this,n=[],a=[],r=e.data.mei_id,s=e.data.preReqId,l=e.data.preReqOfIDs;r&&n.push(r),e.data.contextObj.forEach(e=>{e.dataelements.Proxy_Service===i.SOURCE_3DPLAN?a.push(e.dataelements.Proxy_Id):e.dataelements.Proxy_Id&&n.push(e.dataelements.Proxy_Id)}),s&&n.push(s),l.length>0&&n.push(...l);let c="";a.forEach(e=>{c+='uri:"'+e+'"'+i.OR}),n.forEach(e=>{c+='physicalid:"'+e+'"'+i.OR});let d={completePreCond:c=c.substring(0,c.length-4),nresults:a.length+n.length,start:"0",with_nls:!1},u=o.searchUtil.getSearchPayload([],[],[i.SOURCE_SOURCING,i.SOURCE_3DSPACE,i.SOURCE_3DPLAN],d);o.searchUtil.callFederatedSearch(u).then(function(i){let n=o.searchUtil.processResults(i);0===n.length&&t([]);let a=[],c=o.NLS.qualification_context,d="context",u=[];e.data.contextObj.forEach(e=>{let t=n.filter(t=>t.resourceid===e.dataelements.Proxy_Id);t.length>0&&u.push(o.getGridForRelatedItem(t[0])[0])}),u.length>0&&a.push({isHeader:!0,relIdentifier:d,label:c,contentItems:u}),n.forEach(function(e){c="",d="",e.resourceid===r&&(d="target",c=o.NLS.qualification_target),e.resourceid===s&&(c=o.NLS.qualification_prereq,d="prereq"),c&&a.push({isHeader:!0,relIdentifier:d,label:c,contentItems:o.getGridForRelatedItem(e)})}),c=o.NLS.qualification_prereq_of,d="prereqof";let p=[];l.forEach(function(e){let t=n.filter(t=>t.resourceid===e);t.length>0&&p.push(o.getGridForRelatedItem(t[0])[0])}),p.length>0&&a.push({isHeader:!0,relIdentifier:d,label:c,contentItems:p}),0!==a.length?o.handleTranslations(a,t):t(a)})})},d.prototype.processDataForRelationsTabCRA=async function(e){let t=this,i=void 0!==e.data.impactedItems?e.data.impactedItems:[],o=void 0!==e.data.inprocessItems?e.data.inprocessItems:[],n=void 0!==e.data.answerItems?e.data.answerItems:[],a=void 0!==e.data.objectRoute?e.data.objectRoute:[];const r=e=>e.map(e=>""!==e.Proxy_Id&&void 0!==e.Proxy_Id?e.Proxy_Id:e.id);let s=r(i),l=r(o),c=r(n),d=r(a),u=[...i,...o,...n,...a],p=t.preProcessForSearch(u);const m=t.searchUtil.getSearchPayload(p.objIds,p.types,p.sources);try{const e=await t.searchUtil.callFederatedSearch(m);let i=t.searchUtil.processResults(e);if(0===(i=i.concat(a)).length)return[];let o=[];if(i.forEach(function(e){const i=[],n=[];if(s.includes(e.resourceid)&&(i.push(t.NLS.impacted_item),n.push("Input Item")),l.includes(e.resourceid)&&(i.push(t.NLS.in_process_item),n.push("In Process Item")),c.includes(e.resourceid)&&(i.push(t.NLS.answer_item),n.push("Answer Item")),(d.includes(e.resourceid)||d.includes(e.id))&&(i.push(t.NLS.route),n.push("Route")),i.length>0){const a=t.getGridForRelatedItem(e);for(let e=0;e<i.length;e++)t.addToPreparedData(n[e],i[e],a,o)}}),0===o.length)return o;const n=["Answer Item","In Process Item","Input Item","Route"];return o.sort((e,t)=>n.indexOf(e.relIdentifier)-n.indexOf(t.relIdentifier)),await t.handleTranslationsCRA(o),o}catch(e){throw e}},d.prototype.addToPreparedData=function(e,t,i,o){const n=o.find(t=>t.relIdentifier===e),a={isHeader:!0,relIdentifier:e,label:t,contentItems:i.map(e=>({...e}))};n?n.contentItems.push(...a.contentItems):o.push(a)},d.prototype.handleTranslations=function(e,t){let i={"ds6w:status":[],"ds6w:type":[]};e.forEach(e=>{e.contentItems.forEach(e=>{i["ds6w:status"].push(e.grid.maturity),i["ds6w:type"].push(e.grid.type)})}),this.searchUtil.getNlsOfPropertiesValues(i).then(function(t){e.forEach(e=>{e.contentItems.forEach(e=>{e.grid.maturityDisplay=t["ds6w:status"][e.grid.maturity]?t["ds6w:status"][e.grid.maturity]:e.grid.maturity,e.grid.typeDisplay=t["ds6w:type"][e.grid.type]?t["ds6w:type"][e.grid.type]:e.grid.type})})}).finally(function(){t(e)})},d.prototype.getGridForRelatedItem=function(e){return[{grid:{title:e["ds6w:label"]||e.title,name:e["ds6w:identifier"]||e.name,revision:e["ds6wg:revision"]||e.revision,modificationDate:e["ds6w:when/ds6w:modified"]||e.modified,owner:e["ds6w:who/ds6w:responsible"]||e.owner,maturity:e["ds6w:what/ds6w:status"]||e.stateDisplay,type:e["ds6w:what/ds6w:type"]||e["ds6w:type"]||e.type,organization:e.organization},thumbnail:e.preview_url,id:e.resourceid||e.id}]},d.prototype.getContextsColumnDefinitions=function(){let e=this,t=e.controller.app.typesConfigurator,i=[];for(let o in t)if(t.hasOwnProperty(o)&&t[o].contexts){let n=t[o].contexts,a=e.getAppNLSbyType(o);i.push(...n.map(t=>e.prepareDynamicColumn(a,t.name,t.labelNLSKey,!0)))}return i.filter((e,t,i)=>t===i.findIndex(t=>t.dataIndex===e.dataIndex))},d.prototype.prepareDynamicColumn=function(e,t,i,o){return{text:e[i],dataIndex:t,minWidth:200,visibleFlag:o}},d.prototype.getField=function(e){let t=this,i=e.data,o=t.getAppNLSbyType(i.actualType),n=e.props,a=JSON.parse(e.props.viewConfig),r=a.attributeType,s={name:n.name,label:t.NLS[e.fieldConfig.labelNLSKey]||"NLS not defined",...e.fieldConfig.accordeonHeader&&{accordeonHeader:{label:o[e.fieldConfig.accordeonHeader],value:e.fieldConfig.accordeonHeader}},...e.fieldConfig.placeholderNLSKey&&{placeholder:t.NLS[e.fieldConfig.placeholderNLSKey]},value:i[n.name]};if("string"===r)if(n.range)if(a.multivalue){s.type="autocomplete",s.showSuggestsOnFocus=!0,s.multiSelect=!0,s.className="src-multi-select-autocomplete";let e=n.range.item.map(e=>({value:e.value,label:e.display,selected:s.value?s.value.includes(e.value):!!e.default}));s.dataSet={items:e},s.tokenSeparator=", "}else{s.type="select";let e=n.range.item.map(e=>({value:e.value,label:e.display,selected:s.value?s.value.includes(e.value):!!e.default}));s.options=e}else a.multiline?(s.type="textarea",s.multiline=!0,s.errorText=t.NLS.max_char_limit_err_msg,s.isLengthy=!0,s.helperText=t.NLS.length_256_limit):(s.type="text",s.errorText=t.NLS.max_char_limit_err_msg,s.isLengthy=!1,s.helperText=t.NLS.length_100_limit);else if("real"===r||"integer"===r){if(s.type=r,a.minimum&&a.maximum){s.minValue=a.minimum,s.maxValue=a.maximum;let e=t.NLS.helper_text_number_range;e=(e=e.replace("$1",a.minimum)).replace("$2",a.maximum),s.helperText=e}}else if("timestamp"===r||"date"===r)s.type="date";else if("boolean"===r){s.type="select";let e=n.range.item.map(e=>({value:e.value,label:e.display,selected:s.value?s.value.includes(e.value):!!e.default}));s.options=e}return s},d.prototype.getPropertyMapper=function(e,t,i){return[{name:"type",helperMethod:"getTypePropertyField"},{name:"title",helperMethod:"getTitlePropertyField"},{name:"requestCategory",helperMethod:"getRequestCategoryPropertyField"},{name:"classification",helperMethod:"getClassificationCategoryPropertyField"},{name:"description",helperMethod:"getDescriptionPropertyField"},{name:"comments",helperMethod:"getCommentsPropertyField"},{name:"Submitted Date",helperMethod:"getSubmittedDatePropertyField"},{name:"dueDate",labelNLSKey:"due_date"},...e.includeProperties,...e.contexts.map(e=>({name:e.name,helperMethod:this.getCtxPropertyHelperMethod(e.name)})),...this.getWorkflowDataByRequestCategory(i.data.respParams.requestCategoryActual,t).map(e=>({name:e.stateName,helperMethod:"getApprovalWorkflowPropertyField"}))]},d.prototype.getTitlePropertyField=function(e){let t=e.options.data.respParams.title;return{type:"text",label:this.NLS.title,placeholder:this.NLS.enter_title,name:"title",value:t,required:!0,errorText:this.NLS.max_char_limit_err_msg,isLengthy:!1,helperText:this.NLS.length_100_limit}},d.prototype.getCtxPropertyHelperMethod=function(e){let t;switch(e){case"contextProject":t="getContextProjectPropertyField";break;case"contextProduct":t="getContextProductPropertyField";break;case"contextPlant":t="getContextPlantPropertyField";break;default:widget.notificationUtil.showError("Context Field helper method not defined for:"+e)}return t},d.prototype.getContextProjectPropertyField=function(t){let o=t.options,n=t.options.data.respParams[t.name+"ID"];return{type:o.data.respParams.contextProjectID?"hyperlinkWithAutoCompleteWithSearchField":"autocompleteWithSearch",label:this.NLS.contextProject,placeholder:this.NLS.type_search_input_item,accordeonHeader:{label:this.NLS.ctx_information,value:"contextInformation"},name:i.CONTEXT_PROJECT,value:o.data.respParams.contextProject?o.data.respParams.contextProject:"",errorText:this.NLS.max_char_limit_err_msg,isLengthy:!1,helperText:this.NLS.length_100_limit,multiSelect:!1,itemMultiSelect:!1,allowFreeInput:!0,floatingSuggestions:!0,allowDrop:!1,identifier:n,id:n,completePreCond:i.CONTEXT_PROJECT_OP_SEARCH_QUERY,sources:[i.SOURCE_3DSPACE,i.SOURCE_3DPLAN],searchButtonNotRequired:!1,callBack:function(){if(o.data.respParams.contextProjectID.contains("uuid")||o.data.respParams.contextProjectService&&"3dplan"===o.data.respParams.contextProjectService){let t=o.data.respParams.contextProjectID.replace("<","").replace(">","");t=encodeURIComponent(t),window.open(e._platforms[i.SERVICE_3DDASHBOARD]+"#dashboard:/tab:/app:ENXPLAN_AP/content:ids="+t+"&tenant="+e.getPlatformId()+"&x3dPlatformId="+e.getPlatformId())}else window.open(e._platforms[i.SERVICE_3DSPACE]+"/common/emxNavigator.jsp?objectId="+o.data.respParams.contextProjectID)},callback:function(e){var t=e.getInputField();t.value=e.getSelectedObjectAttrValue("label"),t.id=e.getSelectedObjectAttrValue("value"),t.identifier=e.getSelectedObjectAttrValue("value"),e.autocompleteField.elements.input=t,void 0===e.getSelectedObjectAttrValue("resourceid")&&e.clearIdentifier(e)},events:s.getProxyObjectEvents(i.TYPE_PROJECT_SPACE_ITEM_PROXY)}},d.prototype.getContextProductPropertyField=function(t){let o=t.options,n=t.options.data.respParams[t.name+"ID"];return{type:o.data.respParams.contextProductID?"hyperlinkWithAutoCompleteWithSearchField":"autocompleteWithSearch",label:this.NLS.contextProduct,placeholder:this.NLS.type_search_input_item,allowDrop:!1,accordeonHeader:{label:this.NLS.ctx_information,value:"contextInformation"},name:i.CONTEXT_PRODUCT,value:o.data.respParams.contextProduct?o.data.respParams.contextProduct:"",multiSelect:!1,itemMultiSelect:!1,allowFreeInput:!1,floatingSuggestions:!0,identifier:n,id:n,completePreCond:i.CONTEXT_PRODUCT_SEARCH_QUERY,sources:[i.SOURCE_3DSPACE,i.SOURCE_3DPLAN],searchButtonNotRequired:!1,callback:function(e){var t=e.getInputField();t.value=e.getSelectedObjectAttrValue("label"),t.id=e.getSelectedObjectAttrValue("value"),t.identifier=e.getSelectedObjectAttrValue("value"),e.autocompleteField.elements.input=t,void 0===e.getSelectedObjectAttrValue("resourceid")&&e.clearIdentifier(e)},callBack:function(){window.open(e._platforms[i.SERVICE_3DSPACE]+"/common/emxNavigator.jsp?objectId="+o.data.respParams.contextProductID)},events:s.getProxyObjectEvents(i.TYPE_MODEL_PROXY)}},d.prototype.getContextPlantPropertyField=function(t){let o=t.options,n=t.options.data.respParams[t.name+"ID"];return{type:o.data.respParams.contextPlantID?"hyperlinkWithAutoCompleteWithSearchField":"autocompleteWithSearch",label:this.NLS.contextPlant,placeholder:this.NLS.type_search_input_item,accordeonHeader:{label:this.NLS.ctx_information,value:"contextInformation"},name:i.CONTEXT_PLANT,value:o.data.respParams.contextPlant?o.data.respParams.contextPlant:"",multiSelect:!1,itemMultiSelect:!1,allowFreeInput:!1,floatingSuggestions:!0,allowDrop:!1,identifier:n,id:n,completePreCond:i.CONTEXT_PLANT_SEARCH_QUERY,sources:[i.SOURCE_3DSPACE,i.SOURCE_3DPLAN],searchButtonNotRequired:!1,callback:function(e){var t=e.getInputField();t.value=e.getSelectedObjectAttrValue("label"),t.id=e.getSelectedObjectAttrValue("value"),t.identifier=e.getSelectedObjectAttrValue("value"),e.autocompleteField.elements.input=t,void 0===e.getSelectedObjectAttrValue("resourceid")&&e.clearIdentifier(e)},callBack:function(){window.open(e._platforms[i.SERVICE_3DSPACE]+"/common/emxNavigator.jsp?objectId="+o.data.respParams.contextPlantID)},events:s.getProxyObjectEvents(i.TYPE_PLANT_ITEM_PROXY)}},d.prototype.getApprovalWorkflowPropertyField=function(t){let o=this,a=o.getAppNLSbyType(t.options.data.respParams.actualType),r=t.options.data.respParams[t.name+" ID"],s=t.options.data.respParams[t.name],l=o.controller.app.typesConfigurator[t.options.data.respParams.actualType],c=o.controller.app.typesConfigurator[l.templateType],d=o.getWorkflowDataByRequestCategory(t.options.data.respParams.requestCategoryActual,c).filter(e=>e.stateName===t.name)[0];return{type:r?"hyperlink":"simpleText",label:a[d.labelNLSKey],accordeonHeader:{label:o.NLS.route_information,value:"routeInformation"},name:t.name,disable:!0,value:s,nonEditable:!0,callBack:function(){if(e.getPlatformId()===i.ONPREMISE){let e={routeId:r,routeName:s},t=i.ROUTE_MANAGEMENT;(new n).showWidget(t,e)}else window.open(o.controller.app.platformServices.sourcing+"/common/emxNavigator.jsp?objectId="+r)}}},d.prototype.getSubmittedDatePropertyField=function(e){let t=e.options.data.respParams.submitted?a.getDateStringForDisplay(e.options.data.respParams.submitted,{weekdayShort:!0}):"";return{type:"simpleText",label:this.NLS.submitted_date,name:"Submitted Date",value:t,nonEditable:!0,disable:!0}},d.prototype.getDescriptionPropertyField=function(e){let t=e.options.data.respParams.description;return{type:"textarea",label:this.NLS.description,placeholder:this.NLS.description,name:"description",value:t,disable:!0,errorText:this.NLS.max_char_limit_err_msg,isLengthy:!0,helperText:this.NLS.length_256_limit}},d.prototype.getCommentsPropertyField=function(e){let t=e.options.data.respParams.comments;return{type:"textarea",label:this.NLS.comments,placeholder:this.NLS.comments,name:"SRCREQUEST.Comments",value:t,disable:!0,errorText:this.NLS.max_char_limit_err_msg,isLengthy:!0,helperText:this.NLS.length_256_limit}},d.prototype.getTypePropertyField=function(e){let t=e.options.data.respParams.type;return{type:"text",label:this.NLS.type,name:"type",value:this.NLS[t]?this.NLS[t]:t,disable:!0,nonEditable:!0}},d.prototype.getRequestCategoryPropertyField=function(e){let t=e.options.data.respParams.requestCategory;return{type:"text",label:this.NLS.request_category,name:"requestCategory",value:t,disable:!0,nonEditable:!0}},d.prototype.processSelectedClassificationData=function(e={}){let{idList:t="",labelList:i=""}=e,o=[];var n=t.split(",");n.length>0&&i.split(",").forEach(function(e,t){o.push({value:e,id:n[t]})});return o},d.prototype.createNodeForCompCategory=function(e={}){let{label:t,id:i,icon:o="",type:n,name:a,state:r}=e;return new l({label:t||"Label not available",id:i,icons:[o],grid:{type:n,name:a,state:r},children:[]})},d.prototype.getClassificationCategoryPropertyField=function(e){let t=this,o=t.getAppNLSbyType(e.options.data.respParams.actualType),n=e.options.data.respParams.componentCategoryId,a=e.options.data.respParams.componentCategory?e.options.data.respParams.componentCategory:t.NLS.not_defined,r=n?t.processSelectedClassificationData({idList:n,labelList:a}):[];return{type:"autocompleteWithSearch",multiSelect:!1,name:"componentcategory_ID",placeholder:t.NLS.select_component_category,label:o.category_classification,values:r,minLengthBeforeSearch:"disable",typeDelayBeforeSearch:"disable",keepSearchResultsFlag:"disable",itemMultiSelect:!1,allowFreeInput:!1,floatingSuggestions:!0,searchButtonNotRequired:!1,allowDrop:!1,completePreCond:i.IP_CLASSIFICATION__SEARCH_QUERY,extraQuery:t.controller.getRTSpecificComponentClassificationId(),sources:[i.SOURCE_3DSPACE],dataFetcherMethod:function(){return t.controller.getLibraryClassificationData()}}},d.prototype.getOrganizationField=function(e){return{type:"text",label:this.NLS.organization,name:"organization",value:e.options.data.respParams.organization,disable:!0,nonEditable:!0}},d.prototype.getCollabSpaceField=function(e){return{type:"text",label:this.NLS.collab_space,name:"collabSpace",value:e.options.data.respParams.collabSpace,disable:!0,nonEditable:!0}},d.prototype.getFieldsForPropertiesPage=function(e){let t=this,o=[],n=t.controller.app.typesConfigurator[e.data.respParams.actualType],a=t.controller.app.typesConfigurator[n.templateType],r=e.data.respParams.definitions.filter(e=>e.name===i.REQ_6W_XML_SERVICE_NAME)[0].items;return(o=t.getPropertyMapper(n,a,e).filter(e=>!n.excludeProperties.includes(e.name)).map(i=>{let o;return o=i.helperMethod?t[i.helperMethod]({name:i.name,options:e,viewRef:e.that}):t.getField({props:r.filter(e=>e.name===i.name)[0],data:e.data.respParams,fieldConfig:i})})).push(...t.getDynamicFields(e)),o.push(t.getOrganizationField({name:"organization",options:e,viewRef:e.that})),o.push(t.getCollabSpaceField({name:"collabSpace",options:e,viewRef:e.that})),o},d.prototype.getDynamicFields=function(e){let t=this,o=[...e.data.respParams.interfaceAttributeDetails,...t.getCustomerExtFields(e.data.respParams.extensionDetails)];if(e.data.respParams.maturityState===i.STATE_COMPLETED||e.data.respParams.maturityState===i.STATE_CLOSED){let i=t.addClosureDetails(e);o.push(...i)}return o},d.prototype.addClosureDetails=function(e){return[{type:"simpleText",label:this.NLS.closure_comments,placeholder:this.NLS.closure_comments,accordeonHeader:{label:this.NLS.closure_details,value:"closureDetails"},name:this.NLS.closure_comments,value:e.data.respParams.closureComments?e.data.respParams.closureComments:"",disable:!0,errorText:this.NLS.max_char_limit_err_msg,isLengthy:!0,nonEditable:!0},{type:"simpleText",label:this.NLS.closure_date,placeholder:this.NLS.closure_date,accordeonHeader:{label:this.NLS.closure_details,value:"closureDetails"},nonEditable:!0,name:this.NLS.closure_date,value:e.data.respParams.closureDate?a.getDateStringForDisplay(e.data.respParams.closureDate,{weekdayShort:!0}):"",disable:!0},{type:"simpleText",label:this.NLS.completed_by,placeholder:this.NLS.completed_by,accordeonHeader:{label:this.NLS.closure_details,value:"closureDetails"},name:this.NLS.completed_by,disable:!0,value:e.data.respParams.completedBy?e.data.respParams.completedBy:"",nonEditable:!0}]},d.prototype.getCustomerExtFields=function(e){let t=i.REQUEST_CATEGORIES_ACTUAL,o=[];return e&&e.forEach(function(e){!t.includes(e.id)&&e.options&&e.options.forEach(function(t){let i={type:t.type,label:t.displayName?t.displayName:t.id,value:t.value,name:t.id,disable:!0,default:t.default,accordeonHeader:{label:e.label,value:e.name}};if(t.hasOwnProperty("range")){i.type="select";let e=[];t.range.forEach(function(o,n){o=o.trim();let a={label:t.displayRanges[n]?t.displayRanges[n]:o,value:o};void 0===i.value&&t.default===o&&(a.selected=!0),e.push(a)}),i.options=e}o.push(i)})}),o},d.prototype.getTypeFromTypeHierarchy=function(e,t,i){let o="";return e.length<1||i.includes(t)?o=t:e.forEach(function(e){i.includes(e)&&(o=e)}),o},d.prototype.handleTranslationsCRA=async function(e){try{let t=this,i={"ds6w:status":[],"ds6w:type":[]};e.forEach(e=>{e.contentItems.forEach(e=>{i["ds6w:status"].push(e.grid.maturity),i["ds6w:type"].push(e.grid.type)})});const o=await t.searchUtil.getNlsOfPropertiesValues(i);return e.forEach(e=>{e.contentItems.forEach(e=>{e.grid.maturityDisplay=o["ds6w:status"][e.grid.maturity]?o["ds6w:status"][e.grid.maturity]:e.grid.maturity,e.grid.typeDisplay=o["ds6w:type"][e.grid.type]?o["ds6w:type"][e.grid.type]:e.grid.type})}),e}catch(e){throw e}},d}),define("DS/ENOXSourcingRequest/components/genericHomePage/HomePage",["css!DS/ENOXSourcingRequest/components/genericHomePage/css/HomePage.css"],function(){"use strict";var e=function(){};return e.prototype.init=function(){},e}),define("DS/ENOXSourcingRequest/views/TaskView/ProcessView",["UWA/Core","UWA/Class/View","DS/ENOProcessStepsUX/scripts/ProcessStepsView","DS/ENOXSourcingUXInfra/service/ENOXSourcingPlatformServices","DS/ENOXSourcingUXInfra/service/ENOXSourcingService"],function(e,t,i,o,n){"use strict";return t.extend({name:"approval-view",tagName:"div",className:"generic-detail6",domEvents:{},init:function(e){this.model=e.model,["container","template","tagName","domEvents"].forEach(function(t){delete e[t]}),this._parent(this,e)},setup:function(){this.listenTo(this.model,"onChange",this.render),this.container.addClassName(this.getClassNames("-container"))},render:function(){var e=this;this.container.empty(),this.container.setStyle("height","calc(100% - 10px)");var t=this.model.get("id"),a=new i,r={};r.renderTo=e.container,r.page=e.model.get("policy");var s={};s.id=t.replace("pid:",e.model.get("id")),r.myAppsURL=o.getServiceURL("sourcing"),r.tenant=o.getPlatformId(),r.securityContext=n.getSecurityContext("sourcing"),r.data=s,r.data.callback=function(){e.model.get("refreshCallback")()};try{a._createView_ProcessSteps(r)}catch(e){}return this.container},update:function(){try{var e=this.container.parentElement.parentElement.getBoundingClientRect();this.requestComponentDiv.style.height=e.height/2+"px",this.responseComponentDiv.style.height=e.height/2+"px"}catch(e){}},destroy:function(){return this._parent.apply(this,arguments)}})}),define("DS/ENOXSourcingRequest/helpers/typesConfigProvider",["UWA/Class/Debug","DS/ENOXSourcingUXInfra/Constants/ENOXSourcingConstants"],function(e,t){"use strict";return UWA.Class.singleton(e,{init:function(e){this._parent(e)},getMergedAdminTypeConfigs:function(){let e={};return t.REQUEST_ADMIN_APPS_TYPES_CONFIG_PATHS.reduce(function(t,i){return new UWA.Promise(function(o,n){t.then(function(){require([i+"/typesConfigurator"],function(t){e[t.objectTypes.template]=t[t.objectTypes.template],e[t.objectTypes.request]=t[t.objectTypes.request],e[t.objectTypes.template].appName=e[t.objectTypes.request].appName=t.appName,o(e)},function(){o(e)})}).catch(function(e){n(e)})})},UWA.Promise.resolve([]))}})}),define("DS/ENOXSourcingRequest/views/ComponentRequest/ListComponentRequest",["DS/UIKIT/Mask","DS/Menu/Menu","DS/ENOXSourcingUXInfra/xsourcingCollectionView/xsourcingCollectionView","DS/ENOXSourcingUXInfra/DragAndDrop/ENOXSourcingDataDragAndDrop","DS/ENOXSourcingUXInfra/Constants/ENOXSourcingConstants","DS/ENOXSourcingUXInfra/TypeAHead/ENOXTypeaheadWithSearch","DS/ENOXSourcingUXInfra/service/ENOXSourcingPlatformServices"],function(e,t,i,o,n,a,r){"use strict";var s=function(e){this.controller=e,this.helper=e.helper,this.NLS=this.controller.app.i18NProvider};return s.prototype.render=function(e){var t=this,a=widget.getElement(".information-panel.panel-icon-wrapper");a&&a.style.removeProperty("display"),t.controller.app._applicationChannel.publish({event:"xsourcing-collectionview-unselected-object-id",data:{selectedObjectId:null}}),t.taggerProxy=e.taggerProxy,t.options=e,e.dropStrategy="OPEN",e.onDropCallback=function(i){if(i){var o=e;o.data=i,t.controller.onDropAction(o)}};var r={hideTitle:!0,uniqueIdentifier:"NewCompReq"};r.itemsName=t.NLS.my_requests,r.views=["Grid","Tile"],t.options.app.configurator.enableDashboardView&&(t.filterData=[],t.filtersApplied=[],r.views.push("Graph View"),r.customView={id:"Graph View",text:t.NLS.graph_view,fonticon:"fonticon fonticon-chart-line"},r.customViewLoader=(()=>{let e=t.options.filter?t.options.filter:"";t.options.app.dataControllers.dashboardController.loadDashboardView(s,e,t.filterData,t.filtersApplied)}),r.filterCallback=(e=>{if(t.filterData=e,"Graph View"===s._xsourcingCollectionViewUI.currentView){s._xsourcingCollectionViewUI.viewContainer.empty();let e=t.options.filter?t.options.filter:"";t.options.app.dataControllers.dashboardController.loadDashboardView(s,e,t.filterData,t.filtersApplied)}})),r.enableDrag=!0,r.columnsConfigurations=[{text:t.NLS.title,dataIndex:"tree",resizableFlag:!0,sortableFlag:!0,pinned:"left",width:150,icon:"",typeRepresentation:"url",hyperlinkTarget:"_self",hyperlinkClickCallback:function(e){t.controller.closeTagger();var i=e.nodeModel.options.grid;t.controller.app.router.navigate("home.ComponentRequestDetails",i)},getCellValue:function(e){return{icon:{iconPath:require.toUrl(e.nodeModel.getAttributeValue("typeIcon")),iconSize:{height:"16px",width:"16px"}},label:e.nodeModel.options.label,url:"javascript:;",hyperlinkClickCallback:e.nodeModel.options.grid.grouped?void 0:this.layout.getColumnOptionValue(e.columnID,"hyperlinkClickCallback")}}},{text:t.NLS.name,dataIndex:"name"},{text:t.NLS.description,dataIndex:"description"},{text:t.NLS.status,dataIndex:"statusAttributeDisplay",minWidth:125},{text:t.NLS.request_category,dataIndex:"requestCategory",minWidth:150},{text:t.NLS.interfacesApplied,dataIndex:"interfacesApplied",visibleFlag:!1,minWidth:150},{text:t.NLS.category_classification,dataIndex:"componentCategory",minWidth:150},{text:t.NLS.request_template,dataIndex:"requestTemplate",minWidth:150},{text:t.NLS.context,dataIndex:"Context",children:[...t.controller.helper.getContextsColumnDefinitions()]},{text:t.NLS.request_assignee,dataIndex:"requestAssignee",minWidth:200},{text:t.NLS.submitted_by,dataIndex:"ownerFullName",minWidth:200},{text:t.NLS.due_date,dataIndex:"dueDateDisplay",minWidth:150,typeRepresentation:"date"},{text:t.NLS.creation_date,dataIndex:"created",minWidth:150,typeRepresentation:"datetime"},{text:t.NLS.modified_date,dataIndex:"modified",minWidth:150,typeRepresentation:"datetime"}],r.data=e.data,r.showToolbar=!0,r.showToolbarInfoIcon=!0,r.showMobileWelcomePanelIcon=!0,r.toolbarActions=[{id:"createRequest",text:t.NLS.new_request,fonticon:"plus",handler:function(){t.controller.app.answerItemData=void 0,t.controller.showRequestTypeChooser({wizardRoute:"modal.wizard.type"})}},{id:"promote",text:t.NLS.submit,fonticon:"send",disabled:!0,handler:function(){t.submitComponentRequest(t,e)}},{id:"delete",text:t.NLS.delete,fonticon:"trash",disabled:!0,handler:function(){t.deleteComponentRequest(t,e)}}],t.overrideToolbarSearchAction(r),r.onContextualEventCallback=function(i){var o=[];if(i){var a=i.cellInfos&&i.cellInfos.nodeModel?i.cellInfos.nodeModel:null;if(-1===(i.cellInfos?i.cellInfos.rowID:null)||!a)return this._contextualMenuBuilder?this._contextualMenuBuilder.buildMenu(i,e):[];var r=i.cellInfos.nodeModel?i.cellInfos.nodeModel:i.cellInfos.cellModel,s=r.options.grid;r&&(o=[{type:"PushItem",id:"OpenItem",title:t.NLS.open,fonticon:{content:"wux-ui-3ds wux-ui-3ds-open"},action:{callback:function(){t.controller.closeTagger(),t.controller.app.router.navigate("home.ComponentRequestDetails",s)}}},{type:"PushItem",title:t.NLS.submit,state:s.maturityState===n.STATE_IN_DRAFT?"enabled":"disabled",fonticon:{content:"wux-ui-3ds wux-ui-3ds-send"},action:{callback:function(){e.contextualNode=[a],t.submitComponentRequest(t,e)}}},{type:"PushItem",title:t.NLS.create_answer_request,state:t.enableCreateAnswerItemCommad()?"enabled":"disabled",fonticon:{content:"wux-ui-3ds wux-ui-3ds-plus"},action:{callback:function(){t.launchAnswerRequestWizard(t,e)}}},{type:"PushItem",title:t.NLS.approve,state:t.helper.enableApproveCommand(s.maturityState,s.modifyAccess)?"enabled":"disabled",fonticon:{content:"wux-ui-3ds wux-ui-3ds-thumbs-up"},action:{callback:function(){t.actionCallbackHandler(t,e,a,{commandNLS:t.NLS.approve,commandName:n.APPROVE})}}},{type:"PushItem",title:t.NLS.reject,state:s.maturityState!==n.STATE_IN_DRAFT&&s.maturityState!==n.STATE_COMPLETED&&"FALSE"!==s.isRequestAssignee?"enabled":"disabled",fonticon:{content:"wux-ui-3ds wux-ui-3ds-thumbs-down"},action:{callback:function(){t.actionCallbackHandler(t,e,a,{commandNLS:t.NLS.reject,commandName:n.REJECT})}}},{type:"PushItem",title:t.NLS.cancel,state:s.maturityState!==n.STATE_IN_DRAFT&&s.maturityState!==n.STATE_COMPLETED&&"FALSE"!==s.isOwner?"enabled":"disabled",fonticon:{content:"wux-ui-3ds wux-ui-3ds-block"},action:{callback:function(){t.actionCallbackHandler(t,e,a,{commandNLS:t.NLS.cancel,commandName:n.CANCEL})}}},{type:"PushItem",title:t.NLS.notify,state:t.helper.isDueDateExceeded(s.dueDate,s.isOwner)?"enabled":"disabled",fonticon:{content:"wux-ui-3ds wux-ui-3ds-bell"},action:{callback:function(){t.controller.notifyPastDueDate(a.options)}}},{type:"PushItem",title:t.NLS.delete,fonticon:{content:"wux-ui-3ds wux-ui-3ds-trash"},action:{callback:function(){e.contextualNode=[a],t.deleteComponentRequest(t,e)}}}],o=t.controller.helper.updateNeedForClarrificationListRMB(o,s,e,t,a))}return o};var s=new i;r.container=e.externalContainer?e.externalContainer:t.controller.app._triptychWrapper.getMainPanelContainer(),r.sort=[{id:"title",text:t.NLS.title,type:"string"}],r.applicationChannelEvents=[],r.applicationChannelEvents.push({eventName:"add-model"}),r.applicationChannel=t.controller.app._applicationChannel,r._mediator=e._mediator,r.getEmptyStatusbarVisibleFlag=function(){return!0},r.onPostCellRequest=function(e){return t.helper.setStatusbarStyle(e)},r.descriptionLinesNumber=1,r.displayedOptionalCellProperties=["All"],r.getSubLabel=this.helper.getSubLabel,r.getDescription=this.helper.getDescription,r.getStatusbarIcons=function(e){return t.helper.getStatusbarIcons(e)},r.app=e.app,r.getStatusbarIconsTooltips=function(e){return t.helper.getStatusbarIconsTooltips(e)},r.getCustomTooltip=this.helper.getCustomTooltip.bind(this.helper),s.init(r),t.xsourcingCollectionView=s,t.collectionView=s,s.collectionViewEvents.subscribe({event:"xsourcing-collectionview-cell-dblclick"},function(e){t.controller.closeTagger(),t.controller.app.router.navigate("home.ComponentRequestDetails",e)}),s.collectionViewEvents.subscribe({event:"dashboard-filter-applied"},function(e){t.filtersApplied=e.filtersApplied,t.chartData=e.chartData;let i=s._gridModel.getRoots();s._gridModel.prepareUpdate(),i.forEach(t=>{e.filteredData.map(e=>e.id).includes(t._options.grid.id)?t.show():t.hide()}),s._gridModel.pushUpdate(),s.collectionViewEvents.publish({event:"xsourcing-collectionview-update-count",data:e.filteredData.length})}),s.collectionViewEvents.subscribe({event:"xsourcing-collectionview-selection-updated"},function(e){if(e.selectedItems.length>0){s.collectionViewEvents.publish({event:"xsourcing-collectionview-enable-toolbar-button",data:"delete"}),s.collectionViewEvents.publish({event:"xsourcing-collectionview-enable-toolbar-button",data:"promote"}),t.enableCreateAnswerItemCommad()?s.collectionViewEvents.publish({event:"xsourcing-collectionview-enable-toolbar-button",data:"createAnswerRequest"}):s.collectionViewEvents.publish({event:"xsourcing-collectionview-disable-toolbar-button",data:"createAnswerRequest"});var i=event&&event.dsModel&&event.dsModel.activeNode?event.dsModel.activeNode:{options:e.selectedItems[e.selectedItems.length-1]};1===e.selectedItems.length?t.controller.app._applicationChannel.publish({event:"xsourcing-collectionview-selected-object-id",data:{selectedObject:i.options.grid,openDetails:function(){var e={};e.data={params:{id:i.options.grid.id}},e.detailsContainer=t.controller.app._triptychWrapper.getRightPanelContainer(),e.detailsContainer.empty&&e.detailsContainer.empty(),e._mediator=t.controller.app._mediator,e._triptychWrapper=t.controller.app._triptychWrapper,e.router=t.controller.app.router,e.applicationChannel=t.controller.app._applicationChannel,e.forInfo=!0,e.app=t.controller.app,e.platformServices=t.controller.app.platformServices,e.updateCRList=function(e){var t=s._gridModel.getAllDescendants().filter(t=>t._options.grid.id===e.grid.id);t&&1===t.length&&t[0].updateOptions(e)},t.controller.showDetails(e)}}}):t.controller.app._applicationChannel.publish({event:"xsourcing-collectionview-selected-object-id",data:{selectedObject:"multipleSelected"}})}else s.collectionViewEvents.publish({event:"xsourcing-collectionview-disable-toolbar-button",data:"delete"}),s.collectionViewEvents.publish({event:"xsourcing-collectionview-disable-toolbar-button",data:"promote"}),t.controller.app._applicationChannel.publish({event:"xsourcing-collectionview-unselected-object-id",data:{selectedObject:null}}),s.collectionViewEvents.publish({event:"xsourcing-collectionview-disable-toolbar-button",data:"createAnswerRequest"})}),e.dropArea=s._xsourcingCollectionViewUI.viewContainer,(new o).makeAreaDroppable(e)},s.prototype.deleteComponentRequest=function(e,t){e.xsourcingCollectionView._xsourcingCollectionViewUI.checkIfExceedsDeleteLimit(e.xsourcingCollectionView._gridModel.getSelectedNodes())||require(["DS/UIKIT/SuperModal"],function(i){if(t.selectedNodes=e.xsourcingCollectionView._gridModel.getSelectedNodes(),t.contextualNode&&(t.selectedNodes=t.contextualNode.slice()),t.contextualNode=void 0,0===t.selectedNodes.length)return widget.notificationUtil.showError(e.NLS.select_one_component_request_to_delete),!1;var o=new i({renderTo:widget.body,okButtonText:e.NLS.delete}),n=1===t.selectedNodes.length?t.selectedNodes[0].options.label:t.selectedNodes.length+" "+e.NLS.requests;o.confirm(e.NLS.delete_confirmation,e.NLS.delete+" - "+n,function(i){i&&(t.thatObj=e,e.controller.delete(t))})})},s.prototype.submitComponentRequest=function(e,t){require(["DS/UIKIT/SuperModal"],function(i){return t.selectedNodes=e.xsourcingCollectionView._gridModel.getSelectedNodes(),t.contextualNode&&(t.selectedNodes=t.contextualNode.slice()),t.contextualNode=void 0,1!==t.selectedNodes.length?(widget.notificationUtil.showError(e.NLS.select_one_component_request_to_promote),!1):"In Draft"!==t.selectedNodes[0].options.grid.maturityState?(widget.notificationUtil.showError(e.NLS.not_in_indraft_state),!1):void new i({renderTo:widget.body}).confirm(e.NLS.submit_confirmation,e.NLS.submit+"- "+t.selectedNodes[0].options.grid.title,function(i){i&&(t.submitId=t.selectedNodes[0].options.id,t.title=t.selectedNodes[0].options.grid.title,t.type=t.selectedNodes[0].options.grid.actualType,e.controller.submitComponent(t).then(function(i){e.xsourcingCollectionView._gridModel.prepareUpdate(),t.selectedNodes[0].options.subLabel=e.NLS[i.results[0].current.toLowerCase()],t.selectedNodes[0].setAttribute("maturityState",i.results[0].current),t.selectedNodes[0].setAttribute("maturityStateDisplay",e.NLS[i.results[0].current.toLowerCase()]),e.xsourcingCollectionView._gridModel.pushUpdate(),e.controller.taggerProxy.onCloseTagger(),e.controller.setDataForTagger(e.xsourcingCollectionView._data,e.xsourcingCollectionView),e.controller.app._applicationChannel.publish({event:"information-panel-reload-if-open"})}))})})},s.prototype.actionCallbackHandler=function(e,t,i,o){t.contextualNode=[i],e.controller.actionHandler(i.options,i.options.label,o.commandNLS,o.commandName).then(function(i){t.selectedNodes=e.xsourcingCollectionView._gridModel.getSelectedNodes(),t.contextualNode&&(t.selectedNodes=t.contextualNode.slice()),e.xsourcingCollectionView._gridModel.prepareUpdate(),t.selectedNodes[0].options.subLabel=i.data[0].stateDisplay,t.selectedNodes[0].setAttribute("maturityState",i.data[0].state),t.selectedNodes[0].setAttribute("maturityStateDisplay",i.data[0].stateDisplay),t.selectedNodes[0].setAttribute("statusAttributeDisplay",e.NLS[i.data[0].srcStatus]),e.xsourcingCollectionView._gridModel.pushUpdate(),e.controller.closeTagger(),e.controller.setDataForTagger(e.xsourcingCollectionView._data,e.xsourcingCollectionView),e.controller.app._applicationChannel.publish({event:"information-panel-reload-if-open"})})},s.prototype.addToolbarAction=function(e=[]){if(e.length>0){let t={id:"filterCR",text:e.filter(e=>!0===e.selected)[0].text,fonticon:"fonticon fonticon-list-filter",content:{type:"dropdownmenu",options:{items:e,responsiveMode:!0,multiSelect:!1}}};this.xsourcingCollectionView.collectionViewEvents.publish({event:"xsourcing-collectionview-toolbar-add-action-with-content",data:t})}},s.prototype.launchAnswerRequestWizard=function(e){let t=e.xsourcingCollectionView._gridModel.getSelectedNodes()[0]._options.id;e.controller.getDataAndLaunchAnswerItemCreatePage(t,{view:"responseView"})},s.prototype.enableCreateAnswerItemCommad=function(){let e=this,t=e.xsourcingCollectionView._gridModel.getSelectedNodes();if(!t)return!1;if(t&&1===t.length){let i=t[0];return i._options.grid.hasAnswerItems&&i._options.grid.hasAnswerItems.includes(n.COMPONENT_REQUEST)&&e.controller.helper.getRelatedItemsAllowedStates(i.getAttributeValue("actualType"),"input-items",i._options.grid).includes(i._options.grid.maturityState)}return!1},s.prototype.overrideToolbarSearchAction=function(e){let i=this,o=[],a=[];for(let e in i.controller.app.typesConfigurator)i.controller.app.typesConfigurator.hasOwnProperty(e)&&(i.controller.app.typesConfigurator[e]["input-items"]||i.controller.app.typesConfigurator[e]["answer-items"])&&(o.push(...i.controller.app.typesConfigurator[e]["input-items"].types),a.push(...i.controller.app.typesConfigurator[e]["answer-items"].types));let r={name:"hasInputItem",placeholder:i.NLS.find_by_input_item,typeSearch:o,searchInfields:[n.MANUFACTURER_PART_NUMBER_TAG,n.MANUFACTURER_TITLE_TAG]},s=i.getAutocompletefieldForSearchBar(r),l=s[0],c=s[1],d={name:"hasAnswerItem",placeholder:i.NLS.find_by_answer_item,typeSearch:a,searchInfields:[n.MANUFACTURER_PART_NUMBER_TAG,n.MANUFACTURER_TITLE_TAG]},u=i.getAutocompletefieldForSearchBar(d),p=u[0],m=u[1];e.toolbarSearchActionOverride=function(e){let o=this;if(l.style.display=p.style.display="none",o._actionsIconBar.getItem("enox-search").tooltip.getBody().innerText=i.NLS.search,c.autocompleteField.selectedItems||m.autocompleteField.selectedItems)return void(c.autocompleteField.selectedItems=m.autocompleteField.selectedItems=void 0);e.call(o),o._searchComponent.searchTextBox.elements.input.placeholder=i.NLS.search;let n=o._searchComponent._container,a=o._searchComponent._autocomplteWrapper.getBoundingClientRect();if("none"!==n.style.display){let e=[{id:"noCriteria",type:"CheckItem",title:i.NLS.search,state:"selected",action:{callback:function(){o._actionsIconBar.getItem("enox-search").tooltip.getBody().innerText=i.NLS.search,i.helper.visibilityToggler(n,[l,p])}}},{id:"inputItem",type:"PushItem",title:i.NLS.find_by_input_item,action:{callback:function(){o._actionsIconBar.getItem("enox-search").tooltip.getBody().innerText=i.NLS.find_by_input_item,l.inject(o._filterContainer),i.helper.resizeAutocomplete(l,c,o),i.helper.visibilityToggler(l,[n,p]),o._actionsIconBar.resize()}}},{id:"answerItem",type:"PushItem",title:i.NLS.find_by_answer_item,action:{callback:function(){o._actionsIconBar.getItem("enox-search").tooltip.getBody().innerText=i.NLS.find_by_answer_item,p.inject(o._filterContainer),i.helper.resizeAutocomplete(p,m,o),i.helper.visibilityToggler(p,[n,l]),o._actionsIconBar.resize()}}}];t.show(e,{position:{x:a.right,y:a.bottom}})}}},s.prototype.getAutocompletefieldForSearchBar=function(t){let i=this,o={name:t.name,placeholder:t.placeholder,typeSearch:t.typeSearch,sources:[n.SOURCE_3DSPACE,n.SOURCE_SOURCING],searchButtonNotRequired:!0,searchInfields:t.searchInfields,tenant:r.getPlatformId()},s=new a,l=s.createField(o);return s.autocompleteField.addEventListener("change",function(){let t={...i.options};s.getSelectedObjectAttrValue("resourceid")&&(t.relatedItemFilter=!0,t[s.getInputField().name]=s.getSelectedObjectAttrValue("resourceid")),i.controller.allCRData=[],i.collectionView._gridModel.removeRoots(),e.mask(widget.body,i.NLS.loading_requests),i.controller.list(t)}),window.searchAutocompletes&&window.searchAutocompletes.push(s),[l,s]},s}),define("DS/ENOXSourcingRequest/helpers/SourceHelper",["DS/ENOXSourcingUXInfra/Constants/ENOXSourcingConstants"],function(e){"use strict";var t=function(){};return t.prototype.getPropertyFields=function(t){var i=t.data,o=t.controller.sourceInfoHelper,n=t.controller.utility,a=[],r=t.documentData,s=t.controller.app.i18NProvider;n.sortArrayAlphabeticallyBasedOnProperty(i.children,"type"),a.push({type:"string",label:s.source_type,name:e.SRC_SOURCETYPE,disable:!0,nonEditable:!0,value:i.typeDisplay}),a.push({type:"string",label:s.ID,name:"ID",disable:!0,nonEditable:!0,value:i.name}),i.children.forEach(function(t){if(t.type===e.SRC_SUPPLIER_NAME||t.type===e.SRC_MANUFACTURER){let e=o.getPredefinedFormFields(t.type);e.type="search",e.value=t.value,a.push(e)}else if(t.type===e.SRC_PART_SOURCE_URL){let e=n.getDynamicPropertyField(t);e.type="hyperlinkWithTextField",e.callBack=function(){window.open(this.value)},a.push(e)}else a.push(n.getDynamicPropertyField(t))});let l=o.getPredefinedFormFields("attachment");return r[0]&&(l.value=r[0].title,l.identifier=r[0].id),a.push(l),a},t.prototype.processCreateValues=function(t){let i={data:[{type:t[e.SRC_SOURCETYPE],...t}]};return delete i.data[0][e.SRC_SOURCETYPE],i},t.prototype.processUpdateValues=function(t){let i={data:[{...t}]};return delete i.data[0][e.SRC_SOURCETYPE],delete i.data[0].ID,i.data[0].document_ID?(i.data[0].documents=[{id:i.data[0].document_ID,updateAction:"CONNECT"}],delete i.data[0].document_ID):(i.data[0].documents=[{updateAction:"DISCONNECT"}],delete i.data[0].document_ID),i},t.prototype.validateCreateSubmit=function(t){var i=t.form.getValues();return delete i[e.SRC_SOURCETYPE],delete i.document_ID,Object.values(i).some(e=>""!==e)},t.prototype.validatePropertiesSave=function(t){var i={};for(const e in t)if(t.hasOwnProperty(e)){let o=t[e];o.getValue?i[e]=o.getValue():o.value&&(i[e]=o.value)}return delete i[e.SRC_SOURCETYPE],delete i.document_ID,delete i.ID,Object.values(i).some(e=>""!==e)},t.prototype.processForDelete=function(e){let t={data:[]};return e.forEach(function(e){t.data.push({id:e})}),t},t.prototype.canModify=function(t){return e.SOURCE_EDITABLE_CR_STATES.includes(t.crState)?"TRUE":"FALSE"},t.prototype.getPropertyFieldsInputElements=function(e){var t=[];for(const i in e.fieldElements)if(e.fieldElements.hasOwnProperty(i)){let o=e.fieldElements[i];o.elements.input?t.push(o.elements.input):o.fieldController&&t.push(o.fieldController.getInputField())}return t},t}),define("DS/ENOXSourcingRequest/components/ApplicationTopBar/ApplicationTopBarWrapper",["DS/ENOXSourcingUXInfra/InformationPanel/InformationPanelUI"],function(e){"use strict";var t=function(){};return t.prototype.init=function(e,t,i){this._applicationChannel=e,this.triptych=t,this._subscribeToEvents(),this.NLS=i},t.prototype._subscribeToEvents=function(){var t=this,i="onorientationchange"in window?"orientationchange":"resize";window.addEventListener(i,function(){},!1),this._applicationChannel.subscribe({event:"welcome-panel-collapse"},function(){t._applicationChannel.publish({event:"triptych-set-size",data:{size:40,side:"left"}}),t._applicationChannel.publish({event:"triptych-show-panel",data:"left"})}),this._applicationChannel.subscribe({event:"welcome-panel-expand"},function(){t._applicationChannel.publish({event:"show-welcomepanel-icon"}),t._applicationChannel.publish({event:"triptych-set-size",data:{size:350,side:"left"}}),t._applicationChannel.publish({event:"triptych-show-panel",data:"left"})}),this._applicationChannel.subscribe({event:"welcome-panel-hide"},function(){t._applicationChannel.publish({event:"hide-welcomepanel-icon"}),t._applicationChannel.publish({event:"welcome-panel-collapse"}),t._applicationChannel.publish({event:"triptych-hide-panel",data:"left"}),t._applicationChannel.publish({event:"information-panel-close"})}),this._applicationChannel.subscribe({event:"information-panel-close"},function(){t._applicationChannel.publish({event:"triptych-hide-panel",data:"right"}),widget.getElement(".xCS-triptych-wrapper-right").innerHTML=""}),this._applicationChannel.subscribe({event:"information-panel-open"},function(){t._applicationChannel.publish({event:"triptych-show-panel",data:"right"}),t._applicationChannel.publish({event:"information-panel-visible",data:null}),t._applicationChannel.publish({event:"information-panel-add-content",data:t.selectedObject})}),this._applicationChannel.subscribe({event:"triptych-panel-hidden"},function(e){"right"===e&&(t._applicationChannel.publish({event:"information-panel-hidden",data:null}),widget.getElement(".xCS-triptych-wrapper-right").innerHTML="");var i=widget.getElement("#sourcinginfoicon");if(i){var o=i.getChildren()[0];o.className.contains("enox-collection-toolbar-filter-activated")&&o.removeClassName("enox-collection-toolbar-filter-activated")}var n=document.querySelector(".information-icon");null!==n&&n.className.contains("active")&&n.classList.remove("active"),t._applicationChannel.publish({event:"destroy-document-view"})}),this._applicationChannel.subscribe({event:"xsourcing-collectionview-selected-object-id"},function(e){e.selectedObject&&!e.fromInfoPanel&&(t.selectedObject=e,t.triptych._triptych._isRightOpen&&t._applicationChannel.publish({event:"information-panel-add-content",data:e}))}),this._applicationChannel.subscribe({event:"xsourcing-collectionview-unselected-object-id"},function(e){t.selectedObject=null,e.isDocumentView||t._applicationChannel.publish({event:"information-panel-add-content",data:t.selectedObject})}),this._applicationChannel.subscribe({event:"make-information-panel-disappear"},function(e){if(!e.forInfo){t._applicationChannel.publish({event:"information-panel-close"});var i=widget.getElement(".information-panel.panel-icon-wrapper");i&&(i.style.display="none")}}),this._applicationChannel.subscribe({event:"information-panel-add-content"},function(i){var o=widget.getElement(".xCS-triptych-wrapper-right");if(o.innerHTML="",i&&"multipleSelected"===i.selectedObject){let e=UWA.createElement("span",{styles:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%,-50%)"},text:t.NLS.select_only_one_item});o.appendChild(e)}else if(i&&i.openDetails)i.openDetails();else if(i&&i.selectedObject){new e(i.selectedObject).init(i.selectedObject)}else{let e=UWA.createElement("div",{styles:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%,-50%)"},text:t.NLS.no_valid_item_selected});o.appendChild(e)}}),this._applicationChannel.subscribe({event:"information-panel-reload-if-open"},function(){t._applicationChannel.publish({event:"triptych-fetch-panel-visibility-status",data:{side:"right",cbFunc:e=>{e&&t._applicationChannel.publish({event:"information-panel-open"})}}})})},t}),define("DS/ENOXSourcingRequest/views/Source/CreateSource",["DS/UIKIT/Mask","DS/ENOXSourcingUXInfra/components/ModalWindowWrapper/ModalWindowWrapper","DS/UIKIT/Scroller"],function(e,t,i){"use strict";var o=[],n=function(e){this.controller=e.controller,this.options=e.options,this.sourceFormDiv=e.formContainer,this.setupSubscribers(),this.NLS=this.controller.NLS};return n.prototype.render=function(e){var n=this;n.createForm=e.form;var a=n.getButtonsHolder();let r=new t({app:{widget:widget},draggable:!0,resizable:!0,escapeToClose:!0,onHideCB:()=>{n.modal.destroy(),o.forEach(e=>n.controller.app._applicationChannel.unsubscribe(e))},height:"480px",classNames:"create-npr-details-modal"});n.modal=r.getModal(),n.modal.show(),n.modal.setHeader(n.NLS.add_new_source),n.sourceFormDiv.inject(n.modal.getBody()),a.inject(n.modal.getFooter()),new i({element:n.sourceFormDiv}).inject(n.modal.getBody()),widget.getElement(".xSourcingForm").setAttribute("id","myForm")},n.prototype.onSubmit=function(){var t=this;if(t.controller.helper.validateCreateSubmit({form:t.createForm})){let i=t.createForm.getValues();t.createForm.options.fields.forEach(e=>{"date"===e.type&&""!==i[e.name]&&(i[e.name]=new Date(t.createForm.getDateInput(e.name).getDate().getTime()).toDateString())}),e.mask(t.modal.elements.content,t.NLS.adding_source),t.controller.app._utility.disableOrEnableButton(!0);let o={modelEvent:t.options.modelEvent,modal:t.modal,formValues:i,crID:t.options.crID};o.formValues.document_ID&&(o.formValues.document_ID=t.createForm.getField("document_ID").getAttribute("identifier")),t.controller.create(o)}else widget.notificationUtil.showError(t.NLS.atleast_one_field_to_be_filled)},n.prototype.getButtonsHolder=function(){var e=this,t=UWA.createElement("span",{id:"modalButtons",class:"modal-buttons"});return UWA.createElement("button",{type:"submit",name:"create",id:"createBtn",class:"btn btn-primary",text:e.NLS.add,value:e.NLS.add,events:{click:function(){e.createForm.submit()}}}).inject(t),UWA.createElement("button",{type:"reset",id:"closeModalBtn",class:"btn btn-default",text:e.NLS.cancel,value:e.NLS.cancel,events:{click:function(){e.modal.destroy()}}}).inject(t),t},n.prototype.setupSubscribers=function(){var t=this,n=t.controller.app._applicationChannel;o.forEach(e=>n.unsubscribe(e)),o.push(n.subscribe({event:"source-type-form-changed"},function(o){e.mask(o.formDiv),t.createForm=o.formInstance,t.scroller&&(t.scroller.destroy(),o.formDiv.innerHTML="",o.formInstance.inject(o.formDiv),t.scroller=new i({element:o.formDiv}).inject(t.modal.getBody()),e.unmask(o.formDiv))}))},n}),define("DS/ENOXSourcingRequest/views/DocumentView/DocumentView",["UWA/Core","UWA/Class/View","DS/UIKIT/Mask","DS/ENOXSourcingUXInfra/xsourcingCollectionView/xsourcingCollectionView","WebappsUtils/WebappsUtils","DS/DocumentManagement/DocumentManagement","DS/Utilities/Dom","DS/ENOXSourcingUXInfra/Search/ENOXSourcingSearch","DS/ENOXSourcingUXInfra/service/ENOXSourcingPlatformServices","DS/UIKIT/SuperModal","DS/ENOXSourcingUXInfra/service/ENOXSourcingService","DS/Controls/DatePicker","DS/ENOXSourcingUXInfra/Constants/ENOXSourcingConstants","DS/ENOXSourcingUXInfra/openwithservice/ENOXSourcingOpenWithService","DS/ENOXSourcingUXInfra/Search/SearchUtility","DS/ENOXSourcingUXInfra/components/ModalWindowWrapper/ModalWindowWrapper","css!DS/ENOXSourcingUXInfra/DocumentView/DocumentView.css","css!DS/UIKIT/UIKIT.css"],function(e,t,i,o,n,a,r,s,l,c,d,u,p,m,f,h){"use strict";var g={};return t.extend({name:"document-view",tagName:"div",domEvents:{},init:function(e){this.model=e.model,this.NLS=this.model.get("i18NProvider"),this.modelEvent=this.model.get("modelEvent"),this.searchUtil=new f,["container","template","tagName","domEvents"].forEach(function(t){delete e[t]}),this._parent(this,e),(g=this).app={},widget&&widget.app&&widget.app.jobs&&"doco-jobs"===widget.app.jobs.name&&widget.app.progressPane&&"doco-progress"===widget.app.progressPane.name?(g.app=widget.app,g.app.jobs.MAX_PARALLEL_JOBS=1):(void 0===this.app.jobs&&require(["DS/DocumentCommands/Jobs"],function(e){void 0===g.app.jobs&&(g.app.jobs=new e(g.app),g.app.jobs.MAX_PARALLEL_JOBS=1)}),void 0===g.app.progressPane&&require(["DS/DocumentCommands/ProgressPane"],function(e){void 0===g.app.progressPane&&(g.app.progressPane=new e(g.app),g.app.progressPane.inject(widget.body))}))},setup:function(){this.container.addClassName(this.getClassNames("-container"))},update:function(){var e=this.outerDiv.parentElement.parentElement.getBoundingClientRect();this.outerDiv.style.height=e.height+"px"},render:function(){var t=this;this.container.empty(),this.outerDiv=e.createElement("div",{class:"outerDiv",styles:{height:"500px"}}).inject(this.container),i.mask(this.container,t.NLS.loading_document);var n={data:[]};return t.model.get("contextObject")&&t.loadData(),n._mediator=t.model.get("mediator"),n.showToolbar=!0,n.enableDrag=!0,n.uniqueIdentifier="DocumentView",n.toolbarActions=[{id:"addDocument",fonticon:"plus",text:t.NLS.add,content:t.pupulateToolbarMenus()},{id:"downloadDocument",text:t.NLS.downLoad,disabled:!0,fonticon:"download",handler:function(){let e=t.tableView._gridModel.getSelectedNodes();i.mask(widget.body,t.NLS.downloading_document),t.downloadDocument(e.map(e=>e.options.grid.actualId)).then(function(){i.unmask(widget.body)})}},{id:"deleteDocument",text:t.NLS.remove,disabled:!0,fonticon:"remove",handler:function(){let e=t.tableView._gridModel.getSelectedNodes();var i=new c({renderTo:widget.body,okButtonText:t.NLS.remove}),o=1===e.length?e[0].options.label:e.length+" "+t.NLS.documents_small;i.confirm(t.NLS.remove_confirmation,t.NLS.remove+" - "+o,function(i){i&&e.forEach(function(e){e&&t.detachDocument(e._options.grid)})})}}],l.getPlatformId()===p.ONPREMISE&&n.toolbarActions.push({id:"deleteDocumentFromDB",text:t.NLS.delete,disabled:!0,fonticon:"trash",handler:function(){var e=t.tableView._gridModel.getSelectedNodes(),o=new c({renderTo:widget.body,okButtonText:t.NLS.delete}),n=1===e.length?e[0].options.label:e.length+" "+t.NLS.documents_small;o.confirm(t.NLS.delete_confirmation,t.NLS.delete+" - "+n,function(o){o&&e.forEach(function(e){t.deleteDocument({id:e.options.grid.actualId,source:e.options.grid.source,service:e.options.grid.service}).then(function(){var e={sticky:!1,allowUnsafeHTML:!1,subtitle:"",level:"success",title:t.NLS.document_deleted_successfully};window.notifs.addNotif(e),t.loadData(),i.unmask(widget.body)})})})}}),n.columnsConfigurations=[{text:t.NLS.title,dataIndex:"tree",resizableFlag:!0,sortableFlag:!0,pinned:"left",width:150},{text:t.NLS.revision,dataIndex:"revision"},{text:t.NLS.maturity_state,dataIndex:"maturityState",minWidth:125},{text:t.NLS.source,dataIndex:"documentSource",minWidth:125},{text:t.NLS.responsible,dataIndex:"owner",minWidth:125},{text:t.NLS.description,dataIndex:"description"},{text:t.NLS.is_specification,dataIndex:"isSpecification",visibleFlag:t.model.get("isSpecification")&&t.model.get("isSpecification"),minWidth:150},{text:t.NLS.name,dataIndex:"name"},{text:t.NLS.creation_date,dataIndex:"created",typeRepresentation:"datetime",minWidth:150},{text:t.NLS.modified_date,dataIndex:"modified",typeRepresentation:"datetime",minWidth:150}],n.views=["Grid","Tile","Thumbnail"],n.onContextualEventCallback=function(e){var i=[];if(e){var o=e.cellInfos&&e.cellInfos.nodeModel?e.cellInfos.nodeModel:null;if(-1===(e.cellInfos?e.cellInfos.rowID:null)||!o)return this._contextualMenuBuilder?this._contextualMenuBuilder.buildMenu(e,n):[];var a=e.cellInfos.nodeModel?e.cellInfos.nodeModel:e.cellInfos.cellModel;if(a)return m.getOpenWithMenu(a).then(function(e){return i.push({id:"OpenWith",type:"PushItem",title:t.NLS.open_with,icon:"open-menu-dot",submenu:e},{id:"preview",type:"PushItem",title:t.NLS.preview,icon:"eye",action:{callback:function(){t._selectedRow=a._options.grid,t.launchPreview()}}}),t.getDefaultContexualMenu(i,a),i},function(){return t.getDefaultContexualMenu(i,a),i}).catch(function(){})}else e.cellCtxMenuRequired;return i},n.displayedOptionalCellProperties=["contextualMenu","subtitle"],t.tableView=new o,n.container=t.outerDiv,n.rowSelection="multiple",n.sort=[{id:"title",text:t.NLS.title,type:"string"}],n.descriptionLinesNumber=1,t.tableView.init(n),t.multidocdownloaderFrame=e.createElement("iframe",{name:"multidocdownloaderFrame",styles:{display:"none"}}),n.dropStrategy="CREATE",n.multiObjs=!0,n.onDropCallback=function(e){e[0]instanceof File?t.externalFilesHanlder(e):t.addDroppedObj(e)},n.dropArea=t.tableView._xsourcingCollectionViewUI.viewContainer,require(["DS/ENOXSourcingUXInfra/DragAndDrop/ENOXSourcingDataDragAndDrop"],function(e){(new e).makeAreaDroppable(n)}),t.multidocdownloaderForm=e.createElement("form",{method:"POST",enctype:"application/x-www-form-urlencoded",target:"multidocdownloaderFrame",html:[{tag:"input",value:"true",name:"attachment"}],styles:{display:"none"}}),t.tableView.collectionViewEvents.subscribe({event:"xsourcing-collectionview-selection-updated"},function(e){if(e.selectedItems.length>0){t.tableView.collectionViewEvents.publish({event:"xsourcing-collectionview-enable-toolbar-button",data:"deleteDocument"}),t.tableView.collectionViewEvents.publish({event:"xsourcing-collectionview-enable-toolbar-button",data:"downloadDocument"}),t.tableView.collectionViewEvents.publish({event:"xsourcing-collectionview-enable-toolbar-button",data:"deleteDocumentFromDB"});var i=t.getDocumentInfoData(event&&event.dsModel&&event.dsModel.activeNode?event.dsModel.activeNode:{options:e.selectedItems[e.selectedItems.length-1]});i.triptychWrapper=t.model.get("triptychWrapper"),i.mediator=t.model.get("mediator"),1===e.selectedItems.length?t.model.get("applicationChannel").publish({event:"xsourcing-collectionview-selected-object-id",data:{selectedObject:i,fromInfoPanel:t.model.get("fromInfoPanel")}}):t.model.get("applicationChannel").publish({event:"xsourcing-collectionview-selected-object-id",data:{selectedObject:"multipleSelected",fromInfoPanel:t.model.get("fromInfoPanel")}})}else t.tableView.collectionViewEvents.publish({event:"xsourcing-collectionview-disable-toolbar-button",data:"deleteDocument"}),t.tableView.collectionViewEvents.publish({event:"xsourcing-collectionview-disable-toolbar-button",data:"downloadDocument"}),t.tableView.collectionViewEvents.publish({event:"xsourcing-collectionview-disable-toolbar-button",data:"deleteDocumentFromDB"}),t.model.get("applicationChannel").publish({event:"xsourcing-collectionview-unselected-object-id",data:{selectedObject:null,isDocumentView:!0}})}),t.model.get("applicationChannel").subscribe({event:"destroy-document-view"},function(){t.onDestroy()}),t.modelEvent.subscribe({event:"add-model"},function(){t.loadData(),i.unmask(widget.body)}),r.addResizeListener(this.outerDiv,function(){t.update()},0),this.container},getDownloader:function(){return this.multidocdownloaderFrame.isInjected()||this.multidocdownloaderFrame.inject(document.body),this.multidocdownloaderForm.isInjected()||this.multidocdownloaderForm.inject(document.body),this.multidocdownloaderForm.empty(),e.createElement("input",{name:"attachment",value:"true"}).inject(this.multidocdownloaderForm),this.multidocdownloaderForm},onDestroy:function(){return this.canvas&&delete this.canvas,this._parent.apply(this,arguments)},launchFileChooser:function(e,t){var i=this.getFileInput(t);i.addEventListener("change",function(t){t.preventDefault(),t.stopImmediatePropagation();var o=t.target.files.length>0?t.target.files:t.dataTransfer.files;i.removeEvent("change"),i.destroy(),e&&e(o)}),i.click()},getFileInput:function(t){var i=e.extendElement(widget.body).getElement("#fileExplorer");return i||(i=new e.createElement("input",{id:"fileExplorer",multiple:t?void 0:"multiple",type:"file",styles:{display:"none"}}).inject(widget.body),this.isTouchDevice()&&(i.accept="image/*;capture=camera")),i.removeEvents(),i},isTouchDevice:function(){return"ontouchstart"in document.documentElement},createDocument:function(e){var t=this,i="",o=d.getSecurityContext();return p.ONPREMISE!==l.getPlatformId()&&(i=l.getServiceURL(p.SOURCE_SOURCING),o=d.getSecurityContext(p.SOURCE_SOURCING),e.policy="SRC_Document"),new Promise(function(n,r){var s={sticky:!1,allowUnsafeHTML:!1,subtitle:""},c={tenant:l.getPlatformId(),securityContext:t.model.get("securityContext")?t.model.get("securityContext"):o,additionalHeaders:{},tenantUrl:i,onFailure:function(e){r(e),g.app.jobs.finishJob(u,"failed"),s={level:"error",title:t.NLS.upload_failed,subtitle:e.internalError?e.internalError:e.error?e.error:e},window.notifs.addNotif(s)},onProgress:function(e){u.update&&u.update(e)},onComplete:function(e){g.app.jobs.finishJob(u),e=e.data,n(e)}},d=e.title;e.fileInfo&&(d=e.fileInfo.file.name);var u={title:d,ui:!!e.fileInfo,process:function(){u.xhr=a.createDocument(e,c)}};g.app.jobs.addJob(u)})},processForDocumentWithKeys:function(e,t){var i=this,o=[],n=[],a=t;return i.isInDraft=!1,e&&e.data[0]&&"In Draft"===e.data[0].state&&(i.isInDraft=!0),new Promise(t=>{if(a.forEach(function(t){e&&e.data[0]&&e.data[0][t]&&e.data[0][t].forEach(function(e){n.push(e.Proxy_Id?e.Proxy_Id:e.physicalid)})}),n.length>0){var r={"ds6w:status":[]},s=i.model.get("helper").getSearchPayload(n,"Document");p.ONPREMISE!==l.getPlatformId()&&s.source.push(p.SOURCE_SOURCING),d.getFederatedSearchDataPromise({searchPayLoad:s}).then(function(n){a.forEach(function(t){e&&e.data[0]&&e.data[0][t]&&e.data[0][t].forEach(function(e){var a=i.model.get("helper").getActualDataFromSearch(n,e.Proxy_Id?e.Proxy_Id:e.physicalid),s=p.SERVICE_3DSPACE,c=p.SERVICE_3DSPACE;a.sourceid?s=a.sourceid.substr(0,a.sourceid.indexOf(":")):p.ONPREMISE!==l.getPlatformId()&&(s=p.SOURCE_SOURCING,c=p.SOURCE_SOURCING+":"+l.getPlatformId());var d=e.documentSource,u={actualType:p.DOCUMENT,title:a["ds6w:label"]?a["ds6w:label"]:e.title,tree:a["ds6w:label"]?a["ds6w:label"]:e.title,name:a.name?a.name:e.Name,description:a["ds6w:description"]?a["ds6w:description"]:e.description,id:e.physicalid,revision:a["ds6wg:revision"]?a["ds6wg:revision"]:e.revision,maturityState:a["ds6w:what/ds6w:status"]?a["ds6w:what/ds6w:status"]:e.stateDisplay,modified:a["ds6w:when/ds6w:modified"]?a["ds6w:when/ds6w:modified"]:e.modified,created:a["ds6w:when/ds6w:created"]?a["ds6w:when/ds6w:created"]:e.originated,owner:a["ds6w:who/ds6w:responsible"]?a["ds6w:who/ds6w:responsible"]:e.Owner,modifyAccess:e.modifyAccess,type:a["ds6w:what/ds6w:type"]?a["ds6w:what/ds6w:type"]:e.type,deleteAccess:e.deleteAccess,image:a.preview_url?a.preview_url:"ENOXSourcingUXInfra/assets/icons/32/I_CDM_Document108x144.png",isSpecification:"specification-document"===t?i.NLS.true:i.NLS.false,source:a.sourceid?a.sourceid:c,service:s===p.SOURCE_3DSPACE?p.SERVICE_3DSPACE:s,actualId:a.physicalid?a.physicalid:e.id,documentSource:d};r["ds6w:status"].push(u.maturityState);var m=[{label:i.NLS.title,data:u.title},{label:i.NLS.maturity_state,data:u.maturityState}];d&&m.push({label:i.NLS.source,data:d});var f={grid:u,label:u.title,tooltip:m,subLabel:u.maturityState,thumbnail:require.toUrl(u.image),description:u.documentSource?u.documentSource:u.description};"specification-document"===t&&(i.specificationExists=!0),o.push(f)})}),r["ds6w:status"]=[...new Set(r["ds6w:status"])],i.searchUtil.getNlsOfPropertiesValues(r).then(function(e){o.forEach(t=>{t.grid.maturityState=e["ds6w:status"][t.grid.maturityState]?e["ds6w:status"][t.grid.maturityState]:t.grid.maturityState,t.subLabel=e["ds6w:status"][t.subLabel]?e["ds6w:status"][t.subLabel]:t.subLabel,t.tooltip.forEach(t=>{t.data=e["ds6w:status"][t.data]?e["ds6w:status"][t.data]:t.data})})}).finally(function(){t(o)})})}else t(o)})},launchA3DSearch:function(e,t,i){var o=this,n={typeSearch:p.DOCUMENT,excludeCondition:p.EXCLUDE_OBSOLETE,multiSel:i,callbackMethod:function(i){o.model.get("processForObject")&&i.map(function(i){i.purpose=e,i.source=t,o.model.get("processForObject")(i)})}};(new s).init(n)},downloadDocument:function(t){var o=this;return new Promise(function(n,r){var s=l.getServiceURL(p.SERVICE_3DSPACE),c=d.getSecurityContext(),u={sticky:!1,allowUnsafeHTML:!1,subtitle:""};let m=`${o.model.get("parentOptions").data.respParams.title} (${o.model.get("parentOptions").data.respParams.revision}).zip`;var f={asZip:!0,autoDownload:!0,additionalURLParams:1===t.length?"useDOCMParamSettings=true":`useDOCMParamSettings=true&zipName=${m}`,tenant:l.getPlatformId(),securityContext:c,additionalHeaders:{},tenantUrl:s,onFailure:function(e){u={level:"error",title:o.NLS.download_failed,subtitle:o.processErrorMessage(e)},window.notifs.addNotif(u),i.unmask(widget.body),r(e)},onProgress:function(){i.mask(widget.body,o.NLS.downloading_document)},onComplete:function(t){e.is(t,"array")?t.forEach(function(t){if(t.downloadUrl){var i=new URL(t.downloadUrl),n=o.getDownloader();for(var a of i.searchParams)e.createElement("input",{name:a[0],value:a[1]}).inject(n);i.search="",n.action=i.href,n.submit(),u={level:"info",title:o.NLS.download_has_started}}else u={level:"error",title:o.NLS.download_not_initiated};window.notifs.addNotif(u)}):(u={level:"info",title:o.NLS.download_initiated},window.notifs.addNotif(u)),i.unmask(widget.body),n(t)}};1===t.length?a.downloadDocument(t[0],void 0,!1,f):a.downloadDocuments(t,f)})},processErrorMessage:function(e){var t="Operation failed";return e.internalError?t=e.internalError:e.error?t=e.error:e.data&&e.data.length>0&&(t=e.data[0].updateMessage),t},loadData:function(e){var t=this,o=t.model.get("contextObject");void 0!==e&&(t.model.get("options").includeParams="$include=interface-details,request-template,request-assignee,object-route,context-project,context-product,context-plant,specification-document,reference-document,context-user"),i.mask(t.container,t.NLS.loading),o.getComponentRequest(t.model.get("options")).then(function(o){void 0!==e&&t.model.get("openCREvent").publish({event:"update-id-card-cr",data:o}),t.processForDocumentWithKeys(o,t.model.get("documentKey")).then(function(e){t.tableView._setData(e),t.tableView._xsourcingCollectionViewUI._allData=e,i.unmask(t.container)})}).catch(function(e){widget.app.logger.error(e)})},deleteDocument:function(e){var t=this;return new Promise(function(o,n){var r=l.getServiceURL(p.SERVICE_3DSPACE),s=d.getSecurityContext();p.ONPREMISE!==l.getPlatformId()&&(r=l.getServiceURL(e.service),s=d.getSecurityContext(e.service));var c={sticky:!1,allowUnsafeHTML:!1,subtitle:""},u={tenant:l.getPlatformId(),securityContext:s,additionalHeaders:{},tenantUrl:r,onFailure:function(e){c={level:"error",title:t.NLS.deletion_failed,subtitle:t.processErrorMessage(e)},window.notifs.addNotif(c),i.unmask(widget.body),n(e)},onProgress:function(){i.mask(widget.body,t.NLS.deleting_document)},onComplete:function(e){e=e.data,o(e)}};a.deleteDocument(e.id,u)})},detachDocument:function(e){var t=this,o=t.model.get("contextObject"),n={sticky:!1,allowUnsafeHTML:!1,subtitle:""};if(o.detachDocument){var a=t.model.get("parentOptions");a.data.params.documentId=e.id,o.detachDocument(a).then(function(){e.isSpecification===t.NLS.true&&delete t.specificationExists,t.loadData("publishOpenCREvent"),n={level:"success",title:t.NLS.document_removed_successfully},window.notifs.addNotif(n),i.unmask(widget.body)},function(e){n={level:"error",title:t.NLS.remove_failed,subtitle:e.internalError?e.internalError:e.error?e.error:e},window.notifs.addNotif(n),i.unmask(widget.body)})}i.unmask(widget.body)},validateUploadFile:function(e){if(!["php5","pht","phtml","shtml","asa","cer","asax","swf","xap"].includes(e.split(".")[1].toLowerCase()))return!0;let t={sticky:!1,allowUnsafeHTML:!1,subtitle:"",level:"error",title:e.split(".")[1]+" "+this.NLS.file_extension_invalid};return window.notifs.addNotif(t),i.unmask(widget.body),!1},externalFilesHanlder:function(e,t,i){var o=this;if(e)for(var n=0;n<e.length;n++){const r=e[n];if(o.validateUploadFile(r.name)){var a={title:r.name||"unNamed",fileInfo:{comments:"",file:r}};o.createDocument(a).then(function(e){e[0].purpose=t||"",e[0].source=i||"",o.model.get("processForObject")&&o.model.get("processForObject")(e[0])})}}},toolbarCommandsCallback:function(e,t){var o=this,n="",a=!1,r=!1,s=!0,l="",c={sticky:!1,allowUnsafeHTML:!1,subtitle:"",level:"info",title:o.NLS.specification_document_already_exists};if(o.isInDraft&&(l="Input"),"UploadSpecification"===t.id){if(n="specification",a=!0,o.specificationExists)return window.notifs.addNotif(c),void i.unmask(widget.body)}else if("UploadReference"===t.id)n="reference",a=!0;else if("AddExisitingReference"===t.id)n="reference",r=!0;else if("AddExisitingSpecification"===t.id&&(n="specification",r=!0,s=!1,o.specificationExists))return window.notifs.addNotif(c),void i.unmask(widget.body);a&&o.launchFileChooser(e=>o.externalFilesHanlder(e,n,l)),r&&o.launchA3DSearch(n,l,s)},addDroppedObj:function(e){let t=this,i=[];e.map(e=>{e.sourceid=`${e.serviceId}:${e.envId}`,e.id=e.objectId,e["ds6w:label"]=e.displayName,e.type=e.objectType});let o=[];e.forEach(e=>{const n=new Promise(o=>{t.model.get("controller").gettypeshierarchy([e.type]).then(function(n){let a=n.types_hierarchies[0].hierarchy,r=[p.DOCUMENT],s=t.model.get("controller").helper.getTypeFromTypeHierarchy(a,e.type,r);r.includes(s)&&i.push(e),o()}).catch(function(){let e={sticky:!1,allowUnsafeHTML:!1,subtitle:"",level:"error",title:t.NLS.internal_server_error};window.notifs.addNotif(e)})});o.push(n)}),Promise.all(o).then(function(){i.length>0&&i.map(function(e){t.model.get("processForObject")&&t.model.get("processForObject")(e)});let o={sticky:!1,allowUnsafeHTML:!1,subtitle:"",level:"error",title:t.NLS.invalid_object_dropped};i.length!==e.length&&window.notifs.addNotif(o)})},getDocumentInfoData:function(e){var t=new u({timePickerFlag:!0,type:"datetime",value:new Date(e.options.grid.modified)}),i=new u({timePickerFlag:!0,type:"datetime",value:new Date(e.options.grid.created)});return{fields:[{disable:!0,label:this.NLS.type,placeholder:this.NLS.type,type:"labelValue",icon:e.options.thumbnail,value:this.NLS.document},{disable:!0,label:this.NLS.name,placeholder:this.NLS.name,type:"labelValue",value:e.options.grid.name},{disable:!0,label:this.NLS.description,placeholder:this.NLS.description,type:"labelValue",value:e.options.grid.description},{disable:!0,label:this.NLS.revision,placeholder:this.NLS.revision,type:"labelValue",value:e.options.grid.revision},{disable:!0,label:this.NLS.title,placeholder:this.NLS.title,type:"labelValue",value:e.options.grid.title},{disable:!0,label:this.NLS.owner,placeholder:this.NLS.owner,type:"labelValue",value:e.options.grid.owner},{disable:!0,label:this.NLS.created,placeholder:this.NLS.created,type:"labelValue",value:i.elements.inputField.value},{disable:!0,label:this.NLS.modified,placeholder:this.NLS.modified,type:"labelValue",value:t.elements.inputField.value}],objectData:{attributes:[{name:this.NLS.name,value:e.options.grid.title},{name:this.NLS.created,value:i.elements.inputField.value},{name:this.NLS.owner,value:e.options.grid.owner}],image:e.options.grid.image,name:e.options.grid.title,thumbnail:e.options.thumbnail}}},pupulateToolbarMenus:function(){var e=this,t=[];return e.model.get("isSpecification")&&e.model.get("isSpecification")&&t.push({text:e.NLS.document_as_specification,className:"header"},{id:"UploadSpecification",text:e.NLS.upload,icon:n.getWebappsAssetUrl("ENOXSourcingUXInfra","icons/32/AddDocument-22.png"),className:"OnPremise"===l.getPlatformId()?"":"cloudDisable",handler:function(t,i){e.toolbarCommandsCallback(t,i)}},{id:"AddExisitingSpecification",text:e.NLS.add_existing,icon:n.getWebappsAssetUrl("ENOXSourcingUXInfra","icons/32/I_CatalogAddPLMItemCBPRef.png"),handler:function(t,i){e.toolbarCommandsCallback(t,i)}}),t.push({text:e.NLS.document_as_reference,className:"header"},{id:"UploadReference",text:e.NLS.upload,icon:n.getWebappsAssetUrl("ENOXSourcingUXInfra","icons/32/AddDocument-22.png"),className:"OnPremise"===l.getPlatformId()?"":"cloudDisable",handler:function(t,i){e.toolbarCommandsCallback(t,i)}},{id:"AddExisitingReference",text:e.NLS.add_existing,icon:n.getWebappsAssetUrl("ENOXSourcingUXInfra","icons/32/I_CatalogAddPLMItemCBPRef.png"),handler:function(t,i){e.toolbarCommandsCallback(t,i)}}),t},getDefaultContexualMenu:function(e,t){var o=this,n=t.options.grid;e.push({id:"download",type:"PushItem",title:o.NLS.downLoad,icon:"download",action:{callback:function(){var e=n;i.mask(widget.body,o.NLS.downloading_document),o.downloadDocument([e.actualId]).then(function(){i.unmask(widget.body)})}}}),e.push({type:"SeparatorItem"}),e.push({id:"remove",type:"PushItem",title:o.NLS.remove,icon:"remove",action:{callback:function(){let e=t.options.grid;window.odtData&&(window.odtData=t,window.odtRef=o),new c({renderTo:widget.body,okButtonText:o.NLS.remove}).confirm(o.NLS.remove_confirmation,o.NLS.remove+" - "+e.title,function(t){t&&o.detachDocument(e)})}}}),"TRUE"===n.deleteAccess&&"OnPremise"===l.getPlatformId()&&e.push({id:"delete",type:"PushItem",title:o.NLS.delete,icon:"trash",action:{callback:function(){let e=t.options.grid;var a=n;window.odtData&&(window.odtData=t,window.odtRef=o),new c({renderTo:widget.body,okButtonText:o.NLS.delete}).confirm(o.NLS.delete_confirmation,o.NLS.delete+" - "+e.title,function(e){e&&o.deleteDocument({id:a.actualId,source:a.source,service:a.service}).then(function(){var e={sticky:!1,allowUnsafeHTML:!1,subtitle:"",level:"success",title:o.NLS.document_deleted_successfully};window.notifs.addNotif(e),o.loadData(),i.unmask(widget.body)})})}}}),e.push({type:"SeparatorItem"})},launchPreview:function(){let t=new h({app:{widget:widget},width:"98%",draggable:!0,resizable:!0,escapeToClose:!0,onHideCB:()=>t.destroy(),classNames:"document-preview-modal"}).getModal();t.show();let i=this._selectedRow&&this._selectedRow.title?this._selectedRow.title:this.NLS.preview;t.setHeader(i),this.canvas=e.createElement("div",{class:"viewer-canvas"}),this.canvas.inject(t.getBody());let o={asset:{provider:"EV6",dtype:p.DOCUMENTS,serverurl:l.getServiceURL(p.SERVICE_3DSPACE),tenant:l.getPlatformId(),contextId:d.getSecurityContext()},physicalId:this._selectedRow?this._selectedRow.actualId:"",renderTo:this.canvas,docId:this._selectedRow?this._selectedRow.actualId:""};o.asset.physicalid=o.physicalId,o.renderTo.empty(),o.renderTo.setAttribute("fileName",o.fileName);let a={input:{asset:o.asset},options:{loading:"autoplay"}},r=e.createElement("iframe").inject(o.renderTo);r.style.position="absolute",r.style.width="100%",r.style.height="100%",r.style.border="0px",r.style.top="30px",r.style.left="0px",r.allowFullScreen=r.mozAllowFullScreen=r.webkitAllowFullScreen=!0,r.setAttribute("allowFullScreen",""),r.addEventListener("load",function(e){try{e.target.contentDocument.getElementById("canvas-div").style.backgroundColor="white"}catch(e){let t={sticky:!1,allowUnsafeHTML:!1,level:"error",title:e,subtitle:""};window.notiflddNotif(t)}});let s=n.getProxifiedWebappsBaseUrl();s||(s=n.getWebappsBaseUrl()),r.src=s+"/3DPlayHelper/3DPlaySyndication.html?params="+encodeURI(JSON.stringify(a))}})}),define("DS/ENOXSourcingRequest/components/Triptych/TriptychWrapper",["DS/ENOXTriptych/js/ENOXTriptych","css!DS/ENOXSourcingRequest/components/Triptych/TriptychWrapper.css"],function(e){"use strict";var t=function(){};return t.prototype.init=function(t,i){this._left=UWA.createElement("div"),this._left.classList.add("xCS-triptych-wrapper-left"),this._main=UWA.createElement("div"),this._main.classList.add("xCS-triptych-wrapper-middle"),this._right=UWA.createElement("div"),this._right.classList.add("xCS-triptych-wrapper-right"),this._applicationChannel=t,this._triptych=new e;var o={left:{resizable:!1,originalSize:350,originalState:widget.body.offsetWidth<550?"close":"open",overMobile:!0},right:{resizable:!0,originalSize:450,originalState:"close",withClose:!0,overMobile:!0,minWidth:406},borderRight:!0,borderLeft:!0,container:i,withtransition:!0,modelEvents:this._applicationChannel};this._triptych.init(o,this._left,this._main,this._right)},t.prototype.inject=function(e){this._triptych.inject(e)},t.prototype._getTriptych=function(){return this._triptych},t.prototype.getLeftPanelContainer=function(){return this._left},t.prototype.getRightPanelContainer=function(){return this._right},t.prototype.getMainPanelContainer=function(){return this._main},t}),define("DS/ENOXSourcingRequest/helpers/DashboardHelper",["DS/ENOXSourcingUXInfra/Search/SearchUtility","DS/ENOXSourcingUXInfra/Constants/ENOXSourcingConstants"],function(e,t){"use strict";let i;return{buildSearchPayload:function(o,n,a){i=this;let r=new e,s="";o.map(function(e){s+='flattenedtaxonomies:"types/'+e+'"'+t.OR}),s=s.substring(0,s.length-3);var l={..."all"===n||"active"===n&&""===n?[]:{completePreCond:s+"AND [ds6w:completeness]:"+n},..."active"===n||""===n?{completePreCond:s+'AND NOT([ds6w:status]:"'+t.SCR_REQUEST_COMPLETED+'") AND NOT([ds6w:status]:"'+t.SCR_NEW_MODIFICATION_REQUEST_CLOSED+'") AND NOT([ds6w:status]:"'+t.SCR_SOURCE_CHANGE_NOTIFICATION_CLOSED+'") '}:[],with_nls:!1,nresults:t.NRESULTS_999};return r.getSearchPayload(a,o,[t.SOURCE_SOURCING],l)},processSearchResults:function(e){return e.reduce(function(e,t){return[...e,this.processSearchObject(t.attributes)]}.bind(this),[])},processSearchObject:function(e){return e.reduce((e,t)=>{let i=t.name,o=t.value;return{...e,[i]:o}},{})},groupByProperty:function(e,t,i){return e.reduce((e,o)=>{let n=o[t];return e[n]||(e[n]=[]),e[n]=[...e[n],o[i]],e},{})},formatSeries:function(e){return Object.keys(e).map(t=>[t,e[t].length])},groupFacetByProperty:function(e,t,i,o){let n=0,a=t[1],r=[];return r=e&&e.filter(e=>e.sixw===t[0]).reduce((e,t)=>(e.filter(e=>e[0]===a[t.object]).length>0?e.filter(e=>e[0]===a[t.object])[0][1]=e.filter(e=>e[0]===a[t.object])[0][1]+t.count:e.push([a[t.object]?a[t.object]:t.object,t.count]),n+=t.count,e),[]),i>n&&r.push([o,i-n]),r},groupFacetForFilter:function(e,t){var i=t.reduce((t,i)=>(t[i[e]]=void 0===t[i[e]]?1:t[i[e]]+=1,t),{});return Object.keys(i).map(t=>["requestSubmitDate"===e?new Date(t).getTime():t,i[t]])},sortFacetsByDate:function(e){return e.sort(this.compareFacetDate)},compareFacetDate:function(e,t){let i=new Date(e.object).getTime(),o=new Date(t.object).getTime();return i<o?-1:i>o?1:0},getLowerBoundaryDate:function(e){return this.sortFacetsByDate(e).reverse().pop().object},getUpperBoundaryDate:function(e){return this.sortFacetsByDate(e).pop().object},getUpdatedBurnDownData:function(e){let t=new Date((new Date).getTime()-7776e6).getTime();e.unshift([t,0]);let i=0;return e.map(e=>(i+=e[1],{x:e[0],y:i}))},getBurnDownData:function(e,t){function o(e,i){return i.sixw===t[0]?e+i.count:e-i.count}e||(e=[]),(e=e.filter(e=>t.includes(e.sixw)&&"date"===e.type)).sort(i.compareFacetDate);const n=(new Date).getTime(),a=new Date(n-7776e6).getTime(),r=e.reduce(({actual:e,projected:t,actualCount:i,projectedCount:n},r)=>{const s=new Date(r.object).getTime();return e[a]=e[a]||0,t[a]=t[a]||0,s<a?(e[a]=i=o(i,r),{actual:e,projected:t,actualCount:i,projectedCount:n}):(t[s]=t[s]||n,e[s]=e[s]||i,e[s]=i=o(i,r),{actual:e,projected:t,actualCount:i,projectedCount:n})},{actual:{},projected:{},actualCount:0,projectedCount:0});return{actual:r.actual,projected:r.projected,actualCount:r.actualCount,projectedCount:r.projectedCount}},formatFedSearchData:function(e){let t=[];return e&&e.length>0&&e.forEach(e=>{let i={};e.attributes.forEach(e=>{e.dispValue?(i[e.name]=e.dispValue,e.dispValue!==e.value&&(i[e.name+"_value"]=e.value)):i[e.name]?(i[e.name]=[i[e.name]],i[e.name].push(e.value)):i[e.name]=e.value}),t.push(i)}),t}}}),define("DS/ENOXSourcingRequest/controllers/DashboardController",["DS/UIKIT/Mask","DS/ENOXSourcingRequest/views/Dashboard/DashboardView","DS/ENOXSourcingRequest/helpers/DashboardHelper","DS/ENOXSourcingUXInfra/service/ENOXSourcingService"],function(e,t,i,o){"use strict";let n,a,r=function(e){if(!e||!e.app)throw new Error("app and parentController are mandatory");this.helper=i,n=this,a=this.app=e.app};return r.prototype.loadDashboardView=function(i,o,r,s){n.view=new t({app:a,data:n.fetchData(o,r),helper:n.helper,view:i,filtersApplied:s}),n.view.render().inject(i._xsourcingCollectionViewUI.viewContainer),e.unmask(widget.body)},r.prototype.fetchData=function(e,t){let i=[];Object.entries(this.app.typesConfigurator).forEach(([,e])=>{e.requestType&&i.push(e.requestType)});let n=this.helper.buildSearchPayload(i,e,t);return o.getFederatedSearchDataPromise({searchPayLoad:n})},r}),define("DS/ENOXSourcingRequest/ENOXSourcingRequest",["DS/ENOXSourcingUXInfra/service/ENOXSourcingPlatformServices","DS/ENOXSourcingRequest/components/Triptych/TriptychWrapper","DS/ENOXSourcingRequest/components/ApplicationTopBar/ApplicationTopBarWrapper","DS/ENOXSourcingUXInfra/xSourcingRouter/xSourcingRouter","DS/ENOXSourcingUXInfra/components/WelcomePanel/WelcomePanelWrapper","DS/Notifications/NotificationsManagerUXMessages","DS/Notifications/NotificationsManagerViewOnScreen","DS/Handlebars/Handlebars","DS/ENOXSourcingUXInfra/ENOXSourcingExtensionManager","WebappsUtils/WebappsUtils","DS/ENOXSourcingUXInfra/controllers/xSourcingBootstrapController","text!DS/ENOXSourcingRequest/ENOXSourcingRequest_template.html","DS/ENOXSourcingUXInfra/Constants/ENOXSourcingConstants","DS/ENOXSourcingUXInfra/TNProxyImpl/SourcingTNProxy","DS/ENOXSourcingUXInfra/UpdateWidgetTitle/UpdateWidgetTitle","DS/ENOXSourcingUXInfra/DragAndDrop/ENOXSourcingDataDragAndDrop","DS/ENOXSourcingUXInfra/Utilities/Utility","DS/ENOXSourcingRequest/helpers/typesConfigProvider","DS/ENOXSourcingRequest/config/appConfigurator","DS/ENOXSourcingRequest/config/routerConfig","DS/ENOXSourcingUXInfra/ENOXSourcingLogger","DS/Windows/ImmersiveFrame","DS/ENOXSourcingUXInfra/NotificationsUtil/NotificationsUtil","DS/ENOXSourcingUXInfra/Mediator","DS/ENOXSourcingUXInfra/extensions/ENOXSourcingi18nProvider","DS/ENOXSourcingUXInfra/Utilities/Menu","DS/ENOXSourcingUXInfra/JSCacheBust/JSCacheBust","css!DS/ENOXSourcingRequest/ENOXSourcingRequest.css"],function(e,t,i,o,n,a,r,s,l,c,d,u,p,m,f,h,g,S,y,w,C,b,N,E,v,_,D){"use strict";var I=new f;const P=w;var T={onLoad:function(e){D.onLoad(e,T.loadApp.bind(T))},loadApp:async function(){widget.body.empty(),widget.setIcon(c.getWebappsAssetUrl("ENOXSourcingRequest","icons/ENOVIA_WIDGET_Favicon.png"));var e=T;e.widget=widget,widget.app=e,e.configurator=y,e._utility=new g,e._utility.initializeGlobalMethods(),e.typesConfigurator=await S.getMergedAdminTypeConfigs(),e.i18NProvider=await v.initialize(e),e.logger=new C(e),e.logname="ENOXSourcingRequest",e.immersiveFrame=(new b).inject(widget.body),widget.notificationUtil=N,e._mediator=new E,e._applicationChannel=e._mediator.getApplicationBroker(),e.taggerProxy=new m,this.notifs=a,window.notifs=this.notifs,r.setNotificationManager(this.notifs),e.setPreferences(),e._initTriptychAndToolbar(),e.mandatoryStartupPromises=[],e.extManager=new l(e,"DS/ENOXSourcingUXInfra/extensions/"),e.mainController=new d(e),e.use("ENOXSourcingi18nProviderV2"),e.use("ENOXSourcingDataProvider"),e.use("ENOXSourcingControllerProvider"),e.use("ENOXSourcingViewControllerProvider"),e.use("ENOXSourcingRouteControllerProvider"),UWA.Promise.all([e.extManager.init()]).then(function(){UWA.Promise.all(e.mandatoryStartupPromises).then(function(){e._initWelcomePanel(),e._initPlatformServices()})})},onRefresh:function(){if(T.router){var t=T.router._router.getState().name,i=T.router._router.getState().params;i.isRefresh=!0,T.router.navigate(t,i,{reload:!0})}else T._initPlatformServices();_.hide(),e.setCredentialPreference()},endEdit:function(){T.logger.setLevel(widget.getValue("debug")?C.LEVEL.DEBUG:C.LEVEL.ERROR)},onResize:function(){var e=T.router?T.router.getRouter().getState().name:"";let t=T.router._routes.filter(e=>"detailsViewRouteController"===e.routeController).map(e=>e.name);widget.body.offsetWidth>550&&!t.includes(e)?T._applicationChannel.publish({event:"welcome-panel-expand"}):T._applicationChannel.publish({event:"triptych-hide-panel",data:"left"})},_initTriptychAndToolbar:function(){this._applicationContainer=UWA.createElement("div"),this._applicationContainer.classList.add("xCS-application"),widget.body.appendChild(this._applicationContainer),this._triptychWrapper=new t,this._pageToolBarComponent=new i;var e=UWA.createElement("div");e.innerHTML=s.compile(u)(),e=e.firstChild,this._applicationContainer.appendChild(e),this._mainPanelApplicationContent=e.querySelector(".xCS-content"),this._triptychWrapper.init(this._applicationChannel,this._mainPanelApplicationContent),this._pageToolBarComponent.init(this._applicationChannel,this._triptychWrapper,this.i18NProvider),this._middleContainer=document.createElement("div"),this._middleContainer.appendChild(this._triptychWrapper.getMainPanelContainer()),this._applicationChannel.publish({event:"triptych-set-content",data:{side:"middle",content:this._middleContainer}})},reactivateWP:function(){this.router.navigate("home.ComponentRequests"),this._applicationChannel.publish({event:"welcome-panel-expand"})},deactivateWP:function(){},_initRouter:function(){var e=this;o.addRouteMethods("home",{}),o.setDependency("app",this),widget.setRefreshViewParams("xpflLastVisitedRoute",JSON.stringify({route:widget.getValue("defaultRoute")}));var t=JSON.parse(widget.getRefreshViewParams("xpflLastVisitedRoute"));null!=t&&t.name||(t={},widget.setRefreshViewParams("xpflLastVisitedRoute",JSON.stringify({name:widget.getValue("defaultRoute")})),t.route=widget.getValue("defaultRoute")),o.setDependency("app",this),o.start(function(){var i=decodeURIComponent(top.location.href),n=i.split("X3DContentId="),a=i.split("routeContentId=");if(n&&2===n.length){n[1].includes("/fullscreen")&&(n[1]=n[1].split("/fullscreen")[0]);var r=JSON.parse(n[1]),s=e.decideRouteUsingURL(r);s.route?o.navigate(s.route,s):0===Object.keys(s).length&&widget.notificationUtil.showError(T.i18NProvider.object_unsupported)}else if(a&&2===a.length){var l={route:"home.ComponentRequestDetails"};l.id=a[1],o.navigate(l.route,l)}else o.navigate(t.route,{id:t.objectId?t.objectId:"",name:t.viewName?t.viewName:""})})},decideRouteUsingURL:function(e){var t={};return e.data.items[0].objectId&&e.data.items[0].objectType===p.TYPE_COMPONENT_REQUEST&&(t.route="home.ComponentRequestDetails",t.id=e.data.items[0].objectId),t},_initWelcomePanel:function(){let t=T.configurator.welcomePanelActivities;this._welcomePanelComponent=new n,T._triptychWrapper.getLeftPanelContainer().innerHTML="";var i="";i="OnPremise"===e.getPlatformId()?"ENXNcrqUserMap/enxncrq-c-ov.htm":"ENXNcrqUserCloudMap/enxncrq-c-ov.htm",t[0].actions.find(e=>"modal-wizard-type"===e.id).callback=function(){T.dataControllers.componentRequestController.showRequestTypeChooser({wizardRoute:"modal.wizard.type"})};var a={title:p.MY_REQUEST_MANAGEMENT,description:T.i18NProvider.welcome_message,activities:t,eventBroker:T._applicationChannel,container:T._triptychWrapper.getLeftPanelContainer(),router:o,userAssistnceLink:i,trainingLink:"ENXNcrqUserCloudMap/enxncrq-c-ov.htm",app:T};this._welcomePanelComponent.init(a)},onSearch:function(){},use:function(e){return T.extManager.add({ref:e,context:T}),T},_initPlatformServices:function(){e.getPlatformServices(T).then(function(e){T.platformServices=e,I.init(T),T._applicationChannel.publish({event:"platform-service-ready",data:T}),o.initialize(P),T.router=o,T.mainController.initialize(),T._initRouter()},function(){T.logger.warn("Skipping Security Context and CSRF Token retrieval")})},setPreferences:function(){widget.setPreferences(T.configurator.widgetPreferences)},_initDroppable:function(e){T.dropStrategy="OPEN",T.onDropCallback=function(e){if(e&&e.objectType){let t={};if(e.objectType!==p.TYPE_COMPONENT_REQUEST)return void widget.notificationUtil.showError(T.i18NProvider.invalid_object_dropped);t.route=p.COMPONENT_REQUEST_DETAILS_ROUTE,t.id=e.objectId,T.router.navigate(t.route,t,{reload:!0})}},T.dropArea=e||T._triptychWrapper.getMainPanelContainer(),(new h).makeAreaDroppable(T)}};return T}),define("DS/ENOXSourcingRequest/controllers/SourceController",["DS/UIKIT/Mask","DS/Utilities/Dom","DS/Controls/TooltipModel","DS/ENOXSourcingRequest/models/Source","DS/ENOXSourcingRequest/helpers/SourceHelper","DS/ENOXSourcingRequest/views/Source/CreateSource","DS/ENOXSourcingRequest/views/Source/OpenSource","DS/ENOXSourcingUXInfra/components/CreateRequestForm/SourcingInformationHelper","DS/ENOXSourcingUXInfra/Utilities/Utility","DS/ENOXSourcingRequest/helpers/ComponentRequestHelper"],function(e,t,i,o,n,a,r,s,l,c){"use strict";var d=function(e){this.app=e.app,this.model=new o,this.helper=new n,this.sourceInfoHelper=new s(e),this.app=this.sourceInfoHelper.app,this.utility=new l,this.crHelper=new c(this),this.NLS=this.app.i18NProvider};return d.prototype.create=function(t){var i=this;t.addData=i.helper.processCreateValues(t.formValues),i.model.create(t).then(function(e){t.modal.destroy(),t.modelEvent.publish({event:"add-model",data:{view:"requestView"}}),widget.notificationUtil.showSuccess(i.NLS.source_created_successfully),i.sourceInfoHelper.attachDataSheetsToComponentRequest({sourcesData:[{ID:e.data[0].name,...t.formValues}],crID:t.crID}).then(function(e){e&&widget.notificationUtil.showSuccess(i.NLS.one_document_added_successfully)},function(e){widget.notificationUtil.showError(e.internalError?e.internalError:i.NLS.attachment_add_to_cr_failed)}).catch(function(e){i.app.logger.error(e),widget.notificationUtil.showError(i.NLS.attachment_add_to_cr_failed)})},function(o){e.unmask(t.modal.elements.content),i.app._utility.disableOrEnableButton(!1),widget.notificationUtil.showError(o.internalError?o.internalError:i.NLS.err_source_create)})},d.prototype.update=function(e){var t=this;e.addData=t.helper.processUpdateValues(e.formValues),e.id=e.sourceID,t.model.update(e).then(function(i){e.formValues.document_ID?t.sourceInfoHelper.attachDataSheetsToComponentRequest({sourcesData:[{ID:i.data[0].name,...e.formValues}],crID:e.crID}).then(function(){widget.notificationUtil.showSuccess(t.NLS.one_document_added_successfully)},function(e){t.app.logger.error(e.internalError?e.internalError:t.NLS.attachment_add_to_cr_failed)}).catch(function(e){widget.notificationUtil.showError(t.NLS.attachment_add_to_cr_failed),t.app.logger.error(e)}).finally(function(){t.getFieldsForRerendering(e)}):t.getFieldsForRerendering(e)},function(e){widget.notificationUtil.showError(e.internalError?e.internalError:t.NLS.err_source_create)})},d.prototype.createView=function(e){var o=this,n=UWA.createElement("div",{id:"createSource",class:"modalBodyDiv"}),r=new a({controller:o,options:e,formContainer:n});o.sourceInfoHelper.getSourceInfoForm({sourceType:e.sourceType,container:n,onSubmit:r.onSubmit.bind(r)}).then(function(e){r.render({form:e}),t.generateIcon({iconName:"info wux-ui-3ds",className:"infoIcon",tooltipInfos:new i({shortHelp:o.NLS.manufacturer_info})}).inject(r.createForm.getField("SRC Manufacturer").getParent(".form-group").firstChild)},function(e){widget.notificationUtil.showError(o.NLS.err_source_fields_get),o.app.logger.error(e)})},d.prototype.show=function(t){var i=this;e.mask(t.detailsContainer);var o=t.data.params.id;i.model.getDetails({id:o}).then(function(o){t.data.respParams=i.crHelper.processSources(o.data),i.utility.getProcessedActualDocumentData({data:o.data[0].documents}).then(function(e){t.fields=i.helper.getPropertyFields({data:o.data[0],documentData:e,controller:i}),new r({controller:i,options:t}).render()},function(e){widget.notificationUtil.showError(i.NLS.attachment_get_failed),i.app.logger.error(e)}).catch(function(e){widget.notificationUtil.showError(i.NLS.attachment_get_failed),i.app.logger.error(e)}).finally(function(){e.unmask(t.detailsContainer)})},function(e){widget.notificationUtil.showError(i.NLS.error_getting_source_details),i.app.logger.error(e)}).catch(function(e){widget.notificationUtil.showError(i.NLS.error_getting_source_details),i.app.logger.error(e)})},d.prototype.delete=function(t){var i=this;t.deleteData=i.helper.processForDelete(t.selectedNodes.map(e=>e.getAttributeValue("id"))),e.mask(t.inputItemsContainer,t.deleteData.data.length>1?i.NLS.deleting_sources:i.NLS.deleting_source),i.model.delete(t).then(function(){t.selectedNodes.forEach(e=>e.getTreeDocument().removeRoot(e)),widget.notificationUtil.showSuccess(t.deleteData.data.length>1?i.NLS.sources_deleted_successfully:i.NLS.source_deleted_successfully)},function(e){widget.notificationUtil.showError(e.internalError?e.internalError:e.error?e.error:i.NLS.error_while_deleting_source)}).catch(function(e){widget.notificationUtil.showError(e.error?e.error:i.NLS.error_while_deleting_source)}).finally(function(){i.app._applicationChannel.publish({event:"information-panel-close",data:{selectedObject:null}}),e.unmask(t.inputItemsContainer)})},d.prototype.getFieldsForRerendering=function(t){var i=this;i.model.getDetails({id:t.sourceID}).then(function(o){t.data={},t.data.respParams=i.crHelper.processSources(o.data),i.utility.getProcessedActualDocumentData({data:o.data[0].documents}).then(function(e){t.fields=i.helper.getPropertyFields({data:o.data[0],documentData:e,controller:i}),t.propModel.set("fields",t.fields);let n=t.propView;i.sourceInfoHelper.makeAttachmentFieldsDroppable(n.fieldElements.document_ID.fieldController.getWrapperDiv().getParent(".form-group").getParent(".form-group").getParent(),n.fieldElements.document_ID),i.sourceInfoHelper.makeSourcingFieldsDroppable(n.getContent().getElementsByClassName("outerDiv")[0],i.helper.getPropertyFieldsInputElements(n))},function(e){widget.notificationUtil.showError(i.NLS.attachment_get_failed),i.app.logger.error(e)}).catch(function(e){widget.notificationUtil.showError(i.NLS.attachment_get_failed),i.app.logger.error(e)}).finally(function(){widget.notificationUtil.showSuccess(i.NLS.source_updated_successfully),t.updateSourceList&&t.updateSourceList(t.data.respParams[0]),e.unmask(widget.body)})},function(e){widget.notificationUtil.showError(i.NLS.error_getting_source_details),i.app.logger.error(e)}).catch(function(e){widget.notificationUtil.showError(i.NLS.error_getting_source_details),i.app.logger.error(e)})},d}),define("DS/ENOXSourcingRequest/views/ManufacturerEquivalentItem/ShowManufacturerEquivalentItem",["DS/UIKIT/Mask","UWA/Class/View","DS/ENOXSourcingUXInfra/DetailsView/DetailsView","DS/ENOXSourcingUXInfra/PropertiesView/PropertiesView","WebappsUtils/WebappsUtils","DS/ENOXSourcingUXInfra/service/ENOXSourcingService","DS/Utilities/Dom","DS/ENOXSourcingRequest/helpers/ComponentRequestHelper","DS/ENOXSourcingUXInfra/PropertiesView/EditPropertiesWidgetWrapper"],function(e,t,i,o,n,a,r,s,l){"use strict";var c=function(e){this.controller=e,this.helper=new s(this.controller),window.notifs=this.notifs,this.NLS=this.controller.app.i18NProvider};return c.prototype.render=function(e){this.options=e;var t=new UWA.Class.Model({modifyAccess:!1,stateAccess:!1,currentState:e.data.respParams.state,fields:[{type:"text",label:this.NLS.type,placeholder:"",name:"type",value:this.NLS[e.data.respParams.type]?this.NLS[e.data.respParams.type]:e.data.respParams.type,disable:!0,nonEditable:!0},{type:"text",label:this.NLS.subType,placeholder:"",name:"type",value:this.NLS.manufacturer_equivalent_item,disable:!0,nonEditable:!0},{type:"text",label:this.NLS.name,placeholder:"",name:"name",value:e.data.respParams.name,disable:!0,nonEditable:!0},{type:"text",label:this.NLS.organization,placeholder:"",name:"organization",value:e.data.respParams.organizationResponsible,disable:!0,nonEditable:!0},{type:"text",label:this.NLS.collabspace,placeholder:"",name:"collabSpace",value:e.data.respParams.collabspace,disable:!0,nonEditable:!0},{type:"text",label:this.NLS.manufacturer,placeholder:"",name:"manufacturer",value:e.data.respParams.organization,disable:!0,nonEditable:!0},{type:"text",label:this.NLS.title,required:!0,placeholder:this.NLS.title,name:"title",value:e.data.respParams.title,disable:!0,nonEditable:!0},{type:"text",label:this.NLS.manufacturer_part_number,placeholder:this.NLS.enter_part_number,name:"partNumber",required:!0,value:e.data.respParams.partNumber,disable:!0,nonEditable:!0},{type:"textarea",label:this.NLS.description,placeholder:this.NLS.description,name:"description",value:e.data.respParams.description,disable:!0,nonEditable:!0},{type:"text",label:this.NLS.part_source,placeholder:this.NLS.part_source,name:"partSource",value:e.data.respParams.partSource,disable:!0,nonEditable:!0},{type:e.data.respParams.partSourceURL.length>0?"hyperlink":"text",label:this.NLS.part_url,placeholder:this.NLS.part_url,name:"partSourceURL",value:e.data.respParams.partSourceURL,disable:!0,nonEditable:!0,callBack:function(){window.open(this.value)}}]});e.meiId=e.data.respParams.id,this.propertiesModel=t;var i=new o({model:t}),n=e.data.params.mei_proxy_id;e.data.params.fromCreate&&(n=""),c.prototype.processTabs(this,e,i,n)},c.prototype.processTabs=function(t,o,n){var a=o.data.respParams?o.data.respParams:{},r={showTabView:!0};r.tabConfiguration=[{label:t.NLS.properties,content:n?n.render():void 0,index:"0",value:"meiproperties",isSelected:!0,icon:{iconName:"attributes",fontIconFamily:1}},{label:t.NLS.relations,content:t.getRelationsTabContainer(o),index:"1",value:"relationsDiv",icon:{iconName:"object-related",fontIconFamily:1}}],t.attributeMap=[{name:t.NLS.maturity_state,value:a.state,editable:!1,displayWhenMinified:!0},{name:t.NLS.owner,value:a.owner,displayWhenMinified:!0},{name:t.NLS.name,value:a.name,displayWhenMinified:!0},{name:t.NLS.revision,value:a.revision,displayWhenMinified:!0},{name:t.NLS.type,value:t.NLS[a.type]?t.NLS[a.type]:a.type},{name:t.NLS.manufacturer,value:a.organization},{name:t.NLS.part_number,value:a.partNumber}],r.idCardDetails={name:a.title,configuration:a.partNumber,thumbnail:a.image?require.toUrl(a.image):"",attributes:t.attributeMap,withActionsButton:!1},o.callback=function(){e.unmask(o.detailsContainer)},o.detailsViewOptions=r,(new i).init(o)},c.prototype.getRelationsTabContainer=function(t){let i=UWA.createElement("div",{id:"relationsDiv",styles:{position:"relative"}});i.style.height="100%";let o={container:i,facets:["FACET_RELATIONS"],showIdCard:!1},n={objectId:t.meiId};return new l({viewOptions:o,dataOptions:n}).render(),e.unmask(i),i},c}),define("DS/ENOXSourcingRequest/views/RelatedComponentView/RelatedComponentView",["UWA/Core","UWA/Class/View","DS/UIKIT/Mask","DS/ENOXSourcingUXInfra/xsourcingCollectionView/xsourcingCollectionView","WebappsUtils/WebappsUtils","DS/Utilities/Dom","DS/ENOXSourcingUXInfra/Search/ENOXSourcingSearch","DS/UIKIT/SuperModal","DS/ENOXSourcingUXInfra/DragAndDrop/ENOXSourcingDataDragAndDrop","DS/ENOXSourcingUXInfra/Constants/ENOXSourcingConstants","DS/ENOXSourcingUXInfra/Search/SearchUtility","DS/ENOXSourcingUXInfra/openwithservice/ENOXSourcingOpenWithService","DS/ENOXSourcingRequest/controllers/SourceController","css!DS/UIKIT/UIKIT.css","css!DS/ENOXSourcingRequest/views/RelatedComponentView/RelatedComponentView.css"],function(e,t,i,o,n,a,r,s,l,c,d,u,p){"use strict";var m,f,h;return t.extend({name:"related-component-view",tagName:"div",domEvents:{},init:function(e){this.model=e.model,this.app=this.model.get("app"),this.modelEvent=this.model.get("modelEvent"),this.searchUtil=new d,this.sourceController=new p({app:this.model.get("app")}),["container","template","tagName","domEvents"].forEach(function(t){delete e[t]}),this._parent(this,e),this.NLS=this.model.get("app").i18NProvider},setup:function(){this.container.addClassName(this.getClassNames("-container")),this.listenTo(this.model,"onChange",this.render)},render:function(){var t=this;let o=t.model.get("currentObjectData").actualType;m=t.model.get("controller").helper.getRelatedItemsAllowedStates(o,"input-items",t.model.get("currentObjectData")),f=t.model.get("controller").helper.getRelatedItemsAllowedStates(o,"answer-items",t.model.get("currentObjectData")),h=t.model.get("controller").helper.getRelatedItemsAllowedStates(o,"inprocess-items",t.model.get("currentObjectData")),this.container.empty(),this.outerDiv=e.createElement("div",{class:"outerDiv",styles:{height:"100%"}}).inject(this.container),this.requestComponentDiv=e.createElement("div",{class:"requestComponentDiv"}).inject(this.outerDiv),this.inProcessComponentDiv=e.createElement("div",{class:"inProcessComponentDiv"}).inject(this.outerDiv),this.responseComponentDiv=e.createElement("div",{class:"responseComponentDiv"}).inject(this.outerDiv),a.addResizeListener(this.outerDiv,function(){t.update()},0),i.mask(this.container,t.NLS.loading_document),t.requestComponentView={view:"requestView",name:t.NLS.request_components},t.responseComponentView={view:"responseView",name:t.NLS.response_components},t.inProcessComponentView={view:"inprocessView",name:t.NLS.in_process_item};let n={uniqueIdentifier:"responseView"};n.dropAllowedTypes=t.model.get("controller").helper.getAllowedDropActualTypesAnswerItems(t.model.get("currentObjectData").hasAnswerItems);let r=f.includes(t.model.get("currentObjectData").maturityState);n.dropAllowedTypes.length>0&&r&&(n.enableDrop=!0);let s={uniqueIdentifier:"requestView"};s.dropAllowedTypes=t.model.get("controller").helper.getAllowedDropActualTypesInputItems();let l=m.includes(t.model.get("currentObjectData").maturityState);s.dropAllowedTypes.length>0&&l&&(s.enableDrop=!0);let c=function(){if(t._selectedRow&&0===t._selectedRow.length){let e={contextObjId:t.model.get("currentObjectData").id,callControllerMethod:t.model.get("controller")};t.app._applicationChannel.publish({event:"xsourcing-collectionview-selected-object-id",data:{selectedObject:!0,openDetails:t.model.get("controller").hyperlinkHelper.getObjectDetailsInInfoPanel(e)}})}};n.rowUnSelectCallback=s.rowUnSelectCallback=c;let d={uniqueIdentifier:"inprocessView"};d.dropAllowedTypes=t.model.get("controller").helper.getAllowedDropActualTypesAnswerItems(t.model.get("currentObjectData").supportedInProcessItemTypes);let u=h.includes(t.model.get("currentObjectData").maturityState);return d.dropAllowedTypes.length>0&&u&&(d.enableDrop=!0),d.rowUnSelectCallback=s.rowUnSelectCallback=c,t.getCollectionView(t.requestComponentView,this.requestComponentDiv,s),t.getCollectionView(t.responseComponentView,this.responseComponentDiv,n),t.getCollectionView(t.inProcessComponentView,this.inProcessComponentDiv,d),t.modelEvent.subscribe({event:"add-model"},function(e){var o={};"requestView"===e.view?o=t.requestComponentView:"responseView"===e.view?o=t.responseComponentView:"inprocessView"===e.view&&(o=t.inProcessComponentView),t.loadData(o),i.unmask(widget.body)}),t.update(),this.container},update:function(){try{let t=3;var e=this.outerDiv.parentElement.parentElement.getBoundingClientRect();e.width>922&&(t=1),this.requestComponentDiv.style.height=e.height/t-10+"px",this.responseComponentDiv.style.height=e.height/t-10+"px",this.inProcessComponentDiv.style.height=e.height/t-10+"px",this.outerDiv.style.height=e.height+"px",3===t?(this.outerDiv.style.height=e.height-10+"px",this.requestComponentDiv.style.height=e.height/t+"px",this.responseComponentDiv.style.height=e.height/t+"px",this.inProcessComponentDiv.style.height=e.height/t-10+"px",this.requestComponentDiv.removeClassName("largeView").addClassName("smallView"),this.responseComponentDiv.removeClassName("largeView").addClassName("smallView"),this.inProcessComponentDiv.removeClassName("largeView").addClassName("smallView")):(this.requestComponentDiv.removeClassName("smallView").addClassName("largeView"),this.responseComponentDiv.removeClassName("smallView").addClassName("largeView"),this.inProcessComponentDiv.removeClassName("smallView").addClassName("largeView"))}catch(e){}},getDynamicMenus:function(e){if("requestView"===e.view)return m.includes(this.model.get("currentObjectData").maturityState)?this.getInputItemsToolbarCmds(this.model.get("currentObjectData").inputItemsActions,e):[];if("responseView"===e.view){if(!f.includes(this.model.get("currentObjectData").maturityState))return[];if(this.model.get("currentObjectData").hasAnswerItems&&this.model.get("currentObjectData").hasAnswerItems.length>0)return this.getAnswerItemsToolbarCmds(this.model.get("currentObjectData").hasAnswerItems,e)}else if("inprocessView"===e.view){if(!h.includes(this.model.get("currentObjectData").maturityState))return[];if(this.model.get("currentObjectData").supportedInProcessItemTypes&&this.model.get("currentObjectData").supportedInProcessItemTypes.length>0)return this.getAnswerItemsToolbarCmds(this.model.get("currentObjectData").supportedInProcessItemTypes,e)}},getInputItemsToolbarCmds:function(e,t){let i=this,o=[...e.includes("Source")&&i.model.get("currentObjectData").sourceType?[{id:"addNew",text:i.NLS.source,className:"header"},{id:"addNewSource",text:i.NLS.new_source,icon:n.getWebappsAssetUrl("ENOXSourcingRequest","icons/22/I_SourceNew22.png"),handler:function(){i.sourceController.createView({modelEvent:i.modelEvent,crID:i.model.get("currentObjectData").id,sourceType:i.model.get("currentObjectData").sourceType})}}]:[],...e.includes("Engineering Item")?[{text:i.NLS.engineering_item,className:"header"},{id:"addExisitingEngineeringItem",text:i.NLS.existing_eng_item,icon:n.getWebappsAssetUrl("ENOXSourcingRequest","icons/32/I_PADInsertExisting.png"),handler:function(e,o){i.requestViewToolbarCallback(e,o,t)}}]:[],...e.includes("Manufacturer Equivalent Item")?[{id:"addExisitingManufacturingItem",text:i.NLS.existing_mei,icon:n.getWebappsAssetUrl("ENOXSourcingRequest","icons/22/I_ExistingMEI_22.png"),handler:function(e,o){i.requestViewToolbarCallback(e,o,t)}}]:[],...e.includes("SRCComponentRequest")?[{text:i.NLS.request,className:"header"},{id:"addExisitingComponentRequest",text:i.NLS.existing_component_request,icon:n.getWebappsAssetUrl("ENOXSourcingRequest","icons/22/I_AddExistingComponentRequest22.png"),handler:function(e,o){i.requestViewToolbarCallback(e,o,t)}}]:[]];return[{id:"addItems",fonticon:"plus",text:i.NLS.add,disabled:!("TRUE"===i.model.get("currentObjectData").modifyAccess),content:o},{id:"deleteImpactedItem",text:i.NLS.remove,disabled:!0,fonticon:"remove",handler:function(){let e=t.collectionView._gridModel.getSelectedNodes(),o=new s({renderTo:widget.body,okButtonText:i.NLS.remove}),n=1===e.length?e[0].options.label:e.length+" "+i.NLS.context_items_small;o.confirm(i.NLS.remove_confirmation,i.NLS.remove+" - "+n,function(o){o&&e.forEach(function(e){if(e&&i.model.get("removeObject")){var o=e._options.grid;o.view=t.view,i.model.get("removeObject")(o)}})})}},...e.includes("Source")&&i.model.get("currentObjectData").sourceType?[{id:"deleteSource",text:i.NLS.delete_sources,fonticon:"trash",disabled:!0,handler:function(){let e={};e.view=t,i.deleteSource(e)}}]:[]]},getAnswerItemsToolbarCmds:function(e,t){let i=this,o=[...e.includes(c.COMPONENT_REQUEST)?[{text:i.NLS.request,className:"header"},{id:"createAnswerRequest",text:i.NLS.new_request,icon:n.getWebappsAssetUrl("ENOXSourcingRequest","icons/22/I_AnswerRequest22.png"),disabled:!1,handler:function(){i.launchAnswerRequestWizard(t.view)}},{id:"addExisting-"+c.COMPONENT_REQUEST,text:i.NLS.existing_component_request,icon:n.getWebappsAssetUrl("ENOXSourcingRequest","icons/22/I_AddExistingComponentRequest22.png"),handler:function(){i.toolbarCommandCallback(c.COMPONENT_REQUEST,t)}}]:[],...e.includes(c.ENG_ITEM)||e.includes(c.MEI)?[{text:i.NLS.engineering_item,className:"header"}]:[],...e.includes(c.ENG_ITEM)?[{id:"addExisting-"+c.ENG_ITEM,text:i.NLS.existing_eng_item,icon:n.getWebappsAssetUrl("ENOXSourcingRequest","icons/32/I_PADInsertExisting.png"),handler:function(){i.toolbarCommandCallback(c.ENG_ITEM,t)}}]:[],...e.includes(c.MEI)?[{id:"addExisting-"+c.MEI,text:i.NLS.existing_mei,icon:n.getWebappsAssetUrl("ENOXSourcingRequest","icons/22/I_ExistingMEI_22.png"),handler:function(){i.toolbarCommandCallback(c.MEI,t)}}]:[],...e.includes(c.QUALIFICATION)?[{text:i.NLS.qualification,className:"header"},{id:"addExisting-"+c.QUALIFICATION,text:i.NLS.existing_qualification,icon:n.getWebappsAssetUrl("ENOXSourcingRequest","icons/22/I_AddExistingQualification-22.png"),handler:function(){i.toolbarCommandCallback(c.QUALIFICATION,t)}}]:[],...e.includes(c.DOCUMENT)?[{text:i.NLS.document,className:"header"},{id:"addExisting-"+c.DOCUMENT,text:i.NLS.existing_attachment,icon:n.getWebappsAssetUrl("ENOXSourcingRequest","icons/22/I_CMD_docattach.png"),handler:function(){i.toolbarCommandCallback(c.DOCUMENT,t)}}]:[]],a=[];o.length>0&&a.push({fonticon:"plus",text:i.NLS.add,disabled:!("TRUE"===i.model.get("currentObjectData").modifyAccess),content:o});let r="responseView"===t.view?i.NLS.answer_items_small:i.NLS.in_process_items_small;return a.push({id:"deleteAnswerItem",text:i.NLS.remove,disabled:!0,fonticon:"remove",handler:function(){let e=t.collectionView._gridModel.getSelectedNodes();var o=new s({renderTo:widget.body,okButtonText:i.NLS.remove}),n=1===e.length?e[0].options.label:e.length+" "+r;o.confirm(i.NLS.remove_confirmation,i.NLS.remove+" - "+n,function(o){o&&e.forEach(function(e){if(e&&i.model.get("removeObject")){var o=e._options.grid;o.view=t.view,i.model.get("removeObject")(o)}})})}}),a},requestViewToolbarCallback:function(e,t,i){let o="",n="",a=null,r=null;"addExisitingEngineeringItem"===t.id&&(n=c.ENG_ITEM_PROXY,a=c.EXCLUDE_MEI,r=c.VPMREFERENCE),"addExisitingManufacturingItem"===t.id&&(n=c.MEI_PROXY,o=c.MEI_EXTENSION),"addExisitingComponentRequest"===t.id&&(r=c.TYPE_COMPONENT_REQUEST),this.launchA3DSearch({excludeCondition:a,subType:o,multiSel:!0,proxyType:n,typeSearch:r,resourceid_not_in:[this.model._attributes.options.id]},i.view)},getCollectionView:function(e,t,n){var a=this,r={data:[]};if(r._mediator=a.model.get("mediator"),r.showToolbar=!0,r.uniqueIdentifier=n.uniqueIdentifier,r.rowUnSelectCallback=n.rowUnSelectCallback,r.toolbarActions=a.getDynamicMenus(e),r.columnsConfigurations=[{text:a.NLS.title,dataIndex:"tree",resizableFlag:!0,sortableFlag:!0,pinned:"left",width:150},{text:a.NLS.type,dataIndex:"type"},{text:a.NLS.manufacturer,dataIndex:"organization"},{text:a.NLS.maturity_state,dataIndex:"maturityState",minWidth:125},{text:a.NLS.owner,dataIndex:"owner"},{text:a.NLS.modified_date,dataIndex:"modificationDate",typeRepresentation:"datetime",minWidth:150},{text:a.NLS.creation_date,dataIndex:"creationDate",typeRepresentation:"datetime",minWidth:150}],r.views=["Grid","Tile"],r.showNodeCount=!1,r.itemsName=e.name,r.onContextualEventCallback=function(t){var i=[];if(t){var o=t.cellInfos&&t.cellInfos.nodeModel?t.cellInfos.nodeModel:null;if(-1===(t.cellInfos?t.cellInfos.rowID:null)||!o)return this._contextualMenuBuilder?this._contextualMenuBuilder.buildMenu(t,r):[];var n=t.cellInfos.nodeModel?t.cellInfos.nodeModel:t.cellInfos.cellModel;if(n)return n.options.grid.actualType===c.TYPE_SOURCE?"TRUE"!==a.sourceController.helper.canModify({crState:a.model.get("currentObjectData").maturityState})?i:(i.push({type:"PushItem",title:a.NLS.delete,fonticon:{content:"wux-ui-3ds wux-ui-3ds-trash"},action:{callback:function(){let t={};t.view=e,t.contextualNode=[o],a.deleteSource(t)}}}),i):u.getOpenWithMenu(n).then(function(t){return i.push({id:"OpenWith",type:"PushItem",title:a.NLS.open_with,icon:"open-menu-dot",submenu:t}),a.getDefaultContexualMenu(i,e,n),i},function(){return a.getDefaultContexualMenu(i,e,n),i}).catch(function(){})}else t.cellCtxMenuRequired},e.collectionView=new o,r.container=t,r.rowSelection="multiple",r.sort=[{id:"title",text:a.NLS.title,type:"string"}],r.enableDrag=!0,r.enableCellDrag=!0,r.displayedOptionalCellProperties=["contextualMenu","subtitle","description"],e.collectionView.init(r),n&&!0===n.enableDrop){r.allowedTypes=n.dropAllowedTypes,r.dropArea=e.collectionView._xsourcingCollectionViewUI.viewContainer,window.answerItemDropRef&&(window.answerItemDropRef=r),r.dropStrategy="CREATE",r.multiObjs=!0,r.onDropCallback=function(t){i.mask(r.dropArea,a.NLS.loader_mask);let o=[...new Set(t.map(e=>e.serviceId))],n=[...new Set(t.map(e=>e.objectType))],s=t.map(e=>e.objectId);var l=t.reduce(function(e,t){return e[t.objectType]=t.displayType,e},{}),d=a.searchUtil.getSearchPayload(s,n,o);a.searchUtil.callFederatedSearch(d).then(function(t){t.results=t.results?t.results:[],a.searchUtil.callRecentFederatedSearch(d).then(function(i){t.results=i.results?[...t.results,...i.results]:t.results;let o=a.searchUtil.processResults(t),n=(o=o.filter(e=>s.includes(e.resourceid))).map(({resourceid:e})=>e);(o=o.filter(({resourceid:e},t)=>!n.includes(e,t+1))).length!==d.resourceid_in.length&&widget.notificationUtil.showError(a.NLS.not_found_not_indexed),o.map(function(t){a.model.get("controller").helper.isAllowedForDrop(t,{allowedTypes:r.allowedTypes,ctxObjectID:a.model.get("currentObjectData").id}).then(i=>{if(t&&i[0])if("requestView"===r.uniqueIdentifier||t["ds6w:what/ds6w:status"]&&-1===t["ds6w:what/ds6w:status"].toLowerCase().indexOf(c.OBSOLETE_EMXSTR.toLowerCase())||t["ds6w:status"]&&-1===t["ds6w:status"].toLowerCase().indexOf(c.OBSOLETE_EMXSTR.toLowerCase())){let o=[];o.view=e.view,o.proxyType=a.model.get("controller").helper.getDroppedObjProxyType(t,i[1]),o.push(t),a.model.get("processForObject")&&a.model.get("processForObject")(o)}else widget.notificationUtil.showError(a.NLS.obsolete_not_supported_drop);else if(a.model.get("currentObjectData").id===t.resourceid)widget.notificationUtil.showError(a.NLS.invalid_ctx_object_same_as_dropped);else{let e=l[t["ds6w:what/ds6w:type"]];t["ds6w:what/ds6w:kind"]&&t["ds6w:what/ds6w:kind"]===c.MEI_EXTENSION&&(e=a.NLS.manufacturer_equivalent_item),widget.notificationUtil.showError('"'+e+'" '+a.NLS.invalid_for_adding)}})})})}).finally(function(){i.unmask(r.dropArea)})},r.applicationChannel=a.model.get("applicationChannel"),(new l).makeAreaDroppable(r)}a._selectedRow=[],e.collectionView._gridModel.addEventListener("select",function(e){a._selectedRow.push(e.data.nodeModel.options.grid)}),e.collectionView._gridModel.addEventListener("unselect",function(e){a._selectedRow.length>0&&(a._selectedRow=a._selectedRow.filter(t=>t.id!==e.data.nodeModel.options.grid.id))}),e.collectionView.collectionViewEvents.subscribe({event:"xsourcing-collectionview-selection-updated"},function(t){t.selectedItems.length>0?(t.selectedItems.some(e=>e.grid.actualType===c.TYPE_SOURCE)?t.selectedItems.some(e=>e.grid.actualType!==c.TYPE_SOURCE)?(e.collectionView.collectionViewEvents.publish({event:"xsourcing-collectionview-disable-toolbar-button",data:"deleteSource"}),e.collectionView.collectionViewEvents.publish({event:"xsourcing-collectionview-disable-toolbar-button",data:"deleteImpactedItem"})):e.collectionView.collectionViewEvents.publish({event:"xsourcing-collectionview-enable-toolbar-button",data:"deleteSource"}):e.collectionView.collectionViewEvents.publish({event:"xsourcing-collectionview-enable-toolbar-button",data:"deleteImpactedItem"}),e.collectionView.collectionViewEvents.publish({event:"xsourcing-collectionview-enable-toolbar-button",data:"deleteAnswerItem"}),1===t.selectedItems.length?a.infoPanelHandler({options:r,data:t,event:event,viewObj:e}):a.model.get("applicationChannel").publish({event:"xsourcing-collectionview-selected-object-id",data:{selectedObject:"multipleSelected",fromInfoPanel:a.model.get("fromInfoPanel")}})):(e.collectionView.collectionViewEvents.publish({event:"xsourcing-collectionview-disable-toolbar-button",data:"deleteAnswerItem"}),e.collectionView.collectionViewEvents.publish({event:"xsourcing-collectionview-disable-toolbar-button",data:"deleteSource"}),e.collectionView.collectionViewEvents.publish({event:"xsourcing-collectionview-disable-toolbar-button",data:"deleteImpactedItem"}),a.model.get("applicationChannel").publish({event:"xsourcing-collectionview-unselected-object-id",data:{selectedObject:null}}))}),a.model.get("controller")&&a.loadData(e),i.unmask(this.container)},onDestroy:function(){return this._parent.apply(this,arguments)},launchA3DSearch:function(e,t){var i=this;e.callbackMethod=function(o){o&&o.map(function(o){var n=[];n.view=t,n.proxyType=e.proxyType,n.push(o),i.model.get("processForObject")&&i.model.get("processForObject")(n)})},(new r).init(e)},infoPanelHandler:function(e){var t=this,i=e.options,o=e.viewObj,n=e.data,a=e.event;let r=n.selectedItems[n.selectedItems.length-1].grid.additionalDragData,s=r&&r.objectTaxonomies&&r.objectTaxonomies.includes(c.MEI_EXTENSION),l=n.selectedItems[n.selectedItems.length-1].grid.actualType===c.TYPE_SOURCE,d=c.TYPE_QUALIFICATION_LIST.includes(n.selectedItems[n.selectedItems.length-1].grid.actualType);if(s||l||d){i._triptychWrapper=t.model.get("triptychWrapper"),i.mediator=t.model.get("mediator"),i.router=t.model.get("router");var u=a&&a.dsModel&&a.dsModel.activeNode?a.dsModel.activeNode:{options:n.selectedItems[n.selectedItems.length-1]};t.model.get("applicationChannel").publish({event:"xsourcing-collectionview-selected-object-id",data:{selectedObject:u,openDetails:function(){var e={};e.data={params:u.options.grid},e.detailsContainer=i._triptychWrapper.getRightPanelContainer(),e.detailsContainer.empty&&e.detailsContainer.empty(),e._mediator=i._mediator,e._triptychWrapper=i._triptychWrapper,e.router=i.router,e.applicationChannel=t.model.get("applicationChannel"),e.forInfo=!0,e.crData=t.model.get("currentObjectData"),e.data.params.id=e.data.params.actualId?e.data.params.actualId:e.data.params.id,e.openSourceEvent=t.model.get("openSourceEvent"),e.updateSourceList=function(e){var t=o.collectionView._gridModel.getAllDescendants().filter(t=>t._options.grid.id===e.grid.id);t&&1===t.length&&t[0].updateOptions(e)};let n=t.sourceController;s?(n=t.model.get("controller")).showMEI(e):l?n.show(e):d&&(n=t.model.get("controller")).showQualification(e)},fromInfoPanel:t.model.get("fromInfoPanel")}})}else{var p=t.getRelatedComponentInfoData({options:n.selectedItems[0]});p.triptychWrapper=t.model.get("triptychWrapper"),p.mediator=t.model.get("mediator"),t.model.get("applicationChannel").publish({event:"xsourcing-collectionview-selected-object-id",data:{selectedObject:p,fromInfoPanel:t.model.get("fromInfoPanel")}})}},loadData:function(e){var t=this,o=t.model.get("controller");"requestView"===e.view?(t.model.get("options").includeParams="$include=impacted-items,source-information",t.container.getElement(".requestComponentDiv")&&i.mask(t.container.getElement(".requestComponentDiv"),t.NLS.loading_context_items),o.model.getComponentRequest(t.model.get("options")).then(function(i){t.impactedItems=i.data[0]["impacted-items"];let o=i.data[0]["source-information"];t.processAndLoadDataInView(t.impactedItems,o,e,".requestComponentDiv")})):"responseView"===e.view?(i.unmask(t.container.getElement(".responseComponentDiv")),t.model.get("options").includeParams="$include=answer-items",t.container.getElement(".responseComponentDiv")&&i.mask(t.container.getElement(".responseComponentDiv"),t.NLS.loading_answer_items),o.model.getComponentRequest(t.model.get("options")).then(function(i){t.answerItems=i.data[0]["answer-items"];let o=t.answerItems.filter(e=>e.type===c.TYPE_COMPONENT_REQUEST),n=t.answerItems.filter(e=>e.type!==c.TYPE_COMPONENT_REQUEST);t.processAndLoadDataInView(n,o,e,".responseComponentDiv")})):"inprocessView"===e.view&&(i.unmask(t.container.getElement(".inProcessComponentDiv")),t.model.get("options").includeParams="$include=inprocess-items",t.container.getElement(".inProcessComponentDiv")&&i.mask(t.container.getElement(".inProcessComponentDiv"),t.NLS.loading_in_process_items),o.model.getComponentRequest(t.model.get("options")).then(function(i){t.inprocessItems=i.data[0]["inprocess-items"];let o=t.inprocessItems.filter(e=>e.type===c.TYPE_COMPONENT_REQUEST),n=t.inprocessItems.filter(e=>e.type!==c.TYPE_COMPONENT_REQUEST);t.processAndLoadDataInView(n,o,e,".inProcessComponentDiv")}))},processAndLoadDataInView:function(e,t,o,n){var a=this,r=a.model.get("controller");let s=r.helper.preProcessForSearch(e);var l=a.searchUtil.getSearchPayload(s.objIds,s.types,s.sources);a.searchUtil.callFederatedSearch(l).then(function(s){s.results=s.results?s.results:[],a.searchUtil.callRecentFederatedSearch(l).then(function(l){s.results=l.results?[...s.results,...l.results]:s.results;let d=a.searchUtil.processResults(s),u=e.map(e=>d.find(({resourceid:t})=>t===e.id||t===e.Proxy_Id));u.forEach(function(t){e.map(function(e){t&&(t.resourceid!==e.id&&t.resourceid!==e.Proxy_Id||(t.proxyId=e.id))})});let p=r.helper.processForRelatedItems(u,t),m={"ds6w:status":[]};p.forEach(e=>{e.grid.maturityState&&m["ds6w:status"].push(e.grid.maturityState)}),m["ds6w:status"]=[...new Set(m["ds6w:status"])],a.searchUtil.getNlsOfPropertiesValues(m).then(function(e){p.forEach(t=>{t.grid.maturityState=e&&e["ds6w:status"]&&e["ds6w:status"][t.grid.maturityState]?e["ds6w:status"][t.grid.maturityState]:t.grid.maturityState,t.subLabel=e&&e["ds6w:status"]&&t.grid.actualType===c.TYPE_SOURCE&&e["ds6w:status"][t.subLabel.split("\n")[0].split("|").map(e=>e.trim())[2]]?t.subLabel.replace(t.subLabel.split("\n")[0].split("|").map(e=>e.trim())[2],e["ds6w:status"][t.subLabel.split("\n")[0].split("|").map(e=>e.trim())[2]]):t.subLabel,t.tooltip.forEach(t=>{t.data=e&&e["ds6w:status"]&&e["ds6w:status"][t.data]?e["ds6w:status"][t.data]:t.data})})}).finally(function(){o.collectionView._setData(p),o.collectionView._xsourcingCollectionViewUI._allData=p,a.container.getElement(n)&&i.unmask(a.container.getElement(n))})})})},getRelatedComponentInfoData:function(e){return{fields:[{disable:!0,label:this.NLS.type,placeholder:this.NLS.type,type:"labelValue",icon:require.toUrl("ENOXSourcingUXInfra/assets/icons/22/Qualification-22.png"),value:e.options.grid.type},{disable:!0,label:this.NLS.title,placeholder:this.NLS.title,type:"labelValue",value:e.options.grid.title},{disable:!0,label:this.NLS.description,placeholder:this.NLS.description,type:"labelValue",value:e.options.grid.description},{disable:!0,label:this.NLS.category,placeholder:this.NLS.category,type:"labelValue",value:e.options.grid.category},{disable:!0,label:this.NLS.manufacturer,placeholder:this.NLS.manufacturer,type:"labelValue",value:e.options.grid.organization},{disable:!0,label:this.NLS.owner,placeholder:this.NLS.owner,type:"labelValue",value:e.options.grid.owner},{disable:!0,label:this.NLS.modified_date,placeholder:this.NLS.modified_date,type:"labelValue",value:e.options.grid.modificationDate},{disable:!0,label:this.NLS.creation_date,placeholder:this.NLS.creation_date,type:"labelValue",value:e.options.grid.creationDate}],objectData:{attributes:[{name:this.NLS.name,value:e.options.grid.title},{name:this.NLS.maturity_state,value:e.options.grid.maturityState},{name:this.NLS.description,value:e.options.grid.description}],image:e.options.grid.image,name:e.options.grid.title}}},getDefaultContexualMenu:function(e,t,i){var o=this;(m.includes(o.model.get("currentObjectData").maturityState)&&"requestView"===t.view||f.includes(o.model.get("currentObjectData").maturityState)&&"responseView"===t.view||h.includes(o.model.get("currentObjectData").maturityState)&&"inprocessView"===t.view)&&(e.push({type:"SeparatorItem"}),e.push({id:"remove",type:"PushItem",title:o.NLS.remove,icon:"remove",action:{callback:function(){let e=i.options.grid;(window.odtData&&(window.odtData=i),e.view=t.view,o.model.get("removeObject"))&&new s({renderTo:widget.body,okButtonText:o.NLS.remove}).confirm(o.NLS.remove_confirmation,o.NLS.remove+" - "+e.title,function(t){t&&o.model.get("removeObject")(e)})}}}))},deleteSource:function(e){var t=this;if(!e.view.collectionView._xsourcingCollectionViewUI.checkIfExceedsDeleteLimit(e.view.collectionView._gridModel.getSelectedNodes())&&(e.selectedNodes=e.view.collectionView._gridModel.getSelectedNodes(),e.applicationChannel=t.model.get("applicationChannel"),e.inputItemsContainer=t.container.getElement(".requestComponentDiv"),e.contextualNode&&(e.selectedNodes=e.contextualNode.slice()),e.contextualNode=void 0,e.selectedNodes.length>0)){var i=new s({renderTo:widget.body,okButtonText:t.NLS.delete}),o=1===e.selectedNodes.length?e.selectedNodes[0].options.label:e.selectedNodes.length+" "+t.NLS.sources_small;i.confirm(t.NLS.delete_confirmation,t.NLS.delete+" - "+o,function(i){i&&t.sourceController.delete(e)})}},launchAnswerRequestWizard:function(e){let t=this.model.get("options").id;this.modelEvent.view=e,this.model.get("controller").getDataAndLaunchAnswerItemCreatePage(t,this.modelEvent)},toolbarCommandCallback:function(e,t){var i="",o="",n=null;e===c.ENG_ITEM?(n=c.EXCLUDE_MEI,e=c.VPMREFERENCE,o=c.ENG_ITEM_PROXY):e===c.MEI?(i=c.MEI_EXTENSION,o=c.MEI_PROXY):e===c.QUALIFICATION?(e=c.TYPE_QUALIFICATION,o=c.TYPE_QUALIFICATION):e===c.DOCUMENT?o=c.DOCUMENT:e===c.COMPONENT_REQUEST&&(e=c.TYPE_COMPONENT_REQUEST,o=c.TYPE_COMPONENT_REQUEST),n=n?n+c.AND+c.EXCLUDE_OBSOLETE:c.EXCLUDE_OBSOLETE,this.launchA3DSearch({excludeCondition:n,subType:i,typeSearch:e,multiSel:!0,proxyType:o,resourceid_not_in:[this.model._attributes.options.id]},t.view)}})}),define("DS/ENOXSourcingRequest/views/Qualification/OpenQualification",["DS/UIKIT/Mask","DS/ENOXSourcingRequest/models/ComponentRequest","DS/ENOXSourcingUXInfra/DetailsView/DetailsView","DS/ENOXSourcingUXInfra/PropertiesView/SRCRelatedObjectsView/RelatedObjectsView","DS/ENOXSourcingUXInfra/DocumentView/DocumentView","DS/ENOXSourcingRequest/helpers/ComponentRequestHelper","DS/ENOXSourcingUXInfra/Constants/ENOXSourcingConstants","DS/ENOXSourcingUXInfra/service/ENOXSourcingPlatformServices","DS/ENOXSourcingUXInfra/CommonUtils/CommonUtils","DS/ENOXSourcingUXInfra/PropertiesView/EditPropertiesWidgetWrapper","DS/ENOXSourcingUXInfra/Utilities/HyperLinkHelper","DS/ENOXSourcingUXInfra/PropertiesView/3DComments/CommentsView","DS/ENOXSourcingUXInfra/ObjectHistory/SourcingTimeline"],function(e,t,i,o,n,a,r,s,l,c,d,u,p){"use strict";var m=function(e){this.controller=e,this.NLS=this.controller.app.i18NProvider},f={};return m.prototype.render=function(e){e.controller=this.controller,f=e,this.detailsView(e)},m.prototype.detailsView=function(e){var t={};this.addIdCardOptions(e,t),this.addTabOptions(e,t),e.detailsViewOptions=t,(new i).init(e)},m.prototype.addIdCardOptions=function(e,t){let i=this,o=e.data.respParams,n=[];t.idCardDetails={name:o.name,thumbnail:o.image,attributes:[{name:i.NLS.maturity_state,value:o.qualificationMaturityDisplay,displayWhenMinified:!0},{name:i.NLS.target_item,value:o.mei_title,displayWhenMinified:!0},{name:i.NLS.owner,value:o.owner,displayWhenMinified:!0},{name:i.NLS.revision,value:o.revision,displayWhenMinified:!0},{name:i.NLS.creation_date,value:l.getDateStringForDisplay(o.created)},{name:i.NLS.modified_date,value:l.getDateStringForDisplay(o.modified)}]},e.data.respParams.type!==r.TYPE_QUALIFICATION_LIST[0]&&(e.data.respParams.type===r.TYPE_QUALIFICATION_LIST[2]?(o.contextObj.forEach(e=>{n.push(`${e.dataelements.Title} (${e.dataelements.Revision})`)}),t.idCardDetails.attributes.splice(2,0,{name:i.NLS.context_items,value:n})):(t.idCardDetails.attributes.splice(3,0,{name:i.NLS.preferred,value:"TRUE"===o.preferred?i.NLS.Yes:i.NLS.No,displayWhenMinified:!0}),t.idCardDetails.attributes.splice(2,0,{name:i.NLS.context_item,value:o.enterpriseItem})))},m.prototype.addTabOptions=function(e,t){let i=UWA.createElement("div",{styles:{height:"100%",width:"100%"}}),o=this.qualTimeline=new p({physicalId:e.data.respParams.id,objectTitle:e.data.respParams.name,historyContainer:i,activityMappingObject:{}});t.showTabView=!0,t.tabConfiguration=[{label:this.NLS.properties,content:m.prototype.addQualificationTabContainer(e),index:"1",value:"propertiesTblDiv",isSelected:!0,icon:{iconName:"attributes",fontIconFamily:1}},{label:this.NLS.attachments,content:m.prototype.getDocumentTabContainer(e),index:"2",value:"documentTblDiv",reload:!1,view:m.documentView,icon:{iconName:"attach",fontIconFamily:1}},{label:s.getPlatformId()===r.ONPREMISE?this.NLS.relations:this.NLS.relatedObjects,content:m.prototype.getRelationsTabContainer.call(this,e),index:"3",value:"relationsDiv",icon:{iconName:"object-related",fontIconFamily:1}},{label:this.NLS.activity,content:i,index:"4",value:"activity",icon:{iconName:"clock",fontIconFamily:1},reload:!0,view:o,events:{click:function(){}}},{label:this.NLS.comments,content:m.prototype.get3DCommentsContainer.call(this,e),index:"5",reload:!0,value:"commentsDiv",icon:{iconName:"comment",fontIconFamily:1}}]},m.prototype.getDocumentTabContainer=function(e){var i=m.prototype.createExpanderUWADiv("documentDiv");i.style.height="100%";var o=new t,r=new a(e.controller),s={},l=new UWA.Class.Model({parentOptions:e,fromInfoPanel:e.forInfo,contextObject:o,mediator:e.controller.app._mediator,modelEvent:e.controller.app._mediator.createNewChannel(),infoContainer:e.controller.app._triptychWrapper.getRightPanelContainer(),additionalHeaders:{},applicationChannel:e.controller.app._applicationChannel,triptychWrapper:e.controller.app._triptychWrapper,isSpecification:!1,blockActions:!0,helper:r,isDragDropAllowed:!1,isUpdateAllowed:!1,state:!1});return s=new n({model:l}),m.documentView=s,s.render().inject(i),i},m.prototype.createExpanderUWADiv=function(e){return UWA.createElement("div",{id:e,styles:{position:"relative"}})},m.prototype.getRelationsTabContainer=function(e){let t=this,i=m.prototype.createExpanderUWADiv("relationsDiv");if(i.style.height="100%",s.getPlatformId()===r.ONPREMISE){let t={container:i,facets:["FACET_RELATIONS"],showIdCard:!1},o={objectId:e.data.params.id};new c({viewOptions:t,dataOptions:o}).render()}else t.getSRCRelatedObjectsView({options:e,relationsContainer:i});return i},m.prototype.getSRCRelatedObjectsView=function(t){e.mask(t.relationsContainer,this.NLS.loading),f.controller.helper.processDataForRelationsTab({data:t.options.data.respParams}).then(e=>{let i=new UWA.Class.Model({data:e,ctxCallback:function(e){let t=e.options.id;if(r.TYPE_QUALIFICATION_LIST.includes(e.options.grid.type)){let e={contextObjId:t,callControllerMethod:f.controller,detailsFunction:f.controller.showQualification};this.controller.app._applicationChannel.publish({event:"information-panel-add-content",data:{openDetails:(new d).getObjectDetailsInInfoPanel(e)}}),this.controller.app._applicationChannel.publish({event:"information-panel-open-without-reload-content"})}else if(r.VPMREFERENCE===e.options.grid.type||r.TYPE_MODEL===e.options.grid.type||r.DELFMIFUNCTIONREFERENCE_TYPES.includes(e.options.grid.type)){let e={container:this.controller.app._triptychWrapper.getRightPanelContainer(),facets:["FACET_PROPERTIES","FACET_SWYMCOMMENTS","FACET_RELATIONS"]},i={objectId:t},o=function(){new c({viewOptions:e,dataOptions:i}).render()};this.controller.app._applicationChannel.publish({event:"information-panel-add-content",data:{openDetails:o}}),this.controller.app._applicationChannel.publish({event:"information-panel-open-without-reload-content"})}else if(r.DSPLAN_PROJECT===e.options.grid.type){let e=encodeURIComponent(t.replace("<","").replace(">",""));window.open(s._platforms[r.SERVICE_3DDASHBOARD]+"#dashboard:/tab:/app:ENXPLAN_AP/content:ids="+e+"&tenant="+s.getPlatformId()+"&x3dPlatformId="+s.getPlatformId())}else window.open(s._platforms[r.SERVICE_3DSPACE]+"/common/emxNavigator.jsp?objectId="+t)}}),n=new o({model:i});window.relatedQualificationReference&&(window.srcRelatedObjectsView=n),n.render().inject(t.relationsContainer)}).catch(function(){widget.notificationUtil.showError(this.NLS.error_loading_related_objects)}).finally(function(){e.unmask(t.relationsContainer)})},m.prototype.get3DCommentsContainer=function(t){let i=UWA.createElement("div",{id:"commentsDiv",styles:{position:"relative"}});return i.style.height="100%",this.get3DCommentsView({options:t,container:i}),e.unmask(i),i},m.prototype.get3DCommentsView=function(t){e.mask(t.container,this.NLS.loading),new u({data:{id:t.options.data.respParams.id,type:r.TYPE_QUALIFICATION,appID:"ENXSPIQ_AP"}}).render().inject(t.container)},m.prototype.addQualificationTabContainer=function(e){this.options=e;let t={container:e._triptychWrapper.getRightPanelContainer(),facets:["FACET_PROPERTIES"],typeOfDisplay:"editProp_onlyProperties",showIdCard:!1,readOnly:!0,editMode:!1},i={objectId:e.data.params.qualificationId},o=new c({viewOptions:t,dataOptions:i});o.render();let n=o.tabContainer;return o.tabContainer.elements&&o.tabContainer.elements.container&&(n=o.tabContainer.elements.container),n},m}),define("DS/ENOXSourcingRequest/views/ComponentRequest/OpenComponentRequest",["DS/Utilities/Dom","DS/ENOXSourcingRequest/models/ComponentRequest","DS/UIKIT/Mask","DS/ENOXSourcingUXInfra/DetailsView/DetailsView","DS/ENOXSourcingUXInfra/PropertiesView/PropertiesView","DS/ENOXSourcingUXInfra/LifeCycleView/LifeCycleViewBis","DS/ENOXSourcingRequest/views/DocumentView/DocumentView","DS/ENOXSourcingUXInfra/MembersView/MembersView","DS/ENOXSourcingRequest/views/RelatedComponentView/RelatedComponentView","DS/ENOXSourcingRequest/helpers/ComponentRequestHelper","DS/ENOXSourcingRequest/views/TaskView/ProcessView","DS/ENOXSourcingUXInfra/service/ENOXSourcingService","DS/ENOXSourcingUXInfra/Constants/ENOXSourcingConstants","DS/ENOXSourcingUXInfra/service/ENOXSourcingPlatformServices","DS/ENOXSourcingUXInfra/components/IDCardInfo/IDCardInfo","DS/ENOXSourcingUXInfra/ObjectHistory/SourcingTimeline","DS/ENOXSourcingUXInfra/CommonUtils/CommonUtils","DS/ENOXSourcingUXInfra/PropertiesView/3DComments/CommentsView","DS/ENOXSourcingUXInfra/Search/ENOXSourcingSearch","DS/Menu/ContextualMenu","DS/ENOXSourcingUXInfra/Utilities/Utility","DS/ENOXSourcingUXInfra/PropertiesView/EditPropertiesWidgetWrapper","DS/ENOXSourcingUXInfra/Utilities/HyperLinkHelper","DS/ENOXSourcingUXInfra/PropertiesView/SRCRelatedObjectsView/RelatedObjectsView"],function(e,t,i,o,n,a,r,s,l,c,d,u,p,m,f,h,g,S,y,w,C,b,N,E){"use strict";var v=function(e){this.controller=e,this.helper=new c(this.controller),this.NLS=this.controller.NLS},_={};return v.prototype.render=function(e){var c=this,S=widget.getElement(".information-panel.panel-icon-wrapper");e.detailsContainer||c.controller.app._applicationChannel.publish({event:"welcome-panel-hide"}),e.controller=this.controller,c.options=e,_=e;var y=null,w=[{id:"addExtension",text:c.NLS.add_extension,fonticon:"attributes-add",handler:function(){require(["DS/ENOXSourcingAddAttributeGroup/AddAttributeGroupController"],function(t){let i=new t;e.callerSource=p.SOURCE_SOURCING,e.endPoints=p.COMPONENTREQUEST_EXTENSION_ENDPOINTS,e.applyExtensionCallback=c.applyExtensionCallback,e.id=e.data.respParams.id,i.view(e,i,e.data.respParams.id,e.data.respParams.actualType,y,c.controller)})}}],C=new t;y=new UWA.Class.Model({app:c.controller.app,modifyAccess:e.data.respParams.modifyAccess,additionalActions:w,stateAccess:!0,fields:c.controller.helper.getFieldsForPropertiesPage(e),save:function(t,i){if(t.title.getValue()&&t.title.getValue().trim()){for(var o in e.id=e.data.respParams.id,e.formValues={},c.updateFormValuesForSelectedObjectIds(t,e),t)t.hasOwnProperty(o)&&!t[o].options.nonEditable&&t[o].elements.input&&(e.formValues[o]=t[o].elements.input.getAttribute("actualvalue")?t[o].elements.input.getAttribute("actualvalue"):t[o].elements.content?t[o].elements.content.value:t[o].elements.input.value);e.formValues.componentcategory_ID={};var n=t.componentcategory_ID.selectedItems;if(n){var a={data:[]};[n].forEach(function(e){a.data.push({id:e._options.id,type:p.CLASSIFICATION,dataelements:{"ProxyItem.Proxy_Title":e.getAttributeValue("label"),"ProxyItem.Proxy_Service":p.SOURCE_3DSPACE,"ProxyItem.Proxy_State":e.getAttributeValue("state"),"ProxyItem.Proxy_Tenant":c.controller.app.platformServices.platformId}})}),e.formValues.componentcategory_ID=a}c.controller.update(e,i)}else widget.notificationUtil.showError(c.NLS.title_empty)}}),c.propertiesModel=y;var b=new n({model:y}),N=new UWA.Class.Model({modelEvent:c.controller.app._mediator.createNewChannel(),id:e.data.respParams.id,dataProviderPromise:(new t).getLifeCycleDataProviderPromise(e),relativePath:"/resources/v1/modeler/dssourcing/sourcingrequests",callBackForExecuteCmd:function(){C.getComponentRequest({id:e.data.respParams.id,includeParams:"$include=interface-details,request-template,request-assignee,object-route,context-project,context-product,context-plant,context-user,route-templates&$fields=request-template.requestCategory"}).then(function(t){e.openCREvent.publish({event:"update-id-card-cr",data:t}),e.openSourceEvent.publish({event:"cr-updated",data:t}),c.compReqTimeline&&c.compReqTimeline.historyApplicationChannel&&c.compReqTimeline.historyApplicationChannel.publish({event:"reload-history-content",data:{}})})}});c.lifeCycleModel=N,e.lifeCycleModel=N;var E=new a({model:N}),D={},I=new UWA.Class.Model({parentOptions:e,fromInfoPanel:e.forInfo,objectId:e.data.respParams.id,options:{id:e.data.respParams.id,includeParams:"$include=specification-document,reference-document"},documentKey:["specification-document","reference-document"],contextObject:C,helper:c.helper,mediator:e._mediator,isSpecification:!0,openCREvent:e.openCREvent,modelEvent:c.controller.app._mediator.createNewChannel(),infoContainer:c.controller.app._triptychWrapper.getRightPanelContainer(),controller:c.helper.controller,isDragDropAllowed:!0,additionalHeaders:{},applicationChannel:c.controller.app._applicationChannel,triptychWrapper:c.controller.app._triptychWrapper,i18NProvider:c.controller.app.i18NProvider,processForObject:function(t){var o=t,n={sticky:!1,allowUnsafeHTML:!1,subtitle:""};if(o&&o.sourceid&&!o.sourceid.toLocaleLowerCase().contains(p.SOURCE_SOURCING)&&p.ONPREMISE!==m.getPlatformId()){let r=o["ds6w:label"]?o["ds6w:label"]:"",s=o.sourceid?o.sourceid.split(":")[0]:"",l=o.sourceid?o.sourceid.split(":")[1]:"";var a={data:[{id:o.id,type:"Document",dataelements:{"ProxyItem.Proxy_Title":r,"ProxyItem.Proxy_Service":s,"ProxyItem.Proxy_State":o["ds6w:status_value"],"ProxyItem.Proxy_Tenant":l}}]};C.getProxyObjectId({data:a}).then(function(a){let r={data:[{document_ID:a[o.id],purpose:o.purpose,source:o.source}]};e.attachDocumentData=r,C.attachDocument(e).then(function(e){D&&D.modelEvent&&(D.modelEvent.publish({event:"add-model",data:e}),n=t["ds6w:label"]?{level:"success",title:c.NLS.document_uploaded_successfully}:{level:"success",title:c.NLS.one_document_added_successfully},window.notifs.addNotif(n),i.unmask(widget.body))},function(e){n={subtitle:e.internalError?e.internalError:e.error?e.error:e,level:"error",title:c.NLS.upload_failed},window.notifs.addNotif(n),i.unmask(widget.body)})})}else{var r={data:[{document_ID:o.id,purpose:o.purpose,source:o.source}]};e.attachDocumentData=r,C.attachDocument(e).then(function(e){D&&D.modelEvent&&(D.modelEvent.publish({event:"add-model",data:e}),n=t["ds6w:label"]?{level:"success",title:c.NLS.one_document_added_successfully}:{level:"success",title:c.NLS.document_uploaded_successfully},window.notifs.addNotif(n),i.unmask(widget.body))},function(e){n={subtitle:e&&e.internalError?e.internalError:e&&e.error?e.error:"",level:"error",title:c.NLS.upload_failed},window.notifs.addNotif(n),i.unmask(widget.body)})}}});c.documentModel=I,D=new r({model:I});var P='AND NOT [ds6w:identifier]:("'+e.data.respParams.ownerIdentifier+'") AND NOT [ds6w:identifier]:("'+e.data.respParams.requestAssigneeIdentifier+'")';"Group Proxy"===e.data.respParams.requestAssigneeType&&(P='AND NOT [ds6w:identifier]:("'+e.data.respParams.ownerIdentifier+'") AND NOT [ds6w:resourceUid]:("'+e.data.respParams.assigneeUUID+'")');var T=new UWA.Class.Model({id:e.data.respParams.id,changeAccess:e.data.respParams.changeAccess,excludeQuery:P,disableContextualMenuFor:[e.data.respParams.ownerId,e.data.respParams.requestAssigneeId],mediator:c.controller.app._mediator,modelEvent:c.controller.app._mediator.createNewChannel(),infoContainer:c.controller.app._triptychWrapper.getRightPanelContainer()}),L=new s({model:T}),R={},O={},x=new UWA.Class.Model({controller:c.controller,options:{id:e.data.respParams.id},fromInfoPanel:e.forInfo,openSourceEvent:e.openSourceEvent,mediator:c.controller.app._mediator,router:c.controller.app.router,modelEvent:c.controller.app._mediator.createNewChannel(),infoContainer:c.controller.app._triptychWrapper.getRightPanelContainer(),currentObjectData:e.data.respParams,app:c.controller.app,applicationChannel:c.controller.app._applicationChannel,triptychWrapper:c.controller.app._triptychWrapper,processForObject:function(t){let i=t[0]["ds6w:label"]?t[0]["ds6w:label"]:"",o=t[0].sourceid?t[0].sourceid.split(":")[0]:"",n=t[0].sourceid?t[0].sourceid.split(":")[1]:"",a=t[0].id?t[0].id:t[0].physicalid;t[0].id=a||t[0].resourceid,t.title=i;let r=t[0]["ds6w:status_value"]?t[0]["ds6w:status_value"]:t[0]["ds6w:what/ds6w:status_displayValue"],s=t.proxyType;if(o===p.SOURCE_SOURCING||m.getPlatformId()===p.ONPREMISE)c.attachRelatedComponents(C,e,O,t);else{var l={data:[{id:t[0].id,type:s,dataelements:{"ProxyItem.Proxy_Title":i,"ProxyItem.Proxy_Service":o,"ProxyItem.Proxy_State":r,"ProxyItem.Proxy_Tenant":n}}]};C.getProxyObjectId({data:l}).then(function(i){t[0].id=i[t[0].id],c.attachRelatedComponents(C,e,O,t)})}},removeObject:function(t){var o="",n="";"requestView"===t.view?(o="detachRequestComponents",n=c.NLS.context_item_removed):"responseView"===t.view?(o="detachResposeComponents",n=c.NLS.answer_item_removed):"inprocessView"===t.view&&(o="detachInProcessComponents",n=c.NLS.in_process_item_removed),C[o](e,t).then(function(){O.modelEvent.publish({event:"add-model",data:{view:t.view}}),widget.notificationUtil.showSuccess('"'+t.title+'" '+n),i.unmask(widget.body)},function(e){widget.notificationUtil.showError(e.error?e.error:e.internalError?e.internalError:e),i.unmask(widget.body)})}});c.relatedPartModel=x,O=new l({model:x});let A=c.controller.app.typesConfigurator[e.data.respParams.actualType],U=c.controller.app.typesConfigurator[A.templateType],q=c.helper.getWorkflowPolicyByRequestCategory(e.data.respParams.requestCategoryActual,U);var V=new UWA.Class.Model({service:c.controller.app.platformServices.sourcing,id:e.data.respParams.id,policy:q,modifiedDate:e.data.respParams.modified,securityContext:u.getSecurityContext(),refreshCallback:function(){C.getComponentRequest({id:e.data.respParams.id,includeParams:"$include=interface-details,request-template,route-templates,request-assignee,object-route,context-project,context-product,context-plant,context-user&$fields=request-template.requestCategoryr,request-template.route-templates"}).then(function(t){e.openCREvent.publish({event:"update-id-card-cr",data:t})})}}),M=new d({model:V}),F=UWA.createElement("div",{styles:{height:"100%",width:"100%"}});let X=c.NLS.access_for?c.NLS.access_for:"Access for",j=c.NLS.is_shared_with_user?c.NLS.is_shared_with_user:"is shared with user",k=c.NLS.is_assigned_to_user?c.NLS.is_assigned_to_user:"is assigned to user",W=c.NLS.is_shared_with_user_group?c.NLS.is_shared_with_user_group:"is shared with user group",B=c.NLS.is_assigned_to_user_group?c.NLS.is_assigned_to_user_group:"is assigned to user group";var H=c.compReqTimeline=new h({physicalId:e.data.respParams.id,objectTitle:e.data.respParams.title,historyContainer:F,activityMappingObject:{connect:{"Sharing Access":function(e){return-1!==e.type.indexOf("Group")?X+" {contextTitle} "+W+" {title}":X+" {contextTitle} "+j+" {title}"},"SRC Request Assignee":function(e){return-1!==e.type.indexOf("Group")?"{contextTitle} "+B+" {title}":"{contextTitle} "+k+" {title}"}}}});let Y=[],Q=[];[Y,Q]=c.getCustomTabs(A),R.showTabView=!0,R.tabConfiguration=[{label:c.NLS.properties,content:b.render(),index:"1",value:"properties",isSelected:!0,icon:{iconName:"attributes",fontIconFamily:1},events:{click:function(){},change:function(){}}}],e.forInfo&&R.tabConfiguration.push(...Q,{label:c.NLS.attachments,content:D.render(),index:"2",value:"document",reload:!0,view:D,icon:{iconName:"attach",fontIconFamily:1},events:{click:function(){S&&S.style.removeProperty("display")},change:function(){}}},{label:c.NLS.members,content:L.render(),index:"3",value:"access",icon:{iconName:"users",fontIconFamily:1},events:{click:function(){},change:function(){}}},{label:m.getPlatformId()===p.ONPREMISE?c.NLS.relations:c.NLS.relatedObjects,content:v.prototype.getRelationsTabContainer(e),index:"4",value:"relationsDiv",icon:{iconName:"object-related",fontIconFamily:1},events:{click:function(){}}},{label:c.NLS.activity,content:F,index:"5",value:"activity",icon:{iconName:"clock",fontIconFamily:1},reload:!0,view:H,events:{click:function(){}}},{label:c.NLS.comments,content:v.prototype.get3DCommentsContainer.call(c,e),index:"6",reload:!0,view:c.commentsView,value:"commentsDiv",icon:{iconName:"comment",fontIconFamily:1}}),e.forInfo||R.tabConfiguration.push(...Y,{label:c.NLS.related_components,content:O.render(),index:"3",reload:!0,view:O,value:"relatedParts",icon:{iconName:"object-related",fontIconFamily:1},events:{click:function(){S&&S.style.removeProperty("display")},change:function(){}}},{label:c.NLS.approval_Workflow,content:M.render(),index:"5",value:"approvalWorkflow",icon:{iconName:"task",fontIconFamily:1},reload:!0,view:M,events:{click:function(){},change:function(){}}}),R.tabConfiguration.sort((e,t)=>e.index>t.index?1:e.index<t.index?-1:void 0);var z=e.data.respParams.maturityState,G="FALSE",$=e.data.respParams.maturityState===p.STATE_IN_DRAFT||e.data.respParams.maturityState===p.STATE_COMPLETED;"TRUE"===e.data.respParams.isRequestAssignee&&(G=$);var K="FALSE";"TRUE"===e.data.respParams.isOwner&&(K=$);var J=!c.helper.isDueDateExceeded(e.data.respParams.dueDate,e.data.respParams.isOwner),Z=new f({infoAttributes:[{name:c.NLS.submitted_date,value:g.getDateStringForDisplay(e.data.respParams.submitted,{weekdayShort:!0})},{name:c.NLS.due_date,value:e.data.respParams.dueDateDisplay?g.getDateStringForDisplay(e.data.respParams.dueDateDisplay,{weekdayShort:!0,removeTime:!0}):""}]}),ee=[{name:c.NLS.maturity_state,value:"",id:"maturityState",type:"type-text",editable:!0,displayWhenMinified:!0},{name:c.NLS.status,value:e.data.respParams.statusAttributeDisplay,displayWhenMinified:!0},{name:c.NLS.submitted_by,value:e.data.respParams.owner,displayWhenMinified:!0},{name:c.NLS.name,value:e.data.respParams.name},{name:c.NLS.template,value:e.data.respParams.requestTemplate},{name:c.NLS.assigned_to,value:e.data.respParams.requestAssignee}];R.idCardDetails={name:e.data.respParams.title,thumbnail:e.data.respParams.image?require.toUrl(e.data.respParams.image):"",additionalInfomation:[Z],dropdown:{items:[{text:c.NLS.maturity_state,name:p.MATURITY_STATE,fonticon:"collaborative-lifecycle-management"},{text:c.NLS.submit,name:p.SUBMIT,fonticon:"send",disabled:!(e.data.respParams.maturityState===p.STATE_IN_DRAFT)},{text:c.NLS.approve,name:p.APPROVE,fonticon:"thumbs-up",disabled:!c.helper.enableApproveCommand(e.data.respParams.maturityState,e.data.respParams.modifyAccess)},{text:c.NLS.reject,name:p.REJECT,fonticon:"thumbs-down",disabled:G},{text:c.NLS.cancel,name:p.CANCEL,fonticon:"block",disabled:K},{text:c.NLS.notify,name:p.NOTIFY,fonticon:"bell",disabled:J}],events:{onClick:function(i,o){o.name===p.MATURITY_STATE?E.render():o.name===p.SUBMIT?z===p.STATE_IN_DRAFT?c.controller.submitComponent({submitId:e.data.respParams.id,title:e.data.respParams.title,type:e.data.respParams.type}).then(function(i){z=i.results[0].current,ee[0].value=c.NLS[i.results[0].current.toLowerCase()];var o=te.mIDCardContainer;o._idCard.model.unset("attributes"),o._idCard.model.set("attributes",ee),N.unset("dataProviderPromise"),N.set("dataProviderPromise",(new t).getLifeCycleDataProviderPromise(e)),E.currentValue=i.results[0].current,C.getComponentRequest({id:e.data.respParams.id,includeParams:"$include=interface-details,request-assignee,request-template,object-route,context-project,context-product,context-plant,context-user"}).then(function(t){e.openCREvent.publish({event:"update-id-card-cr",data:t}),c.compReqTimeline&&c.compReqTimeline.historyApplicationChannel&&c.compReqTimeline.historyApplicationChannel.publish({event:"reload-history-content",data:{}})})}):widget.notificationUtil.showError(c.NLS.not_in_indraft_state):o.name===p.REJECT||o.name===p.CANCEL?z!==p.STATE_IN_DRAFT&&z!==p.STATE_COMPLETED?c.controller.actionHandler(e,e.data.title,o.text,o.name).then(function(i){var o=i.data[0].state;N.unset("dataProviderPromise"),N.set("dataProviderPromise",(new t).getLifeCycleDataProviderPromise(e)),E.currentValue=o,c.compReqTimeline&&c.compReqTimeline.historyApplicationChannel&&c.compReqTimeline.historyApplicationChannel.publish({event:"reload-history-content",data:{}})}):widget.notificationUtil.showError(z===p.STATE_IN_DRAFT?c.NLS.not_in_inDraft_state:c.NLS.not_in_completed_state):o.name===p.APPROVE?c.controller.actionHandler(e,e.data.title,o.text,o.name).then(function(i){var o=i.data[0].state;N.unset("dataProviderPromise"),N.set("dataProviderPromise",(new t).getLifeCycleDataProviderPromise(e)),E.currentValue=o,c.compReqTimeline&&c.compReqTimeline.historyApplicationChannel&&c.compReqTimeline.historyApplicationChannel.publish({event:"reload-history-content",data:{}})}):o.name===p.NOTIFY?c.controller.notifyPastDueDate(e):o.name===p.SUBMIT_CLARIFICATION?c.controller.actionHandler(e,e.data.title,o.text,o.name).then(function(){}):o.name===p.STATE_NEED_FOR_CLARIFICATION&&c.controller.actionHandler(e,e.data.title,o.text,o.name).then(function(){})}}},attributes:ee},R=c.controller.helper.updateNeedForClarrificationMenu(R,z,e.data.respParams.isRequestAssignee,e.data.respParams.modifyAccess,e.data.respParams.isOwner,!0),e.detailsViewOptions=R,e.callback=function(){i.unmask(widget.body)};var te=new o;te.init(e),c.detailsView=te,c.assignRequestAssigneeFromGroup(te.mIDCardContainer),e.openCREvent.subscribe({event:"update-id-card-cr"},function(i){c.controller.getRequestCategory(e).then(function(o){var n=c.helper.processRequestCategoryNLS(i,o),a=c.helper.processData({data:n.data[0],definitions:n.definitions});z=a.grid.maturityState;var r=te.mIDCardContainer;G="FALSE",$=z===p.STATE_IN_DRAFT||z===p.STATE_COMPLETED,"TRUE"===a.grid.isRequestAssignee&&(G=$),K="FALSE","TRUE"===a.grid.isOwner&&(K=$),J=!c.helper.isDueDateExceeded(a.grid.dueDate,a.grid.isOwner),r._idCard.model.set("name",a.grid.title),te.updateWidgetObject.updateTitle(a.grid.title?a.grid.title:a.grid.name);var s=new f({infoAttributes:[{name:c.NLS.submitted_date,value:g.getDateStringForDisplay(a.grid.submitted,{weekdayShort:!0})},{name:c.NLS.due_date,value:a.grid.dueDateDisplay?g.getDateStringForDisplay(a.grid.dueDateDisplay,{weekdayShort:!0,removeTime:!0}):""}]});c.attributeMap=[{name:c.NLS.maturity_state,value:"",id:"maturityState",type:"type-text",editable:!0,displayWhenMinified:!0},{name:c.NLS.status,value:a.grid.statusAttributeDisplay},{name:c.NLS.submitted_by,value:a.grid.owner},{name:c.NLS.name,value:a.grid.name,displayWhenMinified:!0},{name:c.NLS.template,value:e.data.respParams.requestTemplate},{name:c.NLS.assigned_to,value:a.grid.requestAssignee}],ee=c.attributeMap;var l={items:[{text:c.NLS.maturity_state,name:p.MATURITY_STATE,fonticon:"collaborative-lifecycle-management"},{text:c.NLS.submit,name:p.SUBMIT,fonticon:"send",disabled:!(a.grid.maturityState===p.STATE_IN_DRAFT)},{text:c.NLS.approve,name:p.APPROVE,fonticon:"thumbs-up",disabled:!c.helper.enableApproveCommand(a.grid.maturityState,a.grid.modifyAccess)},{text:c.NLS.reject,name:p.REJECT,fonticon:"thumbs-down",disabled:G},{text:c.NLS.cancel,name:p.CANCEL,fonticon:"block",disabled:K},{text:c.NLS.notify,name:p.NOTIFY,fonticon:"bell",disabled:J}],events:{onClick:function(i,o){o.name===p.MATURITY_STATE?E.render():o.name===p.SUBMIT?z===p.STATE_IN_DRAFT?c.controller.submitComponent({submitId:e.data.respParams.id,title:e.data.respParams.title,type:e.data.respParams.type}).then(function(i){z=i.results[0].current,ee[0].value=c.NLS[i.results[0].current.toLowerCase()],r._idCard.model.unset("attributes"),r._idCard.model.set("attributes",ee),N.unset("dataProviderPromise"),N.set("dataProviderPromise",(new t).getLifeCycleDataProviderPromise(e)),E.currentValue=i.results[0].current,C.getComponentRequest({id:e.data.respParams.id,includeParams:"$include=interface-details,request-template,object-route,context-project,context-product,context-plant,context-user"}).then(function(t){e.openCREvent.publish({event:"update-id-card-cr",data:t}),c.compReqTimeline&&c.compReqTimeline.historyApplicationChannel&&c.compReqTimeline.historyApplicationChannel.publish({event:"reload-history-content",data:{}})})}):widget.notificationUtil.showError(c.NLS.not_in_indraft_state):o.name===p.REJECT||o.name===p.CANCEL?z!==p.STATE_IN_DRAFT&&z!==p.STATE_COMPLETED?c.controller.actionHandler(e,a.grid.title,o.text,o.name).then(function(i){var o=i.data[0].state;N.unset("dataProviderPromise"),N.set("dataProviderPromise",(new t).getLifeCycleDataProviderPromise(e)),E.currentValue=o,c.compReqTimeline&&c.compReqTimeline.historyApplicationChannel&&c.compReqTimeline.historyApplicationChannel.publish({event:"reload-history-content",data:{}})}):widget.notificationUtil.showError(z===p.STATE_IN_DRAFT?c.NLS.not_in_inDraft_state:c.NLS.not_in_completed_state):o.name===p.APPROVE?c.controller.actionHandler(e,a.grid.title,o.text,o.name).then(function(i){var o=i.data[0].state;N.unset("dataProviderPromise"),N.set("dataProviderPromise",(new t).getLifeCycleDataProviderPromise(e)),E.currentValue=o,c.compReqTimeline&&c.compReqTimeline.historyApplicationChannel&&c.compReqTimeline.historyApplicationChannel.publish({event:"reload-history-content",data:{}})}):o.name===p.NOTIFY?c.controller.notifyPastDueDate(e):o.name===p.SUBMIT_CLARIFICATION?c.controller.actionHandler(e,e.data.title,o.text,o.name).then(function(){}):o.name===p.STATE_NEED_FOR_CLARIFICATION&&c.controller.actionHandler(e,e.data.title,o.text,o.name).then(function(){})}}};r._idCard.model.unset("attributes"),r._idCard.model.set("attributes",c.attributeMap),te.lifeCycleView.model.unset("maturityContainer"),te.lifeCycleView.model.set("maturityContainer",r),l=c.controller.helper.updateNeedForClarrificationMenu(l,z,a.grid.isRequestAssignee,a.grid.modifyAccess,a.grid.isOwner,!1),r._idCard.model.set("dropdown",l),r._idCard.model.set("freezones",[s.render().outerHTML]),x.set("currentObjectData",a.grid);let d={};d.platformServices=c.controller.app.platformServices,d.data={respParams:a.grid};let u=c.controller.helper.getFieldsForPropertiesPage(d);y.unset("fields"),y.set({fields:u,modifyAccess:a.grid.modifyAccess}),c.options.data.respParams=a.grid,c.assignRequestAssigneeFromGroup(r),V.set({modifiedDate:a.grid.modified}),E.currentValue=z,e.updateCRList&&e.updateCRList(a)}).catch(function(){widget.notificationUtil.showError(c.NLS.failed_to_fetch_request_catgeory)})})},v.prototype.attachRelatedComponents=function(e,t,o,n){let a=this,r=n[0]["ds6w:type_value"]?n[0]["ds6w:type_value"]:n[0]["ds6w:what/ds6w:type"];r||(r=n[0]["ds6w:type"]);var s={data:[{impactedItem_ID:n[0].id,answerItem_ID:n[0].id,inProcessItem_ID:n[0].id,type:r===p.DOCUMENT||p.TYPE_QUALIFICATION_LIST.includes(r)?r:"type_"+r}]},l="",c="";"requestView"===n.view?(l="attachRequestComponents",c=a.NLS.added_impacted_item,delete s.data[0].answerItem_ID,delete s.data[0].inProcessItem_ID):"responseView"===n.view?(l="attachResponseComponents",c=a.NLS.added_answer_item,delete s.data[0].impactedItem_ID,delete s.data[0].inProcessItem_ID):"inprocessView"===n.view&&(l="attachInProcessComponents",c=a.NLS.added_in_process_item,delete s.data[0].impactedItem_ID,delete s.data[0].answerItem_ID),e[l](t,s).then(function(){o.modelEvent.publish({event:"add-model",data:{view:n.view}}),widget.notificationUtil.showSuccess('"'+n[0]["ds6w:label"]+'" '+c),i.unmask(widget.body)},function(e){widget.notificationUtil.showError(e.error?e.error:e.internalError?e.internalError:e),i.unmask(widget.body)})},v.prototype.updateFormValuesForSelectedObjectIds=function(e,t){[p.CONTEXT_PROJECT,p.CONTEXT_PRODUCT,p.CONTEXT_PLANT].forEach(i=>{e[i]&&e[i].elements.input&&e[i].elements.input.value&&e[i].elements.input.getAttribute("id")?t.formValues[i+"_ID"]=e[i].elements.input.getAttribute("id"):e[i]&&e[i].elements.input&&0===e[i].elements.input.value.length&&!e[i].elements.input.getAttribute("id")&&(t.formValues[i+"_ID"]="")})},v.prototype.get3DCommentsContainer=function(e){let t=UWA.createElement("div",{id:"commentsDiv",styles:{position:"relative"}});return t.style.height="100%",this.get3DCommentsView({options:e,container:t}),i.unmask(t),t},v.prototype.get3DCommentsView=function(e){i.mask(e.container,this.NLS.loading),this.commentsView=new S({data:{id:e.options.data.respParams.id,type:p.TYPE_COMPONENT_REQUEST,appID:"ENXNCRC_AP"}}),this.commentsView.render().inject(e.container)},v.prototype.applyExtensionCallback=function(){["home.dummyRoute","home.ComponentRequests"].includes(this.callerController.app.router._router.getState().name)&&this.callerController.list(this.callerController.options)},v.prototype.getCustomView=function(e){let t=UWA.createElement("div",{id:e.split("/").slice(-1)[0],styles:{position:"relative"}});return t.style.height="100%",i.mask(t,this.NLS.loading),require([e],function(e){new e("").render().inject(t),i.unmask(t)}),t},v.prototype.getCustomTabs=function(e){let t=this,o=[],n=[];if(e.customTabs&&e.customTabs.length>0)for(let a=0;a<e.customTabs.length;a++){let r=t.controller.app.configurator.appRoot+t.controller.app.configurator.customViewsRoot+e.customTabs[a].name,s=t.getCustomView(r),l={label:t.NLS[e.customTabs[a].nlskey],content:s,index:e.customTabs[a].index,value:e.customTabs[a].name,isSelected:!!e.customTabs[a].isSelected&&e.customTabs[a].isSelected,reload:!!e.customTabs[a].reload&&e.customTabs[a].reload,icon:{iconName:e.customTabs[a].icon,fontIconFamily:1},view:function(){i.mask(s,t.NLS.loading),require([r],function(e){let t=new e("");s.empty(),t.render().inject(s),i.unmask(s)})}};e.customTabs[a].infoPanel?n.push(l):o.push(l)}return[o,n]},v.prototype.isReassignEnabled=function(){let e=this;return!!(e.options.data.respParams.groupMembers&&e.options.data.respParams.groupMembers.length>0&&e.options.data.respParams.maturityState===p.STATE_SUBMITTED&&e.options.data.respParams.groupMembers.map(e=>e.id).includes(e.options.data.respParams.currentUser))&&(e.options.data.respParams.requestAssigneeType===p.TYPE_GROUP||e.options.data.respParams.requestAssigneeType===p.TYPE_GROUP_PROXY||e.options.data.respParams.requestAssigneeId===e.options.data.respParams.currentUser)},v.prototype.assignRequestAssigneeFromGroup=function(t){let i=this;if(i.isReassignEnabled()){let o=Array.from(t._idCardContainer.getElementsByClassName("attribute-name")).find(e=>e.innerText.contains(i.NLS.assigned_to)).parentElement,n=e.generateIcon({iconName:"chevron-down wux-ui-3ds",className:"chevron-request-assign"}).inject(o);(new C).invokeContextualMenuOnClick(n),w.addEventListener(o,{callback:function(){var e=[];return i.options.data.respParams.requestAssigneeType===p.TYPE_GROUP||i.options.data.respParams.requestAssigneeType===p.TYPE_GROUP_PROXY?e.push({type:"PushItem",title:i.NLS.assign_to_self,fonticon:{content:"wux-ui-3ds-user-change wux-ui-3ds"},action:{callback:function(){i.assignRequestToSelf()}}},{type:"PushItem",title:i.NLS.search_and_assign,fonticon:{content:"wux-ui-3ds-search wux-ui-3ds"},action:{callback:function(){i.searchAndAssignRequest()}}}):e.push({type:"PushItem",title:i.NLS.reassign,fonticon:{content:"wux-ui-3ds-search wux-ui-3ds"},action:{callback:function(){i.searchAndAssignRequest()}}}),e}})}},v.prototype.assignRequestToSelf=async function(){let e={};e["request-assignee"]={id:this.options.data.respParams.currentUser},this.controller.update({id:this.options.data.id,formValues:e,openCREvent:this.options.openCREvent})},v.prototype.searchAndAssignRequest=async function(){let e=this,t=e.options.data.respParams.groupMembers||[],i="";t.forEach(t=>{e.options.data.respParams.requestAssigneeId!==t.id&&(i+=`name:${t.name} OR `)}),e.launchA3DSearch({completePreCond:`flattenedtaxonomies:types/${p.TYPE_PERSON} AND ${i.slice(0,-4)}`})},v.prototype.launchA3DSearch=function(e){let t=this;e.callbackMethod=function(e){if(e){let i={};i["request-assignee"]={id:e[0].id},t.controller.update({id:t.options.data.id,formValues:i,openCREvent:t.options.openCREvent})}},(new y).init(e)},v.prototype.getRelationsTabContainer=function(e){let t=v.prototype.createExpanderUWADiv("relationsDiv");if(t.style.height="100%",m.getPlatformId()===p.ONPREMISE){let i={container:t,facets:["FACET_RELATIONS"],showIdCard:!1},o={objectId:e.data.params.id};new b({viewOptions:i,dataOptions:o}).render()}else this.getSRCRelatedObjectsView({options:e,relationsContainer:t});return i.unmask(t),t},v.prototype.createExpanderUWADiv=function(e){return UWA.createElement("div",{id:e,styles:{position:"relative"}})},v.prototype.getSRCRelatedObjectsView=async function(e){let t=this;await t.getDetailRelated(e),i.mask(e.relationsContainer,"loading"),_.controller.helper.processDataForRelationsTabCRA({data:e.options.data.respParams}).then(t=>{let i=new UWA.Class.Model({data:t,ctxCallback:function(e){let t=e.options.id;if(p.TYPE_COMPONENT_REQUEST.includes(e.options.grid.type)){let e={contextObjId:t,callControllerMethod:_.controller};widget.app._applicationChannel.publish({event:"information-panel-add-content",data:{openDetails:(new N).getObjectDetailsInInfoPanel(e)}}),widget.app._applicationChannel.publish({event:"information-panel-open-without-reload-content"})}else if(p.VPMREFERENCE===e.options.grid.type||p.TYPE_MODEL===e.options.grid.type||p.DELFMIFUNCTIONREFERENCE_TYPES.includes(e.options.grid.type)||p.TYPE_QUALIFICATION_LIST.includes(e.options.grid.type)||p.DOCUMENT.includes(e.options.grid.type)){(new C).propertyWidget(t,[{readOnly:"true"}])}else if(p.DSPLAN_PROJECT===e.options.grid.type){let e=encodeURIComponent(t.replace("<","").replace(">",""));window.open(m._platforms[p.SERVICE_3DDASHBOARD]+"#dashboard:/tab:/app:ENXPLAN_AP/content:ids="+e+"&tenant="+m.getPlatformId()+"&x3dPlatformId="+m.getPlatformId())}else window.open(_.controller.app.platformServices.sourcing+"/common/emxNavigator.jsp?objectId="+t)}}),o=new E({model:i});window.relatedQualificationReference&&(window.srcRelatedObjectsView=o),o.render().inject(e.relationsContainer)}).catch(function(){widget.notificationUtil.showError(t.NLS.error_loading_related_objects)}).finally(function(){i.unmask(e.relationsContainer)})},v.prototype.getDetailRelated=function(e){var i=new t,o=["$include=impacted-items,source-information","$include=answer-items","$include=inprocess-items","$include=interface-details,request-template,request-assignee,object-route,context-project,context-product,context-plant,context-user"];let n=e.options.data.respParams.id;let a=o.map(async function(e){let t=await i.getComponentRequest({id:n,includeParams:e});return t.data?t.data[0]:""});return Promise.all(a).then(function(t){var i,n,a,r;return t.forEach(function(e,t){let s=o[t];if(s.includes("impacted-items")&&(i=e["impacted-items"]),s.includes("answer-items")&&(n=e["answer-items"]),s.includes("inprocess-items")&&(a=e["inprocess-items"]),s.includes("object-route")&&e["object-route"]){for(let t=0;t<e["object-route"].length;t++)e["object-route"][t].preview_url=require.toUrl("ENOXSourcingRequest/assets/icons/route.png");r=e["object-route"]}}),e.options.data.respParams={impactedItems:i,answerItems:n,inprocessItems:a,objectRoute:r},e})},v}),define("DS/ENOXSourcingRequest/controllers/ComponentRequestController",["DS/UIKIT/Mask","DS/UIKIT/Modal","DS/TreeModel/TreeDocument","DS/ENOXSourcingRequest/models/ComponentRequest","DS/ENOXSourcingRequest/views/ComponentRequest/OpenComponentRequest","DS/ENOXSourcingRequest/views/ComponentRequest/ListComponentRequest","DS/ENOXSourcingRequest/helpers/ComponentRequestHelper","DS/ENOXSourcingUXInfra/service/ENOXSourcingPlatformServices","DS/ENOXSourcingUXInfra/Constants/ENOXSourcingConstants","DS/ENOXSourcingRequest/views/ManufacturerEquivalentItem/ShowManufacturerEquivalentItem","DS/ENOXSourcingRequest/views/Qualification/OpenQualification","DS/ENOXSourcingUXInfra/xsourcingformview/ENOXSourcingForm","DS/ENOXSourcingUXInfra/CommonUtils/CommonUtils","DS/ENOXSourcingUXInfra/InfiniteScrolling/InfiniteScrollingImpl","DS/ENOXSourcingUXInfra/Search/SearchUtility","DS/ENOXSourcingUXInfra/Utilities/HyperLinkHelper","DS/ENOXSourcingRequest/components/Wizard/RequestTypeChooser","DS/ENOXSourcingUXInfra/Utilities/Utility"],function(e,t,i,o,n,a,r,s,l,c,d,u,p,m,f,h,g,S){"use strict";var y=function(e){this.app=e.app,this.model=new o(this),this.helper=new r(this),this.hyperlinkHelper=new h,this.view=new a(this),this.openCREvent=void 0,this.searchUtil=new f,this.NLS=this.app.i18NProvider,this.commonUtility=new S};return y.prototype.list=function(t){var i=this;if(i.openCREvent=void 0,i.options=t,!(i.allCRData&&0!==i.allCRData.length&&t.isLazyLoading||!0===t.relatedItemFilter)){e.mask(widget.body,i.NLS.loading_requests),i.allCRData&&(i.allCRData.length=0),t.data=[],i.view.render(t);var o={};o.controller=i,o.view=i.view,i.infiniteScrollingImpl=new m(o)}i.model.listComponentRequests(t).then(function(e){i.getRequestCategory(t).then(function(o){var n=i.helper.processRequestCategoryNLS(e,o);i.helper.processForList(n).then(function(o){["home.dummyRoute","home.ComponentRequests"].includes(i.app.router._router.getState().name)&&(i.allCRData&&0!==i.allCRData.length||!0===t.relatedItemFilter||(t.toolbarFilters=i.helper.processToolbarFilters(e.definitions,t,i),i.view.addToolbarAction(t.toolbarFilters)),i.handleVisibilityOfPrivateUserGroup(o).then(function(e){i.addExtensionColumn(e),t.data=e,i.allCRData=i.allCRData?[...i.allCRData,...t.data]:t.data,i.view.collectionView._xsourcingCollectionViewUI._allData=i.allCRData,i.infiniteScrollingImpl.processReloadData(t.data),i.closeTagger(),e.length>0&&i.setDataForTagger(i.allCRData,i.view.xsourcingCollectionView)}))})}).catch(function(){widget.notificationUtil.showError(i.NLS.failed_to_fetch_request_catgeory)})},function(e){widget.notificationUtil.showError(e.internalError?e.internalError:i.NLS.error_while_fetching_component_request),i.app.logger.error("fileName: ComponentRequestController.js line 80 | Error: "+e)}).catch(function(e){widget.notificationUtil.showError(e.message?e.message:i.NLS.error_while_fetching_component_request),i.app.logger.error("fileName: ComponentRequestController.js line 83 | Error: "+e)}).finally(function(){e.unmask(widget.body)})},y.prototype.addExtensionColumn=function(e){let t=this,i=t.view.xsourcingCollectionView._xsourcingCollectionViewUI._columnsConfiguration,o=l.REQUEST_CATEGORIES_ACTUAL;e.forEach(function(e){e.grid.extensionDetails&&e.grid.extensionDetails.forEach(function(e){if(!o.includes(e.id)&&e.options){let o=[];if(i.some(t=>t.text===e.name)){let t=i.find(t=>t.text===e.name);o=t.children}e.options.forEach(function(e){o.find(t=>t.text===e.id)||o.push({text:e.displayName?e.displayName:e.id,dataIndex:e.id,visibleFlag:!1,minWidth:150,editableFlag:!0,...!e.range&&{typeRepresentation:t.commonUtility.getTypeRepresentationKey({type:e.type})},...e.range&&{range:e.range},...e.displayRanges&&{displayRanges:e.displayRanges},getCellEditableState:function(e){return!(!e.nodeModel.options.grid.modifyAccess||"true"!==e.nodeModel.options.grid.modifyAccess.toLowerCase())},setCellValue:function(i,o){let n=this.getColumnOrGroup(i.columnID);if(i.nodeModel.options.grid[n.dataIndex]===o)return;let a={};a[e.id]="timestamp"===e.type?p.getDateStringForDisplay(o):o,i.nodeModel.updateOptions({grid:a}),t.update({id:i.nodeModel.options.grid.id,formValues:a})},getCellSemantics:function(){if(e.range)return{possibleValues:t.commonUtility.processLabelValue(e.range,e.displayRanges)}}})}),t.view.xsourcingCollectionView._xsourcingCollectionViewUI._dataGridView.addColumnOrGroup({text:e.id,dataIndex:e.name,visibleFlag:!1,children:o})}})})},y.prototype.handleVisibilityOfPrivateUserGroup=function(e){var t=this;return new Promise(i=>{var o=e;let n=0,a="";if(o.forEach(function(e){e.grid.requestAssigneeType===l.TYPE_GROUP_PROXY&&(a+='[ds6w:resourceUid]:"<uuid:'+e.grid.assigneeUUID+'>" OR ',n++)}),n>0){var r={completePreCond:a=a.substring(0,a.length-3),nresults:n,start:"0",with_nls:!1};t.searchUtil.callFederatedSearch(t.searchUtil.getSearchPayload([],[],[l.SOURCE_USERGROUPS],r)).then(function(e){let n=t.searchUtil.processResults(e);o.forEach(function(t){t.grid.requestAssigneeType===l.TYPE_GROUP_PROXY&&(0!==e.infos.nmatches&&n.some(e=>e.resourceid==="<uuid:"+t.grid.assigneeUUID+">")?t.grid.requestAssignee=n.filter(e=>e.resourceid==="<uuid:"+t.grid.assigneeUUID+">")[0]["ds6w:label"]:t.grid.requestAssignee=l.PRIVATE_ASSIGNMENT)}),i(o)})}else i(o)})},y.prototype.openInInformationPanel=function(e){this.showDetails(e)},y.prototype.showDetails=function(t){var i=this;t.openCREvent=i.openCREvent,t.openCREvent||(t.openCREvent=i.openCREvent=i.app._mediator.createNewChannel()),e.mask(t.detailsContainer?t.detailsContainer:widget.body,i.NLS.opening_component_request),i.model.getComponentRequest({id:t.data.id?t.data.id:t.data.params.id,includeParams:"$include=interface-details,request-template,request-assignee,route-templates,object-route,context-project,context-product,context-plant,context-user,route-templates&$fields=request-template.requestCategory,request-template.title,request-template.source,request-template.sourceDisplay"}).then(function(e){i.getRequestCategory(t).then(function(o){var a=i.helper.processRequestCategoryNLS(e,o),r=i.helper.processData({data:a.data[0],definitions:a.definitions});t.data.respParams=r.grid,t.getLifecyclePayload=i.helper.buildGetLifecyclePayload(t),t.openSourceEvent=i.app._mediator.createNewChannel();var s=new n(i);i.closeTagger(),s.render(t)}).catch(function(){widget.notificationUtil.showError(i.NLS.failed_to_fetch_request_catgeory)})},function(){widget.notificationUtil.showError(i.NLS.error_getting_cr_details)}).catch(function(){widget.notificationUtil.showError(i.NLS.error_getting_cr_details)}).finally(function(){e.unmask(t.detailsContainer?t.detailsContainer:widget.body)})},y.prototype.update=function(t){var i=this;e.mask(widget.body,i.NLS.updating_component_request),t.addData=i.helper.processUpdateValues(t.formValues),t.includeParams="$include=interface-details,request-template,request-assignee,object-route,context-project,context-product,context-plant,context-user,route-templates&$fields=request-template.requestCategory,request-template.title";var o=t.formValues.componentcategory_ID;o?i.model.getProxyObjectId({data:o}).then(function(e){if(e){let i="";for(var o in e)if(e.hasOwnProperty(o)){var n=e[o];0===i.length?i=n:i+=","+n}t.formValues.componentcategory_ID=i}else t.formValues.componentcategory_ID="";i.updateComponentRequest(t)}).catch(function(e){widget.notificationUtil.showError(e.message?e.message:i.NLS.update_failed)}).finally(function(){e.unmask(widget.body)}):i.updateComponentRequest(t)},y.prototype.updateComponentRequest=function(t){let i=this;i.model.updateComponentRequest(t).then(function(e){var o=i.helper.processData({data:e.data[0],definitions:e.definitions});widget.notificationUtil.showSuccess(i.NLS.request+' "'+o.grid.title+'" '+i.NLS.updated_successfully),t.openCREvent&&t.openCREvent.publish({event:"update-id-card-cr",data:e})},function(e){let t=e.internalError?e.internalError:e.error?e.error:e.message;t&&-1!==t.indexOf("#1500745")&&-1!==t.indexOf("exceeds maximum length")&&(t=t.substring(t.lastIndexOf(": ")+2,t.length)),widget.notificationUtil.showError(t)}).catch(function(e){widget.notificationUtil.showError(e.message?e.message:i.NLS.update_failed)}).finally(function(){e.unmask(widget.body)})},y.prototype.getRTSpecificComponentClassification=async function(){let e={};return e.id=this.app.storage.requestTemplateId?this.app.storage.requestTemplateId:this.app.storage.requestTemplate_ID,(await this.model.getRequestTemplate(e)).data[0]["component-classification"]},y.prototype.getRTSpecificComponentClassificationId=async function(){return(await this.getRTSpecificComponentClassification()).map(e=>e.Proxy_Id)},y.prototype.getLibraryClassificationData=async function(){var e=this,t=new i({shouldBeSelected:function(e){return e.options.grid.type===l.CLASS},useAsyncPreExpand:!0}),o=function(e,t){e.forEach(e=>{t.push(e.id),e.ChildClasses&&o(e.ChildClasses.member,t)})};let n=await e.getRTSpecificComponentClassification();t.prepareUpdate();let a={data:[]};n.forEach(e=>{a.data.push({id:e.Proxy_Id})});let r=await this.model.getObjectInfo(a);return n.map((e,t)=>Object.assign({},e,r.data[t])).forEach(i=>{var o=e.helper.createNodeForCompCategory({label:i.title,id:i.id,icon:"library-class",type:l.CLASS,name:i.title,state:i.stateNLS});t.addRoot(o)}),t.onPreExpand(function(i){var n=i.data.nodeModel;n.hasChildren()?i.target.preExpandDone():e.model.getClasses({id:n.options.id}).then(function(n){var a=n.member[0].ChildClasses.member;t.prepareUpdate(),a.forEach(function(t){let n=[];if(t.ChildClasses?o(t.ChildClasses.member,n):o([t],n),t.state!==l.OBSOLETE&&t.state!==l.INACTIVE){var a=""!==t.title?t.title:t.name,r=e.helper.createNodeForCompCategory({label:a,id:t.id,icon:"library-class",type:l.CLASS,name:t.name,state:t.state});i.target.addChild(r)}}),t.pushUpdate()}).finally(function(){i.target.preExpandDone()})}),t.pushUpdate(),new UWA.Promise(function(e){e({elementsTree:t})})},y.prototype.delete=function(t){var i=this,o=[],n=[];t.selectedNodes.forEach(e=>{o.push({id:e.getAttributeValue("id")}),n.push(e.getAttributeValue("id"))}),t.deleteData={data:o},e.mask(widget.body,i.NLS.deleting_component_request),i.model.deleteComponentRequest(t).then(function(){t.data=t.data.filter(e=>{if(!n.includes(e.grid.id))return e}),i.setDataForTagger(t.data,t.thatObj.xsourcingCollectionView),t.selectedNodes.forEach(e=>e.getTreeDocument().removeRoot(e)),t.thatObj.xsourcingCollectionView._xsourcingCollectionViewUI._updateCount(),widget.notificationUtil.showSuccess(i.NLS.component_request_deleted_successfully,"success")},function(e){widget.notificationUtil.showError(e.internalError?e.internalError:e.error?e.error:i.NLS.error_while_deleting_component_request)}).catch(function(e){widget.notificationUtil.showError(e.error?e.error:i.NLS.error_while_deleting_component_request)}).finally(function(){i.app._applicationChannel.publish({event:"information-panel-close",data:{selectedObject:null}}),e.unmask(widget.body)})},y.prototype.submitComponent=function(t){var i,o=this;return e.mask(widget.body,o.NLS.submiting_component_request),"OnPremise"===s.getPlatformId()?(t.lifeCycleData={data:[{physicalid:t.submitId,tostate:"Submitted",fromstate:"In Draft"}]},i=o.model.performLifeCycleComponentAction(t)):(t.lifeCycleData={data:[{id:t.submitId,physicalid:t.submitId,type:t.type,identifier:t.submitId,source:"Sourcing",relativePath:"/resources/v1/modeler/dssourcing/sourcingrequests",tostate:"Submitted",fromstate:"In Draft"}]},i=o.model.performLifeCycleAction(t)),new Promise(function(n,a){i.then(function(e){if("failure"===e.status)return widget.notificationUtil.showError(e.report[0].error),void a(e);e.results&&0===e.results.length?a(e):(widget.notificationUtil.showSuccess(t.title+" "+o.NLS.comp_req_submitted_successfully),n(e))},function(e){widget.notificationUtil.showError(e.internalError?e.internalError:e.error?e.error:e.report[0].error),a(e)}).catch(function(e){widget.notificationUtil.showError(e.message?e.message:e.report[0].error),a(e)}).finally(function(){e.unmask(widget.body)})})},y.prototype.getRequestCategory=function(e){return this.model.getRequestCategory(e)},y.prototype.closeTagger=function(){this.app.taggerProxy.onCloseTagger()},y.prototype.setDataForTagger=function(e,t){var i=l.TAGGER_COMPONENT_REQUEST;this.app.taggerProxy.setTaggerProxyOpts(e,t,i)},y.prototype.onDropAction=function(e){var t=e.data;if(t.objectType){let e={};t.objectType===l.TYPE_COMPONENT_REQUEST?e.route=l.COMPONENT_REQUEST_DETAILS_ROUTE:t.objectType===l.TYPE_COMPONENT_REQUEST_TEMPLATE&&"ENOXSourcingRequest"!==this.app.logname?e.route=l.REQUEST_TEMPLATE_DETAILS_ROUTE:widget.notificationUtil.showError(this.NLS.invalid_object_dropped),e.id=t.objectId,this.app.router.navigate(e.route,e,{reload:!0}),this.app._applicationChannel.publish({event:"xsrc-destroy-drop-token",data:null})}else widget.notificationUtil.showError(this.NLS.invalid_object_dropped)},y.prototype.showMEI=function(t){var i=this;t.onComplete=function(e){var o=i.helper.processXInfraData(e);t.data.respParams=o[0],UWA.merge(t.data.params,t.data.respParams),new c(i).render(t)}.bind(i),t.onFailure=function(e){widget.notificationUtil.showError(e.error)}.bind(i),t.detailsContainer?e.mask(t.detailsContainer,i.NLS.opening_mei):e.mask(widget.body,i.NLS.opening_mei),t.id=t.data.params.id,i.model.getMEIDetails(t)},y.prototype.showQualification=function(t){var i=this;e.mask(t.detailsContainer,i.NLS.opening_qualification),t.data.params.qualificationId=t.data.params.id,i.model.getQualificationDetails(t).then(function(o){i.helper.processQualificationData(o).then(function(o){t.data.respParams=o[0].grid,new d(i).render(t),e.unmask(t.detailsContainer)})},function(e){widget.notificationUtil.showError(i.NLS.error_getting_qualification_details),i.app.logger.error(e.internalError?e.internalError:e.error)}).catch(function(e){widget.notificationUtil.showError(i.NLS.error_getting_qualification_details),i.app.logger.error(e.message?e.message:e.toString())}).finally(function(){e.unmask(t.detailsContainer)})},y.prototype.actionHandler=function(e,i,o,n){var a=this;return n===l.SUBMIT_CLARIFICATION?(e.id=e.data.params?e.data.params.id:e.id,e.formValues={},e.formValues.action=n,new Promise(function(t,i){a.submitClarification(e,n).then(function(e){200===e.statusCode?t(e):i(e)})})):new Promise(function(r,s){var c,d,m,f,h,g=UWA.createElement("div",{styles:{width:"100%",height:"fit-content",position:"relative",background:"white",overflow:"hidden"}}),S=o+" - "+i,y=!0;n===l.APPROVE?(c=a.NLS.approve_request_label,d=a.NLS.approval_comments,m=a.NLS.approve_ok_button,f=a.NLS.approve_close_button,y=!1):n===l.REJECT?(c=a.NLS.reject_request_label,d=a.NLS.reason_for_rejection,m=a.NLS.reject_ok_button,f=a.NLS.reject_close_button,h=a.NLS.please_enter_rejection_comments):n===l.STATE_NEED_FOR_CLARIFICATION?(c=a.NLS.need_for_clarification,d=a.NLS.clarification_comments,m=a.NLS.submit,f=a.NLS.cancel,h=a.NLS.please_enter_clarification_comments):n===l.CANCEL&&(c=a.NLS.cancel_request_label,d=a.NLS.reason_for_cancellation,m=a.NLS.cancel_ok_button,f=a.NLS.cancel_close_button,h=a.NLS.please_enter_cancellation_comments),a.fields=[{type:"textarea",label:c,placeholder:d,name:l.COMMENTS,required:y,errorText:h,isLengthy:!1}];var w=new u({grid:"4,8",fields:a.fields,events:{onSubmit:function(){var t;e.id=e.data.params?e.data.params.id:e.id,e.formValues={},e.formValues.action=n,n===l.REJECT?(t=l.REJECTED+" - "+w.getField(l.COMMENTS).value,e.formValues[l.SRC_CLOSURE_COMMENTS]=t):n===l.CANCEL?(t=l.CANCELLED+" - "+w.getField(l.COMMENTS).value,e.formValues[l.SRC_CLOSURE_COMMENTS]=t):n===l.STATE_NEED_FOR_CLARIFICATION?(t=w.getField(l.COMMENTS).value,e.formValues[l.SRC_COMMENTS]=t,a.sendNeedForClarification(e,n).then(function(e){200===e.statusCode?r(e):s(e)})):n===l.APPROVE&&(t=w.getField(l.COMMENTS).value,e.formValues[l.SRC_COMMENTS]=t,a.action(e,n).then(function(e){200===e.statusCode?r(e):s(e)})),n!==l.REJECT&&n!==l.CANCEL||a.action(e,n).then(function(e){200===e.statusCode?r(e):s(e)}),b.destroy()}}}).inject(g),C=UWA.createElement("span",{id:"modalButtons",class:"modal-buttons"});UWA.createElement("button",{type:"submit",name:"okModalBtn",id:"okBtn",form:"myForm",class:"btn btn-primary",text:m,value:m,events:{click:function(){w.submit()}}}).inject(C),UWA.createElement("button",{type:"reset",id:"closeModalBtn",class:"btn btn-default",text:f,value:f,events:{click:function(){b.destroy()}}}).inject(C);var b=new t({className:"create-npr-details-modal scroll",closable:!0,header:"<div>"+p.escapeHtml(S)+"</div>",body:"",footer:C,animate:!0,events:{onHide:function(){this.destroy(!0)}}}).inject(widget.body);b.show(),g.inject(b.getBody())})},y.prototype.action=function(t,i){var o,n,a=this;return e.mask(widget.body,a.NLS.updating_component_request),t.addData=a.helper.processUpdateValues(t.formValues),i===l.APPROVE?(o=a.NLS.Approved,n=l.APPROVE):i===l.REJECT?(o=a.NLS.Rejected,n=l.CLOSE):(o=a.NLS.Cancelled,n=l.CLOSE),new Promise(function(i,r){a.model[n](t).then(function(e){var n=a.helper.processData({data:e.data[0],definitions:e.definitions});widget.notificationUtil.showSuccess(a.NLS.request+' "'+n.grid.title+'" '+o),t.openCREvent&&t.openCREvent.publish({event:"update-id-card-cr",data:e}),i(e)},function(e){widget.notificationUtil.showError(e.internalError?e.internalError:e.error?e.error:e.message)}).catch(function(e){widget.notificationUtil.showError(e.message?e.message:a.NLS.update_failed),r(e)}).finally(function(){e.unmask(widget.body)})})},y.prototype.notifyPastDueDate=function(t){e.mask(widget.body,this.NLS.notify_members),t.notificationPayload=this.helper.processNotifyList(t),this.model.sendNotificationPastDueDate(t),e.unmask(widget.body)},y.prototype.sendNeedForClarification=function(t){var i=this;return e.mask(widget.body,i.NLS.updating_component_request),t.addData=i.helper.processUpdateValues(t.formValues),new Promise(function(o,n){i.model.sendNeedForClarification(t).then(function(e){widget.notificationUtil.showSuccess(i.NLS.need_clarification_success),t.openCREvent&&t.openCREvent.publish({event:"update-id-card-cr",data:e}),o(e)},function(e){widget.notificationUtil.showError(e.internalError?e.internalError:e.error?e.error:e.message)}).catch(function(e){widget.notificationUtil.showError(e.message?e.message:i.NLS.update_failed),n(e)}).finally(function(){e.unmask(widget.body)})})},y.prototype.submitClarification=function(t){var i=this;return e.mask(widget.body,i.NLS.updating_component_request),t.addData=i.helper.processUpdateValues(t.formValues),new Promise(function(o,n){i.model.submitClarification(t).then(function(e){widget.notificationUtil.showSuccess(i.NLS.submit_clarification_success),t.openCREvent&&t.openCREvent.publish({event:"update-id-card-cr",data:e}),o(e)},function(e){widget.notificationUtil.showError(e.internalError?e.internalError:e.error?e.error:e.message)}).catch(function(e){widget.notificationUtil.showError(e.message?e.message:i.NLS.update_failed),n(e)}).finally(function(){e.unmask(widget.body)})})},y.prototype.filterComponentRequests=function(e,t){e.filter=t,this.allCRData=[],this.list(e)},y.prototype.getDataAndLaunchAnswerItemCreatePage=function(e,t){var i=this;i.model.getComponentRequest({id:e,includeParams:"$include=impacted-items,specification-document,reference-document"}).then(function(e){i.helper.processInputAndDocuments(e,t),i.showRequestTypeChooser({wizardRoute:"modal.wizard.type"})})},y.prototype.showRequestTypeChooser=function(e){let t=this;t.app.dataControllers.componentRequestController.model.listRequestTemplates({}).then(i=>{let o=new UWA.Class.Model({data:i,params:e,app:t.app});new g(o).render()},function(e){widget.notificationUtil.showError(e.internalError?e.internalError:t.NLS.error_loading_wizard)}).catch(function(e){widget.notificationUtil.showError(e.message?e.message:t.NLS.error_loading_wizard)})},y.prototype.gettypeshierarchy=function(e){let t=this;return new Promise((i,o)=>{t.model.gettypeshierarchy(e).then(function(e){i(e)},function(e){o(e)}).catch(function(){widget.notificationUtil.showError(t.NLS.internal_server_error)})})},y});