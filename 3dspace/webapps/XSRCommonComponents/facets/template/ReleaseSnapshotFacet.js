define("DS/XSRCommonComponents/facets/template/ReleaseSnapshotFacet",["DS/ENONewWidget/ENONew/View/Facet/ENONewFacetBase","DS/XSRCommonComponents/facets/template/ReleaseSnapshotFacetView","DS/XSRCommonComponents/utils/XInfraRequestUtil","UWA/Class/Options","UWA/Class/Events","css!DS/XSRCommonComponents/facets/template/template.css"],function(e,t,n,o,i){"use strict";return e.extend(o,i,{name:"releaseSnapshotFacet",securityContext:null,init:function(e){var n=this;this._parent(e),this.elements.container=UWA.createElement("div",{class:"xsr-plmnew-mastercontainer",id:"ReleaseSnapshot"}),this.listenToPublishedInfo(function(e,t){if("currentSecurityContext"===e){let e=t.value;n.securityContext=e}else if("currentObjectType"===e){let e=t.value;n.templateView.loadTemplate(e)}});var o=function(){};setTimeout(function(){var i=n.fetchInfo("currentObjectType")?n.fetchInfo("currentObjectType").value:e.type;n.securityContext=n.fetchInfo("currentSecurityContext")?n.fetchInfo("currentSecurityContext").value:e.securityContext,n.templateView=new t({type:i,onViewChange:o}),n.templateView.build().inject(n.elements.container)},0)},getUI:function(e){return this.elements.container},plmNewContextProvider(){return this.securityContext},postCreation(e){let t=e[0].identifier,n=this.templateView.getSelectedTemplate();if(t&&n)return this.createSpecReport(t,n)},createSpecReport(e,t){var o={data:{itemPid:e,template:t}},i=new n({id:"SpecificationReport",securityContext:this.plmNewContextProvider()});return new Promise(function(e,t){i.create(o).then(function(t){e({name:"releaseSnapshotFacet"})}).catch(function(t){var n={errors:[{errorCode:"ENONEW_FACETS_POSTCREATION",errorMessages:t.message}]};e(n)})})},destroy(){this.options.onDestroyCallback&&this.options.onDestroyCallback(this.options.tabId),this._parent()}})});