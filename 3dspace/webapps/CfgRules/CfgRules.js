define("DS/CfgRules/scripts/CfgRuleUtility",["DS/WAFData/WAFData"],function(e){"use strict";var t={createRule:function(e,n,i,a){var s=t.getHostUrl()+"/resources/modeler/model/pid:"+n+"/configurationrule";t.makeWebServiceCall(s,"POST","application/json",e,i,a)},getHostUrl:function(){var e=location.pathname.substring(0,location.pathname.indexOf("/",1));return(window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"")).concat(e)},updateRuleExpression:function(e,n,i,a,s,l,r){var o={};o.version=n,o.configurationRule={},o.configurationRule.attributes={},o.configurationRule.attributes.LayoutData={},o.configurationRule.attributes.LayoutData=i,o.configurationRule.mathematicalExpression=a,"undefined"!=r&&null!==r&&(o.cloneSharedRuleForObj=r),o=JSON.stringify(o);var d=t.getHostUrl()+"/resources/modeler/configurationrule/pid:"+e;t.makeWebServiceCall(d,"PUT","application/json",o,s,l)},getRule:function(e,n,i){var a=t.getHostUrl()+"/resources/modeler/configurationrule/pid:"+e+"?attributes=1";t.makeWebServiceCall(a,"GET","application/json","",n,i)},hasClass:function(e,t){return(" "+e.className+" ").indexOf(" "+t+" ")>-1},makeWebServiceCall:function(t,n,i,a,s,l,r){var o=(new Date).getTime();t=-1===t.indexOf("?")?t+"?timestamp="+o:t+"&timestamp="+o,r=void 0===r||r;var d={};d.method=n,d.async=r,d.timeout=6e4,d.type=i,d.headers={Accept:i,"Content-Type":i},d.data=a,d.onComplete=s,d.onFailure=l,e.handleRequest(t,d)}};return t}),define("DS/CfgRules/scripts/dictionaryCfgUtils",["DS/UIKIT/Mask"],function(e){"use strict";var t={generateFeaturesOfTypeFromJsonMatrixRules:function(e,n,i){if(null===e)return[];var a,s=0,l=[],r=[];for("driving"===i?l=e.drivingFeatures:"constrained"===i&&(l=e.constrainedFeatures),s=0;s<l.length;s+=1)a=l[s].id,r.push(t.getFeatureInDicoWithLogicalId(a,n));return r},getFeatureInDicoWithId:function(e,t){var n=0;for(n=0;n<t.features.length;n+=1)if(t.features[n].id===e)return t.features[n];return null},getFeatureIndexInListWithId:function(e,t){var n=0;for(n=0;n<t.length;n+=1)if(t[n].id===e)return n;return-1},isOptionFromFeature:function(e,t,n){var i=0,a=0;for(i=0;i<n.features.length&&n.features[i].id!==e;i+=1);if(i>=n.features.length)return!1;for(a=0;a<n.features[i].options.length;a+=1)if(n.features[i].options[a].id===t)return!0;return!1},getOptionFromId:function(e,t){var n=t.features,i=0,a=0;for(i=0;i<n.length;i+=1)for(a=0;a<n[i].options.length;a+=1)if(n[i].options[a].id===e)return n[i].options[a];return null},getFeatureInDicoWithLogicalId:function(e,t){var n=0;for(n=0;n<t.features.length;n+=1)if(t.features[n].logicalId===e)return t.features[n];return null},getNbOptionsForFeatureLogicalId:function(e,t){var n=0;for(n=0;n<t.length;n+=1)if(t[n].logicalId===e||t[n].id===e)return t[n].options.length;return-1},getFeatureIndexInListWithLogicalId:function(e,t){var n=0;for(n=0;n<t.length;n+=1)if(t[n].logicalId===e||t[n].id===e)return n;return-1},removeFeatureInListWithLogicalId:function(e,n){var i=t.getFeatureIndexInListWithLogicalId(e,n);return-1!==i?(n.splice(i,1),0):-1},getFeatureFromOptionLogicalId:function(e,n){var i=0,a=n.features;for(i=0;i<a.length;i+=1)if(t.isOptionLogicalIdFromLogicalFeature(e,a[i].logicalId,n))return a[i];return null},isOptionLogicalIdFromLogicalFeature:function(e,t,n){var i=0,a=0;for(i=0;i<n.features.length&&n.features[i].logicalId!==t;i+=1);if(i>=n.features.length)return!1;for(a=0;a<n.features[i].options.length;a+=1)if(n.features[i].options[a].parentRelLogicalId===e)return!0;return!1},getOptionFromParentRelLogicaId:function(e,t){var n=t.features,i=0,a=0;for(i=0;i<n.length;i+=1)for(a=0;a<n[i].options.length;a+=1)if(n[i].options[a].parentRelLogicalId===e)return n[i].options[a];return null},hasClass:function(e,t){return(" "+e.className+" ").indexOf(" "+t+" ")>-1},maskContainer:function(t){UWA.extendElement(t),e.mask(t)},unmaskContainer:function(t){UWA.extendElement(t),e.unmask(t)},getRuleFromId:function(e,t){var n=0,i=e.substring(0,32);if(!t.rules)return null;for(n=0;n<t.rules.length;n+=1)if(t.rules[n].id===i)return t.rules[n];return null},areCriteriaOfCombinationsInDico:function(e,n){var i={_rc:0,_listIds:[]},a=0;for(a=0;a<e.combinationOptions.length;a+=1)null==t.getOptionFromParentRelLogicaId(e.combinationOptions[a].id,n)&&(i._listIds.push(e.combinationOptions[a].id),i._rc=-1);return i}};return t}),define("DS/CfgRules/scripts/traceCfgUtils",["UWA/Core"],function(e){"use strict";var t={typeMessage:{CRITICAL_ERROR:5,ERROR:4,WARNING:3,INFO:2,DEBUG:1}},n=!0,i=t.typeMessage.DEBUG;t.critical_error=function(e){i<=t.typeMessage.CRITICAL_ERROR&&t.log(e,t.typeMessage.CRITICAL_ERROR)},t.error=function(e){i<=t.typeMessage.ERROR&&t.log(e,t.typeMessage.ERROR)},t.warning=function(e){i<=t.typeMessage.WARNING&&t.log(e,t.typeMessage.WARNING)},t.info=function(e){i<=t.typeMessage.INFO&&t.log(e,t.typeMessage.INFO)},t.debug=function(e){i<=t.typeMessage.DEBUG&&t.log(e,t.typeMessage.DEBUG)},t.isDebugEnabled=function(){return n},t.getLevel=function(){return i},t.setLevel=function(e){i=e,t.info("logger at level "+l(e))},t.enable=function(){t.log("enabling LOGGER",t.typeMessage.INFO),n=!0},t.disable=function(){t.log("disabling LOGGER",t.typeMessage.WARNING),n=!1},t.log=function(i,a){if(n){var l;switch(l=s(a),a){case t.typeMessage.CRITICAL_ERROR:case t.typeMessage.ERROR:case t.typeMessage.WARNING:case t.typeMessage.INFO:case t.typeMessage.DEBUG:"string"==typeof i?e.log(Date.now()+" ----- "+l+" ----- "+i):(e.log(Date.now()+" ----- "+l+" ----- "),e.log(i))}}};var a=[];t.getListMessages=function(){return a},t.setListMessages=function(e){a=e},t.pushMessage=function(e){a.push(e)},t.logDebugPurpose=function(e,n){t.log(e,n);var i=" ----- "+s(n)+" ----- "+e;t.pushMessage(i)},t.saveTraces=function(e){};var s=function(e){var n="";switch(e){case t.typeMessage.CRITICAL_ERROR:n="CRIT_ERROR";break;case t.typeMessage.ERROR:n="  ERROR   ";break;case t.typeMessage.WARNING:n="  WARNING ";break;case t.typeMessage.INFO:n="  INFO    ";break;case t.typeMessage.DEBUG:n="  DEBUG   "}return n},l=function(e){var n="";switch(e){case t.typeMessage.CRITICAL_ERROR:n="CRITICAL_ERROR";break;case t.typeMessage.ERROR:n="ERROR";break;case t.typeMessage.WARNING:n="WARNING";break;case t.typeMessage.INFO:n="INFO";break;case t.typeMessage.DEBUG:n="DEBUG"}return n};return t}),define("DS/CfgRules/scripts/generateCfgMatrixRulesExpression",["DS/CfgRules/scripts/dictionaryCfgUtils"],function(e){"use strict";var t={generateBCR:function(e,n,i){var a={};a.rightExpression=t.generateRightExpression(e,n,i),a.defaultExpression=t.generateDefaultExpression(e,n);var s={};s.version=e.version,s.defaultExpression=a.defaultExpression,s.expression=a.rightExpression;var l=JSON.stringify(s);return a.fullExpression="MREV1:"+l,a},generateDefaultExpression:function(e,t){var i="",a="",s=0;for(s=0;s<e.drivingCombinations.length&&""===(i=n(s,e,t));s++);for(s+=1;s<e.drivingCombinations.length;s++)""!==(a=n(s,e,t))&&(i=i+" ; "+a);return i}},n=function(e,t,n){var a=[],s="",l=0;for(l=0;l<t.constrainedCombinations.length;l++)"D"===t.states.charAt(e+l*t.drivingCombinations.length)&&a.push(t.constrainedCombinations[l].combinationOptions[0].id);for(0!==a.length&&(s=a[0]),l=1;l<a.length;l++)s=s+" , "+a[l];return""!==s&&(s="DEFAULT ( "+(s="( "+s+" )")+" , ( "+i(t.drivingCombinations[e])+" ) )"),s};t.generateRightExpression=function(e,t,n){var r="",o=0,d="",c="",u="";if(0===e.drivingCombinations.length||0===e.constrainedCombinations.length)return"";for(o=0;o<e.drivingCombinations.length;o++)if(c=i(e.drivingCombinations[o]),u=n?a(o,e,t):s(o,e,t),""!==(d=l(c,u))){r="( "+d+" )";break}for(o+=1;o<e.drivingCombinations.length;o++)c=i(e.drivingCombinations[o]),u=n?a(o,e,t):s(o,e,t),""!==(d=l(c,u))&&(r=r+" AND ( "+d+" )");return r};var i=function(e){var t="",n=0;if(0===e.combinationOptions.length)return"";for(t=e.combinationOptions[0].id,n=1;n<e.combinationOptions.length;n++)t=t+" AND "+e.combinationOptions[n].id;return t},a=function(e,t,n){var i="",a=t.states,s=0,l="";for(s=0;s<t.constrainedCombinations.length;s++)"N"===a.charAt(e+s*t.drivingCombinations.length)&&(l=t.constrainedCombinations[s].combinationOptions[0].id,i=""===i?"NOT ( "+l+" )":"NOT ( "+l+" ) AND "+i);return i},s=function(t,n,i){var a=[],s="",l=n.states,r="",o=0,d=0,c="",u="";for(d=0;d<n.constrainedFeatures.length;d++){for(r="",a=[],u=n.constrainedFeatures[d].id,!1,o=0;o<n.constrainedCombinations.length;o++)c=n.constrainedCombinations[o].combinationOptions[0].id,e.isOptionFromFeature(u,c,i)&&("N"!==l.charAt(t+o*n.drivingCombinations.length)?a.push(n.constrainedCombinations[o].combinationOptions[0].id):!0);if(0!==a.length){for(r=a[0],o=1;o<a.length;o++)r=r+" OR "+a[o];""!==r&&(r=r+" OR NOT ( "+u+" )",s=""===s?r:"( "+s+" ) AND ( "+r+" )")}else s=""===s?"NOT ( "+u+" )":"( "+s+" ) AND ( NOT ( "+u+" ) )"}return s},l=function(e,t){return""===e||""===t?"":"NOT ( "+e+" ) OR ( "+t+" )"};return t}),define("DS/CfgRules/scripts/CfgMatrixRulesWebServices",["UWA/Core","UWA/Data","UWA/Drivers/Alone","UWA/Element","DS/UIKIT/Mask","DS/CfgRules/scripts/traceCfgUtils","i18n!DS/CfgRules/assets/nls/MatrixRule"],function(e,t,n,i,a,s,l){"use strict";var r={getDictionary:function(e,t,n,i){var a=o()+"/resources/modeler/model/pid:"+e+"/configurationdictionary";a+="?features=1",a+="&image=1",a+="&attributes=1",a+="&Rules=1",i&&(a+="&solver=1"),a+="&version=1.1",a+="&random="+Math.random(),s.info("url to retrieve Dictionary and Solver : "+a),UWA.Data.request(a,{method:"POST",type:"application/ds-json",async:!0,timeout:12e4,processData:!1,onComplete:function(e){t(e,n)},data:{evolutionCriteria:i},onFailure:function(e){t(e,"error"),s.log("failed while getting computeAnswer result ="+e)}})},getObjectIDFromURL:function(e){var t=window.location.search.substring(1),n="&",i=t.split(n);i.length<=1&&(n="%26",i=t.split(n));for(var a=0;a<i.length;a+=1){var l=i[a].split("=");if(l[0]===e)return s.debug(e+" : "+l[1]),decodeURIComponent(l[1])}return null},saveRule:function(e,t,n,i,a){var s=null;s=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject(Microsoft.XMLHTTP);var l=o()+"/resources/modeler/configurationrule/pid:"+e;s.open("PUT",l,!1);var r={};return r.version=t,r.configurationRule={},r.configurationRule.attributes={},r.configurationRule.attributes.LayoutData={},r.configurationRule.attributes.LayoutData=n,r.configurationRule.mathematicalExpression=i,"undefined"!=a&&null!==a&&(r.cloneSharedRuleForObj=a),r=JSON.stringify(r),s.setRequestHeader("Content-Type","application/ds-json"),s.send(r),200===s.status&&4===s.readyState?s.responseText:null}},o=function(){var e=location.pathname.substring(0,location.pathname.indexOf("/",1));return(window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"")).concat(e)};r.createRule=function(e,t){var n=o()+"/resources/modeler/model/pid:"+t+"/configurationrule",i=c(n,e,"application/ds-json");return null!==i?i.configurationRule.id:null},r.getRule=function(e){var t=o()+"/resources/modeler/configurationrule/pid:"+e+"?attributes=1&random="+Math.random();return d(t)};var d=function(e){var t;return(t=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject(Microsoft.XMLHTTP)).open("GET",e,!1),t.send(null),t.responseText};r.releaseSolver=function(e){var t=o()+"/resources/cfg/configurator/solver/release";UWA.Data.request(t,{method:"POST",type:null,timeout:5e3,aysnc:!1,onComplete:function(e){s.info("SolverNode Released")},onFailure:function(e){s.error("Failed in Releasing Solver")},data:{solverKey:e}})},r.setRuleActivationOnSolver=function(e,t,n){var i=o()+"/resources/cfg/configurator/solver/computeAnswer",a={solverId:n,selectedCriteria:{_from:"matrixRuleWebApp",_to:"solverRule",_data:{ruleId:e,ruleActivation:t},_request:"ruleActivation"}};UWA.Data.request(i,{method:"POST",type:"application/ds-json",async:!1,timeout:6e4,onComplete:function(e){},onFailure:function(e){s.log("failed while getting computeAnswer result ="+e)},data:{solverId:a.solverId,selectedCriteria:JSON.stringify(a.selectedCriteria).replace(/pid:/g,"")}})},r.checkRulesConsistency=function(e,t){var n=o()+"/resources/cfg/configurator/solver/computeAnswer",i=null;return UWA.Data.request(n,{method:"POST",type:"text/html",async:!1,timeout:6e4,onComplete:function(e){return console.log(e),i=e,e},onFailure:function(e){return console.log("failed while getting computeAnswer result ="+e),i=-1,-1},data:{solverId:t,selectedCriteria:e}}),i},r.activateSolverTraces=function(e,t,n){var i=o()+"/resources/cfg/configurator/solver/computeAnswer",a={_from:"matrixRuleWebApp",_to:"solver",_request:"tracesActivation",_data:{activation:e?"yes":"no",path:t,level:"messages"}};UWA.Data.request(i,{method:"POST",type:"application/ds-json",async:!1,timeout:6e4,onComplete:function(e){},onFailure:function(e){s.error("failed while getting computeAnswer result ="+e)},data:{solverId:n,selectedCriteria:JSON.stringify(a)}})},r.combiSolverOk2=function(e,t,n,i,a,l){var r,d=o()+"/resources/cfg/configurator/solver/computeAnswer",c={};s.debug("Calling ComputeAnswer to abort solve"),r={solverId:t.solverId,selectedCriteria:{_from:t.selectedCriteria._from,_to:"solver",_request:"abortRequest",_data:""}},UWA.Data.request(d,{method:"POST",type:"application/ds-json",async:!1,timeout:3e5,onComplete:function(e){s.debug("Aborting the SOLVE")},onFailure:function(e){s.error("failed while trying to abort the solver")},data:{solverId:r.solverId,selectedCriteria:JSON.stringify(r.selectedCriteria)}}),s.debug("Calling ComputeAnswer with async param = "+n),UWA.Data.request(d,{method:"POST",type:"application/ds-json",async:n,timeout:3e5,onComplete:function(t){return c=t,void 0!==(c=JSON.parse(c))._rc&&"OK"===c._rc?(null!=i&&(i.addToolTips(c._data,e),i.setReasonCalculated(!0),s.debug("current state calculation finished : "+i.getReasonCalculated())),a(c._data,l),c._data):"ABORTED"===c._rc?(a(null,"error"),s.warning("full solve aborted"),null):(a(null,"error"),s.error("SOLVE failed, returned : "),s.error(c),null)},onTimeout:function(){a(null,"error"),s.debug("isBeingComputed = "+isBeingComputed)},onFailure:function(e){a(null,"error"),s.error("failed while getting computeAnswer result = "+e)},data:{solverId:t.solverId,selectedCriteria:JSON.stringify(t.selectedCriteria).replace(/pid:/g,"")}})};var c=function(e,t,n){var i=null,a=null;return(i=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject(Microsoft.XMLHTTP)).open("POST",e,!1),i.setRequestHeader("Content-type",n),i.onreadystatechange=function(){if(4!==i.readyState||200!==i.status){var e=JSON.parse(i.responseText);return void 0!==e&&void 0!==(e=e.errorID)&&1500789===e?(alert(l.MR_NON_UNIQUE),null):(alert(l.MR_ERROR),null)}a=JSON.parse(i.responseText)},i.send(t),a};return r}),define("DS/CfgRules/scripts/selectionCfgMatrixRulesTable",["DS/CfgRules/scripts/dictionaryCfgUtils","DS/CfgRules/scripts/traceCfgUtils"],function(e,t){"use strict";var n={updateWrappedTableAndJSONFromInteraction:function(e,i,s,l){var r=n.getIdxConstrainedCombinationInJSONFromTd(e,i.getJSONObject(),s),o=n.getIdxDrivingCombinationInJSONFromTd(e,i.getJSONObject(),s)+r*i.getDrivingCombinations().length,d=e.getAttribute("idxstate");o!==parseInt(d)&&t.error("not the same index in model & in view");var c=n.updateStateFromInteraction(o,i,l);a(e,c)},getIdxConstrainedCombinationInJSONFromTd:function(t,n,i){var a=0;e.hasClass(t,"firstline")&&(a=1);var s=t.parentElement.childNodes[a].getAttribute("idOption"),l=0;for(l=0;l<n.constrainedCombinations.length;l++)if(n.constrainedCombinations[l].combinationOptions[0].id===s)return l},getIdxDrivingCombinationInJSONFromTd:function(e,t,i){var a=n.getDrivingCombinationIdsFromTd(e,i);return n.getIdxDrivingCombinationInJSONFromIds(a,t)},getDrivingCombinationIdsFromTd:function(e,t){var n=e.getAttribute("nb"),i=[],a=t.getElementsByTagName("thead")[0],s=0,l=0,r="",o=0;for(s=0;s<a.childElementCount;s++)l=a.childNodes[s].childNodes[2].getAttribute("originalcolspan"),o=Math.floor(n/l),r=a.childNodes[s].childNodes[2+o].getAttribute("idOption"),i.push(r);return i},getIdxDrivingCombinationInJSONFromIds:function(e,t){var i=0;for(i=0;i<t.drivingCombinations.length;i++)if(n.isSameCombination(e,t.drivingCombinations[i]))return i},isSameCombination:function(e,t){var n=JSON.parse(JSON.stringify(t.combinationOptions)),i=0,a=0,s=!1;if(n.length!==e.length)return!1;for(i=0;i<n.length;i++){for(s=!1,a=0;a<e.length;a++)if(e[a]==n[i].id){s=!0;break}if(!s)return!1}return!0},updateStateFromInteraction:function(t,n,i){var a=Math.floor(t/n.getDrivingCombinations().length),s=n.getConstrainedCombinations()[a].combinationOptions[0].id,l=e.getFeatureFromOptionLogicalId(s,i),r=0,o=[],d="",c="",u=0,g=l.selectionType,p=l.id;if("Multiple"===g)switch(n.getStates().charAt(t)){case"N":d="A";break;case"A":d="D";break;case"D":d="N"}else{for(u=t%n.getDrivingCombinations().length,r=0;r<n.getConstrainedCombinations().length;r++)r!==a&&(c=n.getStates().charAt(u+r*n.getDrivingCombinations().length),s=n.getConstrainedCombinations()[r].combinationOptions[0].id,e.getFeatureFromOptionLogicalId(s,i).id===p&&o.push(c));if(-1!=o.indexOf("D"))d="A"===n.getStates().charAt(t)?"N":"A";else switch(n.getStates().charAt(t)){case"N":d="A";break;case"A":d="D";break;case"D":d="N"}}return n.setStates(n.getStates().substr(0,t)+d+n.getStates().substr(t+1)),d},updateAllLineWrappedTableAndJSONFromInteraction:function(n,a,s,l,r){var o=0,d=0,c=n.getAttribute("idxconstrainedstate"),u=null,g=s.getElementsByTagName("td");for(null==c&&t.debug("updateAllLineWrappedTableAndJSONFromInteraction without no index (weird)"),c=c.split(","),o=0;o<c.length;o++)for(u=c[o],d=0;d<g.length;d++)e.hasClass(g[d],"tdth")||e.hasClass(g[d],"tdth1")||e.hasClass(g[d],"displaynone")||u===g[d].getAttribute("idxconstrainedstate")&&i(g[d],a,r)},updateAllColumnWrappedTableAndJSONFromInteraction:function(n,a,s,l,r){var o=0,d=0,c=n.getAttribute("idxdrivingstate"),u=null,g=s.getElementsByTagName("td");for(null==c&&t.debug("updateAllLineWrappedTableAndJSONFromInteraction without no index (weird)"),c=c.split(","),o=0;o<c.length;o++)for(u=c[o],d=0;d<g.length;d++)e.hasClass(g[d],"tdth")||e.hasClass(g[d],"tdth1")||u===g[d].getAttribute("idxdrivingstate")&&i(g[d],a,r)}},i=function(e,t,n){var i,s=parseInt(e.getAttribute("idxstate"));i=n,t.setStates(t.getStates().substr(0,s)+i+t.getStates().substr(s+1)),a(e,i)};n.updateStateFromLeftClickInteraction=function(e,n,i){var a=null;switch(n.getJSONObject().states[e]){case"S":case"A":case"D":a="N";break;case"N":a="A";break;default:throw t.error("char "+a+" unexpected in json.states"),new Error("char unexpected in json.states in updateStateFromLeftClickInteraction")}return n.setStates(n.getStates().substr(0,e)+a+n.getStates().substr(e+1)),a},n.updateWrappedTableAndJSONFromLeftClickInteraction=function(e,t,i,s){if("false"!==e.getAttribute("editable")){var l=parseInt(e.getAttribute("idxstate")),r=n.updateStateFromLeftClickInteraction(l,t,s);a(e,r)}},n.updateWrappedTableAndJSONFromContextMenuInteraction=function(e,t,i,s,l){if("false"!==e.getAttribute("editable")){var r=parseInt(e.getAttribute("idxstate")),o=parseInt(e.getAttribute("idxconstrainedstate")),d=parseInt(e.getAttribute("idxdrivingstate")),c=n.updateStateFromContextMenuInteraction(r,o,d,t,s,l),u=0,g=0,p=i.getElementsByTagName("td");for(u=0;u<c.length;u++)for(g=0;g<p.length;g++)if(parseInt(p[g].getAttribute("idxstate"))===c[u]){c[u]===r?a(p[g],l):a(p[g],"A");break}}};var a=function(e,n){switch(e.classList.remove("available"),e.classList.remove("default"),e.classList.remove("nonavailable"),e.classList.remove("internal_conflict"),e.classList.remove("mr_current_highlight"),n){case"S":break;case"A":e.classList.add("available");break;case"N":e.classList.add("nonavailable");break;case"D":e.classList.add("available"),e.classList.add("default");break;default:throw t.error("char "+newChar+" unexpected in interaction"),new Error("weird new char in updateStateFromContextMenuInteraction")}e.classList.remove("conflict"),e.setAttribute("conflict","false"),e.setAttribute("internal_conflict","false"),e.getAttribute("isinvalidatedext")&&"D"===n?(e.classList.add("conflict"),e.setAttribute("conflict","true")):e.getAttribute("isrequiredext")&&"N"===n&&(e.classList.add("conflict"),e.setAttribute("conflict","true"))};return n.updateStateFromContextMenuInteraction=function(n,i,a,s,l,r){var o=[],d=0,c=0;switch(r){case"S":break;case"A":s.setStates(s.getStates().substr(0,n)+"A"+s.getStates().substr(n+1));break;case"N":s.setStates(s.getStates().substr(0,n)+"N"+s.getStates().substr(n+1));break;case"D":var u=s.getJSONObject(),g=e.getFeatureFromOptionLogicalId(u.constrainedCombinations[i].combinationOptions[0].id,l);if("Single"===g.selectionType){for(d=0;d<u.constrainedCombinations.length;d++)c=d*u.drivingCombinations.length+a,g===e.getFeatureFromOptionLogicalId(u.constrainedCombinations[d].combinationOptions[0].id,l)&&"D"===u.states[c]&&(s.setStates(s.getStates().substr(0,c)+"A"+s.getStates().substr(c+1)),o.push(c));s.setStates(s.getStates().substr(0,n)+"D"+s.getStates().substr(n+1))}else s.setStates(s.getStates().substr(0,n)+"D"+s.getStates().substr(n+1));break;default:throw t.error("char "+newChar+" unexpected in interaction"),new Error("weird new char in updateStateFromContextMenuInteraction")}return o.indexOf(n)<0&&o.push(n),o},n.updateAllMatrix=function(t,n,a,s){var l=0,r=n.getElementsByTagName("td");for(l=0;l<r.length;l++)e.hasClass(r[l],"tdth")||e.hasClass(r[l],"tdth1")||i(r[l],t,s)},n}),define("DS/CfgRules/scripts/CfgMatrixRulesSettings",["DS/CfgRules/scripts/traceCfgUtils","DS/CfgRules/scripts/CfgMatrixRulesWebServices","i18n!DS/CfgRules/assets/nls/MatrixRule"],function(e,t,n){"use strict";return function(){var i=null,a=null,s=null,l=null,r=null,o=null,d=!0,c=null,u=null,g=null;this.getSolverDebugUI=function(){return d},this.setParentDiv=function(e){i=e},this.getImageButton=function(){return r},this.getConflictCheckButton=function(){return o},this.init=function(t,n,i){(s=document.createElement("div")).classList.add("MRsettingsLegend"),m(),(a=document.createElement("div")).classList.add("MRsettingsContent"),f(t,n),(d="true"===window.sessionStorage.DS_MRCookie_DebugActivated||!0===window.sessionStorage.DS_MRCookie_DebugActivated)&&((l=document.createElement("div")).classList.add("MRSolverTracesContent"),e.info("using solver traces, check settings to enable/disable it"),p(i))};var p=function(n){(u=document.createElement("input")).setAttribute("type","text"),u.setAttribute("name","path_name"),u.style.marginLeft="20px",(g=document.createElement("button")).textContent="enable traces",g.style.display="block",g.style.marginLeft="20px",c=!0,l.appendChild(u),l.appendChild(g),g.addEventListener("click",function(){t.activateSolverTraces(c,u.value,n),c?(e.info("enabling traces on solver on path : "+u.value),g.textContent="disable traces",c=!1):(e.info("disabling traces on solver"),g.textContent="enable traces",c=!0)})};this.draw=function(){i.appendChild(s),i.appendChild(a),d&&i.appendChild(l)};var f=function(e,t){var i=document.createElement("span");i.textContent=n.MR_Settings,i.style.paddingLeft="-10px",i.style.backgroundColor="white";var s=document.createElement("h1");s.style.paddingLeft="10px",s.style.marginTop="-10px",s.style.fontSize="15px",s.appendChild(i),a.appendChild(s);var l=document.createElement("div");(r=document.createElement("input")).setAttribute("type","checkbox"),r.setAttribute("name","picture"),r.style.display="inline-block",r.checked=e,e?r.setAttribute("value","true"):r.setAttribute("value","false");var d=document.createElement("p");d.style.display="inline-block",d.style.paddingLeft="5px",d.textContent=n.MR_displayPic,(o=document.createElement("input")).setAttribute("type","checkbox"),o.setAttribute("name","internalsolverenable"),o.style.display="inline-block",o.checked=t,t?o.setAttribute("value","true"):o.setAttribute("value","false");var c=document.createElement("p");c.style.display="inline-block",c.style.paddingLeft="5px",c.textContent=n.MR_CheckInternalConflicts,l.appendChild(d),l.appendChild(r),l.appendChild(document.createElement("br")),l.appendChild(c),l.appendChild(o),l.style.paddingLeft="20px",i.style.marginTop="10px",i.style.backgroundColor="white",l.appendChild(document.createElement("br")),a.appendChild(l)},m=function(){var e=document.createElement("table");e.classList.add("tableLegend");var t=document.createElement("table");t.classList.add("tableLegend");var i=document.createElement("table");i.classList.add("tableLegend");var a=document.createElement("table");a.classList.add("tableLegend");var l=document.createElement("tr"),r=document.createElement("tr"),o=document.createElement("tr");l.classList.add("MRsettingsLegend"),r.classList.add("MRsettingsLegend"),o.classList.add("MRsettingsLegend");var d=document.createElement("td"),c=document.createElement("td"),u=document.createElement("td");l.appendChild(d),r.appendChild(c),o.appendChild(u),d.appendChild(t),c.appendChild(i),u.appendChild(a);var g=document.createElement("td"),p=document.createElement("tr"),f=document.createElement("tbody");f.style.height="100%",f.style.paddingLeft="20px",f.style.paddingRight="20px";var m=document.createElement("img");m.classList.add("legendAvailable"),g.appendChild(m.cloneNode(!0)),p.appendChild(g.cloneNode(!0)),(g=document.createElement("td")).setAttribute("rowspan",2),g.textContent=n.MR_Availability,g.style.paddingLeft="3px",p.appendChild(g.cloneNode(!0)),f.appendChild(p.cloneNode(!0)),p=document.createElement("tr"),g=document.createElement("td"),(m=document.createElement("img")).classList.add("legendNonAvailable"),g.appendChild(m.cloneNode(!0)),p.appendChild(g.cloneNode(!0)),f.appendChild(p.cloneNode(!0)),t.appendChild(f.cloneNode(!0)),g=document.createElement("td"),p=document.createElement("tr"),(f=document.createElement("tbody")).style.height="100%",f.style.paddingLeft="20px",f.style.paddingRight="20px",p.appendChild(g.cloneNode(!0)),g=document.createElement("td"),(m=document.createElement("img")).setAttribute("src","assets/images/legendExternalRequirement.png"),m.classList.add("legendExternalRequirement"),g.appendChild(m.cloneNode(!0)),g.setAttribute("rowspan",2),p.appendChild(g.cloneNode(!0)),(g=document.createElement("td")).textContent=n.MR_Ext_Req,p.appendChild(g.cloneNode(!0)),f.appendChild(p.cloneNode(!0)),p=document.createElement("tr"),(g=document.createElement("td")).textContent=n.MR_local_def,p.appendChild(g.cloneNode(!0)),g=document.createElement("td"),p.appendChild(g.cloneNode(!0)),f.appendChild(p.cloneNode(!0)),i.appendChild(f.cloneNode(!0)),g=document.createElement("td"),p=document.createElement("tr"),(f=document.createElement("tbody")).style.height="100%",f.style.paddingLeft="20px",f.style.paddingRight="20px",(m=document.createElement("img")).classList.add("legendDefault"),m.setAttribute("src","assets/images/Default.png"),g.appendChild(m.cloneNode(!0)),p.appendChild(g.cloneNode(!0)),(g=document.createElement("td")).textContent=n.MR_defaultValue,p.appendChild(g.cloneNode(!0)),f.appendChild(p.cloneNode(!0)),a.appendChild(f.cloneNode(!0)),l.appendChild(d),r.appendChild(c),o.appendChild(u),e.appendChild(l),e.appendChild(r),e.appendChild(o);var h=document.createElement("span");h.textContent=n.MR_legend,h.style.paddingLeft="-10px",h.style.backgroundColor="white";var b=document.createElement("h1");b.style.paddingLeft="10px",b.style.marginTop="-10px",b.style.fontSize="15px",b.appendChild(h),s.appendChild(b),s.appendChild(e)}}}),define("DS/CfgRules/scripts/generateCfgMatrixRulesXMLExpression",["DS/CfgRules/scripts/dictionaryCfgUtils"],function(e){"use strict";var t={};t.generateFullExpression=function(e,n){var i=document.createElement("CfgRuleExpression");i.setAttribute("version","1.0.1"),i.setAttribute("xmlns:xs","http://www.w3.org/2001/XMLSchema-instance"),i.setAttribute("xmlns","urn:com:dassault_systemes:config"),i.setAttribute("xs:schemaLocation","urn:com:dassault_systemes:config CfgRuleExpression.xsd");var a=t.generateDependencies(e,n),s=t.generateExpression(e,n);return i.appendChild(a),i.appendChild(s),i},t.generateDependencies=function(e,t){var n=document.createElement("dependencies"),i=[],s=0;for(s=0;s<e.drivingFeatures.length;s++)i.push(e.drivingFeatures[s]);for(s=0;s<e.constrainedFeatures.length;s++)i.push(e.constrainedFeatures[s]);var l=null;for(s=0;s<i.length;s++)l=a(i[s].id,t),n.appendChild(l.cloneNode(!0));return n},t.generateExpression=function(e,t){var i,a=0,s=document.createElement("and"),l=document.createElement("expression");for(a=0;a<e.drivingCombinations.length;a++)""!==(i=n(a,e,t)).innerHTML&&s.appendChild(i.cloneNode(!0));return s.childElementCount>1?l.appendChild(s):1===s.childElementCount&&l.appendChild(s.firstChild),l};var n=function(e,t,n){var a=function(e,t,n){var a=document.createElement("if"),s=void 0,l=0;for(t.drivingCombinations[e].combinationOptions.length>1&&(s=document.createElement("and"),a.appendChild(s)),l=0;l<t.drivingCombinations[e].combinationOptions.length;l++){var r=i(t.drivingCombinations[e].combinationOptions[l].id,n);void 0!==s?s.appendChild(r.cloneNode(!0)):a.appendChild(r.cloneNode(!0))}return void 0!==s&&a.appendChild(s),a}(e,t,n),s=function(e,t,n){var a=document.createElement("then"),s=null,l=null,r=0,o=0,d=null,c=e,u=null;for(r=0;r<t.constrainedCombinations.length;r++)c=e+r*t.drivingCombinations.length,"N"===t.states[c]&&(o+=1);for(o>1&&(d=document.createElement("and")),r=0;r<t.constrainedCombinations.length;r++)s=document.createElement("not"),c=e+r*t.drivingCombinations.length,"N"===t.states[c]&&(u=t.constrainedCombinations[r].combinationOptions[0].id,l=i(u,n),s.appendChild(l.cloneNode(!0)),o>1?d.appendChild(s.cloneNode(!0)):a.appendChild(s.cloneNode(!0)));return o>1&&a.appendChild(d.cloneNode(!0)),a}(e,t,n),l=function(e,t,n){var a=document.createElement("default"),s=0,l=0,r=0,o=null,d=null,c=null;for(s=0;s<t.constrainedCombinations.length;s++)r=e+s*t.drivingCombinations.length,"D"===t.states[r]&&(l+=1);for(l>1&&(o=document.createElement("and")),s=0;s<t.constrainedCombinations.length;s++)if(r=e+s*t.drivingCombinations.length,"D"===t.states[r]){if(d=t.constrainedCombinations[s].combinationOptions[0].id,c=i(d,n),!(l>1)){a.appendChild(c.cloneNode(!0));break}o.appendChild(c.cloneNode(!0))}return l>1&&a.appendChild(o.cloneNode(!0)),a}(e,t,n),r=document.createElement("imply");return""===s.innerHTML&&""===l.innerHTML||(r.appendChild(a),""!==s.innerHTML&&r.appendChild(s),""!==l.innerHTML&&r.appendChild(l)),r},i=function(t,n){var i=document.createElement("feature"),a=document.createElement("option"),s=e.getFeatureFromOptionLogicalId(t,n);null!==s&&(i.setAttribute("type","type_"+s.type),i.setAttribute("name",s.name),i.setAttribute("revision",s.revision),i.setAttribute("physicalid",s.id),i.setAttribute("logicalid",s.logicalId));var l=e.getOptionFromParentRelLogicaId(t,n);return a.setAttribute("type","type_"+l.type),a.setAttribute("name",l.name),a.setAttribute("physicalid",l.id),l.parentRelId?a.setAttribute("relationphysicalid",l.parentRelId):l.parentRelPhysicalId&&a.setAttribute("relationphysicalid",l.parentRelPhysicalId),a.setAttribute("relationlogicalid",l.parentRelLogicalId),i.appendChild(a),i},a=function(t,n){var i=document.createElement("feature"),a=e.getFeatureInDicoWithLogicalId(t,n);return i.setAttribute("type","type_"+a.type),i.setAttribute("name",a.name),i.setAttribute("revision",a.revision),i.setAttribute("physicalid",a.id),i.setAttribute("logicalid",a.logicalId),i};return t}),define("DS/CfgRules/scripts/generateCfgMatrixRulesWrappedTableObj",["DS/CfgRules/scripts/dictionaryCfgUtils","DS/CfgRules/scripts/traceCfgUtils","i18n!DS/CfgRules/assets/nls/MatrixRule"],function(e,t,n){"use strict";return function(){var i=null,a=null,s=null,l=null,r=null,o=null,d=null,c=null,u=null,g=!1;this.setReasonCalculated=function(e){g=e},this.getReasonCalculated=function(){return g},this.getTopLeftTable=function(){return i},this.getTopRightTable=function(){return a},this.getBotLeftTable=function(){return s},this.getBotRightTable=function(){return l},this.getId=function(){return u},this.getTopLeftDiv=function(){return r},this.getTopRightDiv=function(){return o},this.getBotLeftDiv=function(){return d},this.getBotRightDiv=function(){return c},this.init=function(e,n){u=e,(i=document.createElement("table")).setAttribute("id",u+"-top-left-table"),i.classList.add("wrapped-table"),i.classList.add("top-left-table"),(a=document.createElement("table")).setAttribute("id",u+"-top-right-table"),a.classList.add("wrapped-table"),a.classList.add("top-right-table"),(s=document.createElement("table")).setAttribute("id",u+"-bot-left-table"),s.classList.add("wrapped-table"),s.classList.add("bot-left-table"),(l=document.createElement("table")).setAttribute("id",u+"-bot-right-table"),l.classList.add("wrapped-table"),l.classList.add("bot-right-table"),(r=document.createElement("div")).appendChild(i),r.setAttribute("id",u+"-top-left-div"),r.classList.add("top-left-div"),r.classList.add("close"),(o=document.createElement("div")).appendChild(a),o.setAttribute("id",u+"-top-right-div"),o.classList.add("top-right-div"),o.classList.add("close"),(d=document.createElement("div")).appendChild(s),d.setAttribute("id",u+"-bot-left-div"),d.classList.add("bot-left-div"),d.classList.add("close"),(navigator.userAgent&&navigator.userAgent.contains("Firefox")||navigator.userAgent.contains("Edge")||navigator.userAgent.contains("Trident"))&&d.classList.add("firefoxscroll"),(c=document.createElement("div")).appendChild(l),c.setAttribute("id",u+"-bot-right-div"),c.classList.add("bot-right-div"),c.classList.add("close"),(navigator.userAgent&&navigator.userAgent.contains("Firefox")||navigator.userAgent.contains("Edge")||navigator.userAgent.contains("Trident"))&&c.classList.add("firefoxscroll"),n||(c.classList.add("withoutpicture"),d.classList.add("withoutpicture"),o.classList.add("withoutpicture"),r.classList.add("withoutpicture")),t.debug("adding scroll event on divBotRight for "+u),c.addEventListener("scroll",function(){d.scrollTop=c.scrollTop,o.scrollLeft=c.scrollLeft}),o.addEventListener("scroll",function(){r.scrollTop=o.scrollTop,c.scrollLeft=o.scrollLeft})},this.loadTableIn=function(e){p(e),f(e),h(e),m(e)},this.generateAllTables=function(e){u=e.getTable().getAttribute("id"),p(e),f(e),h(e),m(e)},this.drawInDiv=function(e){e.appendChild(r),e.appendChild(o),e.appendChild(d),e.appendChild(c)},this.drawTopIn=function(e){e.appendChild(r),e.appendChild(o)},this.drawBotIn=function(e){e.appendChild(d),e.appendChild(c)};var p=function(e){var t,n=e.getTable().getElementsByTagName("thead")[0],a=0,s=0,l=document.createElement("tbody"),r=document.createElement("th");for(a=0;a<n.childElementCount;a+=1){for(t=document.createElement("tr"),s=0;s<=1;s+=1)r=n.childNodes[a].childNodes[s].cloneNode(!0),t.appendChild(r);l.appendChild(t)}i.appendChild(l)},f=function(e){var t,n=e.getTable().getElementsByTagName("thead")[0],i=0,s=0,l=document.createElement("tbody"),r=document.createElement("th");for(i=0;i<n.childElementCount;i+=1){for(t=document.createElement("tr"),s=2;s<n.childNodes[i].childElementCount;s+=1)r=n.childNodes[i].childNodes[s].cloneNode(!0),t.appendChild(r);l.appendChild(t)}a.appendChild(l)},m=function(t){var n,i=t.getTable().getElementsByTagName("tbody")[0],a=0,l=0,r=document.createElement("tbody"),o=document.createElement("td"),d=1;for(a=0;a<i.childElementCount;a+=1){for(n=document.createElement("tr"),d=e.hasClass(i.childNodes[a].childNodes[1],"firstline")?1:0,l=0;l<=d;l+=1)o=i.childNodes[a].childNodes[l].cloneNode(!0),n.appendChild(o);r.appendChild(n)}s.appendChild(r)},h=function(t){var n,i,a=t.getTable().getElementsByTagName("tbody")[0],s=t.getTable().getElementsByTagName("thead")[0],r=0,o=0,d=document.createElement("tbody"),c=document.createElement("td"),u=1;for(r=0;r<a.childElementCount;r+=1){for(n=document.createElement("tr"),u=e.hasClass(a.childNodes[r].childNodes[1],"firstline")?2:1,o=0;o<u;o+=1)i=a.childNodes[r].childNodes[o],c=document.createElement("td"),(c=i.cloneNode(!0)).classList.add("invisible_td"),n.appendChild(c);for(o=u;o<a.childNodes[r].childElementCount;o+=1)c=(i=a.childNodes[r].childNodes[o]).cloneNode(!0),n.appendChild(c);d.appendChild(n)}s.classList.add("invisible_header"),l.appendChild(s),l.appendChild(d)};this.addToolTips=function(i,a){var s=(new Date).getTime();t.info("adding tooltips on matrix");var r=l.getElementsByTagName("td"),o=0,d=0,c=0,u="",g=null;for(o=0;o<i.statesCausingRules.length;o+=1)if("I"===(g=i.statesValidity[o])||"R"===g||"E"===g||"T"===g)for(d=0;d<r.length;d+=1)if(r[d].getAttribute("idxstate")==o){for(u="",0===i.statesCausingRules[o].length&&(u=n.MR_UnkReason),c=0;c<i.statesCausingRules[o].length;c+=1)c>0&&(u+=", "),e.getRuleFromId(i.statesCausingRules[o][c],a)?u+=e.getRuleFromId(i.statesCausingRules[o][c],a).name:u+=i.statesCausingRules[o][c];"I"===g||"T"===g?r[d].setAttribute("title",n.MR_Invalid_Comb+u):r[d].setAttribute("title",n.MR_Req_Comb+u);break}var p=(new Date).getTime()-s;t.debug("Execution time for adding tooltips : "+p)}}}),define("DS/CfgRules/scripts/generateCfgMatrixRulesTableObj",["DS/CfgRules/scripts/dictionaryCfgUtils","DS/CfgRules/scripts/traceCfgUtils","DS/CfgRules/scripts/selectionCfgMatrixRulesTable","i18n!DS/CfgRules/assets/nls/MatrixRule"],function(e,t,n,i){"use strict";return function(){var a=null,s=null,l="assets/images/no_image.png";this.getTable=function(){return a};var r=function(e,t,n,i){var a=document.createElement("thead"),s=document.createElement("thead"),l=0,r=1,o=1;for(l=0;l<e.length;l++)o*=e[l].options.length;var c=o;for(l=e.length-1;l>=0;l--)o/=e[l].options.length,a.appendChild(d(e[l],o,r,t,i)),r*=e[l].options.length;for(a.childNodes[0].classList.add("lastline"),l=a.childElementCount-1;l>=0;l--)s.appendChild(a.childNodes[l]);return n.appendChild(s),c},o=function(e){var t=document.createElement("caption");return t.innerHTML=e,t},d=function(e,t,n,i,a){var s=document.createElement("tr"),r=document.createElement("th"),o=document.createElement("th"),d=document.createElement("th"),c=e.options.length,u=0,g=0;r.classList.add("invisible_but_hidden");var p=document.createElement("div");for(r.appendChild(p),a||r.classList.add("withoutpicture"),u=0;u<i;u++)s.appendChild(r.cloneNode(!0));if(e.displayValue.length>23){var f=e.displayValue.substring(0,10);f+="...",f+=e.displayValue.substring(e.displayValue.length-1-9)}else f=e.displayValue;var m=document.createElement("div"),h=document.createElement("img");h.classList.add("cellimage");var v=document.createElement("div");for(""===e.image||null==e.image?h.setAttribute("src",l):h.setAttribute("src",e.image),a?h.classList.remove("hidden"):h.classList.add("hidden"),v.textContent=f,v.classList.add("worldwrap_as_breakword"),m.appendChild(h),m.appendChild(v),o.appendChild(m.cloneNode(!0)),o.setAttribute("title",e.displayValue),o.setAttribute("idfeature",e.logicalId),o.classList.add("lastline"),o.classList.add("featureName"),o.classList.add("drivingFeature"),o.classList.add("draggableitem"),o.setAttribute("container","drivingFeatureContainer"),o.setAttribute("featuretype","driving"),o.setAttribute("draggable",!0),a||o.classList.add("withoutpicture"),s.appendChild(o.cloneNode(!0)),u=0;u<t;u++)for(g=0;g<c;g++){if((d=document.createElement("th")).setAttribute("colspan",n),d.setAttribute("originalcolspan",n),d.classList.add("optionName"),d.classList.add("drivingOption"),d.classList.add("lastline"),a||d.classList.add("withoutpicture"),e.options[g].displayValue.length>23*n){var C=e.options[g].displayValue.substring(0,10*n);C+="...",C+=e.options[g].displayValue.substring(e.options[g].displayValue.length-1-9*n)}else C=e.options[g].displayValue;m=document.createElement("div"),(h=document.createElement("img")).classList.add("cellimage"),v=document.createElement("div"),""===e.options[g].image||null==e.options[g].image?h.setAttribute("src",l):h.setAttribute("src",e.options[g].image),a?h.classList.remove("hidden"):h.classList.add("hidden"),C=b(C),v.innerHTML=C,v.classList.add("worldwrap_as_breakword"),m.appendChild(h),m.appendChild(v),d.appendChild(m.cloneNode(!0)),d.setAttribute("title",e.options[g].displayValue),d.setAttribute("idfeature",e.logicalId),d.setAttribute("idOption",e.options[g].parentRelLogicalId),s.appendChild(d.cloneNode(!0))}return s},c=function(e,t,n,i,a){var s=0,r=0,o=document.createElement("tr"),d=document.createElement("td"),c=e.options.length;if(0===c)return-1;if(i){var u;e.displayValue.length>23*c?(u=e.displayValue.substring(0,10*c),u+="...",u+=e.displayValue.substring(e.displayValue.length-1-9*c)):u=e.displayValue,d.setAttribute("rowspan",c);var g=document.createElement("div"),p=document.createElement("img");p.classList.add("cellimage");var f=document.createElement("div");for(""===e.image||null==e.image?p.setAttribute("src",l):p.setAttribute("src",e.image),a?p.classList.remove("hidden"):p.classList.add("hidden"),u=b(u),f.innerHTML=u,f.classList.add("worldwrap_as_breakword"),g.appendChild(p),g.appendChild(f),d.appendChild(g.cloneNode(!0)),d.setAttribute("title",e.displayValue),d.setAttribute("idfeature",e.logicalId),d.setAttribute("container","constrainedFeatureContainer"),d.setAttribute("featuretype","constrained"),d.classList.add("featureName"),d.classList.add("constrainedFeature"),d.classList.add("draggableitem"),d.classList.add("firstline"),d.classList.add("lastline"),d.classList.add("tdth"),a||d.classList.add("withoutpicture"),d.setAttribute("draggable",!0),o.appendChild(d.cloneNode(!0)),(d=document.createElement("td")).classList.add("tdth1"),d.setAttribute("idfeature",e.logicalId),e.options[0].displayValue.length>23?(u=e.options[0].displayValue.substring(0,10),u+="...",u+=e.options[0].displayValue.substring(e.options[0].displayValue.length-1-9)):u=e.options[0].displayValue,g=document.createElement("div"),(p=document.createElement("img")).classList.add("cellimage"),f=document.createElement("div"),""===e.options[0].image||null==e.options[0].image?p.setAttribute("src",l):p.setAttribute("src",e.options[0].image),a?p.classList.remove("hidden"):p.classList.add("hidden"),u=b(u),f.innerHTML=u,f.classList.add("worldwrap_as_breakword"),g.appendChild(p),g.appendChild(f),d.appendChild(g.cloneNode(!0)),d.setAttribute("title",e.options[0].displayValue),d.setAttribute("idOption",e.options[0].parentRelLogicalId),d.classList.add("optionName"),d.classList.add("constrainedOption"),d.classList.add("firstline"),a||d.classList.add("withoutpicture"),o.appendChild(d.cloneNode(!0)),(d=document.createElement("td")).classList.add("firstline"),s=0;s<t;s++)d.setAttribute("nb",s),a||d.classList.add("withoutpicture"),o.appendChild(d.cloneNode(!0));for(n.appendChild(o.cloneNode(!0)),d=document.createElement("td"),r=1;r<c;r++){for(d=document.createElement("td"),o=document.createElement("tr"),r===c-1&&d.classList.add("lastline"),d.classList.add("tdth"),d.setAttribute("idfeature",e.logicalId),e.options[r].displayValue.length>23?(u=e.options[r].displayValue.substring(0,10),u+="...",u+=e.options[r].displayValue.substring(e.options[r].displayValue.length-1-9)):u=e.options[r].displayValue,g=document.createElement("div"),(p=document.createElement("img")).classList.add("cellimage"),f=document.createElement("div"),""===e.options[r].image||null==e.options[r].image?p.setAttribute("src",l):p.setAttribute("src",e.options[r].image),a?p.classList.remove("hidden"):p.classList.add("hidden"),u=b(u),f.innerHTML=u,f.classList.add("worldwrap_as_breakword"),g.appendChild(p),g.appendChild(f),d.appendChild(g.cloneNode(!0)),d.setAttribute("title",e.options[r].displayValue),d.setAttribute("idfeature",e.logicalId),d.setAttribute("idOption",e.options[r].parentRelLogicalId),a||d.classList.add("withoutpicture"),d.classList.add("optionName"),d.classList.add("constrainedOption"),d.classList.add("tdth1"),o.appendChild(d.cloneNode(!0)),d=document.createElement("td"),s=0;s<t;s++)d.setAttribute("nb",s),a||d.classList.add("withoutpicture"),r===c-1&&d.classList.add("lastline"),o.appendChild(d.cloneNode(!0));n.appendChild(o.cloneNode(!0))}}},u=function(e,t,n,i){var a=document.createElement("tbody"),s=0;for(s=0;s<e.length;s++)c(e[s],t,a,!0,i);n.appendChild(a)},g=function(t,n,i){var a=-1,s=0,l=0,r=0,o=0,d=t.getElementsByTagName("thead")[0],c=JSON.parse(JSON.stringify(n));l=d.childNodes[o].childElementCount-1;var u,g=null,f=c.length,m=c.combinationOptions;for(o=0,u=d.childElementCount;o<u;o++)for(r=0,g=c.combinationOptions.length;r<g;r++){if(-1!=(a=p(s,l,d.childNodes[o],m[r].id))){m.splice(r,1),0!==m.length&&(l=(s=(a-2)*e.getNbOptionsForFeatureLogicalId(d.childNodes[o+1].childNodes[1].getAttribute("idfeature"),i)+2)+(e.getNbOptionsForFeatureLogicalId(d.childNodes[o+1].childNodes[1].getAttribute("idfeature"),i)-1));break}if(r===f-1)return}return 0!==m.length&&(a=void 0),a},p=function(e,t,n,i){var a=0;for(a=e;a<=t;a++)if(n.childNodes[a].getAttribute("idOption")===i)return a;return-1};this.createTableFromJSON=function(t,n,i,l){var d=e.generateFeaturesOfTypeFromJsonMatrixRules(t.getJSONObject(),n,"driving"),c=e.generateFeaturesOfTypeFromJsonMatrixRules(t.getJSONObject(),n,"constrained");if(window.localStorage.DS_Debug_MatrixRule_Performance)var g=performance.now();if(function(e,t,n){var i=o(s);a.appendChild(i);var l=r(e,1,a,n);u(t,l,a,n)}(d,c,i),window.localStorage.DS_Debug_MatrixRule_Performance)var p=performance.now();if(function(t,n,i,a){var s,l,r=0,o=0,d=0,c=0,u=n.getDrivingCombinations(),g=n.getConstrainedCombinations(),p=n.getStates(),m=n.getStatesValidity(),h=t.getTable().getElementsByTagName("tbody")[0].getElementsByTagName("tr"),b="",v="",C="",L=null,R=u.length;for(g.length,r=0,l=u.length;r<l;r++)for(c=r+2,o=0,L=g.length;o<L;o++)d=o,void 0!==c&&void 0!==d&&(s=e.hasClass(h[d].childNodes[1],"firstline")?h[d].childNodes[c]:h[d].childNodes[c-1],b=f(p,o,r,R),v=f(m,o,r,R),C=n.getStatesCausingRules()[o*R+r],t.updateSingleTdFromCorrespondingStatesInJson(s,b,v,C))}(this,t),window.localStorage.DS_Debug_MatrixRule_Performance)var m=performance.now();if(h(t,n,l),window.localStorage.DS_Debug_MatrixRule_Performance){var b=performance.now();console.log("----- Generate Table Timer----"),console.log("---- total UI time = "+(b-g)+" ms"),console.log("----- generate empty table time = "+(p-g)+" ms"),console.log("----- loadjson in table time = "+(m-p)+" ms"),console.log("----- post process table time = "+(b-m)+" ms"),console.log("---------------------------------")}},this.init=function(e,t){(a=document.createElement("table")).setAttribute("id",e),a.setAttribute("cellspacing","0"),s=t},this.reset=function(){(a=document.createElement("table")).setAttribute("id",null),a.setAttribute("cellspacing","0")};var f=function(e,t,n,i){return e.charAt(t*i+n)},m=function(e,n,a){e.classList.remove("invalidated"),e.classList.remove("required");var s=0;switch(n){case"R":case"E":for(e.classList.add("required"),e.setAttribute("isrequiredext",!0),s=0;s<a.length;s++)a[s];e.setAttribute("title",i.MR_Req_Comb+i.MR_Undercomputation);break;case"I":case"T":for(e.setAttribute("isinvalidatedext",!0),e.classList.add("invalidated"),s=0;s<a.length;s++)a[s];e.setAttribute("title",i.MR_Invalid_Comb+i.MR_Undercomputation);break;case"V":break;case"U":case"A":case"C":break;default:t.warning("char unexpected in jsonValidityStates : "+newChar)}};this.updateSingleTdFromCorrespondingStatesInJson=function(e,n,i,a){!function(e,n){switch(e.classList.remove("available"),e.classList.remove("default"),e.classList.remove("nonavailable"),n){case"_":case"N":e.classList.add("nonavailable");break;case"D":e.classList.add("available"),e.classList.add("default");break;case"A":e.classList.add("available");break;default:t.warning("char unexpected in jsonStates : "+n)}}(e,n),m(e,i,a),function(e,t,n){e.classList.add("showconflict"),e.classList.remove("conflict"),e.setAttribute("conflict",!1),"N"!==t||"R"!==n&&"E"!==n||(e.classList.add("conflict"),e.setAttribute("conflict",!0)),"D"!==t||"I"!==n&&"T"!==n||(e.classList.add("conflict"),e.setAttribute("conflict",!0))}(e,n,i)};var h=function(i,s,l){var r=a,o=i.getJSONSimplifiedObject(),d=r.childNodes[2],c=0,u=0,p=0,f=0,m=0,h=0,b=0,v=null,C=null,L=o.drivingCombinations.length,R=r.childNodes[1],y=[],I=(C=d.childNodes[0],0);for(c=2;c<C.childElementCount;c++)I=n.getIdxDrivingCombinationInJSONFromTd(C.childNodes[c],o,r),y.push(I);for(c=R.childElementCount-1;c>=0;c--){var A=R.childNodes[c].childNodes[2].getAttribute("originalcolspan");for(p=2;p<R.childNodes[c].childElementCount;p++){for(v=null,u=0;u<A;u++)v=null!==v?v+","+y[(p-2)*A+u]:y[(p-2)*A+u];R.childNodes[c].childNodes[p].setAttribute("idxdrivingstate",v)}}var N=null;for(c=0;c<d.childElementCount;c++)for(C=d.childNodes[c],m=1,e.hasClass(C.childNodes[0],"firstline")&&(m=2,N=C.childNodes[0]),h=n.getIdxConstrainedCombinationInJSONFromTd(C.childNodes[m],o,r),C.childNodes[m-1].setAttribute("idxconstrainedstate",h),null!==N.getAttribute("idxconstrainedstate")?N.setAttribute("idxconstrainedstate",N.getAttribute("idxconstrainedstate")+","+h):N.setAttribute("idxconstrainedstate",h),u=m;u<C.childElementCount;u++)f=(b=y[u-m])+h*L,C.childNodes[u].setAttribute("idxstate",f),C.childNodes[u].setAttribute("idxconstrainedstate",h),C.childNodes[u].setAttribute("idxdrivingstate",b);var S=null,E=0,T=-1,w=i.getJSONObject().drivingCombinationsValidity.length;C=null,p=0;var x=!1,O=!0;if(null!=i.getJSONObject().statesValidity&&null!=i.getJSONObject().drivingCombinationsValidity){for(c=0;c<i.getJSONObject().drivingCombinationsValidity.length;c+=1){if("I"!==i.getJSONObject().drivingCombinationsValidity[c]){O=!1;break}O=!0}if(O&&c>=i.getJSONObject().drivingCombinationsValidity.length)return void t.warning("all columns are invalid")}if(null!=i.getJSONObject().statesValidity&&null!=i.getJSONObject().drivingCombinationsValidity)for(c=0;c<i.getJSONObject().drivingCombinationsValidity.length;c+=1)if("I"===i.getJSONObject().drivingCombinationsValidity[c]){for(x=!0,u=0;u<i.getJSONObject().constrainedCombinations.length;u+=1){if(l){x=!0;break}if("A"!==i.getJSONObject().states[c+u*w]){x=!1;break}}if(x){for(T=g(r,i.getJSONObject().drivingCombinations[c],s.features),u=0;u<R.childElementCount;u+=1)for(S=R.childNodes[u],E=2,p=2;p<S.childElementCount;p+=1)if((E+=parseInt(S.childNodes[p].getAttribute("originalcolspan")))>T){S.childNodes[p].setAttribute("colspan",parseInt(S.childNodes[p].getAttribute("colspan"))-1),0===parseInt(S.childNodes[p].getAttribute("colspan"))&&S.childNodes[p].classList.add("displaynone");break}for(u=0;u<d.childElementCount;u+=1){C=d.childNodes[u];var M=0;M=e.hasClass(C.childNodes[0],"firstline")?0:-1,C.childNodes[T+M].classList.add("displaynone")}}}},b=function(e){for(var t,n,i="",a=!0,s=0;a;){var l=e.substr(s,13);if(l.length<13)return a=!1,i+=l;var r=l.substr(l.length-4,4);t=r.indexOf(" "),(n=r.indexOf("..."))>=0?(i+=l.substr(0,13-n+1)+"<br>",s=s+13-n+1):t>0?(i+=l.substr(0,13-t+1)+"<br>",s=s+13-t+1):(i+=l+"<br>",s+=13)}}}}),define("DS/CfgRules/scripts/generateCfgMatrixRulesJSONObj",["DS/CfgRules/scripts/dictionaryCfgUtils","DS/CfgRules/scripts/traceCfgUtils","DS/CfgRules/scripts/CfgMatrixRulesWebServices","DS/UIKIT/Mask","UWA/Core","UWA/Element","UWA/Drivers/Alone"],function(e,t,n,i,a,s,l){"use strict";return function(){var n=null,a=null,s=null,l=null,r=null,o=null,d=null,c=null,u=null,g=null,p=null,f=this,m=1;this.getNumberColumns=function(){return m},this.setNumberColumns=function(e){m=e},this.getDrivingFeatures=function(){return a},this.getConstrainedFeatures=function(){return s},this.getDrivingCombinations=function(){return l},this.getConstrainedCombinations=function(){return r},this.getStates=function(){return o},this.setStates=function(e){o=e},this.getStatesValidity=function(){return d},this.getDrivingCombinationsValidity=function(){return c},this.getUIDrivingOrder=function(){return u},this.setUIDrivingOrder=function(e){u=e},this.getUIConstrainedOrder=function(){return g},this.setUIConstrainedOrder=function(e){g=e},this.getStatesCausingRules=function(){return p},this.getId=function(){return n},this.init=function(e){n=e,a=[],s=[],l=[],r=[],o="",d="",c="",u=[],g=[],p=[]},this.getJSONObject=function(){var e={};return e.constrainedCombinations=r,e.drivingCombinations=l,e.states=o,e.drivingFeatures=a,e.constrainedFeatures=s,e.statesValidity=d,e.drivingCombinationsValidity=c,e.statesCausingRules=p,e.version="1.0.1",e},this.getJSONSimplifiedObject=function(){var e={};return e.constrainedCombinations=r,e.drivingCombinations=l,e.states=o,e.drivingFeatures=a,e.constrainedFeatures=s,e.version="1.0.1",e},this.createEmptyFromFeatures=function(e,t){var n=0;for(m=0,a=v(e),s=v(t),e.reverse(),l=L(e),r=[],n=0;n<t.length;n+=1)r=r.concat(L([t[n]]));for(o=C(l.length,r.length),d=C(l.length,r.length),c=C(l.length,1),n=0;n<a.length;n+=1)u.push(n);for(n=0;n<s.length;n+=1)g.push(n);if(e.length>0)for(m=1,n=0;n<e.length;n+=1)m*=e[n].options.length;return this.getJSONObject()},this.loadJsonIn=function(e){if(null!==e){var n,i,a,s=0,l=0;for(s=0;s<e.constrainedCombinations.length;s+=1)for(l=0;l<e.drivingCombinations.length;l+=1)i=l+s*e.drivingCombinations.length,a=e.states.charAt(i),void 0===(n=y(e.drivingCombinations[l].combinationOptions,e.constrainedCombinations[s].combinationOptions,this.getJSONObject()))||-1===n?t.warning("could not find a combination in the given JSON"):o=o.substr(0,n)+a+o.substr(n+1)}},this.addDrivingFeature=function(t,n){var i=o,s=JSON.parse(JSON.stringify(l)).length,u=r.length,g=e.getFeatureInDicoWithId(t,n);if(null==g&&(g=e.getFeatureInDicoWithLogicalId(t,n)),null==g)return null;a.push({id:g.logicalId});for(var p=[],f=0;f<a.length;f+=1)p.push(e.getFeatureInDicoWithLogicalId(a[f].id,n));p.reverse(),l=L(p);var m=g.options.length;o="",f=0;var h=0,b=0;for(f=0;f<u;f+=1){var v=i.substr(f*s,s);for(h=0;h<v.length;h+=1){var C=v[h];for(b=0;b<m;b+=1)o+=C}}for(d="",f=0;f<o.length;f+=1)d+="V";for(c="",f=0;f<l.length;f+=1)c+="V"},this.addConstrainedFeature=function(e,a,c,u,g,m,h,b,v,C){var L=0,R=0,y=0,I={};for(I.id=a.logicalId,s.push(JSON.parse(JSON.stringify(I))),L=0;L<a.options.length;L+=1)for((I={}).combinationOptions=[],I.combinationOptions.push({id:a.options[L].parentRelLogicalId}),r.push(JSON.parse(JSON.stringify(I))),R=0;R<l.length;R+=1)o+="?";if(null!=u){t.debug("solve for new feature");var A={};for(A.buildtimeCheck=h?b?"validityWithCause":"validity":"none",A.runtimeCheck=m?b?"validityWithCause":"validity":"none",A.matrixDefinition={},A.matrixDefinition.drivingCombinations=l,A.matrixDefinition.constrainedCombinations=[],L=0;L<a.options.length;L+=1)(I={}).combinationOptions=[],I.combinationOptions.push({id:a.options[L].parentRelLogicalId}),A.matrixDefinition.constrainedCombinations.push(JSON.parse(JSON.stringify(I)));A.matrixDefinition.constrainedFeatures=[],A.matrixDefinition.constrainedFeatures.push({id:a.logicalId}),A.matrixDefinition.drivingFeatures=f.getDrivingFeatures();var N={solverId:u,selectedCriteria:{_from:"matrixRuleWebApp",_to:"solverRule",_data:A,_request:"checkMatrixRuleValidity"}},S=null;null!=C&&(S=[C],UWA.extendElement(S[0]),i.mask(S[0])),c.combiSolverOk2(e,N,v,null,function(e,s){if(null!=s&&null!=s[0]&&(UWA.extendElement(s[0]),i.unmask(s[0])),"error"===s)return t.error("error in solve WebServices"),null;var r=e;if(null!=r)for(d+=r.statesValidity,y=0;y<r.statesCausingRules.length;y+=1)p.push(r.statesCausingRules[y]);else if(!v)for(alert("solve failed, processing matrix without solving"),t.error("solve failed, processing matrix "+n+" without solving"),L=0;L<a.options.length;L+=1)for(R=0;R<l.length;R+=1)d+="?",p.push([]);return 0},S)}else for(L=0;L<a.options.length;L+=1)for(R=0;R<l.length;R+=1)d+="?",p.push([])};var h=function(e){var t=-1,n=0;for(n=0;n<r.length;n+=1)if(r[n].combinationOptions[0].id===e){t=n;break}return t};this.removeConstrainedFeature=function(t,n,i,a,c,u,g,p,f,m){var b=0,v=0,C={},L=l.length;for(C.id=t.logicalId,b=0;b<s.length;b+=1)if(s[b].id===C.id){s.splice(b,1),b-=1;break}var R=null,y=null,I=null,A=null;for(v=0;v<r.length;v+=1)R=e.getFeatureFromOptionLogicalId(r[v].combinationOptions[0].id,m).logicalId,y=r[v].combinationOptions[0].id,R===C.id&&(I=o.substring(0,h(y)*L),A=o.substring(h(y)*L+L),o=I+A,I=d.substring(0,h(y)*L),A=d.substring(h(y)*L+L),d=I+A,r.splice(v,1),v-=1)};var b=null;this.getInternalStatus=function(){return b},this.solveInternalNoReason=function(e,n,a,s,l){if(null!=a){t.debug("solve");var r={};r.matrixDefinition=this.getJSONSimplifiedObject(),r.runtimeCheck="validity";var o={solverId:a,selectedCriteria:{_from:"matrixRuleWebApp",_to:"solverRule",_data:r,_request:"checkMatrixRuleValidity"}};n.combiSolverOk2(e,o,s,null,function(e,n){null!=n&&null!=n[0]&&(UWA.extendElement(n[0]),i.unmask(n[0])),"error"!==n?(null!=e&&(b=e),l&&l()):t.error("error in solve")},null)}},this.solve=function(e,a,s,r,u,g,m,h,b,v){if(null!=s){t.debug("solve");var C={};C.matrixDefinition=this.getJSONSimplifiedObject(),C.runtimeCheck=u?m?"validityWithCause":"validity":"none",C.buildtimeCheck=g?m?"validityWithCause":"validity":"none";var L={solverId:s,selectedCriteria:{_from:"matrixRuleWebApp",_to:"solverRule",_data:C,_request:"checkMatrixRuleValidity"}},R=null;null==r&&(R=[b],UWA.extendElement(R[0]),i.mask(R[0])),a.combiSolverOk2(e,L,h,r,function(r,u){if(null!=u&&null!=u[0]&&(UWA.extendElement(u[0]),i.unmask(u[0])),"error"!==u){var g=r;if(null==g||h){if(!h){alert("solve failed, processing matrix without solving"),t.error("solve failed, processing matrix "+n+" without solving");var m=0;for(d="",m=0;m<o.length;m+=1)d+="?";for(c="",m=0;m<l.length;m+=1)c+="?"}}else d=g.statesValidity,c=g.drivingCombinationsValidity,p=g.statesCausingRules;null!=v&&!0===v.getInternalSolverAvailability()&&(t.debug("re-calculating internal reason once after reason calculation"),f.solveInternalNoReason(e,a,s,!1,null),v.handleInternalConflict(f.getInternalStatus()),v.getConflicts())}else t.error("error in solve")},R)}},this.postProcess=function(){var e=0,t="";for(e=0;e<o.length;e+=1)"?"===o.charAt(e)&&("R"===d.charAt(e)||"V"===d.charAt(e)||"U"===d.charAt(e)||"E"===d.charAt(e)||d.charAt(e),t="A",o=o.substr(0,e)+t+o.substr(e+1));if(d=d.replace(/\?/g,"V"),c=c.replace(/\?/g,"V"),d.length!==p.length)for(p=[],e=0;e<d.length;e+=1)p.push([])},this.simplifyJSON=function(){var e=this.getJSONSimplifiedObject(),t=JSON.parse(JSON.stringify(e)),n=0,i=0,a=0,s=!0,l=[];for(n=0;n<t.drivingCombinations.length;n+=1){for(s=!0,i=0;i<t.constrainedCombinations.length;i+=1)if(a=n+i*t.drivingCombinations.length,"A"!==t.states.charAt(a)){s=!1;break}s&&l.push(n)}var r=0;for(n=0;n<l.length;n+=1)A(t,l[n]-r),r+=1;var o=!0,d=[];for(i=0;i<t.constrainedCombinations.length;i+=1){for(o=!0,n=0;n<t.drivingCombinations.length;n+=1)if(a=n+i*t.drivingCombinations.length,"A"!==t.states.charAt(a)){o=!1;break}o&&d.push(i)}for(r=0,n=0;n<d.length;n+=1)N(t,d[n]-r),r+=1;return t};var v=function(e){var t=0,n={},i=[];for(t=0;t<e.length;t+=1)n.id=e[t].logicalId,i.push(JSON.parse(JSON.stringify(n)));return i},C=function(e,t){var n="",i=0;for(i=0;i<e*t;i+=1)n+="?";return n},L=function(e){if(0===e.length)return[];var t=[],n={},i={},a=[],s=[],l=0,r=0;for(l=0;l<e.length;l+=1)a.push(0),s.push(e[l].options.length-1);var o=1;for(l=0;l<s.length;l+=1)o*=s[l]+1;for(l=0;l<o;l+=1){for(n.combinationOptions=[],r=0;r<a.length;r+=1)i.id=e[r].options[a[r]].parentRelLogicalId,n.combinationOptions.push(JSON.parse(JSON.stringify(i)));a=R(a,s),t.push(JSON.parse(JSON.stringify(n)))}return t},R=function(e,t){var n=0,i=!0;for(n=0;n<e.length;n+=1){if(!i||e[n]!==t[n]){i=!1;break}e[n]=0}return e[n]+=1,e},y=function(e,t,n){var i,a,s,l=0,r=n.drivingCombinations.length,o=n.constrainedCombinations.length;for(l=0;l<r;l+=1)if(I(e,n.drivingCombinations[l].combinationOptions)){a=l;break}for(l=0;l<o;l+=1)if(I(t,n.constrainedCombinations[l].combinationOptions)){s=l;break}return void 0!==s&&void 0!==a&&(i=a+s*n.drivingCombinations.length),i},I=function(e,t){var n=0,i=0,a=!1;if(e.length!==t.length)return!1;for(n=0;n<e.length;n+=1){for(a=!1,i=0;i<t.length;i+=1)if(e[i].id===t[n].id){a=!0;break}if(!a)return!1}return!0},A=function(e,t){var n="",i=0;for(i=0;i<e.constrainedCombinations.length;i+=1)n+=e.states.substr(i*e.drivingCombinations.length,t)+e.states.substr(i*e.drivingCombinations.length+t+1,e.drivingCombinations.length-t-1);e.drivingCombinations.splice(t,1),e.states=n},N=function(e,t){var n=e.drivingCombinations.length,i=e.states.substr(0,n*t),a=e.states.substr(n*(t+1),e.states.length-n*(t+1));e.states=i+a,e.constrainedCombinations.splice(t,1)};this.createFromJSON=function(t,n,i,l,r){if(a=e.generateFeaturesOfTypeFromJsonMatrixRules(t,n,"driving"),s=e.generateFeaturesOfTypeFromJsonMatrixRules(t,n,"constrained"),this.createEmptyFromFeatures(a,s),window.localStorage.DS_Debug_MatrixRule_Performance)var o=performance.now();if(this.loadJsonIn(t),window.localStorage.DS_Debug_MatrixRule_Performance)var d=performance.now();if(this.solve(n,i,l,null,!1,!0,!1,!1,r,null),window.localStorage.DS_Debug_MatrixRule_Performance)var c=performance.now();if(this.postProcess(),window.localStorage.DS_Debug_MatrixRule_Performance){var u=performance.now();console.log("-----  Load JSON Object Timer----"),console.log("----- total time = "+(u-o)+" ms"),console.log("----- load json time = "+(d-o)+" ms"),console.log("----- solve json time = "+(c-d)+" ms"),console.log("----- post process json time = "+(u-c)+" ms"),console.log("---------------------------------")}}}}),define("DS/CfgRules/scripts/CfgMatrixRulesController",["UWA/Core","UWA/Element","UWA/Drivers/Alone","DS/CfgRules/scripts/generateCfgMatrixRulesJSONObj","DS/CfgRules/scripts/generateCfgMatrixRulesTableObj","DS/CfgRules/scripts/generateCfgMatrixRulesWrappedTableObj","DS/CfgRules/scripts/dictionaryCfgUtils","DS/CfgRules/scripts/selectionCfgMatrixRulesTable","DS/CfgRules/scripts/CfgMatrixRulesSettings","DS/CfgRules/scripts/CfgMatrixRulesWebServices","DS/CfgRules/scripts/traceCfgUtils","DS/UIKIT/Alert","DS/UIKIT/Mask","DS/UIKIT/DropdownMenu","i18n!DS/CfgRules/assets/nls/MatrixRule"],function(e,t,n,i,a,s,l,r,o,d,c,u,g,p,f){"use strict";return function(){var e=null,t=null,n=null,m=null,h=null,b=null,v=null,C=null,L=null,R=null,y=!1,I=null,A=0,N=null,S=null,E=null,T=!0,w=this,x=null,O=null,M=null,D=null,_=null,F=null,k=null,B=null,W=null,J=null,V=null,U=0,j=null,H=null,P=null,q=null,G=null,X=null,K=null;this.setInternalSolverAvailability=function(e){K=e},this.getInternalSolverAvailability=function(){return K},this.getContentDiv=function(){return D},this.getSettingsButton=function(){return _},this.getMatrixRulesTableObj=function(){return t},this.getDrivingUL=function(){return m},this.getConstrainedUL=function(){return b},this.setConfigurationFeatureComponent=function(e){C=e},this.getMatrixRulesWrappedTableObj=function(){return n},this.getModel=function(){return e},this.getDrivingList=function(){return S},this.getConstrainedList=function(){return E},this.setDrivingList=function(e){S=e},this.setConstrainedList=function(e){E=e},this.setView=function(e){H=e},this.getView=function(){return H},this.getWithPicture=function(){return T},this.loadJsonIn=function(i,a,s){if(S=l.generateFeaturesOfTypeFromJsonMatrixRules(i,a,"driving"),E=l.generateFeaturesOfTypeFromJsonMatrixRules(i,a,"constrained"),S.length>0&&E.length>0){if(UWA.extendElement(x),g.mask(x),e.createFromJSON(i,a,d,s,x),g.unmask(x),c.log(e.getJSONObject(),c.typeMessage.INFO),t.createTableFromJSON(e,a,T,!0),window.localStorage.DS_Debug_MatrixRule_Performance)var r=performance.now();if(n.generateAllTables(t),window.localStorage.DS_Debug_MatrixRule_Performance){var o=performance.now();console.log("-----  Gen. Wrapped Table Timer ----"),console.log("----- time = "+(o-r)+" ms"),console.log("---------------------------------")}!0===K?e.solveInternalNoReason(a,d,P,!0,function(){w.handleInternalConflict(e.getInternalStatus()),w.getConflicts(),n.setReasonCalculated(!1),e.solve(a,d,s,n,!1,!0,!0,!0,x,w)}):(w.getConflicts(),n.setReasonCalculated(!1),e.solve(a,d,s,n,!1,!0,!0,!0,x,w))}w.initUL()},this.displayDiscrepancyList=function(e){var t=f.MR_InconsistencyCriteria_WarningMessage;I.add({className:"warning MR_message",message:t}),I.show()},this.checkAndRemoveDiscrepancy=function(e,t){console.log("check discrepancy");var n={_rc:0,_discrepancyIds:[],_simplifiedModel:{}},i=null;(i={}).addedConstrainedValues=[],i.addedDrivingCombination=[];var a=null,s=null,r=0,o=0,d=0;if(e.drivingFeatures)for(n._simplifiedModel.drivingFeatures=[],r=0;r<e.drivingFeatures.length;r+=1)a={},s={},null==(s=l.getFeatureInDicoWithLogicalId(e.drivingFeatures[r].id,t))?(n._rc=-1,n._discrepancyIds.push(e.drivingFeatures[r].id)):(a.id=s.logicalId,n._simplifiedModel.drivingFeatures.push(a));if(e.constrainedFeatures)for(n._simplifiedModel.constrainedFeatures=[],r=0;r<e.constrainedFeatures.length;r+=1)a={},s={},null==(s=l.getFeatureInDicoWithLogicalId(e.constrainedFeatures[r].id,t))?(n._rc=-1,n._discrepancyIds.push(e.constrainedFeatures[r].id)):(a.id=s.logicalId,n._simplifiedModel.constrainedFeatures.push(a));n._simplifiedModel.states="",e.states&&(n._simplifiedModel.states=e.states),n._simplifiedModel.drivingCombinations=[];var c=[],u=null,g=null;if(e.drivingCombinations)for(n._simplifiedModel.drivingCombinations=e.drivingCombinations,r=0;r<e.drivingCombinations.length;r+=1)if(u=e.drivingCombinations[r],0!==(g=l.areCriteriaOfCombinationsInDico(u,t))._rc)for(n._rc=-1,c.push(r),o=0;o<g._listIds.length;o+=1)n._discrepancyIds.indexOf(g._listIds[o])<0&&n._discrepancyIds.push(g._listIds[o]);var p=[];if(n._simplifiedModel.constrainedCombinations=[],e.constrainedCombinations)for(n._simplifiedModel.constrainedCombinations=e.constrainedCombinations,r=0;r<e.constrainedCombinations.length;r+=1)if(u=e.constrainedCombinations[r],0!==(g=l.areCriteriaOfCombinationsInDico(u,t))._rc)for(n._rc=-1,p.push(r),o=0;o<g._listIds.length;o+=1)n._discrepancyIds.indexOf(g._listIds[o])<0&&n._discrepancyIds.push(g._listIds[o]);var f="",m=null,h=JSON.parse(JSON.stringify(n._simplifiedModel.drivingCombinations));if(c.length>0){var b=n._simplifiedModel.states;for(r=0;r<c.length;r+=1){f="",m=c[r];var v=h.length;for(d=0;d<n._simplifiedModel.constrainedCombinations.length;d+=1)f+=b.substr(d*v,m)+b.substr(d*v+m+1,v-m-1);for(h.splice(m,1),o=r;o<c.length;o+=1)c[o]-=1;b=f}n._simplifiedModel.states=b,n._simplifiedModel.drivingCombinations=h}for(h=JSON.parse(JSON.stringify(n._simplifiedModel.constrainedCombinations)),r=0;r<p.length;r+=1)m=p[r],m-=r,f="",f=n._simplifiedModel.states.substr(0,m*n._simplifiedModel.drivingCombinations.length),f+=n._simplifiedModel.states.substr((m+1)*n._simplifiedModel.drivingCombinations.length),n._simplifiedModel.states=f,h.splice(m,1);return n._simplifiedModel.constrainedCombinations=h,n};this.init=function(l,r,d,c,g,p){(e=new i).init(l),(t=new a).init(l,"n"+l,!1),(n=new s).init(l,g),N=p,T=g,x=r,v=document.createElement("div"),(h=document.createElement("div")).setAttribute("container","drivingFeatureContainer"),v.setAttribute("container","constrainedFeatureContainer"),h.classList.add("driving_container"),v.classList.add("constrained_container"),(D=document.createElement("div")).classList.add("content95"),D.setAttribute("id","contentdivid"),x.appendChild(D),L=document.createElement("div"),R=document.createElement("div"),L.textContent=f.MR_DRIVING_CRITERIA,R.textContent=f.MR_CONSTRAINED_CRITERIA,L.classList.add("driving_container_title"),R.classList.add("constrained_container_title"),D.appendChild(L),D.appendChild(R),D.appendChild(h),D.appendChild(v),document.createElement("div").classList.add("mid-left-div"),document.createElement("div").classList.add("mid-right-div"),m=document.createElement("ol"),b=document.createElement("ol"),m.classList.add("featureList"),m.classList.add("js-sortable-connected"),b.classList.add("featureList"),b.classList.add("js-sortable-connected"),h.appendChild(m),h.setAttribute("container","drivingFeatureContainer"),v.appendChild(b),v.setAttribute("container","constrainedFeatureContainer"),S=[],E=[],x=r,(M=document.createElement("div")).classList.add("content95"),M.classList.add("settingsdiv"),M.classList.add("displaynone"),F=new o,K="false"!==window.localStorage.DS_FTR_Matrixrule_InternalConflictSetting,F.init(T,K,c),F.setParentDiv(M),F.draw(),(O=document.createElement("div")).setAttribute("id","idSettingsBarDiv"),O.classList.add("content5"),O.classList.add("settingsbar"),(J=document.createElement("div")).setAttribute("id","idConflictDiv"),J.style.marginLeft="165px",J.style.marginBottom="10px",J.style.fontWeight="bold",J.style.display="none",H="editView",Y(),w.showStruct(),x.appendChild(O),x.appendChild(D),x.appendChild(M),n.drawInDiv(D),ee(d,c),P=c,re(d),(I=new u({visible:!1,autoHide:!0,hideDelay:3e3,closeOnClick:!0,maximumVisibleMessages:3,className:"MRAlert"})).inject(D)};var z=!1,Y=function(){(_=document.createElement("button")).classList.add("button_settings"),_.classList.add("btn"),_.classList.add("btn-default"),(n=document.createElement("span")).classList.add("fonticon"),n.classList.add("fonticon-cog"),n.classList.add("matrixrulespan"),_.setAttribute("title",f.MR_Settings),_.appendChild(n),O.appendChild(_),_.addEventListener("click",function(){z=!z,c.debug("settings button clicked"),D.classList.toggle("displaynone"),M.classList.toggle("displaynone"),J.classList.toggle("displaynone"),k.classList.toggle("displaynone"),B.classList.toggle("displaynone"),W.classList.toggle("displaynone"),j.classList.toggle("displaynone"),l.hasClass(j,"displaynone")<0&&(R.classList.toggle("displaynone"),L.classList.toggle("displaynone")),z?(document.getElementById("idcancelMR")&&(document.getElementById("idcancelMR").disabled=!0),document.getElementById("idsaveMR")&&(document.getElementById("idsaveMR").disabled=!0)):N&&(document.getElementById("idcancelMR")&&(document.getElementById("idcancelMR").disabled=!1),document.getElementById("idsaveMR")&&(document.getElementById("idsaveMR").disabled=!1)),Z()}),(V=document.createElement("div")).setAttribute("id","MRconflictDiv"),V.style.cssFloat="right",(k=document.createElement("button")).setAttribute("id","idConflictNext");var e=document.createElement("span");e.classList.add("fonticon"),e.classList.add("fonticon-right"),e.classList.add("matrixrulespan"),k.appendChild(e),k.classList.add("button_settings"),k.classList.add("btn"),k.classList.add("btn-default"),V.appendChild(k),k.addEventListener("click",w.getNextConflicts,!0),(B=document.createElement("button")).setAttribute("id","idConflictPrev");var t=document.createElement("span");t.classList.add("fonticon"),t.classList.add("fonticon-left"),t.classList.add("matrixrulespan"),B.appendChild(t),B.classList.add("button_settings"),B.classList.add("btn"),B.classList.add("btn-default"),V.appendChild(B),B.addEventListener("click",w.getPrevConflicts,!0),(W=document.createElement("i")).setAttribute("id","idConflictAlert"),W.classList.add("fonticon"),W.classList.add("fonticon-alert"),W.style.fontSize="larger",W.style.marginTop="4px",W.style.cssFloat="right",W.style.color="red",V.appendChild(W),(J=document.createElement("div")).setAttribute("id","idConflictDiv"),J.innerHTML="0",J.style.cssFloat="right",J.style.marginTop="4px",J.style.padding="2px",J.style.marginRight="2px",V.appendChild(J),O.appendChild(V),(j=document.createElement("button")).classList.add("button_settings"),j.classList.add("btn"),j.classList.add("btn-default");var n=document.createElement("span");j.appendChild(n),n.classList.add("fonticon"),n.classList.add("matrixrulespan"),j.setAttribute("title",f.MR_SwitchView),j.addEventListener("click",w.toggleView,!0),"structView"===H?n.classList.add("fonticon-layout"):n.classList.add("fonticon-list"),O.appendChild(j)};this.initUL=function(){var e=0;for(e=0;e<S.length;e+=1)m.appendChild(Q(S[e],"driving"));for(e=0;e<E.length;e+=1)b.appendChild(Q(E[e],"constrained"))};var Q=function(e,t){var n=document.createElement("li");n.setAttribute("id","li_"+e.logicalId),n.setAttribute("idfeature",e.logicalId),n.setAttribute("featuretype",t),n.setAttribute("draggable","true"),n.setAttribute("title",e.displayValue),n.classList.add("draggableitem"),n.classList.add("matrixrulesli");var i=document.createElement("div");if(i.textContent=e.displayValue,e.displayValue.length>=40){var a=e.displayValue.substring(0,15);a+="...",a+=e.displayValue.substring(e.displayValue.length-15),i.textContent=a}var s=document.createElement("img");return""===e.image||null==e.image?s.setAttribute("src","assets/images/no_image.png"):s.setAttribute("src",e.image),s.classList.add("cellimage"),s.setAttribute("id","img_"+e.logicalId),T||(n.classList.add("withoutpicture"),s.classList.add("hidden")),n.appendChild(s),n.appendChild(i),n};this.addInteraction=function(e,t){c.debug("adding interaction for wrapped table "+n.getId()),this._addClickInteractionForWrappedTable(e),K="false"!==window.localStorage.DS_FTR_Matrixrule_InternalConflictSetting,te(),ee(e,t),Z(),F.getImageButton().onchange=w.togglePicture,F.getConflictCheckButton().onchange=function(){w.changeInternalStatus(e)}},this.draw=function(){n.drawTopIn(D),n.drawBotIn(D)},this.getNextConflicts=function(){var e=!1,t=!1,i=n.getBotRightTable().getElementsByTagName("td"),a=0,s=0,l=null,r=null;for(a=0;a<i.length;a+=1)if(i[a].classList.remove("mr_current_highlight"),"true"===i[a].getAttribute("navigate")){i[a].setAttribute("navigate","false"),a+=1;break}for(a===i.length&&(a=0,t=!0),s=a;s<i.length;s+=1)if(l=i[s].getAttribute("conflict"),r=i[s].getAttribute("internal_conflict"),"true"===l||"true"===r){i[s].setAttribute("navigate","true"),e=!0,w.showCell(i[s]);break}if(!1===t&&!1===e)for(s=0;s<a;s+=1)if(l=i[s].getAttribute("conflict"),r=i[s].getAttribute("internal_conflict"),"true"===l||"true"===r){i[s].setAttribute("navigate","true"),e=!0,w.showCell(i[s]);break}},this.getPrevConflicts=function(){var e=!1,t=!1,i=n.getBotRightTable().getElementsByTagName("td"),a=0,s=0,l=null,r=null;for(a=0;a<i.length;a+=1)if(i[a].classList.remove("mr_current_highlight"),"true"===i[a].getAttribute("navigate")){i[a].setAttribute("navigate","false");break}for(0===a&&(a=i.length,t=!0),s=a-1;s>0;s-=1)if(l=i[s].getAttribute("conflict"),r=i[s].getAttribute("internal_conflict"),"true"===l||"true"===r){i[s].setAttribute("navigate","true"),e=!0,w.showCell(i[s]);break}if(!1===t&&!1===e)for(s=i.length-1;s>=a;s-=1)if(l=i[s].getAttribute("conflict"),r=i[s].getAttribute("internal_conflict"),"true"===l||"true"===r){i[s].setAttribute("navigate","true"),e=!0,w.showCell(i[s]);break}},this.showCell=function(e){var t=e.offsetLeft-window.scrollX,n=e.offsetTop-window.scrollY;return $("html,#IDTABLE-bot-right-div").animate({scrollLeft:t},200),$("html,#IDTABLE-bot-right-div").animate({scrollTop:n},200),e.classList.add("mr_current_highlight"),!0},this.getConflicts=function(){U=0;var e=n.getBotRightTable().getElementsByTagName("td"),t=0,i=null,a=null;for(t=0;t<e.length;t+=1)i=e[t].getAttribute("conflict"),a=e[t].getAttribute("internal_conflict"),l.hasClass(e[t],"displaynone")||"true"!==i&&"true"!==a||(U+=1);return J.innerHTML=U,A=U,0===U?(W.style.color="grey",B.style.color="grey",k.style.color="grey"):(W.style.color="red",B.style.color="black",k.style.color="black"),U},this.setNavigationConflictsAvailability=function(e){e?(B.disabled=!0,k.disabled=!0,document.getElementById("idinternalsolveMR")&&(document.getElementById("idinternalsolveMR").disabled=!0)):(B.disabled=!1,k.disabled=!1,document.getElementById("idinternalsolveMR")&&(document.getElementById("idinternalsolveMR").disabled=!1))},this._addInteractionBotleftHeader=function(t,i,a){var s=t&&t.rowSpan>=2?f.MR_Set_Rows:f.MR_Set_Row;t.addEventListener("click",function(){if("false"!==this.getAttribute("editable")){var i=new p({className:"mr-dropdown-header-interaction",target:t,items:[{text:s+" : ",className:"header"},{status:"A",text:f.MR_Available,fonticon:"stop",className:"mr-dropdown-available"},{status:"N",text:f.MR_NonAvailable,fonticon:"stop",className:"mr-dropdown-nonavailable"}],events:{onClick:function(s,l){r.updateAllLineWrappedTableAndJSONFromInteraction(t,e,n.getBotRightTable(),a,l.status),!0===n.getReasonCalculated()&&!0===K?e.solveInternalNoReason(a,d,P,!0,function(){w.handleInternalConflict(e.getInternalStatus()),w.getConflicts()}):w.getConflicts(),i.hide(),i.destroy()},onClickOutside:function(e){i.hide(),i.destroy()}}});i.show()}})},this._addInteractionTopRightHeader=function(t,i,a){var s=t&&t.colSpan>=2?f.MR_Set_Columns:f.MR_Set_Column;t.addEventListener("click",function(){if("false"!==this.getAttribute("editable")){var i=new p({target:t,items:[{text:s+" : ",className:"header"},{status:"A",text:f.MR_Available,fonticon:"stop",className:"mr-dropdown-available"},{status:"N",text:f.MR_NonAvailable,fonticon:"stop",className:"mr-dropdown-nonavailable"}],events:{onClick:function(s,l){r.updateAllColumnWrappedTableAndJSONFromInteraction(t,e,n.getBotRightTable(),a,l.status),!0===n.getReasonCalculated()&&!0===K?(e.solveInternalNoReason(a,d,P,!0,function(){w.handleInternalConflict(e.getInternalStatus()),w.getConflicts()}),i.destroy()):w.getConflicts()},onClickOutside:function(e){i.hide(),i.destroy()}}});i.show()}})},this._addInteractionTopLeftHeader=function(t,i){t.addEventListener("click",function(){if("false"!==this.getAttribute("editable")){var a=new p({target:t,items:[{text:f.MR_SET_MATRIX+" : ",className:"header"},{status:"A",text:f.MR_Available,fonticon:"stop",className:"mr-dropdown-available"},{status:"N",text:f.MR_NonAvailable,fonticon:"stop",className:"mr-dropdown-nonavailable"}],events:{onClick:function(t,s){r.updateAllMatrix(e,n.getBotRightTable(),i,s.status),!0===n.getReasonCalculated()&&!0===K?(e.solveInternalNoReason(i,d,P,!0,function(){w.handleInternalConflict(e.getInternalStatus()),w.getConflicts()}),a.destroy()):w.getConflicts()},onClickOutside:function(e){a.hide(),a.destroy()}}});a.show()}})},this._addClickInteractionForWrappedTable=function(t){var i=this;c.debug("adding click event on each cell of mBotRightTable for "+n.getId());var a=n.getBotRightTable().getElementsByTagName("td"),s=0;for(s=0;s<a.length;s+=1)a[s].addEventListener("click",function(){r.updateWrappedTableAndJSONFromLeftClickInteraction(this,e,n.getBotRightTable(),t),!0===n.getReasonCalculated()&&!0===K?e.solveInternalNoReason(t,d,P,!0,function(){i.handleInternalConflict(e.getInternalStatus()),i.getConflicts()}):i.getConflicts()}),a[s].oncontextmenu=function(e){if("false"!==this.getAttribute("editable"))return q=this,oe(this,e),G.focus(),!1};var l=n.getBotLeftTable().getElementsByTagName("td");for(s=0;s<l.length;s+=1)i._addInteractionBotleftHeader(l[s],s,t);var o=n.getTopRightTable().getElementsByTagName("th");for(s=0;s<o.length;s+=1)i._addInteractionTopRightHeader(o[s],s,t);var u=n.getTopLeftTable().getElementsByClassName("invisible_but_hidden");for(s=0;s<u.length;s+=1)i._addInteractionTopLeftHeader(u[s],t)};var Z=function(){c.debug("header resized for "+n.getId()),S.length;var e=D.clientHeight;c.debug("height size : "+e);var t=n.getTopRightDiv().style.height,i=(t=n.getTopRightDiv().clientHeight,"calc(100% - "+(X=t||X)+"px)");n.getBotLeftDiv().style.maxHeight=i,n.getBotRightDiv().style.maxHeight=i,(window.ActiveXObject||"ActiveXObject"in window)&&(n.getBotLeftDiv().style.height=i,n.getBotRightDiv().style.height=i);var a=n.getTopRightDiv();if(a.firstChild&&a.firstChild.firstChild&&a.firstChild.firstChild.childNodes){var s=a.firstChild.firstChild.childNodes,l=0,r=[];for(l=0;l<s.length;l+=1)r.push(s[l].clientHeight);var o=n.getTopLeftDiv().firstChild.firstChild.childNodes;for(l=0;l<o.length;l+=1)o[l].style.height=r[l]+"px"}},ee=function(e,t){w.generateContainer(n.getTopLeftDiv(),e,t,"drivingFeatureContainer"),w.generateContainer(n.getTopRightDiv(),e,t,"drivingFeatureContainer"),w.generateContainer(n.getBotLeftDiv(),e,t,"constrainedFeatureContainer"),y||(w.generateContainer(h,e,t,"drivingFeatureContainer"),w.generateContainer(v,e,t,"constrainedFeatureContainer"),y=!0)},te=function(){var e=document.querySelectorAll(".draggableitem"),t=0;for(t=0;t<e.length;t+=1)e[t].addEventListener("dragstart",ie,!0),e[t].addEventListener("dragend",se,!0),e[t].addEventListener("dragover",ae,!0)};this.generateContainer=function(e,t,n,i){e.setAttribute("container",i),e.ondragover=ae,e.ondrop=function(e){le(e,t,n,this)}};var ne=null;this.triggerDrop=function(e,t,n,i,a){ne=t,le(e,n,i,a)};var ie=function(e){ne=this,this.style.opacity="0.5",e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("MRidfeature",this.getAttribute("idfeature")),c.debug("id feature dragged = "+this.getAttribute("idfeature"))},ae=function(e){return e.preventDefault&&e.preventDefault(),e.dataTransfer.dropEffect="move",!1},se=function(e){this.style.opacity="1.0"},le=function(i,a,s,r){if("false"===r.getAttribute("editable"))return ne=null,void(i.preventDefault&&i.preventDefault());if(null!==ne&&"false"!==ne.getAttribute("draggable")){var o,u;c.debug("item dropped"),i.preventDefault&&i.preventDefault(),i.stopPropagation&&i.stopPropagation(),o="drivingFeatureContainer"===r.getAttribute("container")?"driving":"constrainedFeatureContainer"===r.getAttribute("container")?"constrained":"noType";var g=ne.getAttribute("idfeature");if(null!==l.getFeatureInDicoWithId(g,a)&&(g=l.getFeatureInDicoWithId(g,a).logicalId,ne.setAttribute("idfeature",g)),o!==(u="driving"===ne.getAttribute("featuretype")?"driving":"constrained"===ne.getAttribute("featuretype")?"constrained":"noType")){if("noType"===u){var p=0;for(p=0;p<m.childElementCount;p+=1)if(m.childNodes[p].getAttribute("idfeature")===ne.getAttribute("idfeature")){u="driving";break}for(p=0;p<b.childElementCount;p+=1)if(b.childNodes[p].getAttribute("idfeature")===ne.getAttribute("idfeature")){u="constrained";break}}var h={id:g,newType:o,previousType:u};if(c.debug("DnD : id = "+g+" - newType = "+o+" - previousType = "+u),h.newType!==h.previousType){var v=l.getFeatureInDicoWithLogicalId(g,a);if("driving"===h.newType&&"Multiple"===v.selectionType)return c.error("dragging Feature "+v.displayValue+" is not allowed in Driving Features because the feature is multiple"),I.add({className:"error MR_message",message:v.displayValue+" "+f.NotAllowForMultiple}),I.show(),void(ne=null);if("driving"===h.newType&&e.getNumberColumns()*v.options.length>600)return I.add({className:"primary MR_message",message:f.Too_Many_Columns}),I.show(),void(ne=null);var C=document.createElement("li");if("driving"===h.previousType?(l.removeFeatureInListWithLogicalId(h.id,S),m.removeChild(document.getElementById("li_"+h.id))):"constrained"===h.previousType&&(l.removeFeatureInListWithLogicalId(h.id,E),b.removeChild(document.getElementById("li_"+h.id))),"driving"===h.newType?-1===l.getFeatureIndexInListWithLogicalId(h.id,S)&&-1===l.getFeatureIndexInListWithLogicalId(h.id,E)&&(e.setNumberColumns(e.getNumberColumns()*v.options.length),c.info("new column 'potential' number : "+e.getNumberColumns()),S.push(l.getFeatureInDicoWithLogicalId(h.id,a)),C=Q(l.getFeatureInDicoWithLogicalId(h.id,a),"driving"),m.appendChild(C)):"constrained"===h.newType&&-1===l.getFeatureIndexInListWithLogicalId(h.id,E)&&-1===l.getFeatureIndexInListWithLogicalId(h.id,S)&&(E.push(l.getFeatureInDicoWithLogicalId(h.id,a)),C=Q(l.getFeatureInDicoWithLogicalId(h.id,a),"constrained"),b.appendChild(C)),"driving"===h.previousType&&e.setNumberColumns(e.getNumberColumns()/v.options.length),0===S.length||0===E.length)return c.info("there should be at least one driving & one constrained feature when trying to generate a new table"),w.showStruct(),te(),A=0,J.innerHTML=A,W.style.color="grey",B.style.color="grey",k.style.color="grey",void(ne=null);c.debug(e.getJSONObject()),c.debug("creating NEW TABLE"),"constrained"===h.newType&&"noType"===h.previousType&&1!==E.length&&0!==e.getDrivingFeatures().length?e.addConstrainedFeature(a,l.getFeatureInDicoWithLogicalId(h.id,a),d,s,null,!1,!0,!1,!1,x):"noType"===h.newType&&"constrained"===h.previousType&&0!==e.getDrivingFeatures().length?e.removeConstrainedFeature(l.getFeatureInDicoWithLogicalId(h.id,a),d,s,null,!1,!0,!1,!1,x,a):"driving"===h.newType&&0!==l.getFeatureIndexInListWithLogicalId(h.id,S)&&0!==l.getFeatureIndexInListWithLogicalId(h.id,E)?"constrained"===h.previousType?(e.removeConstrainedFeature(l.getFeatureInDicoWithLogicalId(h.id,a),d,s,null,!1,!0,!1,!1,x,a),e.addDrivingFeature(h.id,a),e.solve(a,d,s,null,!1,!0,!1,!1,x,null)):"noType"===h.previousType&&(e.addDrivingFeature(h.id,a),e.solve(a,d,s,null,!1,!0,!1,!1,x,null)):(e.createEmptyFromFeatures(S,E),e.solve(a,d,s,null,!1,!0,!1,!1,x,null));var L=e.getId();return document.getElementById(L+"-top-left-div")&&(D.removeChild(document.getElementById(L+"-top-left-div")),D.removeChild(document.getElementById(L+"-top-right-div")),D.removeChild(document.getElementById(L+"-bot-left-div")),D.removeChild(document.getElementById(L+"-bot-right-div"))),e.postProcess(),function(i,a,s,l){e=i,t.init(s),n.init(s,T),t.createTableFromJSON(i,a,T,!0),n.generateAllTables(t),!0===K?e.solveInternalNoReason(a,d,P,!0,function(){w.handleInternalConflict(e.getInternalStatus()),w.getConflicts(),n.setReasonCalculated(!1),e.solve(a,d,l,n,!1,!0,!0,!0,x,w)}):(w.getConflicts(),n.setReasonCalculated(!1),e.solve(a,d,l,n,!1,!0,!0,!0,x,w)),w.addInteraction(a,l)}(e,a,L,s),w.showCurrentView(),w.draw(),te(),c.debug(e.getJSONObject()),ne=null,Z(),w.getConflicts(),!1}ne=null}else ne=null}else i.preventDefault&&i.preventDefault()};this.togglePicture=function(){T=!T,window.localStorage.setItem("DS_MatrixruleCookie_ImgSetting",T);var e=D.querySelectorAll(".cellimage"),t=0;for(t=0;t<e.length;t+=1)e[t].classList.toggle("hidden");var i=D.querySelectorAll(".wrapped-table td");for(t=0;t<i.length;t+=1)i[t].classList.toggle("withoutpicture");var a=D.querySelectorAll(".wrapped-table th");for(t=0;t<a.length;t+=1)a[t].classList.toggle("withoutpicture");for("false"===window.localStorage.DS_MatrixruleCookie_ImgSetting?null!=C&&C.showHideFeatureOptionImages(!1):null!=C&&C.showHideFeatureOptionImages(!0),t=0;t<S.length;t+=1)m.childNodes[t].classList.toggle("withoutpicture");for(t=0;t<E.length;t+=1)b.childNodes[t].classList.toggle("withoutpicture");n.getBotLeftDiv().classList.toggle("withoutpicture"),n.getBotRightDiv().classList.toggle("withoutpicture"),n.getTopLeftDiv().classList.toggle("withoutpicture"),n.getTopRightDiv().classList.toggle("withoutpicture"),Z()},this.toggleShowConflict=function(){var e=n.getBotRightTable().getElementsByTagName("td"),t=0;for(t=0;t<e.length;t+=1)e[t].classList.toggle("showconflict")},this.showTable=function(){n.getBotRightDiv().classList.remove("displaynone"),n.getBotLeftDiv().classList.remove("displaynone"),n.getTopLeftDiv().classList.remove("displaynone"),n.getTopRightDiv().classList.remove("displaynone"),h.classList.add("displaynone"),v.classList.add("displaynone"),L.classList.add("displaynone"),R.classList.add("displaynone"),c.debug("current View : "+H),w.setNavigationConflictsAvailability(!1),Z()},this.showStruct=function(){n.getBotRightDiv().classList.add("displaynone"),n.getBotLeftDiv().classList.add("displaynone"),n.getTopLeftDiv().classList.add("displaynone"),n.getTopRightDiv().classList.add("displaynone"),h.classList.remove("displaynone"),v.classList.remove("displaynone"),L.classList.remove("displaynone"),R.classList.remove("displaynone"),c.debug("current View : "+H),w.setNavigationConflictsAvailability(!0)},this.toggleView=function(){"structView"===H&&void 0!==S&&void 0!==E&&0!==S.length&&0!==E.length?(H="editView",j.firstChild.classList.remove("fonticon-layout"),j.firstChild.classList.remove("fonticon-list"),j.firstChild.classList.add("fonticon-list")):(H="structView",j.firstChild.classList.remove("fonticon-layout"),j.firstChild.classList.remove("fonticon-list"),j.firstChild.classList.add("fonticon-layout"),B.disabled=!0,k.disabled=!0),w.showCurrentView()},this.showCurrentView=function(){"structView"===H?w.showStruct():w.showTable()},this.getSettingsContent=function(){return F},this.handleInternalConflict=function(e){var t=0,i=0;if(null!==e){var a=[];for(t=0;t<e.statesValidity.length;t+=1)"C"===e.statesValidity[t]&&a.push(t);var s=n.getBotRightTable().getElementsByTagName("td");for(t=0;t<s.length;t+=1)s[t].setAttribute("internal_conflict",!1),s[t].classList.remove("internal_conflict");for(i=0;i<s.length;i+=1)for(t=0;t<a.length;t+=1)if(a[t]===parseInt(s[i].getAttribute("idxstate"))){s[i].setAttribute("internal_conflict","true"),s[i].classList.add("internal_conflict");break}}};var re=function(t){(G=document.createElement("div")).setAttribute("id","mrdropdownmenu"),G.setAttribute("tabIndex",0),G.classList.add("dropdown"),G.classList.add("dropdown-menu"),G.classList.add("displaynone"),G.onblur=function(e){return G.classList.add("displaynone"),q=null,!1};var i=document.createElement("ul");i.classList.add("dropdown-menu-wrap");var a=document.createElement("li");a.classList.add("item"),a.onclick=function(i){c.debug(f.MR_Available+" clicked"),G.classList.add("displaynone"),r.updateWrappedTableAndJSONFromContextMenuInteraction(q,e,n.getBotRightTable(),t,"A"),!0===n.getReasonCalculated()&&!0===K?e.solveInternalNoReason(t,d,P,!0,function(){w.handleInternalConflict(e.getInternalStatus()),w.getConflicts()}):w.getConflicts()};var s=document.createElement("span");s.innerHTML=f.MR_Available,a.appendChild(s.cloneNode(!0));var l=document.createElement("li");l.classList.add("item"),l.onclick=function(i){c.debug(f.MR_NonAvailable+" clicked"),G.classList.add("displaynone"),r.updateWrappedTableAndJSONFromContextMenuInteraction(q,e,n.getBotRightTable(),t,"N"),!0===n.getReasonCalculated()&&!0===K?e.solveInternalNoReason(t,d,P,!0,function(){w.handleInternalConflict(e.getInternalStatus()),w.getConflicts()}):w.getConflicts()},(s=document.createElement("span")).innerHTML=f.MR_NonAvailable,l.appendChild(s.cloneNode(!0));var o=document.createElement("li");o.classList.add("item"),o.onclick=function(){c.debug(f.MR_Default+" clicked"),G.classList.add("displaynone"),r.updateWrappedTableAndJSONFromContextMenuInteraction(q,e,n.getBotRightTable(),t,"D"),!0===n.getReasonCalculated()&&!0===K?e.solveInternalNoReason(t,d,P,!0,function(){w.handleInternalConflict(e.getInternalStatus()),w.getConflicts()}):w.getConflicts()},(s=document.createElement("span")).innerHTML=f.MR_Default,o.appendChild(s.cloneNode(!0));var u=document.createElement("li");u.classList.add("item"),u.onclick=function(){c.debug(f.MR_Standard+" clicked"),c.warning(f.MR_Standard+" is not handled yet"),G.classList.add("displaynone"),!0===n.getReasonCalculated()&&!0===K?e.solveInternalNoReason(t,d,P,!0,function(){w.handleInternalConflict(e.getInternalStatus()),w.getConflicts()}):w.getConflicts()},(s=document.createElement("span")).innerHTML=f.MR_Standard,u.appendChild(s.cloneNode(!0)),i.appendChild(a),i.appendChild(l),i.appendChild(o),G.appendChild(i),x.appendChild(G)},oe=function(e,t){G.classList.remove("displaynone"),G.style.left=t.pageX+"px",G.style.top=t.pageY+"px"};this.removeInteractionOnTable=function(e,t){c.debug("removing interaction on table & container"),h.setAttribute("editable","false"),v.setAttribute("editable","false");var i=n.getBotRightTable().getElementsByTagName("td"),a=0;for(a=0;a<i.length;a+=1)i[a].setAttribute("editable","false"),i[a].classList.add("noneditable");var s=n.getBotLeftTable().getElementsByTagName("td");for(a=0,a=0;a<s.length;a+=1)s[a].setAttribute("editable","false"),s[a].classList.add("noneditable");var l=n.getTopRightTable().getElementsByTagName("th");for(a=0,a=0;a<l.length;a+=1)l[a].setAttribute("editable","false"),l[a].classList.add("noneditable");n.getBotLeftTable().setAttribute("editable","false"),n.getBotLeftDiv().setAttribute("editable","false"),n.getTopRightDiv().setAttribute("editable","false"),n.getTopRightTable().setAttribute("editable","false"),n.getTopLeftDiv().setAttribute("editable","false"),n.getTopLeftTable().setAttribute("editable","false"),n.getBotLeftTable().classList.remove("editable"),n.getBotLeftDiv().classList.remove("editable"),n.getTopRightDiv().classList.remove("editable"),n.getTopRightTable().classList.remove("editable"),n.getTopLeftDiv().classList.remove("editable"),n.getTopLeftTable().classList.remove("editable")},this.addInteractionOnTable=function(e,t){c.debug("adding interaction on table & container"),h.setAttribute("editable","true"),v.setAttribute("editable","true");var i=n.getBotRightTable().getElementsByTagName("td"),a=0;for(a=0;a<i.length;a+=1)i[a].setAttribute("editable","true"),i[a].classList.remove("noneditable");var s=n.getBotLeftTable().getElementsByTagName("td");for(a=0,a=0;a<s.length;a+=1)s[a].setAttribute("editable","true"),s[a].classList.remove("noneditable");var l=n.getTopRightTable().getElementsByTagName("td");for(a=0,a=0;a<l.length;a+=1)l[a].setAttribute("editable","true"),l[a].classList.remove("noneditable");n.getBotLeftTable().setAttribute("editable","true"),n.getBotLeftDiv().setAttribute("editable","true"),n.getTopRightDiv().setAttribute("editable","true"),n.getTopRightTable().setAttribute("editable","true"),n.getTopLeftDiv().setAttribute("editable","true"),n.getTopLeftTable().setAttribute("editable","true"),n.getBotLeftTable().classList.add("editable"),n.getBotLeftDiv().classList.add("editable"),n.getTopRightDiv().classList.add("editable"),n.getTopRightTable().classList.add("editable"),n.getTopLeftDiv().classList.add("editable"),n.getTopLeftTable().classList.add("editable")},this.changeInternalStatus=function(t){var i=0;if(K=!K,window.localStorage.DS_FTR_Matrixrule_InternalConflictSetting=!1===K?"false":"",!0===n.getReasonCalculated()&&!0===K)e.solveInternalNoReason(t,d,P,!1,null),w.handleInternalConflict(e.getInternalStatus());else{var a=n.getBotRightTable().getElementsByTagName("td");for(i=0;i<a.length;i+=1)a[i].setAttribute("internal_conflict",!1),a[i].classList.remove("internal_conflict"),a[i].classList.remove("mr_current_highlight")}w.getConflicts()}}}),define("DS/CfgRules/scripts/CfgMatrixRulesHighLevelController",["DS/CfgRules/scripts/CfgMatrixRulesController","DS/EffectivityWebExternalJS/scripts/CriteriaLibs","DS/CfgBaseUX/scripts/ConfigurationFeatureCriteria","DS/CfgRules/scripts/CfgMatrixRulesWebServices","DS/CfgRules/scripts/generateCfgMatrixRulesXMLExpression","i18n!DS/CfgRules/assets/nls/MatrixRule","DS/CfgRules/scripts/traceCfgUtils","DS/CfgRules/scripts/dictionaryCfgUtils","DS/UIKIT/Alert","DS/UIKIT/Mask","UWA/Core","UWA/Element","UWA/Drivers/Alone","css!DS/UIKIT/UIKIT.css"],function(e,t,n,i,a,s,l,r,o,d,c,u,g,p){"use strict";return function(){var t,d=!1,c=null,u=null,g=null,p=null,f=null,m=null,h=null,b=null,v=null,C=null,L=null,R=null,y=null,I=null,A=this,N=null,S=null;this.setPidRule=function(e){y=e},this.setVersionRule=function(e){I=e},this.getMatrixRulesController=function(){return t},this.getSliderContentDiv=function(){return f},this.getSliderToggleDiv=function(){return g},this.getSaveButton=function(){return C},this.getCancelButton=function(){return v},this.init=function(n,i,a,l,r,A,E,T){var w=!!document.documentMode;UWA.createElement("div"),y=r,I=A,d=T,h=i,b=document.createElement("div"),(c=document.createElement("div")).classList.add("close"),w?c.classList.add("matrixRulesDivIESpecific"):c.classList.add("matrixRulesDiv"),g=document.createElement("div"),f=document.createElement("div"),(m=document.createElement("div")).classList.add("content5"),m.setAttribute("id",n+"-legend"),(g=document.createElement("div")).classList.add("sliderToggleDivStyle"),g.classList.add("close"),(p=document.createElement("span")).classList.add("arrow"),p.classList.add("fonticon"),p.classList.add("fonticon-right-dir"),p.classList.add("close"),g.appendChild(p),f=document.createElement("div"),w?f.classList.add("sliderContentDivIESpecific"):f.classList.add("sliderContentDiv"),f.classList.add("close"),f.setAttribute("id",n+"-sliderContentId"),(u=document.createElement("div")).classList.add("close"),w?u.classList.add("matrixRulesDivIESpecific"):u.classList.add("matrixRulesDiv"),u.classList.add("preferences"),u.classList.add("hidden"),(t=new e).init(n,c,a,l,E,T),b.appendChild(f),b.appendChild(g),b.appendChild(c),b.appendChild(u),b.classList.add("content95"),(v=document.createElement("button")).setAttribute("id","idcancelMR"),v.textContent=s.MR_Reset,v.classList.add("button_bottom"),v.classList.add("btn"),v.classList.add("btn-default"),(C=document.createElement("button")).setAttribute("id","idsaveMR"),C.textContent=s.MR_Save,C.classList.add("button_bottom"),C.classList.add("btn"),C.classList.add("btn-default"),(L=document.createElement("button")).setAttribute("id","idinternalsolveMR"),L.textContent=s.MR_InternalSolve,L.classList.add("button_bottom"),L.classList.add("btn"),L.classList.add("btn-default"),L.classList.add("displaynone"),m.appendChild(C),m.appendChild(v),m.appendChild(L),N=a,(R=new o({visible:!1,autoHide:!0,hideDelay:3e3,closeOnClick:!0,maximumVisibleMessages:3,className:"MRAlert"})).inject(b),S=l,T||(L.disabled=!0,C.disabled=!0,v.disabled=!0)},this.draw=function(){h.appendChild(b),h.appendChild(m),N.id?n.init("IDTABLE-sliderContentId",N.id,N,!1):n.init("IDTABLE-sliderContentId","random",N,!1),t.setConfigurationFeatureComponent(n),t.generateContainer(f,N,S,"notype"),"false"===window.localStorage.DS_MatrixruleCookie_ImgSetting?n.showHideFeatureOptionImages(!1):n.showHideFeatureOptionImages(!0)},this.getConflicts=function(){t.getConflicts()},this.displayAlertMessage=function(e,t){console.log("an alert from Solver inconsistency");var n="",i=0;for(i=0;i<e.length;i+=1)n+=e[i]+" MR_message";R.add({className:n,message:t}),R.show()},this.addInteraction=function(e,n){t.addInteraction(N,n),g.onclick=function(){g.classList.toggle("close"),g.classList.toggle("open"),f.classList.toggle("close"),f.classList.toggle("open"),p.classList.toggle("fonticon-right-dir"),p.classList.toggle("fonticon-left-dir"),c.classList.toggle("open"),c.classList.toggle("close"),u.classList.toggle("open"),u.classList.toggle("close")},C.onclick=function(){r.maskContainer(h);var e=!1;0!==A.getMatrixRulesController().getDrivingList().length&&0!==A.getMatrixRulesController().getConstrainedList().length||(e=!0);var t=A.getMatrixRulesController().getModel().simplifyJSON();if(e){var n=0;for(t.drivingFeatures=[],t.constrainedFeatures=[],n=0;n<A.getMatrixRulesController().getDrivingList().length;n+=1)t.drivingFeatures.push({id:A.getMatrixRulesController().getDrivingList()[n].logicalId});for(n=0;n<A.getMatrixRulesController().getConstrainedList().length;n+=1)t.constrainedFeatures.push({id:A.getMatrixRulesController().getConstrainedList()[n].logicalId})}var o=a.generateFullExpression(t,N);l.debug("json to save : "),l.debug(t),l.debug("mathematical Expression : "),l.debug(o),l.info("saving rule "+y);var d=null,c=i.getObjectIDFromURL("&productPID=");if(null==c){var u=o.baseURI.indexOf("&productPID=");if(-1!=u){var g=o.baseURI.indexOf("&",u+12);-1==g&&(g=o.baseURI.length),c=o.baseURI.substr(u+12,g-(u+12))}}if(d=e?i.saveRule(y,I,t,"",c):i.saveRule(y,I,t,o.outerHTML,c)){var p=JSON.parse(d);if(p.details){var f=p.details.id.substring(4);if(f!=y&&"content"==window.parent.parent.name){var m=window.parent.parent.location.search,b=m.indexOf("objectId=");if(-1!=b){b+=9;var v=m.indexOf("&",b);-1==v&&(v=m.length);var C=m.substring(b,v);m=m.replace(C,f),(L=window.parent.parent.getTopWindow()).bclist.setPosition(L.bclist.currentPosition()-1),window.parent.parent.location.href="../../common/emxTree.jsp"+m}else{var L;(L=window.parent.parent.getTopWindow()).bclist.setPosition(L.bclist.currentPosition()-1),window.parent.parent.location.href="../../common/emxTree.jsp?objectId="+f+"&mode=insert&DefaultCategory=RuleTable&AppendParameters=true"}}}}A.setFirstModel(t),r.unmaskContainer(h),n=0;var S=!0;for(n=0;n<R.getMessages().length;n+=1)if(r.hasClass(R.elements.container.childNodes[n],"mrsaved_conflict")){S=!1;break}for(S&&!e&&null!==d&&0!==A.getMatrixRulesController().getConflicts()&&R.add({className:"warning mrsaved_conflict MR_message",message:s.MR_SAVE_CONFLICT}),S=!0,n=0;n<R.getMessages().length;n+=1)if(r.hasClass(R.elements.container.childNodes[n],"mrsaved")){S=!1;break}S&&(null===d?R.add({className:"error mrsaved MR_message",message:s.MR_SAVE_ERROR}):R.add({className:"success mrsaved MR_message",message:s.MR_SAVE_OK})),R.show()},v.onclick=function(){l.debug("cancel clicked"),A.getMatrixRulesController().getMatrixRulesWrappedTableObj().getTopLeftTable().innerHTML="",A.getMatrixRulesController().getMatrixRulesWrappedTableObj().getTopRightTable().innerHTML="",A.getMatrixRulesController().getMatrixRulesWrappedTableObj().getBotLeftTable().innerHTML="",A.getMatrixRulesController().getMatrixRulesWrappedTableObj().getBotRightTable().innerHTML="",A.getMatrixRulesController().getDrivingUL().innerHTML="",A.getMatrixRulesController().getConstrainedUL().innerHTML="",A.getMatrixRulesController().setConstrainedList([]),A.getMatrixRulesController().setDrivingList([]),A.getMatrixRulesController().getMatrixRulesTableObj().reset(),f.innerHTML="",window.localStorage.DS_MatrixruleCookie_ImgSetting,E&&E.drivingCombinations?0==E.drivingCombinations.length?A.getMatrixRulesController().getModel().setNumberColumns(1):A.getMatrixRulesController().getModel().setNumberColumns(E.drivingCombinations.length):A.getMatrixRulesController().getModel().setNumberColumns(1),null!==E&&null!==E.drivingFeatures&&null!==E.constrainedFeatures&&void 0!==E.drivingFeatures&&void 0!==E.constrainedFeatures?(E.drivingFeatures.length>0&&E.constrainedFeatures.length>0?(E=A.getMatrixRulesController().checkAndRemoveDiscrepancy(E,e)._simplifiedModel,A.getMatrixRulesController().loadJsonIn(E,e,n),A.getMatrixRulesController().showCurrentView()):(A.getMatrixRulesController().setView("structView"),E=A.getMatrixRulesController().checkAndRemoveDiscrepancy(E,e)._simplifiedModel,A.getMatrixRulesController().loadJsonIn(E,e,n),A.getMatrixRulesController().showCurrentView(),A.getMatrixRulesController().setView("editView")),A.draw(),d?(A.addInteraction(e,n),A.addInteractionOnTable(e,n)):(A.addInteraction(e,n),A.removeInteractionOnTable(e,n)),A.getConflicts()):(A.getMatrixRulesController().setView("structView"),A.getMatrixRulesController().initUL(),A.getMatrixRulesController().showCurrentView(),A.draw(),A.getMatrixRulesController().setView("editView"),d?(A.addInteraction(e,n),A.addInteractionOnTable(e,n)):(A.addInteraction(e,n),A.removeInteractionOnTable(e,n)),A.getConflicts())}},this.removeInteractionOnTable=function(e,n){f.setAttribute("editable",!1),f.classList.remove("editable"),v.disabled=!0,C.disabled=!0,t.removeInteractionOnTable(e,n)},this.addInteractionOnTable=function(e,n){f.setAttribute("editable",!0),f.classList.add("editable"),t.addInteractionOnTable(e,n)};var E=null;this.setFirstModel=function(e){E=e},this.getFirstModel=function(){return E}}});