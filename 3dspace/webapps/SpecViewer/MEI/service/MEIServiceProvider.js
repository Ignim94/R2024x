define("DS/SpecViewer/MEI/service/MEIServiceProvider",["UWA/Class","DS/XSRCommonComponents/utils/Constants","DS/XSRCommonComponents/utils/RequestUtil","DS/XSRCommonComponents/utils/Notification"],function(e,t,n,r){"use strict";return e.extend({init:function(e){this.CSRFToken=n.get3DSpaceCSRFToken(),this.SourcingCSRFToken=n.getSourcingCSRFToken(),this.tenantID=n.getPlatformId(),this.baseUrl=n.get3DSpaceURL(),this.lang=n.getLanguage(),this.SC=n.getSecurityContext(),this.isCloud=n.isCloud(),e&&(this.appCore=e.appCore,this.currentTabKey=e.currentTabKey,this.modelContainer=e.modelContainer,this.contextItem=e.contextItem)},getServiceURL:function(e){var t=this.baseUrl+e.endpoint;return t.includes("?")?t+"&tenant="+this.tenantID:t+"?tenant="+this.tenantID},getSecurityContext:function(e){var t=this.SC;if(this.isCloud&&e){var n=t.lastIndexOf(".");return t.slice(0,n).concat(".SOURCING")}return this.SC},getHeaders:function(e){var t={"Content-Type":"application/json"};return e&&Object.keys(e).forEach(function(n){t[n]=e[n]}),t},processXInfraForm:function(e){return{items:[{attributes:{title:e.title,description:e.description,"dssrc:ManufacturerEquivalentReference":{partSource:e.partSource,partSourceURL:e.partSourceURL,manufacturerPartNumber:e.partNumber,manufacturer:e.manufacturer}}}]}},createMEI:function(e){var t=this;return e.source="3DSpace",e.addData=t.processXInfraForm(e.formValues),e.addData.csrf={name:"ENO_CSRF_TOKEN",value:t.CSRFToken},new Promise(function(r,a){n.send3DSpaceRequest("resources/v1/modeler/dssrc/dssrc:ManufacturerEquivalentItem?$mask=dsmvsrc:ManufacturerEquivalentItem.Details&tenant="+t.tenantID,"POST",{type:"json",headers:t.getHeaders({ENO_CSRF_TOKEN:t.CSRFToken,SecurityContext:t.getSecurityContext(),"Accept-Language":t.lang}),data:UWA.Json.encode(e.addData),canAddWorkUnderHeader:!1},r,a)})},getProxyObject:function(e,t,r){var a=this;e.source="3dspace",e.csrf={name:"ENO_CSRF_TOKEN",value:a.CSRFToken};return e.data=[{id:r,type:t,dataelements:{"ProxyItem.Proxy_Title":e.title,"ProxyItem.Proxy_Service":e.source,"ProxyItem.Proxy_State":e.state,"ProxyItem.Proxy_Tenant":a.tenantID}}],a.isCloud?new Promise(function(t,r){n.sendSourcingRequest("sourcing","resources/dssourcing/ProxyObject?"+a.tenantID,"POST",{type:"json",headers:a.getHeaders({ENO_CSRF_TOKEN:a.CSRFToken,"Accept-Language":a.lang}),data:UWA.Json.encode(e)},t,r)}):new Promise(function(t,r){n.send3DSpaceRequest("resources/dssourcing/ProxyObject?"+a.tenantID,"POST",{type:"json",headers:a.getHeaders({ENO_CSRF_TOKEN:a.CSRFToken,"Accept-Language":a.lang}),data:UWA.Json.encode(e)},t,r)})},listMEIs:function(e){var t=this;return t.isCloud?new Promise(function(r,a){n.sendSourcingRequest("sourcing","resources/v1/modeler/dssourcing/qualifications/context/"+e+"/equivalentqualifications?tenant="+t.tenantID,"GET",{type:"json",headers:t.getHeaders({ENO_CSRF_TOKEN:t.SourcingCSRFToken,SecurityContext:t.getSecurityContext(!0),"Accept-Language":t.lang}),data:void 0},r,a)}):new Promise(function(r,a){n.send3DSpaceRequest("resources/v1/modeler/dssourcing/qualifications/context/"+e+"/equivalentqualifications?tenant="+t.tenantID,"GET",{type:"json",headers:t.getHeaders({ENO_CSRF_TOKEN:t.CSRFToken,SecurityContext:t.getSecurityContext(),"Accept-Language":t.lang}),data:void 0},r,a)})},getMEIDetails:function(e,r){var a=this,s={};s.SecurityContext3DSpace=a.getSecurityContext(),s.csrf={name:"ENO_CSRF_TOKEN",value:a.CSRFToken},s.engItem=[];for(var o=0;o<e.length;o++){var i={};i.identifier=e[o],i.relativePath="resource/v1/dseng/dseng:EngItem/"+e[o],i.source=a.baseUrl,i.type=t.TYPE_VPMREFERENCE,s.engItem.push(i)}return new Promise(function(e,t){n.send3DSpaceRequest("resources/v1/modeler/dssrc/dssrc:ManufacturerEquivalentItems/Locate?$mask=dsmvsrc:ManufacturerEquivalentItem.Details&tenant="+a.tenantID,"POST",{type:"json",headers:a.getHeaders({ENO_CSRF_TOKEN:a.CSRFToken,SecurityContext:a.getSecurityContext(),"Accept-Language":a.lang}),data:UWA.Json.encode(s)},e,t)})},fetchQualification:function(e){var t=this;return t.isCloud?new Promise(function(r,a){n.sendSourcingRequest("sourcing","resources/v1/modeler/dssourcing/qualifications?$include=context-restrictions,target,Context&app=enxspiq&tenant="+t.tenantID,"POST",{type:"json",headers:t.getHeaders({ENO_CSRF_TOKEN:t.SourcingCSRFToken,SecurityContext:t.getSecurityContext(!0),"Accept-Language":t.lang}),data:UWA.Json.encode(e)},r,a)}):new Promise(function(r,a){n.send3DSpaceRequest("resources/v1/modeler/dssourcing/qualifications?$include=context-restrictions,target,Context&app=enxspiq&tenant="+t.tenantID,"POST",{type:"json",headers:t.getHeaders({ENO_CSRF_TOKEN:t.CSRFToken,SecurityContext:t.getSecurityContext(),"Accept-Language":t.lang}),data:UWA.Json.encode(e)},r,a)})},addInstance:function(e,t){var r=this;return r.isCloud?(t.csrf={name:"ENO_CSRF_TOKEN",value:r.SourcingCSRFToken},new Promise(function(e,a){n.sendSourcingRequest("sourcing","resources/v1/modeler/dssourcing/qualifications?$include=context-restrictions,target,Context&tenant="+r.tenantID,"POST",{type:"json",headers:r.getHeaders({ENO_CSRF_TOKEN:r.SourcingCSRFToken,SecurityContext:r.getSecurityContext(!0),"Accept-Language":r.lang}),data:UWA.Json.encode(t)},e,a)})):(t.csrf={name:"ENO_CSRF_TOKEN",value:r.CSRFToken},new Promise(function(e,a){n.send3DSpaceRequest("resources/v1/modeler/dssourcing/qualifications?$include=context-restrictions,target,Context&tenant="+r.tenantID,"POST",{type:"json",headers:r.getHeaders({ENO_CSRF_TOKEN:r.CSRFToken,SecurityContext:r.getSecurityContext(),"Accept-Language":r.lang}),data:UWA.Json.encode(t)},e,a)}))},removeInstance:function(e){var t=this;return t.isCloud?new Promise(function(r,a){n.sendSourcingRequest("sourcing","resources/v1/modeler/dssourcing/qualifications/"+e+"?$include=target,Context&tenant="+t.tenantID,"DELETE",{type:"json",headers:t.getHeaders({ENO_CSRF_TOKEN:t.SourcingCSRFToken,SecurityContext:t.getSecurityContext(!0),"Accept-Language":t.lang})},r,a)}):new Promise(function(r,a){n.send3DSpaceRequest("resources/v1/modeler/dssourcing/qualifications/"+e+"?$include=target,Context&tenant="+t.tenantID,"DELETE",{type:"json",headers:t.getHeaders({ENO_CSRF_TOKEN:t.CSRFToken,SecurityContext:t.getSecurityContext(),"Accept-Language":t.lang})},r,a)})},updateInstance:function(e,t){var r=this;return new Promise(function(a,s){n.send3DSpaceRequest("resources/v1/modeler/dssrc/dssrc:ManufacturerEquivalentItem/"+e+"?$mask=dsmvsrc:ManufacturerEquivalentItem.Details&tenant="+r.tenantID,"PATCH",{type:"json",headers:r.getHeaders({ENO_CSRF_TOKEN:r.CSRFToken,SecurityContext:r.getSecurityContext(),"Accept-Language":r.lang}),data:UWA.Json.encode(t)},a,s)})},deleteInstance:function(e){var t=this;return new Promise(function(r,a){n.send3DSpaceRequest("resources/v1/modeler/dssrc/dssrc:ManufacturerEquivalentItem/delete","POST",{type:"json",headers:t.getHeaders({ENO_CSRF_TOKEN:t.CSRFToken,SecurityContext:t.getSecurityContext(),"Accept-Language":t.lang}),data:UWA.Json.encode(e)},r,a)})},createGQForMEICreate:function(e,t){var n=this;return new Promise(function(e,a){var s;s=n.isCloud?n.SourcingCSRFToken:n.CSRFToken;var o={};o.csrf={name:"ENO_CSRF_TOKEN",value:s},o.data=[{type:"type_SRCGeneralQualification",dataelements:{Target_ID:t,"attribute_SRCQUALIFICATION.Comments":""}}],n.fetchQualification(o).then(function(t){t&&t.data&&e(t)}).catch(function(e){r.displayNotification({eventID:"error",msg:e.error?e.error:e.message})})})},associateMEIWithEQ:function(e,t,n,a){var s=this;return new Promise(function(o,i){var c,u;c=e&&e.formValues&&"Yes"===e.formValues.preferred?"TRUE":"FALSE",u=s.isCloud?s.SourcingCSRFToken:s.CSRFToken;var d={};d.csrf={name:"ENO_CSRF_TOKEN",value:u},d.data=[{type:"type_SRCEquivalentQualification",dataelements:{Target_ID:n,Context_ID:a,"attribute_SRCQUALIFICATION.Preferred":c}}],s.fetchQualification(d,t).then(function(e){e&&e.data&&o(e)}).catch(function(e){r.displayNotification({eventID:"error",msg:e.error?e.error:e.message})})})},getSuppliersIndustry:function(e){var t=this;return new Promise(function(r,a){n.sendSourcingRequest("3dnetwork","3drdfpersist/dsvnc/resources/v2/company/getSearchCriteria?tenant="+t.tenantID,"POST",{type:"json",headers:t.getHeaders({"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"}),data:UWA.Json.encode(e)},r,a)})},searchSuppliersByCriteria:function(e){var t=this;return new Promise(function(r,a){n.sendSourcingRequest("3dnetwork","3drdfpersist/dsvnc/resources/v2/company/searchSupplierCompanies?tenant="+t.tenantID,"POST",{type:"json",headers:t.getHeaders({"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"}),data:UWA.Json.encode(e)},r,a)})},getCompanyClassificationData:function(e){let t={nresults:500,order_field:"ds6w:label",with_indexing_date:!1,with_synthesis:!1,order_by:"asc",start:0,label:"test",login:{"3dspace":{SecurityContext:"ctx::VPLMProjectLeader.Company Name.Common Space"}},locale:"en",select_predicate:["ds6w:label","physicalid","name","ds6w:description","ds6w:identifier"],query:' flattenedtaxonomies:"types/General Class"  AND NOT current:Inactive',source:["3dspace"],tenant:(r=this).tenantID,resourceid_in:[],with_nls:!1,specific_source_parameter:{"3dspace":{search_in_context:{expand:[{multi_root_physicalid:[e.companyclassificationlibrary],expand_iter:"-1",type_filter_rel:["Subclass"]}]},option:{with_Idx_Search:!0}}}};var r=this;return new Promise(function(e,a){n.sendSourcingRequest("3DSearch","search?tenant="+r.tenantID,"POST",{type:"json",headers:r.getHeaders({"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"}),data:UWA.Json.encode(t)},e,a)})}})});