/*!  Copyright 2016 Dassault Systemes. All rights reserved. */
if(define("DS/TraceableRequirementsUtils/REQCommandProxy",["text!DS/TraceableRequirementsUtils/assets/RequirementCommandProxyResources.json","UWA/Core","UWA/Class","DS/PlatformAPI/PlatformAPI","DS/Logger/Logger"],function(e,t,r,n,i){"use strict";var s,o={},a=JSON.parse(e);for(var l in a)if(a.hasOwnProperty(l)){var c="on"+(s=l).charAt(0).toUpperCase()+s.slice(1);a[l].callback=c,o[c]=l}function u(){return(65536*(1+Math.random())|0).toString(16).substring(1)}function d(){var e="/no_private_channel";return"undefined"!=typeof widget&&null!==widget&&(void 0!==widget.getValue("x3dSharedId")?e="/"+widget.getValue("x3dSharedId"):void 0!==widget.getValue("x3dAppId")?e="/"+widget.getValue("x3dAppId"):void 0!==widget.getValue("appId")&&(e="/"+widget.getValue("appId")+"_"+widget.id)),e}function g(e){var t="DS/TraceableRequirementsUtils/REQCommandProxy/"+e;return UWA.is(a[e])&&!0===a[e].private&&(t+=d()),t}var p=r.extend({init:function(e,t,r){this.ownerProxyUid=e,this.eventHandlingFunction=t,this.ignoreMyEvents=r},handleEvent:function(e){var r=Date.now();if(t.debug&&(i.debug("Event received at %d, %dms after event creation",r,r-e.metadata.timestamp),i.debug("    %o",e.metadata)),!0===this.ignoreMyEvents&&e.metadata.originUid===this.ownerProxyUid)t.debug&&i.debug("Ignoring this event (sent by me)");else try{this.eventHandlingFunction(e.data,e.metadata)}catch(t){i.error("Error while handling event %o",e),i.error(t)}}}),f=r.extend({init:function(e){this.uid=u(),this.subscriptions=[],t.debug&&i.debug("Creating proxy %s",this.uid),this.addProxyEvents(e)},addProxyEvents:function(e){if(e)for(var r in e){var s=o[r];if(s){var a=e[r];if("function"==typeof a||Array.isArray(a)&&a.length>0&&"function"==typeof a[0]){var l,c=!0;"function"==typeof a?l=a:(l=a[0],c=a.length<2||!1!==a[1]);var u=new p(this.uid,l,c),d=g(s);t.debug&&i.debug("Subscribing to topic [%s]",d);var f=n.subscribe(d,u.handleEvent.bind(u));this.subscriptions.push(f)}else i.warn("Input [events.%s] is not a function",r)}else i.info("Input [events.%s] is not a known event",r)}},destroy:function(){t.debug&&i.debug("Destroying proxy [%s]",this.uid),this.subscriptions&&(t.debug&&i.debug("Unsubcribing"),this.subscriptions.forEach(function(e){n.unsubscribe(e)}),delete this.subscriptions),this.destroyed=!0}});for(var h in f.prototype._publish=function(e,r){if(!0===this.destroyed)throw new Error("This proxy has been destroyed");var s=g(e),o=function(e,t,r){return{metadata:{uid:u(),originUid:e,timestamp:Date.now(),appid:d(),originWidgetId:void 0!==r?r:"undefined"!=typeof widget&&null!==widget?widget.id:e},data:t}}(this.uid,r,this.odtWidgetId);t.debug&&(i.debug("Publishing to topic [%s]",s),i.debug("\t%o",o)),n.publish(s,o)},a)a.hasOwnProperty(h)&&(f.prototype[h]=function(e){return function(t){this._publish(e,t)}}(h));return f.create=function(e){var t;return e&&(t=e.events),new f(t)},f.appId=function(){return d()},f}),"undefined"!=typeof jQuery&&void 0!==jQuery.ui)define("DS/TraceableRequirementsUtils/jQueryUI",function(){"use strict";return jQuery.ui});else if(-1===require.toUrl("DS/VENENO6WPlugins/jQueryUI").indexOf("latest")){var lJQueryUIPath=require.toUrl("DS/VENENO6WPlugins/plugins/jqueryui/latest/js/");(lIndexOfQuestionMark=lJQueryUIPath.indexOf("?"))>-1&&(lJQueryUIPath=lJQueryUIPath.substring(0,lIndexOfQuestionMark)),require.config({paths:{"DS/VENENO6WPlugins/jQueryUI":lJQueryUIPath+"jquery.ui.custom.min"},shim:{"DS/VENENO6WPlugins/jQueryUI":{deps:["DS/TraceableRequirementsUtils/jQuery"],exports:"jQuery.ui"}}})}if(define("DS/TraceableRequirementsUtils/jQueryUI",["DS/VENENO6WPlugins/jQueryUI"],function(e){"use strict";return e}),define("DS/TraceableRequirementsUtils/REQClipboard",["UWA/Class","UWA/Class/Events","DS/Logger/Logger"],function(e,t,r){"use strict";var n=r.getLogger("DS/TraceableRequirementsUtils/REQClipboard"),i={OBJECT:null,POSITION:null},s=e.extend(t,{init:function(){this._parent();var e=this;document&&document.addEventListener&&document.addEventListener("keyup",function(t){27===t.keyCode&&(n.log("Clear the Clipboard"),e.clear())})},_checkpageAndThrow:function(e){if(n.debug('Checking if "%s" is a valid page',e),!i.hasOwnProperty(e))throw n.error("Check failed"),new Error('"'+e+'" is not a valid page')},setData:function(e,t){n.info('Setting data in page "%s"',e),n.debug("  Data %o",t),this._checkpageAndThrow(e),this.dispatchEvent("pre_setData",arguments),i[e]=UWA.clone(t),this.dispatchEvent("post_setData",arguments)},getData:function(e){return n.info('Getting data in page "%s"',e),this._checkpageAndThrow(e),UWA.clone(i[e])},consumeData:function(e,t){n.info('Consuming data in page "%s"',e);var r=this.getData(e);return t&&this.clear(e),r},clear:function(e){if(e)n.info('Clearing clipboard page "%s"',e),this._checkpageAndThrow(e),this.dispatchEvent("pre_clear",arguments),i[e]=void 0;else for(var t in n.info("Clearing clipboard"),this.dispatchEvent("pre_clear",arguments),i)i.hasOwnProperty(t)&&(i[t]=void 0);this.dispatchEvent("post_clear",arguments)},isEmpty:function(e){if(e){if(this._checkpageAndThrow(e),i[e])return!1}else for(var t in i)if(i.hasOwnProperty(t)&&i[t])return!1;return!0}}).singleton({init:function(){this._parent()}});for(var o in i)i.hasOwnProperty(o)&&(s[o]=o);return s}),define("DS/TraceableRequirementsUtils/views/TRMFloatingPanel",["UWA/Core","UWA/Class","UWA/Class/Options","DS/UIKIT/Input/Button","DS/UIKIT/Scroller","DS/ENOFloatingPanel/ENOFloatingPanel","DS/Logger/Logger"],function(e,t,r,n,i,s,o){"use strict";var a=t.extend(r,{name:"GenericReportPanel",_logger:null,options:{},init:function(e){this._parent(e);e.renderTo||(widget&&widget.body?e.renderTo=widget.body:e.renderTo=document.body),this._logger=o.getLogger(a),this.setOptions(e),this._createPanel(e)},_createPanel:function(t){var r=this;r._dialogBody=e.createElement("div",{class:"trm_floating_panel_body",id:"trm_floating_panel_body"}),r._dialogBody.innerText=t.innerText,r._footer=e.createElement("div"),t.button1&&(r.button1=new n({value:t.button1.title,name:t.button1.title,className:t.button1.className||"default",active:t.button1.active}),r.button1.addEvents({onClick:function(e){r._closePanel()}}),r.button1.inject(r._footer)),t.button2&&(r.button2=new n({value:t.button2.title,name:t.button2.title,className:t.button2.className||"default",active:t.button2.active}),r.button2.addEvents({onClick:function(e){r._closePanel()}}),r.button2.inject(r._footer)),t.button3&&(r.button3=new n({value:t.button3.title,name:t.button3.title,className:t.button3.className||"default",active:t.button3.active}),r.button3.addEvents({onClick:function(e){r._closePanel()}}),r.button3.inject(r._footer)),r._floatingComponent=new s({className:"trm_floating_panel",title:t.Title,body:r._dialogBody,footer:r._footer,overlay:!0,closable:!0,resizable:!0,animate:!0,events:{onResizeFloating:function(){r._logger.log("onResizeFloating")},onClose:function(){r._logger.log("onClose"),r._closePanel()}}}).inject(r.options.renderTo),new i({element:e.Element.getElement.call(r._floatingComponent.getBody(),".hierarchical_revision_dialog")}),r._floatingComponent.show()},_closePanel:function(){this._logger.log("close panel"),this._floatingComponent.hide(),this._floatingComponent.destroy()}});return a}),define("DS/TraceableRequirementsUtils/Command/ActionBar_CleanAllCmd",["DS/ApplicationFrame/Command","DS/i3DXCompassServices/i3DXCompassPubSub"],function(e,t){"use strict";return e.extend({name:"req_cleanAll",init:function(e){this._parent(e,{isAsynchronous:!0})},beginExecute:function(){},execute:function(){var e=this;require(["DS/PADUtils/PADContext"],function(r){t.publish("resetObject"),t.publish("resetX3DContent");var n=UWA.is(widget.getValue("X3DContentId"),"string")?JSON.parse(widget.getValue("X3DContentId")):null;UWA.is(n)&&UWA.is(n.data)&&(n.data.items=[],widget.setValue("X3DContentId",JSON.stringify(n))),r.get().cleanAll(),e.end()})},endExecute:function(){}})}),define("DS/TraceableRequirementsUtils/views/TRMDetachReportPanel",["UWA/Core","UWA/Class","UWA/Class/Options","DS/Controls/Tab","DS/Windows/Panel","DS/Windows/ImmersiveFrame","DS/Logger/Logger","i18n!DS/TraceableRequirementsUtils/assets/nls/TRMDetachReportPanel.json"],function(e,t,r,n,i,s,o,a){"use strict";var l=t.extend(r,{name:"GenericReportPanel",_logger:null,_panel:null,options:{},init:function(e){this._parent(e);e.renderTo||(widget&&widget.body?e.renderTo=widget.body:e.renderTo=document.body),this._logger=o.getLogger(l),this.setOptions(e),this._createPanel(e)},_fillTab:function(t,r,n,i){for(var s="<ul>",o=0,a=r.length;o<a;o++)s+="<li>"+r[o]+"</li>";s+="</ul>";var l=new e.Element("div",{html:s}),c=new e.Element("div",{styles:{padding:"2px","word-wrap":"break-word"}});return c.appendChild(l),{label:t+" ("+r.length+")",isSelected:i===n,content:c,index:n}},_createTab:function(e,t){var r=0;e.success.length>0&&(e.tab.add(this._fillTab(a.success,e.success,r,e.selectedIndex)),r++),e.failure.length>0&&(e.tab.add(this._fillTab(a.failure,e.failure,r,e.selectedIndex)),r++),e.neutral.length>0&&(e.tab.add(this._fillTab(a.neutral,e.neutral,r,e.selectedIndex)),r++),e.aborted.length>0&&(e.tab.add(this._fillTab(a.aborted,e.aborted,r,e.selectedIndex)),r++),e.tab.inject(t)},_createPanel:function(t){var r=this,o=new e.Element("div",{styles:{"vertical-align":"top","min-height":"286px",position:"relative"}}),a=new e.Element("div",{class:"wux-control-inline-container"});o.inject(a),r.immersiveFrame=new s,r.immersiveFrame.inject(r.options.renderTo);var l=r.ReportTabCont=new e.Element("div",{class:"wux-control-container"}),c=new n({displayStyle:"panel"});c.reorderFlag=!1,c.pinFlag=!0,c.showComboBoxFlag=!1,c.editableFlag=!1,c.multiSelFlag=!0,c.centeredFlag=!1,c.touchMode=!0;var u={tab:c,selectedIndex:0};void 0!==t.success&&null!==t.success&&Array.isArray(t.success)&&(u.success=t.success),void 0!==t.failure&&null!==t.failure&&Array.isArray(t.failure)&&(u.failure=t.failure),void 0!==t.neutral&&null!==t.neutral&&Array.isArray(t.neutral)&&(u.neutral=t.neutral),void 0!==t.aborted&&null!==t.aborted&&Array.isArray(t.aborted)&&(u.aborted=t.aborted),r._createTab(u,l),r._panel=new i({title:t.title,content:l,position:{my:"center",at:"center"},width:600,allowedDockAreas:0,immersiveFrame:r.immersiveFrame,resizableFlag:!0,collapsibleFlag:!1,minWidth:600,minHeight:85}),r._panel.addEventListener("close",r._onClosePanel.bind(r),!1),(u.success.length>15||t.failure.length>15||t.neutral.length>15||t.aborted.length>15)&&(r._panel.height=400),r._panel.elements.container.classList.add("AuthGenericReportPanel_Panel")},_onClosePanel:function(){this._panel.destroy(),this._panel=null,this.immersiveFrame.destroy(),this.immersiveFrame=null}});return l}),define("DS/TraceableRequirementsUtils/utils/TRMReportPanel",["UWA/Core","UWA/Class","UWA/Class/Options","DS/Controls/Tab","DS/Windows/Panel","DS/Windows/ImmersiveFrame","DS/Logger/Logger","i18n!DS/TraceableRequirementsUtils/assets/nls/TraceableRequirementsUtils"],function(e,t,r,n,i,s,o,a){"use strict";var l=t.extend(r,{name:"GenericReportPanel",_logger:null,_panel:null,options:{},init:function(e){this._parent(e);e.renderTo||(widget&&widget.body?e.renderTo=widget.body:e.renderTo=document.body),this._logger=o.getLogger(l),this.setOptions(e),this._createPanel(e)},_fillTab:function(t,r,n,i,s,o){for(var l="<ul>",c=0,u=r.length;c<u;c++){var d=r[c],g=(e.is(d.type,"object")?d.type.displayName:d.type)+" "+d.name+" "+d.revision,p=d.successMsg?d.successMsg:d.errorMsg,f=p?p=a[p]?a[p]:p:a[s+"_"+t+"_msg"];l+="<li>"+(f=f.replace("{TNR}",g))+"</li>"}l+="</ul>","Failure"!==t||o||(l+=a.FailureReasons);var h=new e.Element("div",{html:l}),m=new e.Element("div",{styles:{padding:"2px","word-wrap":"break-word"}});return m.appendChild(h),{label:a[t]+" ("+r.length+")",isSelected:i===n,content:m,index:n}},_createTab:function(e,t){var r=0;e.Success&&e.Success.length>0&&(e.tab.add(this._fillTab("Success",e.Success,r,e.selectedIndex,e.title)),r++),e.Failure&&e.Failure.length>0&&(e.tab.add(this._fillTab("Failure",e.Failure,r,e.selectedIndex,e.title,e.hasMsgFromAPI)),r++),e.neutral&&e.neutral.length>0&&(e.tab.add(this._fillTab("Neutral",e.neutral,r,e.selectedIndex,e.title)),r++),e.aborted&&e.aborted.length>0&&(e.tab.add(this._fillTab("Aborted",e.aborted,r,e.selectedIndex,e.title)),r++),e.tab.inject(t)},_createPanel:function(t){var r=this,o=new e.Element("div",{styles:{"vertical-align":"top","min-height":"286px",position:"relative"}}),l=new e.Element("div",{class:"wux-control-inline-container"});o.inject(l),r.immersiveFrame=new s,r.immersiveFrame.inject(r.options.renderTo);var c=r.ReportTabCont=new e.Element("div",{class:"wux-control-container"}),u=new n({displayStyle:"panel"});u.reorderFlag=!1,u.pinFlag=!0,u.showComboBoxFlag=!1,u.editableFlag=!1,u.multiSelFlag=!0,u.centeredFlag=!1,u.touchMode=!0;var d=t.reportData;d.tab=u,d.selectedIndex=0,d.title=t.title,d.hasMsgFromAPI=t.hasMsgFromAPI,r._createTab(d,c),r._panel=new i({title:a["title_"+t.title],content:c,position:{my:"center",at:"center"},width:600,allowedDockAreas:0,immersiveFrame:r.immersiveFrame,resizableFlag:!0,collapsibleFlag:!1,minWidth:600,minHeight:85}),r._panel.addEventListener("close",r._onClosePanel.bind(r),!1),r._panel.elements.container.classList.add("AuthGenericReportPanel_Panel")},_onClosePanel:function(){this._panel.destroy(),this._panel=null,this.immersiveFrame.destroy(),this.immersiveFrame=null}});return l}),define("DS/TraceableRequirementsUtils/Command/ReqNextGenFilterCmd",["DS/ENONextGenFilterCmd/commands/ENONextGenFilterCmd","DS/PADUtils/PADContext","DS/PADUtils/PADUtilsServices","DS/PADUtils/PADSession"],function(e,t,r,n){"use strict";return e.extend({_openFilterPanelNow:!1,_selectionId:-1,init:function(e){this._parent(e);var r=this;t.get().getPADTreeDocument().getModelEvents().subscribe({event:"onRemoveRoot"},function(e){UWA.is(r.removeFilter,"function")&&r.removeFilter({widgetId:r.getAppParams().widgetId,rootIds:[e.data.pid]}),t.get()._biFilter&&t.get()._biFilter.removeRoot(e.data.pid)}),n.subscribe({event:"authoringStateModified"},function(e){if("function"==typeof r.hasSelection)var t=r.hasSelection();t||!e.authored?r.enable():r.disable()});var i=t.get().getPADTreeDocument().getXSO();i.onChange(function(){i.isEmpty()||n.determineAuthoredFlag()?r.disable():r.enable()})},getWidgetId:function(){return r.getWidgetId()},getAppParams:function(){return{widgetId:r.getWidgetId(),appId:r.getSharedId()}},getSelectorManager:function(){return t.get().getPADTreeDocument().getXSO()||null},setOpenFilterNow:function(e){this._openFilterPanelNow=!0,this._selectionId=e},getRoots:function(){if(!1!==this._openFilterPanelNow){this._openFilterPanelNow=!1;var e=[],r=t.get().options.model.getNodesById(this._selectionId)[0],n={};return r.isRoot()?n=r:(n=r.getRoot()).select(),e.push({id:n.getID(),label:n.getLabel(),filtered:n.options.sequence_filter||n.options.config_filter?1:0}),e}return t.get().getPADTreeDocument().getRoots().map(function(e){return{id:e.getID(),label:e.getLabel(),filtered:e.options.sequence_filter||e.options.config_filter?1:0}})},getSelection:function(){var e=t.get().getPADTreeDocument().getSelectedNodes(),r={path:[],label:[]};return e.forEach(function(e){r.path.push(e.getOccurencePath()),r.label.push([e.getLabel()])}),r}})}),define("DS/TraceableRequirementsUtils/Command/ActionBar_AttributeManagementCmd",["DS/ApplicationFrame/Command","DS/RequirementAttrManagement/views/AttributesCustomization","DS/Windows/Dialog","DS/Controls/Button","DS/PADUtils/PADContext","DS/Windows/ImmersiveFrame"],function(e,t,r,n,i,s){"use strict";function o(e){if(e){if(!e.elements||!e.elements.container)return void(e=null);e.getContent()&&(e.content="")}}return e.extend({init:function(e){this._parent(e);var t=this;this.enable(),t.localContext=i.get(),console.log("#AttributesManagementCmd: init called"),this.dialog=null,t.localContext._applicationChannel.subscribe({event:"ENXViews/Views/showInWidgetBody"},function(e){if(e&&e.restore){try{o(t.dialog),t.dialog&&t.dialog.close(),t.dialog=null}catch(e){console.error(e),t.dialog=null}t.localContext._applicationChannel.publish({event:"event-change-structure-view-changed",data:e.refreshStructure})}else{try{o(t.dialog),t.dialog&&t.dialog.close(),t.dialog=null}catch(e){console.error(e),t.dialog=null}t.dialog=new r({title:"Attribute Management",content:e.html,immersiveFrame:t.localContext.getAppImmersiveFrame(),resizableFlag:!0}),t.dialog.maximizedFlag=!0,t.dialog.maximizeButtonFlag=!1}})},execute:function(e){var r=i.get(),n={COLUMNS_EXPORT:"export",TOOLBAR_ACTION_MORE_ATTRIBUTES:"moreAttributes",TOOLBAR_ACTION_DIVISER:"diviser",TOOLBAR_ACTION_MOVE_UP:"moveUp",TOOLBAR_ACTION_MOVE_DOWN:"moveDown",TOOLBAR_ACTION_MOVE_TOP:"moveFirst",TOOLBAR_ACTION_MOVE_BOTTOM:"moveLast",TOOLBAR_ACTION_CHANGE_COLOR:"changeColor",TOOLBAR_ACTION_REMOVE:"trash"};r.isAttributeManagmentEnabled()||(n.TOOLBAR_DEFAULT_ACTIONS=["moreAttributes","diviser","trash"]),r.attribute_customization=new t({modelEvents:this.localContext._applicationChannel,viewMode:"comfortable",configuration:{providedColumns:[],selectedColumns:[]},toolbarActions:n.TOOLBAR_DEFAULT_ACTIONS,appColumns:r.columnManager.getAvailableColumnsWithNls(),baseTypes:r.getBaseReferenceTypes(),baseExtensions:r.getBaseExtensions(),baseInstanceTypes:r.getBaseInstanceTypes(),selectedTypes:r.getSelectedTypes(),selectedExtensions:r.getSelectedExtensions(),withDgv:!0,rowHeaderActivated:!0}),this.end()}})}),define("DS/TraceableRequirementsUtils/views/TRMDetachDlgConfirm",["UWA/Controls/Abstract","UWA/Class/Events","DS/UIKIT/SuperModal","DS/Controls/Toggle","i18n!DS/TraceableRequirementsUtils/assets/nls/TraceableRequirementsUtils"],function(e,t,r,n,i){return e.extend(t,{init:function(e){var t=this;this.className="TRMDetachDlgConfirm_modal",this.options=e,t.confirmModal=new r({className:this.className,closable:!0,okButtonText:e.action,animate:!0,renderTo:e.renderTo});var s=e.callback;e.callback=function(e){if(e){var r=t.displayToggle.checkFlag;localStorage.setItem("TRMDetachLocalStorage",!r)}s(e)},t.confirmModal.confirm(e),this.displayToggle=new n({type:"checkbox",label:i.displayAgain,checkFlag:!1});var o=document.querySelector("."+this.className+" .modal-body");this.displayToggle.inject(o)}})}),define("DS/TraceableRequirementsUtils/utils/TRMConstant",["UWA/Core"],function(e){"use strict";return Object.freeze({OPEN:"open",OPENWITHCONTEXT:"openWithContext",FILTERANDOPEN:"filterAndOpen",TYPE_FILTER:"ENOStrRefinementSpecification",TYPE_REQUIREMENT:"Requirement",TAG_SUCCESS:"success",TAG_ERROR:"error",TAG_WARNING:"warning",TAG_PRIMARY:"primary"})}),-1===require.toUrl("DS/VENREQPlugins/Fancytree").indexOf("latest")){var lFancytreePath=require.toUrl("DS/VENREQPlugins/External/fancytree/latest/media/");(lIndexOfQuestionMark=lFancytreePath.indexOf("?"))>-1&&(lFancytreePath=lFancytreePath.substring(0,lIndexOfQuestionMark)),require.config({paths:{"DS/VENREQPlugins/Fancytree":lFancytreePath+"jquery.fancytree-all.min"},shim:{"DS/VENREQPlugins/Fancytree":{deps:["DS/TraceableRequirementsUtils/jQueryUI","DS/TraceableRequirementsUtils/jQuery"],exports:"jQuery.ui.fancytree"}}})}if(define("DS/TraceableRequirementsUtils/Fancytree",["DS/VENREQPlugins/Fancytree"],function(e){"use strict";return e}),define("DS/TraceableRequirementsUtils/Command/TRMRootInfoPanel",["UWA/Core","DS/ApplicationFrame/CommandCheckHeader","DS/PADUtils/PADContext"],function(e,t,r){"use strict";return t.extend({_context:null,_callbackAdd:!1,init:function(e){this._parent(e,{}),this._context=r.get(),this._change_state_from_close=!1;var t=this;t._context.structureEditor.reqshell&&t._context.structureEditor.reqshell._modelEvents&&t.addCallback(),t=this,this.onStateChange(function(){t._change_state_from_close?t._change_state_from_close=!1:t._context.structureEditor.togglePanel("left")})},addCallback:function(){var e=this;!1===this._callbackAdd&&(this._context.structureEditor.reqshell._modelEvents.subscribe({event:"triptych-hide-panel"},function(t){"left"===t&&(e._change_state_from_close=!0,e.setState(!1,!1))}),e._callbackAdd=!0)}})}),define("DS/TraceableRequirementsUtils/utils/RequirementErrorManager",["UWA/Class","i18n!DS/TraceableRequirementsUtils/assets/nls/TraceableRequirementsUtils"],function(e,t){"use strict";return e.singleton({getParseErrorMessage:function(e,r,n){var i="";if(e&&e.code)return e.reason&&"UNKNOWN_META"==e.code?"Index expansion failed for the columns: "+e.reason.split("[")[1].split("]")[0]:e.code;i=UWA.is(r,"string")&&!r.isEmpty()?r:UWA.is(e,"string")&&!e.isEmpty()?e:UWA.is(e)&&e instanceof Object?e.message?e.message:e.errorCode:"";try{i=JSON.parse(i)}catch(e){i=i}return(i=UWA.is(i.message)?UWA.is(t[i.message])?t[i.message]:i.message:UWA.is(i.errorMessage)?i.errorMessage:i).startsWith("NetworkError")?i.endsWith('return ResponseCode with value "0".')||e.errorCode?t.NetworkError:i:i.startsWith("The request has timedout")?t.timedOut+" "+t.verifyConnection:UWA.is(n)?n:i}})}),define("DS/TraceableRequirementsUtils/Command/ReqCmdBase",["DS/ApplicationFrame/Command","DS/PADUtils/PADContext","DS/RequirementFrameUtils/utils/RequirementFrameConstant"],function(e,t,r){"use strict";return e.extend({init:function(e){this._parent(e,{isAsynchronous:!0}),t.get()&&(this._check_select(),t.get().getPADTreeDocument().getXSO().onChange(this._check_select.bind(this)))},_check_select:function(){var e=this.options.ID,n=!"ENORERV_AP".localeCompare(widget.getValue("appId"));if(UWA.is(t.get())&&UWA.is(t.get().getSelectedNode))var i=t.get().getSelectedNode();if(UWA.is(i)){var s=i.options.kindof;s==r.TYPE_REQUIREMENT_SPECIFICATION?e==r.TRM_INSERT_SPECFOLDER||!n&&e==r.TRM_INSERT_SPEC||e==r.TRM_INSERT_EXISTING_SPECFOLDER||e==r.TRM_INSERT_EXISTING_SPEC?this.disable():this.enable():s==r.TYPE_CHAPTER?e==r.TRM_INSERT_SPECFOLDER||!n&&e==r.TRM_INSERT_SPEC||e==r.TRM_INSERT_EXISTING_SPECFOLDER||e==r.TRM_INSERT_EXISTING_SPEC?this.disable():this.enable():s==r.TYPE_REQUIREMENT?e==r.TRM_INSERT_SPECFOLDER||!n&&e==r.TRM_INSERT_SPEC||e==r.TRM_INSERT_CHAPTER||e==r.TRM_INSERT_COMMENT||e==r.TRM_INSERT_EXISTING_SPECFOLDER||e==r.TRM_INSERT_EXISTING_SPEC||e==r.TRM_INSERT_EXISTING_CHAPTER||e==r.TRM_INSERT_EXISTING_COMMENT?this.disable():this.enable():s==r.TYPE_COMMENT?e==r.TRM_INSERT_SPECFOLDER||!n&&e==r.TRM_INSERT_SPEC||e==r.TRM_INSERT_CHAPTER||e==r.TRM_INSERT_COMMENT||e==r.TRM_INSERT_REQUIREMENT||e==r.TRM_INSERT_EXISTING_SPECFOLDER||e==r.TRM_INSERT_EXISTING_SPEC||e==r.TRM_INSERT_EXISTING_CHAPTER||e==r.TRM_INSERT_EXISTING_COMMENT||e==r.TRM_INSERT_EXISTING_REQUIREMENT?this.disable():this.enable():s==r.TYPE_REQUIREMENT_GROUP&&(e==r.TRM_INSERT_CHAPTER||e==r.TRM_INSERT_COMMENT||e==r.TRM_INSERT_REQUIREMENT||e==r.TRM_INSERT_EXISTING_CHAPTER||e==r.TRM_INSERT_EXISTING_COMMENT||e==r.TRM_INSERT_EXISTING_REQUIREMENT)?this.disable():this.enable()}else e==r.TRM_INSERT_SPECFOLDER||e==r.TRM_INSERT_SPEC||e==r.TRM_INSERT_REQUIREMENT?this.enable():this.disable()}})}),define("DS/TraceableRequirementsUtils/utils/SearchUtils",["UWA/Utils/InterCom","DS/Utilities/Utils"],function(e,t){"use strict";function r(){return"object"==typeof r.instance?r.instance:(r.instance=this,this)}return r.prototype.inAppsSearch=function(r){var n,i=Object.assign({mode:"furtive",default_with_precond:!0,widget_id:"default-widget-id",app_socket_id:"enosearchutils_default-widget-id",idcard_activated:!1,multiSel:!0,advanced_search:{showByDefault:!1},tenant:(n=widget.getValue("x3dPlatformId"))&&""!==n?n:"OnPremise"},r),s=new e.Socket(i.app_socket_id,{dispacthRetryInterval:0});!0===r.debug_mode&&s.setDebugMode(!0),UWA.is(r.parent_window)?s.subscribeServer("SearchComServer",window):s.subscribeServer("SearchComServer"),s.dispatchEvent("RegisterContext",i),UWA.is(r.context_name)&&(i.context_title=r.context_name),i.default_search_criteria=r.fts_value,s.dispatchEvent("InContextSearch",i);var o=[];s.addListener("Selected_Objects_search",function(e){o=e});var a=t.debounce(function(e){switch(e.command_id){case"in_app_ok":r.callback.call(null,o);break;case"in_app_apply":r.apply?r.apply.call(null,o):r.callback.call(null,o);break;default:r.cancel_callback.call(null,o)}s.dispatchEvent("UnregisterContext",{widget_id:i.widget_id})},200);s.addListener("closeTransient",a),s.addListener("onCloseTransient",function(e){r.cancel&&r.cancel.call(null),s.dispatchEvent("UnregisterContext",{widget_id:i.widget_id})})},new r}),"undefined"!=typeof jQuery)define("DS/TraceableRequirementsUtils/jQuery",function(){"use strict";return jQuery});else if(-1===require.toUrl("DS/VENENO6WPlugins/jQuery").indexOf("latest")){var lIndexOfQuestionMark,lJQueryPath=require.toUrl("DS/VENENO6WPlugins/plugins/jquery/latest/");(lIndexOfQuestionMark=lJQueryPath.indexOf("?"))>-1&&(lJQueryPath=lJQueryPath.substring(0,lIndexOfQuestionMark)),require.config({paths:{"DS/VENENO6WPlugins/jQuery":lJQueryPath+"jquery"},shim:{"DS/VENENO6WPlugins/jQuery":{exports:"jQuery"}}})}define("DS/TraceableRequirementsUtils/jQuery",["DS/VENENO6WPlugins/jQuery"],function(e){"use strict";return e.noConflict(),e}),define("DS/TraceableRequirementsUtils/utils/RequirementServicesUtil",["DS/WAFData/WAFData","DS/PADUtils/PADContext"],function(e,t){var r=document.createElement("textarea");function n(e,t,r){let n=void 0;if(t>-1&&(n=[{truncate:{max_distance_from_prefix:t,prefix_filter:{prefix_path:e}}}]),r.searchOptions&&(n=[{truncate:{max_distance_from_prefix:0,compute_matching_subpaths_lengths:1,match_only_refs:1,sequence_filter:{sequence:[{uql:i(r)}]}}}]),r.tagger_select){n=[{truncate:{max_distance_from_prefix:0,compute_matching_subpaths_lengths:1,match_only_refs:1,sequence_filter:r.BIProxy.buildSpecFromAppIntent({V2:{tagger_select:r.tagger_select}}).sequence_filter}}]}return n}function i(e){let t=null;return(e.attributesToSearch?e.attributesToSearch:[]).forEach(r=>{if(e.searchOptions){let n="["+r+"]:(*"+e.searchOptions.searchString+"*)";t=t?t+" OR "+n:n}}),t}function s(e){var t="";return e.forEach(function(e){""!==t&&(t+=" OR "),t+='(flattenedtaxonomies:"reltypes/'+e+'")'}),console.log(t),{descending_condition_relation:{uql:"("+t+")"}}}function o(e){return r.innerHTML="",r.innerHTML=e,r.value}return{executeRequest:function(t,r){return r.timeout=1e9,t=this.appendTenantInUrl(t),r.headers&&(r.headers.Accept="application/json",r.headers["Cache-Control"]="no-cache",r.headers["Content-Type"]="application/json"),e.authenticatedRequest(t,r)},createBatchForExpandV2:function(e,t){var r,o,a={expands:[]},l=e.pathsWithRoot,c=e.expandLevel,u=Object.keys(l),d=e.queryLabel;c||0===c||(c=-1);for(var g=0;g<u.length;g++){for(var p,f=l[u[g]],h=[],m=0;m<f.length;m++)h.push({physical_id_path:f[m]});if(e.BIProxy&&(p=e.BIProxy.getFilterSpec(u[g],{V2:{}})),p||(p={filter:{all:1}}),e.searchOptions){let t=(r=u[g],o=e,{prefixPathArray:function(e,t){let r=null;if(t&&t.length){r=[];for(const e of t)r.push({physical_id_path:e})}else r=[{physical_id_path:e}];return r}([r]),find_in_context:i(o)});p=e.BIProxy.getFilterSpec(u[g],{V2:t||{}})}e.tagger_select&&(p=e.BIProxy.getFilterSpec(u[g],{V2:{prefixPathArray:h,tagger_select:e.tagger_select}}));let v=n(h,c,e);Array.isArray(p.aggregation_processors)&&p.aggregation_processors.length>0&&(v=v?v.concat(p.aggregation_processors):p.aggregation_processors);let S={label:d,root:{physical_id:u[g]},graph:s(t),filter:p.filter,aggregation_processors:v};e.searchOptions&&(S.parameters=e.searchOptions.parameters),a.expands.push(S)}return a},_requestOptions:function(e,t){return{method:t,headers:{Accept:"application/json","Content-Type":"application/json"},onComplete:e.onComplete?e.onComplete:void 0,onFailure:e.onFailure?e.onFailure:void 0,onTimeout:e.timeout?e.timeout:void 0}},parseResponse:function(e){let t,r=(e=UWA.is(e,"string")?JSON.parse(e):e).results?e.results:[];return e.infos?0===(t=this._parseIndexResponse(r)).results.length&&(t=e):t=this._parseAuthoringResponse(r),t},_mapAuthoringValuesToIndexPredicate:function(e){let r=t.get(),n=[];const i={physicalid:"resourceid",LastVersion:"ds6w:isLastRevision","physicalid[connection]":"relationid",owner:"ds6w:responsible",policy:"ds6w:policy",type_icon_url:"icon","attribute[TreeOrder]":"spec.TreeOrder","attribute[Content Data]":"ds6wg:contentData","attribute[Content Type]":"ds6wg:contentType"};return e.forEach(function(e){let t={};for(var s in e){let n=e[s];switch(s){case"name":t["ds6w:identifier"]=n,t[s]=n;break;case"from.physicalid":t.from=n;break;case"interface":t.interface=n.name?n.name:n;break;case"type":UWA.is(n,"object")?(t.type=n.value,t["ds6w:type"]=n.value):t.type=n;break;case"current":t["ds6w:status"]=o(e.policy+"."+n.value);break;default:if(i.hasOwnProperty(s))UWA.is(n,"object")?t[i[s]]=o(n.displayName):t[i[s]]=o(n);else{let e=r.getAttributeInfo?r.getAttributeInfo(s):[];e.length>0&&e[0].dataIndex?UWA.is(n,"object")?t[e[0].ds6w]=o(n.value):t[e[0].ds6w]=o(n):t[s]=o(n)}}}n.push(t)}),n},_parseAuthoringResponse:function(e){let t={results:[]};e.Success&&(t.results={Success:[],Failure:e.Failure},e=e.Success);var r=this._mapAuthoringValuesToIndexPredicate(e);return t.results&&t.results.Success?t.results.Success=r:t.results=r,t},_parseIndexResponse:function(e){let t={results:[]},r=new Map,n=new Map;return t.matchedNode=[],e.forEach(function(e){let i={};if(e.attributes){e.attributes.forEach(function(e){let t=e.name,r=e.dispValue?e.dispValue:e.value;i[t]?i[t]=UWA.is(i[t],"string")&&UWA.is(r,"string")?[i[t],r].join(","):r:i[t]=r}),t.results.push(i)}else if(void 0!==e.to){let i=e.resourceid;e.relationid=i,delete e.resourceid;let s=r.get(e.to),o=UWA.clone(s);UWA.extend(o,e),t.results.push(o),n.set(e.to,o)}else if(e.Path){if(e.matching_lengths)for(const r of e.matching_lengths)e.Path.length>r&&t.matchedNode.push(e.Path[r-1]);t.matchedNode.push(e.Path[e.Path.length-1])}else r.set(e.resourceid,e)}),r.forEach(function(e,r){r&&!n.get(r)&&t.results.push(e)}),t}}}),define("DS/TraceableRequirementsUtils/utils/RequirementAlertManager",["DS/Notifications/NotificationsManagerUXMessages","DS/Notifications/NotificationsManagerViewOnScreen"],function(e,t){"use strict";return{_notif_manager:null,init:function(r){null===this._notif_manager&&(this._notif_manager=e,t.setNotificationManager(this._notif_manager),t.setStackingPolicy(5),t.setRemoveStackOnFirstTimeoutFlag(!0),t.setFadeOutPolicy(2))},errorAlert:function(e){this._notif_manager||this.init(),t.elements.container.style.zIndex=12e3,this._notif_manager.addNotif({level:"error",message:e,sticky:!1})},sucessAlert:function(e){this._notif_manager||this.init(),t.elements.container.style.zIndex=12e3,this._notif_manager.addNotif({level:"success",message:e,sticky:!1})},notifyAlert:function(e){this._notif_manager||this.init(),t.elements.container.style.zIndex=12e3,this._notif_manager.addNotif({level:"info",message:e,sticky:!1})},warningAlert:function(e){this._notif_manager||this.init(),t.elements.container.style.zIndex=12e3,this._notif_manager.addNotif({level:"warning",message:e,sticky:!1})}}}),define("DS/TraceableRequirementsUtils/Command/ActionBar_InsertExternalObject",["UWA/Core","DS/Logger/Logger","DS/TraceableRequirementsUtils/Command/ReqCmdBase","DS/TraceableRequirementsUtils/utils/RequirementAlertManager","DS/TraceableRequirementsUtils/utils/RequirementErrorManager","i18n!DS/TraceableRequirementsUtils/assets/nls/TraceableRequirementsUtils","text!DS/TraceableRequirementsUtils/assets/RequirementRelationshipsPatterns.json","i18n!DS/RequirementStructureBrowser/assets/nls/ENOREQ.json"],function(e,t,r,n,i,s,o,a){"use strict";var l=r.extend({name:"REQ_ACTION_BAR",_logger:null,_options:null,init:function(e){this._logger=t.getLogger(l),this._options=e,this._parent(e,{mode:"exclusive",isAsynchronous:!1}),this._relPattern=JSON.parse(o)},beginExecute:function(){this._logger.log(this._id+".beginExecute")},execute:function(){var e=this,t="",r=e._options.arguments[2].operation;if(t="selectionDialog"===r?s.InsertExistExtReq:s.InsertNewExtReq,"enopad_odt_wgd"!=widget.id||"dummy"!=widget.id)try{require(["DS/LifecycleCmd/OSLCConsumerCmd","DS/PADUtils/PADContext","DS/TraceableRequirementsUtils/Utils","DS/TraceableRequirementsUtils/Services/RequirementWebServices","DS/ApplicationFrame/CommandsManager"],function(o,l,c,u,d){var g=l.get(),p=d.getCommand("OSLCConsumerHdr",g.options.action_bar_opts&&g.options.action_bar_opts.context?g.options.action_bar_opts.context:null);p.setup({title:t,resourceType:"http://open-services.net/ns/rm#Requirement",operation:r,proxyType:"Requirement Proxy",providerFilter:"RM",securityContext:c.getSecurityContext(),tenantId:c.getTenant(),singleObject:!0,notification:function(t){if(UWA.is(t.error))n.errorAlert(t.error);else if(UWA.is(t.objects,"array")){if(0===t.objects.length)return console.log("result:"),void console.log(t);var r=g.getSelectedElement(),o=r.physicalid,l=(r.type,r.kindof,{dataArray:[]}),d=t.objects[0].proxy.id,p=e._options.arguments[1].relType;l.dataArray.push({pid:o,id:d,relationship:p,previousSibling:{},nextSibling:{}}),UWA.is(p)&&(g.beginBlockingTransaction(a.composite),u.insertExisting({securityContext:c.getSecurityContext(),json:l,onComplete:function(t){e._logger.log("WS insertExisting.onComplete");var r=(UWA.is(t,"string")?JSON.parse(t):t).results;if(g.refreshOnInsert(r,null,"insertExisting"),r.Success.length>0){var i=r.Success[0],o=(UWA.is(i.type,"object")?i.type.displayName:i.type)+" "+i.name+" "+i.revision;a=(a=s.InsertExisting_Success_msg).replace("{TNR}",o),n.sucessAlert(a),g.endBlockingTransaction()}if(r.Failure.length>0){var a;i=r.Failure[0],o=(UWA.is(i.type,"object")?i.type.displayName:i.type)+" "+i.name+" "+i.revision;a=(a=s.InsertExisting_Failure_msg+" "+s.FailureReasons).replace("{TNR}",o),n.errorAlert(a)}},onFailure:function(t){e._logger.log("WS insertExisting.onFailure");var r=i.getParseErrorMessage(t);n.errorAlert(r),g.endBlockingTransaction()},onTimeout:function(t){e._logger.warn("WS insertExisting.onTimeout");var r=i.getParseErrorMessage(t);n.errorAlert(r),g.endBlockingTransaction()}}))}}}),p.execute()})}catch(e){console.log("DS/OSLCConsumer/OSLCConsumer file not found")}},endExecute:function(){this._logger.log(this._id+".endExecute")}});return l}),define("DS/TraceableRequirementsUtils/Utils",["UWA/Core","DS/Logger/Logger","DS/TraceableRequirementsUtils/utils/RequirementServicesUtil","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","UWA/Utils/Client","DS/PlatformAPI/PlatformAPI","UWA/Class/Promise","DS/PADUtils/PADSession","DS/TraceableRequirementsUtils/utils/TRMSearchNav"],function(e,t,r,n,i,s,o,a,l){"use strict";var c,u,d,g=document.createElement("textarea"),p=t.getLogger("DS/TraceableRequirementsUtils/Utils"),f=function(e,t){return this.channels[e]||(this.channels[e]=[]),this.channels[e].push({context:this,callback:t}),this},h=function(e){if(!this.channels[e])return!1;for(var t=Array.prototype.slice.call(arguments,1),r=0,n=this.channels[e].length;r<n;r++){var i=this.channels[e][r];i.callback.apply(i.context,t)}return this},m={mediator:{channels:{},publish:h,subscribe:f,installTo:function(e){e.channels={},e.subscribe=f,e.publish=h}},getSecurityContextForProperties:function(){var e="";return e="ENOLCMT_AP"===this.getAppId()?widget.data.securityContext:this.getSecurityContext(),UWA.is(e,"string")&&-1===e.indexOf("ctx::")&&(e="ctx::"+e),e},getSecurityContext:function(){var e=widget.getValue("trm_security_ctx");if(UWA.is(e)&&""!==e||""!==(e=widget.getValue("pad_security_ctx")))return UWA.is(e,"string")&&-1===e.indexOf("ctx::")&&(e="ctx::"+e),e},getChunks:function(e,t){let r,n,i=[];for(r=0,n=e.length;r<n;r+=t){let n={physicalid:e.slice(r,r+t)};i.push(n)}return i},appendTenantInUrl:function(e){if(e.includes("tenant="))return e;let t=this.getTenant();return e+=e.includes("?")?"&tenant="+t:"?tenant="+t},getTenant:function(){var e=widget.getValue("x3dPlatformId");if(UWA.is(e))return UWA.is(e.value)?e.value:e},setXPrefCredentials:function(e,t){var r=t.replace("ctx::","");e.setValue("xPref_CREDENTIAL",r),e.setValue("tenantAware",!0)},computeDisplayName:function(e,t){var r=e.name,n=UWA.is(t,"string")?JSON.parse(t):t,i=n.treeDisplayName,s=n.treeDisplayTitle,o=n.treeDisplayRevision,a=n.treeDisplaySeperation,l=n.treeDisplayTitleMaxSize;l=Math.floor(l);var c=e.title,u="  ";return""!==a&&"false"!==a&&(u=" | "),"false"!==i&&""!==i&&"false"!==s&&""!==s&&0!==c.length&&(r=e.name+u+c),"false"!==i&&""!==i||"false"===s||""===s||0===c.length||(r=c),"false"!=o&&""!=o&&(r+=u+e.revision),"false"!==i&&""!==i||"false"!==s&&""!==s||"false"!==o&&""!==o||(r=c+" "+e.revision),r},computeSubLabel:function(e){let t=e.grid["ds6w:status"]?e.grid["ds6w:status"]+" | ":"",r=e.grid["ds6w:responsible"]?e.grid["ds6w:responsible"]+" | ":"",n=e.grid["ds6w:modified"]?e.grid["ds6w:modified"]:"",i=t+r+n;return n||(i=i.slice(0,-2)),i},app_initialization:function(e){if(p.log("app_initialization"),!UWA.is(e,"function"))throw new Error("Invalid callback for the REQ app initialization");n.getPlatformServices({onComplete:function(t){c=t,e.call(null)},onFailure:function(e){throw p.error("Cannot retrieve the Platform Services"),new Error("Cannot retrieve the Platform Services")}});try{n.getServiceUrl({serviceName:"3DSearch",platformId:widget.getValue("x3dPlatformId"),onComplete:function(e){"string"==typeof e?u=e:(u=e[0].url,e.forEach(function(e){e.platformId==widget.getValue("x3dPlatformId")&&(u=e.url)}))},onFailure:function(e){}})}catch(e){}},getUserLogin:function(){var e=m.getUser(),t="";return void 0!==e&&(t=e.login),t},getUser:function(){var e=null;return null==e&&(e=s.getUser()),e},getPlatformId:function(){return"undefined"!=typeof widget&&widget.getValue("x3dPlatformId")},getSharedId:function(){if("undefined"!=typeof widget)return widget.getValue("x3dSharedId")?widget.getValue("x3dSharedId"):this.getAppId()},getTenantsPreference:function(){var e=[];if(!UWA.is(c,"array"))throw new Error("Platform services not initialize yet");return c.forEach(function(t){e.push({label:t.displayName,value:t.platformId})}),e},getCurrentUser:function(){return new o(function(e,t){n.getUser({onComplete:function(t){e({id:t.id,email:t.email,firstName:t.firstname,lastName:t.lastname})},onFailure:t})})},loadCurrentUserRoles:function(){return new o(function(e,t){n.getGrantedRoles(function(t){e(t)})})},getAppId:function(){if("undefined"!=typeof widget)return widget.getValue("x3dAppId")?widget.getValue("x3dAppId"):widget.getValue("appId")},getRequestLabel:function(){return m.getUserLogin()+"-"+m.getAppId()+"-"+Date.now()},getTenant3DSpaceUrl:function(e){for(var t=0,r=0;r<c.length;r++)c[r].platformId===e&&(t=r);return c[t]["3DSpace"]},getServiceSearchUrl:function(){return u},get3DSpaceUrl:function(){if(!UWA.is(c,"array"))throw new Error("Platform services not initialize yet");var e=this.getTenantIndex();return c[e]["3DSpace"]},getServiceURL:function(e,t){t=t||this.getPlatformId();var r=this.getTenantIndex();return c[r][e]},getUserPrefKey:function(e){return this.getPlatformId()+"_"+e},getTenantIndex:function(){var e=this.getTenant(),t=!1;if(UWA.is(e)){var r=e;if(!UWA.is(d)||c[d].displayName!==r){for(var n=0;n<c.length&&!t;n++)c[n].platformId===r&&(d=n,t=!0);UWA.is(d)||(d=0)}}return d},setTenantIndex:function(e){var t=e;if(c[d].displayName!==t)for(var r=0;r<c.length;r++)c[r].platformId===t&&(d=r)},getPlatformServices:function(){if(!UWA.is(c,"array"))throw new Error("Platform services not initialize yet");return c},determineAuthoredFlag:function(){var e=a.determineAuthoredFlag();return!1===widget.getValue("useIndexAccleration")&&(e=!0),e},decodeEntities:function(e){return UWA.is(e)&&""!=e?e.includes("&")?(g.innerHTML="",g.innerHTML=e,g.value):e:""},uid:function(){return(65536*(1+Math.random())|0).toString(16).substring(1)},getLanguage:function(){var e;widget&&widget.lang?e=widget.lang:e=(navigator?navigator.language||navigator.systemLanguage:"en").toLowerCase().split("-")[0];return e},getWidgetId:function(){return"undefined"!=typeof widget?widget.id:-1},isOnCloud:function(){var e=this.getTenant();return!(!UWA.is(e)||"OnPremise"===e)},isIpad:function(){return i.Platform.ipad},isAndroid:function(){return i.Platform.android},isSurface:function(){return i.Platform.tablet&&(i.Platform.win32||i.Platform.win64)},isMobile:function(){return this.isIpad()||this.isAndroid()||this.isSurface()},copyTexttoCLipboard:function(e){var t=document.createElement("textarea");if(t.classList.add("bookmark-txt-link"),t.value=e,document.body.appendChild(t),i.Platform.hasOwnProperty("ios")&&!0===i.Platform.ios){t.contentEditable=!0,t.readOnly=!0;var r=document.createRange();r.selectNodeContents(t);var n=window.getSelection();n.removeAllRanges(),n.addRange(r),t.setSelectionRange(0,t.value.length)}else t.select();try{var s=document.execCommand("copy")}catch(e){}return document.body.removeChild(t),!!s},_decodeHTML:function(e){var t=document.createElement("textarea");return t.innerHTML=e,t.value},displayTRMSearchNav:function(e){var t=this;t._selectedIdx=0,t.select_on=!1,t._matchedNodes=e,t._pagerview||(t._pagerview=new l({renderTo:document.body,multiSel:!t.richView}),t._pagerview.subscribe({event:"previous"},function(){t.focusChange.call(t,{event:"previous"})}),t._pagerview.subscribe({event:"next"},function(){t.focusChange.call(t,{event:"next"})}),t._pagerview.subscribe({event:"close"},function(){t._selectedIdx=0,t._matchedNodes=[],t._pagerview.hide()}),t.richView||t._pagerview.subscribe({event:"select-on"},function(){t.select_on&&1==t.select_on?t.focusChange.call(t,{event:"unSelectAll"}):t.focusChange.call(t,{event:"selectAll"})})),t._pagerview.show(),t.reframeOn.call(this)},calculateMaxDepth:function(e){let t=0;return e.processDescendants({processNode:function(){let e=this.getDepth();e>t&&(t=e)}}),t},changeExpandStateForStructure:function(e,t,r){e&&t&&(e.setState({state:t}),e.options.childComputed=r,e.processDescendants({processNode:function(e){if(e&&e.nodeModel){let n=e.nodeModel;n.options.useAsyncPreExpand="partiallyExpanded"===t,n.options.childComputed=r,n.setState({state:t})}}}))},traverseTree:function(e,t,r){let n=this;if(t&&t.length&&e){let i=t.indexOf(e.resourceid);i>=0&&(e.relationid?r.push(e.relationid):r.push(e.resourceid),t.splice(i,1)),e.children&&e.children.length&&e.children.forEach(e=>{n.traverseTree(e,t,r)})}},getAuthorizedTypesWithParent:function(){var e=widget.getValue("authorized_types");return UWA.is(e)?e:{}},getKindOf(e){var t=this.getAuthorizedTypesWithParent();return Object.keys(t).length>0?t[e]:""},getEncodedURI(e){if(e)return encodeURIComponent(e)}};return m=UWA.extend(m,r)}),define("DS/TraceableRequirementsUtils/Command/ActionBar_ReplaceByNewVersion",["DS/TraceableRequirementsUtils/Command/ReqCmdBase","DS/Logger/Logger","DS/TraceableRequirementsUtils/Utils","i18n!DS/TraceableRequirementsUtils/assets/nls/TraceableRequirementsUtils","DS/TraceableRequirementsUtils/utils/RequirementAlertManager","DS/TraceableRequirementsUtils/utils/RequirementErrorManager"],function(e,t,r,n,i,s){"use strict";var o=e.extend({name:"REQ_ACTION_BAR",_logger:null,init:function(e){this._logger=t.getLogger(o),this._parent(e,{isAsynchronous:!0}),this._options=e},beginExecute:function(){var e=this;require(["DS/PADUtils/PADContext","DS/TraceableRequirementsUtils/Services/RequirementWebServices","DS/TraceableRequirementsUtils/Utils","i18n!DS/TraceableRequirementsUtils/assets/nls/TraceableRequirementsUtils"],function(t,r,n,o){var a,l=t.get(),c={},u=!1,d=l.getSelectedNodes();if(d.length>1)for(var g=d.length-1;g>0;g--)for(var p=0;p<g;p++)if(d[p+1].getOccurencePath().length<d[p].getOccurencePath().length){var f=d[p];d[p]=d[p+1],d[p+1]=f}if(UWA.is(d)&&d.length>0){var h=[];for(g=0;g<d.length;g++){var m=d[g].getOccurencePath();d[g].isRoot()&&(u=!0),a=l.getReqSpecRoot(d[g]);var v={object_id:m[m.length-1],rel_id:m[m.length-2],parent_id:a};h.push(v)}if(l.getSelectedParentWithChild(d).length>0)return i.warningAlert(o.Requirement_Notif_ParentChildSelection),void e.end();if(u)return i.warningAlert(o.Requirement_Headers_ReviseRoot),void e.end();if(null==a)return void i.warningAlert(o.Requirement_Headers_ReviseRoot);c={objects_to_revise:h,revise_mode:e._options.arguments[0].Type},r.replaceByNewLatestRevision({securityContext:n.getSecurityContext(),json:c,onComplete:function(r){e._logger.log("WS Revise.onComplete"),i.sucessAlert(o[e._options.arguments[0].Type+".Requirement_Headers_Revise"]);var n=t.get(),s=UWA.is(r,"string")?JSON.parse(r):r;if("success"===s.status){var a=s.results;n.refreshOnRevise(a)}},onFailure:function(e,t){var r=s.getParseErrorMessage(e,t);i.errorAlert(r)},onTimeout:function(t){e._logger.warn("WS detach.onTimeout");var r=s.getParseErrorMessage(t);i.errorAlert(r)}})}else i.warningAlert(o.Requirement_Notif_ObjectSelection);e.end()})}});return o}),define("DS/TraceableRequirementsUtils/mixins/_ReqBIFilter",["UWA/Class","UWA/Class/Promise","DS/TraceableRequirementsUtils/Utils","DS/PADUtils/PADSession","DS/TraceableRequirementsUtils/utils/RequirementAlertManager","DS/PADUtils/PADUtilsServices","i18n!DS/TraceableRequirementsUtils/assets/nls/TraceableRequirementsUtils"],function(e,t,r,n,i,s,o){"use strict";return e.extend({_biFilter:null,eventInit:!1,_id2removeFromFilterProxy:[],_filterAlreadyTreatedRoot:[],_isRootAddedFromFilter:!1,initializeBI:function(e){console.log("initializeBI");let t=this._createProxy();this.optionalStartup.push(t)},cleanProxy:function(){this._biFilter&&this._biFilter.cleanProxy&&this._biFilter.cleanProxy(),this._biFilter&&this._biFilter.resetNGFilterUI&&this._biFilter.resetNGFilterUI({widgetId:s.getWidgetId()}),this._filterAlreadyTreatedRoot=[]},_checkIfFilterAvailable:function(e,r){var n=this;return new t(function(t){var i={rootsWithFilter:void 0,objectsWithoutFilterDrop:e},s=UWA.clone(e),o=[];e.physicalid&&(o=[].concat(e.physicalid));for(var a=n.options.model.getRoots(),l=0;l<a.length;l++){var c=o.indexOf(a[l].getID());-1!==c&&o.splice(c,1)}o.length?n._biFilter.areRootsSharable(o,r).then(function(e){for(var n=0;n<e.length;++n)!0===e[n].hasFilter&&(i.rootsWithFilter||(i.rootsWithFilter=s,i.rootsWithFilter.biProxyCtx=r,i.rootsWithFilter.physicalid=[]),i.rootsWithFilter.physicalid.push(e[n].rootId),i.objectsWithoutFilterDrop.physicalid&&-1!==i.objectsWithoutFilterDrop.physicalid.indexOf(e[n].rootId)&&i.objectsWithoutFilterDrop.physicalid.splice(i.objectsWithoutFilterDrop.physicalid.indexOf(e[n].rootId),1));t(i)}):t(i)})},launchFilterCommand:function(e){require(["DS/ApplicationFrame/CommandsManager"],function(t){var r=t.getCommand("DefineFilter");r&&(r.setOpenFilterNow(e),r.begin())})},applyFilterOnOpenAndDroppedFilterObject:function(e){var t=this;e&&e.length>0&&e.forEach(function(e){var r={appId:e.filter.widget,widget:e.filter.widget,CVQuery:e.filter.CVQuery,CVQueryV2:e.filter.CVQueryV2,filterRootIds:e.filter.filterRootIds,filterTitle:e.filter.filterTitle};t.getModels().applyFilter(r)})},_shareFilterSpec:function(e,r){var n=this;return new t(t=>{n._biFilter.shareFilterSpec({fromRootId:e,fromSourceCtx:r,fromDropOnFilter:!1,callback:function(e){e.success.length>0&&e.success.forEach(function(e){t(e)}),e.failure.length>0&&e.failure.forEach(function(e){i.warningAlert(e.msg),t(e)})}})})},retrieveFilter:async function(e,n){var s=this;return new t(t=>{e&&s._biFilter.retrieveFiltersFromIds({filterIds:e,droppedEnvId:r.getPlatformId(),fromDropOnFilter:n,callback:function(e){e.success.length>0&&e.success.forEach(function(e){t(e)}),e.failure.length>0&&e.failure.forEach(function(e){i.warningAlert(e.msg),t(e)})}})})},onApplyNGFilter:function(e){var t=e||null;t=UWA.is(t,"string")?JSON.parse(t):t,UWA.is(this.applyFilter,"function")&&this.applyFilter(t),UWA.is(this.getModels,"function")&&UWA.is(this.getModels().applyFilter,"function")&&this.getModels().applyFilter(t)},onSetPathTags:function(){if(this._biFilter){this._biFilter.setPathTags({nodes:[],paths:[]});var e={nodes:[],paths:[]},t={};function r(n){if(!n.isHidden()){var i=n.getPath().map(function(r){return function(r){return t.hasOwnProperty(r)||(e.nodes.push(r),t[r]=e.nodes.length-1),t[r]}(r.getID())});e.paths.push(i);var s=n.getChildren();s&&s.forEach(function(e){r(e)})}}this.options.model.getRoots().forEach(function(e){r(e)}),this._biFilter.setPathTags(e)}},onSetTagsWithExpandSynthesis:function(){if(this._biFilter){var e=this;setTimeout(function(){var t=e.options.model.getRoots(),r=[];t.forEach(function(t){var n=t.getID();-1===e._filterAlreadyTreatedRoot.indexOf(n)&&(r.push(n),e._filterAlreadyTreatedRoot.push(n))});e._biFilter.setTagsWithExpandSynthesis&&r.length>0&&e._biFilter.setTagsWithExpandSynthesis(r,{type_filter_rel:["Sub Requirement Group","Requirement Group Content","Specification Structure","Sub Requirement","ParameterAggregation"]})})}},onFilterBIColorize:function(e){console.log("_ReqBIFilter onFilterBIColorize"),this.options.model&&this.options.model.applyColor(e)},onFilterBIUnColorize:function(){console.log("_ReqBIFilter onFilterBIUnColorize"),this.options.model&&this.options.model.applyColor()},onFilterBISelectionEvent:function(e){this.options.model&&this.options.model.selectFromTagger(e)},onFilterBIFilteringEvent:function(e){var t=this.options.model;e&&Object.keys(e.allfilters).length,this.options.model.onUpdate(function(e){console.log("_ReqBIFilter onNodeModelUpdate",e)});var r=t.getRoots(!0).slice(0);r.forEach(function(e){e.filterIn(!0)});var n=e.filteredSubjectList;if(n){for(var i=e.nodes,s=[],o={},a=function(e){return i[e]},l=0;l<n.length;l++){var c=n[l];o.hasOwnProperty(c)||s.push(c.map(a))}s.forEach(function(e){t.getNodesByIDPath(e).forEach(function(e){e._filterStatus="IN",e.getParents().forEach(function(e){e._filterStatus="IN"})})});r.forEach(function(e){!function e(t,r){if("IN"===t._filterStatus){var n=t.getChildren();n&&n.length>0&&n.slice(0).forEach(function(t){e(t)})}else{var i=t.getAllDescendants();i&&i.length>0&&i.slice(0).forEach(function(e){e.filterOut(),r&&r.push(e),delete e._filterStatus}),t.filterOut(),r&&r.push(t)}delete t._filterStatus}(e);var t=!1;if(e.options._childrenFilterInfo){var r=e.options._childrenFilterInfo.filteredOutChildren;r&&r.length>0&&(t=!0)}t&&(e.setState({state:"partiallyExpanded"}),e.options.padstate="partiallyExpanded"),t=!1});for(var u=[],d=0;d<s.length;d++){var g=s[d];u.push(g[g.length-1])}this.onSetPathTags()}else console.error("Invalid Argument : %o",e)},onFilterClose:function(e){if("dataFilterPanelCtn"===e.tag){var t=e||{};if(void 0===t.rootIds){t.rootIds=[];for(var r=this.options.model.getRoots(),n=0;n<r.length;n++)t.rootIds.push(r[n].getID())}this.disableFilterWaiting(t)}},_createProxy:function(){var e=this;return new t((t,r)=>{require(["DS/ENOFilterBIUX/FilterBIComponentProxy"],function(r){var n={tenant:s.getPlatformId(),processingMode:"appProcessing",colorize:!0,selection:{},widgetId:s.getWidgetId(),appId:s.getSharedId(),volumeFilterAvailable:0,ExpandSynthesisON:!0,shareFilterSpec:!0,synthesis_priority:1};UWA.is(e.onFilterFilteringEvent,"function")&&(n.events={addFilterChangeListener:e.onFilterFilteringEvent.bind(e)}),e._biFilter=new r(n),e._biFilter.addEvent("NGFilter_Close",e.onFilterClose,e),e._biFilter.addEvent("FilterBIUnColorize",e.onFilterBIUnColorize,e),e._biFilter.addEvent("FilterBIColorize",e.onFilterBIColorize,e),e._biFilter.addEvent("FilterBIFilteringEvent",e.onFilterBIFilteringEvent,e),e._biFilter.addEvent("FilterBISelectionEvent",e.onFilterBISelectionEvent,e),e.options.model.getModelEvents().subscribe({event:"onRootAdded"},e.onSetTagsWithExpandSynthesis.bind(e));var i={expandServices:"expand",appID:s.getSharedId()};e._biFilter.setNGFilterOptions(i),e._biFilter.addEvent("ApplyNGFilter",e.onApplyNGFilter,e),e.options.model._isVolumeFilter=!0,e._biFilter.setSynthesisMode("flat"),e.options.model.setFilterBIProxy(e._biFilter),e.filterInitialized=!0,e.dispatchEvent("filterInitialized",e.filterInitialized),e.eventInit=!0,t(e._biFilter)})})},_colorChildren:function(){}})}),define("DS/TraceableRequirementsUtils/utils/RequirementNlsMgt",["UWA/Core","UWA/Promise","DS/PADUtils/PADContext","DS/Utilities/Utils","DS/TraceableRequirementsUtils/Utils","DS/FedDictionaryAccess/FedDictionaryAccessAPI"],function(e,t,r,n,i,s){"use strict";var o={nodes2updateId:[],nodes2update:[]},a=n.debounce(function(e){var t,n,a,l=r.get(),c={},u=l.columnManager.getAvailableColumn().available_columns,d=l.getSetting("attributesWithoutNls"),g=u.filter(function(e){return-1===d.indexOf(e)});for(t=0;t<e.length;t++){a=l.getPADTreeDocument();let r=e[t].options.grid;var p=Object.getOwnPropertyNames(r);for(n=0;n<p.length;n++)if(-1!==g.indexOf(p[n])){var f=-1!==p[n].indexOf("-relation")?p[n].substring(0,p[n].indexOf("-relation")):p[n];void 0===c[f]&&(c[f]=[]),r[p[n]]&&-1===c[f].indexOf(r[p[n]])&&""!==r[p[n]].trim()&&c[f].push(r[p[n]])}}s.getNlsOfPropertiesValues(JSON.stringify(c),{tenantId:i.getPlatformId(),lang:i.getLanguage(),apiVersion:"R2019x",onComplete:function(r){var i=UWA.is(r,"string")?JSON.parse(r):r;function s(e){var t=!1,r={grid:UWA.clone(e.options.grid)},s=Object.keys(r.grid);for(n=0;n<s.length;n++){var o=-1!==s[n].indexOf("-Instance")?s[n].substring(0,s[n].indexOf("-relation")):s[n];i[o]&&i[o][r.grid[s[n]]]&&i[o][r.grid[s[n]]]!==r.grid[s[n]]&&(t=!0,r.grid[s[n]+"-original"]=r.grid[s[n]],r.grid[s[n]]=i[o][r.grid[s[n]]])}return{updated:t,options:r}}if(a)a.setUseChangeTransactionMode(!0),a.withTransactionUpdate(function(){for(t=0;t<e.length;t++){var r=e[t],n=s(r);!0===n.updated&&r.updateNLS(n.options)}o.nodes2updateId=[],o.nodes2update=[]}),a.setUseChangeTransactionMode(!1);else{for(t=0;t<e.length;t++){var l=e[t],c=s(l);!0===c.updated&&l.updateNLS(c.options)}o.nodes2updateId=[],o.nodes2update=[]}},onFailure:function(){console.warn("Cannot retrieve NLS"),o.nodes2updateId=[],o.nodes2update=[]}})},100);return{updateNLS:function(e){var t=e.getOccurencePath?e.getOccurencePath():e.options.resourceid;-1===o.nodes2updateId.indexOf(t)&&(o.nodes2updateId.push(t),o.nodes2update.push(e),a(o.nodes2update))},retrieveNLS:function(e){return new t(function(t,r){s.getNlsOfPropertiesValues(JSON.stringify(e.nlsData),{tenantId:i.getPlatformId(),lang:i.getLanguage(),apiVersion:"R2019x",onComplete:function(e){var r=UWA.is(e,"string")?JSON.parse(e):e;t(r)},onFailure:function(e){console.warn("Cannot retrieve NLS"),t({})}})})}}}),define("DS/TraceableRequirementsUtils/Command/ActionBar_DownloadMSAddin",["DS/ApplicationFrame/Command","DS/TraceableRequirementsUtils/Utils"],function(e,t){"use strict";var r=null;return e.extend({init:function(e){r=this,this._parent(e,{isAsynchronous:!0}),this.path="/requirements/ENOVIA_RMCInstaller.zip",!0===t.isMobile()&&this.disable()},beginExecute:function(){},execute:function(){r=this;var e=t.get3DSpaceUrl()+r.path;window.open(e)},endExecute:function(){}})}),define("DS/TraceableRequirementsUtils/Command/ActionBar_LaunchWebAppCmd",["DS/ApplicationFrame/Command","UWA/Utils/InterCom","DS/TraceableRequirementsUtils/Utils","DS/TraceableRequirementsUtils/utils/RequirementAlertManager","DS/TraceableRequirementsUtils/utils/RequirementErrorManager","i18n!DS/TraceableRequirementsUtils/assets/nls/TraceableRequirementsUtils"],function(e,t,r,n,i,s){"use strict";return e.extend({init:function(e){this._parent(e,{isAsynchronous:!0}),this.socketName="selection_socket_"+widget.id,this.socket=new t.Socket(this.socketName,{dispatchRetryInterval:5}),this.socket.subscribeServer("com.ds.compass",window.parent)},beginExecute:function(){},execute:function(){var e=this;function t(e){"ENOREQL_AP"===e.appId&&e.widgetId===widget.id&&console.log(e.response)}require(["DS/i3DXCompassServices/i3DXCompassPubSub","DS/PADUtils/PADContext","DS/TraceableRequirementsUtils/Utils","DS/TraceableRequirementsUtils/Services/RequirementWebServices"],function(r,s,o,a){var l={appId:"ENOREQL_AP",widgetId:widget.id},c=void 0;UWA.is(s.get().getSelectedElement())&&(c=s.get().getSelectedElement().physicalid),a.getInfo({securityContext:o.getSecurityContext(),pid:c,authored:!0,selectables:"physicalid,id",onComplete:function(e){console.log("data",e);var n=(UWA.is(e,"string")?JSON.parse(e):e).results[0];n.id&&(c=n.id);var i=o.getSecurityContext();r.publish("setObject",{objectId:c,contextId:i}),r.subscribe("launchAppCallback",t),r.publish("launchApp",l)},onFailure:function(e){var t=i.getParseErrorMessage(e);n.errorAlert(t)},onTimeout:function(t){var r=i.getParseErrorMessage(t);n.errorAlert(r),e._logger.log("RequirementWebServices.getInfo timed out")}})})},endExecute:function(){}})}),define("DS/TraceableRequirementsUtils/Command/ActionBar_DetachCmd",["DS/TraceableRequirementsUtils/Command/ReqCmdBase","DS/PADUtils/PADContext","DS/TraceableRequirementsUtils/utils/RequirementAlertManager","DS/TraceableRequirementsUtils/utils/RequirementErrorManager","DS/Logger/Logger","DS/TraceableRequirementsUtils/views/TRMDetachReportPanel","DS/TraceableRequirementsUtils/Utils","i18n!DS/TraceableRequirementsUtils/assets/nls/TraceableRequirementsUtils"],function(e,t,r,n,i,s,o,a){"use strict";var l=e.extend({name:"REQ_ACTION_BAR",_logger:null,init:function(e){this._logger=i.getLogger(l),this._parent(e,{isAsynchronous:!0}),this._options=e},beginExecute:function(){var e=this;require(["DS/TraceableRequirementsUtils/Services/RequirementWebServices"],function(r){var n=t.get(),i=n.getSelectedElement(),s=[];if(null!==i){var o=[];o.push(i),s=o}else s=n.getSelectedElementList();"false"===localStorage.getItem("TRMDetachLocalStorage")?e._checkSelection(s):e._launchConfirm({callback:function(t){t?e._checkSelection(s):e.end()}}),e.end()})},_launchConfirm:function(e){var r=this;require(["DS/TraceableRequirementsUtils/views/TRMDetachDlgConfirm"],function(n){var i;i=a.unparent_confirm_message_multiple,t.get()._ConfirmModal=r._confirmModal=new n({className:"TRMDetachDlgConfirm_modal",renderTo:document.body,action:a.unparent_confirm_title,title:a.unparent_confirm_title,message:i,callback:e.callback})})},_checkSelection:function(e){var t=this;require(["DS/TraceableRequirementsUtils/Services/RequirementWebServices","DS/PADUtils/PADContext","UWA/Class/Promise"],function(i,l,c){var u=[];t._reportFailure=[],t._reportAborted=[],t._reportSuccess=[];var d=!1,g=e.length;e.forEach(function(e){var n=e.path;if(UWA.is(n)&&UWA.is(n.length)&&1!==n.length)u.push(n[n.length-2]);else{var i=e.label+a.unparent_unsupported_root;1==g?r.errorAlert(i):t._reportFailure.push(i)}});var p=[],f=l.get(),h=new c(function(s,l){i.detach({securityContext:o.getSecurityContext(),json:{relationship_physical_ids:u},onComplete:function(r){var n=UWA.is(r,"string")?JSON.parse(r):r;t._logger.log("WS detach.onComplete"),t._logger.log("Detach and refresh Element"),d=!0,n.results.Success.forEach(function(r){t._logger.log(r),e.forEach(function(e){var i=e.path;if(UWA.is(i)&&UWA.is(i.length)&&1!==i.length){if(i[i.length-2]==r){UWA.is(n.PhysicalDelete)&&(e.PhysicalDelete=n.PhysicalDelete);var s=a.unparent_report_success;s=(s=s.replace("{instanceName}",e.label)).replace("{parentName}",e.ParentLabel);var o=f.getPADTreeDocument().getNodesById(e.physicalid)[0];if(o)"Yes"==(o.getEffectivity?o.getEffectivity():"No")&&""!=f.getAuthoringContextPID()&&(s=s+" "+a.Configured_Operation);f.refreshOnRemove(e,!0),t._reportSuccess.push(s)}}else t._logger.log("Root cannot be detached")})}),n.results.Fail.forEach(function(r){t._logger.log(r),e.forEach(function(e){var n=e.path;if(UWA.is(n)&&UWA.is(n.length)&&1!==n.length){if(n[n.length-2]==r){var i=a.unparent_report_failure+" "+a.FailureReasons;i=(i=i.replace("{instanceName}",e.label)).replace("{parentName}",e.ParentLabel),t._reportFailure.push(i)}}else t._logger.log("Root cannot be detached")})}),s()},onFailure:function(e,i){t._logger.log("WS detach.onFailure");var s=n.getParseErrorMessage(e,i);r.errorAlert(s),d=!1,l()},onTimeout:function(e){d=!1,t._logger.warn("WS detach.onTimeout");var i=n.getParseErrorMessage(e);r.errorAlert(i),l()}})});h&&p.push(h),c.allSettled(p).then(function(){1==d&&(1==g?1==t._reportSuccess.length?r.sucessAlert(t._reportSuccess[0]):1==t._reportFailure.length&&r.errorAlert(t._reportFailure[0]):l.get()._ReportPanel=t.reportPanel=new s({title:a.DetachTitle,success:t._reportSuccess,failure:t._reportFailure,neutral:[],aborted:t._reportAborted}))})})}});return l}),define("DS/TraceableRequirementsUtils/Command/HomePage_InsertRootCmd",["UWA/Core","DS/Logger/Logger","DS/ApplicationFrame/Command","DS/TraceableRequirementsUtils/Utils","DS/TraceableRequirementsUtils/utils/RequirementAlertManager","DS/TraceableRequirementsUtils/utils/RequirementErrorManager","i18n!DS/TraceableRequirementsUtils/assets/nls/TraceableRequirementsUtils","text!DS/TraceableRequirementsUtils/assets/RequirementRelationshipsPatterns.json"],function(e,t,r,n,i,s,o,a){"use strict";var l=r.extend({name:"REQ_HOMEPAGE_PANEL",_logger:null,_options:null,init:function(e){this._logger=t.getLogger(l),this._options=e},beginExecute:function(){this._logger.log(this._id+".beginExecute")},execute:function(){this._logger.log(this._id+".execute");var e=this;require(["DS/PADUtils/PADContext","DS/PADUtils/views/PADModalChooser"],function(t,r){t.get();var n,s,a=e._options.arguments[0].Type;if(UWA.is(a)){for(var l=new Array(a.length),c=0;c<a.length;c++)l[c]=a[c];n="(";for(var u=0;u<l.length;u++)n+=0===u?'flattenedtaxonomies:"types/'+l[u]+'"':' OR flattenedtaxonomies:"types/'+l[u]+'"';s=n+=")",new r({renderTo:document.body,position:"above_action_bar",in_apps_search:{multiSel:!1,in_apps_callback:e._onSelectionDone.bind(e),precond:s}})}else i.warningAlert(o.Requirement_Notif_CmdNotAvailable)})},endExecute:function(){this._logger.log(this._id+".endExecute")},_onSelectionDone:function(e){require(["DS/PADUtils/PADContext","DS/TraceableRequirementsUtils/Utils","DS/TraceableRequirementsUtils/Services/RequirementWebServices"],function(t,r,n){var o=t.get(),a=e[0].id,l=o.utilities.getSelectable();n.getInfo({securityContext:r.getSecurityContext(),pid:a,selectables:l,onComplete:function(e){e=r.parseResponse(e);var t=(UWA.is(e,"string")?JSON.parse(e):e).results;t.indexCreation=!1;let n={physicalid:t[0].resourceid};o._onInitialDrop(n)},onFailure:function(e,t){var r=s.getParseErrorMessage(e,t);i.errorAlert(r),console.warn("WS getInfo.onFailure")},onTimeout:function(e){var t=s.getParseErrorMessage(e);i.errorAlert(t),console.warn("WS getInfo.onFailure")}})})}});return l}),define("DS/TraceableRequirementsUtils/Services/RichContentObjectServices",["UWA/Drivers/Alone","UWA/Core","UWA/Controls/Abstract","UWA/Class/Options","UWA/Class/Events","DS/WAFData/WAFData","DS/TraceableRequirementsUtils/Utils","DS/PADUtils/PADContext","DS/Logger/Logger"],function(e,t,r,n,i,s,o,a,l){"use strict";return r.extend(n,i,{name:"RichContentObjectServices",defaultOptions:{url:null,parallelUploads:2,uploadMultiple:!1,maxFilesize:256,paramName:"file",createImageThumbnails:!0,maxThumbnailFilesize:10,thumbnailWidth:100,thumbnailHeight:100,maxFiles:null,params:{},ignoreHiddenFiles:!0,autoProcessQueue:!0,addRemoveLinks:!1,previewsContainer:null,accept:function(e,t){return t()}},init:function(e){this,this.options=UWA.merge(this.defaultOptions,e||{})},checkinFiles:function(e){var t={},r=o.get3DSpaceUrl()+"/resources/richeditor/res/checkinRCO";if(r+="?objectId="+e.physicalid,!UWA.is(e.callbacks.onComplete,"function"))throw new Error("No onComplete callback function defined");if(!UWA.is(e.callbacks.onTimeout,"function"))throw new Error("No onTimeout callback function defined");if(!UWA.is(e.callbacks.onFailure,"function"))throw new Error("No onFailure callback function defined");var n=e.callbacks.onComplete;t.onComplete=function(t){n(t,e)};var i=e.callbacks.onTimeout;t.onTimeout=function(t){i(t,e)};var l=e.callbacks.onFailure;t.onFailure=function(t){l(t,e)};var c=e.files;if(c&&c.length){t.method="POST",t.headers={Accept:"application/json","Cache-Control":"no-cache"},t.timeout=24e4;var u=a.get();if(UWA.is(u)&&u.getCSRF&&UWA.is(u.getCSRF)){var d=u.getCSRF(),g=Object.keys(d)[0],p=d[g];r+="&"+g+"="+p+"&"+p+"="+d[p]}else UWA.is(u)&&(r+="&csrfTokenName="+u.csrf.csrfTokenName+"&ENO_CSRF_TOKEN="+u.csrf.ENO_CSRF_TOKEN);var f=c[0],h=new FormData;h.append("file",f,f.name),t.data=h,r=o.appendTenantInUrl(r),s.authenticatedRequest(r,t)}}})}),define("DS/TraceableRequirementsUtils/Services/RequirementTenantMgt",["UWA/Class","UWA/Class/Events","DS/Logger/Logger","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","DS/TraceableRequirementsUtils/Utils","i18n!DS/TraceableRequirementsUtils/assets/nls/TraceableRequirementsUtils"],function(e,t,r,n,i,s){"use strict";var o=e.singleton(t,{name:"RequirementTenantMgt",options:{},_preferences_added:!1,_logger:null,init:function(){this._logger=r.getLogger(o)},addTenant2Preferences:function(e){if(this._logger.log("addTenant2Preferences"),!UWA.is(widget))throw new Error("widget variable isn't defined");void 0!==e&&void 0!==e.events&&this.addEvents(e.events),!1===this._preferences_added&&(this._logger.log("add tenant information to the widget preferences"),widget.mergePreferences([{name:"req_tenant",type:"list",label:s.trm_Tenant,defaultValue:""}]),this._logger.log("Fill the values"),this._fillPreferences(),this._preferences_added=!0)},_fillPreferences:function(){this._logger.log("_fillPreferences");if(void 0===widget)throw new Error("widget variable isn't defined");var e=[];i.getPlatformServices().forEach(function(t){e.push({label:t.displayName,value:t.platformId})}),this._update_req_tenant_pref(e)},_update_req_tenant_pref:function(e){var t=!1,r=widget.getValue("req_tenant")?widget.getValue("req_tenant"):e[0];if(""===widget.getValue("req_tenant"))for(var n=widget.getValue("x3dPlatformId"),i=0;i<e.length&&!t;i++)e[i].value===n&&(r=e[i],t=!0);UWA.is(e)&&e.length>0&&(widget.addPreference({name:"req_tenant",type:"list",label:s.trm_Tenant,defaultValue:r,options:e,onchange:"onUpdateTenant",disabled:!0}),widget.setValue("req_tenant",r),this.dispatchEvent("onUpdateTenant",r))}});return o}),define("DS/TraceableRequirementsUtils/Services/RequirementCVServices",["UWA/Core","UWA/Class","DS/TraceableRequirementsUtils/Utils"],function(e,t,r){"use strict";var n={predefined_computation:["urlstream|thumbnail|2dthb","icons"]};return t.singleton({getInfo:function(t){var n=r.getSecurityContext()?r.getSecurityContext():"preferred",i=r.get3DSpaceUrl()+"/cvservlet/fetch/v2",s=t.selectables;t.selectables&&delete t.selectables,Array.isArray(s)||(s=s.split(","));let o=r._requestOptions(t,"POST");o.headers["Accept-Language"]=r.getLanguage(),o.headers.SecurityToken=r.getUserLogin()+"|"+n+"|preferred";var a=e.extend({label:r.getRequestLabel(),physicalid:t.pid,select_predicate:s,locale:r.getLanguage(),tenant:r.getPlatformId()});return o.data=JSON.stringify(a),o.onTimeout=o.onTimeout||o.onFailure,r.executeRequest(i,o)},expand:function(e){let t=r.getSecurityContext()?r.getSecurityContext():"preferred",i=r.get3DSpaceUrl()+"/cvservlet/progressiveexpand/v2?output_format=cvjson",s=e.json,o=s.BIProxy,a=r._requestOptions(e,"POST");a.headers["Accept-Language"]=r.getLanguage(),a.headers.SecurityToken=r.getUserLogin()+"|"+t+"|preferred";let l={};l[s.rootID]=[s.paths];let c=parseInt(s.expand_iter),u=r.getRequestLabel(),d={batch:s.batch?s.batch:r.createBatchForExpandV2({queryLabel:u,pathsWithRoot:l,expandLevel:c,BIProxy:o,searchOptions:s.searchOptions,attributesToSearch:s.attributesToSearch,tagger_select:s.tagger_select},s.rel_filter),outputs:{select_object:s.object_selects,select_relation:s.select_relation,hits:n,format:s.format,matching_lengths:s.matching_lengths}};return a.data=JSON.stringify(d),r.executeRequest(i,a)}})}),define("DS/TraceableRequirementsUtils/utils/TRMSearchNav",["UWA/Core","UWA/Controls/Abstract","DS/TraceableRequirementsUtils/Utils","i18n!DS/TraceableRequirementsUtils/assets/nls/TraceableRequirementsUtils.json","DS/Controls/Button","DS/UIKIT/Tooltip","DS/CoreEvents/ModelEvents"],function(e,t,r,n,i,s,o){"use strict";return t.extend({renderTo:null,visible:!1,_modelEvents:null,init:function(e){this.renderTo=e.renderTo?e.renderTo:document.body,this._parent(e),this._buildSkeleton(e.multiSel),this._modelEvents=new o;require(["DS/PADServices/utils/GlobalModelEvents"],function(e){e.subscribe({event:"ENXViews/TRMSearchNav/close"},function(e){this.getModelEvents().publish({event:"close"})}.bind(this))}.bind(this))},show:function(){!1===this.visible&&(this.elements.container.inject(this.renderTo),this.visible=!0)},hide:function(){!0===this.visible&&(this.renderTo.removeChild(this.elements.container),this.visible=!1)},setLabel:function(e){this.elements.textInfo&&(this.elements.textInfo.innerHTML=e)},publish:function(e){this.getModelEvents().publish(e)},subscribe:function(e,t){return this.getModelEvents().subscribe(e,t)},unsubscribe:function(e){this.getModelEvents().unsubscribe(e)},getModelEvents:function(){return this._modelEvents},_buildSkeleton:function(e){var t=this;this.elements.container=UWA.createElement("div",{class:"TRMSearchNavContainer"}),this.elements.topBarContainer=UWA.createElement("span",{class:"TRMSearchSelectionNavigatiorTopBar"}).inject(this.elements.container),this.elements.previousButton=UWA.createElement("span",{class:"wux-ui-fa-PreviousImage TRMSearchNavPreviousButton","data-toggle":"tooltip","data-placement":"bottom",title:n.ENOTRMApp_Tooltip_Previous}).inject(this.elements.topBarContainer),this.elements.previousButton.addEventListener("click",function(e){t.getModelEvents().publish({event:"previous"})}),this.elements.previousButton.addEventListener("touchend",function(e){t.getModelEvents().publish({event:"previous"})}),this.elements.textInfo=UWA.createElement("div",{class:"TRMSearchNavLabel wux-afr-label"}).inject(this.elements.topBarContainer),this.elements.nextButton=UWA.createElement("span",{class:"wux-ui-fa-NextImage TRMSearchNavNextButton","data-toggle":"tooltip","data-placement":"bottom",title:n.ENOTRMApp_Tooltip_Next}).inject(this.elements.topBarContainer),this.elements.nextButton.addEventListener("click",function(e){t.getModelEvents().publish({event:"next"})}),this.elements.nextButton.addEventListener("touchend",function(e){t.getModelEvents().publish({event:"next"})}),e&&(this.elements.selectButton=UWA.createElement("span",{class:"fonticon fonticon-select-on TRMSearchNavSelectButton","data-toggle":"tooltip","data-placement":"bottom",title:n.ENOTRMApp_Tooltip_SelectAll}).inject(this.elements.topBarContainer),this.elements.selectButton.addEventListener("click",function(e){t.getModelEvents().publish({event:"select-on"})}),this.elements.selectButton.addEventListener("touchend",function(e){t.getModelEvents().publish({event:"selectAll"})})),this.elements.closeButton=UWA.createElement("span",{class:"fonticon fonticon-wrong TRMSearchNavCloseButton","data-toggle":"tooltip","data-placement":"bottom",title:n.ENOTRMApp_Tooltip_Close}).inject(this.elements.topBarContainer),this.elements.closeButton.addEventListener("click",function(e){t.getModelEvents().publish({event:"close"})}),this.elements.closeButton.addEventListener("touchend",function(e){t.getModelEvents().publish({event:"close"})})}})}),define("DS/TraceableRequirementsUtils/Services/RequirementCommonServices",["UWA/Core","UWA/Class","DS/TraceableRequirementsUtils/Utils"],function(e,t,r){"use strict";return t.singleton({getTypeInfo:function(e){var t=e;t.headers||(t.headers={});var n=r.get3DSpaceUrl()+"/resources/dictionary/getTypeInfo";if(t.url_parameters)for(var i=Object.getOwnPropertyNames(t.url_parameters),s=0;s<i.length;s++)n=0===s?n+"?"+i[s]+"="+t.url_parameters[i[s]]:n+"&"+i[s]+"="+t.url_parameters[i[s]];var o=e.body;return t.method="POST",t.data=JSON.stringify(o),r.executeRequest(n,t)},interfaces:function(e){var t=e;t.headers||(t.headers={});var n=r.get3DSpaceUrl()+"/resources/dictionary/class/interfaces";t.onlyCustomer&&(n+="?customerOnly=true&displayAttributes=true");var i=t.data;return t.method="POST",t.data=JSON.stringify(i),r.executeRequest(n,t)}})}),define("DS/TraceableRequirementsUtils/utils/TRMTypeManagement",["UWA/Core","UWA/Class","DS/PADUtils/PADContext","DS/TraceableRequirementsUtils/Utils","DS/TraceableRequirementsUtils/utils/TRMConstant","DS/RequirementStructureBrowser/treemodel/RequirementModelParser"],function(e,t,r,n,i,s){"use strict";var o,a=function(e,t){var i={types:[],root_types:[]},s=[],o=r.get(),a=o.getSetting("authorized_types"),l=o.getSetting("authorized_root_type");e.forEach(function(e){var t=!1;-1!==a.indexOf(e.type)&&(i.types.push(e.type),t=!0),-1!==l.indexOf(e.type)&&(i.root_types.push(e.type),t=!0),!1===t&&s.push(e.type)}),s.forEach(function(e){var t=n.getAuthorizedTypesWithParent();-1!==a.indexOf(t[e])&&i.types.push(e),-1!==l.indexOf(t[e])&&i.root_types.push(e)}),t(i)},l=function(t){for(var r,n={data:{items:[]}},i=e.is(t.dataTransfer.types.indexOf,"function")?"indexOf":"contains",s="",o=["text/searchitems","text/plain","Text"],a=0;a<o.length&&""===s;a++){var l=t.dataTransfer.types[i](o[a]);(e.is(l,"number")&&l>=0||e.is(l,"boolean")&&!0===l)&&(s=o[a])}if(""!==s){r=t.dataTransfer.getData(s);try{n=e.is(r,"string")?JSON.parse(r):r}catch(e){}}return n};return t.singleton({init:function(e){this._parent(e);this.context=r.get()},retrieveDragWidgetId:function(t){var r=l(t);return(e.is(r,"string")?JSON.parse(r):r).widgetId},retrieveAuthorizedObjects:function(t){var r;o=t.version,t.X3DContentId?r=t.X3DContentId:t.x3DSearch?(r=t.x3DSearch,console.log(r)):r=l(t.dnd_event);var n=[],s={authorized_objects:[],authorized_root_objects:[],unauthorized_objects:[],authorized_filter_objects:[]};s.source_data=e.clone(r),delete s.source_data.data,e.is(r.data)&&e.is(r.data.items,"array")&&r.data.items.length>0&&(r.data.items.forEach(function(t){var r=t.objectType?t.objectType:t["ds6w:type_value"];e.is(t.objectType_Internal)&&(r=t.objectType_Internal);var i=t.displayType?t.displayType:t["ds6w:type"];r&&0!==r.length?-1===n.indexOf(r)&&n.push({type:r,displayType:i}):s.unauthorized_objects.push(t)}),a(n,function(n){r.data.items.forEach(function(r){var a=r.objectType?r.objectType:r["ds6w:type_value"];e.is(r.objectType_Internal)&&(a=r.objectType_Internal),a===i.TYPE_FILTER&&("2.0"===o?s.authorized_filter_objects.push(r):s.unauthorized_objects.push(r)),-1!==n.types.indexOf(a)?s.authorized_objects.push(r):s.unauthorized_objects.push(r),!1!==t.isRootAuthorizations&&(-1!==n.root_types.indexOf(a)?s.authorized_root_objects.push(r):s.unauthorized_objects.push(r))})})),s.unauthorized_objects=s.unauthorized_objects.filter(function(e,t,r){return r.indexOf(e)===t}),t.callback(s)},prepareDragData:function(e){var t={protocol:"3DXContent",version:"1.1",source:n.getAppId(),widgetId:n.getWidgetId(),data:{items:[]}},r=[];return e.forEach(function(e){var t={envId:n.getPlatformId(),serviceId:"3DSpace",contextId:n.getSecurityContext(),objectId:e.getID(),objectType:e.getType(),displayName:e.getLabel(),displayType:e.getType(),path:e.getOccurencePath(null,!0)};r.push(t)}),t.data.items=r,this._updateWithBIProxyInfos(e,t),JSON.stringify(t)},_updateWithBIProxyInfos:function(e,t){var r=!1;for(let t=0;t<e.length&&!1===r;t++)e[t].isRoot()&&!0===e[t].options.filtered&&(r=!0);if(this.context._biFilter&&r){var n=this.context._biFilter.getCtxForSharing();n&&(t.biProxyCtx=n)}},getTreeNodeModel:function(e){return s.process.createNode({treedocument:this.context,data:e,tenant:n.getTenant()},this.context.externalTypes)},updateRecentItemModel:function(e){this.context.DataService.getUserRecentsItems(e)}})}),define("DS/TraceableRequirementsUtils/views/DndController",["DS/TraceableRequirementsUtils/utils/TRMTypeManagement","DS/TraceableRequirementsUtils/utils/RequirementAlertManager","DS/Utilities/Dom","DS/TraceableRequirementsUtils/Utils","DS/TraceableRequirementsUtils/utils/TRMConstant","i18n!DS/TraceableRequirementsUtils/assets/nls/TraceableRequirementsUtils","css!DS/TraceableRequirementsUtils/TraceableRequirementsUtils.css"],function(e,t,r,n,i,s){"use strict";var o={actual:null};let a,l,c=0,u=!1,d=Number.MAX_VALUE;function g(t){l=null,c=0,u=!1;var s=r.firstParentWithClass(t.target,"trm-dropZone");this.dropContainer&&(this.dropOptions&&this.dropOptions.firstElementChild.classList.contains("trm-dropArea-opacity")&&this.dropOptions.firstElementChild.classList.remove("trm-dropArea-opacity"),this.dropContainer.hide()),s&&e.retrieveAuthorizedObjects({dnd_event:t,version:a.dropInRichView?void 0:"2.0",callback:function(e){if(e&&s.classList.contains("hightLight-dropzone")){let t;s.classList.contains(i.OPEN)?0!=e.authorized_root_objects.length||0!=e.authorized_filter_objects.length?t=i.OPEN:p(e):s.classList.contains(i.OPENWITHCONTEXT)?0!=e.authorized_objects.length||0!=e.authorized_filter_objects.length?t=i.OPENWITHCONTEXT:p(e):s.classList.contains(i.FILTERANDOPEN)&&(0!=e.authorized_objects.length||0!=e.authorized_filter_objects.length?t=i.FILTERANDOPEN:p(e)),t&&function(e,t){var r="fromDrop",s=[],o=function(e){e.physicalid.length>0&&s.push(new Promise(function(){!function(e){a.dropInRichView?a.context._onInitialDrop(e):a._trmModelEvents.publish({event:"TRMViews-WelcomePanel-OpenStructure",data:e})}(e)}))},l=function(e){let t=f(e),n={physicalid:t,behavior:r,filteredObject:!0};return n};switch(t){case i.OPEN:if(e.authorized_root_objects&&0!=e.authorized_root_objects.length){let t=f(e.authorized_root_objects),r={physicalid:t};o(r)}if(e.authorized_filter_objects.length>0){let t=l(e.authorized_filter_objects);o(t)}break;case i.OPENWITHCONTEXT:if(e.authorized_objects.length>0){let{physicalIds:t,occurrencePath:r}=h(e);var c={physicalid:t,filteredObject:!1,occurrencePath:r};o(c)}if(e.authorized_filter_objects.length>0){let t=l(e.authorized_filter_objects);o(t)}break;case i.FILTERANDOPEN:if(e.authorized_objects.length>0&&e.authorized_filter_objects.length>0?r="fromDrop":1!==e.authorized_objects.length&&1!=e.authorized_filter_objects.length||(r="fromDropOnFilter"),e.authorized_objects.length>0){let{physicalIds:t}=h(e);var u={};u.physicalid=t,u.filteredObject=!1,u.behavior=r;var d=Promise.resolve({rootsWithFilter:void 0,objectsWithoutFilterDrop:u});if(e.source_data.biProxyCtx){var g=n.determineAuthoredFlag();!1===g&&(d=a._checkIfFilterAvailable(u,e.source_data.biProxyCtx))}d.then(function(e){e.rootsWithFilter&&o(e.rootsWithFilter),e.objectsWithoutFilterDrop.physicalid.length>0&&o(e.objectsWithoutFilterDrop)})}if(e.authorized_filter_objects.length>0){let t=l(e.authorized_filter_objects);o(t)}}Promise.all(s).then(function(){console.log("allpromisesresolved")})}(e,t)}}}),t.preventDefault(),t.stopImmediatePropagation(),t.stopPropagation()}function p(e){0!=e.unauthorized_objects.length?t.warningAlert(s.drop_unauthorizeRootType):t.warningAlert(s.invalidDropOperation)}function f(e){let t=[];return e.forEach(function(e){t.push(e.objectId)}),t}function h(e){let r=[],n=[];var i=e.authorized_objects;let o=e.authorized_root_objects.map(e=>e.objectId);return i.forEach(function(e){if(e&&e.path&&e.path[0].resourceid){r.push(e.path[0].resourceid);let t=[];e.path.forEach(function(e){t.push(e.resourceid)}),n.push(t)}else e&&e.objectId&&(o.includes(e.objectId)?r.push(e.objectId):t.warningAlert(s.drop_unauthorizeRootType))}),{physicalIds:r,occurrencePath:n}}return{_dropArea:null,_trmModelEvents:null,_container:null,_onDragStartRowHeader:function(t,r){var n=r.draggedNodes;t.dataTransfer.effectAllowed="all";var i=e.prepareDragData(n);return t.dataTransfer.setData("Text",i),!1},_onDragEndRowHeader:function(e,t){this._dropArea&&this._dropArea.hide()},initializeDropArea:function(e){a=this;this.dropInRichView=e.dropInRichView;let t={container:e.container,events:e.events,dropContext:e.dropContext};this._trmModelEvents=e.events,function(e){this.dragDropZone=[],this.dropOptions=e.container;var t=this.dropContainer=UWA.createElement("div",{class:"trm-dropAreaMainContainer",draggable:!1}).inject(e.container);for(const i of e.dropContext){var r=this.dragDropZone[i.id]=UWA.createElement("div",{class:"trm-dropZone "+i.id,draggable:!1}).inject(t);if(!a.dropInRichView){var n=UWA.createElement("div",{class:"trm-dropIconAndText "+i.id}).inject(r);UWA.createElement("i",{class:"trm-img wux-ui-3ds wux-ui-3ds-4x "+i.icon}).inject(n),UWA.createElement("h6",{class:"trm-txt "+i.id,text:i.title}).inject(n)}}}.call(this,t),e.container.addEventListener("dragenter",function(e){if(c++,!0!==this.dropContainer.isHidden()&&!sessionStorage.getItem("isColumnHeader")){var t=r.firstParentWithClass(e.target,"trm-dropZone");t&&o.actual!==t&&(o.actual&&o.actual.classList.remove("hightLight-dropzone"),t.classList.add("hightLight-dropzone"),o.actual=t),e.preventDefault()}}.bind(this)),e.container.addEventListener("dragover",function(e){e.preventDefault()}.bind(this)),e.container.addEventListener("dragend",function(e){c=0,u=!1,this.dropOptions&&this.dropOptions.firstElementChild.classList.contains("trm-dropArea-opacity")&&this.dropOptions.firstElementChild.classList.remove("trm-dropArea-opacity"),o.actual&&o.actual.classList&&(o.actual.classList.remove("hightLight-dropzone"),o.actual=null),document.querySelectorAll(".trm-dropAreaMainContainer").forEach(e=>{e.hide()}),l=null,e.preventDefault()}.bind(this)),e.dragContainer.addEventListener("dragover",function(e){if(l=l||performance.now(),(d=performance.now())-l>500&&!u){if(u=!0,sessionStorage.getItem("isColumnHeader"))return;this.dropOptions.firstElementChild&&this.dropOptions.firstElementChild.classList.add("trm-dropArea-opacity"),this.dropContainer.show(),e.preventDefault()}}.bind(this)),e.container.addEventListener("drop",g.bind(this)),e.container.addEventListener("dragleave",function(e){0==--c&&(u=!1,this.dropOptions&&this.dropOptions.firstElementChild.classList.contains("trm-dropArea-opacity")&&this.dropOptions.firstElementChild.classList.remove("trm-dropArea-opacity"),e.fromElement===o.actual&&(o.actual&&o.actual.classList&&o.actual.classList.remove("hightLight-dropzone"),o.actual=null),document.querySelectorAll(".trm-dropAreaMainContainer").forEach(e=>{e.hide()})),e.preventDefault()}.bind(this)),this.dropContainer.hide()},onDragStartCell:function(t,r){var n=[],i=this.getNodesXSO();i&&(n=i.get().concat()).sort(function(e,t){return e._getRowID()-t._getRowID()}),n&&0!==n.length||(n=[r.nodeModel]);var s=n;s||(s=[]),t.dataTransfer.effectAllowed="all";var o=e.prepareDragData(s);return t.dataTransfer.setData("Text",o),!1},onDragEndCell:function(e,t){}}}),define("DS/TraceableRequirementsUtils/Services/RequirementDBServices",["UWA/Core","UWA/Class","DS/WAFData/WAFData","DS/PADUtils/PADContext","DS/TraceableRequirementsUtils/Utils","DS/LifecycleServices/LifecycleServices","DS/LifecycleServices/LifecycleServicesSettings"],function(e,t,r,n,i,s,o){"use strict";var a=function(e,t){var n=i.getLanguage();e.timeout=1e9,e.method="GET",e.headers&&(e.headers.Accept="application/json",e.headers["Cache-Control"]="no-cache",e.headers["Content-Type"]="application/json",e.headers.SecurityContext=i.getEncodedURI(e.headers.SecurityContext)),e.headers["Accept-Language"]=n,t=(t=t.replace(/\[/g,"%5B")).replace(/\]/g,"%5D"),t=i.appendTenantInUrl(t),r.authenticatedRequest(t,e)},l=function(t,s,o){var a=i.getLanguage();t.timeout=1e9,t.method="POST",t.headers.Accept="application/json",t.headers["Content-Type"]="application/json",t.headers["Cache-Control"]="no-cache",t.headers["Accept-Language"]=a,t.headers.SecurityContext=i.getEncodedURI(t.headers.SecurityContext);var l=n.get();e.is(l)&&e.is(l.getCSRF)&&(o.csrf=l.getCSRF()),e.is(l)&&e.is(l.getAuthoringContextHeader)&&(t.headers=Object.assign(t.headers,l.getAuthoringContextHeader())),t.data=JSON.stringify(o),s=i.appendTenantInUrl(s),r.authenticatedRequest(s,t)},c=function(t,n,s){var o=i.getLanguage();t.method="PUT",t.headers.Accept="application/json",t.headers["Content-Type"]="application/json",t.headers["Accept-Language"]=o,t.headers.SecurityContext=i.getEncodedURI(t.headers.SecurityContext);var a=null;try{var l=require("DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext").get();a=e.is(l)&&e.is(l.change.id)?l.change.id:null}catch(e){console.warn("CfgAuthoringContext throw an error")}null!=a&&""!=a.trim()&&(t.headers["DS-Change-Authoring-Context"]="pid:"+a),s.csrf=t.csrf,t.data=JSON.stringify(s),n=i.appendTenantInUrl(n),r.authenticatedRequest(n,t)},u=function(t,s,o){var a=i.getLanguage();t.method="PUT",t.headers||(t.headers.Accept="application/json",t.headers["Content-Type"]="application/json",t.headers["Accept-Language"]=a,t.headers.SecurityContext=i.getEncodedURI(t.headers.SecurityContext));var l=n.get();e.is(l)&&e.is(l.getCSRF)&&(o.csrf=l.getCSRF()),e.is(l)&&e.is(l.getAuthoringContextHeader)&&(t.headers=Object.assign(t.headers,l.getAuthoringContextHeader())),t.data=JSON.stringify(o),s=i.appendTenantInUrl(s),r.authenticatedRequest(s,t)};return t.singleton({fetchPredicateData:function(t){var r=t;r.method="POST",r.headers||(r.headers={});var n=i.getServiceSearchUrl()+"/search",s=r.query,o=e.is(r.predicate,"array")?r.predicate:[r.predicate],a=e.merge(e.clone({}),{nresults:1e3,label:i.getRequestLabel(),select_predicate:o,select_synthesis:o,query:s,source:["3dspace"],tenant:i.getTenant(),specific_source_parameter:{"3dspace":{search_in_context:{expand:{root_path_physicalid:[r.RootIDs]}}}}});r.next_start&&(a.next_start=r.next_start),l(r,n,a)},insertExisting:function(t){var r=t;if(!e.is(r,"object"))throw new Error("Invalid inputs for RichViewWebService.insertExisting");r.headers||(r.headers={});var n=i.get3DSpaceUrl()+"/resources/trm/authoring/model/structure/insertexisting";if(e.is(t.securityContext)){r.headers.SecurityContext=t.securityContext;var s=t.json;l(r,n,s)}else this.getsecuritycontext({onComplete:function(i){var s=e.is(i,"string")?JSON.parse(i):i;r.headers.SecurityContext=s.SecurityContext;i=t.json;l(r,n,i)}})},getAllDimentions:function(t){var r=t;if(!e.is(r,"object"))throw new Error("Invalid inputs for RequirementWebService.getAllDimentions");r.headers||(r.headers={});var n=i.get3DSpaceUrl()+"/resources/dictionary/dimensions";a(r,n)},convertValuesToPreferredUnits:function(t){var r=t;if(!e.is(r,"object"))throw new Error("Invalid inputs for RequirementWebServices.convertValuesToPreferredUnits");r.headers||(r.headers={});var n=i.get3DSpaceUrl()+"/resources/dictionary/dimensions/convertValues";if(e.is(t.securityContext)){r.headers.SecurityContext=t.securityContext;var s=t.payload;l(r,n,s)}},endLinkConnect:function(t){var r=t;if(!e.is(r,"object"))throw new Error("Invalid inputs for RichViewWebService.connect");r.headers||(r.headers={});var n=i.get3DSpaceUrl()+"/resources/trm/authoring/model/structure/endlinkconnect";if(e.is(t.securityContext)){r.headers.SecurityContext=t.securityContext;var s=t.json;l(r,n,s)}else this.getsecuritycontext({onComplete:function(i){var s=e.is(i,"string")?JSON.parse(i):i;r.headers.SecurityContext=s.SecurityContext;i=t.json;l(r,n,i)}})},getLinkStatus:function(t){var r=t;if(!e.is(r,"object"))throw new Error("Invalid inputs for RichViewWebService.connect");r.headers||(r.headers={});var n=i.get3DSpaceUrl()+"/resources/trm/dictionary/linkstatus";r.headers.SecurityContext=t.securityContext;var s=t.json;l(r,n,s)},insertNew:function(t){var r=t;if(!e.is(r,"object"))throw new Error("Invalid inputs for RichViewWebService.insert");r.headers||(r.headers={});var n=t.type,s=i.get3DSpaceUrl()+"/resources/trm/authoring/model/structure/"+n+"/insertnew";if(e.is(t.securityContext)){r.headers.SecurityContext=t.securityContext;var o=t.json;l(r,s,o)}else this.getsecuritycontext({onComplete:function(n){var i=e.is(n,"string")?JSON.parse(n):n;r.headers.SecurityContext=i.SecurityContext;n=t.json;l(r,s,n)}})},reorder:function(t){var r=t;if(!e.is(r,"object"))throw new Error("Invalid inputs for RichViewWebService.reorder");r.headers||(r.headers={});var n=i.get3DSpaceUrl()+"/resources/trm/authoring/model/structure/reorder";if(e.is(t.securityContext)){r.headers.SecurityContext=t.securityContext;var s=t.json;l(r,n,s)}else this.getsecuritycontext({onComplete:function(i){var s=e.is(i,"string")?JSON.parse(i):i;r.headers.SecurityContext=s.SecurityContext;i=t.json;l(r,n,i)}})},getConfigSettings:function(t){var r=t;r.headers||(r.headers={});var n=i.get3DSpaceUrl()+"/resources/modeler/configuration/settingsServices/getConfigurationSettings";if(e.is(t.securityContext)){r.headers.SecurityContext=t.securityContext;var s=t.json;l(r,n,s)}else this.getsecuritycontext({onComplete:function(i){var s=e.is(i,"string")?JSON.parse(i):i;r.headers.SecurityContext=s.SecurityContext;i=t.json;l(r,n,i)}})},getReQConfigAuthManagement:function(e){var t=e;t.headers||(t.headers={});var r=i.get3DSpaceUrl()+"/resources/ParamWS/access/DomainElements?domainid=RequirementsConfiguration&xrequestedwith=xmlhttprequest";e.familyid&&(r=r+"&familyid="+e.familyid),a(t,r)},create:function(t){var r=t;if(!e.is(r,"object"))throw new Error("Invalid inputs for RichViewWebService.create");r.headers||(r.headers={}),r.method="POST";var s=t.type,o=i.get3DSpaceUrl()+"/resources/trm/authoring/model/"+s+"/create";if(e.is(t.securityContext)){r.headers.SecurityContext=t.securityContext;var a=t.json,c=n.get();e.is(c)&&e.is(c.getCSRF)&&(a.csrf=c.getCSRF()),e.is(c)&&e.is(c.getAuthoringContextHeader)&&(r.headers=Object.assign(r.headers,c.getAuthoringContextHeader())),l(r,o,a)}},edit:function(t){var r=t;if(!e.is(r,"object"))throw new Error("Invalid inputs for RichViewWebService.insert");r.headers||(r.headers={});var n=t.pid,s=i.get3DSpaceUrl()+"/resources/trm/authoring/model/edit/"+n;if(e.is(t.securityContext)){r.headers.SecurityContext=t.securityContext;var o=t.json;u(r,s,o)}else this.getsecuritycontext({onComplete:function(n){var i=e.is(n,"string")?JSON.parse(n):n;r.headers.SecurityContext=i.SecurityContext;n=t.json;u(r,s,n)}})},enforceWorkUnder:function(t){var r=t;if(!e.is(r,"object"))throw new Error("Invalid inputs for enforceWorkUnder");var n=i.getLanguage();r.headers||(r.headers={},r.headers.Accept="application/json",r.headers["Content-Type"]="application/json",r.headers["Accept-Language"]=n);var s=i.get3DSpaceUrl()+"/resources/modeler/change/changecontrol";if(e.is(t.securityContext)){r.headers.SecurityContext=t.securityContext;var o=t.json;u(r,s,o)}else this.getsecuritycontext({onComplete:function(n){var i=e.is(n,"string")?JSON.parse(n):n;r.headers.SecurityContext=i.SecurityContext;n=t.json;u(r,s,n)}})},editRelationAttributes:function(t){console.log("function called");var r=t;if(!e.is(r,"object"))throw new Error("Invalid inputs for RichViewWebService.insert");r.headers||(r.headers={});var n=t.pid,s=i.get3DSpaceUrl()+"/resources/trm/authoring/model/updateLinkStatus/"+n;if(e.is(t.securityContext)){r.headers.SecurityContext=t.securityContext;var o=t.json;console.log("in if"),u(r,s,o)}else this.getsecuritycontext({onComplete:function(n){var i=e.is(n,"string")?JSON.parse(n):n;r.headers.SecurityContext=i.SecurityContext;n=t.json;console.log("in else"),u(r,s,n)}})},getRelStatusValues:function(t){var r=t;if(!e.is(r,"object"))throw new Error("Invalid inputs for RequirementWebServices.getKindOf");r.headers||(r.headers={});var n=i.get3DSpaceUrl()+"/resources/rmt/get/browsing";if(e.is(t.securityContext)){r.headers.SecurityContext=t.securityContext;var s=t.json;l(r,n,s)}else this.getsecuritycontext({onComplete:function(i){var s=e.is(i,"string")?JSON.parse(i):i;r.headers.SecurityContext=s.SecurityContext;i=t.json;l(r,n,i)}})},getContent:function(t){var r=t;if(!e.is(r,"object"))throw new Error("Invalid inputs for RichViewWebService.insert");r.headers||(r.headers={});var n=t.pid,s=i.get3DSpaceUrl()+"/resources/trm/browsing/model/content/"+n;e.is(t.securityContext)?(r.headers.SecurityContext=t.securityContext,a(r,s)):this.getsecuritycontext({onComplete:function(t){var n=e.is(t,"string")?JSON.parse(t):t;r.headers.SecurityContext=n.SecurityContext,a(r,s)}})},getHistory:function(t){var r=t;if(!e.is(r,"object"))throw new Error("Invalid inputs for RequirementWebServices.insert");r.headers||(r.headers={});var n=t.pid,s=i.get3DSpaceUrl()+"/resources/trm/dictionary/history/"+n;e.is(t.securityContext)?(r.headers.SecurityContext=t.securityContext,a(r,s)):this.getsecuritycontext({onComplete:function(t){var n=e.is(t,"string")?JSON.parse(t):t;r.headers.SecurityContext=n.SecurityContext,a(r,s)}})},getAttributeRange:function(t){var r=t;if(!e.is(r,"object"))throw new Error("Invalid inputs for RequirementWebServices.insert");r.headers||(r.headers={});var n=t.attributeName,s=i.get3DSpaceUrl()+"/resources/trm/dictionary/attributerange/"+n;e.is(t.securityContext)?(r.headers.SecurityContext=t.securityContext,a(r,s)):this.getsecuritycontext({onComplete:function(t){var n=e.is(t,"string")?JSON.parse(t):t;r.headers.SecurityContext=n.SecurityContext,a(r,s)}})},getMyAppPreferences:function(e){var t=i.getServiceURL("3DCompass")+"/resources/AppsMngt/user/preference",r=e;return r.method="GET",r.headers={Accept:"application/json, text/plain"},r.data={name:e.preference_name},this.executeRequest(t,r)},setMyAppPreferences:function(e){var t=i.getServiceURL("3DCompass")+"/resources/AppsMngt/user/preference",r=e;return r.method="PUT",r.headers={Accept:"application/json","Content-Type":"application/x-www-form-urlencoded"},r.data={name:e.preference_name,value:e.value},this.executeRequest(t,e)},getDictionaryCUSTO:function(t){var r=t;if(!e.is(r,"object"))throw new Error("Invalid inputs for API DictionaryCUSTO");r.headers||(r.headers={});var n=i.get3DSpaceUrl()+"/resources/dictionary/DictionaryCUSTO?displayAttributes=true";e.is(t.securityContext)?(r.headers.SecurityContext=t.securityContext,a(r,n)):this.getsecuritycontext({onComplete:function(t){var i=e.is(t,"string")?JSON.parse(t):t;r.headers.SecurityContext=i.SecurityContext,a(r,n)}})},getAttributeInfo:function(t){var r=t;if(!e.is(r,"object"))throw new Error("Invalid inputs for RequirementWebServices.getAttributeInfo");r.headers||(r.headers={});var n=i.get3DSpaceUrl()+"/resources/trm/dictionary/attributeInfo";void 0!==t.attributes&&null!==t.attributes&&(n+="?attributes="+t.attributes),e.is(t.securityContext)?(r.headers.SecurityContext=t.securityContext,a(r,n)):this.getsecuritycontext({onComplete:function(t){var i=e.is(t,"string")?JSON.parse(t):t;r.headers.SecurityContext=i.SecurityContext,a(r,n)}})},getsecuritycontext:function(t){var r=i.get3DSpaceUrl(),n=t.tenant;e.is(n)&&(r=i.getTenant3DSpaceUrl(n)),t.proxy="passport";var s=r+"/resources/modeler/pno/person?current=true&select=preferredcredentials&select=collabspaces",o=t;if(o.headers||(o.headers={}),!e.is(s)||!e.is(o,"object"))throw new Error("Invalid inputs for RequirementWebServices.getsecuritycontext");a(o,s)},availablesecuritycontext:function(t){var r=i.get3DSpaceUrl(),n=t.tenant;e.is(n)&&(r=i.getTenant3DSpaceUrl(n)),t.proxy="passport";var s=r+"/resources/bps/cspaces",o=t;if(o.headers||(o.headers={}),e.is(n)&&(s+="?tenant="+n),!e.is(s)||!e.is(o,"object"))throw new Error("Invalid inputs for RequirementWebServices.availablesecuritycontext");a(o,s)},getInfo:function(t){var r=t,s=t.selectables;if(delete r.authored,!e.is(r,"object"))throw new Error("Invalid inputs for RequirementWebServices.getInfo");r.method="POST",r.headers||(r.headers={});var o=n.get();e.is(o)&&e.is(o.getAuthoringContextHeader)&&(r.headers=Object.assign(r.headers,o.getAuthoringContextHeader())),r.headers.SecurityContext=i.getEncodedURI(t.securityContext);var a=i.get3DSpaceUrl();a+="/resources/trm/dictionary/info",r.data=JSON.stringify({pid:t.pid.toString(),select:s.toString()}),a=(a=a.replace(/\[/g,"%5B")).replace(/\]/g,"%5D"),i.executeRequest(a,r)},setAttributeTreeOrder:function(t){var r=t;if(!e.is(r,"object"))throw new Error("Invalid inputs for RequirementWebServices.setAttributeTreeOrder");r.headers||(r.headers={});var n=i.get3DSpaceUrl()+"/resources/trm/authoring/model/structure/treeOrder";if(e.is(t.securityContext)){r.headers.SecurityContext=t.securityContext;var s=t.json;l(r,n,s)}else this.getsecuritycontext({onComplete:function(i){var s=e.is(i,"string")?JSON.parse(i):i;r.headers.SecurityContext=s.SecurityContext;i=t.json;l(r,n,i)}})},getAttributeTreeOrder:function(t){var r=t;if(!e.is(r,"object"))throw new Error("Invalid inputs for RequirementWebServices.getAttributeTreeOrder");r.headers||(r.headers={});var n=i.get3DSpaceUrl()+"/resources/trm/dictionary/treeOrder";n+="?pid="+t.pid,e.is(t.securityContext)?(r.headers.SecurityContext=t.securityContext,a(r,n)):this.getsecuritycontext({onComplete:function(t){var i=e.is(t,"string")?JSON.parse(t):t;r.headers.SecurityContext=i.SecurityContext,a(r,n)}})},getCsrfToken:function(t){var r=t;if(!e.is(r,"object"))throw new Error("Invalid inputs for RequirementDBServices.getCsrfToken");r.headers||(r.headers={});var n=i.get3DSpaceUrl()+"/resources/v1/application/E6WFoundation/CSRF";a(r,n)},getCustomTypes:function(t){var r=t;if(!e.is(r,"object"))throw new Error("Invalid inputs for RequirementWebServices.getCustomTypes");r.headers||(r.headers={});var n=i.get3DSpaceUrl()+"/resources/trm/browsing/model/custom/"+t.type;e.is(t.securityContext)?(r.headers.SecurityContext=t.securityContext,a(r,n)):this.getsecuritycontext({onComplete:function(t){var i=e.is(t,"string")?JSON.parse(t):t;r.headers.SecurityContext=i.SecurityContext,a(r,n)}})},getTypesHierarchy:function(e){var t=i.get3DSpaceUrl()+"/resources/enong/dico/gettypeshierarchy",r=e;r.method="POST",r.headers={Accept:"application/json, text/plain"};var n={types:e.types};l(r,t,n)},getKindOf:function(t){var r=t;if(!e.is(r,"object"))throw new Error("Invalid inputs for RequirementWebServices.getKindOf");r.headers||(r.headers={});var n=i.get3DSpaceUrl()+"/resources/trm/browsing/model/"+t.pid+"/kindof";e.is(t.securityContext)?(r.headers.SecurityContext=t.securityContext,a(r,n)):this.getsecuritycontext({onComplete:function(t){var i=e.is(t,"string")?JSON.parse(t):t;r.headers.SecurityContext=i.SecurityContext,a(r,n)}})},getAllStructure:function(t){var r=t;if(!e.is(r,"object"))throw new Error("Invalid inputs for RequirementWebServices.getKindOf");r.headers||(r.headers={});var n=i.get3DSpaceUrl()+"/resources/trm/browsing/model/"+t.pid+"/getAllStructure";e.is(t.securityContext)?(r.headers.SecurityContext=t.securityContext,a(r,n)):this.getsecuritycontext({onComplete:function(t){var i=e.is(t,"string")?JSON.parse(t):t;r.headers.SecurityContext=i.SecurityContext,a(r,n)}})},expand:function(t){var r=t;if(!e.is(r,"object"))throw new Error("Invalid inputs for RequirementWebServices.getKindOf");r.headers||(r.headers={});var n=i.get3DSpaceUrl()+"/resources/trm/browsing/model/expand?optimizedloading=true";r.headers.SecurityContext=i.getEncodedURI(t.securityContext),r.method="POST";var s=t.json;r.data=JSON.stringify(s),i.executeRequest(n,r)},detach:function(t){var r=t;if(!e.is(r,"object"))throw new Error("Invalid inputs for RequirementWebServices.detach");r.headers||(r.headers={});var n=i.get3DSpaceUrl()+"/resources/trm/authoring/model/detach";if(e.is(t.securityContext)){r.headers.SecurityContext=t.securityContext;var s=t.json;l(r,n,s)}else this.getsecuritycontext({onComplete:function(i){var s=e.is(i,"string")?JSON.parse(i):i;r.headers.SecurityContext=s.SecurityContext;i=t.json;l(r,n,i)}})},replaceByNewLatestRevision:function(t){var r=t;if(!e.is(r,"object"))throw new Error("Invalid inputs for RequirementWebServices.replaceByNewRevision");r.headers||(r.headers={});var n=i.get3DSpaceUrl()+"/resources/trm/authoring/model/replacebynewlatestrevision";if(e.is(t.securityContext)){r.headers.SecurityContext=t.securityContext;var s=t.json;l(r,n,s)}else this.getsecuritycontext({onComplete:function(i){var s=e.is(i,"string")?JSON.parse(i):i;r.headers.SecurityContext=s.SecurityContext;i=t.json;l(r,n,i)}})},navigate:function(t){var r=i.get3DSpaceUrl(),n=t;if(r+="/cvservlet/multiexpand",!e.is(r)||!e.is(n,"object"))throw new Error("Invalid inputs for PADWSAccess.navigate");if(!e.is(n.data,"object"))throw new Error("Invalid inputs for PADWSAccess.navigate options.data not found");return n.method="POST",n.headers={Accept:"application/json","Content-Type":"application/json"},t.data.label=PADUtilsServices.getRequestLabel(),delete n.data.authored,delete n.data.expand_iter,delete n.data.type_filter_bo,delete n.data.type_filter_rel,n.onTimeout=n.onTimeout||n.onFailure,n.data=JSON.stringify(n.data),this.executeRequest(r,n)},executeRequest:function(e,t){return e=i.appendTenantInUrl(e),r.authenticatedRequest(e,t)},replaceByExistingRevision:function(t){var r=t;if(!e.is(r,"object"))throw new Error("Invalid inputs for RequirementWebServices.replaceByExistingRevision");r.headers||(r.headers={});var n=i.get3DSpaceUrl()+"/resources/trm/authoring/model/replacebyexisitngrevision";if(e.is(t.securityContext)){r.headers.SecurityContext=t.securityContext;var s=t.json;l(r,n,s)}else this.getsecuritycontext({onComplete:function(i){var s=e.is(i,"string")?JSON.parse(i):i;r.headers.SecurityContext=s.SecurityContext;i=t.json;l(r,n,i)}})},getHierarchyOfSelectedNode:function(t){var r=t;if(!e.is(r,"object"))throw new Error("Invalid inputs for RequirementWebServices.replaceByNewRevision");r.headers||(r.headers={});var n=i.get3DSpaceUrl()+"/resources/trm/authoring/model/topDownRevise";if(e.is(t.securityContext)){r.headers.SecurityContext=t.securityContext;var s=t.json;l(r,n,s)}else this.getsecuritycontext({onComplete:function(i){var s=e.is(i,"string")?JSON.parse(i):i;r.headers.SecurityContext=s.SecurityContext;i=t.json;l(r,n,i)}})},handlePasteEvent:function(t){var r=t;if(!e.is(r,"object"))throw new Error("Invalid inputs for RequirementWebServices.handlePasteEvent");r.headers||(r.headers={});var n=i.get3DSpaceUrl()+"/resources/richeditor/res/htmlpreview?format=rtf";if(e.is(t.securityContext)){r.headers.SecurityContext=t.securityContext;var s=t.json;l(r,n,s)}else this.getsecuritycontext({onComplete:function(i){var s=e.is(i,"string")?JSON.parse(i):i;r.headers.SecurityContext=s.SecurityContext;i=t.json;l(r,n,i)}})},setsecuritycontext:function(t){var n=t;if(!e.is(n,"object"))throw new Error("Invalid inputs for RequirementWebServices.setsecuritycontext");n.headers||(n.headers={});var s=i.get3DSpaceUrl()+"/resources/pno/person/setsecuritycontext";n.data=t.json,n.method="POST",n.proxy="passport",n.headers["Content-Type"]="application/x-www-form-urlencoded",r.proxifiedRequest(s,n)},getScopeInformation:function(t){var r=t;if(!e.is(r,"object"))throw new Error("Invalid inputs for RequirementWebServices.getScopeInformation");r.headers||(r.headers={});let n=(i.isOnCloud()?i.getServiceURL("3dxengineeringapps")+"/SystemSynthesis":i.get3DSpaceUrl())+"/syc/api/scope/v1/res"+t.scopeId;e.is(t.securityContext)?(r.headers.SecurityContext=t.securityContext,a(r,n)):this.getsecuritycontext({onComplete:function(t){var i=e.is(t,"string")?JSON.parse(t):t;r.headers.SecurityContext=i.SecurityContext,a(r,n)}})},getDisplayNamePref:function(t){var r=t;if(!e.is(r,"object"))throw new Error("Invalid inputs for RequirementWebServices.getDisplayNamePref");r.headers||(r.headers={});var n=i.get3DSpaceUrl()+"/resources/trm/res/preferences/displayname";r.async=t.async,r.responseType="text",e.is(t.securityContext)?(r.headers.SecurityContext=t.securityContext,a(r,n)):this.getsecuritycontext({onComplete:function(t){var i=e.is(t,"string")?JSON.parse(t):t;r.headers.SecurityContext=i.SecurityContext,a(r,n)}})},getStructureWithStreaming:function(t){var r=t;if(!e.is(r,"object"))throw new Error("Invalid inputs for RequirementWebServices.getStructureWithStreaming");r.headers||(r.headers={});var n=i.get3DSpaceUrl()+"/resources/trm/streaming/structure/"+t.id;e.is(t.securityContext)?(r.headers.SecurityContext=t.securityContext,a(r,n)):this.getsecuritycontext({onComplete:function(t){var i=e.is(t,"string")?JSON.parse(t):t;r.headers.SecurityContext=i.SecurityContext,a(r,n)}})},getContentWithStreaming:function(t){var r=t;if(!e.is(r,"object"))throw new Error("Invalid inputs for RequirementWebServices.getContentWithStreaming");r.headers||(r.headers={});var n=i.get3DSpaceUrl()+"/resources/trm/streaming/content/"+t.id;e.is(t.securityContext)?(r.headers.SecurityContext=t.securityContext,a(r,n)):this.getsecuritycontext({onComplete:function(t){var i=e.is(t,"string")?JSON.parse(t):t;r.headers.SecurityContext=i.SecurityContext,a(r,n)}})},getRichContentWithStreaming:function(t){var r=t;if(!e.is(r,"object"))throw new Error("Invalid inputs for RequirementWebServices.getRichContentWithStreaming");n.get();r.headers||(r.headers={});var s=i.get3DSpaceUrl()+"/resources/trm/streaming/richContentAttr/"+t.id;e.is(t.securityContext)?(r.headers.SecurityContext=t.securityContext,a(r,s)):this.getsecuritycontext({onComplete:function(t){var n=e.is(t,"string")?JSON.parse(t):t;r.headers.SecurityContext=n.SecurityContext,a(r,s)}})},editRichText:function(t){var r=t;if(!e.is(r,"object"))throw new Error("Invalid inputs for RichViewWebService.editRichText");r.headers||(r.headers={});var n=t.pid,s=i.get3DSpaceUrl()+"/resources/trm/authoring/model/editContent/"+n;if(console.log("EditRich called from here"),e.is(t.securityContext)){r.headers.SecurityContext=t.securityContext;var o=t.json;c(r,s,o)}else this.getsecuritycontext({onComplete:function(n){var o=e.is(n,"string")?JSON.parse(n):n;o.SecurityContext?r.headers.SecurityContext=o.SecurityContext:r.headers.SecurityContext=i.getSecurityContextForProperties();n=t.json;c(r,s,n)}})},htmlConvert:function(t){var r=e.merge(t||{},{responseType:"text",cache:!1});r.headers||(r.headers={});var n=i.get3DSpaceUrl()+"/resources/richeditor/res/HTMLConvert?objectId="+t.id;e.is(t.securityContext)?(r.headers.SecurityContext=t.securityContext,a(r,n)):this.getsecuritycontext({onComplete:function(t){var i=e.is(t,"string")?JSON.parse(t):t;r.headers.SecurityContext=i.SecurityContext,a(r,n)}})},getOSLCContent:function(t){var r=t;if(!e.is(r,"object"))throw new Error("Invalid inputs for RequirementWebServices.getContentWithStreaming");r.headers||(r.headers={}),function(e,t){o.isLogicalDeleteActive(function(r){try{s.oslcRequest(e.tenant,e.service,t,{method:"GET",onSuccess:e.onComplete,onError:e.onFailure})}catch(e){console.log("OauthRequest not found")}})}(r,t.doors_url)},getTRMExpressionValue:function(t){var r=t;if(!e.is(r,"object"))throw new Error("Invalid inputs for RequirementWebServices.getTRMTRCExpressionValue");r.headers||(r.headers={});var n=this,s=function(){var s;if(e.is(t.expression,"string")){t.expression;s=i.get3DSpaceUrl()+"/resources/trm/res/preferences/reqconfig/"+t.expression,e.is(t.securityContext)?(r.headers.SecurityContext=t.securityContext,a(r,s)):n.getsecuritycontext({onComplete:function(t){var n=e.is(t,"string")?JSON.parse(t):t;r.headers.SecurityContext=n.SecurityContext,a(r,s)}})}else console.error("Expression value not specified or not a String. Please specify the expression value to get in {options.expression}.")};try{i.get3DSpaceUrl(),s()}catch(e){console.error(e),i.app_initialization(s)}},getTRCSessionInfo:function(t){var r=t;if(!e.is(r,"object"))throw new Error("Invalid inputs for RequirementWebService.getTRCSessionInfo");r.headers||(r.headers={});var n=i.get3DSpaceUrl()+"/resources/trm/res/TRCSessionInfo";a(r,n)},setTRCSessionId:function(t){var r=t;if(!e.is(r,"object"))throw new Error("Invalid inputs for RequirementWebService.setTRCSessionId");r.headers||(r.headers={});var n=i.get3DSpaceUrl()+"/resources/trm/res/TRCSessionId",s=t.json;l(r,n,s)}})}),define("DS/TraceableRequirementsUtils/Dictionary/TRMDictionaryAccess",["UWA/Core","UWA/Promise","DS/FedDictionaryAccess/FedDictionaryAccessAPI","DS/TraceableRequirementsUtils/Utils"],function(e,t,r,n){"use strict";function i(e,t,r){e[t]||(e[t]=[]),-1===e[t].indexOf(r)&&e[t].push(r)}function s(t,r,n){for(var i=!1,s={grid:e.clone(t.options.grid)},o=0;o<r.length;o++)s.grid[r[o]]&&n[r[o]][s.grid[r[o]]]&&n[r[o]][s.grid[r[o]]]!==s.grid[r[o]]&&(i=!0,s.grid[r[o]]=n[r[o]][s.grid[r[o]]]);return{updated:i,options:s}}return{retrieveNLS:function(i){return new t(function(t,s){r.getNlsOfPropertiesValues(JSON.stringify(i.nlsData),{tenantId:n.getPlatformId(),lang:n.getLanguage(),apiVersion:"R2019x",onComplete:function(r){var n=e.is(r,"string")?JSON.parse(r):r;t(n)},onFailure:function(e){console.warn("Cannot retrieve NLS"),t({})}})})},updateNLSforexport:function(o,a){var l=a||o.getAllDescendants();return new t(function(t,a){var c=function(e){for(var t={},r=require("DS/PADServices/utils/AttributesMgtV2"),n=r.getAvailableColumns(),s=r.getColumnsToNotNls(),o=n.filter(function(e){return-1===s.indexOf(e)}),a=0;a<e.length;a++)for(var l=e[a],c=Object.keys(l.options.grid),u=0;u<c.length;u++){var d=c[u];r.hasNLS(d)&&-1!==o.indexOf(d)&&"ds6w:reserved"!==d&&"positionMatrix-Instance"!==d&&i(t,d,l.options.grid[d])}return t}(l);r.getNlsOfPropertiesValues(JSON.stringify(c),{tenantId:n.getPlatformId(),lang:n.getLanguage(),apiVersion:"R2019x",onComplete:function(r){var n=function(e){for(var t={},r=Object.keys(e),n=0;n<r.length;n++)for(var i=e[r[n]],s=Object.keys(i),o=0;o<s.length;o++){var a=s[o],l=i[a];l&&a!==l&&0!==l.indexOf("emxFramework")&&(t[r[n]]||(t[r[n]]={}),t[r[n]][a]=l)}return t}(e.is(r,"string")?JSON.parse(r):r),i=Object.keys(n);o.setUseChangeTransactionMode(!0),o.withTransactionUpdate(function(){for(var e=0;e<l.length;e++){var t=l[e],r=s(t,i,n);!0===r.updated&&t.updateOptions(r.options)}}),o.setUseChangeTransactionMode(!1),t()},onFailure:function(e){console.warn("Cannot retrieve NLS"),t()}})})},getPropertiesForClass:function(i){return new t(function(t,s){r.getPropertiesForClass(i.classURIs,{tenantId:n.getPlatformId(),lang:n.getLanguage(),apiVersion:"R2019x",onComplete:function(r){var n=e.is(r,"string")?JSON.parse(r):r;t(n)},onFailure:function(e){s(e)}})})},getResourcesInfo:function(e){return new t(function(t,i){var s={tenantId:n.getPlatformId(),lang:n.getLanguage(),apiVersion:"R2019x",onComplete:function(e){t(e)},onFailure:function(r){console.warn("DictionaryAccess## FedDictionaryAccessAPI.getResourcesInfo failed for"+e.join(",")),r&&r.length?t(r):t()}};r.getResourcesInfo(e.join(","),s)})},getClassificationAttributes:function(e){return new t(function(t,r){if(!e.interfaces.includes("ClassificationAttributes"))return t();require(["DS/ClassificationUtil/ClassificationUtil"],function(e){e.fetchClassificationAttributes({apiVersion:"R2019x",lang:n.getLanguage(),onComplete:function(e){t(e)},onFailure:function(e){console.warn("Cannot retrieve Classification Attributes"),t()}})})})}}}),define("DS/TraceableRequirementsUtils/RequirementServiceFactory",["UWA/Class","DS/TraceableRequirementsUtils/Services/RequirementDBServices","DS/TraceableRequirementsUtils/Services/RequirementCVServices","DS/TraceableRequirementsUtils/Services/RequirementCommonServices"],function(e,t,r,n){"use strict";let i={};var s=function(){i.DBServices||(i.DBServices=t)},o=function(){i.CVServices||(i.CVServices=r)},a=function(){i.CommonServices||(i.CommonServices=n)};return e.singleton({createFactoryService:function(){s(),o(),a()},getServiceCtrl:function(e){let t;switch(e){case!1:i.CVServices?t=i.CVServices:(this.createFactoryService(),t=i.CVServices);break;case!0:i.DBServices?t=i.DBServices:(this.createFactoryService(),t=i.DBServices);break;default:i.CommonServices?t=i.CommonServices:(this.createFactoryService(),t=i.CommonServices)}return t}})}),define("DS/TraceableRequirementsUtils/Services/RequirementWebServices",["DS/TraceableRequirementsUtils/Utils","DS/TraceableRequirementsUtils/RequirementServiceFactory"],function(e,t){"use strict";return{fetchPredicateData:function(e){t.getServiceCtrl(!0).fetchPredicateData(e)},insertExisting:function(e){t.getServiceCtrl(!0).insertExisting(e)},getAllDimentions:function(e){t.getServiceCtrl(!0).getAllDimentions(e)},convertValuesToPreferredUnits:function(e){t.getServiceCtrl(!0).convertValuesToPreferredUnits(e)},endLinkConnect:function(e){t.getServiceCtrl(!0).endLinkConnect(e)},getLinkStatus:function(e){t.getServiceCtrl(!0).getLinkStatus(e)},insertNew:function(e){t.getServiceCtrl(!0).insertNew(e)},reorder:function(e){t.getServiceCtrl(!0).reorder(e)},getConfigSettings:function(e){t.getServiceCtrl(!0).getConfigSettings(e)},getReQConfigAuthManagement:function(e){t.getServiceCtrl(!0).getReQConfigAuthManagement(e)},create:function(e){t.getServiceCtrl(!0).create(e)},edit:function(e){t.getServiceCtrl(!0).edit(e)},enforceWorkUnder:function(e){t.getServiceCtrl(!0).enforceWorkUnder(e)},editRelationAttributes:function(e){t.getServiceCtrl(!0).editRelationAttributes(e)},getRelStatusValues:function(e){t.getServiceCtrl(!0).getRelStatusValues(e)},getContent:function(e){t.getServiceCtrl(!0).getContent(e)},getHistory:function(e){t.getServiceCtrl(!0).getHistory(e)},getAttributeRange:function(e){t.getServiceCtrl(!0).getAttributeRange(e)},getMyAppPreferences:function(e){t.getServiceCtrl(!0).getMyAppPreferences(e)},setMyAppPreferences:function(e){t.getServiceCtrl(!0).setMyAppPreferences(e)},getDictionaryCUSTO:function(e){t.getServiceCtrl(!0).getDictionaryCUSTO(e)},getAttributeInfo:function(e){t.getServiceCtrl(!0).getAttributeInfo(e)},getsecuritycontext:function(e){t.getServiceCtrl(!0).getsecuritycontext(e)},availablesecuritycontext:function(e){t.getServiceCtrl(!0).availablesecuritycontext(e)},getInfo:function(r){let n=r.authored?r.authored:e.determineAuthoredFlag();t.getServiceCtrl(n).getInfo(r)},getTypeInfo:function(e){t.getServiceCtrl().getTypeInfo(e)},interfaces:function(e){t.getServiceCtrl().interfaces(e)},setAttributeTreeOrder:function(e){t.getServiceCtrl(!0).setAttributeTreeOrder(e)},getAttributeTreeOrder:function(e){t.getServiceCtrl(!0).getAttributeTreeOrder(e)},getCsrfToken:function(e){t.getServiceCtrl(!0).getCsrfToken(e)},getCustomTypes:function(e){t.getServiceCtrl(!0).getCustomTypes(e)},getTypesHierarchy:function(e){t.getServiceCtrl(!0).getTypesHierarchy(e)},getKindOf:function(e){t.getServiceCtrl(!0).getKindOf(e)},getAllStructure:function(e){t.getServiceCtrl(!0).getAllStructure(e)},expand:function(r){let n=r.authored?r.authored:e.determineAuthoredFlag();t.getServiceCtrl(n).expand(r)},detach:function(e){t.getServiceCtrl(!0).detach(e)},replaceByNewLatestRevision:function(e){t.getServiceCtrl(!0).replaceByNewLatestRevision(e)},navigate:function(e){t.getServiceCtrl(!0).navigate(e)},replaceByExistingRevision:function(e){t.getServiceCtrl(!0).replaceByExistingRevision(e)},getHierarchyOfSelectedNode:function(e){t.getServiceCtrl(!0).getHierarchyOfSelectedNode(e)},handlePasteEvent:function(e){t.getServiceCtrl(!0).handlePasteEvent(e)},setsecuritycontext:function(e){t.getServiceCtrl(!0).setsecuritycontext(e)},getScopeInformation:function(e){t.getServiceCtrl(!0).getScopeInformation(e)},getDisplayNamePref:function(e){t.getServiceCtrl(!0).getDisplayNamePref(e)},getStructureWithStreaming:function(e){t.getServiceCtrl(!0).getStructureWithStreaming(e)},getContentWithStreaming:function(e){t.getServiceCtrl(!0).getContentWithStreaming(e)},getRichContentWithStreaming:function(e){t.getServiceCtrl(!0).getRichContentWithStreaming(e)},editRichText:function(e){t.getServiceCtrl(!0).editRichText(e)},htmlConvert:function(e){t.getServiceCtrl(!0).htmlConvert(e)},getOSLCContent:function(e){t.getServiceCtrl(!0).getOSLCContent(e)},getTRMExpressionValue:function(e){t.getServiceCtrl(!0).getTRMExpressionValue(e)},getTRCSessionInfo:function(e){t.getServiceCtrl(!0).getTRCSessionInfo(e)},setTRCSessionId:function(e){t.getServiceCtrl(!0).setTRCSessionId(e)}}}),define("DS/TraceableRequirementsUtils/Command/ActionBar_CopyLinkCmd",["DS/TraceableRequirementsUtils/Command/ReqCmdBase","DS/PADUtils/PADContext","DS/TraceableRequirementsUtils/utils/RequirementAlertManager","DS/TraceableRequirementsUtils/Services/RequirementWebServices","DS/TraceableRequirementsUtils/Utils","i18n!DS/TraceableRequirementsUtils/assets/nls/TraceableRequirementsUtils"],function(e,t,r,n,i,s){"use strict";return e.extend({name:"REQ_ACTION_BAR",init:function(e){this._parent(e,{isAsynchronous:!0}),this._options=e},beginExecute:function(){var e=t.get().getSelectedNodes();this._copyLink(e),this.end()},_copyLink:function(e){if(1==e.length){let r="#app:"+i.getAppId()+"/content:X3DContentId=",s=this._buildData(e[0]);var t=i.getServiceURL("3DDashboard")+r+encodeURIComponent(JSON.stringify(s)),n=i.copyTexttoCLipboard(t)}n?r.sucessAlert(s.replace(s.msg_success_copyLink,{label:e[0].getLabel()})):r.errorAlert(s.msg_error_copyLink)},_buildData:function(e){var t={source:i.getAppId(),widgetId:i.getWidgetId(),data:{items:[]}};if(e&&e.options){var r={envId:i.getPlatformId(),serviceId:"3DSpace",contextId:i.getSecurityContext(),objectId:e.options.resourceid,objectType:e.options.type};t.data.items.push(r)}return t}})}),define("DS/TraceableRequirementsUtils/Dictionary/TRMDictionaryMgt",["UWA/Promise","DS/TraceableRequirementsUtils/Utils","DS/TraceableRequirementsUtils/utils/RequirementAlertManager","DS/TraceableRequirementsUtils/utils/RequirementErrorManager","DS/TraceableRequirementsUtils/Dictionary/TRMDictionaryAccess","i18n!DS/TraceableRequirementsUtils/assets/nls/TraceableRequirementsUtils","DS/TraceableRequirementsUtils/Services/RequirementWebServices"],function(e,t,r,n,i,s,o){"use strict";var a={},l=null,c={buildIconUrl:function(e){return null===l&&(l=t.get3DSpaceUrl()+"/snresources/images/icons/small/"),e?l+e+".png":""},getClassificatonExtnProperties:function(e){return{name:"ClassificationAttributes",nlsName:s.Classifications,lang:t.getLanguage(),declareIn:["Requirement"]}},getNLSForTypes:function(e){var t=e.replace("ds6wg:","");return a.typesInfo[t]?a.typesInfo[t].displayName:a.extensions[t]?a.extensions[t].nlsName:a.automaticExtensions[t]?a.automaticExtensions[t].nlsName:t},getTypesInfo:function(t,s){return new e(function(e){o.getTypeInfo({url_parameters:{parentInfo:!0,$select:"IconName"},body:t.baseTypes,onComplete:function(t){!function(t){t="string"==typeof t?JSON.parse(t):t;var r=Object.getOwnPropertyNames(t),n={"ds6w:type":r};i.retrieveNLS({nlsData:n}).then(function(n){for(var i=0;i<r.length;i++)n["ds6w:type"][r[i]]?t[r[i]].displayName=n["ds6w:type"][r[i]]:t[r[i]].displayName=r[i],null==t[r[i]].IconName&&null!=t[r[i]].parent&&(t[r[i]].IconName=t[t[r[i]].parent].IconName),t[r[i]].iconUrl=c.buildIconUrl(t[r[i]].IconName);e(t),a.typesInfo=t})}(t)},onFailure:function(e){var t=n.getParseErrorMessage(e);r.errorAlert(t)},onTimeout:function(e){var t=n.getParseErrorMessage(e);r.errorAlert(t)}})})},getInterfaces:function(t,i){return new e(function(e){o.interfaces({url_parameters:{},onlyCustomer:t.onlyCustomer,data:{classes:t.classes},onComplete:function(t){!function(t){for(var r={},n={},i=(t="string"==typeof t?JSON.parse(t):t).results,s=0;s<i.length;s++)for(var o=i[s].name,l=0;l<i[s].interfaces.length;l++)i[s].interfaces[l].automatic&&"yes"===i[s].interfaces[l].automatic.toLowerCase()||i[s].interfaces[l].name.startsWith("XP_")&&i[s].interfaces[l].name.endsWith("_Ext")?(void 0===n[i[s].interfaces[l].name]&&(n[i[s].interfaces[l].name]=i[s].interfaces[l],n[i[s].interfaces[l].name].declareIn=[]),n[i[s].interfaces[l].name].declareIn.push(o)):(void 0===r[i[s].interfaces[l].name]&&(r[i[s].interfaces[l].name]=i[s].interfaces[l],r[i[s].interfaces[l].name].declareIn=[]),r[i[s].interfaces[l].name].declareIn.push(o));var u=c.getClassificatonExtnProperties();r[u.name]=u,e({extensions:r,automaticExtensions:n}),a.extensions=r,a.automaticExtensions=n}(t)},onFailure:function(e){var t=n.getParseErrorMessage(e);r.errorAlert(t)},onTimeout:function(e){var t=n.getParseErrorMessage(e);r.errorAlert(t)}})})},getPredicates:function(t){return new e(function(r,n){var s=[i.getPropertiesForClass(t)];e.all(s).then(function(n){for(var s=n[0],o=n[1],l={},c=0;c<s.length;c++)for(var u=s[c],d=0;d<u.properties.length;d++){var g=u.properties[d];if(o){var p=g.originCuri;-1!==p.indexOf("ds6wg:")&&(p=p.replace("ds6wg:","")),g.dbAttrName=[],o.has(p)&&(g.dbAttrName=Array.from(o.get(p)))}if(void 0===l[g.curi])l[g.curi]=g,l[g.curi].inTypes=[u.classInfo.curi];else if(l[g.curi].inTypes.push(u.classInfo.curi),o){l[g.curi].dbAttrName;var f=g.dbAttrName;for(var h in f){var m=f[h];-1===l[g.curi].dbAttrName.indexOf(m)&&l[g.curi].dbAttrName.push(m)}}}var v=new e(function(e){i.getClassificationAttributes(t).then(function(t){if(t&&t.length>0)for(var r=0;r<t.length;r++)for(var n=t[r],i=0;i<n.properties.length;i++){var s=n.properties[i];void 0===l[s.curi]?(l[s.curi]=s,l[s.curi].inTypes=[n.classInfo.curi]):l[s.curi].inTypes.push(n.classInfo.curi)}e()}).catch(function(t){e()})}),S=[];if(S.push(v),(void 0===t.queryTypeNLS||!0===t.queryTypeNLS)&&void 0===l["ds6w:type"]){l["ds6w:type"]={curi:"ds6w:type",label:"ds6w:type",dataType:"string"};var _=new e(function(e){i.getResourcesInfo(["ds6w:type"]).then(function(t){UWA.is(t,"array")&&1===t.length&&(l["ds6w:type"]=UWA.merge(t[0],l["ds6w:type"])),e()})});S.push(_)}e.all(S).then(function(){r({availaibleAttributes:l}),a.availaibleAttributes=l})})})}};return c}),define("DS/TraceableRequirementsUtils/Services/RequirementUserPrefrences",["UWA/Core","UWA/Controls/Abstract","DS/TraceableRequirementsUtils/Services/RequirementWebServices","DS/TraceableRequirementsUtils/Utils","DS/Logger/Logger"],function(e,t,r,n,i){"use strict";var s=null,o=i.getLogger(l);try{n.getPlatformServices(),a(!1)}catch(e){null,n.app_initialization(function(){a(!1)})}function a(e){return UWA.is(e)||(e=!1),null===s&&(s=sessionStorage.getItem("RMTPreferredDisplayName"),null===(s=UWA.is(s,"string")?JSON.parse(s):s)&&r.getDisplayNamePref({async:!e,onComplete:function(e){e=UWA.is(e,"string")?JSON.parse(e):e,s=e.results,sessionStorage.setItem("RMTPreferredDisplayName",JSON.stringify(s))},onFailure:function(e){o.log(e.message)},onTimeout:function(){o.log("WS timeout")}})),s}var l=t.extend({init:function(){this,this._logger=o},getDisplayNamePref:function(){try{return a(!0)}catch(e){}}});return l}),define("DS/TraceableRequirementsUtils/Command/ActionBar_AddNewCmd",["DS/ENONewWidget/command/NewContentCommandBase","DS/TraceableRequirementsUtils/Command/ReqCmdBase","DS/TraceableRequirementsUtils/utils/RequirementAlertManager","DS/TraceableRequirementsUtils/utils/RequirementErrorManager","DS/TraceableRequirementsUtils/Utils","DS/PADUtils/PADContext","i18n!DS/TraceableRequirementsUtils/assets/nls/TraceableRequirementsUtils","DS/TraceableRequirementsUtils/Services/RequirementWebServices","DS/RequirementFrameUtils/utils/RequirementFrameConstant","text!DS/TraceableRequirementsUtils/assets/RequirementRelationshipsPatterns.json"],function(e,t,r,n,i,s,o,a,l,c){"use strict";return e.extend({init:function(e){this._parent(e,{isAsynchronous:!0}),this._options=e,this._relPattern=JSON.parse(c);new t(e)},getType(){return this._options.arguments[0].Type},execute:function(){this.launchCreationDialog()},launchCreationDialog(){this._context=s.get(),this.creationPanelLoadEvent();var e,t,n,i,a,l=void 0,c=null,u=null,d=null,g=this._options.arguments[0].Type,p=null;if(UWA.is(this._context.getToAddSelectedElement)){if(null==(p=this._context.getToAddSelectedElement()))return void r.warningAlert(o.Requirement_Notif_MutliSelection);e=p.physicalid,t=p.element,n=p.type,i=p.kindof,UWA.is(p.previousSibling)&&null!=p.previousSibling.relId&&(u=p.previousSibling.relId),UWA.is(p.nextSibling)&&null!=p.nextSibling.relId&&(d=p.nextSibling.relId),UWA.is(p.previousNode)&&null!=p.previousNode&&(c=p.previousNode)}else{if(!UWA.is(this._context.authoring))return void r.errorAlert(o.Requirement_Notif_CmdNotAvailable);var f=this._context;if(UWA.is(f)&&(p=f.getSelectedElement(),UWA.is(p))){t=p.element,n=p.type;var h,m,v,S=f.getSelectedNode();UWA.is(S)&&UWA.is(S.getParent)&&UWA.is(S.getParent().options)&&(e=S.getParentID(),i=S.getParent().options.kindof),UWA.is(t)&&(h=t.attr("id")),UWA.is(h)&&(m=f.options.model.getNodesByElementID(h)[0],UWA.is(m)&&(u=m.getRelationID(),v=m.getNextBrother(),UWA.is(v)&&(d=v.getRelationID())))}}if(a=this._relPattern[i]||this._relPattern[n],l=null,UWA.is(a))if(l=a[g],UWA.is(l)){var _=[];_.push(u+","+d);var y={typeToCreate:g,commandName:this.options.ID,parentPID:e,previousNode:c,selectedIDs:_,relationship:l},b=this.getCreateOptions(y);this._context.beginBlockingTransaction(),this.launchCreateNew(b),this.end()}else r.errorAlert(o.Requirement_Notif_CmdNotAvailable);else r.errorAlert(o.Requirement_Notif_CmdNotAvailable)},getCreateOptions:function(e){var t=this,s="TRMCreate_prefType_"+e.typeToCreate,c=localStorage.getItem(s),u=t._context.getAuthoringContextHeader(),d={context:{header:Object.assign({SecurityContext:i.getSecurityContext()},u)},type:e.typeToCreate,silentMode:!1,notification:!0,labelTopBar:o[e.commandName],commandName:e.commandName,options:{preferedType:c,typeName:e.typeToCreate,parentPIDs:e.parentPID,selectedIDs:e.selectedIDs},viewType:"tabView"};return e.typeToCreate!=l.TYPE_CHAPTER&&e.typeToCreate!=l.TYPE_COMMENT&&(d.facets=[{name:"classificationFacet",facetoptions:{isBookmark:!0,isLibrary:e.typeToCreate!=l.TYPE_REQUIREMENT_GROUP,isExportControl:e.typeToCreate!=l.TYPE_REQUIREMENT_GROUP}}]),d.events={onSuccess:function(s){if("success"===s.status){t.status=s.status;var l,c,u=s.result[0].identifier,d="id,type,name,revision,physicalid,type.kindof,attribute[Title],cestamp,current.access[modify],current";null!=s.result[0].relations&&(l=s.result[0].relations[0].fromID,c=s.result[0].relations[0].relationshipID,d=d.concat(",relationship[",e.relationship,"].attribute[TreeOrder]")),t._context.author(!0),a.getInfo({securityContext:i.getSecurityContext(),pid:u,selectables:d,onComplete:function(n){var a;n=(n=i.parseResponse(n)).results[0],null!=s.result[0].relations&&(a=n["relationship["+e.relationship+"].attribute[TreeOrder]"]);var d={physicalid:u,"from.physicalid[connection]":l,"physicalid[connection]":c,"attribute[TreeOrder]":a};if(d=UWA.extend(d,n),UWA.is(t._context.refreshOnInsertSibling))t._context.refreshOnInsertSibling(d,e.previousNode);else{var g=[];g.push(d),t._context.refreshOnInsert(g,null,"insert")}let p=o.Requirement_Notif_ObjectCreationSuccess;r.sucessAlert(p)},onFailure:function(e,i){let s=n.getParseErrorMessage(e);t._context.endBlockingTransaction(),r.errorAlert(s)}})}},onFailure:function(e){let n=o.Requirement_Notif_ObjectCreationFailed+" "+o.FailureReasons;e&&e.result&&0==e.result[0].errors.length&&r.errorAlert(n),t._context.endBlockingTransaction()},onCancel:function(e){if(e&&e.preferedType){let t=e.preferedType;localStorage.setItem(s,t),console.log("local pref saved type : "+localStorage.getItem(s))}t._context.endBlockingTransaction()}},d},creationPanelLoadEvent:function(){let e=this;require(["DS/ENONewWidget/ENONew/Events"],function(t){t.addEvent("onCreationDialogAction",function(t){t&&"ready"===t.action&&e._context.endBlockingTransaction()})})}})}),define("DS/TraceableRequirementsUtils/Services/RequirementSecurityCtxMgt",["UWA/Class","UWA/Class/Events","DS/Logger/Logger","DS/TraceableRequirementsUtils/Services/RequirementWebServices","DS/TraceableRequirementsUtils/utils/RequirementAlertManager","DS/TraceableRequirementsUtils/Utils","DS/PADUtils/PADContext","i18n!DS/TraceableRequirementsUtils/assets/nls/TraceableRequirementsUtils","UWA/Promise"],function(e,t,r,n,i,s,o,a,l){"use strict";var c=e.singleton(t,{name:"RequirementSecurityCtxMgt",options:{},_preferences_added:!1,_logger:null,init:function(){this._logger=r.getLogger(c)},buildSecurityContext:function(e,t,r){return"ctx::"+r+"."+t+"."+e},buildDisplayString:function(e,t,r,n){return n?e+"  "+r:e+"  "+t+"  "+r},addSecurityCtx2Preferences:function(e,t){var r=this;return r._logger.log("addSecurityCtx2Preferences"),new l(function(t,n){if(void 0===widget)throw new Error("widget variable isn't defined");void 0!==e&&void 0!==e.events&&r.addEvents(e.events),!1===r._preferences_added?(r._logger.log("add the preferences"),widget.mergePreferences([{name:"trm_security_ctx",type:"list",label:a.trm_SecurityCtx,defaultValue:""}]),r._logger.log("Fill there values"),r._fillPreferences({tenant:void 0,update:!1}).then(function(){t([])}),r._preferences_added=!0):t([])})},updatePreferences:function(){this._logger.log("updatePreferences"),this.dispatchEvent("onUpdateSecurityContext",widget.getValue("trm_security_ctx"))},_fillPreferences:function(e){this._logger.log("_fillPreferences");var t=this;if(void 0===widget)throw new Error("widget variable isn't defined");return new l(function(r,i){UWA.is(e.tenant)||(e.tenant=s.getTenant()),new l(function(r,i){n.getsecuritycontext({tenant:e.tenant,onComplete:function(e){var n=UWA.is(e,"string")?JSON.parse(e):e,i=t.prepareForStorage(n);r({securityContext:i.securityContext,securityContextList:i.cspaces})},onFailure:function(e){console.log("selected tenant: "+this.tenant),console.log("called url: "+this.url),console.log("generated error: ",e),i(e)},onTimeout:function(e){i(e)}})}).then(function(n){t._update_trm_security_ctx_pref(n.securityContext,n.securityContextList,e.update),r([])}).catch(function(e){t._update_trm_security_ctx_pref(null),r([])})})},prepareForStorage:function(e){var t,r,n,i="ctx:",s=e.pid,o=[];for(var a in e.preferredcredentials){var l=e.preferredcredentials[a];switch(a){case"collabspace":t=l.name,l.title?l.title:t;break;case"organization":r=l.name;break;case"role":n=l.name}}i=this.buildSecurityContext(t,r,n);for(var c=!1,u=function(e,t){for(var r=[],n=0;n<e.collabspaces.length;n++)for(var i=e.collabspaces[n],s=0;s<i.couples.length;s++){var o=t.extractCouple(i.couples[s]);-1===r.indexOf(o.org)&&r.push(o.org)}return 1===r.length}(e,this),d=0;d<e.collabspaces.length;d++)for(var g=e.collabspaces[d],p=0;p<g.couples.length;p++){var f=this.extractCouple(g.couples[p]),h=this.buildSecurityContext(g.name,f.org,f.role),m=g.title?g.title:g.name,v={csName:m,label:this.buildDisplayString(m,f.orgTitle,f.roleNls,u),value:h};i===h&&(v.isDefault=!0,c=!0),o.push(v)}if(!c&&o.length){var S=o[0];S.isDefault=!0,i=S.value}return{userId:s,securityContext:i,cspaces:o}},extractCouple:function(e){var t="",r="",n="",i="";for(var s in e){var o=e[s];switch(s){case"organization":t=o.name,r=o.title;break;case"role":n=o.name,i=o.nls?o.nls:n}}return{org:t,orgTitle:r,role:n,roleNls:i}},_update_trm_security_ctx_pref:function(e,t,r){if(""!==e&&t.length>0){if(UWA.is(widget.getValue("trm_security_ctx"))&&""!==widget.getValue("trm_security_ctx")){var n=widget.getValue("trm_security_ctx");t.forEach(function(t){t.value===n&&(e=n)})}e||(e=t[0].value);var i=-1===e.indexOf("ctx::")?"ctx::"+e:e;widget.addPreference({name:"trm_security_ctx",type:"list",label:a.trm_SecurityCtx,defaultValue:i,options:t}),s.setXPrefCredentials(widget,i),widget.setValue("trm_security_ctx",i),this.dispatchEvent("onUpdateSecurityContext",i),!0===r&&widget.dispatchEvent("onEdit")}}});return c}),define("DS/TraceableRequirementsUtils/Command/ReqKeyBoardShortCut_InsertCmd",["DS/ENONewWidget/command/NewContentCommandBase","DS/PADUtils/PADContext","DS/TraceableRequirementsUtils/utils/RequirementAlertManager","DS/TraceableRequirementsUtils/utils/RequirementErrorManager","DS/TraceableRequirementsUtils/Utils","DS/TraceableRequirementsUtils/Services/RequirementWebServices","DS/RequirementFrameUtils/utils/RequirementFrameConstant","i18n!DS/TraceableRequirementsUtils/assets/nls/TraceableRequirementsUtils"],function(e,t,r,n,i,s,o,a){"use strict";return e.extend({init:function(e){var l=this;l.cmdOption=e,l._context=t.get(),l.securityContext=i.getSecurityContext(),l.creationPanelLoadEvent(),e.context={getENONewContext:function(){return{getCreateOptions:function(){l._context.beginBlockingTransaction();var e=l.cmdOption.data,t=UWA.is(e.parent.physicalId)?e.parent.physicalId:e.parent.objectId,i=l._context.getAuthoringContextHeader(),c="TRMCreate_prefType_"+e.type,u=localStorage.getItem(c),d={context:{header:Object.assign({SecurityContext:l.securityContext},i)},type:e.type,silentMode:!1,notification:!0,labelTopBar:a[e.operation],commandName:e.operation,options:{preferedType:u,typeName:e.type,parentPIDs:t,selectedIDs:l.cmdOption.selectedIDs},viewType:"tabView"};return e.type!=o.TYPE_CHAPTER&&e.type!=o.TYPE_COMMENT&&(d.facets=[{name:"classificationFacet",facetoptions:{isBookmark:!0,isLibrary:e.type!=o.TYPE_REQUIREMENT_GROUP,isExportControl:e.type!=o.TYPE_REQUIREMENT_GROUP}}]),d.events={onSuccess:function(t){if("success"===t.status){l.status=t.status;var i,o,c=t.result[0].identifier,u="id,type,name,revision,physicalid,type.kindof,attribute[Title],cestamp,current.access[modify],current";null!=t.result[0].relations&&(i=t.result[0].relations[0].fromID,o=t.result[0].relations[0].relationshipID,u=u.concat(",relationship[",e.relationship,"].attribute[TreeOrder]")),l._context.author(!0),s.getInfo({securityContext:l.securityContext,pid:c,selectables:u,onComplete:function(n){var s,c=(n=UWA.is(n,"string")?JSON.parse(n):n).results[0];null!=t.result[0].relations&&(s=c["relationship["+e.relationship+"].attribute[TreeOrder]"]),c.objectId=c.id,c.physicalId=c.physicalid,c.id=l.cmdOption.randomId,c.level=e.newLevel,c.content=e.content,c.fetchContent=!1,c.title=UWA.is(c["attribute[Title]"])?c["attribute[Title]"]:c["ds6w:label"],c.title=UWA.is(c.title)?c.title:"";var u={"from.physicalid[connection]":i,"physicalid[connection]":o,"attribute[TreeOrder]":s};c=UWA.extend(c,u),l._context.authoring._refreshOnInsert(c,e,e.placeholder,!0);let d=a.Requirement_Notif_ObjectCreationSuccess;l._context.endBlockingTransaction(),r.sucessAlert(d)},onFailure:function(e,t){let i=n.getParseErrorMessage(e);l._context.endBlockingTransaction(),r.errorAlert(i)}})}},onFailure:function(t){UWA.is(e.placeholder)&&e.placeholder.container.remove();let n=a.Requirement_Notif_ObjectCreationFailed+" "+a.FailureReasons;t&&t.result&&0==t.result[0].errors.length&&r.errorAlert(n),l._context.endBlockingTransaction()},onCancel:function(t){if("success"!==l.status&&UWA.is(e.placeholder)&&e.placeholder.container.remove(),t&&t.preferedType){let e=t.preferedType;localStorage.setItem(c,e),console.log("local pref saved type : "+localStorage.getItem(c))}l._context.endBlockingTransaction()}},d}}}},l._parent(e,{isAsynchronous:!0})},getType(){return this.cmdOption.data.type},creationPanelLoadEvent:function(){let e=this;require(["DS/ENONewWidget/ENONew/Events"],function(t){t.addEvent("onCreationDialogAction",function(t){t&&"ready"===t.action&&e._context.endBlockingTransaction()})})}})}),define("DS/TraceableRequirementsUtils/Command/HomePage_CreateCmd",["DS/ENONewWidget/command/NewContentCommandBase","DS/PADUtils/PADContext","DS/TraceableRequirementsUtils/utils/RequirementAlertManager","DS/TraceableRequirementsUtils/utils/RequirementErrorManager","DS/TraceableRequirementsUtils/Utils","DS/TraceableRequirementsUtils/Services/RequirementWebServices","DS/RequirementFrameUtils/utils/RequirementFrameConstant","DS/RequirementStructureBrowser/utils/TRMMask","i18n!DS/TraceableRequirementsUtils/assets/nls/TraceableRequirementsUtils"],function(e,t,r,n,i,s,o,a,l){"use strict";return e.extend({init:function(e){var c=this;c.data=e,c._context=t.get(),c.creationPanelLoadEvent(),e.context={getENONewContext:function(){return{getCreateOptions:function(){let e=c.data.container;a.mask(e);var t=c._context.getAuthoringContextHeader(),u="TRMCreate_prefType_"+c.data.type,d=localStorage.getItem(u),g={context:{header:Object.assign({SecurityContext:i.getSecurityContext()},t)},type:c.data.type,silentMode:!1,notification:!0,labelTopBar:l[c.data.commandName],commandName:c.data.commandName,options:{preferedType:d,typeName:c.data.type},viewType:"tabView"};return c.data.type!=o.TYPE_CHAPTER&&c.data.type!=o.TYPE_COMMENT&&(g.facets=[{name:"classificationFacet",facetoptions:{isBookmark:!0,isLibrary:c.data.type!=o.TYPE_REQUIREMENT_GROUP,isExportControl:c.data.type!=o.TYPE_REQUIREMENT_GROUP}}]),g.events={onSuccess:function(t){if("success"===t.status){var o=t.result[0].identifier,u={physicalid:o};c._context.author(!0);s.getInfo({securityContext:i.getSecurityContext(),pid:o,selectables:"type,name,revision,physicalid,type.kindof,attribute[Title],cestamp,current.access[modify]",onComplete:function(e){e=(e=i.parseResponse(e)).results[0],u=UWA.extend(u,e),c._context.refreshOnCreate(u,!0);let t=l.Requirement_Notif_ObjectCreationSuccess;r.sucessAlert(t)},onFailure:function(t,i){let s=n.getParseErrorMessage(t);a.unmask(e),r.errorAlert(s)}})}},onFailure:function(t){let n=l.Requirement_Notif_ObjectCreationFailed+" "+l.FailureReasons;t&&t.result&&0==t.result[0].errors.length&&r.errorAlert(n),a.unmask(e)},onCancel:function(t){if(t&&t.preferedType){let e=t.preferedType;localStorage.setItem(u,e),console.log("local pref saved type : "+localStorage.getItem(u))}a.unmask(e)}},g}}}},c._parent(e,{isAsynchronous:!0})},getType(){return this.data.type},creationPanelLoadEvent:function(){let e=this;require(["DS/ENONewWidget/ENONew/Events"],function(t){t.addEvent("onCreationDialogAction",function(t){t&&"ready"===t.action&&a.unmask(e.data.container)})})}})}),define("DS/TraceableRequirementsUtils/Services/RequirementTypeMgt",["UWA/Class","UWA/Class/Events","DS/Logger/Logger","DS/TraceableRequirementsUtils/Services/RequirementWebServices","DS/TraceableRequirementsUtils/utils/RequirementAlertManager","DS/TraceableRequirementsUtils/utils/RequirementErrorManager","DS/TraceableRequirementsUtils/Utils","DS/PADUtils/PADContext"],function(e,t,r,n,i,s,o,a){"use strict";var l=e.singleton(t,{name:"RequirementTypeMgt",options:{},_preferences_added:!1,_logger:null,_context:null,_defaultTypes:{},init:function(){this._logger=r.getLogger(l)},defineDefaultTypes:function(e){if(this._logger.log("defineDefaultTypes"),void 0===widget)throw new Error("widget variable isn't defined");if(void 0!==e&&void 0!==e.events&&this.addEvents(e.events),!1===this._preferences_added){this._logger.log("add the preferences");var t=this,r=[];e.types.forEach(function(e){var a=new Promise(function(r,a){e.replace(" ","_");n.getCustomTypes({securityContext:o.getSecurityContext(),type:e,onComplete:function(n){var i=UWA.is(n,"string")?JSON.parse(n):n,s=[];i.results.length>1&&i.results.forEach(function(e){"FALSE"===e.abstract&&s.push({label:e.label,value:e.value})}),t.addParentType(e,s),r()},onFailure:function(e){var t=s.getParseErrorMessage(e);i.errorAlert(t),a()},onTimeout:function(e){var t=s.getParseErrorMessage(e);i.errorAlert(t),a()}})});a&&r.push(a)}),Promise.allSettled(r).then(function(){t._preferences_added=!0,t._updateTypeHierarchy(t._defaultTypes),widget.setValue("authorized_types",t._defaultTypes)})}},initCsrfToken:function(){n.getCsrfToken({onComplete:function(e){let t=(UWA.is(e,"string")?JSON.parse(e):e).csrf,r={csrfTokenName:t.name,ENO_CSRF_TOKEN:t.value};var n=a.get();UWA.is(n)&&UWA.is(n.saveCSRF)&&n.saveCSRF(r)},onFailure:function(){console.log("csrf token failure ")},onTimeout:function(){console.log("csrf token timeout ")}})},addParentType:function(e,t){var r=this;t.length>0?t.forEach(function(t){UWA.is(t)&&(r._defaultTypes[t.value]=e)}):r._defaultTypes[e]=e},_updateTypeHierarchy:function(e){var t=[];for(var r in e)t.push(r);n.getTypesHierarchy({types:t,onComplete:function(e){(UWA.is(e,"string")?JSON.parse(e):e).types_hierarchies.forEach(function(e){widget.setValue(e.type,e.hierarchy)})},onFailure:function(e){var t=s.getParseErrorMessage(e);i.errorAlert(t)},onTimeout:function(e){var t=s.getParseErrorMessage(e);i.errorAlert(t)}})}});return l}),define("DS/TraceableRequirementsUtils/Command/ActionBar_InsertNewCmd",["DS/ENONewWidget/command/NewContentCommandBase","DS/TraceableRequirementsUtils/Command/ReqCmdBase","DS/TraceableRequirementsUtils/utils/RequirementAlertManager","DS/TraceableRequirementsUtils/Utils","DS/PADUtils/PADContext","DS/TraceableRequirementsUtils/Services/RequirementWebServices","DS/RequirementFrameUtils/utils/RequirementFrameConstant","DS/TraceableRequirementsUtils/utils/RequirementErrorManager","text!DS/TraceableRequirementsUtils/assets/RequirementRelationshipsPatterns.json","i18n!DS/TraceableRequirementsUtils/assets/nls/TraceableRequirementsUtils"],function(e,t,r,n,i,s,o,a,l,c){"use strict";return e.extend({init:function(e){this._parent(e,{isAsynchronous:!0}),this._options=e,this._relPattern=JSON.parse(l);new t(e)},getType(){return this._options.arguments[0].Type},execute:function(){this.launchCreationDialog()},launchCreationDialog(){this._context=i.get(),this.creationPanelLoadEvent();var e,t,n,s,a=this._options.arguments[0].Type,l=void 0,u=this._context.getSelectedElement();if(this._context.getSelectedElementList){var d=this._context.getSelectedElementList();if(null!=d&&d.length>1)return void r.warningAlert(c.Requirement_Notif_MutliSelection)}if(UWA.is(u))if(e=u.physicalid,t=u.type,n=u.kindof,s=this._relPattern[n]||this._relPattern[t],l=null,UWA.is(s)){if(l=s[a],!UWA.is(l)){if(!this._context.richView||a!==o.TYPE_REQUIREMENT_SPECIFICATION)return void r.errorAlert(c.Requirement_Notif_CmdNotAvailable);e=void 0}}else{if(!this._context.richView||a!==o.TYPE_REQUIREMENT_SPECIFICATION)return void r.errorAlert(c.Requirement_Notif_CmdNotAvailable);e=void 0}var g={typeToCreate:a,commandName:this.options.ID,parentPID:e,relationship:l},p=this.getCreateOptions(g);this._context.beginBlockingTransaction(),this.launchCreateNew(p),this.end()},getCreateOptions:function(e){var t=this,i="TRMCreate_prefType_"+e.typeToCreate,l=localStorage.getItem(i),u=t._context.getAuthoringContextHeader(),d={context:{header:Object.assign({SecurityContext:n.getSecurityContext()},u)},type:e.typeToCreate,silentMode:!1,notification:!0,labelTopBar:c[e.commandName],commandName:e.commandName,options:{preferedType:l,typeName:e.typeToCreate,parentPIDs:e.parentPID},viewType:"tabView"};return e.typeToCreate!=o.TYPE_CHAPTER&&e.typeToCreate!=o.TYPE_COMMENT&&(d.facets=[{name:"classificationFacet",facetoptions:{isBookmark:!0,isLibrary:e.typeToCreate!=o.TYPE_REQUIREMENT_GROUP,isExportControl:e.typeToCreate!=o.TYPE_REQUIREMENT_GROUP}}]),d.events={onSuccess:function(i){if("success"===i.status){var o=i.result[0].identifier;t._context.author(!0);var l,u,d="type,name,revision,physicalid,type.kindof,attribute[Title],cestamp,current.access[modify]";null!=i.result[0].relations&&(l=i.result[0].relations[0].fromID,u=i.result[0].relations[0].relationshipID,d=d.concat(",relationship[",e.relationship,"].attribute[TreeOrder]")),s.getInfo({securityContext:n.getSecurityContext(),pid:o,selectables:d,onComplete:function(i){i=(i=n.parseResponse(i)).results[0];var s=[];if(null==e.parentPID||null==e.parentPID)s={physicalid:o},s=UWA.extend(s,i),t._context.refreshOnCreate(s,!0);else{s={physicalid:o,"from.physicalid[connection]":l,"physicalid[connection]":u,"attribute[TreeOrder]":i["relationship["+e.relationship+"].attribute[TreeOrder]"]},s=UWA.extend(s,i);var a=[];a.push(s),t._context.refreshOnInsert(a,null,"insert")}let d=c.Requirement_Notif_ObjectCreationSuccess;t._context.endBlockingTransaction(),r.sucessAlert(d)},onFailure:function(e,n){let i=a.getParseErrorMessage(e,n);t._context.endBlockingTransaction(),r.errorAlert(i)}})}},onFailure:function(e){let n=c.Requirement_Notif_ObjectCreationFailed+" "+c.FailureReasons;e&&e.result&&0==e.result[0].errors.length&&r.errorAlert(n),t._context.endBlockingTransaction()},onCancel:function(e){if(e&&e.preferedType){let t=e.preferedType;localStorage.setItem(i,t),console.log("local pref saved type : "+localStorage.getItem(i))}t._context.endBlockingTransaction()}},d},creationPanelLoadEvent:function(){let e=this;require(["DS/ENONewWidget/ENONew/Events"],function(t){t.addEvent("onCreationDialogAction",function(t){t&&"ready"===t.action&&e._context.endBlockingTransaction()})})}})}),define("DS/TraceableRequirementsUtils/utils/LinkManager",["DS/TraceableRequirementsUtils/Services/RequirementWebServices","DS/TraceableRequirementsUtils/utils/RequirementAlertManager","DS/TraceableRequirementsUtils/utils/RequirementErrorManager","i18n!DS/TraceableRequirementsUtils/assets/nls/TraceableRequirementsUtils","DS/TraceableRequirementsUtils/utils/TRMConstant","DS/TraceableRequirementsUtils/Utils"],function(e,t,r,n,i,s){"use strict";return{getColumnDefinitions:function(e,t){return{text:e.text,hyperlinkTarget:"_self",getCellValue:function(e){return e&&e.nodeModel?e.nodeModel.options.grid[t]:void 0},getCellSemantics:function(e){let r;if(e&&e.nodeModel&&e.nodeModel.getKindOf()===i.TYPE_REQUIREMENT){switch(e.nodeModel.options.grid[t]){case n.LinkStatus_Valid:r=i.TAG_SUCCESS;break;case n.LinkStatus_Invalid:r=i.TAG_ERROR;break;case n.LinkStatus_Suspect:r=i.TAG_WARNING;break;case n.LinkStatus_None:r=i.TAG_PRIMARY}}return{emphasize:r}}}},getLinkStatusNLS:function(e){return Object.keys(e).forEach(function(t){switch(e[t]){case"Valid":e[t]=n.LinkStatus_Valid;break;case"Invalid":e[t]=n.LinkStatus_Invalid;break;case"Suspect":e[t]=n.LinkStatus_Suspect;break;case"None":e[t]=n.LinkStatus_None}}),e},getLinkStatus:function(n,i){let o=this;var a={objs:i,direction:"all"};e.getLinkStatus({securityContext:s.getSecurityContext(),json:a,onComplete:function(e){var r=UWA.is(e,"string")?JSON.parse(e):e;if("success"==r.status){var i=r.results.Success;Object.keys(i).forEach(function(e){n.getNodesById(e).forEach(function(t){t.updateProviderColumnValues({grid:o.getLinkStatusNLS(i[e])})})})}"error"==r.status&&t.warningAlert(r.message)},onFailure:function(e){var n=r.getParseErrorMessage(e);t.errorAlert(n)},onTimeout:function(e){var n=r.getParseErrorMessage(e);t.errorAlert(n)}})}}}),define("DS/TraceableRequirementsUtils/Command/ActionBar_ReplaceHierarchyByNewVersion",["DS/ApplicationFrame/Command","DS/Logger/Logger","DS/Tree/TreeDocument","DS/TreeModel/TreeNodeModel","DS/TreeModel/DataModelSet","DS/Tree/TreeListView","DS/UIKIT/Input/Button","DS/UIKIT/Scroller","DS/ENOFloatingPanel/ENOFloatingPanel","DS/PlatformAPI/PlatformAPI","DS/TraceableRequirementsUtils/Services/RequirementWebServices","DS/TraceableRequirementsUtils/Utils","DS/TraceableRequirementsUtils/REQCommandProxy","DS/TraceableRequirementsUtils/Command/ReqCmdBase","DS/PADUtils/PADContext","DS/TraceableRequirementsUtils/utils/RequirementAlertManager","DS/TraceableRequirementsUtils/utils/RequirementErrorManager","i18n!DS/TraceableRequirementsUtils/assets/nls/TraceableRequirementsUtils"],function(e,t,r,n,i,s,o,a,l,c,u,d,g,p,f,h,m,v){"use strict";var S=null,_=p.extend({name:"REQ_ACTION_BAR",_logger:null,init:function(e){return S=this,this._logger=t.getLogger(_),this._parent(e,{isAsynchronous:!0}),this.mediator=e.mediator,this._options=e,this.context=f.get(),this.defaultOptions.renderTo=this.context.structureEditor.container,this._commandProxy=new g,this._initialized=!0,this},_decodeHtml:function(e){var t=document.createElement("textarea");return t.innerHTML=e,t.value},launchRevisionWindow:function(e){var t=UWA.is(e.context)?e.context:e;S._buildDialog(t)},beginExecute:function(){var e,t=f.get(),r=!1,n=t.getSelectedNodes();if(UWA.is(n)&&1==n.length){var i=[],s=(n[0].getOccurencePath(),n[0].options.grid);this._logger.log(s["ds6w:status"]);var o=this._decodeHtml(s["ds6w:status"]);this._logger.log(o),n[0].isRoot()&&(r=!0),e=t.getReqSpecRoot(n[0]);var a={node:n};if(i.push(a),r)return h.warningAlert(v.Requirement_Headers_ReviseRoot),void this.end();if(null==e)return h.warningAlert(v.Requirement_Headers_ReviseRoot),void this.end();if(o!=v.HierarchicalRevise_Frozen&&o!=v.HierarchicalRevise_Released)return h.warningAlert(v.Requirement_Revise_Editable),void this.end();({objects_to_revise:i}),this.launchRevisionWindow(a)}else UWA.is(n)&&n.length>1?h.warningAlert(v.Requirement_Notif_MutliSelection):h.warningAlert(v.Requirement_Notif_ObjectSelection);this.end()},_buildDialog:function(e){S._dialogBody=UWA.createElement("div",{class:"hierarchical_revision_dialog",id:"hierarchical_revision"}),S.buildTreeListView(e).inject(S._dialogBody),S._footer=UWA.createElement("div"),S._cancelButton=new o({value:v.Hierarchical_DiaCancelBtn,name:"cancel_button"}),S._cancelButton.addEvents({onClick:function(e){S._onCancel(e)}}),S._doneButton=new o({value:v.Hierarchical_DiaDoneBtn,name:"done_button",className:"primary"}),S._doneButton.addEvents({onClick:function(e){S._onDone(e)}}),S._doneButton.inject(S._footer),S._cancelButton.inject(S._footer),S._floatingComponent=new l({className:"HierarchicalRevisionModel",title:v.Revise_Cmd_HierarchicalRevise,body:S._dialogBody,footer:S._footer,overlay:!0,closable:!0,resizable:!0,events:{onResizeFloating:function(){S._logger.log("onResizeFloating"),jQuery(".wux-layouts-gridengine-poolcontainer-rel:last").addClass("disabledCheckbox")},onClose:function(){S._logger.log("onClose"),S._onCancel(S._floatingComponent)}}}).inject(S.defaultOptions.renderTo),new a({element:UWA.Element.getElement.call(S._floatingComponent.getBody(),".hierarchical_revision_dialog")}),S._floatingComponent.show()},buildTreeListView:function(e){S._toReviseObjects=[],S._rootToRevise={},S._rootRevised=!1,S.selectedNode=e;var t=e.node[0].getParents(),o=[];o.push(e.node[0]);for(var a=0;a<t.length;a++)o.push(t[a]);var l=new r({}),c=[{text:v.Hierarchical_COL_Name,dataIndex:"tree",width:"auto"},{text:v.Hierarchical_COL_Revision,dataIndex:"ds6wg:revision",width:70},{text:v.Hierarchical_COL_State,dataIndex:"ds6w:status",width:70},{text:v.Hierarchical_COL_Owner,dataIndex:"ds6w:responsible",width:"auto"}],u=new s({treeDocument:l,columns:c,useAsyncPreExpand:!0,enableDragAndDrop:!1,height:"inherit",selection:{unselectAllOnEmptyArea:!1,toggle:!1},resize:{columns:!0},defaultColumnDef:{width:"auto",minWidth:40}});new i;l.useAsyncPreExpand=!0,l.prepareUpdate();var d=null;for(a=o.length-1;a>=0;a--){var g=o[a].options.grid,p=S._decodeHtml(g["ds6w:status"]);g.objectId=o[a]._options.resourceid,g.relId=o[a]._options.relationid,g.parentId=o[a]._parentNode._options.resourceid;var f=new n({label:g.displayName,grid:g});if(null==d){if(d=f,l.addChild(d),p==v.HierarchicalRevise_Frozen||p==v.HierarchicalRevise_Released){f.select();var h=o[a]._options.resourceid;S._rootToRevise={object_id:h},S._rootRevised=!0}}else if(null==d.getChildren()?d.addChild(f):d.getAllDescendants()[d.getAllDescendants().length-1].addChild(f),p==v.HierarchicalRevise_Frozen||p==v.HierarchicalRevise_Released){f.select();var m={object_id:h=o[a]._options.resourceid,rel_id:o[a]._options.relationid,parent_id:o[a]._parentNode._options.resourceid};S._toReviseObjects.push(m)}else{S._toReviseObjects=[],S._rootToRevise={},S._rootRevised=!1;for(var _=f.getParents(),y=0;y<_.length;y++)_[y].unselect()}}return l.expandAll(),l.pushUpdate(),u},_onCancel:function(){S._onLoadingUI=!1,S._logger.log("onCancel"),S._floatingComponent.hide(),S._floatingComponent.destroy()},_onDone:function(){S._onLoadingUI=!1,S._logger.log("onDelete");var e=S.selectedNode.node[0].getParents(),t=S._toReviseObjects,r=S._rootToRevise,n=f.get(),i={root_to_revise:r,objects_to_revise:t,revise_mode:"replaceByNewRevision"};u.getHierarchyOfSelectedNode({securityContext:d.getSecurityContext(),json:i,onComplete:function(t){S._logger.log("WS Revise.onComplete");var r=UWA.is(t,"string")?JSON.parse(t):t;if("success"===r.status)if(S._rootRevised){var i;i=(s=r.rootObject).root_object.physicalid,u.getInfo({securityContext:d.getSecurityContext(),pid:i,selectables:"type,name,revision,attribute[Title],type.kindof,current,physicalid,id",onComplete:function(t){var r=(UWA.is(t,"string")?JSON.parse(t):t).results[0];r.indexCreation=!1,n.refreshOnCreate(r,!1,e[e.length-1]),h.sucessAlert(v[S._options.arguments[0].Type+".Requirement_Headers_Revise"])},onFailure:function(e,t){var r=m.getParseErrorMessage(e,t);h.errorAlert(r)},onTimeout:function(e){var t=m.getParseErrorMessage(e);h.errorAlert(t)}})}else{var s;(s=[]).push(r.results[0]),n.refreshOnRevise(s),h.sucessAlert(v[S._options.arguments[0].Type+".Requirement_Headers_Revise"])}},onFailure:function(e,t){var r=m.getParseErrorMessage(e,t);h.errorAlert(r),S._logger.warn(e+""+t)},onTimeout:function(e){var t=m.getParseErrorMessage(e);h.errorAlert(t),S._logger.warn("WS detach.onTimeout")}}),S._onCancel()}});return _}),define("DS/TraceableRequirementsUtils/Command/ActionBar_InsertExistingCmd",["UWA/Core","DS/Logger/Logger","DS/TraceableRequirementsUtils/Command/ReqCmdBase","i18n!DS/TraceableRequirementsUtils/assets/nls/TraceableRequirementsUtils","DS/TraceableRequirementsUtils/utils/RequirementAlertManager","DS/TraceableRequirementsUtils/utils/RequirementErrorManager","text!DS/TraceableRequirementsUtils/assets/RequirementRelationshipsPatterns.json","DS/PADUtils/PADContext","DS/TraceableRequirementsUtils/Utils","DS/TraceableRequirementsUtils/Services/RequirementWebServices","DS/TraceableRequirementsUtils/utils/TRMReportPanel","UWA/Class/Promise","i18n!DS/RequirementStructureBrowser/assets/nls/ENOREQ.json"],function(e,t,r,n,i,s,o,a,l,c,u,d,g){"use strict";var p=r.extend({name:"REQ_ACTION_BAR",_logger:null,_options:null,init:function(e){this._logger=t.getLogger(p),this._options=e,this._parent(e,{mode:"exclusive",isAsynchronous:!1}),this._relPattern=JSON.parse(o)},beginExecute:function(){this._logger.log(this._id+".beginExecute")},execute:function(){this._logger.log(this._id+".execute");var e=this;e.executingSearch=!0,require(["DS/PADUtils/PADContext","DS/TraceableRequirementsUtils/utils/SearchUtils"],function(t,r){var s,o=function(t){var n={precond:t,callback:e._onSelectionDone.bind(e),cancel_callback:e._endExecute.bind(e)};r.inAppsSearch(n)},a=t.get().getSelectedElement(),l=e._options.arguments.map(function(e){return e.Type});if(UWA.is(a)){var c=a.type,u=a.kindof,d=e._relPattern[u]||e._relPattern[c];if(UWA.is(d)){var g=Object.keys(d);if(l.length>0){s="(";for(var p=0;p<l.length;p++)s+=0===p?'flattenedtaxonomies:"types/'+l[p]+'"':' OR flattenedtaxonomies:"types/'+l[p]+'"';o(s+=")")}else{g.pop("Root"),s="(";for(p=0;p<g.length;p++)s+=0===p?'flattenedtaxonomies:"types/'+g[p]+'"':' OR flattenedtaxonomies:"types/'+g[p]+'"';o(s+=")")}}else i.warningAlert(n.Requirement_Notif_CmdNotAvailable),e._endExecute()}else i.warningAlert(n.Requirement_Notif_MutliSelection),e._endExecute()})},_endExecute:function(e){this._logger.log(this._id+".endExecute"),this.executingSearch=!1,this.end()},_onSelectionDone:function(e){var t=this;if(t.executingSearch){for(var r=a.get(),o=r.getSelectedElement(),p=o.physicalid,f=o.type,h=o.kindof,m=t._relPattern[f]||t._relPattern[h],v={dataArray:[]},S=e.length,_=l.getAuthorizedTypesWithParent(),y=t._options.arguments.map(function(e){return e.Type}),b=0;b<S;b++){var C,T=e[b]["ds6w:type_value"];t._options&&y.indexOf(_[T])>-1&&(C=m[_[T]]),UWA.is(C)&&v.dataArray.push({pid:p,id:e[b].resourceid,relationship:C,previousSibling:{},nextSibling:{}})}var x=v,R={Success:[],Failure:[]},A=t.chunk(x.dataArray,10),E=0;r.beginBlockingTransaction(g.composite);S=A.length;for(var D=0;D<S;D++){var U=new d(function(e,n){var o={dataArray:A[D]};c.insertExisting({securityContext:l.getSecurityContext(),json:o,onComplete:function(n){E++,t._logger.log("WS insertExisting.onComplete");var i=(UWA.is(n,"string")?JSON.parse(n):n).results;i.Success.forEach(function(e){R.Success.push(e)}),i.Failure.forEach(function(e){R.Failure.push(e)}),i.Success.length>0&&r.refreshOnInsert(i.Success,null,"insertExisting"),E===A.length&&e()},onFailure:function(n,o){E++,t._logger.log("WS insertExisting.onFailure");var a=s.getParseErrorMessage(n,o);i.errorAlert(a),r.endBlockingTransaction(),E===A.length&&e()},onTimeout:function(n){E++,t._logger.warn("WS insertExisting.onTimeout");var o=s.getParseErrorMessage(n);i.errorAlert(o),r.endBlockingTransaction(),E===A.length&&e()}})});d.allSettled(U).then(function(){if(v.dataArray.length>1)(R.Failure.length>0||R.Success.length>0)&&new u({title:"InsertExisting",reportData:R});else{if(R.Success.length>0){var e=R.Success[0],t=(UWA.is(e.type,"object")?e.type.displayName:e.type)+" "+e.name+" "+e.revision;s=(s=n.InsertExisting_Success_msg).replace("{TNR}",t),i.sucessAlert(s)}if(R.Failure.length>0){var s;e=R.Failure[0],t=(UWA.is(e.type,"object")?e.type.displayName:e.type)+" "+e.name+" "+e.revision;s=(s=n.InsertExisting_Failure_msg+" "+n.FailureReasons).replace("{TNR}",t),i.errorAlert(s)}}r.endBlockingTransaction()})}t._endExecute()}},chunk:function(e,t){var r,n,i=[],s=t;for(r=0,n=e.length;r<n;r+=s)i.push(e.slice(r,r+s));return i}});return p}),define("DS/TraceableRequirementsUtils/utils/ExpandManager",["UWA/Class","DS/TraceableRequirementsUtils/Services/RequirementWebServices","DS/TraceableRequirementsUtils/utils/RequirementAlertManager","DS/TraceableRequirementsUtils/Utils"],function(e,t,r,n){"use strict";return e.singleton({executeExpand:function(e){return new Promise((r,i)=>{t.expand({json:e,onComplete:function(e){r(n.parseResponse(e))},onFailure:function(e){i(e)},onTimeout:function(e){i(e)}})})}})}),define("DS/TraceableRequirementsUtils/utils/SearchManager",["UWA/Class","DS/TraceableRequirementsUtils/utils/ExpandManager","DS/TraceableRequirementsUtils/Utils","DS/RequirementStructureBrowser/treemodel/RequirementModelParser","DS/PADUtils/PADContext"],function(e,t,r,n,i){"use strict";return e.singleton({maxNoOfNodesToSearch:300,getMaxNoOfNodesToSearch:function(){return this.maxNoOfNodesToSearch},setMaxNoOfNodesToSearch:function(e){this.maxNoOfNodesToSearch=e},resetSearchProperties:function(){this.setMaxNoOfNodesToSearch(300),this.maxLimitOfSearchReached=null},resetLocalFilters:function(){let e=this;if(e.context){e.context.getPADTreeDocument().resetLocalFilters()}},searchExecute:async function(e,t){let r=this,n={matchedNodes:[],sortedNodes:[]};if(r.context=i.get(),r.resetSearchProperties(),r.resetLocalFilters(),e&&e.length){for(let i of e){if(r.maxLimitOfSearchReached)break;let e=r.prepareSearchPayload(i,t),s=await r.performSearch(e);this.handleSearchResponse(i,s,n)}return{searchResultsAll:n,maxLimitOfSearchReached:r.maxLimitOfSearchReached}}return new Error("No Object Found")},performSearch:function(e){return e.matching_lengths=1,e.format="entity_relation_occurrence",e.searchOptions.parameters={limit_max_path:this.maxNoOfNodesToSearch},this.executeExpand(e)},executeExpand:function(e){let r=t.executeExpand(e);return new Promise((e,t)=>{r.then(t=>{e(t)}).catch(e=>{t(e)})})},prepareSearchPayload:function(e,t){let r=this.context.getPADTreeDocument(),n=this.context.getSetting("expand").cv_expand_data.folder_expand,i=UWA.extend({type_filter:n.type_filter_bo,rel_filter:n.type_filter_rel});i.object_selects=this.context.columnManager.getDGVVisibleColumns(),i.select_relation=n.select_rel;let s=e.getID();return i.paths=[s],i.rootID=s,i.BIProxy=r.options.filterBI,i.attributesToSearch=this.context.columnManager.getAvailableAttributesForSearch(),i.searchOptions={searchString:t},i},handleSearchResponse:function(e,t,r){let i=this;try{let s=i.context.getPADTreeDocument(),o=n.process.addRemainingStructure({treedocument:s,BIProxy:s.options.filterBI,response:t.results,authored:!1,rootNodes:[e],expandLevel:-1});r.sortedNodes=r.sortedNodes.concat(o),t.matchedNode&&t.matchedNode.length&&("collapsed"==e.getState()&&e.setState({state:"partiallyExpanded"}),o.forEach(function(e){e.children.forEach(function(e){let t=s.getNodesById(e.physicalid)[0];s.changeStructureExpandedState(t,"partiallyExpanded",!1)})}),this.setMaxNoOfNodesToSearch(this.getMaxNoOfNodesToSearch()-t.matchedNode.length),r.matchedNodes=r.matchedNodes.concat(t.matchedNode)),this.getMaxNoOfNodesToSearch()<=0&&(this.maxLimitOfSearchReached=!0,this.setMaxNoOfNodesToSearch(0))}catch(e){console.error(e)}}})});