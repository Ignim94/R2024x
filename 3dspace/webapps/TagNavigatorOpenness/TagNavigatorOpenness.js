define("DS/TagNavigatorOpenness/views/utils/TaggerConfigUtils",["UWA/Core","UWA/Class/Promise","DS/SNInfraUX/TaggerConfigAccess"],function(e,t,i){"use strict";let n,s={},a=!1;return{retrieveAdminPredicateOperatorConfig:function(e){const n=window.location.search;console.log(n);const o=new URLSearchParams(n);let l;return o.get("editTagsPredicateOperators")&&(l=o.get("editTagsPredicateOperators")),new t(l?function(e){s=JSON.parse(l),a=!0,e()}:function(t){let n=i.get6WTagsRelationship({tenantID:e});n?n.then(function(e){s=e,a=!0,t()}.bind(this),function(){console.log("No operators set by Admin"),a=!0,t()}.bind(this)):(console.log("Error resolving promise"),a=!0,t())}.bind(this))},setPredicateOperators:function(e){s=e,a=!0},getDefaultPredicateOperator:function(e){let t=s,i=e.split("/").pop();if(t&&0!==Object.keys(t).length&&t[i]&&t[i].operator)return t[i].operator},getIrrelevantPredicateOperator:function(e,t){let i,n=s;if(t){for(let e of t)if(e=e.split("/").pop(),n&&0!==Object.keys(n).length&&n[e]&&n[e].irrelevantOperator)return n[e].irrelevantOperator}else i=e.split("/").pop();if(n&&0!==Object.keys(n).length&&n[i]&&n[i].irrelevantOperator)return n[i].irrelevantOperator},getOperatorLoadedStatus:function(){return a},canSaveTags:function(e,s){return n||(n=new t(function(t){e.getOption("allowSavedTags")?t(!0):UWA.is(i.canSaveTags,"function")&&s&&s.platformID?i.canSaveTags(s).then(function(e){t(e)},function(){t(!1)}):t(!1)})),n}}}),define("DS/TagNavigatorOpenness/views/EmptyView",["UWA/Core","UWA/Class/View"],function(e,t){"use strict";return t.extend({tagName:"div",className:"no-tags",render:function(){return this},setMessageText:function(e){this.container.empty(),this.container.setText(e)},isVisible:function(){return!this.container.isHidden()},destroy:function(){this._parent()}})}),define("DS/TagNavigatorOpenness/views/model/ActiveTagsModel",["UWA/Core","UWA/Class/Model","UWA/Class/Debug"],function(e,t,i){"use strict";return t.extend(i,{defaults:{mode:"readOnly"},setup:function(e){this._parent(e)}})}),define("DS/TagNavigatorOpenness/ParentModule",[],function(){"use strict";return{getParentModule:function(){var e={};return function(t,i){if(e[t])e[t]&&i(e[t]);else if(console.log("TagNavigatorProxyPrivate#getParentModule - trying to load the module"),function(){var e;try{top.document,e=!0}catch(t){e=!1}return e}())try{console.log("isParentAccessible: true, require from top window"),top.require([t],function(n){console.log("require from top window SUCCEEDED"),e[t]=n,i(n)})}catch(n){try{console.log("require from top window FAILED - retry on parent of current window.");let n=require;window.parent!=top?(n=window.parent.require,console.log("using require from parent of current window")):console.log("using require from current window"),n([t],function(n){console.log("require SUCCEEDED"),e[t]=n,i(n)})}catch(e){console.log("require from parent of current window FAILED !!, no further attempt"),i(null)}}}}()}}),define("DS/TagNavigatorOpenness/views/TagFilterModel",["UWA/Core","UWA/Class/Model","UWA/Class/Debug"],function(e,t,i){"use strict";return t.extend(i,{defaults:{},setup:function(){this._parent()}})}),define("DS/TagNavigatorOpenness/TagNavigatorOpennessNLS",["i18n!DS/TagNavigatorOpenness/assets/nls/TagNavigatorOpenness"],function(e){"use strict";var t={getText:function(t){return e[t]?e[t].escapeHTML().replace(/'/g,"&#39;").replace(/&#x2F;/g,"/"):t}};return t}),define("DS/TagNavigatorOpenness/views/utils/ActiveTagsUtils",["UWA/Core","UWA/Class","DS/TagNavigatorOpenness/views/utils/TaggerConfigUtils","DS/TagNavigatorOpenness/ParentModule"],function(e,t,i,n){"use strict";let s,a,o,l,r,d=t.singleton({SECTION_FILTERS:"section-filters",SECTION_ADDITIONAL_FILTERS:"section-additionalFilters",EMBEDDED_FILTER:"##embeddedFilter##",init:function(){s={},a={},o={},l={},r={filters:{},hasLocal:!1,hasOnlyLocal:!1},this.EMBEDDED_FILTER_PREDICATE="ds6w:what/"+this.EMBEDDED_FILTER},isAdvancedFilter:function(e){if(e){if((e.isSimplified?e.isSimplified.version:0)>=2){let t=e.condition?e.condition:[];if(Array.isArray(t))return t.length>0}}},segregateFilters:function(e,t){s={},a={},o={},l={},r.filters={};let i=e.allfilters,n=e.localfilters||{},c=n?Object.keys(n).length:0,h=Object.keys(i).length,p=!(!e.filterProperties||!Object.keys(e.filterProperties).length)&&e.filterProperties,g=e.embeddedfilter,u=function(){if(h)for(const e of i){let t=Object.keys(e)[0],i=e[t].condition?e[t].condition:e[t];if(i.length)if(c)for(const t of n){let i=Object.keys(e)[0],n=Object.keys(t)[0];if(i===n){let n=e[i].condition?e[i].condition:e[i],r=t[i].condition?t[i].condition:t[i];if(n.length)for(let e=0;e<n.length;e++){let t=n[e],d=0;r.length&&(d=r.findIndex((e,n)=>(e.hasOwnProperty("excluded")&&e.excluded?(l[i]||(l[i]=[]),l[i].push(e)):(a[i]||(a[i]=[]),a[i].push(e)),UWA.is(e.object,"string")?e.object===t.object:JSON.stringify(e)===JSON.stringify(t)))),-1==d&&(s[i]||(s[i]=[]),t.hasOwnProperty("excluded")&&t.excluded?(o[i]||(o[i]=[]),o[i].push(t)):s[i].push(t))}}}else s[t]||(s[t]=[]),i.forEach(e=>{e.hasOwnProperty("excluded")&&e.excluded?(o[t]||(o[t]=[]),o[t].push(e)):s[t].push(e)})}}.bind(this),f=function(e){for(const[t,i]of Object.entries(e)){let n={};i.forEach((e,t)=>{let i=e.disptext||e.displayValue;0===t?n[i]=e:n.hasOwnProperty(i)?n[i].object!==e.object?(n[i].isComposite=!0,Array.isArray(n[i].object)||(n[e.disptext].object=[n[i].object]),n[i].object.push(e.object)):n[i].duplicate=!0:n[i]=e}),e[t]=[];for(let i in n)n[i].duplicate?(e[t].push(n[i]),e[t].push(n[i])):e[t].push(n[i])}};if(e.localfilters&&e.localfilters.isSimplified&&!e.allfilters.hasOwnProperty("isSimplified")){if(h){f(i);for(const[e,t]of Object.entries(i))if(t.length)for(let i=0;i<t.length;i++){let n=t[i];if(s[e]||(s[e]=[]),p){if(p[e][i].pin&&(n.pin=!0),"date"===n.type&&n.parent){let t=p[e][i].parent.pin;if(t&&(n.parent.pin=t),n.parent.parent){let t=p[e][i].parent.parent.pin;t&&(n.parent.parent.pin=t)}}}n.hasOwnProperty("excluded")&&n.excluded||p&&p[e]&&p[e][i].excluded?(o[e]||(o[e]=[]),n.hasOwnProperty("excluded")||(n.excluded=!0),o[e].push(n)):s[e].push(n)}}if(c){if(n=e.localfilters.condition||{},c=n?n.length:0,t){if(c){let e=-1;for(let t=0;t<c;t++){let t;e++,t=n.length>1?n[e]:n[0];let i=Object.keys(t)[0],s=t[i].condition?t[i].condition:t[i];if(s.length){let a=[],o=t[i].isComplex;s.forEach((e,t)=>{e&&(o&&(e.isComplex=o),e.hasOwnProperty("excluded")&&e.excluded&&(l[i]||(l[i]=[]),l[i].push(e),a.push(t)))}),(a=a.reverse()).forEach(t=>{s.splice(t,1),0===s.length&&n.splice(e,1)})}}}}else if(c){let e=-1;for(let t=0;t<c;t++){let t;e++,t=n.length>1?n[e]:n[0];let i=Object.keys(t)[0],s=t[i].condition?t[i].condition:t[i];if(s.length){let a=t[i].isComplex,o=[];s.forEach((e,t)=>{e&&(a&&(e.isComplex=a),e.hasOwnProperty("excluded")&&e.excluded&&(l[i]||(l[i]=[]),l[i].push(e),o.push(t)))}),(o=o.reverse()).forEach(t=>{s.splice(t,1),0===s.length&&n.splice(e,1)})}}}a=n}}else if(e.allfilters.isSimplified&&e.localfilters.isSimplified)u();else if(c&&f(n),h&&(f(i),p&&f(p)),e.isTagger){if(c)for(const[e,t]of Object.entries(n))for(let i=0;i<t.length;i++){let n=t[i];t.length&&(n.hasOwnProperty("excluded")&&n.excluded?(l[e]||(l[e]=[]),l[e].push(n)):(a[e]||(a[e]=[]),a[e].push(n)))}if(h)for(const[e,t]of Object.entries(i))for(let i=0;i<t.length;i++){let n=t[i];if(t.length){if(p){if(p[e][i].pin&&(n.pin=!0),"date"===n.type&&n.parent){let t=p[e][i].parent.pin;if(t&&(n.parent.pin=t),n.parent.parent){let t=p[e][i].parent.parent.pin;t&&(n.parent.parent.pin=t)}}}n.hasOwnProperty("excluded")&&n.excluded||p&&p[e]&&p[e][i].excluded?(o[e]||(o[e]=[]),n.hasOwnProperty("excluded")||(n.excluded=!0),o[e].push(n)):(s[e]||(s[e]=[]),s[e].push(n))}}}else{if(h)for(const[e,t]of Object.entries(i))if(t.length)for(let i=0;i<t.length;i++){let a=t[i],l=n[e];if(p){if(p[e][i].pin&&(a.pin=!0),"date"===a.type&&a.parent){let t=p[e][i].parent.pin;if(t&&(a.parent.pin=t),a.parent.parent){let t=p[e][i].parent.parent.pin;t&&(a.parent.parent.pin=t)}}}let r=-1;if(l&&l.length&&(r=l.findIndex((e,t)=>UWA.is(e.object,"string")&&UWA.is(a.object,"string")?e.object===a.object:JSON.stringify(e.object)===JSON.stringify(a.object))),t.filter((e,t)=>UWA.is(e.object,"string")&&UWA.is(a.object,"string")?e.object===a.object:JSON.stringify(e.object)===JSON.stringify(a.object)).length>1&&(r=-1),-1==r)if(a.hasOwnProperty("excluded")&&a.excluded||p&&p[e]&&p[e][i].excluded){o[e]||(o[e]=[]);let t=o[e].findIndex((e,t)=>UWA.is(e.object,"string")&&UWA.is(a.object,"string")?e.object===a.object:JSON.stringify(e.object)===JSON.stringify(a.object));a.hasOwnProperty("excluded")||(a.excluded=!0),-1==t&&o[e].push(a)}else{s[e]||(s[e]=[]),-1==s[e].findIndex((e,t)=>UWA.is(e.object,"string")&&UWA.is(a.object,"string")?e.object===a.object:JSON.stringify(e.object)===JSON.stringify(a.object))&&s[e].push(a)}}if(c)for(const[e,t]of Object.entries(n))for(let i=0;i<t.length;i++){let n=t[i];t.length&&(n.hasOwnProperty("excluded")&&n.excluded?(l[e]||(l[e]=[]),l[e].push(n)):(a[e]||(a[e]=[]),a[e].push(n)))}}if(Object.keys(a).length&&(r.filters.localFilters=a),Object.keys(l).length&&(r.filters.localExclude=l),Object.keys(s).length&&(r.filters.globalFilters=s),Object.keys(o).length&&(r.filters.globalExclude=o),g&&g.filter&&Object.keys(g.filter).length>0){let e=d.isAdvancedFilter(g.filter),t=function(t){if(e){let e={};e[d.EMBEDDED_FILTER_PREDICATE]={operator:"OR",condition:[{type:"string",object:d.EMBEDDED_FILTER,operator:"OR",value:[d.EMBEDDED_FILTER],display:g.label,predicates:[{predicate:d.EMBEDDED_FILTER_PREDICATE,type:"string"}],tooltip:g.description}]},t.push(e)}else t[d.EMBEDDED_FILTER_PREDICATE]=[{disptext:g.label,object:d.EMBEDDED_FILTER,type:"string",isEmbedded:!0,tooltip:g.description}]};g.isLocal?(e?(!a||Array.isArray(a)&&0==a.length)&&(a=r.filters.localFilters=[]):(!a||UWA.is(a,"object")&&0==Object.keys(a).length)&&(a=r.filters.localFilters={}),t(a)):((!s||UWA.is(s,"object")&&0==Object.keys(s).length)&&(s=r.filters.globalFilters={}),t(s))}return Object.keys(s).length||Object.keys(o).length||!Object.keys(a).length&&!Object.keys(l).length?r.hasOnlyLocal=!1:r.hasOnlyLocal=!0,Object.keys(a).length||Object.keys(l).length?r.hasLocal=!0:r.hasLocal=!1,r},getUpdatedGrouping:function(e,t){let i=function(t){for(let i=0;i<t.length;i++)if(e.predicate===t[i].predicate){if(e.predLevel){t.splice(i,1);break}{let n=0,s=t[i].object;for(let t=0;t<s.length;t++)if(e.object[0].dispText===s[t].dispText){s.splice(t,1),n=1;break}if(0==s.length&&t.splice(i,1),n)break}}};return t.localGroupings.length?(i(t.localGroupings),t.localGroupings):t.allGroupings.length?(i(t.allGroupings),t.allGroupings):void 0},getGroupedInfo:function(e){let t={predicate:e.predicate};return e.predLevel?(t.isPredicate=!0,t.text=e.predDispName):t.text=e.object[0].dispText,t},getTagInfo:function(e){if(e.display)return{predicate:e.id,dispValue:e.display,object:e.object,type:e.type};let t={predicate:e.id?e.id:e.pred,dispValue:e.condition.displayValue?e.condition.displayValue:e.condition.disptext?e.condition.disptext:e.condition.display?e.condition.display:e.condition.object,object:e.condition.object,type:e.condition.type,excluded:e.hasOwnProperty("excluded")?e.excluded:e.condition.excluded};return e.condition.isEmbedded&&(t.isEmbedded=!0),e.event&&(t.event=e.event),(e.hasOwnProperty("isComplex")||e.condition.hasOwnProperty("isComplex"))&&(t.isComplex=e.hasOwnProperty("isComplex")?e.isComplex:e.condition.isComplex),(e.hasOwnProperty("isComposite")||e.condition.hasOwnProperty("isComposite"))&&(t.isComposite=e.hasOwnProperty("isComposite")?e.isComposite:e.condition.isComposite),(e.hasOwnProperty("isSimplifiedCriteria")||e.condition.hasOwnProperty("isSimplifiedCriteria"))&&(t.object.isSimplifiedCriteria=e.hasOwnProperty("isSimplifiedCriteria")||e.condition.hasOwnProperty("isSimplifiedCriteria")),t},hasOverloadedOperator:function(e){let t=!1;return Array.isArray(e)&&e.length&&e.forEach((e,i)=>{Object.keys(e).forEach(i=>{if("object"==typeof e[i]){let n=UWA.clone(e[i]);n.id=i,this.operatorIsOverloaded(n)&&(t=!0)}})}),t},operatorIsOverloaded:function(e){return!!function(e){let t=function(e){let t=e.predicates;for(let e=0;e<t.length;e++){let n=i.getDefaultPredicateOperator(t[e].predicate);if(n)return n}return null},n=e.id?e.id:e.predicate,s=i.getDefaultPredicateOperator(n);if(s)return s;if(e.isComplex&&!s)if(Array.isArray(e.condition)){let i=e.condition;for(let e=0;e<i.length;e++){let n=t(i[e]);if(n)return n}}else if("object"==typeof e.condition)return t(e.condition)}(e)||!(!(t=e).operator||"OR"==t.operator);var t},getPredicateDisplayName:function(e){return new Promise(function(e){n.getParentModule("DS/TagNavigator/Predicate",function(t){e(t)})})}});return d}),define("DS/TagNavigatorOpenness/views/TagView",["UWA/Core","UWA/Class/View","DS/UIKIT/Tooltip","DS/Handlebars/Handlebars","text!DS/TagNavigatorOpenness/assets/templates/ActiveTagView.html","DS/UIKIT/DropdownMenu","DS/TagNavigatorOpenness/TagNavigatorOpennessNLS"],function(e,t,i,n,s,a,o){"use strict";return t.extend({tagName:"li",className:"tag selected",template:n.compile(s),domEvents:{click:"retrieveTag"},setup:function(e){e.id&&this.container.setAttribute("id",e.id),this._parent(e)},render:function(){var t=this.template();this.container.setContent(t);this.getOption("isSimplified");var n=this.getOption("text"),s=this.getOption("icon"),a=this.getOption("isExcluded"),o=this.getOption("isPinned"),l=this.getOption("isGrouped"),r=this.getOption("hasActions")||o,d=this.getOption("disabled"),c=this.getOption("onePerLine"),h=this.getOption("attribute"),p=this.getOption("hasExcludeSupport"),g=this.getOption("canBeDeleted"),u=this.getOption("canBePinned");if(this.renderTo=this.getOption("renderTo"),r&&this.container.addClassName("tag-with-actions"),d&&this.container.addClassName("disable"),o&&this.container.addClassName("pinned"),l&&this.container.addClassName("grouped"),p&&!a&&this.container.addClassName("canBeExcluded"),u&&this.container.addClassName("canBePinned"),c&&this.container.setStyles({display:"flex",margin:"0px 0 10px 0"}),h&&h.length>0){var f=this;h.forEach(function(e){f.container.setAttributes(e)})}s&&this.container.getElement(".icon").addClassName("wux-ui-3ds-"+s);let m=this.container.getElement(".tag-label");this.container.getElement(".title").setText(n),s||m.setStyles({"padding-left":"5px"}),this.updateExclude(a);let b=this.container.getElement(".tag-elem");return o&&e.createElement("span",{class:"wux-ui-3ds wux-ui-3ds-pin pinned"}).inject(b.getElement(".tag-label")),g&&(r||p?e.createElement("span",{class:"tag-dropdown wux-ui-3ds-chevron-down wux-ui-3ds"}).inject(b):e.createElement("span",{class:"tag-del wux-ui-3ds-wrong wux-ui-3ds"}).inject(b)),this.container.setAttribute("tagName",n),this.tooltip=new i({position:"bottom",target:this.container.getElement(".tag-label"),className:"tagger-filter-tooltip"}).getBody().setText(this.getOption("tooltip")||n),this},updateExclude:function(t){t?(t&&this.container.addClassName("isExcluded"),e.createElement("span",{class:"wux-ui-3ds wux-ui-3ds-block excluded"}).inject(this.getElement(".tag-label"))):(this.container.hasClassName("isExcluded")&&this.container.removeClassName("isExcluded"),this.container.getElement(".excluded")&&this.container.getElement(".excluded").destroy())},retrieveTag:function(e){if(this.getOption("isGrouped")){let e=this.getOption("condition");return void this.dispatchEvent("clickedOnTag",e)}if(e.target.getClosest(".tag-with-actions")instanceof HTMLElement||e.target.getClosest(".canBeExcluded")instanceof HTMLElement||e.target.getClosest(".isExcluded")instanceof HTMLElement)return void this.clickOnTagActions(e);e.preventDefault();let t={};this.getOption("condition")?(t.condition=this.getOption("condition"),t.pred=this.getOption("pred")):t.displayValue=this.container.getElement(".title").getText(),this.dispatchEvent("clickedOnTag",t),this.destroy()},clickOnTagActions:function(e){let t=this;this.dropdownMenu&&this.dropdownMenu.destroy();let i=this.container,n=-1!==this.container.className.indexOf("isExcluded"),s=-1!==this.container.className.indexOf("canBeExcluded"),l=-1!==this.container.className.indexOf("pinned"),r=-1!==this.container.className.indexOf("canBePinned"),d=[{text:o.getText("removeTag"),name:"remove",fonticon:"trash"}];r&&(l?d.unshift({text:o.getText("unPinTag"),name:"unpin",fonticon:"pin-off"}):d.unshift({text:o.getText("pinTag"),name:"pin",fonticon:"pin"})),n?d.unshift({text:o.getText("unexludeTag"),name:"unexclude",fonticon:"block"}):s&&d.unshift({text:o.getText("excludeTag"),name:"exclude",fonticon:"block"});let c=a.extend({getDisplayContext:function(){let e={},t=document.documentElement;return e.viewportWidth=t.clientWidth||window.innerWidth,e.viewportHeight=t.clientHeight||window.innerHeight,e.scrollTop=window.pageYOffset||document.body.scrollTop||t.scrollTop,e}});this.dropdownMenu=new c({target:i,items:d,events:{onClick:function(e,i){let n={};"remove"===i.name?(t.getOption("condition")?(n.condition=t.getOption("condition"),n.pred=t.getOption("pred")):n.displayValue=t.container.getElement(".title").getText(),t.dispatchEvent("clickedOnTag",n),t.destroy()):"exclude"===i.name?(t.getOption("condition")&&(n.condition=t.getOption("condition"),n.pred=t.getOption("pred"),n.condition.excluded=!0),t.dispatchEvent("clickedOnTag",n)):"unexclude"===i.name?(t.getOption("condition")&&(n.condition=t.getOption("condition"),n.pred=t.getOption("pred"),n.condition.excluded=!1),t.dispatchEvent("clickedOnTag",n)):"pin"===i.name?(t.getOption("condition")&&(n.condition=t.getOption("condition"),n.pred=t.getOption("pred"),n.event="pinTag"),t.dispatchEvent("clickedOnTag",n)):"unpin"===i.name&&(t.getOption("condition")&&(n.condition=t.getOption("condition"),n.pred=t.getOption("pred"),n.event="unpinTag"),t.dispatchEvent("clickedOnTag",n))},onHide:function(){},onShow:function(){t.tooltip&&t.tooltip.elements&&t.tooltip.destroy()}}}),this.dropdownMenu.show(),e&&(e.preventDefault(),e.stopPropagation())},destroy:function(){this._parent()}})}),define("DS/TagNavigatorOpenness/views/utils/PredicateUtils",["UWA/Core","DS/TagNavigatorOpenness/ParentModule"],function(e,t){"use strict";var i={};return{getActualPredicates:function(e){let t=new Set;return e.isComplex&&e.condition.forEach(e=>{e.predicates.forEach(e=>{t.add(e.predicate)})}),t},computeReqObj:function(e){return e.display=e.displayValue,e},checkNewfilter:function(e,t,i){let n=this,s=[],a=[];return t?(UWA.is(e,"array")?e.forEach(e=>{var o=!1;switch(e.type){case"boolean":case"string":var l={value:e.object,nls:e.displayValue||e.nls||e.object},r=-1;t.length>0&&(r=t.findIndex(function(e){return e.object===l.value}));let d=n.computeReqObj(e);i&&!d.excluded&&(-1===r?s.push({condition:d}):a.push({condition:d}));break;default:t.length>0&&t.forEach(function(t){t.object.from===e.object.from&&t.object.to===e.object.to&&(o=!0)});let c=n.computeReqObj(e);i&&!c.excluded&&(o?a.push({condition:c}):s.push({condition:c}))}}):UWA.is(e,"object")&&e.condition.forEach(e=>{let n,o=e.isComplex;var l=function(t,i){let n=e.condition?e.condition.object:e.object;return i?n.length==t.object.length&&n.object.every(function(e){return-1!==t.object.indexOf(e)}):n.length<=t.object.length?n.every(function(e){return-1!==t.object.indexOf(e)}):t.object.every(function(e){return-1!==n.indexOf(e)})};n=t.condition.findIndex(function(t){if(o){if(e.isComposite)return l(t);{let i=e.condition?e.condition.object:e.object;return UWA.is(i,"array")&&UWA.is(t.object,"array")?l(t,!0):JSON.stringify(i)===JSON.stringify(t.object)}}return e.isComposite?l(t):UWA.is(e.object,"array")&&UWA.is(t.object,"array")?JSON.stringify(e.object)===JSON.stringify(t.object):e.object===t.object}),i&&!e.excluded&&(-1==n?s.push({condition:e}):a.push({condition:e}))}),{newAddedFilters:s,oldFilters:a}):(a=this.getTags(e,i),{newAddedFilters:s,oldFilters:a})},getTags:function(e,t,i){let n=[];return UWA.is(e,"array")?e.forEach((e,s)=>{let a=this.computeReqObj(e);i?a.excluded&&n.push({condition:a}):t&&a.excluded||n.push({condition:a})}):"object"==typeof e&&e.condition&&e.condition.forEach((e,s)=>{i?e.excluded&&n.push({condition:e}):t&&e.excluded||n.push({condition:e})}),n},getPredicateDisplayName:function(e,n){return new Promise(function(s){i[e]?s(i[e]):t.getParentModule("DS/TagNavigator/Predicate",function(t){n||(n="string");let a=new t({sixw:e,type:n});i[e]=a.displayName(),s(i[e])})})}}}),define("DS/TagNavigatorOpenness/views/ActiveFilterView",["UWA/Core","UWA/Class/View","DS/Handlebars/Handlebars","text!DS/TagNavigatorOpenness/assets/templates/SectionView.html","DS/Controls/Expander","DS/Controls/Button","DS/Controls/TooltipModel","DS/TagNavigatorOpenness/TagNavigatorOpennessNLS","DS/TagNavigatorOpenness/views/TagView"],function(e,t,i,n,s,a,o,l,r){"use strict";return t.extend({tagName:"div",className:"tno-act-crit-section",template:i.compile(n),setup:function(e){this._parent(e)},init:function(e){this._parent(e)},render:function(){let t=this;var i=this.template();this.container.setContent(i);let n=this.getOption("data");this.container.setAttribute("id",n.id);let d,c=null==n.isDisabled||n.isDisabled,h=n.canBeCollapsed||!1,p=null==n.canBeDeleted||n.canBeDeleted,g=[];this.additionalFilters={},this.container.hide();let u=function(){this.additionalFilters={filter:[]},g.forEach(e=>{e.destroy()}),g=[],this.dispatchEvent("addCriteriaChange",this.additionalFilters),this.container.hide()}.bind(this);(function(){let e,i;if(p&&(e=new a({displayStyle:"lite",label:"lite displayStyle",icon:{iconName:"trash",fontIconFamily:WUXManagedFontIcons.Font3DS},domId:"clearAllFilters",showLabelFlag:!1,touchMode:!0,tooltipInfos:new o({title:l.getText("clearAllFilters"),mouseRelativePosition:!1,position:"bottom"})})).addEventListener("buttonclick",u.bind(this)),n.icon&&(d=n.icon),h)i=new s({header:n.title,icon:{iconName:d&&d.fonticon?d.fonticon:"",fontIconFamily:WUXManagedFontIcons.Font3DS},customHeader:p?e:"",style:"simple",touchMode:!0}).inject(t.container);else{let t=n.title?n.title:l.getText("activeFilters");if(this.getElement(".tno-section-title").setText(t),n.icon){let e=n.icon;e.hasOwnProperty("fonticon")?this.getElement(".tno-section-header span").addClassName("wux-ui-3ds-"+e.fonticon):e.hasOwnProperty("image")&&this.getElement(".tno-section-header img").setAttribute("src",e.image)}p&&(e.inject(this.getElement(".tno-section-header .tno-section-clear-all")),this.getElement(".tno-section-header .tno-section-clear-all").removeClassName("hide")),this.getElement(".tno-section-header").removeClassName("hide")}}).bind(this)();let f=function(){g&&g.length&&g.forEach(e=>{e.destroy()}),h?expander.body="":this.container.getElement(".tno-section-content").empty()}.bind(this);return this.updateAdditionalCriteria=function(t){this.additionalFilters=t,f();let i=e.createElement("ul",{class:"active-tags-list"}).inject(h?this.container.getElement(".wux-controls-expander-body"):this.container.getElement(".tno-section-content"));if(!Array.isArray(this.additionalFilters)||!this.additionalFilters.length)return this.container.hide(),void(g=[]);this.container.show(),this.additionalFilters.forEach((e,t)=>{let n=new r({text:e.displayValue,icon:e.icon,canBeDeleted:p}).render().inject(i);g.push(n),n.addEvent("clickedOnTag",function(e){let t=this.additionalFilters.findIndex(t=>t.displayValue==e.displayValue);this.additionalFilters.splice(t,1),this.additionalFilters.length||(this.container.hide(),g=[]);let i={filter:this.additionalFilters};this.dispatchEvent("addCriteriaChange",i)}.bind(this))})},this.setAdditionalFilterProperties=function(e){if(e.hasOwnProperty("title")&&(this.getElement(".tno-section-title").setText(e.title),this.getElement(".tno-section-header").removeClassName("hide")),e.hasOwnProperty("icon")){let t=e.icon;t.hasOwnProperty("fonticon")?this.getElement(".tno-section-header span").addClassName("wux-ui-3ds-"+t.fonticon):t.hasOwnProperty("image")&&this.getElement(".tno-section-header img").setAttribute("src",t.image)}e.hasOwnProperty("isDisabled")&&(c=e.isDisabled,this.container.toggleClassName("disabled",c)),e.hasOwnProperty("canBeDeleted")&&(p=e.canBeDeleted,expander?exapnder.customHeader=p?clearAllBtn:"":this.getElement(".tno-section-header .tno-section-clear-all").toggleClassName("hide",!p))},this.updateFilterViewOnFocusChange=function(e){e.isFocused?this.additionalFilters.length&&this.container.show():this.container.hide()},this},destroy:function(){this._parent()}})}),define("DS/TagNavigatorOpenness/views/PredicateView",["UWA/Core","UWA/Class/View","DS/TagNavigatorOpenness/TagNavigatorOpennessNLS","DS/UIKIT/Input/Select","DS/TagNavigatorOpenness/views/TagView","DS/TagNavigatorOpenness/views/utils/PredicateUtils","DS/TagNavigatorOpenness/views/utils/TaggerConfigUtils","DS/TagNavigatorOpenness/views/utils/ActiveTagsUtils"],function(e,t,i,n,s,a,o,l){"use strict";return t.extend({tagName:"div",className:"predicate-tags tag-list-cont",setup:function(e){this._parent(e)},render:function(){let t=this;this.predicateInfo=this.getOption("predicateInfo"),this.mode=this.getOption("mode"),this.toShowHeader=this.getOption("toShowHeader"),this.predicate=Object.keys(this.predicateInfo)[0],this.predicate===l.EMBEDDED_FILTER_PREDICATE&&(this.toShowHeader=!1,this.isEmbeddedPredicate=!0),this.filter=this.predicateInfo[this.predicate],this.exclude=this.getOption("exclude"),this.canbeDeleted=this.getOption("canBeDeleted"),this.activeTags=0,this.activeTagView={},this.advancedPredOptions=this.getOption("advancedPredOptions");let s,r=["OR","AND","XOR"];this.predId=this.predicate.split("/").pop(),Array.isArray(this.predicateInfo[this.predicate])?s=this.predicateInfo[this.predicate][0].type:this.predicateInfo[this.predicate].condition.length&&(s=this.predicateInfo[this.predicate].condition[0].type);let d=this._getPredicateIcon(this.predicate),c=this.predId;this.tagsListCont=e.createElement("div",{class:"active-tags-list-container",styles:{display:"block"}}).inject(this.container),this.predicateLabelCont=e.createElement("div",{class:"predicate-label-cont "+t.mode}).inject(this.tagsListCont).hide(),e.createElement("span",{class:"w-icon fonticon fonticon-"+d}).inject(this.predicateLabelCont);let h=this.predicate.contains("sixw:")?this.predicate.replace("sixw:",""):this.predicate;a.getPredicateDisplayName(h,s).then(function(i){t.predDispName=i,e.createElement("div",{class:"object-predicate-label",text:i}).inject(t.predicateLabelCont)}),this.predContainer=e.createElement("div",{class:"predicate-container "+t.mode}).inject(this.tagsListCont),this.predContainer.setAttributes({predicate:c}),this.predicateTagsList=e.createElement("ul",{class:"active-predicate-list "});let p,g,u=this.getPredicateOperator(),f=[];if(this.advancedPredOptions.toShowXOR){p=u||"OR",this.predicateInfo[this.predicate].isComplex&&(g=a.getActualPredicates(this.predicateInfo[this.predicate]));let t=o.getIrrelevantPredicateOperator(this.predicate,g);r.forEach(n=>{(t&&t.length&&!t.includes(n)||!t)&&f.push({value:i.getText("local_"+n),selected:!!e.equals(p,n)})})}else{p=u?"XOR"===u?"OR":u:"OR";let t=o.getIrrelevantPredicateOperator(this.predicate);r.forEach(n=>{(t&&t.length&&!t.includes(n)||!t)&&f.push({value:i.getText("local_"+n),selected:!!e.equals(p,n)})})}return e.is(p)&&!this.predicate.contains("sixw:")&&(this.select=new n({className:"combo-operator hide",showTooltips:!0,placeholder:!1,options:f,predicate:t.predicate,events:{onChange:function(){let e=this.getValue()[0],n=o.getDefaultPredicateOperator(t.predId);switch(e){case i.getText("local_OR"):e="OR";break;case i.getText("local_AND"):e="AND";break;case i.getText("local_XOR"):e="XOR"}t.changeLocalOperator({predicate:t.predicate,operator:e,informView:n!==e}),t.updateLocalOperatorText(e)}}}).inject(this.predContainer)),this.predicateTagsList.inject(this.predContainer),this.updatePredicateView(),this},updatePredicateView:function(e){this.mode=e?e.mode:this.mode,e&&e.predicateInfo&&(this.old_filter=UWA.clone(this.filter),this.filter=e.predicateInfo[this.predicate]),this.toShowHeader=e?e.toShowHeader:this.toShowHeader,this.toShowHeader||"writeable"==this.mode?this.predicateLabelCont.show():this.predicateLabelCont.hide(),this.predContainer.getElement(".combo-operator")&&this.predContainer.getElement(".combo-operator").toggleClassName("hide","readOnly"==this.mode),this.createTagView()},getPredicateOperator:function(){return"object"==typeof this.filter&&(this.filter&&this.filter.operator)},updateLocalOperatorText:function(t){"XOR"!=t?this.container.getElement(".operator-text-xor")&&this.container.getElement(".operator-text-xor").destroy():e.createElement("span",{class:"tag-label operator-text-xor",text:i.getText("only")}).inject(this.predicateTagsList,"top");let n=this.container.getElements(".operator-text");n.length&&n.forEach(e=>{e.setText(i.getText(t))}),this.filter.operator=t},createTagView:function(){let t,n=this;this.old_filter||this.destroyAllActiveTagViews();let s=this.filter,o=this.old_filter;if((t=a.checkNewfilter(s,o,!0)).newAddedFilters.length||t.oldFilters.length?!t.newAddedFilters.length&&t.oldFilters.length?(this.destroyAllActiveTagViews(),t=t.oldFilters):t=t.newAddedFilters:this.destroyAllActiveTagViews(),Array.isArray(t)&&t.length){this.show();let s=["string","boolean"];t.forEach((t,a)=>{let o;t.condition.display?o=t.condition.display:-1==s.indexOf(t.condition.type)&&(o=t.condition.display?t.condition.display:this._computeDateNls(UWA.clone(t.condition.object)),t.condition.isSimplifiedCriteria=!0);let l={};this.predicateInfo[this.predicate].isComplex?(l={condition:t.condition,id:this.predicate,tagName:o,isComplex:!0}).condition.display=o:((l=t.condition).id=this.predicate,l.tagName=o,l.display=o);let r=n._getActiveTagsOption(l),d=n._createActiveTagView(r);this.activeTags++,"XOR"==n.getPredicateOperator()&&1==n.activeTags?e.createElement("span",{class:"tag-label operator-text-xor",text:i.getText("only")}).inject(n.predicateTagsList):(n.toShowHeader||"writeable"==n.mode)&&n.getPredicateOperator()&&n.activeTags>1&&e.createElement("span",{class:"tag-label operator-text",text:i.getText(n.getPredicateOperator())}).inject(n.predicateTagsList),d.container.inject(n.predicateTagsList),this.activeTagView[r.attribute[0].unique_id]=d})}if(this.select){let e=this.activeTags>1&&"writeable"==this.mode;this.select.elements.container.toggleClassName("hide",!e)}},_createActiveTagView:function(e){this.predDispName&&(e.predDispName=this.predDispName);let t=new s(e).render();return t.addEvent("clickedOnTag",this.dispatchRemoveEvent.bind(this)),t},dispatchRemoveEvent:function(e){let t=e.condition;this.destroyActiveTagView(t),"writeable"==this.mode&&this.updateView(),this.dispatchEvent("removeTag",t)},updateView:function(){1==this.activeTags?this.select&&!this.select.elements.container.isHidden()&&this.select.elements.container.toggleClassName("hide",!0):this.select&&this.select.elements.container.isHidden()&&this.select.elements.container.toggleClassName("hide",!1)},dispatchExcludeEvent:function(e){let t=e.option;if("writeable"==this.mode){(e.option.condition?e.option.condition.excluded:e.option.excluded)&&this.destroyActiveTagView(e.option)}this.dispatchEvent("excludeTag",t)},addTag:function(t){let n=this._getActiveTagsOption(t),s=this._createActiveTagView(n);this.activeTags++,this.updateView(),"XOR"==this.getPredicateOperator()&&1==this.activeTags?e.createElement("span",{class:"tag-label operator-text-xor",text:i.getText("only")}).inject(this.predicateTagsList):this.getPredicateOperator()&&this.activeTags>1&&e.createElement("span",{class:"tag-label operator-text",text:i.getText(this.getPredicateOperator())}).inject(this.predicateTagsList),s.container.inject(this.predicateTagsList),this.activeTagView[n.attribute[0].unique_id]=s,this.show()},_getActiveTagsOption:function(e){let t;e.condition?((t=UWA.clone(e.condition)).id=e.id,t.tagName=e.tagName):t=UWA.clone(e);let i="";"string"==typeof t.object?i=t.object.replaceAll(" ","_")+"_"+this.predicate:Array.isArray(t.object)&&(i=t.object.join("_")+"_"+this.predicate);let n={text:t.tagName,isSimplified:!0,hasExcludeSupport:this.exclude,isExcluded:t.excluded,canBeDeleted:this.canbeDeleted,condition:e,attribute:[{"predicate-name":this.predId,unique_id:i}],advancedProxy:!0,renderTo:!0};return this.isEmbeddedPredicate&&(n.icon="tag-pencil",n.hasExcludeSupport=!1,n.hasActions=!1,n.canBePinned=!1,n.tooltip=e.tooltip),n},_getPredicateIcon:function(e){return e.contains("ds6w:what")?"3ds-what":e.contains("ds6w:where")?"3ds-where":e.contains("ds6w:when")?"3ds-when":e.contains("ds6w:who")?"3ds-who":e.contains("ds6w:why")?"3ds-why":e.contains("ds6w:how")?"3ds-how":"search"},_computeDateNls:function(e){let t=e.from&&e.from.split("/").reverse().join("/"),n=e.to&&e.to.split("/").reverse().join("/");return t&&!n?i.getText("from")+": "+t:!t&&n?i.getText("to")+": "+n:t&&n?t+" - "+n:void 0},changeLocalOperator:function(e){this.dispatchEvent("updatePredicateOperator",e)},destroyActiveTagView:function(e){let t,i="";if(e.condition?((t=UWA.clone(e.condition)).id=e.id,t.tagName=e.tagName):t=UWA.clone(e),"string"==typeof t.object?i=t.object.replaceAll(" ","_")+"_"+this.predicate:Array.isArray(t.object)&&(i=t.object.join("_")+"_"+this.predicate),this.activeTagView[i]){let e=this.predicateTagsList.getElement("li.tag[unique_id='"+i+"'] + span.operator-text");return e?e.destroy():(e=this.predicateTagsList.getElements("span.tag-label").pop())&&e.destroy(),this.activeTagView[i].destroy(),delete this.activeTagView[i],this.activeTags--,this.activeTags||this.hide(),!0}return!1},destroyAllActiveTagViews:function(){this.hide(),this.activeTags=0,this.predicateTagsList.empty();for(let e in this.activeTagView)this.activeTagView[e].destroy();this.activeTagView={}},destroy:function(){this.stopListening(),this.destroyAllActiveTagViews(),this._parent()}})}),define("DS/TagNavigatorOpenness/views/SelectedTagsView",["UWA/Core","UWA/Class/View","DS/Handlebars/Handlebars","text!DS/TagNavigatorOpenness/assets/templates/SelectedTagsView.html","DS/TagNavigatorOpenness/TagNavigatorOpennessNLS","DS/TagNavigatorOpenness/views/TagView","DS/TagNavigatorOpenness/views/EmptyView","DS/TagNavigatorOpenness/views/PredicateView","DS/TagNavigatorOpenness/views/utils/ActiveTagsUtils","DS/TagNavigatorOpenness/views/utils/TaggerConfigUtils"],function(e,t,i,n,s,a,o,l,r,d){"use strict";return t.extend({tagName:"div",className:"active-tags-area",template:i.compile(n),domEvents:{},setup:function(e){this._parent(e)},init:function(e){this._parent(e),this.tenantId=e.tenantId;let t=this;this.predicateDisplayName={},this.predicateModel,this.tenantId&&d.retrieveAdminPredicateOperatorConfig(this.tenantId).then(function(){}),r.getPredicateDisplayName().then(function(e){t.predicateModel=e})},render:function(){var e=this.template();this.container.setContent(e);let t,i,n,c,h,p,g=!0,u=!0,f=[],m=[],b=this.getOption("canBeDeleted"),w=this.getOption("canBePinned"),v=this.getOption("canBeExcluded"),O=!0,E=!1,T=!1,x=!1,y=!1,C=!1;this.predicateViews=[],this.container.getElement("#global-filters .excluded-tags-list .title").setText(s.getText("excludedTags")),this.container.getElement("#local-filters .excluded-tags-list .title").setText(s.getText("excludedTags")),this.container.getElement("#global-filters .grouped-tags-list .title").setText(s.getText("groupedTags")),this.container.getElement("#local-filters .grouped-tags-list .title").setText(s.getText("groupedTags")),this.container.getElement("#local-filters .filter-title").setText(s.getText("currentWidget")),this.container.getElement("#global-filters .filter-title").setText(s.getText("tab"));let N=function(e){this.dispatchEvent("tagRemoval",e)};this.showActionContainer=function(){actionContainer.removeClassName("hide")},this.updateTagOptions=function(e){w=e.canBePinned,v=e.canBeExcluded,t=e.isFocused,(i=e.hasEditTagRelations)&&(n=e.advancedActiveTags),O=e.canDateBeExcluded,h=e.isAdvancedSearch,e.onePerLine&&(E=e.onePerLine),e.is3DDashboard&&(p=!0)};let A=function(e,t){let i=this;if(e){let s=this.container.getElement("#local-filters"),a=s.getElement(".included-tags-list ul");s.getElement(".included-tags-list").removeClassName("hide"),a.empty(),this.toShowHeader||(this.toShowHeader=r.hasOverloadedOperator(e)),a.toggleClassName("not-modified",!this.toShowHeader),e.forEach(e=>{let s=Object.keys(e)[0];if(i.predicateViews[s])i.predicateViews[s].updatePredicateView({predicateInfo:e,mode:t,toShowHeader:i.toShowHeader}),i.predicateViews[s].container.isInjected()||i.predicateViews[s].inject(a);else{let o=new l({predicateInfo:e,mode:t,toShowHeader:i.toShowHeader,exclude:v,advancedPredOptions:n,canBeDeleted:b,isAdvCriteria:h}).render().inject(a);i.predicateViews[s]=o,o.addEvent("removeTag",N.bind(i)),o.addEvent("updatePredicateOperator",j.bind(i)),o.addEvent("destroyView",S.bind(i))}})}}.bind(this),j=function(e){this.dispatchEvent("changeLocalOperator",e)}.bind(this),S=function(e){if(e)this.predicateViews[e].destroy(),delete this.predicateViews[e];else{for(let e=0;e<this.predicateViews.length;e++)this.predicateViews[e].destroy();this.predicateViews={}}}.bind(this),D=function(e,t,i){let n=e.condition?e.condition:e,o=n.display?n.display:n.disptext?n.disptext:n.displayValue?n.displayValue:"",l=n.type;-1!==["string","boolean"].indexOf(l)||o||(o=function(e){let t,i;return e.from&&(t=e.from.split("/").reverse().join("/")),e.to&&(i=e.to.split("/").reverse().join("/")),t&&!i?s.getText("from")+": "+t:!t&&i?s.getText("to")+": "+i:t&&i?t+" - "+i:void 0}(e.object)),v="date"===l?O:v;let r={text:o,icon:F(t),isExcluded:e.excluded||n.excluded,hasExcludeSupport:v,canBeDeleted:b,condition:e,pred:t,hasActions:(w||v)&&b,attribute:[{"predicate-name":t.split("/").pop()}],onePerLine:E,canBePinned:!1!==w,isPinned:e.pin,tooltip:e.tooltip};e.isEmbedded&&(r.icon="tag-pencil",r.hasExcludeSupport=!1,r.hasActions=!1,r.canBePinned=!1);let d=new a(r).render();f.push(d),d.addEvent("clickedOnTag",N.bind(this)),"date"===e.type&&e.parent?(D(e.parent,t,i),d.inject(i)):d.inject(i)}.bind(this);this.updateTags=function(e,n){if(i){Object.keys(e.filters).length&&(e.filters.hasOwnProperty("localFilters")||e.filters.hasOwnProperty("localExclude"))?(S(),A(e.filters.localFilters,n),c&&!c.container.isHidden()&&c.container.hide(),g=!1):(this.emptyAllContent(!0),"writeable"===n?(V(),this.container.show(),g=!1):g=!0);let t=this.container.getElement("#local-filters").getElement(".grouped-tags-list");"writeable"===n?t.isHidden()||t.addClassName("hide"):t.getElements("li").length&&t.removeClassName("hide")}else c&&c.hide();I();let s=e.filters;if(Object.keys(s).length){if(this.container.show(),y=e.hasLocal&&!i,C=e.hasOnlyLocal){if(this.container.getElement("#global-filters .included-tags-list").addClassName("hide"),this.container.getElement("#global-filters .excluded-tags-list").addClassName("hide"),!1===t)return this.container.hide(),void(g=!0)}else C||y||(this.container.getElement("#global-filters .included-tags-list").addClassName("hide"),this.container.getElement("#global-filters .excluded-tags-list").addClassName("hide"));this.container.getElement("#local-filters .included-tags-list").addClassName("hide"),this.container.getElement("#local-filters .excluded-tags-list").addClassName("hide");for(const e in s){let n,a;switch(e){case"localFilters":n=this.container.getElement("#local-filters"),a=n.getElement(".included-tags-list ul"),n.getElement(".included-tags-list").removeClassName("hide"),i||a.empty();break;case"localExclude":n=this.container.getElement("#local-filters"),a=n.getElement(".excluded-tags-list ul"),n.getElement(".excluded-tags-list").removeClassName("hide"),a.empty();break;case"globalFilters":n=this.container.getElement("#global-filters"),a=n.getElement(".included-tags-list ul"),n.getElement(".included-tags-list").removeClassName("hide"),a.empty();break;case"globalExclude":n=this.container.getElement("#global-filters"),a=n.getElement(".excluded-tags-list ul"),n.getElement(".excluded-tags-list").removeClassName("hide"),a.empty()}if(!i||i&&"localExclude"==e)if(Array.isArray(s[e]))s[e].forEach(e=>{for(const t in e){let i=e[t].condition?e[t].condition:e[t];i.length&&i.forEach(e=>{D(e,t,a)})}});else for(const i in s[e])if(!1===t&&("globalExclude"===e||"globalFilters"===e)||void 0===t||!0===t){let t=s[e][i];t.length&&t.forEach(e=>{D(e,i,a)})}}P(),g=!1}else i||(f.forEach(e=>{e.destroy()}),g=!0,this.container.getElement("#local-filters .included-tags-list").addClassName("hide"),this.container.getElement("#local-filters .excluded-tags-list").addClassName("hide"),this.container.getElement("#global-filters .included-tags-list").addClassName("hide"),this.container.getElement("#global-filters .excluded-tags-list").addClassName("hide"))};let P=function(){let e=this.container.getElement("#global-filters");t?(e.hasClassName("is-not-interactable")||e.toggleClassName("is-not-interactable",t),!C&&y||!x&&T?e.addClassName("toShowTitle"):e.removeClassName("toShowTitle")):t||e.removeClassName("is-not-interactable");let i=this.container.getElement("#local-filters");!C&&y||!x&&T?i.addClassName("toShowTitle"):i.removeClassName("toShowTitle"),C||x?i.addClassName("toShow"):i.removeClassName("toShow")}.bind(this),I=function(){f&&f.length&&f.forEach(e=>{e.destroy()})}.bind(this),F=function(e){return e.contains("ds6w:what")?"6w-what":e.contains("ds6w:where")?"6w-where":e.contains("ds6w:when")?"6w-when":e.contains("ds6w:who")?"6w-who":e.contains("ds6w:why")?"6w-why":e.contains("ds6w:how")?"6w-how":"search"},U=function(e){e.isGrouped=!0,this.dispatchEvent("tagRemoval",e)}.bind(this);this.updateGroupedTags=function(e){this.container.getElement("#local-filters .included-tags-list ul").empty(),this.container.getElement("#global-filters .included-tags-list ul").empty(),this.container.getElement("#local-filters .included-tags-list").addClassName("hide"),this.container.getElement("#global-filters .included-tags-list").addClassName("hide"),m&&m.length&&m.forEach(e=>{e.destroy()});let i=2;if(e.allGroupings.length?(T=!!e.localGroupings.length,x=!1):e.localGroupings.length&&(x=!0),x&&!1===t)return this.container.hide(),void(u=!0);for(const n in e){let s=n.includes("local")?this.container.getElement("#local-filters"):this.container.getElement("#global-filters"),o=s.getElement(".grouped-tags-list ul");o.empty(),!1===t&&"localGroupings"!==n||void 0===t||!0===t?e[n]&&e[n].length?(s.getElement(".grouped-tags-list").removeClassName("hide"),e[n].forEach(e=>{let t=e.predicate;if(e.predLevel){let i=this.predicateDisplayName[t];i||(i=this.predicateDisplayName[t]=this.predicateModel.getPredicate(t).displayName());let n=new a({text:i||t,icon:"group",condition:e,isGrouped:!0,canBeDeleted:b,attribute:[{"predicate-name":t,is_predicate:!0}]}).render().inject(o);n.addEvent("clickedOnTag",U.bind(this)),m.push(n)}else e.object.forEach((t,i)=>{let n=UWA.clone(e);n.object=[],n.object.push(e.object[i]);let s=new a({text:t.dispText,icon:"group",condition:n,isGrouped:!0,canBeDeleted:b,attribute:[{"predicate-name":e.predicate}]}).render().inject(o);s.addEvent("clickedOnTag",U.bind(this)),m.push(s)})}),this.container.show(),"localGroupings"===n&&s.addClassName("toShow"),u=!1):(i--,s.getElement(".grouped-tags-list").addClassName("hide"),0==i&&(u=!0,this.container.hide())):0==--i&&(u=!0,this.container.hide())}P()};let V=function(){c||(c=(new o).render().inject(this.container).hide()).setMessageText(s.getText("selectTagMsg")),c.container.show()}.bind(this);return this.getAllFiltersStatus=function(){return g&&u},this.setAllFilterStatus=function(){g=!0,u=!0},this.emptyAllContent=function(e){this.container.getElement("#local-filters").hasClassName("toShow")||this.container.getElement("#local-filters").hasClassName("toShowTitle")?(this.container.getElement("#local-filters .included-tags-list ul").empty(),this.container.getElement("#local-filters .included-tags-list").addClassName("hide"),this.container.getElement("#local-filters .excluded-tags-list").addClassName("hide"),this.container.getElement("#local-filters .excluded-tags-list ul").empty(),e||(this.container.getElement("#local-filters .grouped-tags-list ul").empty(),this.container.getElement("#local-filters .grouped-tags-list").addClassName("hide"))):(this.container.getElement("#global-filters .included-tags-list ul").empty(),this.container.getElement("#global-filters .included-tags-list").addClassName("hide"),this.container.getElement("#global-filters .excluded-tags-list").addClassName("hide"),this.container.getElement("#global-filters .excluded-tags-list ul").empty(),e&&(this.container.getElement("#global-filters .grouped-tags-list ul").empty(),this.container.getElement("#global-filters .grouped-tags-list").addClassName("hide"))),S(),I(),this.toShowHeader=!1},this.setTenant=function(e){e&&!d.getOperatorLoadedStatus()&&d.retrieveAdminPredicateOperatorConfig(e).then(function(){})},this},destroy:function(){this._parent()}})}),define("DS/TagNavigatorOpenness/views/ActiveTagsView",["UWA/Core","UWA/Class/View","DS/Handlebars/Handlebars","text!DS/TagNavigatorOpenness/assets/templates/SectionView.html","DS/Controls/Expander","DS/Controls/Button","DS/UIKIT/Tooltip","DS/UIKIT/Input/Button","DS/TagNavigatorOpenness/TagNavigatorOpennessNLS","DS/TagNavigatorOpenness/views/utils/ActiveTagsUtils","DS/TagNavigatorOpenness/views/SelectedTagsView","DS/TagNavigatorOpenness/views/model/ActiveTagsModel"],function(e,t,i,n,s,a,o,l,r,d,c,h){"use strict";return t.extend({tagName:"div",className:"tno-act-crit-section",template:i.compile(n),domEvents:{},setup:function(e){this.filters={},this._parent(e)},init:function(e){this._parent(e)},render:function(){var t=this.template();this.container.setContent(t);let i=this.getOption("data");this.container.setAttribute("id",i.id);let n=null==i.isDisabled||i.isDisabled,p=null==i.canBeCollapsed||i.canBeCollapsed,g=null==i.canBeDeleted||i.canBeDeleted;this.filters={},this.container.hide();let u,f,m,b,w,v,O,E,T=!0,x={localfilters:{},allfilters:{}},y={};this.container.toggleClassName("disabled",n);let C=new h,N=function(e){this.dispatchEvent("enableApplyBtn"),T&&(O=UWA.clone(this.filters.filters));let t=e.id||e.pred,i=O.localfilters;if(Object.keys(i).length){let n=e.condition?e.condition.object:e.object,s=e.hasOwnProperty("excluded")?e.excluded:e.condition&&e.condition.hasOwnProperty("excluded")?e.condition.excluded:void 0;if(i.condition)i.condition.forEach((e,a)=>{if(e[t]&&e[t].condition){for(let i=0;i<e[t].condition.length;i++){let a=e[t].condition[i];if(JSON.stringify(a.object)===JSON.stringify(n)){"boolean"!=typeof s||a.hasOwnProperty("excluded")&&a.excluded==s?e[t].condition.splice(i,1):a.excluded=s;break}}0===e[t].condition.length&&i.condition.splice(a,1)}else if(e[t]&&Array.isArray(e[t])){let o=e[t];for(let e=0;e<o.length;e++){let t=o[e];if(JSON.stringify(t.object)===JSON.stringify(n)){"boolean"!=typeof s||t.hasOwnProperty("excluded")&&t.excluded==s?o.splice(e,1):t.excluded=s;break}}0===o.length&&i.condition.splice(a,1)}});else if(i[t]){let e=i[t];for(let t=0;t<e.length;t++)if(JSON.stringify(e[t].object)==JSON.stringify(n)){"boolean"!=typeof s||tag.hasOwnProperty("excluded")&&tag.excluded==s?e[t].splice(t,1):e[t].excluded=s;break}0===e.length&&delete i[t]}t===d.EMBEDDED_FILTER_PREDICATE&&O.embeddedfilter&&O.embeddedfilter.filter&&(O.embeddedfilter.filter.condition=[])}if(b&&"writeable"===C.get("mode")){T=!1;let e=UWA.clone(O),t=d.segregateFilters(e,b);u.updateTags(t,C.get("mode"))}}.bind(this),A=function(e){e.stopPropagation(),O=void 0,T=!0;let t=C.get("mode");if(b&&"writeable"===t){let e=this.filters.filterProperties;S(x,e,t)}else u.emptyAllContent(),u.setAllFilterStatus(),P(),this.dispatchEvent("criteriaChange")}.bind(this),j=function(e){e.stopPropagation(),this.dispatchEvent("saveTags",{filter:Object.keys(this.filters.filters.allfilters).length?this.filters.filters.allfilters:this.filters.filters.localfilters})}.bind(this);this.getModifiedFilters=function(){O&&O.localfilters.condition.length||(O=UWA.clone(this.filters.filters));let e={filter:UWA.clone(O),group:this.filters.hasOwnProperty("groups")?this.filters.groups:null};return this.filters.filters=UWA.clone(O),O=void 0,T=!0,e},this.resetModifiedFilters=function(){O=void 0,T=!0},this.getOldFilters=function(){return{filter:UWA.clone(E)}},function(){let t;if(g&&(w=e.createElement("div",{class:"tno-custom-header"}),(v=new l({id:"tn-saveTagsBtn",value:r.getText("saveTags"),className:"link"}).inject(w)).addEvent("onClick",j.bind(this)),t=new a({displayStyle:"lite",label:"lite displayStyle",domId:"clearAllBtn",icon:{iconName:"trash",fontIconFamily:WUXManagedFontIcons.Font3DS},showLabelFlag:!1,touchMode:!0}).inject(w),new o({target:w.getElement("#clearAllBtn"),body:"<div><b>"+r.getText("clearActiveTags")+"</b></div>",className:"tagger-filter-tooltip"}),t.addEventListener("buttonclick",A.bind(this)),t.addEventListener("click",function(e){e.stopPropagation()})),p)m=new s({header:r.getText("selectedTags"),icon:{iconName:this.icon?this.icon.fonticon:"",fontIconFamily:WUXManagedFontIcons.Font3DS},customHeader:g?w:"",style:"simple",touchMode:!0,domId:"active-tags"}).inject(this.container),f=this.container.getElement(".wux-controls-expander-body");else{if(this.getElement(".tno-section-title").setText(r.getText("selectedTags")),i.icon){let e=i.icon;e.hasOwnProperty("fonticon")?this.getElement(".tno-section-header span").addClassName("wux-ui-3ds-"+e.fonticon):e.hasOwnProperty("image")&&this.getElement(".tno-section-header img").setAttribute("src",e.image)}g&&(t.inject(this.getElement(".tno-section-header .tno-section-clear-all")),this.getElement(".tno-section-header .tno-section-clear-all").toggleClassName("hide",g)),f=this.getElement(".tno-section-content"),this.container.getElement(".tno-section-header").show()}(u=new c({canBeDeleted:!n&&g,canBePinned:this.getOption("canBePinned"),tenantId:this.getOption("tenantId")}).render().inject(f)).addEvent("tagRemoval",function(e){if(e.isGrouped){let t={groups:d.getUpdatedGrouping(e,this.filters.groups),removedGroupings:d.getGroupedInfo(e,this.filters.groups)};this.dispatchEvent("criteriaChange",t)}else{let t=C.get("mode");if(b){if(N(e),"readOnly"==t){let e={filter:O,isAdvProxy:!0,mode:"readOnly"};O=void 0,T=!0,this.dispatchEvent("criteriaChange",e)}}else{let t=d.getTagInfo(e);this.dispatchEvent("criteriaChange",t)}}}.bind(this)),u.addEvent("hideExpander",function(){this.container.hide()}.bind(this)),u.addEvent("changeLocalOperator",function(e){e.informView&&this.dispatchEvent("enableApplyBtn"),O||(O=UWA.clone(this.filters.filters));for(let t=0;t<O.localfilters.condition.length;t++){let i=O.localfilters.condition[t];if(i[e.predicate]){i[e.predicate].operator=e.operator;break}}}.bind(this))}.bind(this)(),this.collapse=function(){m&&m.close()},this.expand=function(){m&&m.expand()},this.getExpandStatus=function(){if(m)return m.expandedFlag},this.editCriteria=function(e){let t=!1;"readOnly"==C.get("mode")?(C.set("mode","writeable"),t=!0,this.container.removeClassName("readOnly"),this.container.addClassName("writeable"),E=UWA.clone(this.filters.filters)):(C.set("mode","readOnly"),this.container.addClassName("readOnly"),this.container.removeClassName("writeable")),e&&(this.filters.filters=UWA.clone(E)),this.updateCriteria(this.filters.filters,this.filters.filterProperties,t)},this.updateCriteria=function(e,t,i){let n;if(b&&(n=C.get("mode")),y=t,e.hasOwnProperty("allfilters"))this.filters.filters=UWA.clone(e),"writeable"===n&&(O=UWA.clone(e)),S(e,y,n,i);else if(e.hasOwnProperty("groups")){if(Array.isArray(e.groups)){let t=UWA.clone(e.groups);e.groups={localGroupings:[],allGroupings:[]},t.forEach(t=>{t.isLocal?e.groups.localGroupings.push(t):e.groups.allGroupings.push(t)})}this.filters.groups=e.groups,D(UWA.clone(e.groups)),this.filters.filters&&S(this.filters.filters)}P()};let S=function(e,t,i,n){let s=UWA.clone(e);s.embeddedfilter&&s.embeddedfilter.filter&&Object.keys(s.embeddedfilter.filter).length>0||s.embeddedfilter&&s.embeddedfilter.isInEdit?v.setDisabled(!0):v.setDisabled(!1),s.filterProperties=t;let a=d.segregateFilters(s,b);u.updateTags(a,i),(Object.keys(a.filters).length||b&&"writeable"==i&&!Object.keys(a.filters).length)&&(b&&"writeable"==i?clearAllBtn.addClassName("disabled"):clearAllBtn.removeClassName("disabled")),b&&("writeable"===i||w.addClassName("show-edit-tags"))},D=function(e){u.updateGroupedTags(e)};this.updateTagOptions=function(e){e.headerTitle&&(m.header=e.headerTitle),b=e.hasEditTagRelations,u.updateTagOptions(e),b?w.addClassName("show-edit-tags"):w.removeClassName("show-edit-tags"),n||this.container.toggleClassName("disabled",e.focusedSubject),this.container.toggleClassName("subject-focused",e.focusedSubject),e.tenantId&&u.setTenant(e.tenantId)};let P=function(){u.getAllFiltersStatus()?this.container.hide():(m.expandedFlag=!0,this.container.show())}.bind(this);(function(){return 0===this.filters.groups.allGroupings.length&&0==this.filters.groups.localGroupings.length}).bind(this);return this.updateTagsViewOnFocusChange=function(e){this.updateTagOptions(e),this.filters.filters&&this.updateCriteria(this.filters.filters,this.filters.filterProperties),this.filters.groups&&this.updateCriteria(this.filters.groups)},this.updateViewOptions=function(e){UWA.is(e,"object")&&e.hasOwnProperty("canSaveTags")&&(e.canSaveTags?v&&v.show():v&&v.hide())},this},destroy:function(){this._parent()}})}),define("DS/TagNavigatorOpenness/views/ActiveCriteriaView",["UWA/Core","UWA/Class/View","DS/Handlebars/Handlebars","text!DS/TagNavigatorOpenness/assets/templates/ActiveCriteriaView.html","DS/TagNavigatorOpenness/views/ActiveFilterView","DS/TagNavigatorOpenness/views/ActiveTagsView","DS/TagNavigatorOpenness/views/utils/ActiveTagsUtils","css!DS/TagNavigatorOpenness/TagNavigatorOpenness.css"],function(e,t,i,n,s,a,o){"use strict";return t.extend({tagName:"div",className:"tno-act-crit-cont",template:i.compile(n),domEvents:{},setup:function(e){this.sectionViews={},this._parent(e)},init:function(e){this._parent(e)},render:function(){let e,t,i=this.getOption("sections"),n=this;var l=this.template();this.container.setContent(l),navigator.userAgent.toLowerCase().indexOf("firefox")>-1&&this.container.addClassName("firefox"),!1===this.getOption("scroll")&&this.container.addClassName("no-scroll");this.updateTagOptions=function(e){t.updateTagOptions(e)};let r=function(e){e&&("start"===e.action?this.dispatchEvent("editActionStart"):"launch"===e.action?this.dispatchEvent("editActionLaunch",e):"cancel"===e.action&&this.dispatchEvent("editActionCancel"))}.bind(this),d=function(){this.dispatchEvent("enableApply")}.bind(this);return i.forEach((i,l)=>{i.id===o.SECTION_ADDITIONAL_FILTERS?(e=new s({data:i}).render().inject(n.container.getElement(".tno-act-crit-sections"))).addEvent("addCriteriaChange",function(e){this.dispatchEvent("onAdditionalCriteriaChange",e)}.bind(this)):i.id===o.SECTION_FILTERS&&((t=new a({data:i,tenantId:this.getOption("tenantId")}).render().inject(n.container.getElement(".tno-act-crit-sections"))).addEvent("criteriaChange",function(e){this.dispatchEvent("onCriteriaChange",e)}.bind(this)),t.addEvent("editTagClick",r.bind(this)),t.addEvent("actionCancel",r.bind(this)),t.addEvent("actionApply",r.bind(this)),t.addEvent("enableApplyBtn",d.bind(this)),t.addEvent("saveTags",function(e){this.dispatchEvent("onSaveTags",e)}.bind(this)))}),this.updateSectionOptions=function(e){e&&e.id===o.SECTION_FILTERS&&t&&t.updateViewOptions(e.options)},this.expandActiveTags=function(){t.expand()},this.collapseActiveTags=function(){t.collapse()},this.getActiveTagsExpandStatus=function(){return t.getExpandStatus()},this.updateCriteria=function(e,i){t.updateCriteria(e,i)},this.updateAdditionalCriteria=function(t){e.updateAdditionalCriteria(t)},this.setAdditionalFilterProperties=function(t){e.setAdditionalFilterProperties(t)},this.editCriteria=function(e){t.editCriteria(e),e||this.container.show()},this.getModifiedFilters=function(){return t.getModifiedFilters()},this.resetModifiedFilters=function(){return t.resetModifiedFilters()},this.getOldFilters=function(){return t.getOldFilters()},this.updateActiveViewOnFocusChange=function(i){e.updateFilterViewOnFocusChange(i),t.updateTagsViewOnFocusChange(i)},this},destroy:function(){this._parent()}})});