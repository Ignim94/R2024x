define("DS/ENOXEngineerCommonUtils/expand/ProgressiveExpand",["UWA/Core"],e=>{const t={utils:{}},n=(e,t)=>{if(typeof e!==t)throw new Error("wrong type value")};t.utils={checkValueWithType:n,...t.utils};const r=(e,t)=>{if(!Array.isArray(e))throw new Error("expecting an array value");e.forEach(e=>{n(e,t)})};t.utils={checkArrayValuesWithType:r,...t.utils};const s=(e,t)=>{if(!(e instanceof t))throw new Error("wrong type value")};t.utils={checkInstanceWithType:s,...t.utils};const i=(e,t)=>{if(!Array.isArray(e))throw new Error("expecting an array value");e.forEach(e=>{s(e,t)})};t.utils={checkArrayInstancesWithType:i,...t.utils};const o=e=>{const t=typeof e;return"string"===t&&("number"===e||"string"===e||"boolean"===e)||"function"===t},a=(t,r,i,a=null)=>{if(!e.is(t)||"string"!=typeof r||!e.is(i))throw new Error("invalid input");if(!1===o(i))throw new Error("invalid type");const l=`_${r}`;Object.defineProperty(t,r,{get:()=>(e.is(t[l])||(e.is(a)?t[l]=a():t[l]=null),t[l]),set(e){const r=typeof i;if("string"!==r||"number"!==i&&"string"!==i&&"boolean"!==i){if("function"!==r)throw new Error(`invalid type '${r}'`);s(e,i)}else n(e,i);t[l]=e}})};t.utils={declareValueProperty:a,...t.utils};const l=(t,n,s)=>{if(!e.is(t)||"string"!=typeof n||!e.is(s))throw new Error("invalid input");if(!1===o(s))throw new Error("invalid type");const a=`_${n}`;Object.defineProperty(t,n,{get:()=>(e.is(t[a])||(t[a]=[]),t[a]),set(e){const n=typeof s;if("string"!==n||"number"!==s&&"string"!==s&&"boolean"!==s){if("function"!==n)throw new Error(`invalid type '${n}'`);i(e,s)}else r(e,s);t[a]=e}})};t.utils={declareArrayValueProperty:l,...t.utils};class u{getImplKeys(){return Reflect.ownKeys(this).filter(e=>"string"==typeof e&&e.startsWith("_"))}getImplKey(e){const t=`_${e}`;return-1!==this.getImplKeys().indexOf(t)?this[t]:null}get json(){const t={};return this.getImplKeys().forEach(n=>{const r=n.slice(1);if(Reflect.has(this,n)){const s=this[n];if(Array.isArray(s)&&s.length){const e=s[0];t[r]=e instanceof u?s.map(e=>e.json):s}else s instanceof u?t[r]=s.json:e.is(s)&&(t[r]=s)}}),t}}t.utils={Base:u,...t.utils};class c extends u{constructor(){super(),l(this,"path","number"),l(this,"physical_id_path","string")}}t.Path=c;class h extends u{constructor(){super(),a(this,"id","number"),a(this,"physical_id","string")}}t.Physical_Object=h;class d extends u{constructor(){super(),a(this,"ellql","string"),a(this,"uql","string"),a(this,"uql_prefix_handler","string")}}t.Graph_Expression=d;class p extends u{constructor(){super(),a(this,"descending_condition",d,()=>new d),a(this,"descending_condition_object",d,()=>new d),a(this,"descending_condition_relation",d,()=>new d)}}t.Graph=p;class m extends u{}t.Matrices_Overload=m;class g extends u{constructor(){super(),l(this,"prefix_path",c)}}t.Prefix_Filter=g;class f extends u{constructor(){super(),a(this,"name","string"),a(this,"mode","string"),a(this,"synthesis_only","number"),a(this,"limit","number"),a(this,"group_by_facet","number")}}t.Synthesis=f,t.ENUM_FACET_MODE={flat:"flat",tree_leaf:"tree_leaf",tree_leaf_instance:"tree_leaf_instance",occurrence:"occurrence",matching_occurrence:"matching_occurrence"};class _ extends u{constructor(){super(),a(this,"ellql","string"),a(this,"uql","string"),a(this,"uql_prefix_handler","string")}}t.Materials=_;class y extends u{constructor(){super(),a(this,"left",N,()=>new N),a(this,"right",N,()=>new N)}}t.And_Not=y;class E extends u{constructor(){super(),l(this,"filters",N,()=>new N)}}t.And=E;class A extends u{constructor(){super(),l(this,"filters",N,()=>new N)}}t.Or=A;class C extends u{constructor(){super(),l(this,"predefined_computation","string")}}t.Hits=C;class S extends u{constructor(){super(),l(this,"sequence",d)}}t.SequenceFilter=S;t.BeginSequenceFilter=class extends S{get json(){const e=super.json,{sequence:t}=e||{};return Array.isArray(t)&&t.length&&t.splice(0,0,{statement:"BEGIN"}),e}};t.EndSequenceFilter=class extends S{get json(){const e=super.json,{sequence:t}=e||{};return Array.isArray(t)&&t.length&&t.push({statement:"END"}),e}};t.AllSequenceFilter=class extends S{get json(){const e=super.json,{sequence:t}=e||{};return Array.isArray(t)&&1===t.length&&t.splice(0,0,{statement:"ALL"}),e}};t.NextSequenceFilter=class extends S{get json(){const e=super.json,{sequence:t}=e||{};return Array.isArray(t)&&2===t.length&&t.splice(1,0,{statement:"NEXT"}),e}};class N extends u{constructor(){super(),a(this,"and",E,()=>new E),a(this,"or",A,()=>new A),a(this,"sequence_filter",S),a(this,"all","number"),a(this,"config_filter","string"),a(this,"config_filter_id",h,()=>new h),a(this,"referenced","string"),a(this,"and_not",y,()=>new y),a(this,"prefix_filter",g,()=>new g)}}t.Filter=N;class M extends u{constructor(){super(),a(this,"max_distance_from_prefix","number"),a(this,"compute_matching_subpaths_lengths","number"),a(this,"match_only_refs","number"),a(this,"and",E),a(this,"or",A),a(this,"and_not",y),a(this,"prefix_filter",g),a(this,"sequence_filter",S),a(this,"referenced","string"),a(this,"all","number")}}t.Truncate=M;class w extends u{constructor(){super(),a(this,"truncate",M,()=>new M),a(this,"synthesis",f,()=>new f),a(this,"materials",_,()=>new _)}}t.Aggregation_Processor=w;class U extends u{constructor(){super(),l(this,"select_object","string"),l(this,"select_relation","string"),l(this,"select_material","string"),l(this,"select_pgp","string"),l(this,"synthesis","string"),l(this,"filter_facets","string"),a(this,"facet_name","string"),a(this,"matching_lengths","number"),a(this,"format","string"),a(this,"hits",C,()=>new C)}}t.Outputs=U,t.ENUM_OUTPUT_FORMAT={entity_relation:"entity_relation",entity_relation_occurrence:"entity_relation_occurrence",entity_relation_occurrence_label:"entity_relation_occurrence_label"};class v extends u{}t.NamedFilters=v;class R extends u{constructor(){super(),a(this,"limit_max_path","number"),a(this,"limit_timeout_in_ms","number")}}t.Param=R;class x extends u{constructor(){super(),a(this,"label","string"),a(this,"root",h,()=>new h),a(this,"graph",p,()=>new p),a(this,"filter",N,()=>new N),a(this,"parameters",R,()=>new R),l(this,"aggregation_processors",w),l(this,"matrices_overloads",m)}}t.Expand=x;class T extends u{constructor(){super(),l(this,"expands",x)}}t.Batch=T;return t.Query=class extends u{constructor(){super(),a(this,"batch",T,()=>new T),a(this,"outputs",U,()=>new U),a(this,"namedFilters",v,()=>new v)}},t}),define("DS/ENOXEngineerCommonUtils/XENCommonConstants",[],()=>{return{SERVICE_3DSPACE_NAME:"3DSpace",SERVICE_3DCOMPASS_NAME:"3DCompass",SERVICE_3DSWYM_NAME:"3DSwym",SERVICE_3DSEARCH_NAME:"3DSearch",SERVICE_3DPASSPORT_NAME:"3DPassport",SERVICE_6WTAGS_NAME:"6WTags",SERVICE_COMMENT_NAME:"comment",SERVICE_3DNOTIFICATIONS_NAME:"3dnotifications",ERROR_TYPE_TIMEOUT:"Timeout",COMMAND_WS_EXPAND_CV:"cv_expand",COMMAND_WS_EXPAND_DB:"db_expand_new",COMMAND_WS_EXPAND_CV_V2:"cv_expand_v2",COMMAND_WS_MULTIEXPAND_V2:"multiexpand_v2",COMMAND_WS_MULTIEXPAND:"multiexpand",CONT_QUANTITY_VOLUME:"ds6wg:DELFmiContQuantity_Volume.V_ContQuantity",DECLARED_VOLUME:"ds6wg:MaterialUsageExtension.DeclaredQuantity",CONT_QUANTITY_MASS:"ds6wg:DELFmiContQuantity_Mass.V_ContQuantity",CONT_RAWMAT_QUANTITY_LENGTH:"ro.madefromquantity_length.V_ContQuantity-Instance",CONT_RAWMAT_QUANTITY_MASS:"ro.madefromquantity_mass.V_ContQuantity-Instance",CONT_RAWMAT_QUANTITY_AREA:"ro.madefromquantity_area.V_ContQuantity-Instance",CONT_RAWMAT_QUANTITY_VOLUME:"ro.madefromquantity_volume.V_ContQuantity-Instance",CONT_RAWMAT_QUANTITY_ASREQ:"ro.madefromquantity_AsRequired.AsRequired-Instance",CONT_RAWMAT_QUANTITY_LENGTH_INST:"ro.VPMInstanceQuantity_Length.V_ContQuantity-Instance",CONT_RAWMAT_QUANTITY_MASS_INST:"ro.VPMInstanceQuantity_Mass.V_ContQuantity-Instance",CONT_RAWMAT_QUANTITY_AREA_INST:"ro.VPMInstanceQuantity_Area.V_ContQuantity-Instance",CONT_RAWMAT_QUANTITY_VOLUME_INST:"ro.VPMInstanceQuantity_Volume.V_ContQuantity-Instance",CONT_RAWMAT_QUANTITY_ASREQ_INST:"ro.VPMInstanceQuantity_AsRequired.AsRequired-Instance",DIMENSION_VOLUME:"VOLUME",DIMENSION_MASS:"MASS",DIMENSION_AREA:"AREA",DIMENSION_LENGTH:"LENGTH",PREFERRED_MASS_UNIT:"preferred-unit-mass",PREFERRED_VOLUME_UNIT:"preferred-unit-volume",PREFERRED_AREA_UNIT:"preferred-unit-area",PREFERRED_LENGTH_UNIT:"preferred-unit-length"}}),define("DS/ENOXEngineerCommonUtils/QuantityHelper/QuantityHelperUtils",[],()=>{const e=function(e){let t=!1;switch(typeof e){case"number":t=e>0;break;case"boolean":t=!0;break;case"string":t=e.trim().length>0}return t},t=function(e){let t=NaN;switch(typeof e){case"number":t=e;break;case"string":t=parseFloat(e)}return t};return{isAValidValue:e,hasQuantity:function(t){return!!e(t)&&t},asNumber:t,sum:function(e){return e.reduce((e,n)=>(1e3*e+1e3*t(n))/1e3,0)}}}),define("DS/ENOXEngineerCommonUtils/xEngAlertManager",["DS/Notifications/NotificationsManagerUXMessages","DS/Notifications/NotificationsManagerViewOnScreen","i18n!DS/ENOXEngineerCommonUtils/assets/nls/XENCommonNls.json"],function(e,t,n){"use strict";var r={_notif_manager:null,init:function(n){null===this._notif_manager&&(this._notif_manager=e,t.setNotificationManager(this._notif_manager),t.setStackingPolicy(5),t.setRemoveStackOnFirstTimeoutFlag(!0),t.setFadeOutPolicy(2))},errorAlert:function(e,t){this._notif_manager||this.init(),this._notif_manager.addNotif({level:"error",title:t,message:e,sticky:!1})},sucessAlert:function(e){this._notif_manager||this.init(),this._notif_manager.addNotif({level:"success",message:e,sticky:!1})},notifyAlert:function(e){this._notif_manager||this.init(),this._notif_manager.addNotif({level:"info",message:e,sticky:!1})},warningAlert:function(e){this._notif_manager||this.init(),this._notif_manager.addNotif({level:"warning",message:e,sticky:!1})},notif:function(e,t){this.customNotif({...t,level:e,sticky:!1})},customNotif:function(e){this._notif_manager||this.init(),this._notif_manager.addNotif(e)},errorNotif:function(e){this.notif("error",e)},successNotif:function(e){this.notif("success",e)},infoNotif:function(e){this.notif("info",e)},warningNotif:function(e){this.notif("warning",e)},unexpectedFailure:function(e){r.errorNotif({title:e,subtitle:n.get("app.failure")})}};return r}),define("DS/ENOXEngineerCommonUtils/XENModal",["DS/ENOFloatingPanel/ENOFloatingPanel","UWA/Core","i18n!DS/ENOXEngineerCommonUtils/assets/nls/XENCommonNls.json"],function(e,t,n){"use strict";function r(r){var s=this;this.options={title:"Dialog",persitId:r.persitId||"XEN_dialog",withFooter:!0},this.options=t.extend(this.options,r),this.options.events={onClose:function(){s.options.onClose&&s.options.onClose.apply(),s.destroy()},onHide:function(){s.options.onClose&&s.options.onClose.apply(),s.destroy()}},this.modal=function(t){return new e({className:t.className||"",closable:!0,title:t.title,body:"",footer:"",animate:!0,resizable:!0,autocenter:!0,visible:!0,limitParent:!0,overlay:!0,persistId:t.persitId||"XEN_dialog",events:t.events||{}})}(this.options),setTimeout(function(){var e=200,t=200;s.options.minSize&&(s.options.minSize.width&&(e=s.options.minSize.width),s.options.minSize.height&&(t=s.options.minSize.height)),s.modal&&s.modal.setMinSize(e,t)},10);var i=widget?widget.body:document.body;this.modal.inject(i),this.options.withFooter&&(this.options.customFooter?this.modal.setFooter(this.options.customFooter()):this.modal.setFooter("<button type='button' name='okButton' class='btn btn-primary'>"+n.get("eng.ui.button.ok")+"</button> <button type='button' name='cancelButton' class='btn btn-default'>"+n.get("eng.ui.button.cancel")+"</button>"),this._bindFooterEvent())}return r.prototype.isNotDestroyed=function(){return this.modal&&this.options},r.prototype.setNewSize=function(e){this.modal.setNewSize(e)},r.prototype.show=function(){this.modal.show()},r.prototype.dispose=function(){this.modal.hide()},r.prototype.injectBody=function(e){this.modal.setBody(e)},r.prototype.inject=function(e){this.modal.inject(e)},r.prototype.getBody=function(){return this.modal.getBody()},r.prototype.injectHeader=function(e){this.modal.setHeader(e)},r.prototype.injectFooter=function(e){this.modal.setFooter(e)},r.prototype._unbindFooterEvent=function(){},r.prototype._bindFooterEvent=function(){var e=this;this.modal.getFooter().getElements(".btn").forEach(function(t){"cancelButton"===t.name&&t.addEvent("click",function(){e.options.onClose&&e.options.onClose.apply(),e.destroy()}),"okButton"===t.name&&t.addEvent("click",function(){e.options.onValidate&&e.options.onValidate.apply(),e.destroy()})})},r.prototype.getContent=function(){return this.modal.getContent()},r.prototype.destroy=function(){this.options.relatedCommand&&"function"==typeof this.options.relatedCommand&&this.options.relatedCommand.end(),this.modal.destroy();for(var e=Object.keys(this),t=0;t<e.length;t++)this[e[t]]=void 0,delete this[e[t]]},r}),define("DS/ENOXEngineerCommonUtils/LoggerUtils",[],()=>{const e={log(){},error(){},warn(){},debug(){},id:"stub"},t={log(...e){console.log(...e)},error(...e){console.error(...e)},warn(...e){console.warn(...e)},debug(...e){console.debug(...e)},id:"console"};class n{constructor({id:e,label:t}){this.loggerID="string"==typeof e?e:"",this.loggerLabel="string"==typeof t?t:""}static create(e,t){if("string"!=typeof e||!e.trim().length)throw new Error("expecting an id as input");return new n({id:e,label:t})}get id(){return this.loggerID}get label(){return this.loggerLabel}get enable(){return"true"===sessionStorage.getItem(this.id)}get appender(){return this.enable?t:e}log(...e){this.print({parameters:[...e],printFunc:this.appender.log})}error(...e){this.print({parameters:[...e],printFunc:this.appender.error})}warn(...e){this.print({parameters:[...e],printFunc:this.appender.warn})}debug(...e){this.print({parameters:[...e],printFunc:this.appender.debug})}print({parameters:e,printFunc:t}){if(!this.enable)return;const n=this.formatInputs(e);t.bind(this.appender)(...n)}formatInputs(e){if(!e.length)return e;const t=[...e],n=this.label.trim().length?`[${this.id} : ${this.label}]`:`[${this.id}]`,r=t[0];return t[0]=`${n} -> ${r}`,t}}return{Logger:n,availableAppenders:{stub:e,console:t}}}),define("DS/ENOXEngineerCommonUtils/CancelablePromise",["UWA/Promise"],function(e){"use strict";var t=e;return t.prototype.cancelEmbeddedRequest=function(e){this.xEngEmbeddedRequest&&this.xEngEmbeddedRequest.cancel()},t}),define("DS/ENOXEngineerCommonUtils/XENMask",["UWA/Core","DS/Controls/Loader","i18n!DS/ENOXEngineerCommonUtils/assets/nls/XENCommonNls.json"],function(e,t,n){"use strict";return{mask:function(r,s){var i;this.isMasked(r)&&this.unmask(r),r.addClassName("masked"),i=e.createElement("div",{class:"mask"}),this.loader=new t({text:e.is(s,"string")?s:n.get("loading"),showButtonFlag:!1}),s=e.createElement("div",{class:"mask-wrapper",html:{tag:"div",class:"mask-content",html:[this.loader]}}).inject(i),this.loader.on(),i.inject(r)},unmask:function(e){var t=e.getElement(" > .mask");t&&(t.destroy(),this.loader&&(this.loader.off(),this.loader.destroy(),this.loader=null)),e.removeClassName("masked")},isMasked:function(e){return e.hasClassName("masked")}}}),define("DS/ENOXEngineerCommonUtils/expand/ExpandPayloadFactoryUtils",["UWA/Core"],e=>{const t={};function n(e){if("string"!=typeof e||!e.trim().length)return"";let t=e;const n=e.match(/\[[\S]+\]/g)||[];return[...new Set(n)].forEach(e=>{const n=e.toLowerCase().replaceAll("_","_95_").replaceAll("[","").replaceAll("]","").replaceAll(":","_58_").replaceAll(".","_46_").replaceAll(" ","_32_");t=t.replaceAll(e,n)}),t}t.definePropertiesOnObject=function(t,n,{getterFct:r=null,setterFct:s=null}){Array.isArray(n)&&e.is(t)?n.forEach(n=>{const i={};e.is(r)&&"string"==typeof r&&Reflect.has(t,r)&&(i.get=function(){return t[r](n)}),e.is(s)&&"string"==typeof s&&Reflect.has(t,s)&&(i.set=function(e){t[s](n,e)}),(Reflect.has(i,"get")||Reflect.has(i,"set"))&&Object.defineProperty(t,n,i)}):console.error("definePropertiesOnObject wrong inputs")},t.fixUqlWithCloudViewFormat=n,t.appendUqlValue=function(e,t,r="AND"){if("string"!=typeof t||!t.trim().length)return e;const s=n(t);let i="";return i="string"==typeof e&&e.trim().length?`${e} ${r} (${s})`:s};const r=["no_type_filter_rel","type_filter_rel","compute_select_bo","expand_iter","fcs_url_mode","select_bo","select_rel","locale","label","tenant","q.iterative_filter_query_bo","paths","root_path","root_physicalid","root_path_physicalid","config_filter","sequence_filter","max_count_path","find_in_context","multi_root_physicalid"];t.defaultProperties=r;t.defaultMultiProperties=["specVersion","union","intersection","minus","synthesis_mode"];return t.AbstractPayloadFactory=class{get json(){return null}get entries(){return r}updatePayloadWithEntries(){console.debug("updatePayloadWithEntries not implemented")}updateAnswer(){console.debug("updateAnswer not implemented")}},t}),define("DS/ENOXEngineerCommonUtils/expand/ExpandErrorManager",["DS/ENOXEngineerCommonUtils/XENCommonConstants"],e=>{class t{static buildErrorMsg(e){if(!Array.isArray(e))return"";return e.map(e=>{if("string"==typeof e)return e;const{message:t,reason:n}=e.error||{};let r="";return r="string"==typeof n&&""!==n.trim()?n:"string"==typeof t&&""!==t.trim()?t:e.toString()}).join("\n")}constructor(e,t){this.error=e,this.appCore=t}get isManaged(){return!1}get isDisplayMessage(){return!0}get canBeMerged(){return!1}fixPayload(){}fixOptions(){}}class n extends t{static buildErrorMsg(e,t){const r=e.filter(e=>e instanceof n);if(!r.length)return"";const s=[];r.forEach(e=>{const t=(e.unkMeta?e.unkMeta.split(","):[]).map(e=>e.trim());s.push(...t)});const{i18nManager:i,dicoService:o}=t,a=i?i.get("error.Expand.unknownAttribute"):"unknown attribute(s): {unknownMetas}",l=o?o.getColumnsNLSFromSelectables(s):s;return a.replace("{unknownMetas}",l.join(", "))}constructor(e,t){super(e,t),this.unkMeta=null}get isManaged(){return"string"==typeof this.unkMeta&&""!==this.unkMeta.trim()}fixPayload(e){const{select_bo:t,select_rel:n}=e||{},r=e=>{return-1===this.unkMeta.replace(/\s+/g,"").split(",").indexOf(e)},s={...e};return Array.isArray(t)&&(s.select_bo=t.filter(r)),Array.isArray(n)&&(s.select_rel=n.filter(r)),s}}class r extends n{static isA(e,t){if(-1===["cv_expand_v2","multiexpand_v2"].indexOf(t))return!1;const{code:n}=e;return"UNKNOWN_META"===n}constructor(e,t){super(e,t);const{reason:n}=e;if("string"!=typeof this.unkMeta||!this.unkMeta.trim()){const e=/(Meta not found:)/g,t=n.search(e);-1!==t&&(this.unkMeta=-1!==t?n.substring(t+"Meta not found:".length).trim():null)}if("string"!=typeof this.unkMeta||!this.unkMeta.trim()){const e=/\[(.+)\]/g,[t]=n.match(e)||[];"string"==typeof t&&t.trim()&&(this.unkMeta=t.slice(1,t.length-1))}}}class s extends t{static isA(e,t){if(-1===["cv_expand_v2","multiexpand_v2"].indexOf(t))return!1;const{code:n}=e;return"UNKNOWN_PHYSICAL_ID"===n||"INVALID_PATH"===n||"INVALID_ROOT"===n}get isDisplayMessage(){return!this.hasBeenFixed}static buildErrorMsg(){return""}get isManaged(){const e=this.appCore.sessionManager.isUsingDB(),t=this.appCore.sessionManager.shouldShowFinalItems(),n=this.appCore.sessionManager.shouldShowLeafMaterials();return!e&&!t&&!n}get canBeMerged(){return!0}fixOptions(t){return this.appCore.sessionManager.isUsingDB()?t:(this.hasBeenFixed=!0,this.appCore.sessionManager.setAuthoringMode("authoring"),{...t,executor:e.COMMAND_WS_EXPAND_DB})}}return class{constructor(e){this.errors=[],this.appCore=e?e.core:null,this.i18nManager=e&&e.core?e.core.i18nManager:null,this.dicoService=e&&e.core?e.core.dicoService:null,this.ErrorsCtr=[r,s]}get managedErrorClasses(){return{CV2UnknownMeta:r,CV2UnknownPhysicalid:s,ExpandError:t}}get hasErrors(){return this.errors.length>0}get hasErrorsToBeDisplayed(){return this.errors.filter(e=>e.isDisplayMessage).length>0}get canErrorsBeFixed(){return!!this.errors.length&&!(-1!==this.errors.findIndex(e=>!e.isManaged))}fixPayload(e){if(!e)return e;let t=e;return this.errors.forEach(e=>{t=e.fixPayload(t)}),t}fixOptions(e){if(!e)return e;let t=e;return this.errors.forEach(e=>{t=e.fixOptions(t)}),t}buildErrorMessage(e=!0){const n=this.errors.filter(e=>e.isDisplayMessage);if(!n.length)return"";const r=[],s=[];if(n.forEach(e=>{e.constructor.name!==t.name?r.push(e):s.push(e)}),s.length&&e)return"";let i="";if(r.length&&this.ErrorsCtr.forEach(e=>{const t=e.buildErrorMsg(r,{i18nManager:this.i18nManager,dicoService:this.dicoService});"string"==typeof t&&t.trim().length&&(i+=t)}),s.length&&!e){const e=t.buildErrorMsg(s);"string"==typeof e&&e.trim().length&&(i+=`\n${e}`)}return i}addNewErrors(e,n){Array.isArray(e)&&e.length&&e.forEach(e=>{const r=this.ErrorsCtr.find(t=>t.isA(e,n))||t,s=new r(e,this.appCore);s.canBeMerged&&-1!==this.errors.findIndex(e=>e instanceof r)||this.errors.push(s)})}}}),define("DS/ENOXEngineerCommonUtils/PromiseUtils",["UWA/Promise","DS/ENOXEngineerCommonUtils/CancelablePromise"],function(e,t){"use strict";return{wrappedWithPromise:function(t){return new e(t)},wrappedWithCancellablePromise:function(e){return new t(e)},allSettled:function(t){return e.allSettled(t)},all:function(t){return e.all(t)}}}),define("DS/ENOXEngineerCommonUtils/XENPlatform3DXSettings",["UWA/Core","UWA/Class","DS/WAFData/WAFData","DS/ENOXEngineerCommonUtils/PromiseUtils","DS/ENOXEngineerCommonUtils/XENCommonConstants","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext","DS/ENOXEngineerCommonUtils/xEngAlertManager","text!DS/ENOXEngineerCommonUtils/assets/config/commonConf.json"],function(e,t,n,r,s,i,o,a,l){"use strict";var u=JSON.parse(l);return{_isPlatformDataInitialized:!1,_platforms:null,_user:null,_discoveringPlatformPromise:null,getCommand:function(t){return e.is(t,"string")&&e.is(u.commands[t])?u.commands[t]:null},getLanguage:function(){return widget.lang&&widget.lang.length>1?widget.lang:"en"},_checkRoles:function(e){var t=this.getPlatformId();if(!Array.isArray(e)||!Array.isArray(this.roles))return!1;for(var n=0;n<e.length;n++)for(var r=0;r<this.roles.length;r++)if(this.roles[r].id===e[n]&&t&&this.roles[r].platforms&&-1!==this.roles[r].platforms.indexOf(t))return!0;return!1},isConfigRoleGranted:function(){return this._checkRoles(["CDN","CFG","CH2","CH5","CMM","COD","COX","CTP","DPM","EEW","GLR","MBO","PDA","PDM","QUM","REM","SAZ","SDZ","SMZ","SPJ","SPM","SPV","TRM","UWE","UWU","UXG","UWG","InternalDS"])},getWidgetId:function(){try{return widget&&widget.id?widget.id:"widget-odt"}catch(e){return"widget-odt"}},switchPlatformId:function(e){return!(!e||!e instanceof String)&&(widget.setValue("x3dPlatformId",e),this._platformId=e,a.sucessAlert(this.app.core.i18nManager.get("platform-changed")),!0)},setPlatformId:function(e){!e||!e instanceof String||(this._platformId=e)},getPlatformId:function(){if(this._platformId)return this._platformId;try{return widget&&(this._platformId=widget.getValue("x3dPlatformId")?widget.getValue("x3dPlatformId"):this._getAlternativePlatformId()),this._platformId}catch(e){return"OnPremise"}},isTenantBasedService:function(e){return u.tenantBasedServices.indexOf(e)>=0},isCloud:function(){var e=!0;return"OnPremise"===this.getPlatformId()&&(e=!1),e},_getAlternativePlatformId:function(){return this._platforms.OnPremise?"OnPremise":this.isWebInWinEnvironment()?(this._platformId=this.getUrlParameter("tenant")||"OnPremise",this._platformId):null},bindCommandsToABackend:function(e){var t=this;return t.bindCommandPromise?t.bindCommandPromise:(t.bindCommandPromise=r.wrappedWithPromise(function(n,r){t.discoverRelated3DXPlatform().then(function(){if(!e)return n(!0);t.retrieveUserPreferredSC().then(function(){n(!0)}).catch(function(e){console.error(e),r(!1)})}).catch(function(){r(!1)})}),t.bindCommandPromise)},isRelatedPlatformSet:function(){return this._isPlatformDataInitialized},discoverRelated3DXPlatform:function(){var e=this;return e._discoveringPlatformPromise?e._discoveringPlatformPromise:(e._discoveringPlatformPromise=r.wrappedWithPromise(function(t,n){e.getAllPlatforms().then(function(){e.loadCurrentUserRoles().then(function(){e.retrieveCurrentUser().then(function(){e._isPlatformDataInitialized=!0,t(!0)},function(e){let t="Error retrieveCurrentUser "+e;console.log(t),n(t)})},function(e){let t="Error loadCurrentUserRoles "+e;console.log(t),n(t)})},function(e){let t="Error getAllPlatforms"+e;console.log(t),n(t)})}),e._discoveringPlatformPromise)},retrieveUserPreferredSC:function(){var e=this;return r.wrappedWithPromise(function(t,r){e.discoverRelated3DXPlatform().then(function(){var s=u&&u.commands?u.commands.getPreferredSC:null;if(!s)return r();if(e._preferredSC)return t(e._preferredSC);var i=e.getServiceURL(s.targetService)+s.url+"?tenant="+e.getPlatformId();n.authenticatedRequest(i,{method:"GET",type:"json",onComplete:function(n){if(n)return e._preferredSC=n.SecurityContext,t();r()},onFailure:function(){return r()}})}).catch(function(){r()})})},hasSecurityContext:function(){return this.getSecurityContext()},setDefaultSecurityContext:function(e){this._sc=e},getPreferredSC:function(){return this._preferredSC},getSecurityContext:function(){return this._sc?this._sc:this.getPreferredSC()},getSecurityToken:function(){return(this.getCurrentUser()||{}).id+"|ctx::"+this.getSecurityContext()+"|preferred"},securityContextPromise:null,getDefault3DSpaceUrl:function(){return this.getServiceURL(s.SERVICE_3DSPACE_NAME)},getDefault3DSearchUrl:function(){return this.getServiceURL(s.SERVICE_3DSEARCH_NAME)},get3DCompassUrl:function(){return this.getServiceURL(s.SERVICE_3DCOMPASS_NAME)},get6wTagURL:function(){return this.getServiceURL(s.SERVICE_6WTAGS_NAME)},getDefault3DSpaceURI:function(e){var t=this.getDefault3DSpaceUrl();return t.substring(0,t.indexOf("/"+s.SERVICE_3DSPACE_NAME))},getServiceURL:function(e,t){return t=t||this.getPlatformId(),this._platforms&&this._platforms[t]&&this._platforms[t][e]?this._platforms[t][e]:null},getAuthorizedChange:function(){return this.authorizedChange=o.get(),this.authorizedChange},isChangeAuthorized:function(){var e=this.getAuthorizedChangeId();return null!=e&&""!=e},getAuthorizedChangeId:function(){let e=this.getAuthorizedChange();return e&&e.change?e.change.id:null},getCurrentUser:function(){return this._user},getUserName:function(){var e=this._user;return e?e.firstName+" "+e.lastName:""},getWorkUnderHeaders:function(){return this.getAuthorizedChange(),this.authorizedChange&&this.authorizedChange.AuthoringContextHeader?Object.assign({},this.authorizedChange.AuthoringContextHeader):{}},getAppId:function(){try{return widget&&widget.getValue("x3dAppId")?widget.getValue("x3dAppId"):""}catch(e){return""}},getAllPlatforms:function(){var t=this;return r.wrappedWithPromise(function(n,r){i.getPlatformServices({onComplete:function(s){let o=[],a=[];s.length>0&&s[0].platformId&&(s.forEach(function(e){let t=e.platformId,n=e.displayName;o.push({platformId:t,value:t,label:n})}),t.configuredTenantList=o);var l=!1;if("undefined"!=typeof widget&&o&&o.length>1){var u=o[0].platformId;u&&-1===["OnPremise"].indexOf(u)&&(console.count("checkAppInfo"),l=!0)}l&&i.getAppInfo({appId:t.getAppId(),onComplete:function(e){var n=!(!e||!e.tenantAware)&&e.tenantAware;if(n){for(var r=0;r<e.platforms.length;r++)for(var s=0;s<o.length;s++)if(!n||o[s].platformId===e.platforms[r].id){a.push(o[s]);break}t.configuredTenantList=a}else t.configuredTenantList=o},onFailure:function(e){console.error("Cannot retrieve the App Info"),callback({success:!1})}});var c=function(t){if(e.is(t,"array")&&t.length>0){var n={};return t.forEach(function(e){n[e.platformId]=e}),n}return null}(s);if(null===c)return r("cannot retrieve platform data");t._platforms=c,n(c)},onFailure:r})})},retrieveCurrentUser:function(){var e=this;return r.wrappedWithPromise(function(t,n){if(e._user&&e._user.id)return t(e._user);i.getUser({onComplete:function(n){e._user={id:n.id,email:n.email,firstName:n.firstname,lastName:n.lastname},t(e._user)},onFailure:n})})},loadCurrentUserRoles:function(){var e=this;return r.wrappedWithPromise(function(t,n){i.getGrantedRoles(function(n){e.roles=n,t(n)})})},isNatifEnvironnement:function(){return"undefined"!=typeof dscef},isWebInWinEnvironment:function(){return this.isCatiaV6Environment()||this.isCatiaV5Environment()||this.isSolidworksEnvironment()},isBuildSecurityContext:function(){return this.isCatiaV6Environment()||1==this.getUrlParameter("BuildSecurityContextforCloud")||"true"==this.getUrlParameter("BuildSecurityContextforCloud")},isCatiaV6Environment:function(){return"catiav6"===this._getEnvironment()},isCatiaV5Environment:function(){return"catiav5"===this._getEnvironment()},isSolidworksEnvironment:function(){return"solidworks"===this._getEnvironment()},_getEnvironment:function(){return this.getUrlParameter("addinmode")},getUrlParameter:function(e){return this._getUrlParameters()[e]},_getUrlParameters:function(){if(!this.storedUrlParams){var e={},t=[window.top.location];window!==window.top&&t.push(window.location),t.forEach(function(t){try{t&&t.search}catch(e){return void console.log(e)}t.search.substr(1).split("&").forEach(function(t){var n=t.split("=");n.length>1&&(e[n[0]]=n[1])})}),this.storedUrlParams=e}return this.storedUrlParams}}}),define("DS/ENOXEngineerCommonUtils/XENWebInWinHelper",["UWA/Core","UWA/Class","DS/WebToWinInfra/WebToWinCom","DS/ENOXEngineerCommonUtils/XENPlatform3DXSettings"],function(e,t,n,r){"use strict";return t.singleton({init:function(e){this._parent(e)},initializeSocket:function(){r.isWebInWinEnvironment()&&this.getSocket()},createWebInWinSocket:function(e){return n.createSocket({socket_id:e})},getSocket:function(){return this.socket?this.socket:(this.socket=this.createWebInWinSocket("xen_web_in_win"),this.socket)},closePanel:function(e){r.isWebInWinEnvironment()&&(1==e&&r.isCatiaV6Environment()?this.getSocket().dispatchEvent("onDispatchToWin",{notif_name:"errorThrown",notif_parameters:"errorThrown"},"xen_web_in_win"):this.getSocket().dispatchEvent("onDispatchToWin",{notif_name:"ClosePanel",notif_parameters:"ClosePanel"},"xen_web_in_win"))},notifyUpdatedEnterpriseItem:function(e){r.isWebInWinEnvironment()&&this.getSocket().dispatchEvent("onDispatchToWin",{notif_name:"engineering/setPartNumber",notif_parameters:JSON.stringify({action:"engineering/setPartNumber",Args:[{Name:"response",Value:e}]})},"xen_web_in_win")},commandViewReady:function(){r.isWebInWinEnvironment()&&this.getSocket().dispatchEvent("onDispatchToWin",{notif_name:"engineering/viewready",notif_parameters:JSON.stringify({action:"engineering/viewready",Args:[{Name:"status",Value:"up"}]})},"xen_web_in_win")}})}),define("DS/ENOXEngineerCommonUtils/QuantityHelper/PreferredUnitColumnProviderInputFactory",["DS/ENOXEngineerCommonUtils/XENCommonConstants"],e=>{const t=function({pid:e,sixw:t,value:n,dimension:r,toUnit:s}){return{pid:e,sixw:t,value:n,dimension:r,toUnit:s}};return class{static createAMassInput({physicalid:n,ds6w:r,value:s}){return t({pid:n,sixw:r,value:s,dimension:e.DIMENSION_MASS,toUnit:widget.getValue(e.PREFERRED_MASS_UNIT)})}static createAVolumeInput({physicalid:n,ds6w:r,value:s}){return t({pid:n,sixw:r,value:s,dimension:e.DIMENSION_VOLUME,toUnit:widget.getValue(e.PREFERRED_VOLUME_UNIT)})}static createALengthInput({physicalid:n,ds6w:r,value:s}){return t({pid:n,sixw:r,value:s,dimension:e.DIMENSION_LENGTH,toUnit:widget.getValue(e.PREFERRED_LENGTH_UNIT)})}static createAnAreaInput({physicalid:n,ds6w:r,value:s}){return t({pid:n,sixw:r,value:s,dimension:e.DIMENSION_AREA,toUnit:widget.getValue(e.PREFERRED_AREA_UNIT)})}}}),define("DS/ENOXEngineerCommonUtils/expand/CV2PayloadFactory",["UWA/Core","DS/ENOXEngineerCommonUtils/expand/ExpandPayloadFactoryUtils","DS/ENOXEngineerCommonUtils/expand/ProgressiveExpand","DS/ENOXEngineerCommonUtils/XENCommonConstants"],(e,t,n,r)=>{const{AbstractPayloadFactory:s,fixUqlWithCloudViewFormat:i,appendUqlValue:o}=t;return class extends s{constructor(){super(),this.query=new n.Query,this.updateEltList=[]}addEltToUpdate(e,t){Array.isArray(this.updateEltList)||(this.updateEltList=[]),Array.isArray(e[Symbol.for("update")])||(e[Symbol.for("update")]=[],this.updateEltList.push(e)),e[Symbol.for("update")].push(t)}addEltForUpdate(e,t){this.eltForUpdateList||(this.eltForUpdateList={}),this.eltForUpdateList[e]=t}finalize(){this.updateEltList.forEach(e=>{e[Symbol.for("update")].forEach(e=>e(this.eltForUpdateList))}),this.updateEltList=[];const{outputs:e}=this;if(e.format=n.ENUM_OUTPUT_FORMAT.entity_relation_occurrence,!Reflect.has(this,"skipValidFilterCheck")){const{expands:e}=this.query.batch;e.forEach(e=>{e.getImplKey("filter")||(e.filter.all=1)})}}get json(){return this.finalize(),this.query.json}get name(){return r.COMMAND_WS_EXPAND_CV_V2}get currentExpand(){const{expands:e}=this.query.batch;if(!e.length){const{Expand:t}=n;e.push(new t)}return e}get outputs(){return this.query.outputs}set multi_root_physicalid(e){e.forEach(e=>{const{Expand:t}=n,r=new t;r.root.physical_id=e,this.query.batch.expands.push(r)})}set no_type_filter_rel(e){this.currentExpand.forEach(t=>{const{descending_condition_relation:n}=t.graph;let r=null;Array.isArray(e)?r=e.map(e=>`NOT (flattenedtaxonomies:"reltypes/${e}")`).join(" OR "):"string"==typeof e&&(r=`NOT (flattenedtaxonomies:"reltypes/${e}")`),n.uql=o(n.uql,r,"AND")})}set type_filter_rel(e){this.currentExpand.forEach(t=>{const{descending_condition_relation:n}=t.graph;let r=null;Array.isArray(e)?r=e.map(e=>`(flattenedtaxonomies:"reltypes/${e}")`).join(" OR "):"string"==typeof e&&(r=`(flattenedtaxonomies:"reltypes/${e}")`),n.uql=o(n.uql,r,"AND")})}set compute_select_bo(e){const t=e.map(e=>{let t=e;switch(e){case"thumbnail_2d":t="urlstream|thumbnail_2d|2dthb|allrefs";break;case"icon":t="icons"}return t});this.outputs.hits.predefined_computation=t}set expand_iter(t){const r=parseInt(t,10);Number.isNaN(r)?console.error("expand_iter expand level cannot be computed"):-1!==r&&this.currentExpand.forEach(t=>{const s=new n.Truncate;s.max_distance_from_prefix=r;const i=new n.Aggregation_Processor;i.truncate=s,t.aggregation_processors.push(i),this.addEltToUpdate(s,r=>{if(r&&Reflect.has(r,"truncate_prefix_filter"))s.prefix_filter=r.truncate_prefix_filter.prefix_filter;else if(r&&Reflect.has(r,"truncate_or_filter"))s.or=r.truncate_or_filter.or;else if(e.is(t.root.physical_id)){const e=new n.Path;e.physical_id_path=[t.root.physical_id];const r=new n.Filter;r.prefix_filter.prefix_path.push(e),s.prefix_filter=r.prefix_filter}})})}set select_bo(e){this.outputs.select_object=e}set select_rel(e){this.outputs.select_relation=e}set label(e){this.currentExpand.forEach(t=>{t.label=e})}set"q.iterative_filter_query_bo"(e){this.currentExpand.forEach(t=>{const{descending_condition_object:n}=t.graph;n.uql=o(n.uql,e,"AND")})}set root_physicalid(e){this.currentExpand.forEach(t=>{t.root.physical_id=e})}set root_path_physicalid(e){this.currentExpand.forEach(t=>{if(Array.isArray(e)&&e.length){const r=e.map(e=>{const t=new n.Path;t.physical_id_path=e;const r=new n.Filter;return r.prefix_filter.prefix_path.push(t),r});if(r.length>1){const e=new n.Filter;e.or.filters.push(...r),t.filter.and.filters.push(e),this.addEltForUpdate("truncate_or_filter",e)}else 1===r.length&&(t.filter.and.filters.push(r[0]),this.addEltForUpdate("truncate_prefix_filter",r[0]));if(!t.getImplKey("root")){const[n]=e[0];t.root.physical_id=n}}})}set paths(t){let n=null;if(Array.isArray(t)&&t.length){const e=t[0];Array.isArray(e)&&e.length&&([n]=e)}if(!e.is(n))throw new Error("wrong root");this.root_physicalid=n}set max_count_path(e){this.currentExpand.forEach(t=>{let n=e;Number.isInteger(e)||(n=Number.parseInt(e,10)),t.parameters.limit_max_path=n})}set config_filter(e){this.currentExpand.forEach(t=>{const r=new n.Filter;t.filter.and.filters.push(r),r.config_filter=e})}set find_in_context(e){const t=new n.SequenceFilter;e.forEach(e=>{const r=e["q.query"];if("string"!=typeof r||""===r.trim())return;const s=new n.Graph_Expression;s.uql=i(r),t.sequence.push(s)}),this.currentExpand.forEach(e=>{const r=new n.Filter;r.sequence_filter=t,e.filter.and.filters.push(r);const s=new n.Aggregation_Processor;s.truncate.sequence_filter=t,e.aggregation_processors.push(s)})}set sequence_filter(e){Array.isArray(e)&&e.length&&this.currentExpand.forEach(t=>{e.forEach(e=>{const{definition:r,option:s}=e;Array.isArray(r)&&r.length&&r.forEach((e,r)=>{const i=new n.Filter;if(Array.isArray(s)&&s[r])switch(s[r]){case"seq_remove":case"seq_cut ":{const e=new n.Filter;t.filter.and.filters.push(e);const r=new n.Filter;r.all=1,e.and_not.left=r,e.and_not.right=i;break}default:t.filter.and.filters.push(i)}else t.filter.and.filters.push(i);(Array.isArray(e)?e:[e]).forEach(e=>{const t=new n.Filter;i.and.filters.push(t);const r=[];Array.isArray(e.type_filter_rel)&&e.type_filter_rel.forEach(e=>{r.push(`(flattenedtaxonomies:"reltypes/${e}")`)}),Array.isArray(e.type_filter_bo)&&e.type_filter_bo.forEach(e=>{r.push(`(flattenedtaxonomies:"reltypes/${e}")`)});let s="";r.length&&(s=o("",`(${r.join(" OR ")})`)),Reflect.has(e,"q.query")&&(s=o(s,e["q.query"],"AND"));const a=new n.Graph_Expression;a.uql=s,t.sequence_filter||(t.sequence_filter=new n.SequenceFilter),t.sequence_filter.sequence.push(a)})})})})}}}),define("DS/ENOXEngineerCommonUtils/QuantityHelper/EngItemModelQuantityHelper",["DS/ENOXEngineerCommonUtils/QuantityHelper/QuantityHelperUtils"],e=>{const{isAValidValue:t}=e,n=e=>`${e}_converted`;return class{constructor(e){this.model=e}get options(){return this.model.options}getID(){return this.model.getID()}getConvertedOrMKSValueForRel(e){const n=this.getConvertedValueForRel(e);if(t(n))return n;const r=this.getMKSValueForRel(e);return t(r)?r:""}getConvertedValueForRel(e){const t=n(e);return this.getValueForRel(t)}getFirstValueFromRels(e){if(!Array.isArray(e))throw new Error("wrong input");const n=e.find(e=>{const n=this.getConvertedOrMKSValueForRel(e);return t(n)});return n?{rel:n,value:this.getConvertedOrMKSValueForRel(n)}:{rel:"",value:""}}getFirstMKSValueFromRels(e){if(!Array.isArray(e))throw new Error("wrong input");const n=e.find(e=>{const n=this.getMKSValueForRel(e);return t(n)});return n?{rel:n,value:this.getMKSValueForRel(n)}:{rel:"",value:""}}getMKSValueForRel(e){return this.getValueForRel(e)}getValueForRel(e){return this.options.grid[e]}}}),define("DS/ENOXEngineerCommonUtils/expand/CVPayloadFactory",["UWA/Core","DS/ENOXEngineerCommonUtils/XENCommonConstants","DS/ENOXEngineerCommonUtils/expand/ExpandPayloadFactoryUtils"],(e,t,n)=>{const{defaultProperties:r,AbstractPayloadFactory:s}=n,i=[...r];return class extends s{constructor(){super(),this.payload={},n.definePropertiesOnObject(this,i,{getterFct:"getKey",setterFct:"setKey"})}get name(){return t.COMMAND_WS_EXPAND_CV}setKey(e,t){this.payload[e]=t}getKey(e){return Reflect.has(this,e)||console.error(`unable to retreive ${e} on ${this.name}`),this.payload[e]}get json(){return this.payload}}}),define("DS/ENOXEngineerCommonUtils/XENTracker",["DS/Usage/TrackerAPI","DS/ENOXEngineerCommonUtils/XENPlatform3DXSettings"],(e,t)=>{const n=["XENG_UPDATE_WIDGET_TITLE"],r=["/cvservlet/multiexpand","/cvservlet/expand","/cvservlet/progressiveexpand/v2","/resources/enoauthoring/expand/v1"];return class{static trackCommandLaunched(e,t){if(n.some(t=>t===e))return;const r=this.buildPersFromViewOptions(t);this.trackPageEvent({eventCategory:"command",eventAction:e,eventLabel:e,...r})}static trackQueryResponse(e,t,n){try{const s=e.split("?")[0];r.some(e=>e===s)&&this.trackPageEvent({eventCategory:"query_expand",eventAction:t,eventLabel:s,eventValue:n})}catch(e){}}static buildPersFromViewOptions(e){if(!e)return{};const t=t=>e[t]?1:0;return{persVal:{pv1:t("flat"),pv2:t("leaves"),pv3:t("reference"),pv4:t("specDoc"),pv5:t("notInBom"),pv6:t("madeFrom"),pv7:t("deformable"),pv8:t("rep3D"),pv9:t("manufOnly")}}}static trackCurrentView(e){const t=this.buildPersFromViewOptions(e);this.trackPageEvent({eventCategory:"viewOptions",eventAction:"Open_Reload",eventLabel:null,eventValue:null,...t})}static trackPageEvent(n){const r={...n,appID:t.getAppId(),tenant:t.getPlatformId()};e.trackPageEvent(r)}}}),define("DS/ENOXEngineerCommonUtils/QuantityHelper/EngItemModelRawQuantityHelper",["DS/ENOXEngineerCommonUtils/QuantityHelper/EngItemModelQuantityHelper","DS/ENOXEngineerCommonUtils/XENCommonConstants","DS/ENOXEngineerCommonUtils/QuantityHelper/QuantityHelperUtils","DS/ENOXEngineerCommonUtils/QuantityHelper/PreferredUnitColumnProviderInputFactory"],(e,t,n,r)=>{const{isAValidValue:s,hasQuantity:i}=n,o=[t.CONT_RAWMAT_QUANTITY_VOLUME,t.CONT_RAWMAT_QUANTITY_VOLUME_INST],a=[t.CONT_RAWMAT_QUANTITY_MASS,t.CONT_RAWMAT_QUANTITY_MASS_INST],l=[t.CONT_RAWMAT_QUANTITY_AREA,t.CONT_RAWMAT_QUANTITY_AREA_INST],u=[t.CONT_RAWMAT_QUANTITY_LENGTH,t.CONT_RAWMAT_QUANTITY_LENGTH_INST],c=[t.CONT_RAWMAT_QUANTITY_ASREQ,t.CONT_RAWMAT_QUANTITY_ASREQ_INST],h=[t.CONT_RAWMAT_QUANTITY_MASS_INST,t.CONT_RAWMAT_QUANTITY_VOLUME_INST,t.CONT_RAWMAT_QUANTITY_AREA_INST,t.CONT_RAWMAT_QUANTITY_LENGTH_INST,t.CONT_RAWMAT_QUANTITY_ASREQ_INST];return class extends e{isDirectRawMatConsumption(){return-1!==h.findIndex(e=>{const t=this.getConvertedOrMKSValueForRel(e);return!!s(t)||"boolean"==typeof t&&t})}hasConvertedValue(){return!![...a,...o,...l,...u].find(e=>{const t=this.getConvertedValueForRel(e);return s(t)})}getRawMatMassQuantity(){const{value:e}=this.getFirstValueFromRels(a);return e}getRawMatVolumeQuantity(){const{value:e}=this.getFirstValueFromRels(o);return e}getRawMatAreaQuantity(){const{value:e}=this.getFirstValueFromRels(l);return e}getRawMatLengthQuantity(){const{value:e}=this.getFirstValueFromRels(u);return e}hasRawMatVolumeQuantity(){const e=this.getRawMatVolumeQuantity();return i(e)}hasRawMatAreaQuantity(){const e=this.getRawMatAreaQuantity();return i(e)}hasRawMatMassQuantity(){const e=this.getRawMatMassQuantity();return i(e)}hasRawMatLengthQuantity(){const e=this.getRawMatLengthQuantity();return i(e)}hasRawMatAsRequired(){return-1!==c.findIndex(e=>{let t=!1;const n=this.getValueForRel(e);return"boolean"==typeof n?t=n:"string"==typeof n&&(t="TRUE"===n.toUpperCase()),t})}getMKSAttributesToConvert(){const e=[];if(this.hasRawMatVolumeQuantity()){const{rel:t,value:n}=this.getMKSRawMatVolumeAttribute();if(s(n)){const s=this.getID(),i=r.createAVolumeInput({physicalid:s,ds6w:t,value:n});e.push(i)}}if(this.hasRawMatMassQuantity()){const{rel:t,value:n}=this.getMKSRawMatMassAttribute();if(s(n)){const s=this.getID(),i=r.createAMassInput({physicalid:s,ds6w:t,value:n});e.push(i)}}if(this.hasRawMatAreaQuantity()){const{rel:t,value:n}=this.getMKSRawMatAreaAttribute();if(s(n)){const s=this.getID(),i=r.createAnAreaInput({physicalid:s,ds6w:t,value:n});e.push(i)}}if(this.hasRawMatLengthQuantity()){const{rel:t,value:n}=this.getMKSRawMatLengthAttribute();if(s(n)){const s=this.getID(),i=r.createALengthInput({physicalid:s,ds6w:t,value:n});e.push(i)}}return e}getMKSRawMatMassAttribute(){return this.getFirstMKSValueFromRels(a)}getMKSRawMatVolumeAttribute(){return this.getFirstMKSValueFromRels(o)}getMKSRawMatAreaAttribute(){return this.getFirstMKSValueFromRels(l)}getMKSRawMatLengthAttribute(){return this.getFirstMKSValueFromRels(u)}}}),define("DS/ENOXEngineerCommonUtils/QuantityHelper/EngItemModelMassOrVolumeQuantityHelper",["DS/ENOXEngineerCommonUtils/QuantityHelper/EngItemModelQuantityHelper","DS/ENOXEngineerCommonUtils/XENCommonConstants","DS/ENOXEngineerCommonUtils/QuantityHelper/QuantityHelperUtils","DS/ENOXEngineerCommonUtils/QuantityHelper/PreferredUnitColumnProviderInputFactory"],(e,t,n,r)=>{const{isAValidValue:s,hasQuantity:i}=n,o=[t.CONT_QUANTITY_VOLUME,t.DECLARED_VOLUME];return class extends e{getMassQuantity(){const e=this.getConvertedOrMKSValueForRel(t.CONT_QUANTITY_MASS);return s(e)?e:""}getMKSMassQuantity(){const e=this.getMKSValueForRel(t.CONT_QUANTITY_MASS);return s(e)?e:""}getVolumeQuantity(){const{value:e}=this.getFirstValueFromRels(o);return e}getMKSVolumeQuantity(){const{value:e}=this.getFirstMKSValueFromRels(o);return e}hasMassQuantity(){const e=this.getMassQuantity();return i(e)}hasVolumeQuantity(){const e=this.getVolumeQuantity();return i(e)}hasQuantity(){let e=!1;return this.hasMassQuantity()?e=this.hasMassQuantity():this.hasVolumeQuantity()&&(e=this.hasVolumeQuantity()),e}getMKSAttributesToConvert(){const e=[];if(this.hasMassQuantity()){const n=this.getMKSMassQuantity();if(s(n)){const s=this.getID(),i=r.createAMassInput({physicalid:s,ds6w:t.CONT_QUANTITY_MASS,value:n});e.push(i)}}if(this.hasVolumeQuantity()){const n=this.getMKSVolumeQuantity();if(s(n)){const s=this.getID(),i=r.createAVolumeInput({physicalid:s,ds6w:t.CONT_QUANTITY_VOLUME,value:n});e.push(i)}}return e}}}),define("DS/ENOXEngineerCommonUtils/QuantityHelper/EngItemRollupQuantity",["DS/ENOXEngineerCommonUtils/QuantityHelper/EngItemModelMassOrVolumeQuantityHelper","DS/ENOXEngineerCommonUtils/QuantityHelper/EngItemModelRawQuantityHelper","DS/ENOXEngineerCommonUtils/QuantityHelper/QuantityHelperUtils"],(e,t,n)=>{const{isAValidValue:r,asNumber:s,sum:i}=n,o=(e,t)=>{let n=e;if(r(t)){const r=s(t);if(n=i([e,r]),t.toString().includes(".")&&n%1==0){let e=t.split(".")[1].length;n=n.toFixed(e)}}return n},a=({volume:e,mass:t,area:n,length:r})=>({newVolume:e,newMass:t,newArea:n,newLength:r,mapResultsInto(e){e.volume=this.newVolume,e.mass=this.newMass,e.area=this.newArea,e.length=this.newLength}});return class{constructor(e,t){this.model=e,this.preferenceManager=t.PreferencesManager,this.i18nManager=t.i18nManager}getRollup(){let e="";return this.isCoreMaterialType?e=this.computeRollupForMassOrVolumeMaterial():this.isRawMaterialType?e=this.computeRollupForRawMaterial():this.isEngineeringItem&&(e=this.computeRollupForEngItem()),e}get isCoreMaterialType(){return this.model.isCoreMaterialType()}get isRawMaterialType(){return this.model.isRawMaterialType()}get isEngineeringItem(){return this.model.isEngineeringItem()}get nlsVolumeUnit(){return this.preferenceManager.getNLSValueForVolumeQuantity()}get nlsMassUnit(){return this.preferenceManager.getNLSValueForMassQuantity()}get nlsAreaUnit(){return this.preferenceManager.getNLSValueForAreaQuantity()}get nlsLengthUnit(){return this.preferenceManager.getNLSValueForLengthQuantity()}get nlsMakeFromAsRequired(){return this.i18nManager.get("makeFromAsRequired")}get usages(){const e="function"==typeof this.model.getUsages?this.model.getUsages():[];return Array.isArray(e)?e:[]}computeRollupForMassOrVolumeMaterial(){const e=this.computeRollupQuantityForMassOrVolumeMaterial();return this.buildRollupStatusForMassOrVolumeMaterial(e)}computeRollupQuantityForMassOrVolumeMaterial(){const t={volume:0,mass:0};return this.usages.forEach(n=>{const r=new e(n);if(r.hasVolumeQuantity()){const e=r.getVolumeQuantity();t.volume=o(t.volume,e)}if(r.hasMassQuantity()){const e=r.getMassQuantity();t.mass=o(t.mass,e)}}),t}buildRollupStatusForMassOrVolumeMaterial(e){const t=this.nlsVolumeUnit,n=this.nlsMassUnit;let r="";return e.mass&&e.volume?r=`${e.mass} ${n} + ${e.volume} ${t}`:e.mass?r=`${e.mass} ${n}`:e.volume&&(r=`${e.volume} ${t}`),r}computeRollupForRawMaterial(){const e=this.computeRollupQuantityForRawMaterial();return this.buildStatusForRawMaterial(e)}computeRollupQuantityForRawMaterial(){const e={volume:0,mass:0,area:0,length:0};return this.hasConvertedValue()?this.sumRawQuantityValuesForItem(this.model,{volume:e.volume,mass:e.mass,area:e.area,length:e.length}).mapResultsInto(e):this.sumRawQuantityValuesForUsages(this.usages,{volume:e.volume,mass:e.mass,area:e.area,length:e.length}).mapResultsInto(e),e}buildStatusForRawMaterial(e){const t=this.nlsVolumeUnit,n=this.nlsMassUnit,r=this.nlsAreaUnit,s=this.nlsLengthUnit;let i="";return e.mass?i=`${e.mass} ${n}`:e.volume?i=`${e.volume} ${t}`:e.area?i=`${e.area} ${r}`:e.length&&(i=`${e.length} ${s}`),this.hasRequiredFlag()&&(i=this.addRequiredFlagToRollup(i)),i}sumRawQuantityValuesForItem(e,n){const{volume:r,mass:s,area:i,length:l}=n,u=new t(e);let{volume:c,mass:h,area:d,length:p}=n;if(u.hasRawMatVolumeQuantity()){const e=u.getRawMatVolumeQuantity();c=o(r,e)}if(u.hasRawMatMassQuantity()){const e=u.getRawMatMassQuantity();h=o(s,e)}if(u.hasRawMatAreaQuantity()){const e=u.getRawMatAreaQuantity();d=o(i,e)}if(u.hasRawMatLengthQuantity()){const e=u.getRawMatLengthQuantity();p=o(l,e)}return a({volume:c,mass:h,area:d,length:p})}sumRawQuantityValuesForUsages(e,t){const n={volume:t.volume,mass:t.mass,area:t.area,length:t.length};return e.forEach(e=>{this.sumRawQuantityValuesForItem(e,{volume:n.volume,mass:n.mass,area:n.area,length:n.length}).mapResultsInto(n)}),a({volume:n.volume,mass:n.mass,area:n.area,length:n.length})}hasRequiredFlag(){return!!this.usages.find(e=>new t(e).hasRawMatAsRequired())}hasConvertedValue(){return!!new t(this.model).hasConvertedValue()}addRequiredFlagToRollup(e){const t=this.nlsMakeFromAsRequired;return r(e)?`${e}, ${t}`:`${t}`}computeRollupForEngItem(){const e=this.usages.length;return r(e)?`${e}`:""}}}),define("DS/ENOXEngineerCommonUtils/XENGenericHttpClient",["DS/ENOXEngineerCommonUtils/XENPlatform3DXSettings","DS/WAFData/WAFData","UWA/Json","DS/ENOXEngineerCommonUtils/PromiseUtils","DS/ENOXEngineerCommonUtils/XENCommonConstants","DS/ENOXEngineerCommonUtils/XENTracker"],function(e,t,n,r,s,i){"use strict";return{buildUrl:function(t){var n=e.getServiceURL(t.targetService);return e.isTenantBasedService(t.targetService)?n=this.decorateUrlWithTenant(n+t.url):n+=t.url,t.sc_tenant_in_url&&(n=this.decorateUrlWithSecuritycontext(n)),t.queryParameters&&(n=this.decorateUrlWithQueryParameters(n,t.queryParameters)),n},buildChangeHeaders:function(t){return Object.assign(t,e.getWorkUnderHeaders())},decorateUrlWithSecuritycontext:function(t){var n=e.getSecurityContext(),r=t||"";if(t&&n&&n.length>0){var s=r.indexOf("?");r=s>-1?r+"&SecurityContext="+encodeURIComponent("ctx::"+e.getSecurityContext()):r+"?SecurityContext="+encodeURIComponent("ctx::"+e.getSecurityContext())}return r},decorateUrlWithTenant:function(t){var n=t||"",r=n.indexOf("?");return n=r>-1?n+"&tenant="+e.getPlatformId():n+"?tenant="+e.getPlatformId()},decorateUrlWithQueryParameters:function(e,t){if("string"==typeof e&&Array.isArray(t)){e+=`&${t.join("&")}`}return e},decorateWithAddtionnaloptions:function(t,n){n.noSecurityContextNeeded||n.targetService!==s.SERVICE_3DSPACE_NAME||(t.headers.SecurityContext=encodeURIComponent("ctx::"+e.getSecurityContext()),t.headers.SecurityToken=encodeURIComponent(e.getSecurityToken()))},decorateWithCSRF:function(e,t){},perform:function(o,a,l){var u=this,c=null,h=r.wrappedWithCancellablePromise(function(r,d){var p=null;!function(e){if(!(e&&e.url&&e.method&&e.type&&e.targetService))throw new Error("the request is not valid !!")}(o),p="file"===o.type||o.useFormData?a:!UWA.is(a)||n.isJson(a)||UWA.is(a,"string")?a:n.encode(a);var m={method:o.method,cache:o.cache||!1,type:o.type,data:p,headers:{}};"json"===o.type?m.headers={Accept:"application/json","Content-Type":"application/json","Accept-Language":e.getLanguage()}:"xml"===o.type?m.headers={Accept:"application/xml","Content-Type":"application/xml","Accept-Language":e.getLanguage()}:"octet-stream"===o.type?m.headers={"Content-Type":"application/json","Accept-Language":e.getLanguage()}:"file"===o.type?m.headers={Accept:"application/json","Accept-Language":e.getLanguage()}:"text"===o.type&&(m.headers={"Content-Type":"application/x-www-form-urlencoded","Accept-Language":e.getLanguage()}),o.timeout&&(m.timeout=o.timeout),o.customHeaders&&(m.headers=Object.assign(m.headers,o.customHeaders)),o.noContentType&&delete m.headers["Content-Type"],u.decorateWithAddtionnaloptions(m,o),!0===o.isChangeControlled&&(m.headers=u.buildChangeHeaders(m.headers));var g=u.buildUrl(o);if(o.useCSRF){const{value:e}=l||{};"string"==typeof e&&e.trim().length&&(m.headers["X-Requested-With"]="csrf protection",m.headers["X-Request"]=e,m.headers.ENO_CSRF_TOKEN=e)}const f=Date.now();var _=function(e,t){i.trackQueryResponse(o.url,"Failure");var n={error:e,response:t};h&&delete h.xEngEmbeddedRequest,c=null,d(n)};m.onComplete=function(e){const t=Date.now()-f;i.trackQueryResponse(o.url,"Complete",t),h&&delete h.xEngEmbeddedRequest,c=null,r(e)},m.onFailure=_,m.onCancel=_,m.onTimeout=function(e,t){i.trackQueryResponse(o.url,"Timeout");var n={error:e,response:t,type:s.ERROR_TYPE_TIMEOUT};h&&delete h.xEngEmbeddedRequest,c=null,d(n)},c=t.authenticatedRequest(g,m)});return h.xEngEmbeddedRequest={cancel:function(e){c&&c.cancel(),c&&c.xhr&&c.xhr.timeoutTimer&&clearTimeout(c.xhr.timeoutTimer)}},h}}}),define("DS/ENOXEngineerCommonUtils/XENCommandsAppContextProxy",["DS/ENOXEngineerCommonUtils/XENPlatform3DXSettings","DS/ENOXEngineerCommonUtils/XENGenericHttpClient","DS/ENOXEngineerCommonUtils/PromiseUtils"],function(e,t,n){"use strict";return{getAppContextPromise:function(e){return n.wrappedWithPromise(function(t,n){return e?e.options&&e.options.context?t(e.options.context):(e.options||(e.options={}),void require(["DS/PADUtils/PADContext"],function(n){e.options.context=n.get(),t(e.options.context)},function(e){n(e)})):n(null)})},loadCommandsSetting:function(){if(this.commandsSettingsPromise)return this.commandsSettingsPromise;return this.commandsSettingsPromise=n.wrappedWithPromise(function(n,r){e.bindCommandsToABackend(!0).then(function(){var s=e.getCommand("get_command_settings");t.perform(s).then(function(e){return"string"==typeof e&&(e=JSON.parse(e)),n(e)}).catch(function(e){r(e)})})}),this.commandsSettingsPromise}}}),define("DS/ENOXEngineerCommonUtils/expand/DBPayloadFactory",["UWA/Core","DS/ENOXEngineerCommonUtils/XENCommonConstants","DS/ENOXEngineerCommonUtils/expand/ExpandPayloadFactoryUtils"],(e,t,n)=>{const{defaultProperties:r,AbstractPayloadFactory:s}=n,i=["types","extensions",...r];return class extends s{constructor(){super(),this.payload={},n.definePropertiesOnObject(this,i,{getterFct:"getKey",setterFct:"setKey"})}get name(){return t.COMMAND_WS_EXPAND_DB}setKey(e,t){this.payload[e]=t}getKey(e){return Reflect.has(this,e)||console.error(`unable to retreive ${e} on ${this.name}`),this.payload[e]}get json(){return this.payload}get entries(){return i}}}),define("DS/ENOXEngineerCommonUtils/expand/MultiCVPayloadFactory",["UWA/Core","DS/ENOXEngineerCommonUtils/XENCommonConstants","DS/ENOXEngineerCommonUtils/expand/ExpandPayloadFactoryUtils","DS/ENOXEngineerCommonUtils/expand/CVPayloadFactory"],(e,t,n,r)=>{const{defaultMultiProperties:s}=n;return class extends r{constructor(){super(),this.payload={},n.definePropertiesOnObject(this,s,{getterFct:"getKey",setterFct:"setKey"})}get name(){return t.COMMAND_WS_MULTIEXPAND}setKey(e,t){this.payload[e]=t}getKey(e){return Reflect.has(this,e)||console.error(`unable to retreive ${e} on ${this.name}`),this.payload[e]}get entries(){return[...super.entries,...s]}}}),define("DS/ENOXEngineerCommonUtils/expand/MultiCV2PayloadFactory",["UWA/Core","DS/ENOXEngineerCommonUtils/expand/CV2PayloadFactory","DS/ENOXEngineerCommonUtils/XENCommonConstants","DS/ENOXEngineerCommonUtils/expand/ProgressiveExpand","DS/ENOXEngineerCommonUtils/expand/ExpandPayloadFactoryUtils"],(e,t,n,r,s)=>{return class extends t{get name(){return n.COMMAND_WS_MULTIEXPAND_V2}get entries(){return[...super.entries,...s.defaultMultiProperties]}get currentExpand(){const e=super.currentExpand;return[e[e.length-1]]}set label(e){this.addEltToUpdate(this.query.batch,()=>{const{expands:t}=this.query.batch;t.length||t.push(new r.Expand),t.forEach(t=>t.label=e)})}set max_count_path(e){this.addEltToUpdate(this.query.batch,()=>{const{expands:t}=this.query.batch;t.length||t.push(new r.Expand),t.forEach(t=>{let n=e;Number.isInteger(e)||(n=Number.parseInt(e,10)),t.parameters.limit_max_path=n})})}set synthesis_mode(e){Reflect.has(r.ENUM_FACET_MODE,e)?this.addEltToUpdate(this.query.batch,()=>{const{expands:t}=this.query.batch;t.length||t.push(new r.Expand),t.forEach((t,n)=>{const s=new r.Aggregation_Processor;t.aggregation_processors.push(s),s.synthesis.name=`synthesis${n.toString()}`,s.synthesis.mode=e,s.synthesis.group_by_facet=1,s.synthesis.synthesis_only=1,this.query.outputs.synthesis.push(s.synthesis.name),this.query.outputs.facet_name="ds6w"})}):console.error(`synthesis_mode unknown mode ${e}`)}set union(e){const{expand:t}=e||{};t.forEach(e=>{this.query.batch.expands.push(new r.Expand),Reflect.ownKeys(e).forEach(t=>{super[t]=e[t]})})}extractTagsFromCVQueryV2IfValuated(e,t=["filter","aggregation_processors"]){if(!e||!Array.isArray(t))return null;const{batch:n}=e||{},{expands:r}=n||{};let s=null;Array.isArray(r)&&1===r.length&&([s]=r);const i={};return t.forEach(t=>{let n=null;Reflect.has(e,t)?n=e:s&&Reflect.has(s,t)&&(n=s);const r=n?n[t]:null;Array.isArray(r)&&r.length?i[t]=r:!Array.isArray(r)&&r&&(i[t]=r)}),Reflect.ownKeys(i).length?i:null}updatePayloadWithEntries(e,t){if(e&&t&&Reflect.has(t,"CVQueryV2")){const{CVQueryV2:n}=t,r=this.extractTagsFromCVQueryV2IfValuated(n);Reflect.ownKeys(r).forEach(t=>{const n=r[t];if("filter"===t)this.updatePayloadWithFilter(e,n);else{const{expands:r}=e.batch;r.forEach(e=>{e[t]=n})}})}}updatePayloadWithFilter(e,t){if(!e||!t)return;const{expands:n}=e.batch;n.forEach(e=>{const{filter:n}=e;if(n){const{and:r}=n;if(r){const{filters:e}=r;e.push({and:{filters:[t]}})}else e.filter={and:{filters:[n,t]}}}else e.filter=t})}updateAnswer(e){e&&!Reflect.has(e,"facets")&&Object.defineProperty(e,"facets",{get(){const{results:t}=e;if(!Array.isArray(t)||!t.length)return null;const{synthesis:n}=t[0]||{};return n&&Array.isArray(n.facets)?n.facets:null}})}}}),define("DS/ENOXEngineerCommonUtils/ExpandPayloadFactory",["UWA/Core","DS/ENOXEngineerCommonUtils/XENCommonConstants","DS/ENOXEngineerCommonUtils/expand/MultiCV2PayloadFactory","DS/ENOXEngineerCommonUtils/expand/MultiCVPayloadFactory","DS/ENOXEngineerCommonUtils/expand/CV2PayloadFactory","DS/ENOXEngineerCommonUtils/expand/CVPayloadFactory","DS/ENOXEngineerCommonUtils/expand/DBPayloadFactory"],(e,t,n,r,s,i,o)=>{const a=e=>{const t=Reflect.getPrototypeOf(e);e.entries.forEach(n=>{Reflect.has(e,n)||Object.defineProperty(e,n,{set(e){console.debug(`${t.name} => ${n} not implemented`)}})})};class l{static getInstance(l){let u=null;switch(l){case t.COMMAND_WS_MULTIEXPAND_V2:u=new n;break;case t.COMMAND_WS_MULTIEXPAND:u=new r;break;case t.COMMAND_WS_EXPAND_CV_V2:u=new s;break;case t.COMMAND_WS_EXPAND_CV:u=new i;break;case t.COMMAND_WS_EXPAND_DB:u=new o}return e.is(u)&&a(u),u}static convertPayloadTo(e,t){if("object"!=typeof e)throw new Error("invalid payload input");const n=l.getInstance(t);if(!n)throw new Error(`unknown executorType ${t}`);const r=["multi_root_physicalid","root_path","root_physicalid","root_path_physicalid","label"];r.forEach(t=>{Reflect.has(e,t)&&(n[t]=e[t])}),Reflect.ownKeys(e).filter(e=>-1===r.indexOf(e)).forEach(t=>{n[t]=e[t]});const s=n.json,{v2PayloadEntriesToAdd:i}=e;return Array.isArray(i)&&i.length&&i.forEach(e=>n.updatePayloadWithEntries(s,e)),s}static postTreatAnswer(e,t){if("object"!=typeof e)throw new Error("invalid payload input");const n=l.getInstance(t);if(!n)throw new Error(`unknown executorType ${t}`);n.updateAnswer(e)}}return l});