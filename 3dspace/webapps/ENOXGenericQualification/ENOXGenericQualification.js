define("DS/ENOXGenericQualification/config/appConfigurator",["i18n!DS/ENOXGenericQualification/assets/nls/ENOXGenericQualification"],function(e){"use strict";return{_controllersRoot:["DS/ENOXGenericQualification/controllers/"],_controllersList:[{name:"QualificationContextsController",label:"qualificationContextsController"},{name:"QualificationController",label:"qualificationController"}],_serviceViewControllersList:[],_viewControllersRoot:["DS/ENOXGenericQualification/controllers/"],_viewControllersList:[],routeControllersRoot:["DS/ENOXSourcingUXInfra/controllers/"],routeControllersList:[{name:"ListViewRouteController",label:"listViewRouteController"},{name:"DetailsViewRouteController",label:"detailsViewRouteController"}],widgetPreferences:[{name:"xsrcQualificationContext",type:"hidden",defaultValue:"[]"},{name:"xsrcQualificationContextListMaxSize",type:"list",label:e.qualification_contexts_max_size,defaultValue:"50",options:[{label:"20",value:"20"},{label:"50",value:"50"},{label:"100",value:"100"}]},{name:"xsrcQualificationTarget",type:"hidden",defaultValue:"[]"},{name:"xsrcQualificationTargetListMaxSize",type:"list",label:e.qualification_targets_max_size,defaultValue:"50",options:[{label:"20",value:"20"},{label:"50",value:"50"},{label:"100",value:"100"}]},{name:"defaultRoute",type:"hidden",defaultValue:"home.QualificationContextsView"},{name:"lastVisitedRouteName",type:"hidden",defaultValue:"xpflLastVisitedRoute"},{name:"progressViewTileTopAttribute",type:"list",label:e.progress_view_top_attribute,defaultValue:"state",onchange:"topAttributeChange",options:[{label:e.name,value:"name"},{label:e.status,value:"approved"},{label:e.MATURITY,value:"state"},{label:e.owner,value:"owner"},{label:e.modified_date,value:"modified"},{label:e.prerequisite,value:"prereq"},{label:e.extensionAttribute,value:"extension"}]},{name:"topPattern",type:"hidden",label:e.topPatternLabel,defaultValue:""},{name:"progressViewTileBottomAttribute",type:"list",label:e.progress_view_bottom_attribute,defaultValue:"approved",onchange:"bottomAttributeChange",options:[{label:e.name,value:"name"},{label:e.status,value:"approved"},{label:e.MATURITY,value:"state"},{label:e.owner,value:"owner"},{label:e.modified_date,value:"modified"},{label:e.prerequisite,value:"prereq"},{label:e.extensionAttribute,value:"extension"}]},{name:"bottomPattern",type:"hidden",label:e.bottomPatternLabel,defaultValue:""}],welcomePanelActivities:[{id:"actions",actions:[{id:"newQualification",nlsKey:"new_qualification",fonticon:"fonticon fonticon-plus",className:"action-new",isNotHighlightable:!0},{id:"QualificationContextsView",nlsKey:"my_qualification_contexts",fonticon:"fonticon fonticon-compass-services",className:"action-new"},{id:"QualificationTargetsView",nlsKey:"my_qualification_targets",fonticon:"fonticon fonticon-target",className:"action-new"}]}]}}),define("DS/ENOXGenericQualification/views/Qualification/NewQualification",["DS/ENOXSourcingUXInfra/components/ModalWindowWrapper/ModalWindowWrapper","DS/UIKIT/Scroller","DS/ENOXSourcingUXInfra/service/ENOXSourcingPlatformServices","DS/ENOXSourcingUXInfra/xsourcingformview/ENOXSourcingForm","i18n!DS/ENOXGenericQualification/assets/nls/ENOXGenericQualification","i18n!DS/ENOXSourcingUXInfra/assets/nls/ENOXSourcingUXInfra","DS/UIKIT/Mask","DS/UIKIT/Accordion","DS/UIKIT/Input/Text","DS/UIKIT/Input/Number","DS/UIKIT/Input/Date","DS/UIKIT/Input/Select","DS/UIKIT/SuperModal","DS/ENOXSourcingUXInfra/service/ENOXSourcingService","DS/ENOXSourcingUXInfra/Constants/ENOXSourcingConstants","DS/ENOXSourcingUXInfra/CommonUtils/CommonUtils","css!DS/ENOXGenericQualification/ENOXGenericQualification.css"],function(e,t,i,n,a,o,r,l,s,d,c,u,p,g,f,h){"use strict";var m=function(e){this.controller=e,this.form=null};return m.prototype.render=function(s,d){var c,u=this;s.qualType=f.TYPE_QUALIFICATION_LIST[2];var h="";widget.getValue(f.QUALIFICATION_CONTEXT_ALLOWED_TYPES).map(function(e){h+=' flattenedtaxonomies:"types/'+e+'"'+f.OR}),h=h.substring(0,h.length-3);var m="";widget.getValue(f.QUALIFICATION_TARGET_ALLOWED_TYPES).map(function(e){m+=' flattenedtaxonomies:"types/'+e+'"'+f.OR}),m=m.substring(0,m.length-3);var w=UWA.createElement("div",{id:"newQualification",class:"newQualification modalBodyDiv"});let b=s.postQualificationCreationRouteData?[s.postQualificationCreationRouteData.id]:[];if(this.form=new n({grid:"4,8",applicationChannel:s.applicationChannel,fields:[{type:"text",label:a.title,name:"title",placeholder:a.enter_title,isLengthy:!1,helperText:a.length_100_limit},...s.fromContextDetailsPage?[{type:"text",label:a.context,name:"context",value:d.contextItem.label,id:d.contextItem.id,identifier:d.contextItem.id,disabled:!0}]:[{type:"autocompleteWithSearch",multiSelect:!0,required:!0,label:a.context,placeholder:a.placeholder_context_or_target,errorText:a.errorText_context_item,name:"context",completePreCond:"( "+h+' )  AND ( NOT([ds6w:kind]:"'+f.MEI_EXTENSION+'") )',resourceid_not_in:b,showRevisionWithLabel:!0,typeSearch:widget.getValue(f.QUALIFICATION_CONTEXT_ALLOWED_TYPES),allowDrop:!0,sources:i.getPlatformId()===f.ONPREMISE?[f.SOURCE_3DSPACE]:[f.SOURCE_3DSPACE,f.SOURCE_SOURCING,f.SOURCE_3DPLAN],callback:async function(e){let t=e.options.form.wuxAutocompletes.filter(e=>"context"===e.options.name);if(t&&t[0].selectedItems.length>0){let e=t[0].selectedItems.map(e=>e.getAttributeValue("id")||e.getAttributeValue("physicalid")),i=await u.controller.helper.searchUtility.getNonIndexedObjectIds(e);i.length>0&&(widget.notificationUtil.showError(a.one_or_more_object_not_indexed),i.forEach(function(e){t[0].selectedItems=t[0].selectedItems.filter(t=>t._options.resourceid!==e)}))}},dropValidator:function(e){return new Promise(t=>{u.controller.qualificationContextsController.commonUtility.gettypeshierarchy(e).then(function(e){t(e.types_hierarchies[0].hierarchy.some(e=>widget.getValue(f.QUALIFICATION_CONTEXT_ALLOWED_TYPES).includes(e)))})})}}],...s.fromTargetDetailsPage?[{type:"text",label:a.target,name:"target",value:d.contextItem.label,id:d.contextItem.id,identifier:d.contextItem.id,disabled:!0}]:[{type:"autocompleteWithSearch",required:!0,label:a.target,placeholder:a.placeholder_context_or_target,errorText:a.errorText_target_item,width:"100px",name:"target",completePreCond:"( "+m+' )  AND ( NOT([ds6w:kind]:"'+f.MEI_EXTENSION+'") )',resourceid_not_in:b,showRevisionWithLabel:!0,typeSearch:widget.getValue(f.QUALIFICATION_TARGET_ALLOWED_TYPES),allowDrop:!0,sources:[f.SOURCE_3DSPACE],callback:async function(e){let t=e.options.form.wuxAutocompletes.filter(e=>"target"===e.options.name);if(t&&t[0].selectedItems){let e=[t[0].selectedItems.getAttributeValue("id")||t[0].selectedItems.getAttributeValue("physicalid")];(await u.controller.helper.searchUtility.getNonIndexedObjectIds(e)).length>0&&(widget.notificationUtil.showError(a.one_or_more_object_not_indexed),t[0].selectedItems=[])}},dropValidator:function(e){return new Promise(t=>{u.controller.qualificationContextsController.commonUtility.gettypeshierarchy(e).then(function(e){t(e.types_hierarchies[0].hierarchy.some(e=>widget.getValue(f.QUALIFICATION_TARGET_ALLOWED_TYPES).includes(e)))})})}}],{type:"autocompleteWithSearch",label:a.prereq,placeholder:a.placeholder,width:"100px",name:"prereq",typeSearch:[f.TYPE_QUALIFICATION_LIST[2]],excludeCondition:f.EXCLUDE_QUALIFICATION_OBSOLETE,showRevisionWithLabel:!0,sources:[f.SOURCE_SOURCING],callback:function(e){e.autocompleteField.selectedItems?(e.getInputField().setAttribute("identifier",e.autocompleteField.selectedItems._options.resourceid||e.autocompleteField.selectedItems._options.id),e.getInputField().value=e.autocompleteField.selectedItems._options["ds6w:label"],e.getInputField().id=e.autocompleteField.selectedItems._options.resourceid||e.autocompleteField.selectedItems._options.id):u.setFieldValuesEmpty(e.getInputField())}},...i.getPlatformId()===f.ONPREMISE?[{type:"autocomplete",label:a.add_extensions,autofocus:"autofocus",placeholder:o.SEARCH_AG,name:"Add Extensions",multiSelect:!0,showSuggestsOnFocus:!0,className:"src-multi-select-autocomplete",events:{onPostInject:function(){c=this,u.setDataSetForAutocomplete(s).then(function(e){var t=1;e.items.map(e=>{e.datasetId=c.datasets[0].id,e.id=c.datasets[0].id+"_"+t,t++}),c.datasets[0].items=e.items})},onClickOutside:function(){0===this.selectedItems.length&&(this.resetInput(),this.onHideSuggests())},onSelect:function(e){this.resetInput(),this.onHideSuggests(),this.elements.input.setAttribute("identifier",e.name),u.updateView(e,!0)},onUnselect:function(e){this.onHideSuggests(),u.updateView(e,!1)}},datasets:{configuration:{remoteSearchEngine:function(e,t){var i;return new Promise(function(n,a){u.setDataSetForAutocomplete(s).then(function(a){i={},e.items=a.items,""!==t&&(e.items=a.items.filter(e=>e.label.toLowerCase().includes(t.toLowerCase()))),i.dataset=e,i.matchingItems=i.dataset.items,n(i)},function(t){t.type="error",t.dataset=e,a(t)})})}}}}]:[]],events:{onSubmit:function(){let e=this,t=g.getSecurityContext().split(".");var n;if(n=e.FormValidations.wuxAutoCompleteValidation(e.wuxAutocompletes),i.getPlatformId()===f.ONPREMISE){let i=e.wuxAutocompletes.filter(e=>e.options.name===f.TARGET)[0],r=i?i.selectedItems._options["ds6w:project_value"]||i.selectedItems._options["ds6w:where/ds6w:context/ds6w:project"]:e.getField(f.TARGET).getAttribute("projectSpace"),l=i?i.selectedItems._options["ds6w:organizationResponsible_value"]||i.selectedItems._options["ds6w:who/ds6w:responsible/ds6w:organizationResponsible"]:e.getField(f.TARGET).getAttribute("organizationResponsible");if(n&&t&&(t[2]&&t[2]!==r||t[1]&&t[1]!==l))new p({renderTo:widget.body,className:""}).dialog({body:`<p>${a.security_context_alert_text}</p>`,title:"Alert!",buttons:[{className:"default",value:a.create_using_target,action:function(e){o(!0),e.hide()}},{className:"primary",value:a.create_using_widget_pref,action:function(e){o(),e.hide()}}]});else n&&o()}else n&&o();function o(t){if(r.mask(y.elements.content,a.creating_qualification),u.controller.app._utility.disableOrEnableButton(!0),y&&y.destroy&&e.wuxAutocompletes){s.formValues=e.getValues(),s.formValues.type=f.SYMBOLIC_TYPE_SRC_Usage_QUALIFICATION,s.formValues.prereqId=e.getField(f.PREREQ).getAttribute("identifier")&&!e.getField(f.PREREQ).getAttribute("identifier").contains("input")?e.getField(f.PREREQ).getAttribute("identifier"):e.getField(f.PREREQ).id&&!e.getField(f.PREREQ).id.contains("input")?e.getField(f.PREREQ).id:null,i.getPlatformId()===f.ONPREMISE&&(s.extensionDetails=u.applyAttributeGroups(e.getValue("Add Extensions")));let n=e.wuxAutocompletes.filter(e=>e.options.name===f.CONTEXT)[0],o=e.wuxAutocompletes.filter(e=>e.options.name===f.TARGET)[0];if(s.qualificationCreateCallBack=function(){if(s.fromGlobal){s.formValues.contextId=[],n?n.selectedItems.forEach(e=>{s.formValues.contextId.push(e._options.resourceid||e._options.id)}):s.formValues.contextId=e.getField(f.CONTEXT).getAttribute("identifier");let t=JSON.parse(widget.getValue("xsrcQualificationContext"));s.formValues.contextId.forEach(e=>{0===t.filter(t=>t.pid===e).length&&u.controller.qualificationContextsController.addToWidgetTracker([{pid:e}],"xsrcQualificationContext","xsrcQualificationContextListMaxSize")}),s.formValues.targetId=o?o.selectedItems._options.id||o.selectedItems._options.resourceid:e.getField(f.TARGET).getAttribute("identifier"),0===JSON.parse(widget.getValue("xsrcQualificationTarget")).filter(e=>e.pid===s.formValues.targetId).length&&u.controller.qualificationContextsController.addToWidgetTracker([{pid:s.formValues.targetId}],"xsrcQualificationTarget","xsrcQualificationTargetListMaxSize")}r.unmask(y.elements.content),y.destroy()},s.createFailureCallback=function(){r.unmask(y.elements.content),u.controller.app._utility.disableOrEnableButton(!1)},s.matchProjOrgStamp=t,i.getPlatformId()===f.ONPREMISE){let t=[];n?n.selectedItems.forEach(e=>{t.push(e._options.resourceid||e._options.id)}):t=e.getField(f.CONTEXT).getAttribute("identifier"),s.formValues.contextId=1===t.length?t[0]:t,s.formValues.targetId=o?o.selectedItems._options.id||o.selectedItems._options.resourceid:e.getField(f.TARGET).getAttribute("identifier"),u.controller.create(s,e.wuxAutocompletes,d)}else{let t=e.getField(f.CONTEXT),i=[],r=widget.getValue(f.QUALIFICATION_CONTEXT_ALLOWED_TYPES);n?n.selectedItems.forEach(e=>{i.push(e._options["ds6w:what/ds6w:type"]||e._options["ds6w:type_value"])}):i.push(t.getAttribute("itemType"));let l=a.select_valid_Context_item,c=e.getField(f.TARGET),p=widget.getValue(f.QUALIFICATION_TARGET_ALLOWED_TYPES),g=a.select_valid_Target_item,h=o?o.selectedItems._options["ds6w:what/ds6w:type"]||o.selectedItems._options["ds6w:type_value"]:c.getAttribute("itemType");u.getTypesandProxyId(i,l,n,r,t,"context").then(function(t){s.formValues.contextId=1===t.length?t[0]:t,u.getTypesandProxyId([h],g,o,p,c).then(function(t){s.formValues.targetId=t[0],u.controller.create(s,e.wuxAutocompletes,d)})})}}}},onChange:function(){this.texts.length>0&&this.FormValidations.charLimitValidate(this.texts)}}}).inject(w),this.attrAccordeon=new l({items:[],className:"filled filled-separate"}).inject(w),this.form.getField("context").required=!1,d&&d.contextItem){let e;(e=s.fromContextDetailsPage?this.form.getField("context"):this.form.getField("target")).value=d.contextItem.label,e.id=d.contextItem.id,e.setAttribute("identifier",d.contextItem.id),e.setAttribute("projectSpace",d.contextItem._options.projectSpace),e.setAttribute("organizationResponsible",d.contextItem._options.organizationResponsible),e.setAttribute("itemType",d.contextItem._options["ds6w:type_value"]),e.setAttribute("sourceid",d.contextItem.sourceid)}var I=UWA.createElement("span",{id:"modalButtons",class:"modal-buttons"});UWA.createElement("button",{type:"submit",name:"create",id:"createBtn",form:"myForm",class:"btn btn-primary",text:a.create,value:a.create}).inject(I),UWA.createElement("button",{type:"reset",id:"closeModalBtn",class:"btn btn-default",text:a.cancel,value:a.cancel,events:{click:function(){y.destroy()}}}).inject(I);let y=new e({app:{widget:widget},draggable:!0,resizable:!0,escapeToClose:!0,onHideCB:()=>y.destroy(),minimumHeight:"300px",height:"350px",classNames:"create-npr-details-modal"}).getModal();y.show(),y.setHeader(a.new_qualification),w.inject(y.getBody()),I.inject(y.getFooter()),new t({element:w}).inject(y.getBody()),widget.getElement(".xSourcingForm").setAttribute("id","myForm");var v='input[name="'+this.form.options.fields[0].name+'"]';document.querySelector(v).focus(),document.querySelector(".modal-body .form-group").scrollIntoView(),s.applicationChannel.subscribe({event:"qualification-type-switched"},function(e){s.qualType=f.TYPE_QUALIFICATION_LIST[2],s.type=e,u.setDataSetForAutocomplete(s).then(function(e){c.datasets[0].items=e.items})})},m.prototype.applyAttributeGroups=function(e){var t=this.trackAttrValUpdates,i={};if(e.length>0){var n=e.split(";");i.selectedInterfaces=n;var a=[];t.forEach(function(e){e.selected&&a.push(e.attributes)}),i.selectedAttributes=a}return i},m.prototype.updateView=function(e,t){var i=this,n=this.attrAccordeon,a=this.trackAttrValUpdates,r=UWA.createElement("div",{class:"outerDiv xSourcingForm"}),l=UWA.createElement("div",{id:"no-object-found",class:"emptyContainerStyle",html:o.NO_ATTRIBUTES_PRESENT,styles:{position:"relative","font-family":"3ds","font-size":"17px",color:"#368ec4",margin:"8px 1px 0px 8px","font-weight":"bold","align-self":"center","text-align":"center","justify-content":"center","align-items":"center",display:"flex","flex-direction":"column"}});t?(0!==e.attributes.length?e.attributes.forEach(function(e){var t=UWA.createElement("div",{}).inject(r),n=UWA.createElement("div",{}).inject(t);i.createInputFieldsUI(e).inject(n)}):l.inject(r),n.addItem({title:UWA.String.escapeHTML(e.label),content:r,name:e.label}),a.forEach(function(t){t.name===e.name&&0!==t.attributes.length&&(t.selected=!0)})):(n.removeItem(e.label),a.forEach(function(t,i){var n=i;t.value===e.value&&0!==a[n].attributes.length&&(a[n].selected=!1,t.attributes.forEach(function(e,t){a[n].attributes[t].value=""}))}))},m.prototype.createInputFieldsUI=function(e){var t=this,i="xsrc-add-attributegroup-field",n=UWA.createElement("div",{}),a=e.displayName?e.displayName:e.name;UWA.createElement("label",{html:a,styles:{"padding-top":"10px"}}).inject(n);var r=UWA.createElement("div",{}).inject(n),l=[{label:o.TRUE,value:"True"},{label:o.False,value:"False"}],p="";switch(e.type){case"string":p=new s({placeholder:e.displayName,name:e.name,className:i}).inject(r);break;case"real":case"integer":p=new d({placeholder:e.displayName,className:i,name:e.name,step:1,max:9999999999,min:-9999999999}).inject(r);break;case"date":case"timestamp":p=new c({placeholder:e.displayName,name:e.name,className:i}).inject(r);break;case"boolean":p=new u({custom:!1,placeholder:!1,name:e.name,options:l,className:i}).inject(r);break;case"select":{var g=e.range;g=g.substring(1,g.length-1);let t=e.displayRange;if(!Array.isArray(t)){let e=t.substring(1,t.length-1);t=e.split(",")}var f=g.split(","),h=[],m=e.defaultValue;for(let e=0;f.length,e<t.length;e++){let i=f[e].trim(),n=t[e].trim();var w={label:o[n]?o[n]:n,value:i};i===m&&(w.selected="true"),h.push(w)}p=new u({custom:!1,placeholder:!1,name:e.name,options:h,className:i}).inject(r);break}}return p.onChange=function(){t.trackAttributeUpdations(this.elements,this.getName(),this.getValue())},n},m.prototype.trackAttributeUpdations=function(e,t,i){var n=this.trackAttrValUpdates,a=t,o=i,r=void 0;n.forEach(function(t,i){r=i,t.attributes.forEach(function(t,i){if(a===t.name){var l=n[r].attributes[i].type;"date"!==l&&"Date"!==l&&"timestamp"!==l||(o=new Date(e.picker.getDate().getTime()).toDateString()),n[r].attributes[i].value=o}})})},m.prototype.setDataSetForAutocomplete=function(e){var t=this,i={source:f.SOURCE_SOURCING,endpoint:"/resources/v1/modeler/dssourcing/qualifications/interfaces?$type="+e.qualType};return new Promise((e,n)=>{g.getDataPromise(i).then(function(i){var n=[];i.data.map(e=>{var t={name:e.dataelements.name,description:e.dataelements.description,displayName:e.dataelements.displayName,attributes:[]};e.children.forEach(function(e){"timestamp"===e.dataelements.Type&&e.dataelements.displayRanges&&(e.dataelements.displayRanges=e.dataelements.displayRanges.replace(/[[\]']+/g,"").split(","),e.dataelements.displayRanges.forEach((e,t,i)=>{let n=h.getDateStringForDisplay(e);i[t]=n.substring(0,n.lastIndexOf(","))}));var i={name:e.dataelements.Name,type:e.dataelements.Type,defaultValue:e.dataelements["Default Value"],displayName:e.dataelements.displayName};e.dataelements.Range&&(i.type="select",i.range=e.dataelements.Range,i.displayRange=e.dataelements.displayRanges),t.attributes.push(i)}),n.push(t)});var o=[];n?n.forEach(function(e){o.push({name:e.name,value:e.name,label:e.displayName?e.displayName:e.description?e.description:e.name,attributes:e.attributes,selected:!1})}):widget.notificationUtil.showWarning(a.no_ext_available),t.trackAttrValUpdates=o,e({name:"Extensions",items:o})},function(e){n(e)})})},m.prototype.setFieldValuesEmpty=function(e){e.value="",e.id="",e.setAttribute("identifier","")},m.prototype.getTypesandProxyId=function(e,t,i,n,o,r){var l=this;return new Promise(s=>{l.controller.qualificationContextsController.gettypeshierarchy(e).then(function(e){let a=[],d=[],c="",u=[];if(i&&"context"===r)i.selectedItems.forEach(t=>{a=e;let i=t._options["ds6w:what/ds6w:type"]||t._options["ds6w:type_value"],o=a.types_hierarchies.find(e=>e.type===i).hierarchy;c=l.controller.helper.getTypeFromTypeHierarchy(o,i,n),d.push({title:t._options["ds6w:label"]||"",id:t._options.id||t._options.resourceid,sourceid:t._options.sourceid,actualType:t._options["ds6w:what/ds6w:type"]||t._options["ds6w:type_value"],proxyType:c})});else{let t=i?i.selectedItems._options["ds6w:what/ds6w:type"]||i.selectedItems._options["ds6w:type_value"]:o.getAttribute("itemType");a=e.types_hierarchies[0].hierarchy,c=l.controller.helper.getTypeFromTypeHierarchy(a,t,n),d.push({title:i?i.selectedItems._options["ds6w:label"]:o.value,id:i?i.selectedItems._options.resourceid||i.selectedItems._options.id:o.id,sourceid:i?i.selectedItems._options.sourceid:o.getAttribute("sourceid"),actualType:t,proxyType:c})}c||widget.notificationUtil.showError(t),l.controller.helper.getProxyItemId(d).then(function(e){e.length>0&&(u=e)}).catch(function(){u=[]}).finally(function(){s(u)})},function(){widget.notificationUtil.showError(a.internal_server_error)}).catch(function(){widget.notificationUtil.showError(a.internal_server_error)})})},m}),define("DS/ENOXGenericQualification/views/Qualification/SearchQualificationItem",["DS/ENOXSourcingUXInfra/Search/ENOXSourcingSearch","DS/ENOXSourcingUXInfra/Constants/ENOXSourcingConstants"],function(e,t){"use strict";var i=function(){},n={};return i.prototype.init=function(a){n=this,this.options=a;var o="";let r=a.detailsRoutePath===t.QUALIFICATION_CONTEXT_DETAILS_VIEW?t.QUALIFICATION_CONTEXT_ALLOWED_TYPES:t.QUALIFICATION_TARGET_ALLOWED_TYPES;widget.getValue(r).map(function(e){t.DSPLAN_PROJECT===e?o+='[dsplan:type]:"'+e+'"'+t.OR:o+=' flattenedtaxonomies:"types/'+e+'"'+t.OR}),o=o.substring(0,o.length-3);var l={title:"All Objects"};l.completePreCond="( "+o+' )  AND ( NOT([ds6w:kind]:"'+t.MEI_EXTENSION+'") )',l.callbackMethod=i.prototype.openItem,(new e).init(l)},i.prototype.openItem=function(e){var t={itemId:e[0].id,pid:e[0].id,label:e[0]["ds6w:label"],title:e[0]["ds6w:label"],partNumber:e[0]["ds6w:label_value"],maturityStatus:e[0]["ds6w:status"],image:e[0].preview_url,responsible:e[0]["ds6w:responsible"],modificationDate:e[0]["ds6w:modified"],creationDate:e[0]["ds6w:created"],revision:e[0]["ds6wg:revision"],type:e[0]["ds6w:type"],objName:e[0]["ds6w:identifier"],type_icon_url:e[0].type_icon_url,preview_url:e[0].preview_url,sourceId:e[0].sourceid};t.platformServices=n.options.platformServices;var i=n.options.nxtNavigationPath;n.options.nxtNavigationPath=void 0,t.pid=t.itemId,n.options.callbackmethod?n.options.callbackmethod(t):n.options.router.navigate(i,t)},i}),define("DS/ENOXGenericQualification/components/ApplicationTopBar/ApplicationTopBarWrapper",["DS/ENOXSourcingUXInfra/InformationPanel/InformationPanelUI","i18n!DS/ENOXGenericQualification/assets/nls/ENOXGenericQualification"],function(e,t){"use strict";var i=function(){};return i.prototype.init=function(e,t){this.xCSRouter=t,this._applicationChannel=e,this._subscribeToEvents()},i.prototype._subscribeToEvents=function(){var i=this;this._applicationChannel.subscribe({event:"welcome-panel-collapse"},function(){i._applicationChannel.publish({event:"triptych-set-size",data:{size:40,side:"left"}}),i._applicationChannel.publish({event:"triptych-show-panel",data:"left"})}),this._applicationChannel.subscribe({event:"welcome-panel-expand"},function(){i._applicationChannel.publish({event:"show-welcomepanel-icon"}),i._applicationChannel.publish({event:"triptych-set-size",data:{size:350,side:"left"}}),i._applicationChannel.publish({event:"triptych-show-panel",data:"left"})}),this._applicationChannel.subscribe({event:"welcome-panel-hide"},function(){i._applicationChannel.publish({event:"hide-welcomepanel-icon"}),i._applicationChannel.publish({event:"welcome-panel-collapse"}),i._applicationChannel.publish({event:"triptych-hide-panel",data:"left"}),i._applicationChannel.publish({event:"information-panel-close"})}),this._applicationChannel.subscribe({event:"information-panel-close"},function(){i.isRightPaneOpen=!1,i._applicationChannel.publish({event:"triptych-hide-panel",data:"right"});var e=widget.getElement(".xCS-triptych-wrapper-right");e&&(e.innerHTML="")}),this._applicationChannel.subscribe({event:"information-panel-open"},function(){i.isRightPaneOpen=!0,i._applicationChannel.publish({event:"triptych-show-panel",data:"right"}),i._applicationChannel.publish({event:"information-panel-visible",data:null}),i._applicationChannel.publish({event:"information-panel-add-content",data:i.selectedObject})}),this._applicationChannel.subscribe({event:"triptych-show-panel"},function(){var e=document.querySelector(".information-icon");null!==e&&(e.className.contains("active")||e.classList.add("active"))}),this._applicationChannel.subscribe({event:"triptych-panel-hidden"},function(e){if(i.isRightPaneOpen=!1,"right"===e){i._applicationChannel.publish({event:"information-panel-hidden",data:null});var t=widget.getElement(".xCS-triptych-wrapper-right");t&&(t.innerHTML="")}var n=widget.getElement("#sourcinginfoicon");if(n){var a=n.getChildren()[0];a.className.contains("enox-collection-toolbar-filter-activated")&&a.removeClassName("enox-collection-toolbar-filter-activated")}var o=document.querySelector(".information-icon");null!==o&&o.className.contains("active")&&o.classList.remove("active"),i._applicationChannel.publish({event:"destroy-document-view"})}),this._applicationChannel.subscribe({event:"xsourcing-collectionview-selected-object-id"},function(e){e.selectedObject&&!e.fromInfoPanel&&(i.selectedObject=e,i.isRightPaneOpen&&i._applicationChannel.publish({event:"information-panel-add-content",data:e}))}),this._applicationChannel.subscribe({event:"xsourcing-collectionview-unselected-object-id"},function(e){i.selectedObject=null,e.isDocumentView||i._applicationChannel.publish({event:"information-panel-add-content",data:i.selectedObject})}),this._applicationChannel.subscribe({event:"information-panel-open-without-reload-content"},function(){i.isRightPaneOpen=!0,i._applicationChannel.publish({event:"triptych-show-panel",data:"right"}),i._applicationChannel.publish({event:"information-panel-visible",data:null})}),this._applicationChannel.subscribe({event:"information-panel-add-content"},function(i){var n=widget.getElement(".xCS-triptych-wrapper-right");if(n&&(n.innerHTML=""),i&&"multipleSelected"===i.selectedObject){let e=UWA.createElement("span",{styles:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%,-50%)"},text:t.select_only_one_item});n.appendChild(e)}else if(i&&i.isRDFObject)n.appendChild(document.createTextNode(t.rdf_objects_alert_msg));else if(i&&i.openDetails)i.openDetails();else if(i&&!0===i.selectedObject){new e(i.selectedObject).init(i.selectedObject)}else{let e=UWA.createElement("div",{styles:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%,-50%)"},text:t.no_valid_item_selected});n&&n.appendChild(e)}})},i}),define("DS/ENOXGenericQualification/components/Triptych/TriptychWrapper",["DS/ENOXTriptych/js/ENOXTriptych","css!DS/ENOXGenericQualification/components/Triptych/TriptychWrapper.css"],function(e){"use strict";var t=function(){};return t.prototype.init=function(t,i){this._left=document.createElement("div"),this._left.classList.add("xCS-triptych-wrapper-left"),this._main=document.createElement("div"),this._main.classList.add("xCS-triptych-wrapper-middle"),this._right=document.createElement("div"),this._right.classList.add("xCS-triptych-wrapper-right"),this._applicationChannel=t,this._triptych=new e;var n={left:{resizable:!0,originalSize:350,originalState:widget.body.offsetWidth<550?"close":"open",overMobile:!0},right:{resizable:!0,originalSize:450,originalState:"close",withClose:!0,overMobile:!0,minWidth:406},borderRight:!0,borderLeft:!0,container:i,withtransition:!0,modelEvents:this._applicationChannel};this._triptych.init(n,this._left,this._main,this._right)},t.prototype.inject=function(e){this._triptych.inject(e)},t.prototype._getTriptych=function(){return this._triptych},t.prototype.getLeftPanelContainer=function(){return this._left},t.prototype.getRightPanelContainer=function(){return this._right},t.prototype.getMainPanelContainer=function(){return this._main},t}),define("DS/ENOXGenericQualification/views/Qualification/ProgressView/ItemLabelContentView",["UWA/Core","UWA/Class/View","css!DS/ENOXGenericQualification/views/Qualification/ProgressView/ProgressView.css"],function(e,t){"use strict";return t.extend({name:"item-label-content-view",tagName:"div",domEvents:{},setup:function(e){this.options=e,this.container.addClassName(this.getClassNames("-container"))},update:function(){},render:function(){this.container.empty(),this.container.setStyles({width:"100%"});var t=e.createElement("div",{class:"item-label-content-main-div"}).inject(this.container);return this.options.data.forEach(i=>{var n=e.createElement("div",{class:"item-label-content-div"}).inject(t);e.createElement("b",{html:`${i.label}: `}).inject(n),e.createElement("span",{html:`${i.content}`,class:"item-content"}).inject(n)}),this},onDestroy:function(){return this._parent.apply(this,arguments)}})}),define("DS/ENOXGenericQualification/config/routerConfig",[],function(){"use strict";return{routes:[{name:"home",path:"/home"},{name:"home.QualificationContextsView",path:"/QualificationContextsView",routeController:"listViewRouteController",dataController:"qualificationContextsController",titleNLS:"my_qualification_contexts",showTitle:!1},{name:"home.QualificationContextsDetailsView",path:"/QualificationContextsDetailsView",routeController:"detailsViewRouteController",dataController:"qualificationContextsController",titleNLS:"my_qualification_contexts",showTitle:!1},{name:"home.QualificationTargetsView",path:"/QualificationTargetsView",routeController:"listViewRouteController",dataController:"qualificationContextsController",titleNLS:"my_qualification_targets",showTitle:!1},{name:"home.QualificationTargetsDetailsView",path:"/QualificationTargetsDetailsView",routeController:"detailsViewRouteController",dataController:"qualificationContextsController",titleNLS:"my_qualification_targets",showTitle:!1}],options:{defaultRoute:"home.QualificationContextsView",defaultParams:{},trailingSlash:!1,useTrailingSlash:void 0,autoCleanUp:!0,strictQueryParams:!0,allowNotFound:!1}}}),define("DS/ENOXGenericQualification/models/Qualification",["DS/ENOXSourcingUXInfra/service/ENOXSourcingService","DS/ENOXSourcingUXInfra/service/ENOXSourcingPlatformServices","DS/ENOXSourcingUXInfra/Constants/ENOXSourcingConstants"],function(e,t,i){"use strict";var n=function(){this.source="sourcing"};return n.prototype.init=function(){},n.prototype.create=function(i){"OnPremise"===t.getPlatformId()?i.endpoint="/resources/v1/modeler/dssourcing/qualifications?tenant=OnPremise&contextType=multipleContext&$include=target,Context":i.endpoint="/resources/v1/modeler/dssourcing/qualifications?$include=target,Context",i.matchProjOrgStamp&&(i.endpoint=i.endpoint+"&matchProjOrgStamp=true"),i.source=this.source,e.createService(i)},n.prototype.delete=function(t){t.endpoint="/resources/v1/modeler/dssourcing/qualifications?$include=target,Context",t.source=this.source,e.deleteService(t)},n.prototype.updateQualificationPromise=function(t){return t.endpoint="/resources/v1/modeler/dssourcing/qualifications/"+t.qualId,t.endpoint=t.endpoint+"?$include=target,Context",t.source=this.source,e.updateServicePromise(t)},n.prototype.getProxyObjectId=function(t){return t.endpoint="/resources/dssourcing/ProxyObject",t.source=this.source,t.postData=t.data,e.performPostPromise(t)},n.prototype.getQualificationTargetDetails=function(t,i,n,a){var o="",r="none",l="none";return n&&(r=[r,...n].join()),a&&(l=[l,...a].join()),i&&(o="?type="+i+"&$include="+l+"&$fields="+r),t.endpoint="/resources/v1/modeler/dssrc/qualifications/targetLocate"+o,t.postData.data.source=this.source,t.source=this.source,e.performPostPromise(t)},n.prototype.getQualificationContextDetails=function(t,i,n,a){var o="",r="none",l="none";return n&&(r=[r,...n].join()),a&&(l=[l,...a].join()),i&&(o="?type="+i+"&currentView=myQualificationContext&$include="+l+"&$fields="+r),t.endpoint="/resources/v1/modeler/dssrc/qualifications/contextLocate"+o,t.postData.data.source=this.source,t.source=this.source,e.performPostPromise(t)},n.prototype.getDetails=function(t){let i=t.data.respParams?t.data.respParams.id:t.data.params.qualificationId;return t.endpoint="/resources/v1/modeler/dssourcing/qualifications/"+i,t.source=this.source,e.getDataPromise(t)},n.prototype.getQualificationDetails=function(t,i=""){return t.endpoint="/resources/v1/modeler/dssrc/qualifications/ids?$include=interface-details&$fields=policy",t.endpoint=""!==i?t.endpoint+","+i:t.endpoint,t.source=this.source,e.performPostPromise(t)},n.prototype.reviseQualification=function(t){return t.endpoint="/resources/v1/modeler/dssourcing/qualifications?action=Revise",t.source=this.source,e.createServicePromise(t)},n.prototype.getLifeCycleDataProviderPromise=function(t){var i={endpoint:"/resources/lifecycle/maturity/getStateGraph"};return i.lifeCycleData=t.getLifecycleData,i.source=this.source,e.performLifeCycleAction(i)},n.prototype.getDocuments=function(t){var i={};return i.endpoint="/resources/v1/modeler/dssourcing/qualifications/"+t.data.respParams.id+"/documents",i.source=this.source,e.getDataPromise(i)},n.prototype.attachDocument=function(t){var i={};return i.endpoint="/resources/v1/modeler/dssourcing/qualifications/"+t.data.respParams.id+"/documents",i.source=this.source,i.attachDocumentData=t.attachDocumentData,e.performPatchPromise(i)},n.prototype.detachDocument=function(t){var i={};return i.endpoint="/resources/v1/modeler/dssourcing/qualifications/"+t.data.respParams.id+"/documents/"+t.data.params.documentId,i.source=this.source,e.performDeletePromise(i)},n.prototype.updateQualifications=function(t){t.endpoint="/resources/v1/modeler/dssourcing/qualifications/"+t.id,t.endpoint=t.endpoint+"?$include=Context",t.source=this.source,e.updateService(t)},n.prototype.getAllowedTargetAndContextTypes=function(t){return t.endpoint="/resources/v1/modeler/dssourcing/qualifications/allowedTypes?$simpleJSON=true",t.source=this.source,e.getDataPromise(t)},n.prototype.gettypeshierarchy=function(t){var n={};return n.source=i.SERVICE_3DSPACE,n.endpoint="/resources/enong/dico/gettypeshierarchy",n.postData={types:t},e.performPostPromise(n)},n.prototype.getVersionGraph=function(t){var n={};return n.source=i.SERVICE_3DSPACE,n.endpoint="/resources/v1/dslc/versiongraph",n.postData=t,e.performPostPromise(n)},n.prototype.getTagsRead=function(t){var i={endpoint:"/resources/v3/e6w/service/Tags/read"};return i.postData=t,i.source=this.source,i.contentType="application/x-www-form-urlencoded; charset=utf-8",e.performPostPromise(i)},n.prototype.getObjectInfo=function(t,n="",a=""){var o={endpoint:"/resources/v3/e6w/service/ObjectInfo/read"};return o.endpoint=""!==n?o.endpoint+"?$fields=none,"+n:o.endpoint,o.postData=t,o.source=""!==a?a:i.SERVICE_3DSPACE,e.performPostPromise(o)},n.prototype.getProofs=function(t){var i={};return i.endpoint="/resources/v1/modeler/dssourcing/qualifications/"+t+"/proof",i.source=this.source,e.getDataPromise(i)},n.prototype.updateProofs=function(t){t.endpoint="/resources/v1/modeler/dssourcing/qualifications/"+t.id+"/proof",t.source=this.source,e.updateService(t)},n}),define("DS/ENOXGenericQualification/views/Qualification/ProgressView/ProgressViewUtil",["i18n!DS/ENOXGenericQualification/assets/nls/ENOXGenericQualification","DS/ENOXSourcingUXInfra/service/ENOXSourcingPlatformServices","DS/ENOXSourcingUXInfra/Constants/ENOXSourcingConstants","DS/Utilities/Dom","DS/UIKIT/Mask","DS/Controls/TooltipModel","DS/ENOXSourcingUXInfra/CommonUtils/CommonUtils"],function(e,t,i,n,a,o,r){"use strict";return{customViewLoader:async function(n){a.mask(widget.body,e.loading);let o=t.getPlatformId()===i.ONPREMISE?this.groupData(n.tableView.options.dataSource.referenceArray,"isVersionOf"):this.groupData(n.tableView.options.dataSource.referenceArray,"name");n.index=50,n.groupedData=this.groupWithKey(o);let r=this.getGroupedData(n.groupedData.slice(0,n.index)),l={};l.qualData=await n.controller.queryQualificationIds(r,n.tableView.options.dataSource.contextId),l.qualData.find(e=>e.id===n.data.qualIdToHighlight)&&(l.qualData.find(e=>e.id===n.data.qualIdToHighlight).highLight=!0),n.qualificationProgressView.render(l).inject(n.tableView._xsourcingCollectionViewUI.viewContainer),n.groupedData.length>n.index&&n.qualificationProgressView.loadMoreButton(),a.unmask(widget.body)},groupWithKey:function(e){let t=[];return Object.entries(e).forEach(([e,i])=>{"undefined"!==e?t.push(i):i.forEach(e=>{t.push([e])})}),t},getGroupedData:function(e){let t={data:[]};return e.forEach(e=>{e.forEach(e=>{t.data.push({id:e.id})})}),t},groupData:function(e,t){return e.reduce((e,i)=>((e[i[t]]=e[i[t]]||[]).push(i),e),[])},addNewData:async function(e,n){let a={data:[]},o=t.getPlatformId()===i.ONPREMISE?this.groupData(n.tableView.options.dataSource.referenceArray,"isVersionOf"):this.groupData(n.tableView.options.dataSource.referenceArray,"name");if(n.groupedData=this.groupWithKey(o),t.getPlatformId()===i.ONPREMISE){let t={graphRequests:[{id:e[0].id}]},i=n.groupedData.find(t=>t[0].name===e[0].title);n.helper.model.getVersionGraph(t).then(async function(t){t.graphs[0].versions.forEach(e=>{i.map(e=>e.id).includes(e.id)&&a.data.push({id:e.id})});let o={};o.qualData=await n.controller.queryQualificationIds(a,n.tableView.options.dataSource.contextId),o.qualData.find(t=>t.id===e[0].id).highLight=!0,n.qualificationProgressView.render(o)})}else{n.groupedData.find(t=>t[0].name===e[0].title).forEach(e=>{a.data.push({id:e.id})});let t={};t.qualData=await n.controller.queryQualificationIds(a,n.tableView.options.dataSource.contextId),n.qualificationProgressView.render(t)}},deleteData:async function(e,n){let a={data:[]},o=[];n.groupedData.filter(t=>{t.forEach(i=>{e.includes(i.id)&&o.push(t)})}),o.forEach(t=>{t.forEach(t=>{e.includes(t.id)||a.data.push({id:t.id})})});let r={};r.qualData=await n.controller.queryQualificationIds(a,n.tableView.options.dataSource.contextId);let l=t.getPlatformId()===i.ONPREMISE?this.groupData(n.tableView.options.dataSource.referenceArray,"isVersionOf"):this.groupData(n.tableView.options.dataSource.referenceArray,"name");n.groupedData=this.groupWithKey(l),n.qualificationProgressView.render(r)},loadMoreData:async function(e){let t=this.getGroupedData(e.groupedData.slice(e.index,e.index+50));e.index+=50;let i={};i.qualData=await e.controller.queryQualificationIds(t,e.tableView.options.dataSource.contextId),e.qualificationProgressView.render(i),e.groupedData.length<e.index&&e.qualificationProgressView.loadMoreButtonHide()},updateProgressViewNodes:function(t){let i=["approved","state","modified","extension"];if(i.includes(widget.getValue("progressViewTileTopAttribute"))){let e;"extension"===widget.getValue("progressViewTileTopAttribute")?e=t.extensionColumns?t.extensionColumns.find(e=>e.id.includes(widget.getValue("topPattern"))).value:"":(e=t.grid[widget.getValue("progressViewTileTopAttribute")],"modified"===widget.getValue("progressViewTileTopAttribute")&&(e=r.getDateStringForDisplay(e))),document.getElementById(t.id).getChildren()[0].innerHTML=e}if(i.includes(widget.getValue("progressViewTileBottomAttribute"))){let e;"extension"===widget.getValue("progressViewTileBottomAttribute")?e=t.extensionColumns?t.extensionColumns.find(e=>e.id.includes(widget.getValue("bottomPattern"))).value:"":(e=t.grid[widget.getValue("progressViewTileBottomAttribute")],"modified"===widget.getValue("progressViewTileBottomAttribute")&&(e=r.getDateStringForDisplay(e))),document.getElementById(t.id).getChildren()[1].innerHTML=e}t.grid&&(document.getElementById(t.id).parentElement.style["background-color"]=t.grid.approved!==e.approved||t.grid.state!==e.Released&&t.grid.state!==e.Obsolete?t.grid.approved!==e.rejected||t.grid.state!==e.Released&&t.grid.state!==e.Obsolete?"#F59A23":"#D9001B":"#018308",t.grid.restriction?!document.getElementById(t.id).getChildren()[2]&&this.generateRestrictionIcon(document.getElementById(t.id)):document.getElementById(t.id).getChildren()[2]&&document.getElementById(t.id).getChildren()[2].remove())},generateRestrictionIcon:function(e){n.generateIcon({iconName:"attention wux-ui-3ds",tooltipInfos:new o({shortHelp:"Has restriction",mouseRelativePosition:!1,position:"right"})}).inject(e)}}}),define("DS/ENOXGenericQualification/dataSource/QualificationDataSource",["DS/TreeModel/DataSourceBase","DS/ENOXSourcingUXInfra/Constants/ENOXSourcingConstants"],function(e,t){"use strict";return e.extend({init:function(e={}){return this.referenceArray=e.referenceArray,this.availableProperties=[],this.contextId=e.contextId,this.model=e.model,this.helper=e.helper,this.app=e.app,this.controller=e.controller,this.dataIndexesToGroup=[],this._parent.apply(this,arguments)},getModelItems:function(e){let{request:t}=e,i=this;this.getRowData(t).then(function(t){if(t.success){let n;t.rows.forEach(function(e){e.extensionColumns&&i.app.dataControllers.qualificationContextsController.addExtensionColumn(e.extensionColumns)}),e.successCallback(t.rows,t.lastRow,t.numberOfChildren,t.requestDataForVirtualLoading);let a=i.controller.detailsView.relatedQualificationsView.data.qualIdToHighlight;i.referenceArray[0].highLight?n={key:"id",id:i.referenceArray[0].id}:a&&(n={key:"id",id:a}),n&&i.controller.detailsView.relatedQualificationsView.tableView._xsourcingCollectionViewUI.selectNodeModel(n),a&&i.controller.renderPropertiesView({id:i.contextId,qualIdToHighlight:a}),i.referenceArray[0].highLight&&delete i.referenceArray[0].highLight}else e.failCallback()}).catch(function(){})},getRowData:async function(e){let t=[];if(this.referenceArray=await this.getReferenceArray(e),e.rowGrouping&&e.rowGrouping.dataIndexesToGroup&&e.rowGrouping.dataIndexesToGroup.length>0?(this.dataIndexesToGroup=e.rowGrouping.dataIndexesToGroup,t=this.groupData(this.referenceArray,e.rowGrouping.dataIndexesToGroup),e.groupKeys&&e.groupKeys.length&&(t=e.requestDataForVirtualLoading.parentNode.options.grid.children)):(t=this.referenceArray,this.dataIndexesToGroup=[]),e.sortModel){this.sortModel=e.sortModel,t=t.slice(0);let i=[...e.sortModel];if(i.length>0){let e=[];if(t[0]&&t[0].wux_group)if(i.some(e=>e.dataIndex===t[0].dataindex)){let n=i.filter(e=>e.dataIndex===t[0].dataindex);e.push({key:t[0].dataindex,inverse:"desc"===n[0].sort})}else"tree"===i[0].dataIndex&&e.push({key:t[0].dataindex,inverse:"desc"===i[0].sort});else i.forEach(t=>{e.push({key:t.dataIndex,inverse:"desc"===t.sort})});t=this.sortData(t,e)}}else this.sortModel&&delete this.sortModel;let i=t.slice(e.startRow,e.endRow+1);if(i[0]&&!i[0].wux_group){let e=this.helper.getPostData(i);i=await this.controller.queryQualificationIds(e,this.contextId)}return{success:!0,rows:i,lastRow:t.length<=e.endRow?t.length:-1,numberOfChildren:t.length,requestDataForVirtualLoading:e.requestDataForVirtualLoading}},sortData:function(e,t){let i=this;return Object.defineProperty(e,"sortData",{configurable:!0,value:function(e){e.map(e=>{e.uniqueValues=Array.from(new Set(this.map(t=>t[e.key]))),e.uniqueValues=e.uniqueValues.sort((t,n)=>{return"datetime"===i.helper.gettypeRepresentationForDataindex(e.key,i.controller.detailsView.relatedQualificationsView.tableView._xsourcingCollectionViewUI._columnsConfiguration)?e.inverse?new Date(n)-new Date(t):new Date(t)-new Date(n):"string"==typeof t?e.inverse?n.localeCompare(t):t.localeCompare(n):0})});const t=t=>{let i="";return e.map(e=>{let n=`${e.uniqueValues.length}`.length;i+=e.uniqueValues.indexOf(t[e.key]).toString().padStart(n,"0")}),i};return this.sort((e,i)=>t(e).localeCompare(t(i))),this}}),e.sortData(t)},getReferenceArray:async function(e){let t=[],i=[...this.referenceArray],n=[];if((e.rowGrouping&&e.rowGrouping.dataIndexesToGroup||e.sortModel)&&(t=this.getPropertiesToQuery(e,n)).length){let e=await this.queryProperties(t,n);n.length>0&&await this.updateDataWithProperties(e.data,t,n),i=((e,t)=>e.map(e=>({...t.find(t=>t.id===e.id&&t),...e})))(i,e.data),this.availableProperties=this.availableProperties.concat(t)}return i},getPropertiesToQuery:function(e,t){let i=[],n=["tree","targetType"],a=["context","contextType"];return e.sortModel&&e.sortModel.map(e=>{e.dataIndex&&!this.availableProperties.includes(e.dataIndex)&&i.push(e.dataIndex)}),e.rowGrouping&&e.rowGrouping.dataIndexesToGroup&&(i=i.concat([...i,...e.rowGrouping.dataIndexesToGroup.filter(e=>!this.availableProperties.includes(e))])),i.length&&(n.some(e=>i.includes(e))&&t.push("target"),a.some(e=>i.includes(e))&&t.push("context"),i.includes("owner")&&t.push("ownerInfo"),i.includes("owner")&&i.push("ownerInfo.firstname,ownerInfo.lastname"),i.includes("prereq")&&t.push("prerequisite")),i},updateDataWithProperties:async function(e,t,i){let n=this;for(;i.length;){let a=i.splice(0,1),o="ownerInfo"!==a?n.getIDsFromProperty(e,a[0]):{},r="title,revision,typeNLS",l="ownerInfo"!==a?await n.controller.queryObjectInfo(o,r):{};e.forEach((e,i,n)=>{let o=l.data&&l.data.find(t=>t.id===e[a[0]].id||t.id===(e[a[0]][0]&&e[a[0]][0].id));switch(a[0]){case"target":t.includes("tree")&&o&&(n[i].tree=o.title+" ("+o.revision+")"),t.includes("targetType")&&o&&(n[i].targetType=o.typeNLS);break;case"context":t.includes("context")&&o&&(n[i].context=o.title+" ("+o.revision+")"),t.includes("contextType")&&o&&(n[i].contextType=o.typeNLS);break;case"ownerInfo":t.includes("owner")&&(n[i].owner=e.ownerInfo.firstname+" "+e.ownerInfo.lastname);break;case"prerequisite":t.includes("prereq")&&o&&(n[i].prereq=o.title+" ("+o.revision+")")}})}},getIDsFromProperty:function(e,t){let i={data:[]};return e.forEach(e=>e[t][0]&&e[t][0].id?i.data.push({id:e[t][0].id}):e[t]&&e[t].id?i.data.push({id:e[t].id}):""),i},groupData:function(e,t){return e.reduce((e,i)=>{let n=e,a=[...t];for(;a.length;){let e=a.splice(0,1),t=n.find(t=>t.tree===i[e]);t||(t={tree:i[e],[e]:i[e],wux_group:!0,children:[],dataindex:e[0]},n.push(t)),n=t.children}return n.push(i),e},[])},queryProperties:async function(e,i){let n={},a={postData:{data:[{id:this.contextId,tenant:this.app.platformServices.platformId}]}};return n=t.QUALIFICATION_TARGET_DETAILS_VIEW===this.controller.params.detailsRoutePath?await this.model.getQualificationTargetDetails(a,"contextQualification",e,i):await this.model.getQualificationContextDetails(a,"contextQualification",e,i)}})}),define("DS/ENOXGenericQualification/helpers/QualificationHelper",["i18n!DS/ENOXGenericQualification/assets/nls/ENOXGenericQualification","i18n!DS/ENOXSourcingUXInfra/assets/nls/ENOXSourcingUXInfra","DS/ENOXSourcingUXInfra/service/ENOXSourcingPlatformServices","DS/ENOXSourcingUXInfra/CommonUtils/CommonUtils","DS/ENOXGenericQualification/models/Qualification","DS/ENOXSourcingUXInfra/service/ENOXSourcingService","DS/ENOXSourcingUXInfra/Search/SearchUtility","DS/ENOXSourcingUXInfra/PropertiesView/EditPropertiesWidgetWrapper","DS/ENOXSourcingUXInfra/Constants/ENOXSourcingConstants","DS/ENOXSourcingUXInfra/Utilities/Utility","DS/ENOXSourcingUXInfra/Search/ENOXSourcingSearch"],function(e,t,i,n,a,o,r,l,s,d,c){"use strict";var u=function(){this.model=new a,this.searchUtility=new r,this.commonUtility=new d};return u.prototype.getPostData=function(e){let t={data:[]};return e.forEach(e=>{t.data.push({id:e.pid||e.id||e})}),t},u.prototype.getRelatedObjectIds=function(e){let t={erIDs:[],rdfIDs:[],sourcingIDs:[]};return e.forEach(e=>{e.relateddata?(e.relateddata.Context.forEach(e=>{e.dataelements.Proxy_Service===s.SOURCE_3DPLAN&&e.dataelements.Proxy_Service.toLowerCase().includes(s.SOURCE_3DPLAN)?t.rdfIDs.push({id:e.dataelements.Proxy_Id}):t.erIDs.push({id:e.dataelements.Proxy_Id})}),t.erIDs.push({id:e.relateddata.target[0].dataelements.Proxy_Id}),e.relateddata.PreReq[0]&&t.sourcingIDs.push({id:e.relateddata.PreReq[0].dataelements.Proxy_Id}),e.relateddata.prereqof&&e.relateddata.prereqof.forEach(e=>{t.sourcingIDs.push({id:e.dataelements.Proxy_Id})})):e.contexts||e.target||e.prerequisite?(e.contexts.forEach(e=>{e.source.toLowerCase().includes(s.SOURCE_3DPLAN)?t.rdfIDs.push({id:e.id}):t.erIDs.push({id:e.id})}),t.erIDs.push({id:e.target.id}),e.prerequisite.length>0&&t.sourcingIDs.push({id:e.prerequisite[0].id})):e.sourceid&&e.sourceid.toLowerCase().includes(s.SOURCE_3DPLAN)||e.pid.includes("uuid")?t.rdfIDs.push({id:e.pid}):t.erIDs.push({id:e.pid})}),t.erIDs=[...new Set(t.erIDs)],t.sourcingIDs=[...new Set(t.sourcingIDs)],t.rdfIDs=[...new Set(t.rdfIDs)],t},u.prototype.processListItemsData=function(e){let t=[];return e.map(e=>{let i={title:e.title||e["ds6w:label"]+(e.revision||e["ds6w:revision"]?" ("+e.revision||e["ds6w:revision"]+")":""),id:e.id||e.resourceid,preview_url:e.image||e.preview_url,image:e.image||e.preview_url,modificationDate:e.modified||e["ds6w:modified"],owner:e.ownerFullname||e["ds6w:responsible"],type:e.type||e["ds6w:type"],typeNLS:e.typeNLS,projectSpace:e.collabSpace||"",state:e.stateNLS,revision:e.revision,name:e.name};t.push({grid:i,label:i.title,thumbnail:i.preview_url?i.preview_url.includes("https")?require.toUrl(i.preview_url):i.preview_url:"",id:i.id})}),t},u.prototype.getTypeFromTypeHierarchy=function(e,t,i){let n="";return e.length<1||i.includes(t)?n=t:e.forEach(function(e){i.includes(e)&&(n=e)}),n},u.prototype.processContextData=function(e){var t=this,n=[],a=i.getPlatformId()===s.ONPREMISE?[s.SOURCE_3DSPACE]:[s.SOURCE_3DSPACE,s.SOURCE_SOURCING,s.SOURCE_3DPLAN],r={completePreCond:e&&e.contains("uuid")?'uri:"'+e+'"':"physicalid="+e,nresults:1};return new Promise(i=>{var l=this.searchUtility.getSearchPayload(e,[],a,r);o.getFederatedSearchDataPromise({searchPayLoad:l}).then(function(n){var a=t.getActualDataFromSearch(n,e)||{};let o=a["ds6w:what/ds6w:type_value"]||a["ds6w:what/ds6w:type"],r={"ds6w:status":[a["ds6w:what/ds6w:status"]],"ds6w:type":[o]};t.searchUtility.getNlsOfPropertiesValues(r).then(function(e){t.NLSpropKeyVal=e,t.NLSpropKeyVal["ds6w:type"]&&(a["ds6w:what/ds6w:type_value"]||a["ds6w:what/ds6w:type"])&&(a.contextNLSType=t.NLSpropKeyVal["ds6w:type"][a["ds6w:what/ds6w:type_value"]||a["ds6w:what/ds6w:type"]]),a.contextNLSType||!a["ds6w:what/ds6w:type_value"]&&!a["ds6w:what/ds6w:type"]||(a.contextNLSType=a["ds6w:what/ds6w:type_value"]||a["ds6w:what/ds6w:type"]),t.NLSpropKeyVal["ds6w:status"]&&(a.contextNLSState=t.NLSpropKeyVal["ds6w:status"][a["ds6w:what/ds6w:status"]]),!a.contextNLSState&&a["ds6w:what/ds6w:status"]&&(a.contextNLSState=a["ds6w:what/ds6w:status"]),i(a)}).catch(function(){i(a)})},function(e){widget.notificationUtil.showError(e),i(n)})})},u.prototype.getEditAccess=function(e){return!(!e||"true"!==e.toLowerCase())},u.prototype.formatTooltip=function(e){let t="";return e.forEach(function(e){""!==e.data&&void 0!==e.data&&(""!==t&&(t+="\n"),t=t+e.label+": "+e.data)}),t},u.prototype.getCustomTooltip=function(t){let{title:i,typeNLS:a,revision:o,state:r,owner:l,modificationDate:s,name:d}=t.options.grid,c=[{label:e.title,data:i},{label:e.type,data:a},{label:e.revision,data:o},{label:e.MATURITY,data:r},{label:e.owner,data:l},{label:e.modificationDate,data:n.getDateStringForDisplay(s)},{label:e.name,data:d}];return this.formatTooltip(c)},u.prototype.getDescription=function(e){let{typeNLS:t,revision:i,state:a,owner:o,modificationDate:r,name:l}=e.options.grid,s={type:t,revision:i,state:a,owner:o,formattedDate:n.getDateStringForDisplay(r),name:l};return Object.values(s).filter(e=>e).join(" | ")},u.prototype.getProxyItemId=function(t){var i=this;let n=[];var a={data:[]};return t.forEach(e=>{let t=e.title,i=e.sourceid?e.sourceid.split(":")[0]:"",n=e.sourceid?e.sourceid.split(":")[1]:"",o=e.actualType;a.data.push({id:e.id,type:e.proxyType,dataelements:{"ProxyItem.Proxy_Title":t,"ProxyItem.Proxy_Service":i,"ProxyItem.Proxy_State":e.state,"ProxyItem.Proxy_Tenant":n,"ProxyItem.Proxy_URL":"/"+e.id,"ProxyItem.Proxy_Type":o}})}),new Promise((o,r)=>{i.model.getProxyObjectId({data:a}).then(function(e){e&&t.forEach(t=>{e[t.id]&&n.push(e[t.id])}),o(n)}).catch(function(){var t={level:"error",subtitle:e.error_getting_proxy_sourcing,sticky:!1,allowUnsafeHTML:!1};window.notifs.addNotif(t),r(n)})})},u.prototype.processQualificationData=function(t,n){let a=[];return t.data&&(a=t.data.map(a=>{let o=a.relateddata.Context?a.relateddata.Context.filter(e=>e.id===n||e.dataelements.Proxy_Id===n)[0]:"";o=o||a.relateddata.Context[0];let r=a.relateddata.target?a.relateddata.target[0]:"",l=a.relateddata.PreReq?a.relateddata.PreReq[0]:"",d=t.data.objectInfodata.filter(e=>e.id===r.dataelements.Proxy_Id)[0],c=a.relateddata.prereqof?a.relateddata.prereqof:[],u=t.data.objectInfodata.filter(e=>e.id===o.dataelements.Proxy_Id)[0],p=l?t.data.objectInfodata.filter(e=>e.id===l.dataelements.Proxy_Id)[0]:{},g=[];c&&c.forEach(e=>{t.data.objectInfodata.forEach(t=>t.id===e.dataelements.Proxy_Id?g.push(t):"")});let f={id:a.id,type:a.type,displayGenericType:"SRC Usage Qualification"===a.type?e.usage_qualification:"SRC General Qualification"===a.type?e.general_qualification:e.equivalent_qualification,restriction:a.dataelements.Restriction,qualificationType:a.type,name:a.dataelements.name,revision:a.dataelements.revision,maturityState:a.dataelements.stateDisplay,state:a.dataelements.state,preferred:a.dataelements["SRC Preferred"],ValidationLevel:a.relateddata["interface-details"]&&a.relateddata["interface-details"].length>0?a.relateddata["interface-details"][0].children[0].dataelements.value:"",prereqId:a.dataelements.PreReq_ID?a.dataelements.PreReq_ID:"",orderable:a.dataelements["SRC Is Orderable"],comments:a.dataelements["SRC Comments"],modifyAccess:a.dataelements.modifyAccess,changeAccess:a.dataelements.changesov,owner:a.dataelements.owner,modified:a.dataelements.modified,created:a.dataelements.originated,image:require.toUrl("ENOXGenericQualification/assets/icons/Qualification-Thumbnail.png"),target:d,context:u,prerequisite:p,prereqof:c,approved:a.dataelements["SRC Approved"],contexts:a.relateddata.Context,sourceId:a.source,effectivityStartDate:a.dataelements["Effectivity Start Date"],effectivityEndDate:a.dataelements["Effectivity End Date"],isProofExists:a.dataelements.isProofExists,collabSpace:a.dataelements.collabSpace,organization:a.dataelements.organization,title:a.dataelements.title,additionalContexts:[]};i.getPlatformId()!==s.ONPREMISE?(f.context.context_ProxyId=o.id,f.additionalContexts=a.relateddata.Context.length>1&&a.relateddata.Context.filter(e=>e.dataelements.Proxy_Id!==n)):f.additionalContexts=a.relateddata.Context.length>1&&a.relateddata.Context.filter(e=>e.id!==n),f.additionalContexts=f.additionalContexts?f.additionalContexts:[],f.contexts.forEach((e,i,n)=>{n[i].objectInfodata=t.data.objectInfodata.filter(t=>t.id===e.dataelements.Proxy_Id)[0]}),f.additionalContexts.forEach((e,i,n)=>{n[i].objectInfodata=t.data.objectInfodata.filter(t=>t.id===e.dataelements.Proxy_Id)[0]}),f.prereqof.forEach((e,i,n)=>{n[i]=t.data.objectInfodata.filter(t=>t.id===e.id)[0]});let h=a.relateddata["interface-details"];if(h&&h.length>0){var m=[];h.forEach(function(e){var t={label:e.dataelements.displayName?e.dataelements.displayName:e.dataelements.description?e.dataelements.description:e.id,options:e.children,name:e.id};m.push(t)}),f.extensionDetails=m}return{grid:f,label:f.name,id:f.id}})),a},u.prototype.getActualDataFromSearch=function(e,t){if(!e.results)return{};var i=e.results.filter(e=>{return e.attributes.filter(e=>("physicalid"===e.name||"resourceid"===e.name)&&e.value===t).length>0}),n={};return i.length>0&&i[0].attributes.forEach(e=>{e.dispValue?(n[e.name]=e.dispValue,e.dispValue!==e.value&&(n[e.name+"_value"]=e.value)):n[e.name]=e.value}),n},u.prototype.processFedSearchData=function(e){if(!e.results)return[];let t=[];return e.results.forEach(e=>{let i={};e.attributes.forEach(e=>{e.dispValue?(i[e.name]=e.dispValue,e.dispValue!==e.value&&(i[e.name+"_value"]=e.value)):i[e.name]=e.value}),t.push(i)}),t},u.prototype.processReviseObjectsToConnect=function(t){let i={objectToConnect:["prereq"]};return t===s.QUALIFICATION_TARGET_DETAILS_VIEW?(i.objectToConnect.push("context"),i.reviseConfirmationMessage=e.qual_revise_confirmation_CtxPrereq):t===s.QUALIFICATION_CONTEXT_DETAILS_VIEW&&(i.objectToConnect.push("target"),i.reviseConfirmationMessage=e.qual_revise_confirmation_TargetPrereq),i},u.prototype.getRevisePayload=function(e){return{data:[{id:e,dataelements:{securityContext:o.getSecurityContext()}}]}},u.prototype.renderPropertiesView=function(e){let t={container:e._triptychWrapper.getRightPanelContainer(),facets:["FACET_PROPERTIES","FACET_SWYMCOMMENTS","FACET_RELATIONS"]},i={objectId:e.id};e.applicationChannel.publish({event:"xsourcing-collectionview-selected-object-id",data:{selectedObject:!0,openDetails:function(){new l({viewOptions:t,dataOptions:i}).render()},...e.id.includes("uuid")?{isRDFObject:!0}:{}}})},u.prototype.getDecoratorData=function(t,i){let a=n.getDateStringForDisplay(t.getAttributeValue("modified")),o="",r="";return t.getAttributeValue("additionalContexts").forEach(e=>{o=o.concat(`${e.label}, `)}),t.getAttributeValue("contexts").forEach(e=>{r=r.concat(`${e.label}, `)}),[{label:e.qualification,content:t.getAttributeValue("name")},...i===s.QUALIFICATION_CONTEXT_DETAILS_VIEW?[{label:e.qualification+" "+e.target,content:`${t.getAttributeValue("target").title} (${t.getAttributeValue("target").revision})`}]:[{label:e.qualification+" "+e.contexts,content:r.substring(0,r.length-2)}],...""!==t.getAttributeValue("restriction")?[{label:e.restriction,content:t.getAttributeValue("restriction")}]:[],{label:e.status,content:"No"===t.getAttributeValue("approved")?e.rejected:"Yes"===t.getAttributeValue("approved")?e.approved:e.pending},{label:e.MATURITY,content:t.getAttributeValue("state")},{label:e.owner,content:t.getAttributeValue("owner")},{label:e.modification_date,content:a},...t.getAttributeValue("prerequisite")?[{label:e.prerequisite,content:`${t.getAttributeValue("prerequisite")[0].title} (${t.getAttributeValue("prerequisite")[0].revision})`}]:[],...t.getAttributeValue("additionalContexts").length>0&&i===s.QUALIFICATION_CONTEXT_DETAILS_VIEW?[{label:e.additional_contexts,content:o.substring(0,o.length-2)}]:[],...this.getExtensionColumns(t.getAttributeValue("extensionColumns"))]},u.prototype.getExtensionColumns=function(e){var t=this,i=[];return e&&e.forEach(e=>{let a="timestamp"===e.type&&n.getDateStringForDisplay(e.value);""!==e.value&&i.push({label:e.displayName,content:e.displayRanges&&"timestamp"!==e.type?t.commonUtility.processLabelValue(e.range,e.displayRanges).filter(t=>t.value===e.value)[0].label:"timestamp"===e.type?a.substring(0,a.lastIndexOf(",")):e.value})}),i},u.prototype.createUWADiv=function(e,t){return UWA.createElement("div",{class:e,...t?{id:t}:{}})},u.prototype.getCellValueHtmlForMultipleItems=function(e){for(var t=UWA.createElement("div",{class:"additionalContextsContainer"}),i=0;i<e.length;i++){let n=e[i].title?e[i].title:e[i].objectInfodata.title,a=e[i].revision?e[i].revision:"";a=a||(e[i].objectInfodata?e[i].objectInfodata.revision:"");let o=e[i].typeNLS?e[i].typeNLS:e[i].objectInfodata.typeNLS,r=a?n+" ("+a+")":n;UWA.createElement("a",{class:"wux-tweakers-string-label",html:`${o}: ${r}`,href:`javascript:widget.hyperLinkClickCallback('${e[i].id?e[i].id:e[i].objectInfodata.id}');`}).inject(t),i<e.length-1&&UWA.createElement("span",{html:","}).inject(t)}return t.outerHTML},u.prototype.addingTypeRepresentations=function(t){t._xsourcingCollectionViewUI._dataGridView.getTypeRepresentationFactory().registerTypeRepresentations(JSON.stringify(this.addDropDownTypeRepresentation("statusDropDown",[{value:"",label:e.pending},{value:"Yes",label:e.approved},{value:"No",label:e.rejected}])))},u.prototype.addDropDownTypeRepresentation=function(e,t){return{[e]:{stdTemplate:"enumCombo",semantics:{valueType:"enumString",possibleValues:t}}}},u.prototype.processDataForRelationsTab=function(e){return new Promise(i=>{let n=this,a=e.data.target.id,o=e.data.prereqId,r=[],l="",s="";a&&(l="target",s=t.qualification_target,r.push({isHeader:!0,relIdentifier:l,label:s,contentItems:n.getGridForRelatedItem(e.data.target)})),e.data.contexts.forEach(e=>{s=t.qualification_context,l="context",s&&!r.map(e=>e.relIdentifier).includes(l)?r.push({isHeader:!0,relIdentifier:l,label:s,contentItems:n.getGridForRelatedItem(e.objectInfodata)}):r.find(e=>e.relIdentifier===l).contentItems.push(...n.getGridForRelatedItem(e.objectInfodata))}),o&&(s=t.qualification_prereq,l="prereq",r.push({isHeader:!0,relIdentifier:l,label:s,contentItems:n.getGridForRelatedItem(e.data.prerequisite)})),e.data.prereqof&&e.data.prereqof.length>0&&e.data.prereqof.forEach(e=>{s=t.qualification_prereq_of,l="prereqof",s&&!r.map(e=>e.relIdentifier).includes(l)?r.push({isHeader:!0,relIdentifier:l,label:s,contentItems:n.getGridForRelatedItem(e)}):r.find(e=>e.relIdentifier===l).contentItems.push(...n.getGridForRelatedItem(e))}),e.data.qualificationProofs&&e.data.qualificationProofs.forEach(e=>{s=t.qualification_proofs,l="qualificationProofs",s&&!r.map(e=>e.relIdentifier).includes(l)?r.push({isHeader:!0,relIdentifier:l,label:s,contentItems:n.getGridForRelatedItem(e)}):r.find(e=>e.relIdentifier===l).contentItems.push(...n.getGridForRelatedItem(e))}),n.handleTranslations(r,i)})},u.prototype.handleTranslations=function(e,t){let i={"ds6w:status":[],"ds6w:type":[]};e.forEach(e=>{e.contentItems.forEach(e=>{i["ds6w:status"].push(e.grid.maturity),i["ds6w:type"].push(e.grid.type)})}),this.searchUtility.getNlsOfPropertiesValues(i).then(function(t){e.forEach(e=>{e.contentItems.forEach(e=>{e.grid.maturityDisplay=t["ds6w:status"][e.grid.maturity]?t["ds6w:status"][e.grid.maturity]:e.grid.maturity,e.grid.typeDisplay=t["ds6w:type"][e.grid.type]?t["ds6w:type"][e.grid.type]:e.grid.type})})}).finally(function(){t(e)})},u.prototype.getGridForRelatedItem=function(e){return[{grid:{title:e.title,name:e.name,revision:e.revision,modificationDate:e.modified,owner:e.ownerFullname,maturity:e.stateNLS,type:e.type,organization:e.organization},thumbnail:e.image,id:e.id}]},u.prototype.getDataforDnD=function(e,t){return[{options:{grid:{actualType:"name"===e?s.TYPE_QUALIFICATION_LIST[2]:"context"===e?t.getAttributeValue("additionalContexts")[0].type:t.getAttributeValue("target").type,displayType:"name"===e?t.getAttributeValue("type"):"context"===e?t.getAttributeValue("additionalContexts")[0].typeNLS:t.getAttributeValue("target").typeNLS,id:"name"===e?t.getAttributeValue("id"):"context"===e?t.getAttributeValue("additionalContexts")[0].id:t.getAttributeValue("target").id},label:"name"===e?t.getAttributeValue("name"):"context"===e?t.getAttributeValue("additionalContexts")[0].label:`${t.getAttributeValue("target").title} (${t.getAttributeValue("target").revision})`}}]},u.prototype.getLifecycleEventObject=function(e,t){return{From:"Lifecycle",Refresh:{created:"revise"===e?[{physicalid:t.id,sourceObjectId:t.tempId,operation:"Revise",refreshPSD:!0}]:[],deleted:"delete"===e?t:[],modified:[],..."delete"===e&&{restored:[]},context:null,..."revise"===e&&{refreshFolder:!1}},AppID:null,OriginID:null,tenant:i.getPlatformId()}},u.prototype.getFileNameForExport=function(e){return(e=e.replaceAll(" ","_"))+"_"+((new Date).getFullYear().toString()+((new Date).getMonth()+1).toString()+(new Date).getDate().toString()+(new Date).getHours().toString()+(new Date).getMinutes().toString())+"_"+i.getPlatformId()+".csv"},u.prototype.gettypeRepresentationForDataindex=function(t,i){let n=i.find(e=>e.dataIndex===t);if(!n){n=i.find(t=>t.text===e.qualification).children.find(e=>e.dataIndex===t)}return n&&n.typeRepresentation?n.typeRepresentation:""},u.prototype.convertFedSearchDataInObjectinfoResponseFormat=function(e){let t=[];return e.forEach(e=>{t.push({id:e.resourceid,identifier:e.resourceid,title:e["ds6w:label"],type:e["ds6w:type"],typeNLS:e["ds6w:type"],revision:e["ds6w:revision"]||"",state:e["ds6w:status"],stateNLS:e["ds6w:status"],ownerFullname:e["ds6w:responsible"],name:e["ds6w:label"],image:e.preview_url,modified:e["ds6w:when/ds6w:modified"],source:e.sourceid||""})}),t},u.prototype.getUpdateTargetContextPayload=async function(e,t,i){let n={},a=[],o=[{dataelements:{idToConect:t,idToDisconnect:i}}];"Contexts"===e[0].getAttributeValue("id")&&(n.Context=o),"Target Items"===e[0].getAttributeValue("id")&&(n.target=o);var r={type:s.TYPE_QUALIFICATION_LIST[2],relateddata:n};return a.push(r),{data:a}},u.prototype.getSearchDataforUpdateTargetContext=async function(e){var t={completePreCond:e,nresults:999};let i=r.prototype.getSearchPayload([],[],[],t),n=await r.prototype.callFederatedSearch(i),a=n.results?u.prototype.processFedSearchData(n):[];return a=await u.prototype.processForNLSProperties(a)},u.prototype.getSearchOptionsfor3dSearchtoUpdateTargetContext=async function(e,t){let i={},n=t.idsToExclude,a=[],o="";return t.queryString?o=t.queryString:("Contexts"!==e.id&&"Contexts"!==e.grid.parentName||((a=widget.getValue(s.QUALIFICATION_CONTEXT_ALLOWED_TYPES)).map(function(e){s.DSPLAN_PROJECT===e?o+='[dsplan:type]:"'+e+'"'+s.OR:o+=' flattenedtaxonomies:"types/'+e+'"'+s.OR}),o=o.substring(0,o.length-3)),"Target Items"!==e.id&&"Target Items"!==e.grid.parentName||((a=widget.getValue(s.QUALIFICATION_TARGET_ALLOWED_TYPES)).map(function(e){o+=' flattenedtaxonomies:"types/'+e+'"'+s.OR}),o=o.substring(0,o.length-3))),i.completePreCond="( "+o+' )  AND ( NOT([ds6w:kind]:"'+s.MEI_EXTENSION+'") )',i.resourceid_not_in=n,i.multiSel=t.multiSel,i.sources=[],i.callbackMethod=t.callbackfunction,(new c).init(i),i},u.prototype.getRootNodeDefinition=function(e,t,i,n){var a={tree:t,name:"",typeDisplay:"",id:e,revision:"",maturityDisplay:"",isLatestRevision:"",modificationDate:"",image:n};return{grid:a,label:a.tree,id:a.id,children:i}},u.prototype.getChildNodeDefinition=function(e,t,n){let a=[];return e.forEach(e=>{let o=t.filter(t=>t.resourceid===(e.dataelements?e.dataelements.Proxy_Id:e.resourceid));var r={tree:o[0]["ds6w:label"],name:o[0].name||o[0]["ds6w:identifier"],typeDisplay:o[0]["ds6w:what/ds6w:type"]||o[0]["ds6w:type"],actualType:o[0].type_Actual||o[0]["ds6w:type_value"],id:o[0].id?o[0].id:o[0].resourceid,revision:o[0]["ds6wg:revision"]?o[0]["ds6wg:revision"]:"",maturityDisplay:o[0]["ds6w:what/ds6w:status"]||o[0]["ds6w:status"],isLatestRevision:o[0]["ds6w:when/ds6w:isLastRevision"]||o[0]["ds6w:isLastRevision"]?o[0]["ds6w:when/ds6w:isLastRevision"]||o[0]["ds6w:isLastRevision"]:"false",modificationDate:o[0]["ds6w:when/ds6w:modified"]||o[0]["ds6w:modified"],image:o[0].type_icon_url,parentName:n,proxyId:i.getPlatformId()===s.ONPREMISE?e.proxyId||e.dataelements.Proxy_Id:e.dataelements&&e.dataelements.physicalid?e.dataelements.physicalid:o[0].proxyId},l={grid:r,label:r.tree,id:r.id};a.push(l)}),a},u.prototype.processForNLSProperties=async function(e){let t=[],i=[];e.forEach(e=>{i.push(e["ds6w:what/ds6w:type_value"]||e["ds6w:what/ds6w:type"]),t.push(e["ds6w:what/ds6w:status"])});let n={"ds6w:status":t,"ds6w:type":i},a=await r.prototype.getNlsOfPropertiesValues(n);return e.forEach(e=>{e["ds6w:what/ds6w:type_value"]&&(e.type_Actual=e["ds6w:what/ds6w:type"],e["ds6w:what/ds6w:type_value"]=a["ds6w:type"][e["ds6w:what/ds6w:type_value"]]),e["ds6w:what/ds6w:type"]&&(e.type_Actual=e["ds6w:what/ds6w:type"],e["ds6w:what/ds6w:type"]=a["ds6w:type"][e["ds6w:what/ds6w:type"]]),e["ds6w:what/ds6w:status"]&&(e["ds6w:what/ds6w:status"]=a["ds6w:status"][e["ds6w:what/ds6w:status"]])}),e},u}),define("DS/ENOXGenericQualification/views/Qualification/QualificationContexts/ListQualificationContexts",["DS/UIKIT/Mask","i18n!DS/ENOXGenericQualification/assets/nls/ENOXGenericQualification","i18n!DS/ENOXSourcingUXInfra/assets/nls/ENOXSourcingUXInfra","DS/ENOXSourcingUXInfra/xsourcingCollectionView/xsourcingCollectionView","DS/ENOXSourcingUXInfra/EmptyContent/ENOXSourcingEmptyContent","DS/ENOXGenericQualification/views/Qualification/SearchQualificationItem","DS/ENOXSourcingUXInfra/Constants/ENOXSourcingConstants","DS/UIKIT/SuperModal","DS/ENOXSourcingUXInfra/openwithservice/ENOXSourcingOpenWithService"],function(e,t,i,n,a,o,r,l,s){"use strict";var d=function(e){this.controller=e,this.helper=e.helper};return d.prototype.openDetailsFunction=async function(e){var n=this;let a=(e=Array.isArray(e)?e:[e]).map(e=>({pid:e.pid||e.objectId||e.id,label:e.label||e.displayName,name:e.name||e.displayName,type:e.type||e.displayType,sourceid:e.sourceId||e.serviceId,title:e.displayName||e.label}));if(e[0].objectType===r.TYPE_QUALIFICATION_LIST[2]){let e={data:{params:{qualificationId:a[0].pid}}};n.controller.model.getDetails(e).then(function(e){let i=e.data[0];if(i.relateddata.target[0].dataelements.interface!==r.MEI_EXTENSION&&i.relateddata.target[0].dataelements.type!==r.MEI_PROXY){let e=n.options.detailsRoutePath===r.QUALIFICATION_CONTEXT_DETAILS_VIEW?i.relateddata.Context[0].dataelements.Proxy_Id||i.relateddata.Context[0].id:i.relateddata.target[0].dataelements.Proxy_Id||i.relateddata.target[0].id;n.options.router.navigate(n.options.detailsRoutePath,{id:e,qualIdToHighlight:a[0].pid})}else widget.notificationUtil.showError(t.openWithSPIQ)})}else{let e=a.map(e=>e.pid),o=await n.controller.searchUtility.getNonIndexedObjectIds(e);o.length>0&&(widget.notificationUtil.showError(t.one_or_more_object_not_indexed),o.forEach(function(e){a=a.filter(t=>t.pid!==e)})),a.map((e,a)=>{n.helper.processContextData(e.pid).then(function(o){let l=o,s=l["ds6w:what/ds6w:kind_value"]||l["ds6w:what/ds6w:kind"],d=l["ds6w:what/ds6w:type_value"]||l["ds6w:what/ds6w:type"],c="",u=[],p=n.options.detailsRoutePath===r.QUALIFICATION_CONTEXT_DETAILS_VIEW?widget.getValue(r.QUALIFICATION_CONTEXT_ALLOWED_TYPES):widget.getValue(r.QUALIFICATION_TARGET_ALLOWED_TYPES);n.controller.gettypeshierarchy([d]).then(function(o){u=o.types_hierarchies[0].hierarchy,c=n.helper.getTypeFromTypeHierarchy(u,d,p),0===Object.keys(l).length?widget.notificationUtil.showError(i.object_not_found_not_indexed):p.includes(c)&&s!==r.MEI_EXTENSION?(n.controller.addToWidgetTracker([e],n.options.recentTrackerWidgetPreference,n.options.listViewMaxSize),0===a&&n.options.router.navigate(n.options.detailsRoutePath,e)):widget.notificationUtil.showError(t.invalid_object_dropped)}).catch(function(){widget.notificationUtil.showError(t.internal_server_error)})})})}},d.prototype.render=function(l){var d=this;d.options=l,l.applicationChannel=this.controller.app._applicationChannel,l.app=this.controller.app,l._triptychWrapper=this.controller.app._triptychWrapper,l._mediator=this.controller.app._mediator,l.platformServices=this.controller.app.platformServices,l.router=this.controller.app.router,l._triptychWrapper.getMainPanelContainer().innerHTML="";var c=widget.getElement(".information-panel.panel-icon-wrapper");if(c&&c.style.removeProperty("display"),l.applicationChannel.publish({event:"xsourcing-collectionview-unselected-object-id",data:{selectedObjectId:null}}),l.container=l.externalContainer?l.externalContainer:l._triptychWrapper.getMainPanelContainer(),l.uniqueIdentifier=l.app.router.getState().name===r.QUALIFICATION_CONTEXT_DETAILS_VIEW?"QualificationContextsListPage":"QualificationTargetsListPage",l.dropStrategy="OPEN",l.multiObjs=!0,l.onDropCallback=function(e){d.openDetailsFunction(e)},l.emptyDataButtonCallback=function(){l.nxtNavigationPath=l.detailsRoutePath,l.callbackmethod=d.openDetailsFunction.bind(d),(new o).init(l)},0===l.data.length){l.dropArea=l.container,l.emptyContentArea=l.container;var u=new a;l.emptyDataButtonLabel=i.search_for_content,l.dropIconLabel=i.DropInvit_drop,l.emptyDataButtonIcon="search",u.init(l),require(["DS/ENOXSourcingUXInfra/DragAndDrop/ENOXSourcingDataDragAndDrop"],function(e){(new e).makeAreaDroppable(l)})}else{l.hideTitle=!0,l.views=["Large Tile","Tile"],l.columnsConfigurations=[],l.toolbarActions=[],l.showItemCount=!1,l.disableNoDataMessage=!0,l.expandallBtn=!0,l.toolbarActions.push({id:"openNew",text:t[l.open_search_command],fonticon:"part-add wux-ui-3ds",handler:function(){l.emptyDataButtonCallback()}},{id:"remove",text:t.remove,fonticon:"remove",disabled:!0,handler:function(){d.removeItems(d,l)}}),l.onContextualEventCallback=function(e){var n=[];if(e){var a=e.cellInfos&&e.cellInfos.nodeModel?e.cellInfos.nodeModel:null;if(-1===(e.cellInfos?e.cellInfos.rowID:null)||!a)return this._contextualMenuBuilder?this._contextualMenuBuilder.buildMenu(e,l):[];var o=e.cellInfos.nodeModel?e.cellInfos.nodeModel:e.cellInfos.cellModel;o.options.grid.id=o.options.grid.id?o.options.grid.id:o.options.id?o.options.id:"",o.options.grid.actualType=o.options.grid.actualType?o.options.grid.actualType:o.options.grid.type?o.options.grid.type:"";var r=o.options.grid;if(o)return n.push({id:"OpenItem",type:"PushItem",title:t.open,fonticon:{content:"wux-ui-3ds wux-ui-3ds-open"},action:{callback:function(){d.controller.app.router.navigate(l.detailsRoutePath,r)}}}),s.getOpenWithMenu(o).then(function(e){return n.push({id:"OpenWith",type:"PushItem",title:i.open_with,icon:"open-menu-dot",submenu:e}),n},function(){return n})}return n},l.getCustomTooltip=this.helper.getCustomTooltip.bind(this.helper),l.getLargeTileCustomTooltip=this.helper.getCustomTooltip.bind(this.helper),l.getSubLabel=this.helper.getDescription,l.getLargeTileSubLabel=this.helper.getDescription,l.displayedOptionalCellProperties=["contextualMenu","subtitle"];var p=new n;l.sort=[{id:"title",text:t.title,type:"string"}],l.expandChildren=!0,l.showToolbar=!0,l.showToolbarInfoIcon=!0,l.showMobileWelcomePanelIcon=!0,l.multiObjs=!0,d.xsourcingCollectionView=p,p.init(l),p.collectionViewEvents.subscribe({event:"xsourcing-collectionview-cell-dblclick"},function(e){d.controller.app.router.navigate(l.detailsRoutePath,e)}),p.collectionViewEvents.subscribe({event:"xsourcing-collectionview-selection-updated"},function(e){e.selectedItems.length>0?(p.collectionViewEvents.publish({event:"xsourcing-collectionview-enable-toolbar-button",data:"remove"}),1===e.selectedItems.length?d.helper.renderPropertiesView({id:e.selectedItems[0].id,applicationChannel:d.controller.app._applicationChannel,_triptychWrapper:d.controller.app._triptychWrapper}):l.applicationChannel.publish({event:"xsourcing-collectionview-selected-object-id",data:{selectedObject:"multipleSelected"}})):(p.collectionViewEvents.publish({event:"xsourcing-collectionview-disable-toolbar-button",data:"remove"}),l.applicationChannel.publish({event:"xsourcing-collectionview-unselected-object-id",data:{selectedObject:null}}))}),l.dropArea=p._xsourcingCollectionViewUI.viewContainer,require(["DS/ENOXSourcingUXInfra/DragAndDrop/ENOXSourcingDataDragAndDrop"],function(e){(new e).makeAreaDroppable(l)})}e.unmask(widget.body)},d.prototype.removeItems=function(e,i){if(i.selectedNodes=e.xsourcingCollectionView._gridModel.getSelectedNodes(),i.selectedNodes.length>0){var n=new l({renderTo:widget.body,okButtonText:t.remove}),a=1===i.selectedNodes.length?i.selectedNodes[0].options.label:i.selectedNodes.length+" "+t[i.removeRecentDialogTitle];n.confirm(t.remove_confirmation,t.remove+" - "+a,function(t){t&&e.controller.removeItemsDataGridView(i).then(function(){0===e.xsourcingCollectionView._gridModel.getChildren().length&&e.controller.list(i)})})}},d}),define("DS/ENOXGenericQualification/views/Qualification/QualificationContexts/ScopeView",["UWA/Core","UWA/Class/View","DS/UIKIT/Mask","i18n!DS/ENOXSourcingUXInfra/assets/nls/ENOXSourcingUXInfra","DS/ENOXSourcingUXInfra/xsourcingCollectionView/xsourcingCollectionView","DS/Utilities/Dom","DS/TreeModel/TreeNodeModel","i18n!DS/ENOXGenericQualification/assets/nls/ENOXGenericQualification","DS/ENOXSourcingUXInfra/openwithservice/ENOXSourcingOpenWithService","DS/ENOXSourcingUXInfra/Search/SearchUtility","DS/ENOXSourcingUXInfra/service/ENOXSourcingPlatformServices","DS/ENOXSourcingUXInfra/Constants/ENOXSourcingConstants","DS/ENOXGenericQualification/helpers/QualificationHelper"],function(e,t,i,n,a,o,r,l,s,d,c,u,p){"use strict";return t.extend({name:"scopeview-view",tagName:"div",source:"sourcing",template:function(){return'<div class="'+this.getClassNames("-subcontainer")+'"></div>'},domEvents:{},init:function(e){this.model=e.model,this.modelEvent=this.model.get("modelEvent"),this.infoContainer=this.model.get("infoContainer"),["container","template","tagName","domEvents"].forEach(function(t){delete e[t]}),this._parent(this,e)},setup:function(){this.container.addClassName(this.getClassNames("-container"))},render:function(){var t=this;this.container.empty(),this.outerDiv=e.createElement("div",{class:"scope-outerDiv",styles:{height:"90%"}}).inject(this.container),i.mask(this.container,n.Loading);var r={data:[]};return t.loadData(),r._mediator=t.model.get("mediator"),r.showToolbar=!0,r.uniqueIdentifier="ScopeView",t.membersCollectionUIObj=new a,r.toolbarActions=t.model.get("isToolBarEnabled")?[{fonticon:"plus",text:n.add,content:[{id:"insertByExisting",text:l.insert_existing,fonticon:"replace-by-existing",disabled:!0,handler:function(){t.model.get("controller").insertByExistingHandler(t.scopeViewUIObj,t.model.get("id"),t.model.get("updateQualificationTable"))}},{id:"replaceByLatestRevision",text:l.replace_by_latest_revision,fonticon:"replace-by-latest-version",disabled:!0,handler:function(){t.model.get("controller").replaceByLatestRevisionHandler(t.scopeViewUIObj,t.model.get("id"),t.model.get("updateQualificationTable"))}},{id:"replaceByExisting",text:l.replace_by_existing,fonticon:"replace-by-existing",disabled:!0,handler:function(){t.model.get("controller").replaceByExistingHandler(t.scopeViewUIObj,t.model.get("id"),t.model.get("updateQualificationTable"))}},{id:"replaceByRevision",text:l.replace_by_revision,fonticon:"replace-by-revision",disabled:!0,handler:function(){t.model.get("controller").replaceByRevisionHandler(t.scopeViewUIObj,t.model.get("id"),t.model.get("updateQualificationTable"))}}]},{fonticon:"remove",text:n.remove,id:"remove",disabled:!0,handler:function(){t.model.get("controller").removeTargetContextScopeTabHandler(t.scopeViewUIObj,t.model.get("id"),t.model.get("updateQualificationTable"))}}]:[{fonticon:"plus",text:n.add,disabled:!0,content:[]},{fonticon:"remove",text:n.remove,disabled:!0}],r.columnsConfigurations=[{text:n.title,dataIndex:"tree",resizableFlag:!0,sortableFlag:!0,pinned:"left",width:"250",typeRepresentation:"url",hyperlinkTarget:"_self",getCellValue:function(e){return{icon:{iconPath:e.nodeModel.options.grid.image,iconSize:{height:"20px",width:"20px"}},label:e.nodeModel.options.label,url:"javascript:;",hyperlinkClickCallback:void 0}}},{text:n.TYPE,dataIndex:"typeDisplay"},{text:n.name,dataIndex:"name",width:200},{text:n.revision,dataIndex:"revision",width:200},{text:n.MATURITY,dataIndex:"maturityDisplay",width:200},{text:n.isLast,dataIndex:"isLatestRevision",typeRepresentation:"url",getCellValue:function(e){let t="";return 0!==e.nodeModel.getAttributeValue("revision").length&&(t="true"===e.nodeModel.getAttributeValue("isLatestRevision")?"check":"close"),{icon:t}},width:200},{text:n.modified,dataIndex:"modificationDate",width:200,typeRepresentation:"datetime"}],r.views=["Grid"],r.displayedOptionalCellProperties=["contextualMenu","subtitle"],r.onContextualEventCallback=async function(e){var i=[];let a=e.cellInfos.nodeModel?e.cellInfos.nodeModel:e.cellInfos.cellModel,o=t.model.get("controller").detailsView.relatedQualificationsView?t.model.get("controller").detailsView.relatedQualificationsView.data.currentContextId:"";if("Contexts"===e.cellInfos.nodeModel.options.grid.id&&t.model.get("isToolBarEnabled")?i.push({type:"PushItem",title:l.insert_existing,fonticon:{content:"wux-ui-3ds wux-ui-3ds-replace-by-existing"},action:{callback:function(){t.scopeViewUIObj.contextualMenuNode=a.options,t.model.get("controller").insertByExistingHandler(t.scopeViewUIObj,t.model.get("id"),t.model.get("updateQualificationTable"))}}}):"Contexts"===e.cellInfos.nodeModel.getParent().options.grid.id&&t.model.get("isToolBarEnabled")&&e.cellInfos.nodeModel.getAttributeValue("id")!==o&&(i=[{type:"PushItem",title:l.replace_by_latest_revision,fonticon:{content:"wux-ui-3ds wux-ui-3ds-replace-by-latest-version"},action:{callback:function(){t.scopeViewUIObj.contextualMenuNode=a.options,t.model.get("controller").replaceByLatestRevisionHandler(t.scopeViewUIObj,t.model.get("id"),t.model.get("updateQualificationTable"))}}},{type:"PushItem",title:l.replace_by_existing,fonticon:{content:"wux-ui-3ds wux-ui-3ds-replace-by-existing"},action:{callback:function(){t.scopeViewUIObj.contextualMenuNode=a.options,t.model.get("controller").replaceByExistingHandler(t.scopeViewUIObj,t.model.get("id"),t.model.get("updateQualificationTable"))}}},{type:"PushItem",title:l.replace_by_revision,fonticon:{content:"wux-ui-3ds wux-ui-3ds-replace-by-revision"},action:{callback:function(){t.scopeViewUIObj.contextualMenuNode=a.options,t.model.get("controller").replaceByRevisionHandler(t.scopeViewUIObj,t.model.get("id"),t.model.get("updateQualificationTable"))}}},{type:"PushItem",title:l.remove,fonticon:{content:"wux-ui-3ds wux-ui-3ds-remove"},action:{callback:function(){t.scopeViewUIObj.contextualMenuNode=a.options,t.model.get("controller").removeTargetContextScopeTabHandler(t.scopeViewUIObj,t.model.get("id"),t.model.get("updateQualificationTable"))}}}]),"Target Items"===e.cellInfos.nodeModel.getParent().options.grid.id||"Contexts"===e.cellInfos.nodeModel.getParent().options.grid.id||"Pre-requisites"===e.cellInfos.nodeModel.getParent().options.grid.id){let e=await s.getOpenWithMenu(a);i.push({id:"OpenWith",type:"PushItem",title:n.open_with,icon:"open-menu-dot",submenu:e})}return i},t.scopeViewUIObj=new a,r.container=t.outerDiv,r.sort=[{id:"name",text:n.NAME,type:"string"}],r.shouldAllowUnsafeHTMLAt=["picture"],t.scopeViewUIObj.init(r),t.modelEvent.subscribe({event:"add-model"},function(){i.unmask(widget.body)}),o.addResizeListener(this.outerDiv,function(){t.update()},0),t.scopeViewUIObj.collectionViewEvents.subscribe({event:"xsourcing-collectionview-selection-updated"},function(e){t.selectionCallback(e)}),this.addRootNodes(),this.container},loadData:function(){},onDestroy:function(){return this._parent.apply(this,arguments)},update:function(){var e=this.outerDiv.parentElement.parentElement.getBoundingClientRect();this.outerDiv.style.height=e.height-10+"px"},addRootNodes:async function(){let e=this;e.model.get("controller").model.getDetails({data:{respParams:{id:e.model.get("id")}}}).then(async t=>{e.scopeViewUIObj._gridModel.prepareUpdate();let n=c.getPlatformId()===u.ONPREMISE?[u.SOURCE_3DSPACE]:[u.SOURCE_3DSPACE,u.SOURCE_SOURCING,u.SOURCE_3DPLAN],a=e.processForResourceIdIn(t),o="";a.forEach(e=>{o+=e.contains("uuid")?'uri:"'+e+'"'+u.OR:"physicalid="+e+u.OR});let s={completePreCond:o=o.substring(0,o.length-4),nresults:a.length},g=d.prototype.getSearchPayload(a,[],n,s),f=await d.prototype.callFederatedSearch(g),h=p.prototype.processFedSearchData(f);h=await p.prototype.processForNLSProperties(h);let m=p.prototype.getChildNodeDefinition(t.data[0].relateddata.target,h,"Target Items");var w=new r(p.prototype.getRootNodeDefinition("Target Items",l.target_items+" ("+m.length+")",m,require.toUrl("ENOXGenericQualification/assets/icons/Qualification-Thumbnail.png")));e.scopeViewUIObj._gridModel.addRoot(w);let b=p.prototype.getChildNodeDefinition(t.data[0].relateddata.Context,h,"Contexts");var I=new r(p.prototype.getRootNodeDefinition("Contexts",l.contexts+" ("+b.length+")",b,require.toUrl("ENOXGenericQualification/assets/icons/Qualification-Thumbnail.png")));e.scopeViewUIObj._gridModel.addRoot(I);let y=p.prototype.getChildNodeDefinition(t.data[0].relateddata.PreReq,h,"Pre-requisites");var v=new r(p.prototype.getRootNodeDefinition("Pre-requisites",l.pre_requisites+" ("+y.length+")",y,require.toUrl("ENOXGenericQualification/assets/icons/Qualification-Thumbnail.png")));e.scopeViewUIObj._gridModel.addRoot(v),e.scopeViewUIObj._gridModel.pushUpdate(),e.scopeViewUIObj.collectionViewEvents.publish({event:"xsourcing-collectionview-update-count",data:m.length+b.length+y.length}),e.scopeViewUIObj._gridModel.expandAll(),i.unmask(e.container)})},selectionCallback:function(e){let t=this.model.get("controller").detailsView.relatedQualificationsView?this.model.get("controller").detailsView.relatedQualificationsView.data.currentContextId:"",i=this.scopeViewUIObj._xsourcingCollectionViewUI._gridModel.getRoots().filter(e=>"Contexts"===e.getAttributeValue("id")),n=i&&i[0].getChildren().length;1===e.selectedItems.length&&-1!==e.selectedItems[0].id.search("Contexts")?this.scopeViewUIObj.collectionViewEvents.publish({event:"xsourcing-collectionview-enable-toolbar-button",data:"insertByExisting"}):this.scopeViewUIObj.collectionViewEvents.publish({event:"xsourcing-collectionview-disable-toolbar-button",data:"insertByExisting"});let a=!1;if(e.selectedItems&&1===e.selectedItems.length&&e.selectedItems[0].grid.id!==t){let t=e.selectedItems[0];a=!(0===t.id.search("Target"))&&!(0===t.id.search("Contexts"))&&!(0===t.id.search("Pre"))&&(t.grid.parentName&&0===t.grid.parentName.search("Target")||t.grid.parentName&&0===t.grid.parentName.search("Contexts"))&&!(t.grid.parentName&&0===t.grid.parentName.search("Pre"))}e.selectedItems&&1===e.selectedItems.length&&e.selectedItems[0].grid.id===t&&widget.notificationUtil.showError(l.info_cannot_modify_current_context),a?(this.scopeViewUIObj.collectionViewEvents.publish({event:"xsourcing-collectionview-enable-toolbar-button",data:"replaceByLatestRevision"}),this.scopeViewUIObj.collectionViewEvents.publish({event:"xsourcing-collectionview-enable-toolbar-button",data:"replaceByExisting"}),this.scopeViewUIObj.collectionViewEvents.publish({event:"xsourcing-collectionview-enable-toolbar-button",data:"replaceByRevision"}),"Target Items"===e.selectedItems[0].grid.parentName||1===n?this.scopeViewUIObj.collectionViewEvents.publish({event:"xsourcing-collectionview-disable-toolbar-button",data:"remove"}):this.scopeViewUIObj.collectionViewEvents.publish({event:"xsourcing-collectionview-enable-toolbar-button",data:"remove"})):(this.scopeViewUIObj.collectionViewEvents.publish({event:"xsourcing-collectionview-disable-toolbar-button",data:"replaceByLatestRevision"}),this.scopeViewUIObj.collectionViewEvents.publish({event:"xsourcing-collectionview-disable-toolbar-button",data:"replaceByExisting"}),this.scopeViewUIObj.collectionViewEvents.publish({event:"xsourcing-collectionview-disable-toolbar-button",data:"replaceByRevision"}),this.scopeViewUIObj.collectionViewEvents.publish({event:"xsourcing-collectionview-disable-toolbar-button",data:"remove"}))},processForResourceIdIn:function(e){let t=[];return t.push(e.data[0].relateddata.target[0].dataelements.Proxy_Id),e.data[0].relateddata.Context.forEach(e=>{t.push(e.dataelements.Proxy_Id)}),e.data[0].relateddata.PreReq.forEach(e=>{t.push(e.id)}),t}})}),define("DS/ENOXGenericQualification/views/Qualification/OpenQualification",["DS/UIKIT/Mask","DS/ENOXGenericQualification/models/Qualification","DS/ENOXSourcingUXInfra/DetailsView/DetailsView","DS/ENOXSourcingUXInfra/PropertiesView/SRCRelatedObjectsView/RelatedObjectsView","i18n!DS/ENOXGenericQualification/assets/nls/ENOXGenericQualification","i18n!DS/ENOXSourcingUXInfra/assets/nls/ENOXSourcingUXInfra","DS/ENOXSourcingUXInfra/DocumentView/DocumentView","DS/ENOXSourcingUXInfra/LifeCycleView/LifeCycleViewBis","DS/ENOXSourcingUXInfra/MembersView/MembersView","DS/ENOXGenericQualification/helpers/QualificationHelper","DS/ENOXSourcingUXInfra/Constants/ENOXSourcingConstants","DS/ENOXSourcingUXInfra/service/ENOXSourcingPlatformServices","DS/ENOXSourcingUXInfra/CommonUtils/CommonUtils","DS/ENOXSourcingUXInfra/PropertiesView/EditPropertiesWidgetWrapper","DS/ENOXSourcingUXInfra/Utilities/HyperLinkHelper","DS/ENOXGenericQualification/views/Qualification/QualificationContexts/ScopeView","DS/ENOXSourcingUXInfra/PropertiesView/3DComments/CommentsView","DS/ENOXSourcingUXInfra/ProofsView/ProofsView","DS/ENOXSourcingUXInfra/ObjectHistory/SourcingTimeline","DS/ENOXSourcingUXInfra/Search/SearchUtility"],function(e,t,i,n,a,o,r,l,s,d,c,u,p,g,f,h,m,w,b,I){"use strict";var y=function(e){this.controller=e},v={};return y.prototype.render=function(e){if(e.controller=this.controller,!e.detailsContainer){var t=widget.getElement(".information-panel.panel-icon-wrapper");t&&(t.style.display="none"),e.applicationChannel.publish({event:"welcome-panel-hide"}),e.applicationChannel.publish({event:"information-panel-hidden",data:null})}v=e,this.detailsView(e)},y.prototype.detailsView=function(e){var n=this,o={};this.addIdCardOptions(e,o);let r=new t,l=new UWA.Class.Model({modelEvent:e._mediator?e._mediator.createNewChannel():e.controller.app._mediator.createNewChannel(),id:e.data.respParams.id,dataProviderPromise:r.getLifeCycleDataProviderPromise(e),relativePath:"/resources/v1/modeler/dssourcing/qualifications/usagequalifications",callBackForExecuteCmd:function(){u.getPlatformId()!==c.ONPREMISE&&n.callBackAfterSaveFromInfoPanel(e)}});e.lifeCycleModel=l,this.addTabOptions(e,o),e.detailsViewOptions=o;var s=new i;s.init(e),e.applicationChannel.subscribe({event:"update-qualification-id-card"},function(t){let i=s.mIDCardContainer;e.data.respParams=t.grid;var n=(""!==t.grid.target.title?t.grid.target.title:t.grid.target.name?t.grid.target.name:"")+(t.grid.target.revision?` (${t.grid.target.revision}) `:""),o=[];t.grid.contexts.forEach(e=>{o.push((""!==e.dataelements.Title?e.dataelements.Title:e.dataelements.Proxy_Title?e.dataelements.Proxy_Title:e.dataelements.name?e.dataelements.name:"")+(e.dataelements.Revision?` (${e.dataelements.Revision}) `:""))});let r=[{name:a.MATURITY,value:"",id:"maturityState",type:"type-text",editable:!0},{name:a.target_item,value:n},{name:a.context_items,value:o},{name:a.owner,value:t.grid.owner},{name:a.revision,value:t.grid.revision},{name:a.creation_date,value:p.getDateStringForDisplay(t.grid.created)},{name:a.modificationDate,value:p.getDateStringForDisplay(t.grid.modified)}];i.getIDCard().model.unset("attributes"),i.getIDCard().model.set("attributes",r),s.lifeCycleView.model.unset("maturityContainer"),s.lifeCycleView.model.set("maturityContainer",i)})},y.prototype.getQualificationLifeCycleUI=function(e){let i=this,n=new t;e.controller=i.controller;let a=new UWA.Class.Model({modelEvent:e._mediator?e._mediator.createNewChannel():e.controller.app._mediator.createNewChannel(),id:e.data.respParams.id,dataProviderPromise:n.getLifeCycleDataProviderPromise(e),relativePath:"/resources/v1/modeler/dssourcing/qualifications/usagequalifications",callBackForExecuteCmd:function(){i.callBackAfterSaveFromInfoPanel(e)}});return new l({model:a})},y.prototype.addIdCardOptions=function(e,t){let i=e.data.respParams;var n=[],o=(""!==i.target.title?i.target.title:i.target.name?i.target.name:"")+(i.target.revision?` (${i.target.revision}) `:"");i.contexts.forEach(e=>{n.push((""!==e.dataelements.Title?e.dataelements.Title:e.dataelements.Proxy_Title?e.dataelements.Proxy_Title:e.dataelements.name?e.dataelements.name:"")+(e.dataelements.Revision?` (${e.dataelements.Revision}) `:""))}),t.idCardDetails={name:i.name,thumbnail:i.image,attributes:[{name:a.MATURITY,value:"",id:"maturityState",type:"type-text",editable:!0},{name:a.target_item,value:o},{name:a.context_items,value:n},{name:a.owner,value:i.owner},{name:a.revision,value:i.revision},{name:a.creation_date,value:p.getDateStringForDisplay(i.created)},{name:a.modificationDate,value:p.getDateStringForDisplay(i.modified)}]}},y.prototype.addTabOptions=function(e,t){let i=UWA.createElement("div",{styles:{height:"100%",width:"100%"}}),n=e.qualTimeline=new b({physicalId:e.data.respParams.id,objectTitle:e.data.respParams.name,historyContainer:i,activityMappingObject:{}});t.showTabView=!0,t.tabConfiguration=[{label:a.properties,content:y.prototype.addQualificationTabContainer(e),index:"1",value:"propertiesTblDiv",isSelected:!0,icon:{iconName:"attributes",fontIconFamily:1},events:{click:function(){var e=widget.getElement(".information-panel.panel-icon-wrapper");e&&(e.style.display="none")}}},{label:a.scope,content:y.prototype.addScopeTab(e),index:"2",value:"scopeTblDiv",view:y.scopeView,icon:{iconName:"location",fontIconFamily:1},events:{click:function(){var e=widget.getElement(".information-panel.panel-icon-wrapper");e&&(e.style.display="none")}}},{label:a.attachments,content:y.prototype.getDocumentTabContainer(e),index:"4",value:"documentTblDiv",reload:!1,view:y.documentView,icon:{iconName:"attach",fontIconFamily:1},events:{click:function(){var e=widget.getElement(".information-panel.panel-icon-wrapper");e&&e.style.removeProperty("display")}}},{label:a.members,content:y.prototype.getMembersTabContainer(e),index:"5",value:"membersDiv",icon:{iconName:"users",fontIconFamily:1},events:{click:function(){var e=widget.getElement(".information-panel.panel-icon-wrapper");e&&(e.style.display="none")}}},{label:o.proof,content:y.prototype.getProofsTabContainer(e),index:"3",value:"proofsDiv",isSelected:"proof"===e.data.params.tabToOpen,reload:!0,icon:{iconName:"doc-text-shield",fontIconFamily:1},events:{click:function(){var e=widget.getElement(".information-panel.panel-icon-wrapper");e&&(e.style.display="none")}}},{label:u.getPlatformId()===c.ONPREMISE?a.relations:a.relatedObjects,content:y.prototype.getRelationsTabContainer(e),index:"6",value:"relationsDiv",icon:{iconName:"object-related",fontIconFamily:1},events:{click:function(){var e=widget.getElement(".information-panel.panel-icon-wrapper");e&&(e.style.display="none")}}},{label:o.activity,content:i,index:"7",value:"activity",icon:{iconName:"clock",fontIconFamily:1},reload:!0,view:n,events:{click:function(){}}},...u.getPlatformId()===c.ONPREMISE?[{label:a.revisions,content:y.prototype.getRevisionsTabContainer(e),index:"8",value:"revisionsDiv",icon:{iconName:"flow-branch-list",fontIconFamily:1},events:{click:function(){var e=widget.getElement(".information-panel.panel-icon-wrapper");e&&(e.style.display="none")}}}]:[],{label:a.comments,content:y.prototype.get3DCommentsContainer.call(this,e),index:"9",reload:!0,value:"commentsDiv",icon:{iconName:"comment",fontIconFamily:1}}]},y.prototype.getDocumentTabContainer=function(e){var i=this,n=y.prototype.createExpanderUWADiv("documentDiv");n.style.height="100%";var a=new t,o=new d,l={},s=new UWA.Class.Model({parentOptions:e,contextObject:a,mediator:e._mediator,modelEvent:e._mediator.createNewChannel(),infoContainer:e._triptychWrapper.getRightPanelContainer(),additionalHeaders:{},applicationChannel:e.applicationChannel,triptychWrapper:e._triptychWrapper,isSpecification:!1,fromInfoPanel:e.forInfo,controller:e.controller,isDragDropAllowed:Boolean("TRUE"===e.data.respParams.modifyAccess),isUpdateAllowed:Boolean("TRUE"===e.data.respParams.modifyAccess),state:e.data.respParams.state,helper:o,processForObject:function(t){i.processDocumentInfo(t,e,l)}});return l=new r({model:s}),y.documentView=l,l.render().inject(n),n},y.prototype.processDocumentInfo=async function(i,n,a){var r=new t,l=i[0];let s=l["ds6w:label"]?l["ds6w:label"]:"",d=l.sourceid?l.sourceid.split(":")[0]:c.SOURCE_3DSPACE,p=l.sourceid?l.sourceid.split(":")[1]:u.getPlatformId();var g={data:[{id:l.id,type:c.DOCUMENT,dataelements:{"ProxyItem.Proxy_Title":s,"ProxyItem.Proxy_Service":d.toLowerCase(),"ProxyItem.Proxy_Tenant":p}}]},f={data:[{type:l["ds6w:type"]?l["ds6w:type"]:"",dataelements:{document_ID:l.id,purpose:l.purpose}}]};n.attachDocumentData=f;let h=function(){r.attachDocument(n).then(function(t){a&&a.modelEvent&&(a.modelEvent.publish({event:"add-model",data:t}),i[0]["ds6w:label"]?widget.notificationUtil.showSuccess(o.document_added_successfully):widget.notificationUtil.showSuccess(o.document_uploaded_successfully),e.unmask(widget.body))},function(t){widget.notificationUtil.showError(t&&t.internalError&&500===t.statusCode?t.internalError:t&&t.error?t.error:t||o.upload_failed),e.unmask(widget.body)})};l&&l.sourceid&&!l.sourceid.toLocaleLowerCase().contains(c.SOURCE_SOURCING)&&c.ONPREMISE!==u.getPlatformId()?r.getProxyObjectId({data:g}).then(function(e){f.data[0].dataelements.document_ID=e[l.id],h()}):h()},y.prototype.createExpanderUWADiv=function(e){return UWA.createElement("div",{id:e,styles:{position:"relative"}})},y.prototype.getMembersTabContainer=function(e){var t=y.prototype.createExpanderUWADiv("membersDiv");t.style.height="100%";var i=new UWA.Class.Model({id:e.data.respParams.id,changeAccess:e.data.respParams.changeAccess,excludeQuery:'AND NOT [ds6w:identifier]:("'+e.data.respParams.ownerIdentifier+'")',mediator:e._mediator,modelEvent:e._mediator.createNewChannel(),infoContainer:e._triptychWrapper.getRightPanelContainer()});return new s({model:i}).render().inject(t),t},y.prototype.getRelationsTabContainer=function(t){let i=y.prototype.createExpanderUWADiv("relationsDiv");if(i.style.height="100%",u.getPlatformId()===c.ONPREMISE){let e={container:i,facets:["FACET_RELATIONS"],showIdCard:!1},n={objectId:t.data.params.id};new g({viewOptions:e,dataOptions:n}).render()}else this.getSRCRelatedObjectsView({options:t,relationsContainer:i});return e.unmask(i),i},y.prototype.getSRCRelatedObjectsView=async function(t){e.mask(t.relationsContainer,a.loading);let i={erIDs:(await v.controller.getProofsData(t.options.data.respParams.id)).map(e=>e.id),sourcingIDs:[],rdfIDs:[]},r=await v.controller.queryRelatedDataObjects(i);t.options.data.respParams.qualificationProofs=r.data,v.controller.helper.processDataForRelationsTab({data:t.options.data.respParams}).then(e=>{let i=new UWA.Class.Model({data:e,ctxCallback:function(e){let t=e.options.id;if(c.TYPE_QUALIFICATION_LIST.includes(e.options.grid.type)){let e={contextObjId:t,callControllerMethod:v.controller};widget.app._applicationChannel.publish({event:"information-panel-add-content",data:{openDetails:(new f).getObjectDetailsInInfoPanel(e)}}),widget.app._applicationChannel.publish({event:"information-panel-open-without-reload-content"})}else if(t.includes("uuid")){let e=encodeURIComponent(t.replace("<","").replace(">",""));window.open(u._platforms[c.SERVICE_3DDASHBOARD]+"#dashboard:/tab:/app:ENXPLAN_AP/content:ids="+e+"&tenant="+u.getPlatformId()+"&x3dPlatformId="+u.getPlatformId())}else{let e={container:widget.app._triptychWrapper.getRightPanelContainer(),facets:["FACET_PROPERTIES","FACET_SWYMCOMMENTS","FACET_RELATIONS"]},i={objectId:t},n=function(){new g({viewOptions:e,dataOptions:i}).render()};widget.app._applicationChannel.publish({event:"information-panel-add-content",data:{openDetails:n}}),widget.app._applicationChannel.publish({event:"information-panel-open-without-reload-content"})}}}),a=new n({model:i});window.relatedQualificationReference&&(window.srcRelatedObjectsView=a),a.render().inject(t.relationsContainer)}).catch(function(){widget.notificationUtil.showError(o.error_loading_related_objects)}).finally(function(){e.unmask(t.relationsContainer)})},y.prototype.getRevisionsTabContainer=function(t){let i=y.prototype.createExpanderUWADiv("revisionsDiv");i.style.height="100%";let n={container:i,facets:["FACET_REVISIONS"],showIdCard:!1},a={objectId:t.data.params.id};return new g({viewOptions:n,dataOptions:a}).render(),e.unmask(i),i},y.prototype.get3DCommentsContainer=function(t){let i=UWA.createElement("div",{id:"commentsDiv",styles:{position:"relative"}});return i.style.height="100%",this.get3DCommentsView({options:t,container:i}),e.unmask(i),i},y.prototype.get3DCommentsView=function(t){e.mask(t.container,a.loading),new m({data:{id:t.options.data.respParams.id,type:c.TYPE_QUALIFICATION,appID:"ENXSPIQ_AP"}}).render().inject(t.container)},y.prototype.addScopeTab=function(e){let t=y.prototype.createExpanderUWADiv("scopeViewDiv");t.style.height="100%";let i=e.data.versionGraph.find(t=>{if(t.versions.some(t=>e.data.respParams.id===t.id||e.data.respParams.id===t.physicalid))return t.versions}),n=!(!i||!i.versions)&&(c.SCOPETAB_ALLOWED_STATES.includes(e.data.respParams.state)&&"FALSE"!==e.data.respParams.modifyAccess&&i.versions.length<=1),a=new UWA.Class.Model({id:e.data.respParams.id,controller:e.controller,mediator:e._mediator,modelEvent:e._mediator.createNewChannel(),infoContainer:e._triptychWrapper.getRightPanelContainer(),updateQualificationTable:e.updateQualificationTable,isToolBarEnabled:n}),o=new h({model:a});return o.render().inject(t),y.scopeView=o,t},y.prototype.getProofsTabContainer=function(e){var t=y.prototype.createExpanderUWADiv("proofsDiv");t.style.height="100%";var i=new UWA.Class.Model({qualDetails:e.data.respParams,controller:e.controller,mediator:e._mediator,modelEvent:e._mediator.createNewChannel(),infoContainer:e._triptychWrapper.getRightPanelContainer()}),n=new w({model:i});return n.render().inject(t),y.proofsView=n,t},y.prototype.addQualificationTabContainer=function(e){let t=this,i={container:e._triptychWrapper.getRightPanelContainer(),facets:["FACET_PROPERTIES"],typeOfDisplay:"editProp_onlyProperties",showIdCard:!1,readOnly:Boolean("FALSE"===e.data.respParams.modifyAccess),editMode:!1};(new I).getPlatfromAPIObj().unsubscribe("DS/PADUtils/PADCommandProxy/refresh"),(new I).getPlatfromAPIObj().subscribe("DS/PADUtils/PADCommandProxy/refresh",i=>{e.data.params.qualificationId===i.data.authored.modified[0]&&t.callBackAfterSaveFromInfoPanel(e)}),(new I).getPlatfromAPIObj().unsubscribe("DS/Information/CommandProxy/AddExtension"),(new I).getPlatfromAPIObj().subscribe("DS/Information/CommandProxy/AddExtension",i=>{e.data.params.qualificationId===i.authored.modified[0].physicalid&&t.callBackAfterSaveFromInfoPanel(e)});let n={objectId:e.data.params.qualificationId},a=new g({viewOptions:i,dataOptions:n});a.render();let o=a.tabContainer;return a.tabContainer.elements&&a.tabContainer.elements.container&&(o=a.tabContainer.elements.container),o},y.prototype.callBackAfterSaveFromInfoPanel=function(e){let i=new t(e.controller.app),n=new d(e.controller.app);i.getDetails(e).then(async function(t){let i=n.getRelatedObjectIds(t.data),a=await e.controller.queryRelatedDataObjects(i);t.data.objectInfodata=a.data;let o=e.data.respParams.currentContextId?e.data.respParams.currentContextId:e.data.respParams.context.id;var r=n.processQualificationData(t,o)[0];e.applicationChannel.publish({event:"update-qualification-id-card",data:r}),e.updateTableFunction&&e.updateTableFunction(r),e.updateQualificationTable&&e.updateQualificationTable(r),e.qualTimeline&&e.qualTimeline.historyApplicationChannel&&e.qualTimeline.historyApplicationChannel.publish({event:"reload-history-content",data:{}})})},y}),define("DS/ENOXGenericQualification/views/Qualification/ProgressView/GraphViewUtil",["UWA/Core","DS/egraph/core","DS/egraph/views","DS/egraph/utils","DS/Controls/Popup","i18n!DS/ENOXGenericQualification/assets/nls/ENOXGenericQualification","DS/ENOXGenericQualification/views/Qualification/ProgressView/ItemLabelContentView","DS/ENOXSourcingUXInfra/CommonUtils/CommonUtils","DS/ENOXSourcingUXInfra/Utilities/Utility","DS/ENOXGenericQualification/views/Qualification/ProgressView/ProgressViewUtil","css!DS/egraph/views.css","css!DS/egraph/views_default.css"],function(e,t,i,n,a,o,r,l,s,d){"use strict";return{newNode:function(l,s,c,u){var p=this;function g(){i.HTMLNodeView.call(this)}n.inherit(g,i.HTMLNodeView),g.prototype.onmodifyDisplay=function(n,l){if(i.HTMLNodeView.prototype.onmodifyDisplay.apply(this,arguments),t.inPathSet(l,"data","id")){var s=u.helper.createUWADiv("node-data-div",c.getAttributeValue("id"));s.addEventListener("click",function(){c._options.isNewRevision||u.localChannel.publish({event:"qualification-selection-updated",data:{selectedObj:c,currentElement:this}})}),e.createElement("div",{html:p.getAttributeValue("progressViewTileTopAttribute","topPattern",c),class:"node-content"}).inject(s),e.createElement("div",{html:p.getAttributeValue("progressViewTileBottomAttribute","bottomPattern",c),class:"node-content"}).inject(s);var g=this.display.elt;if(g.appendChild(s),g.style["background-color"]="Yes"!==c.getAttributeValue("approved")&&c.getAttributeValue("approved")!==o.approved||c.getAttributeValue("state")!==o.Released&&c.getAttributeValue("state")!==o.Obsolete?"No"!==c.getAttributeValue("approved")&&c.getAttributeValue("approved")!==o.rejected||c.getAttributeValue("state")!==o.Released&&c.getAttributeValue("state")!==o.Obsolete?"#F59A23":"#D9001B":"#018308",c._options.isOldRevision&&(g.style.opacity="0.6"),c._options.isNewRevision&&(g.style.opacity="0.3"),c.getAttributeValue("restriction")&&d.generateRestrictionIcon(s),c._options.grid.highLight&&u.localChannel.publish({event:"qualification-selection-updated",data:{selectedObj:c,currentElement:s}}),!c.getAttributeValue("isNewRevision")){let e=new a({target:g,trigger:"hover",arrowBoxFlag:!0,position:"right",alignment:"center",constraint:"screen"}),t=u.helper.createUWADiv("decorator-container");new r({data:u.helper.getDecoratorData(c,u.controller.params.detailsRoutePath)}).render().inject(t),e.setBody(t)}}};var f=new t.Node;return f.views.main=new g,f.multiset("left",l,"top",s,"width",110,"height",40),f},getAttributeValue:function(e,t,i){let n=new s,a="";if("modified"===widget.getValue(e))a=l.getDateStringForDisplay(i.getAttributeValue(widget.getValue(e)));else if("extension"===widget.getValue(e)){if(i.getAttributeValue("extensionColumns")){let e=i.getAttributeValue("extensionColumns").filter(e=>e.displayName.toLowerCase().includes(widget.getValue(t).toLowerCase())),o=e[0]&&"timestamp"===e[0].type&&l.getDateStringForDisplay(e[0].value);e.length>0&&(a=e[0].displayRanges&&"timestamp"!==e[0].type?n.processLabelValue(e[0].range,e[0].displayRanges).filter(t=>t.value===e[0].value)[0].label:"timestamp"===e[0].type?o.substring(0,o.lastIndexOf(",")):e[0].value)}}else a="approved"===widget.getValue(e)?"No"===i.getAttributeValue("approved")?o.rejected:"Yes"===i.getAttributeValue("approved")?o.approved:o.pending:i.getAttributeValue(widget.getValue(e));return a},newConnector:function(e,n){var a=new t.Connector;return a.views.main=new i.SVGConnView,a.multiset(["cstr","attach"],e,["cstr","offset"],n),a},newEdge:function(){var e=new t.Edge,n=new t.StairGeometry;return n.onupdate=function(e){var i={x:e.cl1.c.aleft,y:e.cl1.c.atop},n={x:e.cl2.c.aleft,y:e.cl2.c.atop};if(!e.path.length||(a=i,o=n,r=e.path,a.x!==r[1]||a.y!==r[2]||o.x!==r[r.length-1]||o.y!==r[r.length-2])){var a,o,r,l;if(e.path&&6!==e.path.length&&(e.reshaped||e.splitted)){var s={x:(l=e.path.slice())[1],y:l[2]},d={x:l[l.length-2],y:l[l.length-1]};return s.x!==i.x&&(l[1]=i.x),s.y!==i.y&&(l[2]=i.y,l[5]=i.y),d.x!==n.x&&(l[l.length-2]=n.x),d.y!==n.y&&(l[l.length-1]=n.y,l[l.length-4]=n.y),void e.gr.withLockedUpdate(function(){e.set("path",l)})}e.reshaped=!1,e.splitted=!1;var c,u,p;if(i.x===n.x||i.y===n.y)p=0;else if(Math.abs(i.x-n.x)<5||Math.abs(i.y-n.y)<5)p=1,c=Math.floor((n.x-i.x)/2),u=n.y-i.y;else{p=this.nbStairs+1;do{p--,c=Math.floor((n.x-i.x)/(p+1)),u=Math.floor((n.y-i.y)/p)}while(p>1&&(Math.abs(c)<5||Math.abs(u)<5))}l=[t.PathCmd.M,i.x,i.y];var g=i.x;this.nbStairs>0&&l.push(t.PathCmd.L,g,n.y),l.push(t.PathCmd.L,n.x,n.y),e.gr.withLockedUpdate(function(){e.set("path",l)})}},e.set("geometry",n),e.views.main=new i.SVGEdgeView,e}}}),define("DS/ENOXGenericQualification/views/Qualification/ProgressView/QualificationContentGraphView",["UWA/Class/View","DS/egraph/core","DS/egraph/views","DS/UIKIT/Scroller","DS/TreeModel/TreeDocument","DS/ENOXGenericQualification/views/Qualification/ProgressView/GraphViewUtil","DS/ENOXSourcingUXInfra/service/ENOXSourcingPlatformServices","DS/ENOXSourcingUXInfra/Constants/ENOXSourcingConstants","css!DS/egraph/views.css","css!DS/egraph/views_default.css","css!DS/ENOXGenericQualification/views/Qualification/ProgressView/ProgressView.css"],function(e,t,i,n,a,o,r,l){"use strict";return e.extend({name:"qualification-content-graph-view",tagName:"div",domEvents:{},setup:function(e){this.options=e,this.container.addClassName(this.getClassNames("-container"))},render:function(){return this.container.empty(),this.container.setStyles({width:"100%"}),this.mainDiv=this.options.helper.createUWADiv("main-div"),this.graphDiv=r.getPlatformId()===l.ONPREMISE?this.options.helper.createUWADiv("graph-div").inject(this.mainDiv):this.options.helper.createUWADiv("graph-div cloud").inject(this.mainDiv),this.renderGraphView(this.graphDiv),new n({element:this.mainDiv}).inject(this.container),this},renderGraphView:function(e){var n=this,s=new t.EGraph;s.addView("main",new i.HTMLGraphView(e));let d=this.options.data;var c,u=20,p=5;if(r.getPlatformId()===l.ONPREMISE){c=140;var g=50,f=new a;let e=d.filter(e=>""===e._options.grid.parent);0===e.length?f.addRoot(d[0]):e.forEach(e=>{f.addRoot(e)});var h=function(e,i){let a=u;if(e.getChildren()){var r;e.getChildren().filter(e=>"E"!==e.getAttributeValue("semantic")&&""!==e.getAttributeValue("semantic")).length>0&&(r=o.newConnector(t.BorderCstr.BOTTOM,55),i.appendConnector(r),n.mainDiv.style.height="200px"),e.getChildren().sort((e,t)=>e.getAttributeValue("semantic")>t.getAttributeValue("semantic")?1:t.getAttributeValue("semantic")>e.getAttributeValue("semantic")?-1:0),e.getChildren().forEach(e=>{var l;if("E"===e.getAttributeValue("semantic")){let r=o.newConnector(t.BorderCstr.RIGHT,20);i.appendConnector(r),u=a+150,l=o.newNode(u,p,e,n.options),s.addNode(l),c+=150;let d=o.newConnector(t.BorderCstr.LEFT,20);l.appendConnector(d),s.addEdge(r,d,o.newEdge())}else{p+=50,u=a+100,c+=100,l=o.newNode(u,p,e,n.options),s.addNode(l),g+=60;let i=o.newConnector(t.BorderCstr.LEFT,20);l.appendConnector(i),s.addEdge(r,i,o.newEdge())}h(e,l)})}};f.getRoots().forEach((e,t)=>{var i;d.forEach(e=>{e.removeChildren()}),n.getQualHierarchy(e,d),0===t?i=o.newNode(u,p,e,n.options):(u=20,p+=50,i=o.newNode(u,p,e,n.options),g+=50),s.addNode(i),h(e,i)}),this.graphDiv.style.height=g+"px"}else{c=10;var m=d.length,w=[];if(m>0){for(let e=0;e<=m-1;e++){var b,I=d[e],y=o.newNode(u,p,I,n.options);if(m>1)if(0===e)b=o.newConnector(t.BorderCstr.RIGHT,20),y.appendConnector(b),w.push(b);else if(e===m-1)b=o.newConnector(t.BorderCstr.LEFT,20),y.appendConnector(b),w.push(b);else{var v=o.newConnector(t.BorderCstr.LEFT,20),C=o.newConnector(t.BorderCstr.RIGHT,20);y.appendConnector(v),y.appendConnector(C),w.push(v),w.push(C)}s.addNode(y),u+=180,c+=180}c-=40}for(var _=0;_<w.length-1;_++)s.addEdge(w[_],w[_+1],o.newEdge())}this.graphDiv.style.width=c+"px"},getQualHierarchy:function(e,t){var i=this;e.removeChildren(),t.forEach(n=>{if(n._options.grid.parent===e.getAttributeValue("id"))e.addChild(n);else if(""!==n._options.grid.parent){let a=e.getChildren()?e.getChildren().find(e=>e.getAttributeValue("id")===n._options.grid.parent):void 0;a&&i.getQualHierarchy(a,t)}})},onDestroy:function(){return this._parent.apply(this,arguments)}})}),define("DS/ENOXGenericQualification/views/Qualification/ProgressView/QualificationContentRowView",["UWA/Core","UWA/Class/View","DS/Controls/Popup","DS/Controls/ComboBox","i18n!DS/ENOXGenericQualification/assets/nls/ENOXGenericQualification","DS/ENOXGenericQualification/views/Qualification/ProgressView/QualificationContentGraphView","DS/ENOXGenericQualification/views/Qualification/ProgressView/ItemLabelContentView","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/Controls/TooltipModel","css!DS/ENOXGenericQualification/views/Qualification/ProgressView/ProgressView.css"],function(e,t,i,n,a,o,r,l,s,d){"use strict";return t.extend({name:"qualification-content-row-view",tagName:"div",domEvents:{},setup:function(e){this.options=e,this.container.addClassName(this.getClassNames("-container"))},render:function(){var t=this;this.container.empty(),this.container.setStyles({width:"100%"});var c=[],u=new l,p=t.options.helper.createUWADiv("item-label-div").inject(this.container),g=t.options.helper.createUWADiv("qualification-content-div").inject(this.container),f=t.options.data.find(e=>e.getAttributeValue("target")&&!!e.getAttributeValue("target").title);let h=t.options.data[0].getAttributeValue("additionalContexts")||[];if(h.length>0){let t="";h.forEach(e=>{t=t.concat(`${e.title}, `)});let i=`${a.additional_contexts}: `;e.createElement("div",{html:[{tag:"label",text:`${i}`},{tag:"span",text:`${t.substring(0,t.length-2)}`}],class:"additional-contexts"}).inject(p).tooltipInfos=new d({shortHelp:t.substring(0,t.length-2)})}var m=[...t.options.data];let w=m.slice(0),b=m.map(e=>e.getAttributeValue("target")?`${e.getAttributeValue("target").title} (${e.getAttributeValue("target").revision})`:"");b=[...new Set(b)].filter(e=>!!e);var I=e.createElement("label",{text:b.length>1?f.getAttributeValue("target").title:`${f.getAttributeValue("target").title} (${f.getAttributeValue("target").revision})`,class:"item-label"}).inject(p);if(b.length>1&&t.options.data.forEach(e=>{e.getAttributeValue("target")&&e.getAttributeValue("target").title&&e.getAttributeValue("target").revision&&!u.getRoots().find(t=>t.getAttributeValue("id")===e.getAttributeValue("target").id)&&u.addRoot(new s({label:`${e.getAttributeValue("target").title} (${e.getAttributeValue("target").revision})`,grid:{id:e.getAttributeValue("target").id}}))}),u.addRoot(new s({label:f.getAttributeValue("target").title,grid:{id:f.getAttributeValue("target").id}})),b.length>1){var y=new n({elementsTree:u,mainElementVisibleFlag:!1,selectedIndex:u.getRoots().length-1});y.inject(p),y.addEventListener("click",function(e){e.stopPropagation()})}var v=function(e){var i={};m.forEach(e=>{let t=e.getAttributeValue("target")?`${e.getAttributeValue("target").title} (${e.getAttributeValue("target").revision})`:void 0;t in i?i[t].push(e):i[t]=[e]}),I.innerHTML=e.data.nodeModel.getAttributeValue("label");let n=b.findIndex(e=>e===I.innerHTML);let a=(m=function(e){let t=[];for(let i=0;i<e.length;i++){let n=t.map(e=>e.getAttributeValue("target")?e.getAttributeValue("target").id:""),a=e[i].getAttributeValue("target")?e[i].getAttributeValue("target").id:"";if(!n.includes(a)){let n=e.filter(t=>t.getAttributeValue("target")&&e[i].getAttributeValue("target")?t.getAttributeValue("target").id===e[i].getAttributeValue("target").id:e[i]);t.push(...n)}}return t}(m)).map(e=>e.getAttributeValue("target")?e.getAttributeValue("target").id:"").lastIndexOf(e.data.nodeModel.getAttributeValue("id"));if(m.map(function(e){return e._options.isOldRevision=!1,e._options.isNewRevision=!1,e}),t.options.data=[],-1===n)w.forEach(function(e){e._options.grid.isNewRevision&&(e._options.isNewRevision=!0)}),t.options.data=w;else{let e=[],o=[];for(let t=0;t<n;t++)e.push(...i[b[t]]);for(let e=n+1;e<b.length;e++)o.push(...i[b[e]]);i[void 0]&&o.push(...i[void 0]),e.map(function(e){return e._options.isOldRevision=!0,e}),o.map(function(e){return e._options.isNewRevision=!0,e}),t.options.data=m.slice(0,a+1)}p.hasClassName("target-node-selected")&&(c.length=0,c.push(e.data.nodeModel),t.options.localChannel.publish({event:"target-selection-updated",data:c})),g.empty(),new o({data:t.options.data,localChannel:t.options.localChannel,helper:t.options.helper,controller:t.options.controller}).render().inject(g)};u.getRoots().forEach(e=>{e._modelEvents.subscribe({event:"select"},v)}),p.addEventListener("click",function(){t.container.parentElement.childNodes.forEach(e=>{e.childNodes[0].removeClassName("target-node-selected")});let e={};e=1===u.getRoots().length?u.getRoots()[0]:u.getRoots().find(e=>!0===e.isSelected()),c.includes(e)?c.splice(c.indexOf(e),1):(c.length=0,c.push(e),this.classList.add("target-node-selected")),t.options.localChannel.publish({event:"target-selection-updated",data:c})}),t.options.localChannel.subscribe({event:"progress-view-selection-updated"},function(){(t.container.parentElement?t.container.parentElement.childNodes:[]).forEach(e=>{e.childNodes[0].removeClassName("target-node-selected")}),c.length=0});let C=new i({target:I,trigger:"hover",arrowBoxFlag:!0,position:"right",alignment:"center"}),_=t.options.helper.createUWADiv("decorator-container");return new r({data:[{label:a.item_type,content:`${f.getAttributeValue("target").title}(${f.getAttributeValue("target").revision}): ${f.getAttributeValue("target").typeNLS}`}]}).render().inject(_),C.setBody(_),new o({data:t.options.data,localChannel:t.options.localChannel,helper:t.options.helper,controller:t.options.controller}).render().inject(g),this},onDestroy:function(){return this._parent.apply(this,arguments)}})}),define("DS/ENOXGenericQualification/views/Qualification/ProgressView/QualificationContentTargetRowView",["UWA/Core","UWA/Class/View","DS/Controls/Popup","DS/Controls/ComboBox","i18n!DS/ENOXGenericQualification/assets/nls/ENOXGenericQualification","DS/ENOXGenericQualification/views/Qualification/ProgressView/QualificationContentGraphView","DS/ENOXGenericQualification/views/Qualification/ProgressView/ItemLabelContentView","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","css!DS/ENOXGenericQualification/views/Qualification/ProgressView/ProgressView.css"],function(e,t,i,n,a,o,r,l,s){"use strict";return t.extend({name:"qualification-content-row-view",tagName:"div",domEvents:{},setup:function(e){this.options=e,this.container.addClassName(this.getClassNames("-container"))},render:function(){var t=this;this.container.empty(),this.container.setStyles({width:"100%"});var d=[],c=new l,u=t.options.helper.createUWADiv("item-label-div").inject(this.container),p=t.options.helper.createUWADiv("qualification-content-div").inject(this.container);let g=t.options.data.map(e=>e.getAttributeValue("contexts")),f=[];g.forEach(e=>{e&&f.push(...e)}),f=f.filter((e,t,i)=>i.findIndex(t=>t.id===e.id)===t);let h="",m="";f.forEach(e=>{h=h.concat(`${e.title}(${e.revision}), `),m=m.concat(`${e.title}(${e.revision}): ${e.typeNLS}, `)});var w=e.createElement("label",{text:h.substring(0,h.length-2),class:"item-label"}).inject(u),b=[...t.options.data];let I=f.map(e=>`${e.title} (${e.revision})`),y=f.map(e=>e.title);if((I=[...new Set(I)].filter(e=>!!e)).length>1){f.forEach(e=>{if(y.filter(t=>t===e.title).length>1){let t=c.getRoots().filter(t=>t.getAttributeValue("label")===e.title)[0];t||(t=new s({label:e.title,grid:{id:"id"+Math.random()}}),c.addRoot(t)),t.addChild(new s({label:`${e.title} (${e.revision})`,grid:{id:e.id}}))}else c.addRoot(new s({label:`${e.title} (${e.revision})`,grid:{id:e.id}}))}),c.expandAll(),c.addRoot(new s({label:a.show_all,grid:{id:"showAll"}}));var v=new n({elementsTree:c,mainElementVisibleFlag:!1});v.inject(u),v.addEventListener("click",function(e){e.stopPropagation()})}else c.addRoot(new s({label:f[0].title,grid:{id:f[0].id}}));var C=function(e){let i=e.data.nodeModel.getAttributeValue("id");if(i.includes("id"))return;w.innerHTML="showAll"===i?h.substring(0,h.length-2):e.data.nodeModel.getAttributeValue("label"),b=function(e){let t=[];for(let i=0;i<e.length;i++){let n=t.map(e=>e.getAttributeValue("contexts")?e.getAttributeValue("contexts").map(e=>e.id):[]),a=e[i].getAttributeValue("contexts")?e[i].getAttributeValue("contexts").map(e=>e.id):[];if(!n.some(e=>a.every((t,i)=>t===e[i]))){let n=e.filter(t=>t.getAttributeValue("contexts")&&e[i].getAttributeValue("contexts")?JSON.stringify(t.getAttributeValue("contexts").map(e=>e.id))===JSON.stringify(e[i].getAttributeValue("contexts").map(e=>e.id)):e[i]);t.push(...n)}}return t}(b);let n=[];b.forEach(e=>{n.push({qualId:e.getAttributeValue("id"),contextId:e.getAttributeValue("contexts")?e.getAttributeValue("contexts").map(e=>e.id):[]})});let a=b.map(e=>e.getAttributeValue("contexts")?e.getAttributeValue("contexts").map(e=>e.id):[]),r=function(e,t){let i;return e.forEach((e,n)=>{e.includes(t)&&(i=n)}),i}(a,i),l=function(e,t){for(let i=0;i<e.length;i++)if(e[i].includes(t))return i}(a,i);if(b.map(function(e){return e._options.isOldRevision=!1,e._options.isNewRevision=!1,e}),t.options.data=[],"showAll"===i)b.forEach(function(e){e._options.grid.isNewRevision&&(e._options.isNewRevision=!0)}),t.options.data=b;else{let e=[],i=[];for(let t=0;t<l;t++)b[t]._options.previousRevision||e.push(b[t]);for(let e=r+1;e<b.length;e++)i.push(b[e]);for(let e=0;e<b.length;e++)b[e]._options.previousRevision&&i.push(b[e]);e.map(function(e){return e._options.isOldRevision=!0,e}),i.map(function(e){return e._options.isNewRevision=!0,e}),t.options.data=b.slice(0,r+1)}u.hasClassName("target-node-selected")&&(d.length=0,d.push(e.data.nodeModel),t.options.localChannel.publish({event:"target-selection-updated",data:d})),p.empty(),new o({data:t.options.data,localChannel:t.options.localChannel,helper:t.options.helper,controller:t.options.controller}).render().inject(p)};c.getRoots().forEach(e=>{e.getChildren()&&e.getChildren().forEach(e=>{e._modelEvents.subscribe({event:"select"},C)}),e._modelEvents.subscribe({event:"select"},C)}),u.addEventListener("click",function(){t.container.parentElement.childNodes.forEach(e=>{e.childNodes[0].removeClassName("target-node-selected")});let e={};e=1===c.getRoots().length?c.getRoots()[0]:c.getRoots().find(e=>!0===e.isSelected()),d.includes(e)?d.splice(d.indexOf(e),1):(d.length=0,d.push(e),this.classList.add("target-node-selected")),t.options.localChannel.publish({event:"target-selection-updated",data:d})}),t.options.localChannel.subscribe({event:"progress-view-selection-updated"},function(){(t.container.parentElement?t.container.parentElement.childNodes:[]).forEach(e=>{e.childNodes[0].removeClassName("target-node-selected")}),d.length=0});let _=new i({target:w,trigger:"hover",arrowBoxFlag:!0,position:"right",alignment:"center"}),E=t.options.helper.createUWADiv("decorator-container");return new r({data:[{label:a.item_type,content:m.substring(0,m.length-2)}]}).render().inject(E),_.setBody(E),new o({data:t.options.data,localChannel:t.options.localChannel,helper:t.options.helper,controller:t.options.controller}).render().inject(p),this},onDestroy:function(){return this._parent.apply(this,arguments)}})}),define("DS/ENOXGenericQualification/views/Qualification/ProgressView/QualificationProgressView",["UWA/Core","UWA/Class/View","DS/UIKIT/Mask","DS/ENOXGenericQualification/views/Qualification/ProgressView/QualificationContentRowView","DS/ENOXGenericQualification/views/Qualification/ProgressView/QualificationContentTargetRowView","i18n!DS/ENOXGenericQualification/assets/nls/ENOXGenericQualification","DS/ENOXSourcingUXInfra/service/ENOXSourcingPlatformServices","DS/ENOXSourcingUXInfra/Constants/ENOXSourcingConstants","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","css!DS/ENOXGenericQualification/views/Qualification/ProgressView/ProgressView.css"],function(e,t,i,n,a,o,r,l,s,d){"use strict";return t.extend({name:"qualification-progress-view",tagName:"div",domEvents:{},setup:function(e){this.container.addClassName(this.getClassNames("-container")),this.container.empty(),this.options=e,this.rowContainer=this.options.helper.createUWADiv("qualification-progress-view-row-div").inject(this.container),this.subscribeToEvents()},render:function(t){var i=this;this.container.setStyles({width:"100%"});var c=n;i.options.controller.params.detailsRoutePath===l.QUALIFICATION_TARGET_DETAILS_VIEW&&(c=a);var u,p=new s;if(t.qualData.forEach(e=>{p.addRoot(new d({grid:e}))}),t.qualData.length>0){let e=widget.getElement('[id="no-object-found-QualificationContextsDetailsPage"]');e&&e.remove()}let g=t.qualData.find(e=>e.highLight);t.qualData.length>0&&g&&(u=g.id);var f={};return i.options.view.options.localChannel.publish({event:"target-selection-updated",data:[]}),r.getPlatformId()===l.ONPREMISE?p.getRoots().length>0&&i.options.controller.getVersionGraphDetails(p).then(e=>{e.getRoots().sort(function(e,t){return new Date(e.getAttributeValue("originated"))-new Date(t.getAttributeValue("originated"))}),e.getRoots().forEach(e=>{let t=e.getAttributeValue("rootId")||e.getAttributeValue("title");t in f?f[t].push(e):f[t]=[e]}),Object.keys(f).forEach(function(e){let t=!0;f[e].some(e=>{const n=e.getAttributeValue("id");return!!i.findElementById(i.rowContainer,n)&&(t=!1,!0)}),t&&new c({data:f[e],localChannel:i.options.view.options.localChannel,helper:i.options.helper,controller:i.options.controller}).render().inject(i.rowContainer)}),u&&widget.getElement('[id="'+u+'"]')&&widget.getElement('[id="'+u+'"]').scrollIntoView({block:"center",inline:"center"})}):(p.getRoots().sort(function(e,t){return new Date(e.getAttributeValue("originated"))-new Date(t.getAttributeValue("originated"))}),p.getRoots().forEach(e=>{let t=e.getAttributeValue("title");t in f?f[t].push(e):f[t]=[e]}),Object.keys(f).forEach(function(e){let t=!0;f[e].some(e=>{const n=e.getAttributeValue("id");return!!i.findElementById(i.rowContainer,n)&&(t=!1,!0)}),t&&new c({data:f[e],localChannel:i.options.view.options.localChannel,helper:i.options.helper,controller:i.options.controller}).render().inject(i.rowContainer)}),u&&widget.getElement('[id="'+u+'"]')&&widget.getElement('[id="'+u+'"]').scrollIntoView({block:"center",inline:"center"})),i.options.view.collectionViewEvents.subscribe({event:"filter-on-search"},function(t){if(t){var n=new RegExp(t,"i");i.rowContainer.empty();let r=!0;if(Object.keys(f).forEach(function(e){let t=!1;f[e].forEach(function(e){l.QFM_COLUMNS_TO_SEARCH.forEach(i=>{t=t||n.test(e._options.grid[i])})}),t&&(r=!1,new c({data:f[e],localChannel:i.options.view.options.localChannel,helper:i.options.helper,controller:i.options.controller}).render().inject(i.rowContainer))}),r){var a=e.createElement("div",{class:"emptyContainerStyle",html:o.data_unavailable_message});i.rowContainer.appendChild(a)}}else i.rowContainer.empty(),Object.keys(f).forEach(function(e){new c({data:f[e],localChannel:i.options.view.options.localChannel,helper:i.options.helper,controller:i.options.controller}).render().inject(i.rowContainer)})}),i.container.addEventListener("click",function(e){var t=document.getElementsByClassName("qualification-progress-view-row-div")[0];(t!==e.target&&!t.contains(e.target)||"item-label-div target-node-selected"===!e.target.className)&&(i.options.view.options.localChannel.publish({event:"target-selection-updated",data:[]}),i.options.view.options.localChannel.publish({event:"progress-view-selection-updated",data:{selectedNodes:[]}}))}),this},loadMoreButton:function(){let t=this;t.loadMore=e.createElement("button",{text:o.load_more,class:"load-more btn btn-default"}).inject(this.container),t.loadMore.addEventListener("click",function(){t.options.view.options.localChannel.publish({event:"load-more-data"})})},loadMoreButtonHide:function(){this.loadMore.addClassName("hide")},findElementById:function(e,t){return e.querySelector('.node-data-div[id="'+t+'"]')},subscribeToEvents:function(){let e=this;var t=[];e.options.view.options.localChannel.subscribe({event:"target-selection-updated"},function(){document.querySelectorAll(".qual-node-selected").forEach(e=>{e.classList.remove("qual-node-selected")}),t.length=0}),e.options.view.options.localChannel.subscribe({event:"qualification-selection-updated"},function(i){e.currentElement=i.currentElement;let n=i.selectedObj;t.includes(n)?(t.splice(t.indexOf(n),1),i.currentElement.parentElement.classList.remove("qual-node-selected")):(t.push(n),i.currentElement.parentElement.classList.add("qual-node-selected")),e.options.view.options.localChannel.publish({event:"progress-view-selection-updated",data:{selectedNodes:t}})}),e.options.view.options.localChannel.subscribe({event:"update-progress-view-row"},function(t){t.operation?(t.data.forEach(e=>{null!==document.getElementById(e)&&document.getElementById(e).closest(".qualification-content-row-view-container").remove()}),e.options.view.options.localChannel.publish({event:"delete-progress-view-row",data:t.data}),e.options.view.options.localChannel.publish({event:"progress-view-selection-updated",data:{selectedNodes:[]}})):(e.options.view.options.localChannel.publish({event:"add-progress-view-row",data:t}),e.currentElement.closest&&e.currentElement.closest(".qualification-content-row-view-container").remove())})},onDestroy:function(){return this._parent.apply(this,arguments)}})}),define("DS/ENOXGenericQualification/views/Qualification/QualificationContexts/ListContextQualifications",["UWA/Core","UWA/Class/View","DS/Utilities/Dom","DS/UIKIT/Mask","i18n!DS/ENOXGenericQualification/assets/nls/ENOXGenericQualification","DS/ENOXSourcingUXInfra/service/ENOXSourcingPlatformServices","i18n!DS/ENOXSourcingUXInfra/assets/nls/ENOXSourcingUXInfra","DS/ENOXSourcingUXInfra/xsourcingCollectionView/xsourcingCollectionView","DS/ENOXGenericQualification/views/Qualification/OpenQualification","DS/UIKIT/SuperModal","DS/ENOXSourcingUXInfra/PropertiesView/EditPropertiesWidgetWrapper","DS/ENOXSourcingUXInfra/Constants/ENOXSourcingConstants","DS/ENOXGenericQualification/views/Qualification/ProgressView/QualificationProgressView","DS/ENOXSourcingUXInfra/Search/SearchUtility","DS/ENOXSourcingUXInfra/openwithservice/ENOXSourcingOpenWithService","DS/ENOXSourcingUXInfra/CommonUtils/CommonUtils","DS/ENOXGenericQualification/views/Qualification/ProgressView/ProgressViewUtil","DS/ENOXGenericQualification/dataSource/QualificationDataSource","DS/ENOXSourcingUXInfra/MembersView/MembersView","DS/ENOXSourcingUXInfra/components/MemberInfoProvider/MemberInfoProvider"],function(e,t,i,n,a,o,r,l,s,d,c,u,p,g,f,h,m,w,b,I){"use strict";return t.extend({name:"context-items-qualifications-view",tagName:"div",domEvents:{},platformEventTokens:[],setup:function(e){this.model=e.model,this.data=e.data,this.container.addClassName(this.getClassNames("-container")),this.listenTo(this.model,"onChange",this.render),this.searchUtility=new g,this.subscribeToPlatformEvents()},update:function(){var e=this.outerDiv.parentElement.parentElement.getBoundingClientRect();this.outerDiv.style.height=e.height+"px"},render:function(){var t=this;t.container.empty(),t.outerDiv=e.createElement("div",{class:"outerDiv",styles:{height:"100%"}}).inject(t.container),n.mask(t.container,r.loading_qualifications),t.controller=t.model.get("controller"),t.helper=t.model.get("helper");let s={};return s.applicationChannel=t.model.get("applicationChannel"),s.app=this.controller.app,s._triptychWrapper=t.model.get("triptychWrapper"),s._mediator=t.model.get("mediator"),s.localChannel=t.model.get("mediator").createNewChannel(),s.data=t.model.get("qualData")||[],s.dataSource=new w({referenceArray:s.data,contextId:t.model.get("parentOptions").data.id||t.model.get("parentOptions").data.pid,model:t.controller.model,helper:t.helper,controller:t.controller,app:t.controller.app}),s.dataSource.numberOfRowsPerRequest=50,s.dataSource.rowsOffsetToTriggerRequest=15,s.columnToSearch=u.QFM_COLUMNS_TO_SEARCH,s.virtuallyLoadAllModelItems=!0,s.showToolbar=!0,s.uniqueIdentifier=s.app.router.getState().name===u.QUALIFICATION_CONTEXT_DETAILS_VIEW?"QualificationContextsDetailsPage":"QualificationTargetsDetailsPage",s.toolbarActions=t.populateToolbar(s),s.columnsConfigurations=t.getColumnConfigurations(),s.onContextualEventCallback=function(i){var n=i.cellInfos&&i.cellInfos.nodeModel?i.cellInfos.nodeModel:null,l=i.cellInfos?i.cellInfos.rowID:null;let d=i.cellInfos?i.cellInfos.columnID:null,c=i.collectionView?i.collectionView.layout.getColumnIdentifiers(d).dataIndex:"";if(-1===l||!n)return this._contextualMenuBuilder?this._contextualMenuBuilder.buildMenu(i,s):[];let p=[];if(n.options.grid.grouped||"name"!==c||(p=[{type:"PushItem",title:a.revise_qualification,fonticon:{content:"wux-ui-3ds wux-ui-3ds-flow-line-add"},action:{callback:function(){s.contextualNode=[n],t.controller.reviseQualificationItem(t,s)}}},...o.getPlatformId()===u.ONPREMISE?[{type:"PushItem",title:a.branch_qualification,fonticon:{content:"wux-ui-3ds wux-ui-3ds-flow-branch-add"},action:{callback:function(){t.controller.branchQualificationItem(n)}}}]:[],{type:"PushItem",fonticon:{content:"wux-ui-3ds wux-ui-3ds-forward"},title:a.share,action:{callback:function(){var t=new e.Class.Model({id:n._options.grid.id,changeAccess:n._options.grid.modifyAccess,excludeQuery:'AND NOT [ds6w:identifier]:("'+n._options.grid.owner+'")',mediator:s._mediator,modelEvent:s._mediator.createNewChannel(),infoContainer:s._triptychWrapper.getRightPanelContainer()}),i=new b({model:t});let o=`${a.share} - ${n._options.grid.name}`,r=a.can_view;i.memberInfoProvider=new I,i.launchWebUXPopup({shareName:o,canView:r})}}}]),!n.options.grid.grouped&&"tree"===c){let e=i.cellInfos.nodeModel?i.cellInfos.nodeModel:i.cellInfos.cellModel;e.options.grid.id=s.uniqueIdentifier===u.QUALIFICATION_CONTEXT_DETAILS_PAGE?e.options.grid.target.id:e.options.grid.additionalContexts[0].id,e.options.grid.actualType=s.uniqueIdentifier===u.QUALIFICATION_CONTEXT_DETAILS_PAGE?e.options.grid.target.type:e.options.grid.additionalContexts[0].type;var g=e.options.grid;return s.uniqueIdentifier===u.QUALIFICATION_CONTEXT_DETAILS_PAGE?p.push({id:"OpenTarget",type:"PushItem",title:`${a.open} ${a.target}`,fonticon:{content:"wux-ui-3ds wux-ui-3ds-open"},action:{callback:()=>{t.controller.app.router.navigate(t.controller.app.router._routes[4].name,g)}}}):p.push({id:"OpenContext",type:"PushItem",title:`${a.open} ${a.context}`,fonticon:{content:"wux-ui-3ds wux-ui-3ds-open"},action:{callback:()=>{t.controller.app.router.navigate(t.controller.app.router._routes[2].name,g)}}}),f.getOpenWithMenu(e).then(function(e){return p.push({id:"OpenWith",type:"PushItem",title:r.open_with,icon:"open-menu-dot",submenu:e}),p},function(){return p})}return p},s.views=["Grid","Progress View"],s.currentView="Grid View",s.activateComfortableView=!0,t.tableView=new l,s.container=t.outerDiv,s.enableDrag=!0,s.enableCellDrag=!0,s.onDragStartCell=function(e,i){let n=this.getColumnOrGroup(i.columnID);if("name"!==n.dataIndex&&"tree"!==n.dataIndex)return void e.preventDefault();let a="tree"===n.dataIndex?"QualificationContextsDetailsPage"===s.uniqueIdentifier?n.dataIndex:"context":n.dataIndex,o=t.helper.getDataforDnD(a,i.draggedNodes[0]);var r=t.tableView._xsourcingCollectionViewUI.formatDataForDnD(o);return e.dataTransfer.setData("text/plain",JSON.stringify(r)),!1},s.onDragStartRowHeader=function(e,i){let n=t.helper.getDataforDnD("name",i.draggedNodes[0]);var a=t.tableView._xsourcingCollectionViewUI.formatDataForDnD(n);return e.dataTransfer.setData("text/plain",JSON.stringify(a)),!1},s.customView={id:"Progress View",text:a.progress_view,fonticon:"fonticon fonticon-graph-egraph-list"},s.customViewLoader=function(){if(t.tableView.options.dataSource.referenceArray.length>0){let e={};e.view=t.tableView,e.helper=t.helper,e.controller=t.controller,t.qualificationProgressView=new p(e),m.customViewLoader(t),t.controller.renderPropertiesView({id:t.data.currentContextId,qualIdToHighlight:t.data.qualIdToHighlight?t.data.qualIdToHighlight:""})}},t.tableView.init(s),t.tableView._xsourcingCollectionViewUI.collectionToolbar.setItemBarVisibility("sourcinginfoicon",!1),t.helper.addingTypeRepresentations(t.tableView),t.setListenersAndSubscribers(),n.unmask(t.container),i.addResizeListener(t.outerDiv,function(){t.update()},0),t.container},onDestroy:function(){let e=this;return e.tableView._xsourcingCollectionViewUI._dataGridView.destroy(),e.platformEventTokens.forEach(t=>e.searchUtility.getPlatfromAPIObj().unsubscribe(t)),this._parent.apply(this,arguments)},populateToolbar:function(e){var t=this;return[{id:"newQualification",text:a.new_qualification,fonticon:"plus",handler:function(){var i=t.controller.app.dataControllers.qualificationController;let n=t.model.get("parentOptions").contextDetails,a=n["ds6wg:revision"]?" ("+n["ds6wg:revision"]+")":"";var o={contextItem:{_options:{id:n.physicalid||n.pid,label:n["ds6w:label"],name:n.name,"ds6w:label":n["ds6w:label"],sourceid:n.sourceid,"ds6w:what/ds6w:kind":n["ds6w:what/ds6w:kind_value"]||"","ds6w:type_value":n["ds6w:what/ds6w:type_value"]||n["ds6w:what/ds6w:type"],projectSpace:n["ds6w:where/ds6w:context/ds6w:project"],organizationResponsible:n["ds6w:who/ds6w:responsible/ds6w:organizationResponsible"]},id:n.physicalid||n.resourceid,label:n["ds6w:label"]+a,title:n["ds6w:label"],projectSpace:n["ds6w:where/ds6w:context/ds6w:project"],organizationResponsible:n["ds6w:who/ds6w:responsible/ds6w:organizationResponsible"],sourceid:n.sourceid,disabled:!0,contextKind:n["ds6w:what/ds6w:kind_value"]||"",actualType:n["ds6w:what/ds6w:type_value"]||n["ds6w:what/ds6w:type"]},localChannel:e.localChannel};e.postQualificationCreationRoute=t.model.get("parentOptions").route,e.postQualificationCreationRouteData=t.model.get("parentOptions").data,e.app.router.getState().name===u.QUALIFICATION_CONTEXT_DETAILS_VIEW?e.fromContextDetailsPage=!0:e.fromTargetDetailsPage=!0,i.newQualification(e,o)}},{id:"reviseQualification",text:a.revise_qualification,fonticon:"flow-line-add",disabled:!0,handler:function(){t.controller.reviseQualificationItem(t,e)}},...o.getPlatformId()===u.ONPREMISE?[{id:"branchQualification",text:a.branch_qualification,fonticon:"flow-branch-add",disabled:!0,handler:function(){let i="Progress View"!==t.tableView._xsourcingCollectionViewUI.collectionToolbar._currentViewId?t.tableView._xsourcingCollectionViewUI._dataGridView.getTreeDocument().getSelectedNodes()[0]:e.selectedItem[0];t.controller.branchQualificationItem(i)}}]:[],{id:"delete",text:a.delete,fonticon:"trash",disabled:!0,handler:function(){t.deleteQualification(t,e)}},{id:"exportToCSV",text:a.export_to_csv,fonticon:"export-to-csv",handler:function(){let e=t.helper.getFileNameForExport(t.model.get("parentOptions").contextDetails.name||t.model.get("parentOptions").contextDetails["ds6w:label"]);t.tableView._xsourcingCollectionViewUI.exportDataToCSV({allColumns:!0,addLevelInformation:!0},e)}}]},getColumnConfigurations:function(){var e=this;return[...e.controller.app.router.getState().name===u.QUALIFICATION_CONTEXT_DETAILS_VIEW?[{text:a.qualification_target,dataIndex:"tree",resizableFlag:!0,sortableFlag:!0,width:130,typeRepresentation:"url",hyperlinkTarget:"_self",hyperlinkClickCallback:function(t){let i=t.nodeModel.options.grid.target;e.getHyperLinkClickCallBack(i.id)},getCellValue:function(t){return e.getTreeCellValue(t,this)}}]:[{text:a.qualification_context,dataIndex:"tree",resizableFlag:!0,sortableFlag:!0,width:130,typeRepresentation:"url",hyperlinkTarget:"_self",hyperlinkClickCallback:function(t){let i=t.nodeModel.options.grid.additionalContexts[0];e.getHyperLinkClickCallBack(i.id)},getCellValue:function(t){return e.getTreeCellValue(t,this)}}],...e.controller.app.router.getState().name===u.QUALIFICATION_CONTEXT_DETAILS_VIEW?[{text:a.target_type,dataIndex:"targetType",width:130,getCellValue:function(e){return e.nodeModel&&e.nodeModel.options.grid.target?e.nodeModel.options.grid.target.typeNLS:""}}]:[{text:a.context_type,dataIndex:"contextType",width:130,getCellValue:function(e){return e.nodeModel&&e.nodeModel.options.grid.additionalContexts&&e.nodeModel.options.grid.additionalContexts.length>0?e.nodeModel.options.grid.additionalContexts[0].typeNLS||e.nodeModel.options.grid.additionalContexts[0].objectInfodata.typeNLS:""}}],{text:a.additional_contexts,dataIndex:"additionalContexts",allowUnsafeHTMLContent:!0,sortableFlag:!1,groupableFlag:!1,hyperlinkTarget:"_self",getCellValue:function(t){let i=t.nodeModel&&t.nodeModel.options.grid.additionalContexts?Object.assign([],t.nodeModel.options.grid.additionalContexts):[];return e.controller.app.router.getState().name===u.QUALIFICATION_TARGET_DETAILS_VIEW&&i.shift(),i&&i.length>0?(widget.hyperLinkClickCallback=function(t){e.getHyperLinkClickCallBack(t)},e.helper.getCellValueHtmlForMultipleItems(i)):""},getCellTooltip:function(t){let i="",n=t.nodeModel&&t.nodeModel.options.grid.additionalContexts&&Object.assign([],t.nodeModel.options.grid.additionalContexts);return e.controller.app.router.getState().name===u.QUALIFICATION_TARGET_DETAILS_VIEW&&n&&n.shift(),n&&n.length>0&&n.forEach(e=>{let t=e.typeNLS?e.typeNLS:e.objectInfodata.typeNLS,n=e.label?e.label:e.objectInfodata.title;i+=t+": "+n+",\n"}),{shortHelp:i.substring(0,i.length-2)}},getCellValueForExport:function(t){if(t.nodeModel){let i=[],n=t.nodeModel.options.grid.additionalContexts?Object.assign([],t.nodeModel.options.grid.additionalContexts):[];return e.controller.app.router.getState().name===u.QUALIFICATION_TARGET_DETAILS_VIEW&&n.shift(),n.forEach(function(e){i.push(e.label)}),i.join(",")}return t.cellModel}},{text:a.qualification,dataIndex:"qualification",children:[{text:a.title,width:100,dataIndex:"title",setCellValue:function(t,i){t.nodeModel.options.grid.title!==i&&e.controller.gridCellUpdate({cellInfos:t,dataIndex:void 0,value:i,attributeName:"Title"})},getCellEditableState:function(t){return e.helper.getEditAccess(!(!t.nodeModel||!t.nodeModel.options.grid.modifyAccess)&&t.nodeModel.options.grid.modifyAccess)}},{text:a.name,dataIndex:"name",width:130,typeRepresentation:"url",hyperlinkTarget:"_self",hyperlinkClickCallback:function(t){var i=t.nodeModel.options.grid;let n=i.id;e.slideInPanelOpenedWith=n;let a={contextObjId:n,currentContextId:"QualificationContextsDetailsPage"===e.tableView.options.uniqueIdentifier?i.contextId:i.additionalContexts[0].id};e.controller.app._applicationChannel.publish({event:"information-panel-add-content",data:{openDetails:e.controller.getQualificationOpenInInfoPanel(a,e)}}),e.controller.app._applicationChannel.publish({event:"information-panel-open-without-reload-content"})},getCellValue:function(e){return{label:e.nodeModel&&e.nodeModel.options.grid.name?e.nodeModel.options.grid.name:"",url:"javascript:;",hyperlinkClickCallback:e.nodeModel&&e.nodeModel.options.grid.grouped?void 0:this.layout.getColumnOptionValue(e.columnID,"hyperlinkClickCallback")}}},{text:r.proof,dataIndex:"proof",typeRepresentation:"functionIcon",getCellValue:function(t){return t.nodeModel&&t.nodeModel.options.grid.isProofExists&&"FALSE"!==t.nodeModel.options.grid.isProofExists?()=>(function(t){var i=t.nodeModel.options.grid;let n=i.id;e.slideInPanelOpenedWith=n;let a={contextObjId:n,currentContextId:"QualificationContextsDetailsPage"===e.tableView.options.uniqueIdentifier?i.contextId:i.additionalContexts[0].id,tabToOpen:"proof"};e.controller.app._applicationChannel.publish({event:"information-panel-add-content",data:{openDetails:e.controller.getQualificationOpenInInfoPanel(a,e)}}),e.controller.app._applicationChannel.publish({event:"information-panel-open-without-reload-content"})})(t):""},getCellSemantics:function(e){return{icon:e.nodeModel&&e.nodeModel.options.grid.isProofExists&&"FALSE"!==e.nodeModel.options.grid.isProofExists?{iconName:"doc-text-shield",fontIconFamily:1}:""}},alignment:"center",width:100},{text:a.status,dataIndex:"approved",width:100,typeRepresentation:"statusDropDown",editableFlag:!0,editionPolicy:"EditionOnOver",setCellValue:function(t,i){t.nodeModel&&t.nodeModel.options.grid.approved&&t.nodeModel.options.grid.approved===i||e.controller.gridCellUpdate({cellInfos:t,dataIndex:void 0,value:i,attributeName:"attribute_SRCQUALIFICATION.Approved",successMessage:a.qualification_status_updated})},getCellValue:function(e){return e.nodeModel&&e.nodeModel._options.grid.wux_group?"":{label:e.nodeModel&&"No"===e.nodeModel.options.grid.approved?a.rejected:e.nodeModel&&"Yes"===e.nodeModel.options.grid.approved?a.approved:a.pending,value:e.nodeModel&&e.nodeModel.options.grid.approved?e.nodeModel.options.grid.approved:""}},getCellEditableState:function(t){return e.helper.getEditAccess(t.nodeModel.options.grid.modifyAccess)}},{text:a.MATURITY,dataIndex:"state",typeRepresentation:"url",hyperlinkTarget:"_self",width:100,getCellValue:function(t){return{label:t.nodeModel&&t.nodeModel.options.grid.state?t.nodeModel.options.grid.state:"",url:"javascript:;",hyperlinkClickCallback:function(){e.launchContextQualificationMaturityUI(t,e)}}},getCellValueForExport:function(e){return e.nodeModel?e.cellModel.label:e.cellModel}},{text:a.owner,dataIndex:"owner",width:130},{text:a.modified_date,dataIndex:"modified",typeRepresentation:"datetime",width:200,getCellValueForExport:function(e){return e.nodeModel?h.getDateStringForDisplay(e.cellModel):e.cellModel}},{text:a.prerequisite,dataIndex:"prereq",width:130,typeRepresentation:"url",hyperlinkTarget:"_self",hyperlinkClickCallback:function(t){let i=t.nodeModel.options.grid.prerequisite[0].id;e.slideInPanelOpenedWith=i;let n={contextObjId:i};e.controller.app._applicationChannel.publish({event:"information-panel-add-content",data:{openDetails:e.controller.getQualificationOpenInInfoPanel(n,e)}}),e.controller.app._applicationChannel.publish({event:"information-panel-open-without-reload-content"})},getCellValue:function(e){return{label:e.nodeModel&&e.nodeModel.getAttributeValue("prerequisite")&&e.nodeModel.getAttributeValue("prerequisite").length>0?`${e.nodeModel.getAttributeValue("prerequisite")[0].title} (${e.nodeModel.getAttributeValue("prerequisite")[0].revision})`:"",url:"javascript:;",hyperlinkClickCallback:e.nodeModel&&e.nodeModel.options.grid.grouped?void 0:this.layout.getColumnOptionValue(e.columnID,"hyperlinkClickCallback")}}},{text:a.comments,dataIndex:"comments",editableFlag:!0,setCellValue:function(t,i){t.nodeModel&&t.nodeModel.options.grid.comments&&t.nodeModel.options.grid.comments===i||e.controller.gridCellUpdate({cellInfos:t,dataIndex:void 0,value:i,attributeName:"attribute_SRCQUALIFICATION.Comments"})},getCellEditableState:function(t){return e.helper.getEditAccess(!(!t.nodeModel||!t.nodeModel.options.grid.modifyAccess)&&t.nodeModel.options.grid.modifyAccess)}},{text:a.restriction,dataIndex:"restriction",editableFlag:!0,setCellValue:function(t,i){t.nodeModel&&t.nodeModel.options.grid.restriction&&t.nodeModel.options.grid.restriction===i||e.controller.gridCellUpdate({cellInfos:t,dataIndex:void 0,value:i,attributeName:"attribute_SRCQUALIFICATION.Restriction"})},getCellEditableState:function(t){return e.helper.getEditAccess(!(!t.nodeModel||!t.nodeModel.options.grid.modifyAccess)&&t.nodeModel.options.grid.modifyAccess)}}]}]},getTreeCellValue:function(e,t){let i=this,n="";if(e.nodeModel&&e.nodeModel.options.grid.wux_group){let a=e.nodeModel.options.grid.dataindex,{typeRepresentation:o,text:r}=t.getColumnOrGroup(a);n=r+": "+i.getLabelForGroupedValue(o,e.nodeModel.options.grid.tree)+" ("+i.getChildrenCount(e.nodeModel.options.grid,0)+")"}else{let t=e.nodeModel&&e.nodeModel.getAttributeValue("target")&&e.nodeModel.getAttributeValue("target").revision?" ("+e.nodeModel.getAttributeValue("target").revision+")":"",a=e.nodeModel&&e.nodeModel.getAttributeValue("context")&&e.nodeModel.getAttributeValue("context")[0]&&e.nodeModel.getAttributeValue("context")[0].revision?" ("+e.nodeModel.getAttributeValue("context")[0].revision+")":e.nodeModel&&e.nodeModel.getAttributeValue("context")&&e.nodeModel.getAttributeValue("context").revision?" ("+e.nodeModel.getAttributeValue("context").revision+")":"";n=u.QUALIFICATION_CONTEXT_DETAILS_VIEW===i.controller.params.detailsRoutePath?e.nodeModel&&e.nodeModel.getAttributeValue("target")?e.nodeModel.getAttributeValue("target").title+t:"":e.nodeModel&&e.nodeModel.getAttributeValue("context")?e.nodeModel.getAttributeValue("context").length>0?`${e.nodeModel.getAttributeValue("context")[0].title}${a}`:`${e.nodeModel.getAttributeValue("context").title}${a}`:""}let a=e.nodeModel&&e.nodeModel.getAttributeValue("contexts")&&e.nodeModel.getAttributeValue("contexts").length>0;return{icon:{iconPath:u.QUALIFICATION_CONTEXT_DETAILS_VIEW===i.controller.params.detailsRoutePath?e.nodeModel&&e.nodeModel.options.grid.target&&e.nodeModel.options.grid.target.image?require.toUrl(e.nodeModel.options.grid.target.image):"":a&&e.nodeModel.options.grid.contexts[0].image?e.nodeModel.options.grid.contexts[0].image.includes("https")?require.toUrl(e.nodeModel.options.grid.contexts[0].image):e.nodeModel.options.grid.contexts[0].image:"",iconSize:{height:"16px",width:"16px"}},label:n,url:"javascript:;",hyperlinkClickCallback:e.nodeModel&&e.nodeModel.options.grid.grouped?void 0:t.layout.getColumnOptionValue(e.columnID,"hyperlinkClickCallback")}},getLabelForGroupedValue:function(e,t){switch(e){case"datetime":return h.getDateStringForDisplay(t);case"statusDropDown":return"No"===t?a.rejected:"Yes"===t?a.approved:a.pending;default:return t}},getChildrenCount:function(e,t){let i=this;return e.children[0].wux_group?(e.children.forEach(e=>{t=i.getChildrenCount(e,t)}),t):t+=e.children.length},getColumnName:function(e){let t=this.controller.detailsView.relatedQualificationsView.tableView._xsourcingCollectionViewUI._columnsConfiguration,i=t.filter(t=>t.dataIndex===e);if(0===i.length){let n=t.find(e=>e.text===a.qualification);i=n&&n.children&&n.children.filter(t=>t.dataIndex===e)}return i&&i[0]&&i[0].text},loadInfoPanelAndToolBarData:function(e){if(e.selectedNodes.length>0)if(1===e.selectedNodes.length){let t=e.selectedNodes[0]._options.grid.id;if(t){let e={contextObjId:t};this.tableView.collectionViewEvents.publish({event:"xsourcing-collectionview-enable-toolbar-button",data:"reviseQualification"}),this.tableView.collectionViewEvents.publish({event:"xsourcing-collectionview-enable-toolbar-button",data:"branchQualification"}),this.tableView.collectionViewEvents.publish({event:"xsourcing-collectionview-enable-toolbar-button",data:"delete"}),this.controller.app._applicationChannel.publish({event:"xsourcing-collectionview-selected-object-id",data:{selectedObject:!0,openDetails:this.controller.getQualificationOpenInInfoPanel(e,this)}}),this.slideInPanelOpenedWith=t}else this.tableView.collectionViewEvents.publish({event:"xsourcing-collectionview-disable-toolbar-button",data:"reviseQualification"}),this.tableView.collectionViewEvents.publish({event:"xsourcing-collectionview-disable-toolbar-button",data:"branchQualification"}),this.tableView.collectionViewEvents.publish({event:"xsourcing-collectionview-disable-toolbar-button",data:"delete"}),this.controller.app._applicationChannel.publish({event:"xsourcing-collectionview-selected-object-id",data:{selectedObject:"false"}})}else this.tableView.collectionViewEvents.publish({event:"xsourcing-collectionview-disable-toolbar-button",data:"reviseQualification"}),this.tableView.collectionViewEvents.publish({event:"xsourcing-collectionview-disable-toolbar-button",data:"branchQualification"}),this.tableView.collectionViewEvents.publish({event:"xsourcing-collectionview-enable-toolbar-button",data:"delete"}),this.controller.app._applicationChannel.publish({event:"xsourcing-collectionview-selected-object-id",data:{selectedObject:"multipleSelected"}});else{this.tableView.collectionViewEvents.publish({event:"xsourcing-collectionview-disable-toolbar-button",data:"reviseQualification"}),this.tableView.collectionViewEvents.publish({event:"xsourcing-collectionview-disable-toolbar-button",data:"branchQualification"}),this.tableView.collectionViewEvents.publish({event:"xsourcing-collectionview-disable-toolbar-button",data:"delete"});let e=this.model.get("parentOptions").data.id||this.model.get("parentOptions").data.pid;this.helper.renderPropertiesView({id:e,applicationChannel:this.controller.app._applicationChannel,_triptychWrapper:this.controller.app._triptychWrapper})}},setListenersAndSubscribers:function(){var e=this;e.helper.renderPropertiesView({id:e.data.currentContextId,applicationChannel:e.controller.app._applicationChannel,_triptychWrapper:e.controller.app._triptychWrapper}),e.tableView.collectionViewEvents.subscribe({event:"xsourcing-collectionview-selection-updated"},function(t){"Progress View"!==e.tableView._xsourcingCollectionViewUI.collectionToolbar._currentViewId&&e.loadInfoPanelAndToolBarData(t)}),e.tableView.options.localChannel.subscribe({event:"progress-view-selection-updated"},function(t){e.tableView.options.selectedItem=t.selectedNodes,e.loadInfoPanelAndToolBarData(t)}),e.tableView.options.localChannel.subscribe({event:"load-more-data"},function(){m.loadMoreData(e)}),e.tableView.options.localChannel.subscribe({event:"add-progress-view-row"},function(t){if("new"===t[0].operation)if(1===e.tableView.options.dataSource.referenceArray.length)e.data.qualIdToHighlight=t[0].id,e.tableView.options.customViewLoader();else{let i={};i.qualData=t,e.qualificationProgressView.render(i)}else m.addNewData(t,e)}),e.tableView.options.localChannel.subscribe({event:"delete-progress-view-row"},function(t){m.deleteData(t,e)}),e.tableView.options.localChannel.subscribe({event:"update-data"},function(t){e.controller.updateViewWithNewData(e.tableView,t).then(function(t){let i={contextObjId:t};e.controller.app._applicationChannel.publish({event:"information-panel-add-content",data:{openDetails:e.controller.getQualificationOpenInInfoPanel(i,e)}}),e.controller.app._applicationChannel.publish({event:"information-panel-open-without-reload-content"})})}),e.tableView.options.localChannel.subscribe({event:"target-selection-updated"},function(t){if(t.length>0)t[0]&&""!==t[0].getAttributeValue("id")&&"showAll"!==t[0].getAttributeValue("id")?e.helper.renderPropertiesView({id:t[0].getAttributeValue("id"),applicationChannel:e.controller.app._applicationChannel,_triptychWrapper:e.controller.app._triptychWrapper}):e.controller.app._applicationChannel.publish({event:"xsourcing-collectionview-selected-object-id",data:{selectedObject:"multipleSelected"}});else{let t=e.model.get("parentOptions").data.id||e.model.get("parentOptions").data.pid;e.helper.renderPropertiesView({id:t,applicationChannel:e.controller.app._applicationChannel,_triptychWrapper:e.controller.app._triptychWrapper})}}),e.tableView._xsourcingCollectionViewUI._toolbarChannel.subscribe({event:"enox-collection-toolbar-switch-view-activated"},function(t){let i=e.tableView._xsourcingCollectionViewUI._gridModel.getRoots().some(e=>e.getAttributeValue("highlightNode"))[0];i&&i.removeAttribute("highlightNode"),e.data.qualIdToHighlight&&delete e.data.qualIdToHighlight,e.controller.app._applicationChannel.publish({event:"information-panel-close"}),e.tableView.collectionViewEvents.publish({event:"xsourcing-collectionview-disable-toolbar-button",data:"reviseQualification"}),e.tableView.collectionViewEvents.publish({event:"xsourcing-collectionview-disable-toolbar-button",data:"delete"}),e.tableView.options.selectedItem=[],"Grid View"===t&&(e.tableView._xsourcingCollectionViewUI._dataGridView.resetTreeDocument(),e.tableView.collectionViewEvents.publish({event:"xsourcing-collectionview-disable-toolbar-button",data:"reviseQualification"}),e.tableView.collectionViewEvents.publish({event:"xsourcing-collectionview-disable-toolbar-button",data:"branchQualification"}),e.tableView.collectionViewEvents.publish({event:"xsourcing-collectionview-disable-toolbar-button",data:"delete"}))}),e.controller.app._applicationChannel.subscribe({event:"information-panel-hidden"},function(){e.slideInPanelOpenedWith&&delete e.slideInPanelOpenedWith}),e.controller.app._applicationChannel.subscribe({event:"update-proof-dgv"},function(t){let i=e.tableView._xsourcingCollectionViewUI._dataGridView.getTreeDocument()?e.tableView._xsourcingCollectionViewUI._dataGridView.getTreeDocument().getAllDescendants().filter(e=>e._options.grid.id===t.qualId):[],n={isProofExists:"FALSE"};0!==t.proofData.length&&(n.isProofExists="TRUE"),Array.isArray(i)&&i.length>0&&i[0].updateOptions&&i[0].updateOptions({grid:n})})},launchContextQualificationMaturityUI:(e,t)=>{var i={data:{respParams:{id:e.nodeModel.options.grid.identifier,type:e.nodeModel.options.grid.type,currentContextId:Array.isArray(e.nodeModel._options.grid.context)?e.nodeModel._options.grid.context[0].id:e.nodeModel._options.grid.context.id}},applicationChannel:t.controller.app._applicationChannel};i._mediator=t.controller.app._mediator;var n={data:[{id:e.nodeModel.options.grid.identifier,physicalid:e.nodeModel.options.grid.identifier,type:e.nodeModel.options.grid.type,identifier:e.nodeModel.options.grid.identifier,source:"Sourcing",relativePath:"/resources/v1/modeler/dssourcing/qualifications/contextqualifications"}]};i.getLifecycleData=n,i.updateTableFunction=function(i){if(i&&i.grid){var n={state:i.grid.maturityState};if(e.nodeModel.prepareUpdate(),e.nodeModel.updateOptions({grid:n}),t.slideInPanelOpenedWith===i.id){let e={contextObjId:i.id};t.controller.app._applicationChannel.publish({event:"information-panel-add-content",data:{openDetails:t.controller.getQualificationOpenInInfoPanel(e,t)}})}e.nodeModel.pushUpdate()}},new s(t.controller).getQualificationLifeCycleUI(i).render()},deleteQualification:function(e,t){if(t.selectedNodes=e.tableView._xsourcingCollectionViewUI._dataGridView.getTreeDocument().getSelectedNodes().filter(function(e){return!0!==e._options.grid.grouped}),!e.tableView._xsourcingCollectionViewUI.checkIfExceedsDeleteLimit(t.selectedNodes)&&(t.contextualNode&&(t.selectedNodes=t.contextualNode.slice()),t.selectedItem&&t.selectedItem.length>0&&(t.selectedNodes=t.selectedItem),t.contextualNode=void 0,t.selectedNodes.length>0)){var i=[];t.selectedNodes.forEach(e=>{i.push({id:e._options.grid.id})}),t.deleteData={data:i};var o=new d({renderTo:widget.body,okButtonText:a.delete}),l=1===t.selectedNodes.length?t.selectedNodes[0]._options.grid.name:t.selectedNodes.length+" "+a.qualifications_small;o.confirm(a.delete_confirmation,a.delete+" - "+l,function(o){if(o){let o=[];i.forEach(e=>{o.push({physicalid:e.id,operation:"Delete"})}),n.mask(e.container,r.loading_qualifications),t.onComplete=function(){if(e.searchUtility.getPlatfromAPIObj().publish("Lifecycle.Modification",JSON.stringify(e.helper.getLifecycleEventObject("delete",o))),e.update(),"Progress View"===e.tableView._xsourcingCollectionViewUI.collectionToolbar._currentViewId)e.controller.getAllDetails(e.model.get("parentOptions").data.id||e.model.get("parentOptions").data.pid,e.controller.app.router.getState().name).then(function(t){e.tableView.options.dataSource.referenceArray=t,e.tableView.collectionViewEvents.publish({event:"xsourcing-collectionview-update-count",data:e.tableView.options.dataSource.referenceArray.length});let n=i.map(e=>e.id);e.tableView.options.localChannel.publish({event:"update-progress-view-row",data:{data:n,operation:"delete"}})});else if(0!==e.tableView.options.dataSource.dataIndexesToGroup.length||e.tableView.options.dataSource.sortModel)e.controller.getAllDetails(e.model.get("parentOptions").data.id||e.model.get("parentOptions").data.pid,e.controller.app.router.getState().name).then(function(t){e.tableView.options.dataSource.referenceArray=t,e.tableView._xsourcingCollectionViewUI._dataGridView.prepareUpdateView(),e.tableView.options.dataSource.availableProperties=[],e.tableView._xsourcingCollectionViewUI._dataGridView.groupRows({dataIndexesToGroup:e.tableView.options.dataSource.dataIndexesToGroup}),e.tableView.options.dataSource.sortModel&&e.tableView._xsourcingCollectionViewUI._dataGridView.reapplySortModel(),e.tableView._xsourcingCollectionViewUI._dataGridView.pushUpdateView(),e.tableView.collectionViewEvents.publish({event:"xsourcing-collectionview-update-count",data:e.tableView.options.dataSource.referenceArray.length})});else{let i=e.tableView.options.dataSource.referenceArray;t.selectedNodes.forEach(t=>{let n=i.map(e=>e.id).indexOf(t.getAttributeValue("id")),a=t.getAttributeValue("id");var o=[{operationType:"nodesRemoved",nodesNumber:1,nodesPath:[n]}];e.tableView._xsourcingCollectionViewUI._dataGridView.dataSource.pushUpdatesNotifications(o,function(e){e.treatedNotificationsNodesNumber>0&&i.find(e=>e.id===a)&&i.splice(n,1)})}),e.tableView.collectionViewEvents.publish({event:"xsourcing-collectionview-update-count",data:i.length})}widget.notificationUtil.showSuccess(a.qualification_deleted_sucessfully),n.unmask(e.container)},t.onFailure=function(t){widget.notificationUtil.showError(t.internalError&&500===t.statusCode?t.internalError:t.error?t.error:t),n.unmask(e.container)},e.model.get("helper").model.delete(t)}})}},subscribeToPlatformEvents:function(){let e=this;e.platformEventTokens.push(e.searchUtility.getPlatfromAPIObj().subscribe("Lifecycle.Modification",function(t){let i=JSON.parse(t).Refresh;if(i.modified.some(e=>"Promote"===e.operation)&&"Progress View"!==e.tableView._xsourcingCollectionViewUI.collectionToolbar._currentViewId){var n={maturity:i.modified[0].state},a=e.tableView._xsourcingCollectionViewUI._gridModel.getRoots().filter(e=>{if(e._options.grid.id===i.modified[0].physicalid)return!0});a&&0!==a.length&&(e.tableView._xsourcingCollectionViewUI._gridModel.prepareUpdate(),a.forEach(function(e){e.updateOptions({grid:n})}),e.tableView._xsourcingCollectionViewUI._gridModel.pushUpdate())}else if(i.created.some(e=>"Duplicate"===e.operation)||i.created.some(e=>"Revise"===e.operation)||i.created.some(e=>"Branch"===e.operation)||i.deleted.some(e=>"Delete"===e.operation)||i.modified.some(e=>"Promote"===e.operation)&&"Progress View"===e.tableView._xsourcingCollectionViewUI.collectionToolbar._currentViewId){let t=e.model.get("parentOptions").data.id||e.model.get("parentOptions").data.pid,n=i.created[0]&&i.created[0].physicalid;if(i.created.some(e=>"Branch"===e.operation)||i.created.some(e=>"Revise"===e.operation)){let i={data:{params:{qualificationId:n}}};e.controller.model.getDetails(i).then(function(i){i.data[0].contextId=t,e.tableView.options.localChannel.publish({event:"update-data",data:i.data})})}i.deleted.some(e=>"Delete"===e.operation)&&e.helper.renderPropertiesView({id:t,applicationChannel:e.controller.app._applicationChannel,_triptychWrapper:e.controller.app._triptychWrapper})}}))},getHyperLinkClickCallBack:function(e){if(e.includes("uuid")){let t=encodeURIComponent(e.replace("<","").replace(">",""));window.open(o._platforms[u.SERVICE_3DDASHBOARD]+"#dashboard:/tab:/app:ENXPLAN_AP/content:ids="+t+"&tenant="+o.getPlatformId()+"&x3dPlatformId="+o.getPlatformId())}else{let t={container:this.controller.app._triptychWrapper.getRightPanelContainer(),facets:["FACET_PROPERTIES","FACET_SWYMCOMMENTS","FACET_RELATIONS"]},i={objectId:e};this.controller.app._applicationChannel.publish({event:"information-panel-add-content",data:{openDetails:function(){new c({viewOptions:t,dataOptions:i}).render()}}}),this.controller.app._applicationChannel.publish({event:"information-panel-open-without-reload-content"})}}})}),define("DS/ENOXGenericQualification/views/Qualification/QualificationContexts/QualificationContextsDetailsView",["DS/UIKIT/Mask","DS/ENOXSourcingUXInfra/DetailsView/DetailsView","DS/ENOXSourcingUXInfra/components/IDCardInfo/IDCardInfo","i18n!DS/ENOXGenericQualification/assets/nls/ENOXGenericQualification","DS/Notifications/NotificationsManagerUXMessages","DS/Notifications/NotificationsManagerViewOnScreen","DS/ENOXGenericQualification/views/Qualification/QualificationContexts/ListContextQualifications","DS/ENOXSourcingUXInfra/CommonUtils/CommonUtils"],function(e,t,i,n,a,o,r,l){"use strict";var s=function(e){this.controller=e,this.notifs=a,window.notifs=this.notifs,this.lifeCycleView=void 0,o.setNotificationManager(this.notifs)};return s.prototype.render=function(a){e.unmask(widget.body),(a={...a,router:this.controller.app.router,applicationChannel:this.controller.app._applicationChannel,_triptychWrapper:this.controller.app._triptychWrapper,_mediator:this.controller.app._mediator}).data.respParams=a.data;var o=widget.getElement(".information-panel.panel-icon-wrapper");o&&(o.style.display="none"),this.controller.app._applicationChannel.publish({event:"welcome-panel-hide"});let r=a.contextDetails?a.contextDetails:{},s={tabConfiguration:[],showTabView:!1,contentView:this.relatedQualificationsViewContainer(this,a)};this.attributeMap=[{name:n.MATURITY,value:r.contextNLSState,displayWhenMinified:!0},{name:n.owner,value:r["ds6w:who/ds6w:responsible"],displayWhenMinified:!0},{name:n.name,value:r["ds6w:identifier"],displayWhenMinified:!0},{name:n.revision,value:r["ds6wg:revision"]},{name:n.type,value:r.contextNLSType}];var d=new i({infoAttributes:[{name:n.creation_date,value:l.getDateStringForDisplay(r["ds6w:when/ds6w:created"])},{name:n.modificationDate,value:l.getDateStringForDisplay(r["ds6w:when/ds6w:modified"])}]});s.idCardDetails={name:r["ds6w:label"]||r.name,thumbnail:r.preview_url?r.preview_url.includes("https")?require.toUrl(r.preview_url):r.preview_url:"",attributes:this.attributeMap,withActionsButton:!1,withInformationButton:!0,additionalInfomation:[d]},a.callback=function(){e.unmask(widget.body)},a.detailsViewOptions=s,(new t).init(a),this.relatedQualificationsView.update()},s.prototype.relatedQualificationsViewContainer=((e,t)=>{var i=UWA.createElement("div",{id:"relatedQualificationsDiv",styles:{position:"relative",height:"100%"}}),n=new UWA.Class.Model({id:t.data.id,parentOptions:t,mediator:t._mediator,platformServices:e.controller.app.platformServices,applicationChannel:t.applicationChannel,triptychWrapper:t._triptychWrapper,router:e.controller.app.router,helper:e.controller.helper,controller:e.controller,qualData:t.qualData});let a=new r({model:n,data:{currentContextId:t.data.id||t.data.pid,qualIdToHighlight:t.data.qualIdToHighlight}});return e.relatedQualificationsView=a,window.testContextItemDetailsView&&(window.testContextItemDetailsView.relatedQualificationsView=a),a.render().inject(i),i}),s.prototype.destroy=function(){this.relatedQualificationsView&&this.relatedQualificationsView.onDestroy()},s}),define("DS/ENOXGenericQualification/controllers/QualificationContextsController",["DS/UIKIT/Mask","i18n!DS/ENOXGenericQualification/assets/nls/ENOXGenericQualification","i18n!DS/ENOXSourcingUXInfra/assets/nls/ENOXSourcingUXInfra","DS/ENOXGenericQualification/helpers/QualificationHelper","DS/ENOXGenericQualification/views/Qualification/QualificationContexts/ListQualificationContexts","DS/ENOXGenericQualification/models/Qualification","DS/ENOXGenericQualification/views/Qualification/QualificationContexts/QualificationContextsDetailsView","DS/ENOXSourcingUXInfra/Constants/ENOXSourcingConstants","DS/ENOXGenericQualification/views/Qualification/OpenQualification","DS/UIKIT/SuperModal","DS/ENOXSourcingUXInfra/Utilities/Utility","DS/ENOXSourcingUXInfra/Utilities/HyperLinkHelper","DS/TreeModel/TreeNodeModel","DS/ENOXSourcingUXInfra/Search/SearchUtility","DS/ENOXSourcingUXInfra/CommonUtils/CommonUtils","DS/Foundation2/WidgetTagNavInit","DS/ENOXSourcingUXInfra/service/ENOXSourcingPlatformServices","DS/ENOXGenericQualification/views/Qualification/ProgressView/ProgressViewUtil","DS/ENOXSourcingUXInfra/BranchRevisioning/BranchRevisioning"],function(e,t,i,n,a,o,r,l,s,d,c,u,p,g,f,h,m,w,b){"use strict";var I=function(e){if(!e||!e.app)throw new Error("App is required in params to instantiate QualificationContextsController");this.params=this.getParamsforContextandTargets(),this.helper=new n,this.view=new a(this),this.detailsView=new r(this),this.model=new o,this.commonUtility=new c,this.searchUtility=new g,this.app=e.app,this.notifIds=[]};return I.prototype.list=function(e){var t=this;let i={...t.getParamsforContextandTargets(e.app.router.getState().name)};t.params=t.getParamsforContextandTargets(e.app.router.getState().name);let n=JSON.parse(widget.getValue(i.recentTrackerWidgetPreference)),a=JSON.parse(widget.getValue(i.listViewMaxSize)),o=a||10;n.length>o&&(n.length=o,widget.setValue(i.recentTrackerWidgetPreference,JSON.stringify(n))),i.data=[],n.length>0?t.getListItemsData(n).then(function(e){i.data=e,t.view.render(i)}):t.view.render(i),t.app.taggerProxy.onCloseTagger()},I.prototype.getListItemsData=async function(e){let t=[],i=this.helper.getRelatedObjectIds(e),n=await this.queryRelatedDataObjects(i);return t=this.helper.processListItemsData(n.data)},I.prototype.showDetails=function(n){var a=this;e.mask(widget.body,t[this.params.loadingMask]);var o={...a.getParamsforContextandTargets(n.route),data:n.data,route:n.route};a.params=a.getParamsforContextandTargets(n.route),a.helper.processContextData(n.data.id||n.data.pid).then(function(r){o.contextDetails=r;let s=o.contextDetails["ds6w:what/ds6w:kind_value"],d=o.contextDetails["ds6w:what/ds6w:type_value"]||o.contextDetails["ds6w:what/ds6w:type"],c="",u=a.params.detailsRoutePath===l.QUALIFICATION_CONTEXT_DETAILS_VIEW?widget.getValue(l.QUALIFICATION_CONTEXT_ALLOWED_TYPES):widget.getValue(l.QUALIFICATION_TARGET_ALLOWED_TYPES),p=[];a.gettypeshierarchy([d]).then(function(e){if(p=e.types_hierarchies[0].hierarchy,c=a.helper.getTypeFromTypeHierarchy(p,d,u),0===Object.keys(o.contextDetails).length)return void widget.notificationUtil.showError(i.object_not_found_not_indexed);if(!u.includes(c)||s===l.MEI_EXTENSION)return void widget.notificationUtil.showError(t.invalid_object_dropped);a.getAllDetails(o.data.pid||o.data.id,n.route).then(function(e){let t=[];e.forEach(function(e){t.push(e.id)}),a.app._utility.get6WTagsForIDs(t,a.model).then(async function(i){let n={};const s=i.data||[],d=m.getPlatformId()===l.ONPREMISE?"":await a.updatedQualTagData(t,s);n=a.app._utility.buildTagObjectData(d||s),o.qualData=e,a.detailsView.render(o),a.app.taggerProxy.initTaggerProxy(r.qualData,n,a.detailsView.relatedQualificationsView.tableView),a.detailsView.relatedQualificationsView.tableView.collectionViewEvents.publish({event:"xsourcing-collectionview-update-count",data:e.length})})}),0===JSON.parse(widget.getValue(o.recentTrackerWidgetPreference)).filter(e=>e.pid===(n.data.id||n.data.pid)).length&&a.addToWidgetTracker([{pid:n.data.id||n.data.pid}],o.recentTrackerWidgetPreference,o.listViewMaxSize),o.data.isRefresh&&(n.data.qualIdToHighlight="",o.data.qualIdToHighlight="")}).catch(function(){widget.notificationUtil.showError(t.internal_server_error)}).finally(function(){e.unmask(widget.body)})})},I.prototype.destroyDetailsView=function(){this.detailsView.destroy()},I.prototype.updatedQualTagData=async function(e,t){const i=await this.getTagForOnCloud(e);return t.map(e=>{const t=i[e.id].contextIds,n=i[e.id].targetId;return{...e,[l.QUALIFICATION_CONTEXT]:t.map(e=>e[1]),[l.QUALIFICATION_TARGET]:[n[1]],[l.QUALIFICATION_CONTEXT_TYPE]:t.map(e=>e[2]),[l.QUALIFICATION_TARGET_TYPE]:[n[2]]}})},I.prototype.renderPropertiesView=function(e){if(e.qualIdToHighlight&&""!==e.qualIdToHighlight){let t={contextObjId:e.qualIdToHighlight,currentContextId:e.id};widget.app._applicationChannel.publish({event:"information-panel-add-content",data:{openDetails:this.getQualificationOpenInInfoPanel(t,this)}}),widget.app._applicationChannel.publish({event:"information-panel-open-without-reload-content"})}else this.helper.renderPropertiesView({id:e.id,applicationChannel:widget.app._applicationChannel,_triptychWrapper:widget.app._triptychWrapper})},I.prototype.getAllDetails=function(e,t){var i=this;let n={postData:{data:[{id:e,tenant:i.app.platformServices.platformId}]}},a=function(e){let t=[];return e.data.forEach(e=>{t.push({id:e.id,name:e.name,...e.isVersionOf&&{isVersionOf:e.isVersionOf}})}),t};return new Promise(e=>{t===l.QUALIFICATION_TARGET_DETAILS_VIEW?i.model.getQualificationTargetDetails(n,"contextQualification",["isVersionOf","name"]).then(function(t){e(a(t))}):i.model.getQualificationContextDetails(n,"contextQualification",["isVersionOf","name"]).then(function(t){e(a(t))})})},I.prototype.addToWidgetTracker=function(e,t,i){var n=JSON.parse(widget.getValue(t));e.forEach(e=>{var t=e._options?e._options:e;t.pid=t.pid||t.id||t.physicalid,n=n.filter(e=>e.pid!==t.pid);var i={pid:t.pid,label:t.label,name:t.name,sourceid:t.sourceid};n.unshift(i)});var a=JSON.parse(widget.getValue(i)),o=a||10;n.length>o&&n.pop(),widget.setValue(t,JSON.stringify(n))},I.prototype.gridCellUpdate=function(e){let i=e.cellInfos,n=e.dataIndex,a=e.value,o=e.attributeName,r=e.successMessage,s=e.extensionName,d={};d.qualId=i.nodeModel.options.grid.id,d.addData={data:[{type:l.TYPE_QUALIFICATION_LIST[2],dataelements:{[o]:a.toString()}}]},this.model.updateQualificationPromise(d).then(function(e){widget.notificationUtil.showSuccess(r?r+'"'+e.data[0].dataelements.name+'"':'"'+e.data[0].dataelements.name+'" '+t.updated_successfully);let a={comments:e.data[0].dataelements["SRC Comments"],approved:e.data[0].dataelements["SRC Approved"],restriction:e.data[0].dataelements.Restriction,title:e.data[0].dataelements.title};if(s&&n){let t=e.data[0].relateddata["interface-details"].find(e=>e.id===s).children.find(e=>e.id===o),i=t.dataelements.value;if("timestamp"===t.dataelements.type&&t.dataelements.displayRanges){let e=new Date(t.dataelements.value);i=e.getFullYear()+"/"+(e.getMonth()<9?"0"+(e.getMonth()+1).openQualificationInformationtoString():(e.getMonth()+1).toString())+"/"+e.getDate()+l.GMTTIME}a[n]=i}i.nodeModel.updateOptions({grid:a})},function(e){widget.notificationUtil.showError(e.internalError&&500===e.statusCode?e.internalError:e.error),i.nodeModel.updateOptions({})}).catch(function(e){widget.notificationUtil.showError(e.message?e.message:e.toString()),i.nodeModel.updateOptions({})})},I.prototype.addExtensionColumn=function(e){let n=this,a=n.detailsView.relatedQualificationsView.tableView,o=a.options.columnsConfigurations.find(e=>e.text===t.qualification),r=o.children.length;e.forEach(function(e){e.id.includes(l.VALIDATION_LEVEL_SUB_STRING)&&!o.children.some(e=>e.dataIndex===l.VALIDATION_LEVEL_COLUMN_NAME)?o.children.splice(r,0,{dataIndex:l.VALIDATION_LEVEL_COLUMN_NAME,text:t.Validation_Level,editableFlag:!0,setCellValue:function(e,t){let i=this.getColumnOrGroup(e.columnID);e.nodeModel.options.grid[i.dataIndex]!==t&&n.gridCellUpdate({cellInfos:e,dataIndex:i.dataIndex,value:t,attributeName:e.nodeModel.options.grid.Validation_Level_Attribute_Name,extensionName:e.nodeModel.options.grid.Validation_Level_Extension_Name})},getCellEditableState:function(t){return n.helper.getEditAccess(t.nodeModel.options.grid.modifyAccess)&&"true"!==e.readOnly},getCellSemantics:function(e){let t=e.nodeModel.options.grid.Validation_Level_Attribute_Range,i=e.nodeModel.options.grid.Validation_Level_Attribute_Range_Display;return{possibleValues:Array.isArray(t)?n.commonUtility.processLabelValue(t,i):""}}}):o.children.some(t=>t.dataIndex===e.id)||e.id.includes(l.VALIDATION_LEVEL_SUB_STRING)||o.children.push({dataIndex:e.id,text:e.displayName?e.displayName:e.id,editableFlag:!0,extensionName:e.extensionName,...!e.range&&{typeRepresentation:n.commonUtility.getTypeRepresentationKey({type:e.type})},...e.range&&{range:e.range},...e.displayRanges&&{displayRanges:e.displayRanges},setCellValue:function(e,t){let i=this.getColumnOrGroup(e.columnID);e.nodeModel.options.grid[i.dataIndex]!==t&&n.gridCellUpdate({cellInfos:e,dataIndex:i.dataIndex,value:t,attributeName:i.dataIndex,extensionName:i.extensionName})},getCellEditableState:function(t){return n.helper.getEditAccess(t.nodeModel.options.grid.modifyAccess)&&"true"!==e.readOnly},getCellSemantics:function(){if(e.range)return{possibleValues:n.commonUtility.processLabelValue(e.range,e.displayRanges)}},getCellValueForExport:function(t){if(t.nodeModel){let n=t.nodeModel.getAttributeValue(e.id);switch(e.type){case"boolean":return Array.isArray(n)?void 0===n[0]||""===n[0]?i.FALSE:i[n[0]]:void 0===n||""===n?i.FALSE:i[n];case"date":case"timestamp":{let e=f.getDateStringForDisplay(n);return e?e.substring(0,e.lastIndexOf(",")):""}}}return t.cellModel}}),a._xsourcingCollectionViewUI._dataGridView.addColumnOrGroup(o,3)})},I.prototype.removeItemsDataGridView=function(i){var n=i.selectedNodes.map(e=>e.getAttributeValue("id")),a=JSON.parse(widget.getValue(i.recentTrackerWidgetPreference));return new UWA.Promise(function(e){a=a.filter(function(e){return-1===n.indexOf(e.pid)}),i.selectedNodes.forEach(e=>e.getTreeDocument().removeRoot(e)),i.collectionViewEvents.publish({event:"xsourcing-collectionview-update-count"}),widget.notificationUtil.showSuccess(t[i.removeMessage]),widget.setValue(i.recentTrackerWidgetPreference,JSON.stringify(a)),e()}).catch(function(e){widget.notificationUtil.showError(e)}).finally(function(){e.unmask(widget.body)})},I.prototype.buildGetLifecyclePayload=function(e){var t="/resources/v1/modeler/dssourcing/qualifications/generalqualifications";return"SRC Engineering Equivalent Qualification"===e.data.respParams.type?t="/resources/v1/modeler/dssourcing/qualifications/equivalentqualifications":"SRC Usage Qualification"===e.data.respParams.type&&(t="/resources/v1/modeler/dssourcing/qualifications/usagequalifications"),{data:[{id:e.data.respParams.id,physicalid:e.data.respParams.id,type:e.data.respParams.type,identifier:e.data.respParams.id,source:"Sourcing",relativePath:t}]}},I.prototype.queryRelatedDataObjects=async function(e){let t=this,i=e.erIDs,n=e.rdfIDs,a=e.sourcingIDs,o="title,type,typeNLS,revision,state,stateNLS,policy,ownerFullname,name,image,modified,organization,collabSpace",r={},s={},d={};if(i.length>0){let e=t.helper.getPostData(i);r=await this.queryObjectInfo(e,o)}if(a.length>0){let e=t.helper.getPostData(a);s=await this.queryObjectInfo(e,o,l.SOURCE_SOURCING),r.data.push(...s.data)}if(n.length>0){let e=m.getPlatformId()===l.ONPREMISE?[l.SOURCE_3DSPACE]:[l.SOURCE_3DSPACE,l.SOURCE_SOURCING,l.SOURCE_3DPLAN],i={completePreCond:""};n.forEach(e=>{i.completePreCond=i.completePreCond+'uri:"'+e.id+'"'+l.OR}),i.completePreCond=i.completePreCond.substring(0,i.completePreCond.length-3),i.nresults=n.length;let a=t.searchUtility.getSearchPayload([],[],e,i);d=await g.prototype.callFederatedSearch(a),d=t.helper.processFedSearchData(d),d=t.helper.convertFedSearchDataInObjectinfoResponseFormat(d);let o=await t.searchUtility.getNlsOfPropertiesValues({"ds6w:type":["dsplan:Project"]});d.forEach(function(e){e.typeNLS=o["ds6w:type"]["dsplan:Project"]}),r.data=r.data?[...r.data,...d]:[...d]}return r},I.prototype.openQualificationInformation=function(i){var n=this;let a="proof"===i.data.params.tabToOpen?t.opening_proof:t.opening_qualification;e.mask(i.detailsContainer,a),i.data.params.qualificationId=i.data.params.id,n.model.getDetails(i).then(async function(t){let a=n.getCurrentContextItemId(t),o=n.helper.getRelatedObjectIds(t.data),r=await n.queryRelatedDataObjects(o);t.data.objectInfodata=r.data,i.data.respParams=n.helper.processQualificationData(t,a)[0].grid,i.data.respParams.extensionDetails&&i.data.respParams.extensionDetails.forEach(e=>{e.options.forEach(e=>{if("timestamp"===e.dataelements.type&&e.dataelements.displayRanges){let t=f.getDateStringForDisplay(e.dataelements.value);e.dataelements.value=t.substring(0,t.lastIndexOf(",")),e.dataelements.displayRanges.forEach((t,i)=>{let n=f.getDateStringForDisplay(t);e.dataelements.displayRanges[i]=n.substring(0,n.lastIndexOf(","))})}})}),n.getRevisionGraph(i.data.respParams).then(function(t){i.data.versionGraph=t,i.getLifecycleData=n.buildGetLifecyclePayload(i),new s(n).render(i),e.unmask(i.detailsContainer)})},function(t){widget.notificationUtil.showError(t.internalError&&500===t.statusCode?t.internalError:t.error),e.unmask(i.detailsContainer)}).catch(function(t){widget.notificationUtil.showError(t.message?t.message:t.toString()),e.unmask(i.detailsContainer)})},I.prototype.getCurrentContextItemId=function(e){let t=this,i="";if(t.app.router.getState().name===l.QUALIFICATION_CONTEXT_DETAILS_VIEW){i=t.detailsView.relatedQualificationsView.options.data.currentContextId;let n=e.data.filter(e=>!!e.dataelements&&e.dataelements.Proxy_Id===i);i=n.length>0?i:e.data[0].relateddata.Context[0].id}else{let t=e.data[0].relateddata.Context[0];i=t.id}return i},I.prototype.openInInformationPanel=function(e){this.openQualificationInformation(e)},I.prototype.branchQualificationItem=function(e){if(!e||l.RELEASED!==e.getAttributeValue("state")&&l.OBSOLETE!==e.getAttributeValue("state"))widget.notificationUtil.showError(t.branching_qualification_error);else{var i={physicalid:e.getAttributeValue("id"),id:e.getAttributeValue("id"),displayName:e.getAttributeValue("title"),name:e.getAttributeValue("title"),revision:e.getAttributeValue("revision"),type:l.TYPE_QUALIFICATION_LIST[2],typeDisplayName:e.getAttributeValue("type"),current:e.getAttributeValue("state")};b.execute({branchingOptions:i})}},I.prototype.reviseQualificationItem=function(e,t){t.selectedNodes=e.tableView._xsourcingCollectionViewUI._dataGridView.getTreeDocument().getSelectedNodes(),t.contextualNode&&(t.selectedNodes=t.contextualNode.slice()),t.selectedItem&&t.selectedItem.length>0&&(t.selectedNodes=t.selectedItem),t.contextualNode=void 0,t.selectedNodes.length>0&&this.confirmRevisionAction(t)},I.prototype.confirmRevisionAction=function(e){var n=this;let a=e.selectedNodes[0].getAttributeValue("id"),o=e.selectedNodes[0].getAttributeValue("name");e.currentContextId=e.selectedNodes[0].getAttributeValue("context")[0]?e.selectedNodes[0].getAttributeValue("context")[0].id:e.selectedNodes[0].getAttributeValue("context").id,e.objectToConnectDetails=n.helper.processReviseObjectsToConnect(n.app.router.getRouter().getState().name),e.addData=n.helper.getRevisePayload(a),new d({renderTo:widget.body,className:"revise-dialog"}).dialog({body:e.objectToConnectDetails.reviseConfirmationMessage,title:t.revise+" - "+o,buttons:[{className:"primary",value:i.Yes,action:function(t){t.hide(),e.addData.data[0].dataelements.objectToConnect=e.objectToConnectDetails.objectToConnect,n.reviseQualification(e)}},{className:"default",value:i.No,action:function(t){t.hide(),n.reviseQualification(e)}},{className:"default",value:i.CANCEL_BUTTON,action:function(e){e.hide()}}]})},I.prototype.reviseQualification=function(i){var n=this;e.mask(widget.body,t.creating_qual_revision),this.model.reviseQualification(i).then(function(i){n.searchUtility.getPlatfromAPIObj().publish("Lifecycle.Modification",JSON.stringify(n.helper.getLifecycleEventObject("revise",i.data[0]))),e.unmask(widget.body),widget.notificationUtil.showSuccess(t.qualification+' "'+i.data[0].dataelements.name+'" '+t.created_successfully)},function(i){widget.notificationUtil.showError(i.internalError&&500===i.statusCode?i.internalError:i.error?i.error:t.error_while_creating_qualification),e.unmask(widget.body)}).catch(function(t){widget.notificationUtil.showError(t.message?t.message:t.toString()),e.unmask(widget.body)})},I.prototype.getQualificationOpenInInfoPanel=function(e,i){let n={tabToOpen:e.tabToOpen,contextObjId:e.contextObjId,callControllerMethod:i.model.get?i.model.get("controller"):i,updateTable:function(e){let n=i.tableView?i.tableView._xsourcingCollectionViewUI:i.detailsView.relatedQualificationsView.tableView._xsourcingCollectionViewUI,a=n._dataGridView.getTreeDocument().getAllDescendants().filter(t=>t._options.grid.id===e.id);e.grid.extensionDetails&&e.grid.extensionDetails.length>0&&(e.extensionColumns=[],e.grid.extensionDetails.forEach(function(t){t.options.forEach(function(i){i.id.includes(l.VALIDATION_LEVEL_SUB_STRING)?(e.grid.Validation_Level=i.dataelements.value,e.grid.Validation_Level_Attribute_Name=i.id,e.grid.Validation_Level_Extension_Name=t.label,e.grid.Validation_Level_Attribute_Range=i.dataelements.range?i.dataelements.range:"",e.grid.Validation_Level_Attribute_Range_Display=i.dataelements.displayRanges?i.dataelements.displayRanges:""):e.grid[i.id]=i.dataelements.value,e.extensionColumns.push({...i.dataelements,extensionName:t.label,id:i.id})})}));let o=i.params&&i.params.detailsRoutePath?i.params.detailsRoutePath:i.controller.params.detailsRoutePath;a&&1===a.length&&(a[0].getAttributeValue("extensionDetails")&&a[0].getAttributeValue("extensionDetails").forEach(t=>{t.options&&t.options.forEach(t=>{e.grid[t.id]||a[0].removeAttribute(t.id),e.grid.Validation_Level||a[0].removeAttribute("Validation_Level"),e.grid.Validation_Level_Attribute_Name||a[0].removeAttribute("Validation_Level_Attribute_Name"),e.grid.Validation_Level_Extension_Name||a[0].removeAttribute("Validation_Level_Extension_Name"),e.grid.Validation_Level_Attribute_Range||a[0].removeAttribute("Validation_Level_Attribute_Range"),e.grid.Validation_Level_Attribute_Range_Display||a[0].removeAttribute("Validation_Level_Attribute_Range_Display")})}),e.grid.name=`${e.grid.name} (${e.grid.revision})`,e.grid.state=e.grid.maturityState,l.QUALIFICATION_TARGET_DETAILS_VIEW===o&&(e.grid.additionalContexts=e.grid.contexts),e.extensionColumns&&i.controller.addExtensionColumn(e.extensionColumns),a[0].updateOptions(e)),"Progress View"===n.collectionToolbar._currentViewId&&(e.grid.approved="No"===e.grid.approved?t.rejected:"Yes"===e.grid.approved?t.approved:t.pending,e.grid.state=e.grid.maturityState,w.updateProgressViewNodes(e)),i.update?i.update():i.detailsView.relatedQualificationsView.update()}};return(new u).getObjectDetailsInInfoPanel(n)},I.prototype.getVersionGraphDetails=function(e){var i=this;let n={graphRequests:[]};return e.getRoots().forEach(e=>{n.graphRequests.push({id:e.getAttributeValue("id"),attributes:["SRCQUALIFICATION.Approved"]})}),new Promise(a=>{i.model.getVersionGraph(n).then(function(n){n.errorMessage&&(i.notifIds.push(widget.notificationUtil.showError(t.version_graph_error)),i.notifIds.forEach(function(e,t,i){t!==i.length-1&&widget.notificationUtil.removeNotificationById(e)}));var o=[],r=n.graphs.filter(e=>e.item);e.getRoots().map(i=>(r.forEach(n=>{let a=n.item.id,r=n.versions.find(e=>e.id===i.getAttributeValue("id"));r&&(i.setAttribute("semantic",r.ancestors?r.ancestors[0].semantic:""),i.setAttribute("parent",r.ancestors?r.ancestors[0].id:""),i.setAttribute("rootId",a)),(o=n.versions.filter(t=>!e.getRoots().some(e=>t.id===e.getAttributeValue("id")))).map(e=>(e.rootId=a,e)),o.forEach(i=>{e.addRoot(new p({grid:{id:i.id,semantic:i.ancestors?i.ancestors[0].semantic:"",parent:i.ancestors?i.ancestors[0].id:"",rootId:i.rootId,originated:i.creation,name:i.label+" ("+i.code+")",modified:i.modification,state:i.maturity_nls,approved:i["SRCQUALIFICATION.Approved"]?"No"===i["SRCQUALIFICATION.Approved"]?t.rejected:t.approved:t.pending,isNewRevision:!0},isNewRevision:!0,previousRevision:!0}))})}),i)),a(e)})})},I.prototype.getQualDetails=function(e,t){var i=this;let n={data:{params:{qualificationId:e}}};return new Promise(e=>{i.model.getDetails(n).then(async function(n){let a=i.helper.getRelatedObjectIds(n.data),o=await i.queryRelatedDataObjects(a);n.data.objectInfodata=o.data,e(i.helper.processQualificationData(n,t))})})},I.prototype.getParamsforContextandTargets=function(e){let t={detailsRoutePath:l.QUALIFICATION_CONTEXT_DETAILS_VIEW,recentTrackerWidgetPreference:"xsrcQualificationContext",listViewMaxSize:"xsrcQualificationContextListMaxSize",open_search_command:"open_qualification_context",removeMessage:"qualification_context_removed_sucessfully",removeRecentDialogTitle:"remove_my_qualification_context"};return"home.QualificationTargetsView"!==e&&e!==l.QUALIFICATION_TARGET_DETAILS_VIEW||(t={detailsRoutePath:l.QUALIFICATION_TARGET_DETAILS_VIEW,recentTrackerWidgetPreference:"xsrcQualificationTarget",listViewMaxSize:"xsrcQualificationTargetListMaxSize",open_search_command:"open_qualification_target",removeMessage:"qualification_target_removed_sucessfully",removeRecentDialogTitle:"remove_my_qualification_target"}),t},I.prototype.decideRouteUsingURL=function(e){let i=this;if(e.data.items[0].objectType===l.TYPE_QUALIFICATION_LIST[2]){let n={data:{params:{qualificationId:e.data.items[0].objectId}}};i.model.getDetails(n).then(function(e){let n=e.data[0];n.relateddata.target[0].dataelements.interface!==l.MEI_EXTENSION&&n.relateddata.target[0].dataelements.type!==l.MEI_PROXY?i.openModalWithOptions(n.relateddata.Context[0].dataelements.Proxy_Id||n.relateddata.Context[0].id,n.id,n.relateddata.target[0].dataelements.Proxy_Id||n.relateddata.target[0].id):widget.notificationUtil.showError(t.openWithSPIQ)})}else e.data.items[0].objectId&&i.helper.processContextData(e.data.items[0].objectId).then(function(n){let a=n;(a["ds6w:what/ds6w:kind_value"]||a["ds6w:what/ds6w:kind"])!==l.MEI_EXTENSION?i.openWithOptions(e.data.items[0].objectType,e.data.items[0].objectId):widget.notificationUtil.showError(t.openMEIWithSPIQ)})},I.prototype.openWithOptions=function(e,t,n){let a=this;widget.getValue(l.QUALIFICATION_CONTEXT_ALLOWED_TYPES).includes(e)&&widget.getValue(l.QUALIFICATION_TARGET_ALLOWED_TYPES).includes(e)?a.openModalWithOptions(t,n):widget.getValue(l.QUALIFICATION_TARGET_ALLOWED_TYPES).includes(e)?a.app.router.navigate(l.QUALIFICATION_TARGET_DETAILS_VIEW,{id:t,...n&&{qualIdToHighlight:n}}):widget.getValue(l.QUALIFICATION_CONTEXT_ALLOWED_TYPES).includes(e)?a.app.router.navigate(l.QUALIFICATION_CONTEXT_DETAILS_VIEW,{id:t,...n&&{qualIdToHighlight:n}}):widget.notificationUtil.showError(i.object_unsupported)},I.prototype.openModalWithOptions=function(e,i,n){let a=this;new d({renderTo:widget.body,className:"open-with-context-or-target"}).dialog({body:t.open_with_context_target,title:t.title_qualification_management,buttons:[{className:"primary",value:t.context_details_view,action:function(t){t.hide(),a.app.router.navigate(l.QUALIFICATION_CONTEXT_DETAILS_VIEW,{id:e,...i&&{qualIdToHighlight:i}})}},{className:"default",value:t.target_details_view,action:function(t){t.hide(),a.app.router.navigate(l.QUALIFICATION_TARGET_DETAILS_VIEW,{id:n||e,...i&&{qualIdToHighlight:i}})}}]})},I.prototype.getProcessedQualificationData=async function(e,t){let i=this.helper.getRelatedObjectIds(e),n=await this.queryRelatedDataObjects(i);return this.formatQualData(e,n,t)},I.prototype.formatQualData=function(e,i,n){return e.map((e,a,o)=>{e.target={...e.target,...i.data.find(t=>t.id===e.target.id||e.target.dataelements&&t.id===e.target.dataelements.Proxy_Id)},e.contexts=e.contexts.map(e=>{let t={...e,...i.data.find(t=>t.id===e.id||e.dataelements&&t.id===e.dataelements.Proxy_Id)};return t.label=t.revision?`${t.title} (${t.revision})`:`${t.title}`,t}),e.context=this.params.detailsRoutePath===l.QUALIFICATION_CONTEXT_DETAILS_VIEW?e.contexts.filter(e=>e.id===n):e.contexts,e.additionalContexts=e.contexts.filter(e=>e.id!==n),e.prerequisite=e.prerequisite.length>0&&e.prerequisite.map(e=>({...e,...i.data.find(t=>t.id===e.id)})),e.prereq=e.prerequisite.length>0?`${e.prerequisite[0].title} (${e.prerequisite[0].revision})`:"",e.title=e.Title?e.Title:e.name,e.name=`${e.name} (${e.revision})`,e.owner=e.ownerInfo?`${e.ownerInfo.firstname} ${e.ownerInfo.lastname}`:e.owner,e.approvedDisplay="No"===e.approved?t.rejected:"Yes"===e.approved?t.approved:t.pending,e.targetTitle=`${e.target.title} (${e.target.revision})`,e.targetType=e.target.typeNLS,e.contextTitle="",e.contextType="",e.contexts.forEach(t=>{e.contextTitle+=` ${t.label}`,e.contextType+=` ${t.typeNLS}`}),e.extensionValue="",o[a]={...e,...this.getExtensionColumns(e["interface-details"])}}),e},I.prototype.getExtensionColumns=function(e){if(e&&e.length>0){let t={extensionColumns:[]};return e.forEach(function(e){e.children.forEach(function(i){i.id.includes(l.VALIDATION_LEVEL_SUB_STRING)?(t.extensionValue+=` ${i.value}`,t.Validation_Level=i.value,t.Validation_Level_Attribute_Name=i.id,t.Validation_Level_Extension_Name=e.id,t.Validation_Level_Attribute_Range=i.range?i.range:"",t.Validation_Level_Attribute_Range_Display=i.displayRanges?i.displayRanges:""):(t[i.id]=i.value,t.extensionValue+=` ${i.value}`),t.extensionColumns.push({...i,extensionName:e.id})})}),t}},I.prototype.gettypeshierarchy=function(e){return new Promise((i,n)=>{this.model.gettypeshierarchy(e).then(function(e){i(e)},function(e){n(e)}).catch(function(){widget.notificationUtil.showError(t.internal_server_error)})})},I.prototype.updateViewWithNewData=async function(e,t){t.map((e,t,i)=>{i[t]={...e,...e.dataelements},i[t].target=e.relateddata.target[0],i[t].contexts=e.relateddata.Context,i[t]["interface-details"]=e.relateddata["interface-details"],i[t].prerequisite=e.relateddata.PreReq});let i=await this.getProcessedQualificationData(t,t[0].contextId);if(i[0].extensionColumns){let e=[];i[0].extensionColumns.forEach(t=>{e.push({...t.dataelements,id:t.id,extensionName:t.extensionName})}),i[0].extensionColumns=e}if(i[0].highLight=!0,"Progress View"!==e._xsourcingCollectionViewUI.collectionToolbar._currentViewId)if(0!==e.options.dataSource.dataIndexesToGroup.length||e.options.dataSource.sortModel)this.getAllDetails(t[0].contextId,this.app.router.getState().name).then(function(t){e.options.dataSource.referenceArray=t,e._xsourcingCollectionViewUI._dataGridView.prepareUpdateView(),e.options.dataSource.availableProperties=[],e.options.dataSource.dataIndexesToGroup.length>0&&e._xsourcingCollectionViewUI._dataGridView.groupRows({dataIndexesToGroup:e.options.dataSource.dataIndexesToGroup}),e.options.dataSource.sortModel&&e._xsourcingCollectionViewUI._dataGridView.reapplySortModel(),e._xsourcingCollectionViewUI._dataGridView.pushUpdateView(),e.collectionViewEvents.publish({event:"xsourcing-collectionview-update-count",data:e.options.dataSource.referenceArray.length})});else{let n=e.options.dataSource.referenceArray;e._xsourcingCollectionViewUI._dataGridView.dataSource.pushUpdatesNotifications([{operationType:"nodesAdded",nodesNumber:1,nodesPath:[0]}],function(e){e.treatedNotificationsNodesNumber>0&&!n.find(e=>e.id===t[0].id)&&n.splice(0,0,i[0])}),e.collectionViewEvents.publish({event:"xsourcing-collectionview-update-count",data:n.length})}else e.options.dataSource.referenceArray.find(e=>e.id===t[0].id)||this.getAllDetails(t[0].contextId,this.app.router.getState().name).then(function(n){e.options.dataSource.referenceArray=n,e.collectionViewEvents.publish({event:"xsourcing-collectionview-update-count",data:e.options.dataSource.referenceArray.length}),"new"===t[0].operation?e.options.localChannel.publish({event:"add-progress-view-row",data:i}):e.options.localChannel.publish({event:"update-progress-view-row",data:i})});return e._xsourcingCollectionViewUI.unSelectAll(),t[0].id},I.prototype.queryObjectInfo=async function(e,t,i=""){return await this.model.getObjectInfo(e,t,i)},I.prototype.queryQualificationIds=async function(e,t){let i=await this.model.getQualificationDetails({postData:e});return await this.getProcessedQualificationData(i.data,t)},I.prototype.getTagForOnCloud=async function(e){const t={data:e.map(e=>({id:e}))};let i=(await this.model.getQualificationDetails({postData:t})).data,n={};i.forEach(e=>{n[e.id]={contextIds:e.contexts.map(e=>e.id),targetId:e.target.id}});let a=this.helper.getRelatedObjectIds(i),o=await this.queryRelatedDataObjects(a);return o.data&&o.data.forEach(e=>{for(const t in n)if(n.hasOwnProperty(t)){let i=n[t].contextIds.findIndex(t=>t===e.id);-1!==i&&(n[t].contextIds[i]=[n[t].contextIds[i],e.title?e.title:e.name,e.type]),e.id===n[t].targetId&&(n[t].targetId=[n[t].targetId,e.title?e.title:e.name,e.type])}}),n},I.prototype.getVersionGraphPayload=function(e){let t=this.app.router.getState().name===l.QUALIFICATION_CONTEXT_DETAILS_VIEW,i={graphRequests:[]};return t&&i.graphRequests.push({id:e.target.id}),i.graphRequests.push({id:e.id}),(t?e.additionalContexts:e.contexts).map(n=>n.id===e.contextId&&t?"":i.graphRequests.push({id:n.id})),i},I.prototype.getFederatedSearchPayload=function(e,t){let i,n=this.app.router.getState().name===l.QUALIFICATION_CONTEXT_DETAILS_VIEW,a=[l.SOURCE_3DSPACE,l.SOURCE_SOURCING,l.SOURCE_3DPLAN];t.push(e.name),i='(flattenedtaxonomies:"types/'+e.type+'" AND "'+e.name+'")',n?(t.push(e.target.name),i+=' OR (flattenedtaxonomies:"types/'+e.target.type+'" AND "'+e.target.name+'")'):(t.push(e.context.name),i=l.DSPLAN_PROJECT===e.context.type?' ( [dsplan:type]:"'+e.context.type+'" AND "'+e.context.name+'")':'(flattenedtaxonomies:"types/'+e.context.type+'" AND "'+e.context.name+'")'),e.additionalContexts.map(a=>{if(a.id!==e.context.context_ProxyId||!n){let e=a.objectInfodata.name,n=a.objectInfodata.type;t.push(e),l.DSPLAN_PROJECT===n?i+=' OR ( [dsplan:type]:"'+n+'" AND "'+e+'")':i+=' OR (flattenedtaxonomies:"types/'+n+'" AND "'+e+'")'}});var o={completePreCond:i=n?i:i.substring(4),nresults:999};return g.prototype.getSearchPayload([],[],a,o)},I.prototype.prepareVersionGraphFromFedSearch=function(i,n){let a=this,o=[],r=[],s=[],d=widget.getValue(l.QUALIFICATION_CONTEXT_ALLOWED_TYPES),c=widget.getValue(l.QUALIFICATION_TARGET_ALLOWED_TYPES);return i.forEach(e=>{s.push(e["ds6w:what/ds6w:type_value"]||e["ds6w:what/ds6w:type"]||e["ds6w:type_value"]||e["ds6w:type"])}),new Promise((l,u)=>{a.gettypeshierarchy(s).then(function(e){i.forEach(t=>{if(n.includes(t["ds6w:identifier"])){let i=t["ds6w:what/ds6w:type"]||t["ds6w:type_value"]||t["ds6w:type"],n=i,o=e.types_hierarchies.find(e=>e.type===i),l=o&&o.hierarchy;n=a.helper.getTypeFromTypeHierarchy(l,i,[...d,...c]),r.push({title:t["ds6w:label"]||"",id:t.physicalid||t.resourceid,sourceid:t.sourceid,actualType:t["ds6w:what/ds6w:type_value"]||t["ds6w:what/ds6w:type"]||t["ds6w:type_value"],proxyType:n})}}),a.helper.getProxyItemId(r).then(function(e){i.map((t,i,n)=>{n[i].proxyId=e[i]}),n.forEach(e=>{let t={};t.versions=i.filter(t=>t["ds6w:identifier"]===e),o.push(t)}),l(o)},function(e){u(e)}).catch(function(){widget.notificationUtil.showError(t.internal_server_error)})}).catch(function(){widget.notificationUtil.showError(t.internal_server_error)}).finally(function(){e.unmask(widget.body)})})},I.prototype.getRevisionGraph=function(e){let i=this;return new Promise((n,a)=>{if(m.getPlatformId()===l.ONPREMISE){let o=i.getVersionGraphPayload(e);i.model.getVersionGraph(o).then(function(e){n(e.graphs)},function(e){a(e)}).catch(function(){widget.notificationUtil.showError(t.internal_server_error)})}else{let o=[],r=i.getFederatedSearchPayload(e,o);g.prototype.callFederatedSearch(r).then(function(e){let l=e;g.prototype.callRecentFederatedSearch(r).then(function(e){let r=e;l.results=r.results?[...l.results,...r.results]:l.results;let s=i.helper.processFedSearchData(l);i.prepareVersionGraphFromFedSearch(s,o).then(function(e){n(e)},function(e){a(e)}).catch(function(){widget.notificationUtil.showError(t.internal_server_error)})},function(e){a(e)}).catch(function(){widget.notificationUtil.showError(t.internal_server_error)})},function(e){a(e)}).catch(function(){widget.notificationUtil.showError(t.internal_server_error)})}})},I.prototype.getProofsData=async function(e){let t=await this.model.getProofs(e);return await this.processProofsData(t.data)},I.prototype.processProofsData=async function(e){let t=this,i=[];if(e){let n=t.searchUtility.getSearchPayload(e.map(e=>e.dataelements.Proxy_Id),[l.DOCUMENT,l.TYPE_TEST_SPECIFICATION],[]),a=await t.searchUtility.callFederatedSearch(n);t.helper.processFedSearchData(a).forEach(t=>{let n=e.filter(e=>e.dataelements.Proxy_Id===t.physicalid)[0];i.push({grid:{title:t["ds6w:label"],tree:t["ds6w:label"],name:t.name,id:t.physicalid,revision:t["ds6wg:revision"],state:t["ds6w:what/ds6w:status"],type:t["ds6w:what/ds6w:type"],actualType:t["ds6w:what/ds6w:type_value"]||t["ds6w:what/ds6w:type"],image:t.preview_url,source:n&&n.Proxy_Service?n.Proxy_Service:t.type!==l.QUALIFICATION_PROOF_PROXY?l.SERVICE_3DSPACE:l.SOURCE_SOURCING,service:n&&n.Proxy_Service?n.Proxy_Service===l.SOURCE_3DSPACE?l.SERVICE_3DSPACE:n.Proxy_Service:t.type!==l.QUALIFICATION_PROOF_PROXY?l.SERVICE_3DSPACE:l.SOURCE_SOURCING},label:t["ds6w:label"],subLabel:t["ds6w:what/ds6w:status"],thumbnail:t.preview_url,id:t.physicalid,proxy_id:n&&n.id})})}return i},I.prototype.insertByExistingHandler=async function(e,i,n){let a=this,r=e._xsourcingCollectionViewUI._selectedItems[0]||e.contextualMenuNode,l=e._gridModel.getRoots().filter(e=>"Contexts"===e.getAttributeValue("id")),s=e._gridModel.getRoots().filter(e=>"Target Items"===e.getAttributeValue("id")),d=r.children?r.children.map(e=>e.getAttributeValue("id")):"";d.push(s[0].getChildren()[0].getAttributeValue("id"));let c={callbackfunction:async function(r){if(r){let s=await a.getUpdateScopeViewPayload(l,r,[]),d={id:i,addData:s,onComplete:async function(){let o=a.helper.getChildNodeDefinition(r,r,"Contexts");e._gridModel.prepareUpdate(),o.forEach(e=>{l[0].addChild(new p(e))}),l[0].updateOptions({label:t.contexts+" ("+l[0].getChildren().length+")",grid:{tree:t.contexts+" ("+l[0].getChildren().length+")"}}),e._gridModel.pushUpdate(),e.collectionViewEvents.publish({event:"xsourcing-collectionview-update-count",data:e._xsourcingCollectionViewUI._dataGridView.treeDocument.getAllDescendants().length-3}),widget.notificationUtil.showSuccess(t.insert_by_existing_success);let s=await a.getQualDetails(i,a.detailsView.relatedQualificationsView.data.currentContextId);n(s[0])},onFailure:function(){widget.notificationUtil.showError(t.error_changing_target_context)}};(new o).updateQualifications(d)}},idsToExclude:d,multiSel:!0};this.helper.getSearchOptionsfor3dSearchtoUpdateTargetContext(r,c)},I.prototype.replaceByLatestRevisionHandler=async function(e,i,n){let a=this,r=e._xsourcingCollectionViewUI._selectedItems[0]||e.contextualMenuNode,s="";l.DSPLAN_PROJECT===r.grid.actualType?s+='( [dsplan:type]:"'+r.grid.actualType+'" AND [ds6w:identifier]:"'+r.grid.name+'" AND '+l.ISLASTREVISION+":true ) OR ":s+='(flattenedtaxonomies:"types/'+r.grid.actualType+'" AND [ds6w:identifier]:"'+r.grid.name+'" AND '+l.ISLASTREVISION+":true ) OR ",s=s?s.substring(0,s.length-4):"";let d=await this.helper.getSearchDataforUpdateTargetContext(s),c=e._gridModel.getRoots().filter(e=>r.grid.parentName===e.getAttributeValue("id")),u=c[0].getChildren().filter(e=>r.grid.id===e.getAttributeValue("id")),g=d.filter(e=>e.name===u[0].getAttributeValue("name")&&e["ds6wg:revision"]!==u[0].getAttributeValue("revision"));if(g.length>0){let r=await a.getUpdateScopeViewPayload(c,g,[u[0].getAttributeValue("proxyId")]),l={id:i,addData:r,onComplete:async function(){e._gridModel.prepareUpdate(),c[0].removeChild(u[0]);let o=a.helper.getChildNodeDefinition(g,g,u[0].getAttributeValue("parentName"));c[0].addChild(new p(o[0])),e._gridModel.pushUpdate();let r=t.replace_by_latest_revision_success;r=(r=r.replace("$1",u[0].getAttributeValue("label")+" ("+u[0].getAttributeValue("revision")+")")).replace("$2",o[0].grid.tree+" ("+o[0].grid.revision+")"),widget.notificationUtil.showSuccess(r);let l=await a.getQualDetails(i,a.detailsView.relatedQualificationsView.data.currentContextId);n(l[0])},onFailure:function(){widget.notificationUtil.showError(t.error_changing_target_context)}};(new o).updateQualifications(l)}else widget.notificationUtil.showError(t.info_attach_latest_revision)},I.prototype.replaceByExistingHandler=async function(e,i,n){let a=this,r=e._xsourcingCollectionViewUI._selectedItems[0]||e.contextualMenuNode,l=e._gridModel.getRoots().filter(e=>r.grid.parentName===e.getAttributeValue("id")),s=[];e._gridModel.getRoots().forEach(e=>{s=[...s,...e._options.children.map(e=>e.getAttributeValue("id"))]});let d={callbackfunction:async function(s){if(s){let d=l[0].getChildren().filter(e=>r.grid.id===e.getAttributeValue("id")),c=await a.getUpdateScopeViewPayload(l,s,[r.grid.proxyId]),u={id:i,addData:c,onComplete:async function(){e._gridModel.prepareUpdate(),l[0].removeChild(d[0]);let o=a.helper.getChildNodeDefinition(s,s,d[0].getAttributeValue("parentName"));l[0].addChild(new p(o[0])),e._gridModel.pushUpdate();let r=t.replace_by_existing_success;r=(r=r.replace("$1",d[0].getAttributeValue("label"))).replace("$2",o[0].label),widget.notificationUtil.showSuccess(r);let c=await a.getQualDetails(i,a.detailsView.relatedQualificationsView.data.currentContextId);n(c[0])},onFailure:function(){widget.notificationUtil.showError(t.error_changing_target_context)}};(new o).updateQualifications(u)}},idsToExclude:s,multiSel:!1};this.helper.getSearchOptionsfor3dSearchtoUpdateTargetContext(r,d)},I.prototype.replaceByRevisionHandler=async function(e,i,n){let a=this,r=e._xsourcingCollectionViewUI._selectedItems[0]||e.contextualMenuNode,s=e._gridModel.getRoots().filter(e=>r.grid.parentName===e.getAttributeValue("id")),d=s[0]._options.children.map(e=>e.getAttributeValue("id")),c="";l.DSPLAN_PROJECT===r.grid.actualType?c+='( [dsplan:type]:"'+r.grid.actualType+'" AND [ds6w:identifier]:"'+r.grid.name+'") OR ':c+='(flattenedtaxonomies:"types/'+r.grid.actualType+'" AND [ds6w:identifier]:"'+r.grid.name+'") OR ';let u={callbackfunction:async function(l){if(l){let d=s[0].getChildren().filter(e=>r.grid.id===e.getAttributeValue("id")),c=await a.getUpdateScopeViewPayload(s,l,[r.grid.proxyId]),u={id:i,addData:c,onComplete:async function(){e._gridModel.prepareUpdate(),s[0].removeChild(d[0]);let o=a.helper.getChildNodeDefinition(l,l,d[0].getAttributeValue("parentName"));s[0].addChild(new p(o[0])),e._gridModel.pushUpdate();let r=t.replace_by_latest_revision_success;r=(r=r.replace("$1",d[0].getAttributeValue("label")+" ("+d[0].getAttributeValue("revision")+")")).replace("$2",o[0].grid.tree+" ("+o[0].grid.revision+")"),widget.notificationUtil.showSuccess(r);let c=await a.getQualDetails(i,a.detailsView.relatedQualificationsView.data.currentContextId);n(c[0])},onFailure:function(){widget.notificationUtil.showError(t.error_changing_target_context)}};(new o).updateQualifications(u)}},idsToExclude:d,queryString:c=c?c.substring(0,c.length-4):"",multiSel:!1};this.helper.getSearchOptionsfor3dSearchtoUpdateTargetContext(r,u)},I.prototype.removeTargetContextScopeTabHandler=async function(e,i,n){let a=this,r=e._xsourcingCollectionViewUI._selectedItems[0]||e.contextualMenuNode,l=e._gridModel.getRoots().filter(e=>r.grid.parentName===e.getAttributeValue("id")),s=await this.getUpdateScopeViewPayload(l,[],[r.grid.proxyId]),d=l[0].getChildren().filter(e=>r.grid.id===e.getAttributeValue("id")),c={id:i,addData:s,onComplete:async function(){e._gridModel.prepareUpdate(),l[0].removeChild(d[0]),l[0].updateOptions({label:t.contexts+" ("+l[0].getChildren().length+")",grid:{tree:t.contexts+" ("+l[0].getChildren().length+")"}}),e._gridModel.pushUpdate(),e.collectionViewEvents.publish({event:"xsourcing-collectionview-update-count",data:e._xsourcingCollectionViewUI._dataGridView.treeDocument.getAllDescendants().length-3});let o=t.removed_successfully;o=o.replace("$1",d[0].getAttributeValue("label")),widget.notificationUtil.showSuccess(o);let r=await a.getQualDetails(i,a.detailsView.relatedQualificationsView.data.currentContextId);n(r[0])},onFailure:function(){widget.notificationUtil.showError(t.error_changing_target_context)}};(new o).updateQualifications(c)},I.prototype.getUpdateScopeViewPayload=async function(e,t,i){let n=[];if(m.getPlatformId()===l.ONPREMISE)n=t&&t.map(e=>e.id||e.physicalid);else{let e=[...new Set([...widget.getValue(l.QUALIFICATION_CONTEXT_ALLOWED_TYPES),...widget.getValue(l.QUALIFICATION_TARGET_ALLOWED_TYPES)])],i=await this.gettypeshierarchy(e),a=[];t&&t.forEach(t=>{let n=t["ds6w:type_value"]||t.type_Actual,o=i.types_hierarchies.find(e=>e.type===n).hierarchy,r=this.helper.getTypeFromTypeHierarchy(o,n,e);a.push({title:t["ds6w:label"],id:t.resourceid,sourceid:t.sourceid?t.sourceid.split(":")[0]:"",actualType:t["ds6w:type_value"],proxyType:r})}),n=await this.helper.getProxyItemId(a)}return t&&t.map((e,t,i)=>{i[t].proxyId=n[t]}),this.helper.getUpdateTargetContextPayload(e,n,i)},I}),define("DS/ENOXGenericQualification/controllers/QualificationController",["DS/UIKIT/Mask","DS/ENOXGenericQualification/models/Qualification","DS/ENOXGenericQualification/views/Qualification/NewQualification","DS/ENOXGenericQualification/helpers/QualificationHelper","i18n!DS/ENOXGenericQualification/assets/nls/ENOXGenericQualification","DS/ENOXGenericQualification/controllers/QualificationContextsController","DS/ENOXSourcingUXInfra/Constants/ENOXSourcingConstants"],function(e,t,i,n,a,o,r){"use strict";var l=function(e){this.model=new t(this),this.helper=new n,this.app=e?e.app:void 0,this.qualificationContextsController=new o({app:this.app})};return l.prototype.newQualification=function(e,t){new i(this).render(e,t)},l.prototype.create=function(t,i,n){var o=this,l=i[0].selectedItems;t.addData=this.wrapData(o.app.platformServices.ENO_CSRF_TOKEN,this.processFormValues(t.formValues)),t.onComplete=async function(i){if(t.qualificationCreateCallBack(),t.extensionDetails&&t.extensionDetails.selectedInterfaces){var s={data:[{type:r.TYPE_QUALIFICATION_LIST[2],dataelements:{interface:t.extensionDetails.selectedInterfaces}}]};t.extensionDetails.selectedAttributes&&t.extensionDetails.selectedAttributes.forEach(function(e){0!==e.length&&e.forEach(function(e){var t=e.name,i=Array.isArray(e.value)?e.value[0]:e.value;s.data[0].dataelements[t]=""===i||void 0===i?e.defaultValue:i})}),t.addData=s,t.qualId=i.data[0].id,i=await o.model.updateQualificationPromise(t)}let d=o.helper.getRelatedObjectIds(i.data),c=await o.qualificationContextsController.queryRelatedDataObjects(d);i.data.objectInfodata=c.data;let u=o.helper.processQualificationData(i,l[0]?l[0].getAttributeValue("id")||l[0].getAttributeValue("physicalid"):n.contextItem.id),p=t.fromContextDetailsPage?u[0].grid.context.id:u[0].grid.target.id;i.data[0].contextId=p,i.data[0].operation="new",t.fromContextDetailsPage||t.fromTargetDetailsPage?n.localChannel.publish({event:"update-data",data:i.data}):o.qualificationContextsController.app.router.navigate(r.QUALIFICATION_CONTEXT_DETAILS_VIEW,{id:l[0].getAttributeValue("pid")||l[0].getAttributeValue("id")||l[0].getAttributeValue("physicalid"),qualIdToHighlight:u[0].grid.id}),e.unmask(widget.body);var g={level:"success",subtitle:a.qualification+' "'+u[0].grid.name+'" '+a.created_successfully,sticky:!1,allowUnsafeHTML:!1};window.notifs.addNotif(g)}.bind(this),t.onFailure=function(i){t.createFailureCallback&&t.createFailureCallback();var n={level:"error",subtitle:i.internalError&&500===i.statusCode?i.internalError:i.error?i.error:a.error_while_creating_qualification,sticky:!1,allowUnsafeHTML:!1};window.notifs.addNotif(n),e.unmask(widget.body)}.bind(this),e.mask(widget.body,a.creating_qualification),this.model.create(t)},l.prototype.processFormValues=function(e){var t={Target_ID:e.targetId,Context_ID:e.contextId,PreReq_ID:e.prereqId,"attribute_SRCQUALIFICATION.Preferred":e.preferred,"attribute_SRCQUALIFICATION.Comments":e.qualificationComments,ValidationLevel:e.validationLevel,Title:e.title};return{type:e.type||"type_SRCUsageQualification",dataelements:t}},l.prototype.wrapData=function(e,t){return{csrf:{name:"ENO_CSRF_TOKEN",value:e},data:[t]}},l}),define("DS/ENOXGenericQualification/ENOXGenericQualification",["DS/UIKIT/Mask","DS/ENOXSourcingUXInfra/service/ENOXSourcingPlatformServices","DS/ENOXSourcingUXInfra/Mediator","DS/ENOXSourcingUXInfra/ENOXSourcingLogger","DS/ENOXGenericQualification/components/Triptych/TriptychWrapper","DS/ENOXGenericQualification/components/ApplicationTopBar/ApplicationTopBarWrapper","DS/ENOXSourcingUXInfra/xSourcingRouter/xSourcingRouter","DS/ENOXGenericQualification/config/routerConfig","DS/ENOXSourcingUXInfra/components/WelcomePanel/WelcomePanelWrapper","DS/Notifications/NotificationsManagerUXMessages","DS/Notifications/NotificationsManagerViewOnScreen","DS/Handlebars/Handlebars","DS/ENOXSourcingUXInfra/ENOXSourcingExtensionManager","DS/ENOXGenericQualification/config/appConfigurator","WebappsUtils/WebappsUtils","DS/ENOXSourcingUXInfra/NotificationsUtil/NotificationsUtil","text!DS/ENOXGenericQualification/ENOXGenericQualification_template.html","i18n!DS/ENOXGenericQualification/assets/nls/ENOXGenericQualification","i18n!DS/ENOXSourcingUXInfra/assets/nls/ENOXSourcingUXInfra","DS/ENOXSourcingUXInfra/Constants/ENOXSourcingConstants","DS/ENOXSourcingUXInfra/TNProxyImpl/SourcingTNProxy","DS/ENOXSourcingUXInfra/UpdateWidgetTitle/UpdateWidgetTitle","DS/ENOXSourcingUXInfra/controllers/xSourcingBootstrapController","DS/ENOXSourcingUXInfra/Utilities/Utility","DS/ENOXGenericQualification/controllers/QualificationController","DS/ENOXSourcingUXInfra/Utilities/Menu","DS/ENOXSourcingUXInfra/JSCacheBust/JSCacheBust","DS/ENOXSourcingUXInfra/DragAndDrop/ENOXSourcingDataDragAndDrop","css!DS/ENOXGenericQualification/ENOXGenericQualification.css"],function(e,t,i,n,a,o,r,l,s,d,c,u,p,g,f,h,m,w,b,I,y,v,C,_,E,x,S,V){"use strict";const D=l;var T={onLoad:function(e){S.onLoad(e,T.loadApp.bind(T))},loadApp:function(){widget.body.empty(),widget.setIcon(f.getWebappsAssetUrl("ENOXGenericQualification","icons/ENOVIA_WIDGET_Favicon.png"));var e=T;widget.app=e,e.configurator=g,e.widget=widget,e._utility=new _,e._utility.initializeGlobalMethods(),e._mediator=new i,e._applicationChannel=e._mediator.getApplicationBroker(),e.taggerProxy=new y,e.i18NProvider=Object.freeze(w),e.genericI18nProvider=Object.freeze(b),e.logname="ENOXGenericQualification",e.logger=new n(e),e.bootstrapcontroller=new C(e),e.setPreferences(),e.addWidgetEvents(),e._initTriptychAndToolbar(),e._initWelcomePanel(),e.mandatoryStartupPromises=[],e.updateWidgetObject=new v,e.extManager=new p(e,"DS/ENOXSourcingUXInfra/extensions/"),e.use("ENOXSourcingControllerProvider"),e.use("ENOXSourcingRouteControllerProvider"),widget.notificationUtil=h,UWA.Promise.all([e.extManager.init()]).then(function(){UWA.Promise.all(e.mandatoryStartupPromises).then(function(){e._initPlatformServices()})}),this.notifs=d,window.notifs=this.notifs,c.setNotificationManager(this.notifs)},onRefresh:function(){var e=T.router.getState().name,t=T.router.getState().params;t.isRefresh=!0,x.hide(),T.router.navigate(e,t,{reload:!0})},endEdit:function(){T.logger.setLevel(widget.getValue("debug")?n.LEVEL.DEBUG:n.LEVEL.ERROR),this.app.onExtensionToggle(widget.getValue("progressViewTileTopAttribute"),w.topPatternLabel,"topPattern"),this.app.onExtensionToggle(widget.getValue("progressViewTileBottomAttribute"),w.bottomPatternLabel,"bottomPattern")},onResize:function(){var e=T.router?T.router.getRouter().getState().name:"";let t=T.router._routes.filter(e=>"detailsViewRouteController"===e.routeController).map(e=>e.name);widget.body.offsetWidth>550&&!t.includes(e)?T._applicationChannel.publish({event:"welcome-panel-expand"}):T._applicationChannel.publish({event:"triptych-hide-panel",data:"left"})},_initTriptychAndToolbar:function(){this._applicationContainer=UWA.createElement("div"),this._applicationContainer.classList.add("xCS-application"),widget.body.setContent(this._applicationContainer),this._triptychWrapper=new a,this._pageToolBarComponent=new o;var e=UWA.createElement("div");return e.innerHTML=u.compile(m)(),e=e.firstChild,this._applicationContainer.appendChild(e),this._mainPanelApplicationContent=e.querySelector(".xCS-content"),this._triptychWrapper.init(this._applicationChannel,this._mainPanelApplicationContent),this._pageToolBarComponent.init(this._applicationChannel,r),this._middleContainer=document.createElement("div"),this._middleContainer.appendChild(this._triptychWrapper.getMainPanelContainer()),this._applicationChannel.publish({event:"triptych-set-content",data:{side:"middle",content:this._middleContainer}}),this},setPreferences:function(){return this.checkforExtensionAttribute("topPattern","progressViewTileTopAttribute"),this.checkforExtensionAttribute("bottomPattern","progressViewTileBottomAttribute"),widget.setPreferences(T.configurator.widgetPreferences)},checkforExtensionAttribute:function(e,i){let n=T.configurator.widgetPreferences.findIndex(t=>t.name===e);if(T.configurator.widgetPreferences[n].type="extension"===widget.getValue(i)?"text":"hidden",t.getPlatformId()!==I.ONPREMISE){let e=T.configurator.widgetPreferences.findIndex(e=>e.name===i),t=T.configurator.widgetPreferences[e].options.findIndex(e=>"extension"===e.value);-1!==t&&T.configurator.widgetPreferences[e].options.splice(t,1)}},addWidgetEvents:function(){widget.addEvent("topAttributeChange",this.onAttributeChange.bind(this)),widget.addEvent("bottomAttributeChange",this.onAttributeChange.bind(this))},onAttributeChange:function(e,t){"progressViewTileTopAttribute"===e&&this.onExtensionToggle(t,w.topPatternLabel,"topPattern"),"progressViewTileBottomAttribute"===e&&this.onExtensionToggle(t,w.bottomPatternLabel,"bottomPattern"),widget.dispatchEvent("onEdit")},onExtensionToggle:function(e,t,i){"extension"===e?widget.addPreference({name:i,type:"text",label:t,defaultValue:""}):widget.addPreference({name:i,type:"hidden",label:t,defaultValue:""})},reactivateWP:function(){widget.setRefreshViewParams("xpflLastVisitedRoute",JSON.stringify({name:"home.QualificationContextsView"})),T.router.navigate("home.QualificationContextsView"),this._applicationChannel.publish({event:"welcome-panel-expand"})},deactivateWP:function(){},_initRouter:function(){var e=this;r.addRouteMethods("home",{}),widget.setRefreshViewParams("xpflLastVisitedRoute",JSON.stringify({route:widget.getValue("defaultRoute")}));var t=JSON.parse(widget.getValue("xpflLastVisitedRoute"));return null!=t&&t.name||(t={},widget.setRefreshViewParams("xpflLastVisitedRoute",JSON.stringify({name:widget.getValue("defaultRoute")})),t.route=widget.getValue("defaultRoute")),r.setDependency("app",this),r.start(function(){var i=decodeURIComponent(top.location.href).split("X3DContentId=");if(i&&2===i.length){i[1].includes("/fullscreen")&&(i[1]=i[1].split("/fullscreen")[0]);var n=JSON.parse(i[1]);e.dataControllers.qualificationContextsController.decideRouteUsingURL(n)}else r.navigate(t.route,{id:t.objectId?t.objectId:"",name:t.viewName?t.viewName:""})}),r},_initWelcomePanel:function(){this._welcomePanelComponent=new s,this._triptychWrapper.getLeftPanelContainer().innerHTML="";let e=T.configurator.welcomePanelActivities,t=this;e[0].actions.find(e=>"newQualification"===e.id).callback=function(){t.dataControllers.qualificationController.newQualification({applicationChannel:t._applicationChannel,fromGlobal:!0},{localChannel:t._mediator.createNewChannel()})};var i={title:I.QUALIFICATION_MANAGEMENT,description:w.welcome_message,activities:e,eventBroker:this._applicationChannel,container:this._triptychWrapper.getLeftPanelContainer(),router:r,userAssistnceLink:"ENXQusUserMap/enxqus-c-ov.htm",trainingLink:"ENXQusUserMap/enxqus-c-ov.htm",app:T};this._welcomePanelComponent.init(i)},onSearch:function(){},use:function(e){return T.extManager.add({ref:e,context:T}),T},_initPlatformServices:function(){var e=this;t.getPlatformServices(e).then(async function(t){e.platformServices=t,e.updateWidgetObject.init(e),e._applicationChannel.publish({event:"platform-service-ready",data:T}),r.initialize(D),e.router=r,e.bootstrapcontroller.initialize(),e.reorderPreferences(),await e._setAllowedTargetAndContextTypes(e)&&e._initRouter()},function(){e.logger.warn("Skipping Security Context and CSRF Token retrieval")})},reorderPreferences:function(){let e=widget.getPreferences(),t=e.findIndex(e=>"SC"===e.name);-1!==t&&(e.splice(0,0,e.splice(t,1)[0]),widget.setPreferences(e))},_initDroppable:function(e){let t=this;T.dropStrategy="OPEN",T.onDropCallback=function(e){let i=t.dataControllers.qualificationContextsController.helper;if(e&&e.objectType){let n=T.router.getState().name,a={};n===I.QUALIFICATION_CONTEXT_DETAILS_VIEW&&widget.getValue(I.QUALIFICATION_CONTEXT_ALLOWED_TYPES).includes(e.objectType)||n===I.QUALIFICATION_TARGET_DETAILS_VIEW&&widget.getValue(I.QUALIFICATION_TARGET_ALLOWED_TYPES).includes(e.objectType)?i.processContextData(e.objectId).then(function(t){(t["ds6w:what/ds6w:kind_value"]||t["ds6w:what/ds6w:kind"])!==I.MEI_EXTENSION?(a.id=e.objectId,T.router.navigate(n,a,{reload:!0})):widget.notificationUtil.showError(w.invalid_object_dropped)}):t.dataControllers.qualificationContextsController.gettypeshierarchy([e.objectType]).then(function(t){let o=t.types_hierarchies[0].hierarchy,r="",l="";o.forEach(function(e){widget.getValue(I.QUALIFICATION_CONTEXT_ALLOWED_TYPES).includes(e)&&(r=e),widget.getValue(I.QUALIFICATION_TARGET_ALLOWED_TYPES).includes(e)&&(l=e)}),n===I.QUALIFICATION_CONTEXT_DETAILS_VIEW&&""!==r||n===I.QUALIFICATION_TARGET_DETAILS_VIEW&&""!==l?i.processContextData(e.objectId).then(function(t){(t["ds6w:what/ds6w:kind_value"]||t["ds6w:what/ds6w:kind"])!==I.MEI_EXTENSION?(a.id=e.objectId,T.router.navigate(n,a,{reload:!0})):widget.notificationUtil.showError(w.invalid_object_dropped)}):widget.notificationUtil.showError(w.invalid_object_dropped)}).catch(function(){widget.notificationUtil.showError(w.internal_server_error)})}},T.dropArea=e||T._triptychWrapper.getMainPanelContainer(),(new V).makeAreaDroppable(T)},_setAllowedTargetAndContextTypes:async function(){var t=new E({app:T});let i=await t.model.getAllowedTargetAndContextTypes({});try{if(!i||!i.data[0])throw widget.notificationUtil.showError(w.getting_AllowedTypes_Failed),new Error("Error");return i.data[0].Qualification_Context_Allowed_Types?widget.setValue(I.QUALIFICATION_CONTEXT_ALLOWED_TYPES,i.data[0].Qualification_Context_Allowed_Types):widget.notificationUtil.showError(w.getting_AllowedTypes_Failed),i.data[0].Qualification_Target_Allowed_Types?widget.setValue(I.QUALIFICATION_TARGET_ALLOWED_TYPES,i.data[0].Qualification_Target_Allowed_Types):widget.notificationUtil.showError(w.getting_AllowedTypes_Failed),!0}catch(t){return widget.notificationUtil.showError(t.internalError?t.internalError:w.getting_AllowedTypes_Failed),e.unmask(widget.body),!0}}};return T});