define("DS/DELWebUXControls/DELProgressBar",["UWA/Core","DS/ControlsEx/LoadingPanel","DS/Logger/Logger","css!DS/DELWebUXControls/assets/css/DELProgressBar.css"],function(e,t,s){"use strict";return t.inherit({name:"DELProgressBar",logger:s.getLogger("DS/DELWebUXControls/DELProgressBar"),publishedProperties:{stepValue:{defaultValue:1,type:"number"},steps:{defaultValue:null,type:"array"},simulateProgressInStep:{defaultValue:!1,type:"boolean"},fullBarForEachStep:{defaultValue:!1,type:"boolean"}},_computeProgressBarValue:function(e,t){let s=0,i=t-1;for(let t=0;t<i;++t)s+=e[t].weight;return s},_applyProperties:function(e){this._parent(e),this.isDirty("stepValue")&&this._applyStepValue()},buildView:function(){let t=e.is(this.steps,"array")?this.steps:[],s=this.stepValue?this.stepValue:this.publishedProperties.stepValue.defaultValue;if(!this.fullBarForEachStep&&e.is(t,"array")&&t.length>0){if(100!==t.reduce(function(e,t){return e+t.weight},0))throw new Error("Steps weight must be equal to 100")}this._parent(),this.elements._label.addClassName("del-controls-progress-bar-label"),this.value=this.fullBarForEachStep?0:this._computeProgressBarValue(t,s)},_applyStepValue:function(){let t=e.is(this.steps,"array")?this.steps:[],s=this.stepValue,i=t.length;t.length>0&&(s>i||s<=0?this.logger.error(`StepValue must be in the range [1-${i}]`):(this.info=`${s} / ${i} | ${t[s-1].text}`,this._updateBarProgress(t,s,this.simulateProgressInStep,this.fullBarForEachStep)))},_updateBarProgress:function(e,t,s,i){(async function(){const n=i?0:this._computeProgressBarValue(e,t);if(this.value=n,s){const s=300,r=e[t-1];let o=81;if(r){let e=r.estimatedTime;!isNaN(e)&&e>=0&&(o=e/s)}let a=1-Math.pow(.1,1/o),l=0,h=0;const d=(i?100:r.weight)-1,g=function(e){return new Promise(function(t){this._barRefreshTimeout=setTimeout(t,e)}.bind(this))}.bind(this);for(await g(s);h<o&&!this._skipCurrentStep;++h)l+=(1-l)*a,this.value=n+l*d,await g(s);for(;!this._skipCurrentStep;++h)l+=(1-l)*(a=1-1/(1+a)),this.value=n+l*d,await g(s)}}).call(this)}})}),define("DS/DELWebUXControls/DELGeneratedToolbar",["UWA/Core","DS/Tweakers/GeneratedToolbar","DS/Core/PointerEvents","DS/WebappsUtils/WebappsUtils","css!DS/DELWebUXControls/assets/css/DELGeneratedToolbar.css"],function(e,t,s,i){"use strict";let n=0,r=0,o=0,a=0,l=!1,h=function(e){let t=e&&e.getFreeZone();return t&&t.getBoundingClientRect()},d=function(e){let t,s,i=this,d=i.elements&&i.elements.container,g=!1,c=h(i.immersiveFrame);if(d&&(e.preventDefault(),e.stopPropagation(),t=e.changedTouches?e.changedTouches[0].clientX:l?e.clientX:null,s=e.changedTouches?e.changedTouches[0].clientY:l?e.clientY:null,t&&s)){if(o=Math.min(Math.max(t-n,-1),window.innerWidth-d.offsetWidth),a=Math.min(Math.max(s-r,-1),window.innerHeight-d.offsetHeight),t=o<0?0:o,s=a<0?0:a,c)!function(){let e=c.left,i=c.top,n=d.getBoundingClientRect();t<=c.x&&s<=c.y?(t=c.x,s=c.y):t+n.width>=c.right&&s<=c.y?(t=c.right-n.width,s=c.y):t<=c.left&&s+n.height>=c.bottom?(t=c.x,s=c.bottom-n.height):t+n.width>=c.right&&s+n.height>=c.bottom?(t=c.right-n.width,s=c.bottom-n.height):t<=e?(t=e,g=!0):t+n.width>=c.right?(t=c.right-n.width,g=!0):s<=i?s=i:s+n.height>=c.bottom&&(s=c.bottom-n.height)}();else{let e=window.innerWidth-d.getDimensions().width;0!==t&&t!==e||(g=!0)}i.direction=g?"vertical":"horizontal",d.setStyles({left:t+"px",top:s+"px"})}},g=function(e){e.preventDefault(),e.stopPropagation();let t=this,i=t.elements&&t.elements.dragContainer;!function(e){let t=e,s=t.elements&&t.elements.container,i=h(t.immersiveFrame),n=s.getBoundingClientRect();s&&i&&(o<i.left?(s.classList.add("left"),s.classList.remove("right","top","bottom")):o+n.width>i.right?(s.classList.add("right"),s.classList.remove("left","top","bottom")):a<i.top?(s.classList.add("top"),s.classList.remove("right","left","bottom")):a+n.height>i.bottom?(s.classList.add("bottom"),s.classList.remove("right","top","left")):s.classList.remove("right","top","left","bottom"))}(t),t._dragEvents&&(Object.entries(t._dragEvents).forEach(e=>i.removeEventListener(s[e[0]],e[1])),Object.entries(t._dragEvents).forEach(e=>document.removeEventListener(s[e[0]],e[1]))),l=!1};return t.inherit({name:"DELGeneratedToolbar",publishedProperties:{immersiveFrame:{defaultValue:null,type:"object",category:"Behavior"}},buildView:function(){this._parent(),this.elements.container.addClassName("del-controls-toolbar-maincontainer"),this.elements.dragContainer=new e.Element("div",{class:"del-controls-toolbar-dragContainer"}).inject(this.elements.container,"top"),this.elements.dragImage=new e.Element("img",{class:"del-controls-toolbar-dragimage",src:i.getWebappsAssetUrl("DELWebUXControls","icons/I_ToolbarDrag.png")}).inject(this.elements.dragContainer),this.elements.dragImageRotated=new e.Element("img",{class:"del-controls-toolbar-dragimage-rotated",src:i.getWebappsAssetUrl("DELWebUXControls","icons/I_ToolbarDragRotated.png")}).inject(this.elements.dragContainer)},handleEvents:function(){this._parent(),this.elements.dragContainer&&(this._dragEvents={POINTERMOVE:d.bind(this),POINTERUP:g.bind(this)},this._dragStart=function(e){e.stopPropagation();let t=this,i=t.elements&&t.elements.container,h=t.elements&&t.elements.dragContainer;h&&i&&(Object.entries(t._dragEvents).forEach(e=>h.addEventListener(s[e[0]],e[1])),Object.entries(t._dragEvents).forEach(e=>document.addEventListener(s[e[0]],e[1])),o=i.offsetLeft,a=i.offsetTop,e.changedTouches?(n=e.changedTouches[0].clientX-o,r=e.changedTouches[0].clientY-a):e.pageX&&e.pageY&&(n=e.clientX-o,r=e.clientY-a,l=!0))}.bind(this),this.elements.dragContainer.addEventListener(s.POINTERDOWN,this._dragStart)),this.immersiveFrame&&(this.freeZoneResize=function(){let e=this.elements&&this.elements.container,t=h(this.immersiveFrame),s=e.getBoundingClientRect();e&&!e.isHidden()&&(s.bottom>t.bottom&&(e.style.top=`${t.bottom-s.height}px`),s.right>t.right&&(e.style.left=`${t.right-s.width}px`),s.top<t.top&&(e.style.top=`${t.top}px`),s.left<t.x&&(e.style.left=`${t.x}px`),e.classList.contains("right")?e.style.left=`${t.right-s.width}px`:e.classList.contains("left")?e.style.left=`${t.x}px`:e.classList.contains("top")?e.style.top=`${t.top}px`:e.classList.contains("bottom")&&(e.style.top=`${t.bottom-s.height}px`))}.bind(this),this.immersiveFrame.addEventListener("freeZoneResize",this.freeZoneResize))},_applyDirection:function(){this._parent(),this.elements.dragImageRotated&&this.elements.dragImage&&("vertical"===this.direction?(this.elements.container.addClassName("del-toolbar-vertical"),this.elements.dragImageRotated.show(),this.elements.dragImage.hide()):(this.elements.container.removeClassName("del-toolbar-vertical"),this.elements.dragImageRotated.hide(),this.elements.dragImage.show()))},destroy:function(){this.elements.dragContainer&&this.elements.dragContainer.removeEventListener(s.POINTERDOWN,this._dragStart),this.immersiveFrame&&this.immersiveFrame.removeEventListener("freeZoneResize",this.freeZoneResize),this.elements.dragContainer.destroy(),this._parent()}})});