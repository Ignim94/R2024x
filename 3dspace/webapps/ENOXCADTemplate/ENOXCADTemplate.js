var integrationNLs;define("DS/ENOXCADTemplate/Controllers/ENOXCADTemplateContext",["UWA/Class","DS/ENOXCADUtils/XCADNotification"],function(e,t){"use strict";return e.singleton({_selectedItems:[],getContext:function(){return this},init:function(e){this._parent(e)},getSecurityContext:function(){return{SecurityContext:widget.getPreference("Template_security_ctx").value}},displayNotification:function(e){"error"==e.eventID?t.errorMsg(e.msg):"warning"==e.eventID?t.warningMsg(e.msg):t.sucessMsg(e.msg)},addSelection:function(e){e.object="",this._selectedItems.splice(0),this._selectedItems.push(e)},getSelectedNodes:function(){return this._selectedItems}})}),define("DS/ENOXCADTemplate/Controllers/ENOXCADTemplateDataConverter",["UWA/Class/Options","UWA/Class"],function(e,t){return t.singleton(e,{init:function(){},transformXMLToJson:function(e){var t,a=(new DOMParser).parseFromString(e,"text/xml"),n=this.xmlToJson(a),i=n.response.info.cadobjectlist.cadobject;return console.log(n),null!=i&&(t=this.buildCadObjectJson(i)),t},xmlToJson:function(e){var t={};if(1==e.nodeType){if(e.attributes.length>0)for(var a=0;a<e.attributes.length;a++){var n=e.attributes.item(a);t[n.nodeName]=n.nodeValue}}else 3==e.nodeType?t=e.nodeValue:4==e.nodeType&&(t=e.nodeValue);var i=[].slice.call(e.childNodes).filter(function(e){return 3===e.nodeType});if(e.hasChildNodes()&&e.childNodes.length===i.length)t=[].slice.call(e.childNodes).reduce(function(e,t){return e+t.nodeValue},"");else if(e.hasChildNodes())for(var l=0;l<e.childNodes.length;l++){var o=e.childNodes.item(l),s=o.nodeName;if(void 0===t[s])t[s]=this.xmlToJson(o);else{if(void 0===t[s].push){var r=t[s];t[s]=[],t[s].push(r)}t[s].push(this.xmlToJson(o))}}return t},buildCadObjectJson:function(e){var t={};if(t.structure=new Array,null==e.length){var a=this.addTemplateAttributes(e);t.structure.push(a)}else for(var n=0;n<e.length;n++){a=this.addTemplateAttributes(e[n]);t.structure.push(a)}return t.structure},addTemplateAttributes:function(e){if(null==e)throw Error("Unable to find cad object in xml file");var t=null;if(null!=e.revisioninfolist)for(var a=0;a<e.revisioninfolist.revisioninfo.length;a++)if("Next"!=e.revisioninfolist.revisioninfo[a].revision){t=e.revisioninfolist.revisioninfo[a].overwriteaccess;break}var n={};n={cadid:e.cadid,phid:e.oid,maincadtype:e.targetcadtype,templatecadtype:e.cadtype,type3dx:e.nonmappedattributes.persistencytype["#cdata-section"],cadinfo:e.nonmappedattributes.cadinfo["#cdata-section"],overwriteaccess:t,uuid:e.uuid,cestamp:e.ceStamp};var i=null;i=null==e.Title?e.title:e.Title["#cdata-section"],n.title=i;var l=null;l=null==e.Name?e.name:e.Name["#cdata-section"],n.name=l;var o=null;o=null==e.State?e.state:e.State["#cdata-section"],n.maturity=o;var s=null;return s=null==e.Description?e.description:e.Description["#cdata-section"],n.desc=s,null==n.templatecadtype&&(n.templatecadtype=e.type),n}})}),define("DS/ENOXCADTemplate/Models/ENOXCADTemplateInitDataModel",["UWA/Class/Options","UWA/Class"],function(e,t){return t.singleton(e,{_customColumnJson:null,_templatesTypeWithoutFile:[],_customAttributesJson:null,_notRequiredColumns:[],_notRequiredFields:[],_manageTemplates:!1,_mapOfFormFields:null,_createAsInWork:!1,init:function(){},initUIJsonFields:function(e){null!=e&&(null!=e.notrequiredfields&&(this._notRequiredFields=e.notrequiredfields),null!=e.notrequiredcolumns&&(this._notRequiredColumns=e.notrequiredcolumns),null!=e.managetemplates&&(this._manageTemplates=e.managetemplates),void 0!==e.createAsInWork&&(this._createAsInWork=e.createAsInWork))},setCustomColumnLJson:function(e){},getCustomColumnJson:function(){return this._customAttributesJson},setCustomFormFields:function(e,t){null==this._mapOfFormFields&&(this._mapOfFormFields=new Map),null!=t&&t.length>0&&this._mapOfFormFields.set(e,t)}})}),define("DS/ENOXCADTemplate/cmd/ENOXCADManageTemplateCmd",["UWA/Core","DS/ApplicationFrame/Command","DS/PlatformAPI/PlatformAPI"],function(e,t,a){"use strict";return t.extend({init:function(e){this._parent(e)},execute:function(e){a.publish("webinwin:web:notification",JSON.stringify({operation:"managetemplates",version:"1.0"}))}})}),define("DS/ENOXCADTemplate/Models/TemplateModel",["UWA/Class/Model"],function(e){"use strict";return e.extend({getID:function(){return this.get("phid")},getLabel:function(){return this.get("name")},getType:function(){return"XCADTemplate"},getDisplayName:function(){return this.get("title")}})}),define("DS/ENOXCADTemplate/Models/ENOXCADTemplateDataModel",["DS/ENOXCADTemplate/Controllers/ENOXCADTemplateDataConverter","text!DS/ENOXCADTemplate/assets/TemplateCadTypeClass.json","i18n!DS/ENOXCADTemplate/assets/nls/TemplateDialogCreation"],function(e,t,a){var n={_listOf3DxTypes:null,_listOfTemplateData:null,_templateGridView:null,_parentContainer:null,_listOftemplateCadType:null,_gcoJsonData:null,_currentSelectedTabName:null,_newFromTemplateView:null,_isTypeselectionField:null,init:function(e){this._listOfTemplateData=new Map},setTemplateGridViewForUpdate:function(e){this._templateGridView=e},setGcoCadAttributes:function(e){var t=this;t._gcoJsonData=JSON.parse(e),t._listOf3DxTypes=new Map,t._listOftemplateCadType=new Map,n.setCad3DxTypes(t._gcoJsonData.data),n.settemplateCadType(t._gcoJsonData.data)},setCad3DxTypes:function(e){for(var t=0;t<e.length;t++){for(var a=[],n=0;n<e[t].enoviatype.length;n++)a[n]=e[t].enoviatype[n];this._listOf3DxTypes.set(e[t].cadtype,a)}},getCad3DxTypes:function(e){return this._listOf3DxTypes.get(e)},settemplateCadType:function(e){for(var t=0;t<e.length;t++)this._listOftemplateCadType.set(e[t].cadtype,e[t].templatecadtype)},getTypeClassFromCadType:function(e){for(var a=JSON.parse(t),n=null,i=0;i<this._gcoJsonData.data.length;i++)if(this._gcoJsonData.data[i].cadtype==e){for(var l=0;l<a.classtypes.length;l++)if(this._gcoJsonData.data[i].typeclass.indexOf(a.classtypes[l])>=0){n=a.classtypes[l];break}break}return n},getGcoMappingFromCadType:function(e){JSON.parse(t);for(var a=0;a<this._gcoJsonData.data.length;a++)if(this._gcoJsonData.data[a].cadtype==e)return this._gcoJsonData.data[a];return null},getCadTypes:function(){for(var e=[],t=0;t<this._gcoJsonData.data.length;t++)e.push(this._gcoJsonData.data[t].cadtype);return e},setTemplateData:function(e){var t=this;null==t._listOfTemplateData&&(t._listOfTemplateData=new Map),t._listOfTemplateData.set(e.maincadtype,e.templatelist),document.getElementsByClassName("DIV_newfromtemplate").length>0?t.update3dxtypeindropdown(e.maincadtype,null,!0):t._templateGridView.updateTreeDocument(e.templatelist)},setTypeselectionField:function(e){this._isTypeselectionField=e},update3dxtypeindropdown:function(e,t,a){var n=this;if(n._isTypeselectionField){var i=n.EnoviatypesNLSValues(e);n.sortEnoviaTypesBasedOnLabel(i),n._newFromTemplateView.cadsubTypeDropDown.elementsList=i;var l=0;i.forEach((e,t)=>{"notSpecified"!==e.value||(l=t)}),n._newFromTemplateView.cadsubTypeDropDown.selectedIndex=l,t=i[l].value}n.updateTemplateInDropdown(e,t,a)},updateTemplateInDropdown:function(e,t,a){t&&(t="notSpecified"===t?"":t),this.filteredTemplateData(e,t,a)},getTemplateData:function(){return this._listOfTemplateData},gettypeselectionfield:function(){return this._isTypeselectionField},sortEnoviaTypesBasedOnLabel:function(e){e.sort((e,t)=>e.label.toLowerCase()<t.label.toLowerCase()?-1:e.label.toLowerCase()>t.label.toLowerCase()?1:0)},getEnoviaType:function(e){var t=null;return"assembly"===e?t="VPMReference":"component"===e?t="VPMReference":"drawing"===e&&(t="Drawing"),t},filteredTemplateData:function(e,t,a){for(var n=this,i=[],l=n._listOfTemplateData.get(e),o=0;l.length>o;o++)"OBSOLETE"!=l[o].maturity&&(!n._isTypeselectionField||n._isTypeselectionField&&l[o].type3dx===t)&&i.push({labelItem:l[o].title,valueItem:l[o].phid});i.sort((e,t)=>e.labelItem.toLowerCase()<t.labelItem.toLowerCase()?-1:e.labelItem.toLowerCase()>t.labelItem.toLowerCase()?1:0),n._newFromTemplateView.templateDropDown.elementsList=i,n._newFromTemplateView.templateDropDown.selectedIndex=0,a&&n._newFromTemplateView.createConnectorFields()},EnoviatypesNLSValues:function(e){var t=this;t.enoviaTypes=t.getCad3DxTypes(e);var n=[];return n.push({value:"notSpecified",label:a.notSpecified,selected:!0}),t.enoviaTypes.forEach(function(e){n.push({value:e,label:t._gcoJsonData.nlsvalues[e]})}),n},addOREditTemplateData:function(e){var t=this;null==t._listOfTemplateData&&(t._listOfTemplateData=new Map);var a=t._listOfTemplateData.get(e.maincadtype),n=e.action;if("add"==n)void 0===a&&(a=[],t._listOfTemplateData.set(e.maincadtype,a)),a.push(e.template),t._templateGridView.addDataToTreeDocument(e.template);else if("edit"==n)for(var i=0;a.length>i;i++)if(a[i].phid===e.template.phid){a[i]=e.template,t._templateGridView.editTreeDocument(a[i]);break}},deleteTemplateData:function(e,t){for(var a=this._listOfTemplateData.get(e),n=0;a.length>n;n++)if(a[n].phid===t){a.splice(n,1),this._templateGridView.deleteNodeModel(t);break}},checkAndUpdateTemplateData:function(e,t,a,n){var i=this,l=!1;if(i._listOfTemplateData&&i._listOfTemplateData.has(e))if(l=!0,1==t)null!=a?i.updateTemplateInDropdown(e,a,n):i.update3dxtypeindropdown(e,null,n);else{var o=i._listOfTemplateData.get(e);i._templateGridView.updateTreeDocument(o)}return l},setParentContainer:function(e){this._parentContainer=e},getContainer:function(){return this._parentContainer},setSelectedCadType:function(e){this._currentSelectedTabName=e},setXMLData:function(t,a){if("xml"!=t.mode||null==a)throw Error("ERROR: Template data is not in xml format");var i=null;i=e.transformXMLToJson(t.xmldata),"listtemplate"==a?(null==i&&(i=[]),t.templatelist=i,this.setTemplateData(t)):"addoredittemplate"==a&&(t.template=i[0],null==t.template.maincadtype&&(t.template.maincadtype=t.maincadtype),n.addOREditTemplateData(t))}};return n}),define("DS/ENOXCADTemplate/Views/ENOXCADTemplateDlg",["UWA/Class/View","DS/UIKIT/Form","DS/UIKIT/SuperModal","DS/UIKIT/Input/File","DS/UIKIT/Input/Button","DS/UIKIT/Alert","DS/ENOXCADUtils/utils/XCADModelEvents","DS/ENOXCADTemplate/Models/ENOXCADTemplateDataModel","DS/Controls/TooltipModel","DS/ENOXCADTemplate/Models/ENOXCADTemplateInitDataModel","DS/ENOXCADUtils/XCADNotification","i18n!DS/ENOXCADTemplate/assets/nls/TemplateDialogCreation","css!DS/ENOXCADTemplate/assets/css/ENOXCADTemplateDlg"],function(e,t,a,n,i,l,o,s,r,d,p,c){"use strict";return{createTemplateDlgView:e.extend({_options:null,className:"template-dialog-creation",setup:function(e){this._options=e},render:function(){var e=this,a=UWA.createElement("div"),n=e.getMandFormFields();if(e.formContent=new t({className:"vertical",fields:n}),1==e._options.forEdit&&e.formContent.setValues(e._options.values),e.formContent.inject(a),null==e._options.forswconnector&&0==d._notRequiredFields.includes("fileselect"))e.createFileDiv().inject(a);else if(1==e._options.forswconnector){null!=e._options.values.title&&e.formContent.setValues({title:e._options.values.title});var i=e.formContent.getField("filename");i&&(i.tooltipInfos=new r({shortHelp:e._options.filepath}))}return a},createFileDiv:function(){var e=this,t=UWA.createElement("fileselect");e.fileLabelDiv=UWA.createElement("div");var a=UWA.createElement("label",{class:"label-only",text:c.file,styles:{color:"black"}});null==e._options.forEdit&&UWA.createElement("span",{class:"label-field-required",text:" *",styles:{color:"red"}}).inject(a),a.inject(this.fileLabelDiv);var n=new UWA.createElement("div",{class:"div-Browsefile",id:"fileBrowseDiv",styles:{display:"flex",width:"550px",marginBottom:"10px",marginUp:"0px"}});e.text_input=UWA.createElement("input",{class:"form-control form-control-root",styles:{"margin-left":"1px",width:"calc(100% - 115px)",position:"absolute",left:"98px"}}),e.text_input.id="FileText",e.text_input.type="text",e.text_input.file="",e.text_input.setAttribute("placeholder",c.fileplaceholder),e.text_input.disabled=!0;var l=new i({id:"browse",value:c.browse,events:{onClick:function(){var t={operation:"templatefilepath",version:"1.0",data:{maincadtype:e._options.maincadType}};o.publish({event:"ENOXCADTemplate_publish",data:t})}}});return l.getContent().setStyle("min-width","80px"),l.inject(n),e.text_input.inject(n),this.fileLabelDiv.inject(t),n.inject(t),t},ResetFormContent:function(){this.formContent.setValues(this._options.values)},getMandFormFields:function(){var e=this;e.enoviaTypes=s.getCad3DxTypes(e._options.maincadType);var t=s.EnoviatypesNLSValues(e._options.maincadType);s.sortEnoviaTypesBasedOnLabel(t);var a="1";1==e._options.forswconnector&&(a="3");var n=[];0==d._notRequiredFields.includes("title")&&n.push({type:"text",label:c.title,placeholder:c.titleplaceholder,name:"title",errorText:c.titleerrortext,required:"true"}),0==d._notRequiredFields.includes("description")&&n.push({type:"text",label:c.description,placeholder:c.descplaceholder,name:"description",rows:a,multiline:"true"});var i=!1;return 1==e._options.forEdit&&(i=!0,e._options.values.typeselection&&(t=t.filter(t=>t.value==e._options.values.typeselection))),1==e._options.forswconnector?!1===d._notRequiredFields.includes("filename")&&n.push({type:"text",label:c.file,placeholder:"",name:"filename",errorText:c.fileerror,disabled:"true",value:e._options.filepath.replace(/^.*[\\\/]/,"")}):0==d._notRequiredFields.includes("typeselection")&&n.push({type:"select",label:c.targetype,name:"typeselection",errorText:c.targettypeerrortext,options:t,required:"true",disabled:i}),n}}),show:function(e){var t=this;t.options=e;var n=s._currentSelectedTabName;t.options.maincadType=n;var i="mainContainer";1==t.options.forswconnector&&(i="IdDIV_container"),t.superModal=new a({renderTo:document.getElementById(i),className:t.options.classname,escapeToClose:!1,events:{onHide:function(){p.clearNotifications()}}}),t.view=new t.createTemplateDlgView(t.options);var l=1==t.options.forEdit?c.save:c.createshared,r=1==t.options.forEdit?c.reset:c.createprivate;const u=d._createAsInWork;u&&!t.options.forEdit&&(l=c.createAsInWork);var m=[{className:"primary",value:l,action:function(e){var a=t.view.formContent.getValue("title");t.view.formContent.setValue("title",a.trim()),t.view.formContent.validate()&&t.validateMandatoryField()&&(u?t.publishAddTemplateEvent("IN_WORK"):t.publishAddTemplateEvent("RELEASED"),null==t.options.forswconnector&&e.hide())}},{className:"default",value:r,action:function(e){if(1==t.options.forEdit)t.view.ResetFormContent();else{var a=t.view.formContent.getValue("title");t.view.formContent.setValue("title",a.trim()),t.view.formContent.validate()&&t.validateMandatoryField()&&(t.publishAddTemplateEvent("PRIVATE"),null==t.options.forswconnector&&e.hide())}}},{className:"default",value:c.cancel,action:function(e){if(1==t.options.forswconnector){o.publish({event:"ENOXCADTemplate_publish",data:{operation:"closetemplatedialog",version:"1.0"}})}else e.hide()}}],f=null;if(null==t.options.forswconnector)if(1==t.options.forEdit)f=c.edittemplate;else{widget.getPreference("Template_integration").value;var D=n+".label",v=widget.getPreference("Template_connectorNls").value[D];f=c.createtemplate+" - "+v}this.superModal.dialog({body:this.view.render(),title:f,buttons:m})},updateTemplateFilePath:function(e){if(this.view.text_input.value=e.replace(/^.*[\\\/]/,""),this.view.text_input.title=e,widget.getPreference("Template_odtmode")&&!0===widget.getPreference("Template_odtmode").value){o.publish({event:"ENOXCADTemplate_publish",data:{operation:"templateodtevent",version:"1.0"}})}},publishAddTemplateEvent:function(e){var t=this,a=t.view.formContent.getValues(),n={maincadtype:t.view._options.maincadType,templatecadtype:s._listOftemplateCadType.get(t.view._options.maincadType),title:a.title,desc:a.description};if(1==t.view._options.forEdit)n.action="edit",n.phid=t.view._options.values.phid,null!=t.view._options.values.uuid&&(n.uuid=t.view._options.values.uuid),null!=t.view._options.values.cestamp&&(n.cestamp=t.view._options.values.cestamp);else{if(n.action="add",d._createAsInWork)n.targetState=e;else{let t=!1;"PRIVATE"===e&&(t=!0),n.keepasprivate=t}1==t.options.forswconnector&&null!=t.view._options.values.uuid&&(n.uuid=t.view._options.values.uuid)}var i=null;1==t.options.forswconnector?(n.type3dx=t.view.enoviaTypes[0],i=t.view._options.filepath):null!=t.view.text_input&&""!=t.view.text_input.value&&(i=t.view.text_input.title),null!=i&&(n.filepath=i),null!=a.typeselection&&("notSpecified"==a.typeselection?n.type3dx="":n.type3dx=a.typeselection);var l={operation:"addoredittemplate",version:"1.0",data:n};o.publish({event:"ENOXCADTemplate_publish",data:l}),o.publish({event:"xcad-loader-on"})},showCustomErrorField:function(e,t){null!=this.alertMsg&&this.alertMsg.destroy();var a=!0;"error"==t&&(a=!1),this.alertMsg=new l({closable:!0,visible:!0,maximumVisibleMessages:1,autoHide:a,hideDelay:5e3,className:"wp-alert"}).inject(this.view.fileLabelDiv,"bottom"),this.alertMsg.add({className:t,message:e})},validateMandatoryField:function(){var e=!0;return 1==d._notRequiredFields.includes("fileselect")?e:(null==this.options.forswconnector&&""==this.view.text_input.value&&1!=this.view._options.forEdit&&(p.errorMsg(c.fileerror),e=!1),e)}}}),define("DS/ENOXCADTemplate/Controllers/ENOXCADTemplateUtility",["DS/WAFData/WAFData","DS/ENOXCADTemplate/Models/ENOXCADTemplateDataModel","DS/Logger/Logger"],function(e,t){"use strict";var a={_CSRFHeader:null,_isAuthoringMode:null,_isLRDEnabled:null,init:function(){},initGCOCadAttributes:function(a,n,i){var l=this,o=widget.getPreference("Template_security_ctx").value,s=widget.getPreference("Template_serviceurl").value,r=widget.getPreference("Template_integration").value,d=widget.getPreference("Template_tenantid").value;null!=o&&null!=s&&null!=r||i("ERROR : security context or url is missing");var p={method:"GET",headers:{Accept:"application/json","Accept-Language":widget.getPreference("Template_lang").value,SecurityContext:o},onFailure:function(e){console.log("Unable to fetch GCO data :"+e),i("ERROR : Unable to fetch GCO data")},onComplete:function(e){console.log("OnComplete "),console.log(e);var a=JSON.parse(e);l._isLRDEnabled=a.islrdenable,l._isAuthoringMode=a.isauthoring;let i=a.icons_nonPStypes;widget.setValue("icons_nonPStypes",i),t.setGcoCadAttributes(e),n(e)}},c="/resources/xcadtemplate/services/templatemapping?integration="+r+"&operation="+a+"&tenant="+d;e.authenticatedRequest(s+c,p)},downloadTemplateFile:function(t){var n=this,i=widget.getPreference("Template_security_ctx").value,l=widget.getPreference("Template_serviceurl").value,o=widget.getPreference("Template_tenantid").value;a.readCSRFHeader(l).then(s=>{var r={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",ENO_CSRF_TOKEN:n._CSRFHeader,SecurityContext:i},onFailure:function(e){console.log("download failed :"+e)},onComplete:function(e){var t=JSON.parse(e);t?a.getBlobObject(t,function(){var e=this.response,a=t.filename;if(window.navigator.msSaveOrOpenBlob){var n=this.getResponseHeader("content-type");window.navigator.msSaveOrOpenBlob(new Blob([e],{type:n}),a)}else{UWA.createElement("a",{href:window.URL.createObjectURL(e),download:a,type:"application/x-www-form-urlencoded"}).dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window}))}console.log("download docuemnt sucess...!")}):console.log("download docuemnt Failed...!")}},d="/resources/v1/modeler/dsxcad/dsxcad:Template/"+t+"/dsxcad:AuthoringFile/DownloadTicket?tenant="+o;e.authenticatedRequest(l+d,r)})},getBlobObject:function(t,a){var n=widget.getPreference("Template_security_ctx").value,i=widget.getPreference("Template_tenantid").value,l=t.ticketURL+"?__fcs__jobTicket="+encodeURIComponent(t.ticket)+"&__fcs__attachment=true&tenant="+i;(0,e.authenticatedRequest)(l,{method:"POST",responseType:"blob",headers:{SecurityContext:n,Accept:"application/x-www-form-urlencoded","Content-Type":"application/x-www-form-urlencoded"},onload:a,onFailure:function(){},onComplete:function(){}})},readCSRFHeader:function(t){var a=this;return new Promise(function(n,i){if(a._CSRFHeader&&n(),t){var l=t+"/resources/v1/application/CSRF";e.authenticatedRequest(l,{method:"GET",type:"json",onComplete:function(e){e.csrf&&(a._CSRFHeader=e.csrf.value),n()},onFailure:function(e){console.log(e),i()}})}else console.log("no service url found")})}};return a}),define("DS/ENOXCADTemplate/Controllers/ENOXCADTemplateActionsController",["DS/ENOXCADTemplate/Views/ENOXCADTemplateDlg","DS/ENOXCADTemplate/Controllers/ENOXCADTemplateUtility","DS/ENOXCADUtils/XCADNotification","DS/ENOXCADUtils/utils/XCADModelEvents","DS/ENOXCADTemplate/Models/ENOXCADTemplateDataModel","DS/LifecycleCmd/MaturityCmd","DS/LifecycleServices/LifecycleServicesSettings","DS/PlatformAPI/PlatformAPI","DS/ENOXCADTemplate/Controllers/ENOXCADTemplateContext","DS/LifecycleCmd/DeleteCmd","DS/ENOXCADTemplate/Models/TemplateModel","i18n!DS/ENOXCADTemplate/assets/nls/ENOXCADTemplateView","css!DS/UIKIT/UIKIT.css"],function(e,t,a,n,i,l,o,s,r,d,p,c){return{downloadTemplate:function(e){if(1==t._isLRDEnabled){var a={operation:"templatedownload",version:"1.0",data:{template:{cadid:e.cadid,phid:e.phid,maincadtype:e.maincadtype,templatecadtype:e.templatecadtype}}};n.publish({event:"ENOXCADTemplate_publish",data:a})}else t.downloadTemplateFile(e.phid)},editTemplate:function(t){if("true"==t.overwriteaccess){var l={};if(l.title=t.title,null!=t.desc&&(l.description=t.desc),l.typeselection=(o=i._gcoJsonData.nlsvalues,s=t.type3dx,Object.keys(o).find(e=>o[e]===s)),l.phid=t.phid,null!=t.uuid&&(l.uuid=t.uuid),null!=t.cestamp&&(l.cestamp=t.cestamp),e.show({classname:"templateSuperModal",forEdit:!0,values:l}),widget.getPreference("Template_odtmode")&&!0===widget.getPreference("Template_odtmode").value){n.publish({event:"ENOXCADTemplate_publish",data:{operation:"templateodtevent",version:"1.0"}})}}else a.errorMsg(c.msg_error_editmodifyaccess);var o,s},publishTemplate:function(e){var t=e;this.performLifecycleOperation(t,"publish")},deleteTemplate:function(e){var t=e;this.performLifecycleOperation(t,"delete")},performLifecycleOperation:function(e,t){s.subscribe("webinwin:web:notification",function(t){if(console.log(t),updatedData=JSON.parse(t),"Lifecycle"==updatedData.From)if(updatedData.Refresh.modified.length>0){for(var a=0;updatedData.Refresh.modified.length>a;a++)if(updatedData.Refresh.modified[a].physicalid===e.phid){const t=JSON.parse(JSON.stringify(e));var l={operation:"updatetemplateinfo",version:"1.0",data:{maincadtype:t.maincadtype,templatecadtype:t.templatecadtype,phid:e.phid}};n.publish({event:"ENOXCADTemplate_publish",data:l}),n.publish({event:"xcad-loader-on"});break}}else if(updatedData.Refresh.deleted.length>0)for(a=0;updatedData.Refresh.deleted.length>a;a++)if(updatedData.Refresh.deleted[a].physicalid===e.phid){i.deleteTemplateData(e.maincadtype,e.phid);break}s.unsubscribe("webinwin:web:notification")});var a=new p(e);r.addSelection(a);var c;c=[{"3DSpace":widget.getPreference("Template_serviceurl").value,platformId:widget.getPreference("Template_tenantid").value}],o.app_initialization(function(){var e=null;if("delete"==t?e=new d({context:r.getContext(),ID:"DeleteHdr"}):"publish"==t&&(e=new l({context:r.getContext(),ID:"MaturityHdr"})),null!=e&&(e.begin(),widget.getPreference("Template_odtmode")&&!0===widget.getPreference("Template_odtmode").value)){n.publish({event:"ENOXCADTemplate_publish",data:{operation:"templateodtevent",version:"1.0"}})}},c)}}}),define("DS/ENOXCADTemplate/Controllers/ENOXCADTemplateToolbarController",["DS/ENOXCADTemplate/Views/ENOXCADTemplateDlg","DS/ENOXCADTemplate/Controllers/ENOXCADTemplateActionsController","DS/ENOXCADTemplate/Models/ENOXCADTemplateDataModel","DS/ENOXCADUtils/utils/XCADModelEvents","css!DS/UIKIT/UIKIT.css"],function(e,t,a,n){"use strict";var i=Object.create(null);return i.createTemplate=function(t){if(e.show({classname:"templateSuperModal"}),widget.getPreference("Template_odtmode")&&!0===widget.getPreference("Template_odtmode").value){n.publish({event:"ENOXCADTemplate_publish",data:{operation:"templateodtevent",version:"1.0"}})}},i.editTemplate=function(e){var a=e.context.executionContext;if(a){var n=a.getTreeDocument();if(n){var i=n.getXSO();if(i){var l=i.get();if(l.length>0){var o=l[0].options.grid;t.editTemplate(o)}}}}},i.downloadTemplate=function(e){var a=e.context.executionContext;if(a){var n=a.getTreeDocument();if(n){var i=n.getXSO();if(i){var l=i.get();if(l.length>0){var o=l[0].options.grid;t.downloadTemplate(o)}}}}},i.publishTemplate=function(e){var a=e.context.executionContext;if(a){var n=a.getTreeDocument();if(n){var i=n.getXSO();if(i){var l=i.get();if(l.length>0){var o=l[0].options.grid;t.publishTemplate(o)}}}}},i.deleteTemplate=function(e){var a=e.context.executionContext;if(a){var n=a.getTreeDocument();if(n){var i=n.getXSO();if(i){var l=i.get();if(l.length>0){var o=l[0].options.grid;t.deleteTemplate(o)}}}}},i.refreshTemplate=function(e){var t={operation:"listtemplate",version:"1.0",data:{maincadtype:a._currentSelectedTabName,templatecadtype:a._listOftemplateCadType.get(a._currentSelectedTabName)}};n.publish({event:"ENOXCADTemplate_publish",data:t}),n.publish({event:"xcad-loader-on"})},i}),define("DS/ENOXCADTemplate/Views/ENOXCADNewFromTemplate",["UWA/Class","UWA/Core","DS/ENOXCADTemplate/Models/ENOXCADTemplateDataModel","DS/ENOXCADUtils/utils/XCADModelEvents","DS/Controls/ComboBox","DS/Controls/Button","DS/ENOXCADTemplate/Models/ENOXCADTemplateInitDataModel","DS/Controls/LineEditor","DS/PlatformAPI/PlatformAPI","DS/ENOXCADUtils/XCADNotification","i18n!DS/ENOXCADTemplate/assets/nls/ENOXCADTemplateView","css!DS/ENOXCADTemplate/assets/css/ENOXCADNewFromTemplate"],function(e,t,a,n,i,l,o,s,r,d,p){"use strict";return e.extend({_mainSubContainer:null,_formFieldDiv:null,_arrDynamicFields:[],_newfromtemplateparent:null,init:function(){},setUpView:function(e){var t=this;t._mainSubContainer=e,t.createFixedFieldView(),1==widget.getPreference("Template_isFloating").value?n.subscribe({event:"ENOXCADTemplate_ok_newfromdialog"},function(e){t.validateAndPublishEvent(t)}):t.createTemplateFooter()},createFixedFieldView(){var e=this,t=a.gettypeselectionfield();e._newfromtemplateparent=new UWA.createElement("div",{class:"div-newfromtemplateparent",id:"newfromtemplateparent"}).inject(e._mainSubContainer);var l=new UWA.createElement("div",{class:"div-templatefixedfield",id:"templatefixedfield"});new UWA.Element("h5",{text:p.cadtypefield}).inject(l);for(var o=a.getCadTypes(),s=[],r=widget.getPreference("Template_connectorNls").value,d=0;d<o.length;d++){var c=o[d],u=r[c+".label"];s.push({labelItem:u,valueItem:c})}var m=localStorage.getItem("templateselectedindex");if(e.cadTypeDropDown=new i({elementsList:s,selectedIndex:m}),e.cadTypeDropDown.inject(l),e.cadTypeDropDown.addEventListener("change",function(){if(localStorage.setItem("templateselectedindex",e.cadTypeDropDown.selectedIndex),null!=e._formFieldDiv&&e._formFieldDiv.remove(),document.getElementsByClassName("div-managebtn").length>0&&document.getElementsByClassName("div-managebtn")[0].destroy(),null!=e._arrDynamicFields&&e._arrDynamicFields.splice(0,e._arrDynamicFields.length),0==a.checkAndUpdateTemplateData(e.cadTypeDropDown.currentValue,!0,null,!0)){var t={operation:"listtemplate",version:"1.0",data:{maincadtype:e.cadTypeDropDown.currentValue,templatecadtype:a._listOftemplateCadType.get(e.cadTypeDropDown.currentValue)}};n.publish({event:"ENOXCADTemplate_publish",data:t}),n.publish({event:"xcad-loader-on"})}else if(widget.getPreference("Template_odtmode")&&!0===widget.getPreference("Template_odtmode").value){n.publish({event:"ENOXCADTemplate_publish",data:{operation:"templateodtevent",version:"1.0"}})}}),t){new UWA.Element("h5",{text:p.cadsubtypefield}).inject(l);var f=a.EnoviatypesNLSValues(e.cadTypeDropDown.currentValue);a.sortEnoviaTypesBasedOnLabel(f);var D=localStorage.getItem("cadSubtypeSelectedIndex");e.cadsubTypeDropDown=new i({elementsList:f,selectedIndex:D}),e.cadsubTypeDropDown.inject(l),e.cadsubTypeDropDown.addEventListener("change",function(){localStorage.setItem("cadSubtypeSelectedIndex",e.cadsubTypeDropDown.selectedIndex),a.checkAndUpdateTemplateData(e.cadTypeDropDown.currentValue,!0,e.cadsubTypeDropDown.currentValue,!1)})}new UWA.Element("h5",{text:p.templatefield}).inject(l),e.templateDropDown=new i({}),e.templateDropDown.inject(l),l.inject(e._newfromtemplateparent),e.cadTypeDropDown.fire("change")},createConnectorFields(){var e=this;if(o._mapOfFormFields&&o._mapOfFormFields.has(e.cadTypeDropDown.currentValue)){e._formFieldDiv=new UWA.createElement("div",{class:"div-templateformfields",id:"templateformfields"});var t=widget.getPreference("Template_connectorNls").value,a=o._mapOfFormFields.get(e.cadTypeDropDown.currentValue);for(let l=0;l<a.length;l++){var n=null!=t[a[l].label]?t[a[l].label]:a[l].label;new UWA.Element("h5",{text:n}).inject(e._formFieldDiv);var i=new s({id:a[l].id,value:null!=a[l].value?a[l].value:null,touchMode:!0,placeholder:null!=a[l].placeholder?t[a[l].placeholder]:null,requiredFlag:a[l].required,sizeInCharNumber:null!=a[l].sizeincharnumber?a[l].sizeincharnumber:null});i.inject(e._formFieldDiv),e._arrDynamicFields.push({field:i,id:a[l].id})}e._formFieldDiv.inject(e._newfromtemplateparent)}1==o._manageTemplates&&e.createManageTemplateButton()},createManageTemplateButton(){var e=this;if(1==o._manageTemplates){var t=new UWA.createElement("div",{class:"div-managebtn",id:"manageTemplateDiv"}),a=new l({label:p.managetemplates,emphasize:"info",styles:{float:"right"}}).inject(t);a.getContent().addEventListener("buttonclick",function(){a.hide(),localStorage.setItem("templateselectedtab",e.cadTypeDropDown.currentValue),r.publish("template-managetemplate-btn-click")}),t.inject(e._newfromtemplateparent)}},validateAndPublishEvent:function(e){var t=!0,i=a.gettypeselectionfield();if(null!=e.cadTypeDropDown.currentValue)if(null!=e.templateDropDown.currentValue){var l={maincadtype:e.cadTypeDropDown.currentValue,templatecadtype:a._listOftemplateCadType.get(e.cadTypeDropDown.currentValue),phid:e.templateDropDown.currentValue};if(i){var o=e.cadsubTypeDropDown.currentValue;o="notSpecified"==o?"":o,l.type3dx=o}for(let a=0;a<e._arrDynamicFields.length;a++){var s=e._arrDynamicFields[a];1==s.field.requiredFlag&&(null==s.field.value||s.field.value.trim().length<=0)&&(t=!1),l[s.id]=s.field.value}if(null!=e.cadTypeDropDown.currentValue&&e.templateDropDown.currentValue,1==t){var r={operation:"newfromtemplateselection",version:"1.0",data:l};n.publish({event:"ENOXCADTemplate_publish",data:r})}else d.errorMsg(p.msg_error_mandfieldempty)}else d.errorMsg(p.msg_error_templateempty);else d.errorMsg(p.msg_error_cadtypeempty)},createTemplateFooter:function(){var e=this,t=new UWA.createElement("div",{class:"div-template-footer",id:"template-footer"});new l({label:p.newfromok,emphasize:"primary"}).inject(t).addEventListener("buttonclick",function(){e.validateAndPublishEvent(e)}),new l({label:p.newfromcancel,emphasize:"secondary"}).inject(t).addEventListener("buttonclick",function(){n.publish({event:"ENOXCADTemplate_publish",data:{operation:"closenewfromtemplate",version:"1.0"}})}),t.inject(e._mainSubContainer)}})}),define("DS/ENOXCADTemplate/Views/ENOXCADTemplateTabView",["UWA/Class","UWA/Core","DS/Controls/Tab","DS/ENOXCADTemplate/Models/ENOXCADTemplateDataModel","DS/ENOXCADUtils/utils/XCADModelEvents","DS/ENOXCADUtils/XCADIconsPath"],function(e,t,a,n,i,l){"use strict";return e.extend({_webUXTabs:null,_container:null,_gridView:null,_currentTabName:null,init:function(){},setUpView:function(e,t){this._container=e,this._gridView=t,this.createTabView()},createTabView(){var e=this,t=n.getCadTypes();if(0>=t.length)throw Error("ERROR: No cad types found to build tab view");e._webUXTabs=new a({showComboBoxFlag:!0,touchMode:!0,allowUnsafeHTMLOnTabButton:!1,displayStyle:["strip"]});var o=e._gridView.getGridViewContainer(),s=widget.getPreference("Template_serviceurl").value,r=widget.getPreference("Template_integration").value;r=widget.getPreference("Template_connectorNls").value;e._currentTabName=localStorage.getItem("templateselectedtab");for(var d=0;d<t.length;d++){var p=t[d],c=r[p+".label"],u=n.getGcoMappingFromCadType(p),m=l.getTypeIconPath(s,u,widget.getValue("icons_nonPStypes"));null==e._currentTabName&&0==d&&(localStorage.setItem("templateselectedtab",p),e._currentTabName=p);var f={label:c,isSelected:p==e._currentTabName,index:d,value:p,content:o,icon:m,allowUnsafeHTMLOnTabButton:!1};e._webUXTabs.add(f)}e._webUXTabs.tabBar.centeredFlag=!1,e._webUXTabs.tabPanelContainer.classList.add("tab-in-mobile"),e._webUXTabs.inject(e._container),o.inject(e._container),n.setSelectedCadType(e._currentTabName),e._webUXTabs.addEventListener("change",function(t){if(void 0!==t.dsModel&&void 0!==t.dsModel.value){var a=t.dsModel.value[0];if(e._currentTabName=a,localStorage.setItem("templateselectedtab",a),n.setSelectedCadType(e._currentTabName),e._gridView.emptyTreeDocument(),0==n.checkAndUpdateTemplateData(a)){var l={operation:"listtemplate",version:"1.0",data:{maincadtype:a,templatecadtype:n._listOftemplateCadType.get(a)}};i.publish({event:"ENOXCADTemplate_publish",data:l}),i.publish({event:"xcad-loader-on"})}else if(widget.getPreference("Template_odtmode")&&!0===widget.getPreference("Template_odtmode").value){i.publish({event:"ENOXCADTemplate_publish",data:{operation:"templateodtevent",version:"1.0"}})}}}),e._webUXTabs._showContent(e._currentTabName)}})}),define("DS/ENOXCADTemplate/Views/ENOXCADTemplateDlgView",["UWA/Class","UWA/Core","DS/ENOXCADTemplate/Views/ENOXCADTemplateDlg","DS/ENOXCADTemplate/Models/ENOXCADTemplateDataModel","DS/ENOXCADUtils/utils/XCADModelEvents","css!DS/UIKIT/UIKIT.css"],function(e,t,a,n,i){"use strict";return e.singleton({init:function(){},showAddEditTemplateDlg:function(e){try{if(null==e.maincadtype||null==e.action)throw Error("ERROR: maincadtype or action parameter is missing");if(UWA.createElement("div",{id:"IdDIV_container",class:"addDlgDIV_container"}).inject(document.getElementById("mainContainer")),n.setSelectedCadType(e.maincadtype),"edit"==e.action)(t={}).title=e.title,null!=e.desc&&(t.description=e.desc),t.filepath=e.filepath,t.phid=e.phid,null!=e.uuid&&(t.uuid=e.uuid),null!=e.cestamp&&(t.cestamp=e.cestamp),a.show({classname:"templateSuperModal_sw",forswconnector:!0,forEdit:!0,filepath:e.filepath,values:t});else if("add"==e.action){var t={};null!=e.title&&(t.title=e.title),null!=e.uuid&&(t.uuid=e.uuid),a.show({classname:"templateSuperModal_sw",forswconnector:!0,filepath:e.filepath,values:t})}var l={operation:"initforcreatetemplate",version:"1.0",data:{status:"success",message:"initforcreatetemplate operation is succesful"}};i.publish({event:"ENOXCADTemplate_publish",data:l})}catch(e){"Error"==e.name?console.log(e.message):console.log(e);l={operation:"initforcreatetemplate",version:"1.0",data:{status:"failure",message:"initforcreatetemplate operation is Failed"}};i.publish({event:"ENOXCADTemplate_publish",data:l})}}})}),define("DS/ENOXCADTemplate/Controllers/ENOXCADTemplateCtxMenu",["DS/ENOXCADTemplate/Controllers/ENOXCADTemplateActionsController","DS/ENOXCADTemplate/Controllers/ENOXCADTemplateUtility","i18n!DS/ENOXCADTemplate/assets/nls/ENOXCADTemplateOperation"],function(e,t,a){"use strict";return{getOnContextualEvent:function(t){t.onContextualEvent=function(t){var n=[];return t&&t.collectionView&&t.cellInfos&&t.cellInfos.rowID>-1&&(n.push({type:"PushItem",title:a.download,fonticon:{family:1,content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-download"},action:{callback:function(a){var n=t.cellInfos.nodeModel;e.downloadTemplate(n.options.grid)}}}),n.push({type:"PushItem",title:a.edit,fonticon:{family:1,content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-pencil"},action:{callback:function(a){a.context;var n=t.cellInfos.nodeModel;e.editTemplate(n.options.grid)}}}),n.push({type:"PushItem",title:a.publish,fonticon:{family:1,content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-collaborative-lifecycle-management"},action:{callback:function(a){a.context;var n=t.cellInfos.nodeModel;e.publishTemplate(n.options.grid)}}}),n.push({type:"PushItem",title:a.delete,fonticon:{family:1,content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-close"},action:{callback:function(a){a.context;var n=t.cellInfos.nodeModel;e.deleteTemplate(n.options.grid)}}})),n}}}}),define("DS/ENOXCADTemplate/Views/ENOXCADTemplateDataGridView",["UWA/Class","UWA/Core","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/DataGridView/DataGridView","DS/ENOXCADTemplate/Controllers/ENOXCADTemplateCtxMenu","DS/ENOXCADUtils/utils/XCADModelEvents","DS/ENOXCADTemplate/Controllers/ENOXCADTemplateUtility","DS/ENOXCADTemplate/Models/ENOXCADTemplateDataModel","DS/ENOXCADUtils/XCADIconsPath","DS/ENOXCADTemplate/Models/ENOXCADTemplateInitDataModel","text!DS/ENOXCADTemplate/assets/columns.json","text!DS/ENOXCADTemplate/assets/toolbar.json","i18n!DS/ENOXCADTemplate/assets/nls/ENOXCADTemplateColumn","i18n!DS/ENOXCADTemplate/assets/nls/ENOXCADTemplateOperation","i18n!DS/ENOXCADTemplate/assets/nls/TemplateDialogCreation"],function(e,t,a,n,i,l,o,s,r,d,p,c,u,m,f,D){"use strict";return e.singleton({_model:null,_dataGridView:null,_selectedNodes:null,_treeListViewContainer:null,init:function(){this._model=new a},setUpView:function(){this.setDataGridView()},setDataGridView:function(){var e=this,t=[];if(null!=p._notRequiredColumns&&p._notRequiredColumns.length>0){var a=JSON.parse(c);for(let e=0;e<a.length;e++)0==p._notRequiredColumns.includes(a[e].dataIndex)&&t.push(a[e])}else t=JSON.parse(c);e._dataGridView=new i({identifier:"dataGridView",treeDocument:e._model,cellSelection:"none",showContextualMenuColumnFlag:!0,rowSelection:"single",columns:t,showRowBorderFlag:!0,defaultColumnDef:{width:"auto",resizableFlag:!0,sortableFlag:!0}}),e._dataGridView.layout.columnHeaderHeight=40,e._dataGridView.layout.cellHeight=35;var n=e._dataGridView.getColumnOrGroup("ContextualMenuColumn");n&&(n.text="Action",n.width="70px"),e.setColumnNls(),l.getOnContextualEvent(e._dataGridView),e._treeListViewContainer=new UWA.Element("div",{class:"vpmTemplate-view-grid-container"}),e._dataGridView.inject(e._treeListViewContainer),e.createToolbar()},setColumnNls:function(){var e=this._dataGridView.columns;for(let a=0;a<e.length;a++){var t=e[a].dataIndex;e[a].text=m[t]}},createToolbar:function(){var e,t=UWA.createElement("div",{class:"toolbar"}).inject(this._treeListViewContainer),a=JSON.parse(u);(e=this._dataGridView.setToolbar(JSON.stringify(a.fullaccesmode))).addEventListener("onReady",function(t){for(var a=e.items.getRoots(),n=0;n<a.length;n++){var i=a[n];i&&(i.options.tooltip=f[i.options.tooltip],e.updateNodeModel(i._ID,{}))}}),t.appendChild(e.getContent()),this.enableToolBar(this._model.getXSO(),e)},enableToolBar:function(e,t){var a=this;e&&(e.onPostAdd(function(e){t.updateNodeModel("edittemplateId",{disabled:!1}),t.updateNodeModel("downloadId",{disabled:!1}),t.updateNodeModel("publishId",{disabled:!1}),t.updateNodeModel("deleteTemplateId",{disabled:!1}),e.forEach(function(e){a._selectedNodes[e.options.nodeId]=e}),a.prepareMessageToSend()}),e.onPostRemove(function(e){t.updateNodeModel("edittemplateId",{disabled:!0}),t.updateNodeModel("downloadId",{disabled:!0}),t.updateNodeModel("publishId",{disabled:!0}),t.updateNodeModel("deleteTemplateId",{disabled:!0}),e.forEach(function(e){delete a._selectedNodes[e.options.nodeId]}),a.prepareMessageToSend()}))},prepareMessageToSend:function(){var e=[];Object.entries(this._selectedNodes).map(t=>{let a=t[0],n=t[1];e.push({cadid:n.options.grid.cadid,phid:a,maincadtype:n.options.grid.maincadtype,templatecadtype:n.options.grid.templatecadtype})});var t={operation:"templateselectrow",version:"1.0",data:{templatelist:e}};o.publish({event:"ENOXCADTemplate_publish",data:t})},getGridViewContainer:function(){return this._treeListViewContainer},updateTreeDocument:function(e){var t=this,a=JSON.parse(JSON.stringify(e));if(!t._model)throw Error("updateTreeDocument: Model is not available");if(t._model.empty(),t._selectedNodes=new Object,null!=a)for(var i=widget.getPreference("Template_serviceurl").value,l=0;l<a.length;l++){var o=a[l],s=r._gcoJsonData.nlsvalues[o.type3dx],p=r._gcoJsonData.nlsstate[o.maturity];o.type3dx=s||D.notSpecified,o.maturity=p||o.maturity;var c=new n({nodeId:o.phid,label:o.title,icons:[{iconPath:d.getTypeIconPath(i,{typeclass:"[TYPE_CAD_DOCUMENT_LIKE]",cadtype:o.templatecadtype})}],grid:o});t._model.prepareUpdate(),t._model.addChild(c),t._model.pushUpdate()}},addDataToTreeDocument:function(e){var t=Object.assign({},e);if(!this._model)throw Error("addDataToTreeDocument: Model is not available");var a=r._gcoJsonData.nlsvalues[t.type3dx],i=r._gcoJsonData.nlsstate[t.maturity];t.type3dx=a||D.notSpecified,t.maturity=i||t.maturity;var l=widget.getPreference("Template_serviceurl").value,o=new n({nodeId:t.phid,label:t.title,icons:[{iconPath:d.getTypeIconPath(l,{typeclass:"[TYPE_CAD_DOCUMENT_LIKE]",cadtype:t.templatecadtype})}],grid:t});this._model.prepareUpdate(),this._model.addChild(o),this._model.pushUpdate()},editTreeDocument:function(e){var t=Object.assign({},e);if(!this._model)throw Error("editTreeDocument: Model is not available");var a=this._model.search({match:function(e){if(e.nodeModel.options.grid.phid==t.phid)return!0}});if(a&&a.length>0){var n=a[0],i=r._gcoJsonData.nlsvalues[t.type3dx],l=r._gcoJsonData.nlsstate[t.maturity];for(var o in t.type3dx=i||D.notSpecified,t.maturity=l||t.maturity,t)t.hasOwnProperty(o)&&n.setAttribute(o,t[o]);n.options.label=t.title,this._dataGridView.invalidateLayout({updateCellContent:!0,updateCellLayout:!0,updateCellAttributes:!0})}},deleteNodeModel:function(e){if(!this._model)throw Error("editTreeDocument: Model is not available");var t=this._model.search({match:function(t){if(t.nodeModel.options.grid.phid==e)return!0}});t&&t.length>0&&t[0].remove()},emptyTreeDocument:function(){this._model.empty()}})}),define("DS/ENOXCADTemplate/Views/ENOXCADTemplateView",["UWA/Class/View","UWA/Core","DS/ENOXCADTemplate/Views/ENOXCADTemplateTabView","DS/ENOXCADTemplate/Views/ENOXCADTemplateDataGridView","DS/ENOXCADTemplate/Models/ENOXCADTemplateDataModel","DS/ENOXCADUtils/utils/XCADModelEvents","DS/ENOXCADUtils/loader/XCADLoader","DS/Controls/Breadcrumb","DS/PlatformAPI/PlatformAPI","i18n!DS/ENOXCADTemplate/assets/nls/ENOXCADTemplateView"],function(e,t,a,n,i,l,o,s,r,d){"use strict";return e.extend({_tabView:new a,_viewContainer:null,_viewNFT:null,className:"xcadtemplate-view-list",setup:function(e){try{this._mainContainer=null,this._mainContainer=null!=e?e.container:document.getElementById("mainContainer")}catch(e){"Error"==e.name?console.log(e.message):console.log(e);l.publish({event:"ENOXCADTemplate_publish",data:{operation:"initfortemplate",version:"1.0",data:{status:"failure",message:"initfortemplate operation is Failed"}}})}},initManageTemplateUI:function(){n.setUpView(),this._tabView.setUpView(this._mainContainer,n),i.setTemplateGridViewForUpdate(n),i.setParentContainer(this._mainContainer)},setupManageTemplateUI:function(e){try{this.initManageTemplateUI(),n._dataGridView.getContent().style.top="90px";var t={operation:"initfortemplate",version:"1.0",data:{status:"success",message:"Template Init operation is succesful"}};l.publish({event:"ENOXCADTemplate_publish",data:t});var a={operation:"listtemplate",version:"1.0",data:{maincadtype:this._tabView._currentTabName,templatecadtype:i._listOftemplateCadType.get(this._tabView._currentTabName)}};l.publish({event:"ENOXCADTemplate_publish",data:a}),l.publish({event:"xcad-loader-on"})}catch(e){"Error"==e.name?console.log(e.message):console.log(e);t={operation:"initfortemplate",version:"1.0",data:{status:"failure",message:"initfortemplate operation is Failed"}};l.publish({event:"ENOXCADTemplate_publish",data:t})}},setupUIFromNewFromTemplate:function(e){var t=this;t._viewNFT=e.nftview,new s({value:[d.newfromtemplate,d.managetemplates],mode:s.MODE.NAVIGATION}).inject(t._mainContainer).addEventListener("selectionChange",function(){r.unsubscribe("template-managetemplate-btn-click"),t._mainContainer.empty(),new o({maindiv:document.getElementById("mainContainer"),url_3DSpace:widget.getPreference("Template_serviceurl").value}),t._viewNFT.setupUI()}),t.initManageTemplateUI(),n._dataGridView.getContent().style.top="115px",t._tabView._webUXTabs.fire("change")},render:function(e){return this}})}),define("DS/ENOXCADTemplate/Views/ENOXCADNewFromTemplateView",["UWA/Class/View","UWA/Core","DS/ENOXCADTemplate/Models/ENOXCADTemplateDataModel","DS/ENOXCADUtils/utils/XCADModelEvents","DS/ENOXCADUtils/loader/XCADLoader","DS/Controls/Button","DS/ENOXCADTemplate/Views/ENOXCADTemplateView","DS/ENOXCADTemplate/Views/ENOXCADNewFromTemplate","DS/PlatformAPI/PlatformAPI"],function(e,t,a,n,i,l,o,s,r){"use strict";return e.extend({_newFromTemplateView:null,_mainSubContainer:null,className:"xcadtemplate-view-newfromtemplate",initUI:function(){try{this._newFromTemplateView=new s,this.setupUI(this._mainSubContainer),a._newFromTemplateView=this._newFromTemplateView}catch(e){"Error"==e.name?console.log(e.message):console.log(e);n.publish({event:"ENOXCADTemplate_publish",data:{operation:"initnewfromtemplate",version:"1.0",data:{status:"failure",message:"initnewfromtemplate operation is Failed"}}})}},setupUI:function(e){var t=this;try{t._mainContainer=null,t._mainContainer=null!=e?e.container:document.getElementById("mainContainer"),t._mainSubContainer=UWA.createElement("div",{id:"newfromtemplate",class:"DIV_newfromtemplate"}).inject(t._mainContainer),t._newFromTemplateView.setUpView(t._mainSubContainer),r.subscribe("template-managetemplate-btn-click",function(){t._mainContainer.empty(),new i({maindiv:document.getElementById("mainContainer"),url_3DSpace:widget.getPreference("Template_serviceurl").value}),null==t._view&&(t._view=new o),t._view.setupUIFromNewFromTemplate({nftview:t})})}catch(e){"Error"==e.name?console.log(e.message):console.log(e);n.publish({event:"ENOXCADTemplate_publish",data:{operation:"initnewfromtemplate",version:"1.0",data:{status:"failure",message:"initnewfromtemplate operation is Failed"}}})}},render:function(e){return this}})}),define("DS/ENOXCADTemplate/Models/ENOXCADTemplateProtocolModel",["UWA/Class/Options","UWA/Class","DS/ENOXCADTemplate/Views/ENOXCADTemplateView","DS/ENOXCADTemplate/Models/ENOXCADTemplateDataModel","DS/ENOXCADTemplate/Controllers/ENOXCADTemplateUtility","DS/ENOXCADTemplate/Views/ENOXCADTemplateDlg","DS/ENOXCADTemplate/Models/ENOXCADTemplateInitDataModel","DS/ENOXCADUtils/XCADNotification","DS/ENOXCADTemplate/Views/ENOXCADTemplateDlgView","DS/ENOXCADUtils/loader/XCADLoader","DS/ENOXCADUtils/utils/XCADModelEvents","DS/ENOXCADTemplate/Views/ENOXCADNewFromTemplateView","i18n!DS/ENOXCADTemplate/assets/nls/ENOXCADTemplateView"],function(e,t,a,n,i,l,o,s,r,d,p,c,u){"use strict";var m=t.singleton(e,{_view:null,init:function(){},receivedProtocol:function(e){var t=this;try{var d=e;switch("string"==typeof e&&(d=JSON.parse(e)),d.operation){case"initnewfromtemplate":t.setInitPreferences(d.data.infra),o.initUIJsonFields(d.data.ui),n.setTypeselectionField(d.data.ui.showtypeselectionfield),new Promise(function(e,t){i.initGCOCadAttributes(d.operation,e,t)}).then(function(e){1==parseFloat(d.version)&&m.loadConnectorNls().then(()=>{t._newFromTemplateview=new c,t._newFromTemplateview.initUI()})},function(e){throw Error(e)});break;case"initfortemplate":t.setInitPreferences(d.data.infra),o.initUIJsonFields(d.data.ui),new Promise(function(e,t){i.initGCOCadAttributes(d.operation,e,t)}).then(function(e){1==parseFloat(d.version)&&m.loadConnectorNls().then(()=>{t._view=new a,t._view.setupManageTemplateUI()})},function(e){throw Error(e)});break;case"initforcreatetemplate":t.setInitPreferences(d.data.infra),o.initUIJsonFields(d.data.ui),new Promise(function(e,t){i.initGCOCadAttributes(d.operation,e,t)}).then(function(e){r.showAddEditTemplateDlg(d.data.createinfo)},function(e){throw Error(e)});break;case"listtemplate":if(1==parseFloat(d.version))if("success"==d.data.status){if(null!=d.data.formfields&&o.setCustomFormFields(d.data.maincadtype,d.data.formfields),"xml"==d.data.mode?n.setXMLData(d.data,d.operation):"json"==d.data.mode&&n.setTemplateData(d.data),document.getElementsByClassName("DIV_newfromtemplate").length<=0)v=d.data.templatelist.length>0?u.msg_success_listtemplate:u.msg_success_notemplate,s.sucessMsg(v);if(widget.getPreference("Template_odtmode")&&!0===widget.getPreference("Template_odtmode").value){var f={operation:"templateodtevent",version:"1.0"};p.publish({event:"ENOXCADTemplate_publish",data:f})}}else{var D=null!=u[d.data.message]?u[d.data.message]:d.data.message;s.errorMsg(D)}p.publish({event:"xcad-loader-off"});break;case"templatefilepath":if(1==parseFloat(d.version))if("success"==d.data.status)l.updateTemplateFilePath(d.data.filepath);else{D=null!=u[d.data.message]?u[d.data.message]:d.data.message;s.errorMsg(D)}break;case"addoredittemplate":if(1==parseFloat(d.version))if("success"==d.data.status){if("xml"==d.data.mode?n.setXMLData(d.data,d.operation):"json"==d.data.mode&&n.addOREditTemplateData(d.data),"add"==d.data.action?v=u.msg_success_templatecreate:"edit"==d.data.action&&(v=u.msg_success_edittemplate),s.sucessMsg(v),widget.getPreference("Template_odtmode")&&!0===widget.getPreference("Template_odtmode").value){f={operation:"templateodtevent",version:"1.0"};p.publish({event:"ENOXCADTemplate_publish",data:f})}}else{D=null!=u[d.data.message]?u[d.data.message]:d.data.message;s.errorMsg(D)}p.publish({event:"xcad-loader-off"});break;case"templatenotification":if(1==parseFloat(d.version)){var v=null!=u[d.data.message]?u[d.data.message]:d.data.message;"success"==d.data.status?s.sucessMsg(v):"warning"==d.data.status?s.warningMsg(v):"info"==d.data.status?s.infoMsg(v):s.errorMsg(v)}break;case"closetemplatenewfrompanel":1==parseFloat(d.version)&&p.publish({event:"ENOXCADTemplate_closenewfromtemplatepanel",data:d})}}catch(e){"Error"==e.name?console.log(e.message):console.log(e),p.publish({event:"xcad-loader-off"})}},setInitPreferences:function(e){if(!(e.tenantid&&e.securitycontext&&e.url3dspace&&e.lang&&e.integration))throw Error("Init infra options are missing");new d({maindiv:document.getElementById("mainContainer"),url_3DSpace:e.url3dspace}),"OnPremise"!==e.tenantid?widget.setValue("x3dPlatformId",e.tenantid):console.log("This is onPremise"),widget.addPreference({name:"Template_tenantid",type:"hidden",defaultValue:""}),widget.setValue("Template_tenantid",e.tenantid),widget.addPreference({name:"Template_security_ctx",type:"hidden",defaultValue:""}),widget.setValue("Template_security_ctx",e.securitycontext),widget.addPreference({name:"Template_serviceurl",type:"hidden",defaultValue:""}),widget.setValue("Template_serviceurl",e.url3dspace),widget.addPreference({name:"Template_lang",type:"hidden",defaultValue:""}),widget.setValue("Template_lang",e.lang),widget.addPreference({name:"Template_integration",type:"hidden",defaultValue:""}),widget.setValue("Template_integration",e.integration),!0===e.odtmode&&(widget.addPreference({name:"Template_odtmode",type:"hidden",defaultValue:""}),widget.setValue("Template_odtmode",e.odtmode))},loadConnectorNls:function(){return new Promise(function(e,t){null!=widget.getPreference("Template_connectorNls")&&e();var a=widget.getPreference("Template_integration").value;require(["i18n!DS/ENOXCADTemplate/assets/nls/"+a+"_nls"],function(t){widget.addPreference({name:"Template_connectorNls",type:"hidden",defaultValue:""}),widget.setValue("Template_connectorNls",t),e()})})}});return m}),define("DS/ENOXCADTemplate/ENOXCADTemplatecommunication",["DS/ENOXCADTemplate/Models/ENOXCADTemplateProtocolModel","DS/ENOXCADUtils/utils/XCADModelEvents","DS/PlatformAPI/PlatformAPI","DS/MessageBus/MessageBus"],function(e,t,a,n){"use strict";return{_isFloating:null,_xcadEvent:null,onLoad:function(e){var a=UWA.createElement("div",{id:"mainContainer",class:"mainDIV_container"});null!=e&&null!=e.isfloating?(this._isFloating=e.isfloating,a.inject(e.container)):widget.setBody(a),widget.addPreference({name:"Template_isFloating",type:"hidden",defaultValue:""}),widget.setValue("Template_isFloating",this._isFloating),this.publish(),this.subscribe();t.publish({event:"ENOXCADTemplate_publish",data:{operation:"templatepageready",version:"1.0",data:{status:"success",message:"Page is ready"}}})},publish:function(){var e=this;t.subscribe({event:"ENOXCADTemplate_publish"},function(t){null==e._isFloating&&"undefined"!=typeof dscef?dscef.sendString(JSON.stringify(t)):a.publish("webinwin:web:notification",JSON.stringify(t))})},subscribe:function(){null==this._isFloating&&"undefined"!=typeof dscef?t.subscribe({event:"webinwin:win:notification"},function(t){e.receivedProtocol(t)}):this._xcadEvent=a.subscribe("webinwin:win:notification",function(t){e.receivedProtocol(t)})}}}),define("DS/ENOXCADTemplate/cmd/ENOXCADNewFromTemplateCmd",["UWA/Core","DS/ApplicationFrame/Command","DS/ENOXCADTemplate/ENOXCADTemplatecommunication","DS/ENOXCADTemplate/Models/ENOXCADTemplateDataModel","DS/Windows/ImmersiveFrame","DS/Windows/Dialog","DS/Controls/Button","DS/ENOXCADUtils/utils/XCADModelEvents","DS/PlatformAPI/PlatformAPI","i18n!DS/ENOXCADTemplate/assets/nls/ENOXCADTemplateView"],function(e,t,a,n,i,l,o,s,r,d){"use strict";var p;return t.extend({init:function(t){t=e.extend(t,{isAsynchronous:!1}),this._parent(t)},execute:function(t){n._listOf3DxTypes=null,n._listOfTemplateData=null,n._templateGridView=null,n._parentContainer=null,n._listOftemplateCadType=null,n._gcoJsonData=null,n._currentSelectedTabName=null,n._newFromTemplateView=null,p=e.createElement("div",{id:"floatingContainer",class:"floating_container",styles:{position:"relative",height:"100%",width:"100%"}}),a.onLoad({isfloating:!0,container:p}),this._buildTemplateDialog()},_buildTemplateDialog:function(){this.buildModal()},buildModal:function(){var t=this;let a=new i({identifier:"WebUIPanelDocumentation_MaximizableDialog"}),n=new l({immersiveFrame:a,title:d.mysession_newfromdlg_title,content:p,width:710,height:300,resizableFlag:!0,identifier:"WebUIPanelDocumentation_maximizableDialog",maximizeButtonFlag:!1,closeButtonFlag:!0,buttons:{Cancel:new o({onClick:function(e){n.close(),a.destroy(),t.unsubscribeAllEvents()}}),Ok:new o({onClick:function(e){s.publish({event:"ENOXCADTemplate_ok_newfromdialog",data:e})}})}});n.addEventListener("close",function(e){n.destroy(),a.destroy(),t.unsubscribeAllEvents()}),a.inject(e.extendElement(document.body)),s.subscribe({event:"ENOXCADTemplate_closenewfromtemplatepanel"},function(e){n.destroy(),a.destroy(),t.unsubscribeAllEvents()})},unsubscribeAllEvents:function(){null!=a._xcadEvent&&a._xcadEvent.unsubscribe(),s.unsubscribeAll({event:"ENOXCADTemplate_closenewfromtemplatepanel"}),s.unsubscribeAll({event:"ENOXCADTemplate_publish"}),s.unsubscribeAll({event:"ENOXCADTemplate_ok_newfromdialog"})}})});