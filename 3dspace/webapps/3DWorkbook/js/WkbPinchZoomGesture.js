define("DS/3DWorkbook/js/WkbPinchZoomGesture",["UWA/Core","UWA/Class","DS/Core/PointerEvents"],function(e,t,n){"use strict";const i=1908/1057;var s=function(e,t){let n=e.clientX-t.clientX,i=e.clientY-t.clientY;return Math.sqrt(n*n+i*i)};function r(t,n){const s=t.getElement("#twoDViews");if(!e.is(s))return;const r=s.getElement("#img0");if(!e.is(r))return;let l=0,o=0;const c=s.clientHeight,f=s.clientWidth;i>f/c?((l=r.clientWidth*n)<f&&(l=f),o=l/i):((o=r.clientHeight*n)<c&&(o=c),l=o*i);const u=parseFloat(r.style.top),h=parseFloat(r.style.left),d=c/2,a=f/2,g=d-(d-u)/r.clientHeight*o,m=a-(a-h)/r.clientWidth*l;r.setStyle("width",l),r.setStyle("height",o),r.setStyle("top",g),r.setStyle("left",m)}var l,o,c=[],f=-1;function u(t){e.is(c.find(e=>e.identifier===t.identifier))||c.push(t)}function h(e){for(let t=0;t<c.length;t++)if(c[t].identifier===e.identifier)return c.splice(t,1),!0;return!1}var d=!1;function a(e){e.preventDefault(),e.stopPropagation()}return t.extend({init:function(e){this.element=e.element,this.preventDefaultGestures(),this._listenEvents()},_listenEvents:function(){var t=this;function i(e){if("img0"===e.target.id){d=!1;for(let t=0;t<e.changedTouches.length;t++)h(e.changedTouches[t])||(f=-1,c=[]);c.length<2&&(f=-1)}}e.is(this.element)&&(this.element.addEvent(n.POINTERDOWN,function(e){if("img0"===e.target.id){for(let t=0;t<e.changedTouches.length;t++)c.length<2&&u(e.changedTouches[t]);2===c.length?(d=!1,f=s(c[0],c[1])):1===c.length&&(l=e.offsetX,o=e.offsetY,d=!0)}}),this.element.addEvent(n.POINTERMOVE,function(n){if("img0"!==n.target.id)return;let i=!1;for(let e=0;e<n.changedTouches.length;e++){i=!1;for(let t=0;t<c.length;t++)if(n.changedTouches[e].identifier===c[t].identifier){c[t]=n.changedTouches[e],i=!0;break}}if(i)if(2===c.length){const e=s(c[0],c[1]);f>0&&(e>f&&r(t.element,e/f),e<f&&r(t.element,e/f)),f=e}else 1===c.length&&d&&function(t,n,i){const s=t.getElement("#twoDViews");if(!e.is(s))return;const r=s.getElement("#img0");if(!e.is(r))return;const c=parseFloat(r.style.top),f=parseFloat(r.style.left),u=n-l,h=i-o;r.setStyle("top",c+h),r.setStyle("left",f+u)}(t.element,n.offsetX,n.offsetY)}),this.element.addEvent(n.POINTERUP,i),this.element.addEvent(n.POINTERCANCEL,i),this.element.addEvent(n.POINTEROUT,i),this.element.addEvent(n.POINTERLEAVE,i))},preventDefaultGestures:function(){document.addEventListener("gesturestart",a),document.addEventListener("gesturechange",a),document.addEventListener("gestureend",a)},restoreDefaultGestures:function(){document.removeEventListener("gesturestart",a),document.removeEventListener("gesturechange",a),document.removeEventListener("gestureend",a)},destroy:function(){this.restoreDefaultGestures(),this.element.removeEvent(n.POINTERDOWN),this.element.removeEvent(n.POINTERMOVE),this.element.removeEvent(n.POINTERUP)}})});