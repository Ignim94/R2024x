define("DS/3DWorkbook/js/models/WkbSystemDS",["UWA/Core","UWA/Class","UWA/Utils","UWA/Promise","DS/3DWorkbook/js/WkbUtils","i18n!DS/3DWorkbook/assets/nls/3DWorkbook"],function(e,t,s,r,i,n){"use strict";var o=null,u=null;return t.extend({init:function(e){o=(e=e||{}).modelEvtManager,u=e.ematrixURL},getSystemPIDFromHeaderOpPID:function(t,s,n){return e.is(t)?new r(function(e,s){e(function(e,t){var s={input_physical_ids:e,fileAttributes:[],version:3,primitives:[{navigate_from_rel:{id:1,mode:"stop_at_bo"}}],patterns:{relatedSystem:[{id:1}]},patternTypeFilters:{workplans:{typesToReturn:["DELLmiProductionSystemReference"]}},attributes:t,label:"WKB: Navigate Operation to System"};return JSON.stringify(s)}([t],["ds6w:label","ds6w:type"]))}).then(function(e){const t=s+"cvservlet/navigate?SecurityContext="+encodeURIComponent(n);return i.serverRequestPromise(t,"json","POST",e)}).then(function(t){return function(t){if(!e.is(t))return null;if("OK"!==t.infos.status)return null;if(t.result.length<1)return null;const s=t.result[0].outputs.relatedSystem;return!e.is(s,"array")||s.length<1?null:s[0].physicalid}(t)}).catch(function(e){r.reject(e)}):new r(function(e,t){e([])})},getIsSystemConfigured:function(t){const s=u+"resources/v1/modeler/dsprcs/dsprcs:MfgProcess/"+t+"/dscfg:Configured?$fields=dsmvcfg:attribute.isConfigured";return i.serverRequestPromise(s,"application/json","GET").then(function(t){t=JSON.parse(t);var s=!1;if(e.is(t.totalItems)&&t.totalItems>0){var i=t.member[0];e.is(i)&&e.is(i.isConfigured)&&"true"===i.isConfigured&&(s=!0)}return new r(function(e,t){e(s)})}).catch(function(e){console.log(e);var t="";widget.Debug.debugMode&&(t=e.message),o.publish({event:"wkbNotify",data:{src:"WkbSystemDS",title:n.ErrorTitle,subtitle:n.ErrSystemWebService,message:t,isVanishes:!1,type:"error"}})})},getIsValidSystem:async function(t){const s=u+"resources/v1/modeler/dsprcs/dsprcs:MfgProcess/bulkfetch?$fields=dsmveno:basic.type.public";var r=[t];r=JSON.stringify(r);try{var a=await i.serverRequestPromise(s,"application/json","POST",r);a=JSON.parse(a)}catch(e){console.log(e);var l="";return widget.Debug.debugMode&&(l=e.message),o.publish({event:"wkbNotify",data:{src:"WkbSystemDS",title:n.ErrorTitle,subtitle:n.ErrWebServiceValidSystem,message:l,isVanishes:!1,type:"error"}}),!1}return!!(e.is(a)&&e.is(a.totalItems)&&a.totalItems>0)}})});