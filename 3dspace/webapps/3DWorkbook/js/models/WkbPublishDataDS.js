define("DS/3DWorkbook/js/models/WkbPublishDataDS",["UWA/Core","UWA/Class","UWA/Promise","DS/3DWorkbook/js/WkbUtils","i18n!DS/3DWorkbook/assets/nls/3DWorkbook"],function(e,t,n,i,o){"use strict";var s,r,a="",l="",c=null;function d(e){console.log(e);var t="";widget.Debug.debugMode&&(t=e.message),c.publish({event:"wkbNotify",data:{src:"WkbPublishDataDS",title:o.ErrorTitle,subtitle:o.ErrPublishDataWebService,message:t,isVanishes:!1,type:"error"}})}return t.extend({init:function(e){c=e.modelEvtManager,a=e.serverURL,l=e.securityContext,s=a+"resources/wkb/invoke/v1/compiled3DRepReference?pid=",r=a+"cvservlet/progressiveexpand/v2?output_format=cvjson&SecurityContext="+encodeURIComponent(l)},getPublishedData:async function(t){if(!e.is(t)||0===t.length)return new n(function(e,t){e({})});var o=s+t;try{var r=await i.serverRequestPromise(o,"application/json","GET","");return JSON.parse(r)}catch(e){return d(e),{}}},getPublishedDataByIndex:async function(t){var o=null;if(!e.is(t)||0===t.length)return new n(function(e,t){e([])});var s=this.getQueryV2(t);try{if(o=await i.serverRequestPromise(r,"application/json","POST",s),!e.is(o,"string"))return{};if(o=JSON.parse(o),!e.is(o)||!e.is(o.results))return{};o=o.results}catch(e){return d(e),{}}return this.getCompiledRep(o)},getCompiledRep:function(t){const n=t.find(t=>!(!e.is(t.type)||"DELPPRCompiled3DWkiRepresentationReference"!==t.type));return e.is(n)?(n.physicalId=n.resourceid,n):{physicalId:null,modified:null,type:null}},getQueryV2:function(e){const t={batch:{expands:[{label:"DELMOMWKB: System published data reference: "+e,root:{physical_id:e},filter:{all:1},graph:{descending_condition_object:{uql:"(flattenedtaxonomies:types/AllocatedResourceLink) OR (flattenedtaxonomies:types/PLMSpecifyHowToCollectDataCnx) OR (flattenedtaxonomies:types/DELAsmProcessCanUseCnx) OR (flattenedtaxonomies:types/DELPPRCompiled3DWkiRepresentationReference) OR (flattenedtaxonomies:types/DELPPRCompiled3DWkiReference)"},descending_condition_relation:{uql:"(flattenedtaxonomies:reltypes/VPLMrel_47_PLMPort_47_V_Owner) OR (flattenedtaxonomies:reltypes/DELLmiPPRSystemInstance) OR (flattenedtaxonomies:reltypes/DELWkiDataCollectInstance) OR (flattenedtaxonomies:reltypes/VPLMrel_47_PLMConnection_47_V_Owner) OR (flattenedtaxonomies:reltypes/Reference Document) OR (flattenedtaxonomies:reltypes/DELPPRCompiled3DWkiInstance) OR (flattenedtaxonomies:reltypes/DELLmiDocRepInstance)"}}}]},outputs:{select_object:["type","bo.PLMEntity.V_Name","bo.PLMEntity.PLM_ExternalID","bo.PLMEntity.V_description","modified","physicalid","bo.plmentity.v_usage"],select_relation:["from.physicalid","physicalid","type","originated","to.physicalid","modified","ro.PLMInstance.V_description","ro.PLMInstance.PLM_ExternalID","bo.plmentity.v_usage"],hits:{predefined_computation:[]}}};return JSON.stringify(t)}})});