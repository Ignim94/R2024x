define("DS/3DWorkbook/js/models/WkbDataCollectionDS",["UWA/Core","UWA/Class","DS/3DWorkbook/js/models/WkbModelUtils","DS/3DWorkbook/js/models/WkbDataStore","DS/3DWorkbook/js/models/WkbToolDS"],function(e,s,a,t,o){"use strict";var n="",r=null;return s.extend({init:function(e){r=e.modelEvtManager,n=e.ematrixURL},getDataCollects:async function(s,o){if(!e.is(s)||0===s.length)return[];const n=t.getDataCollectRows(s);n.unshift({index:o});var r=await this._addAssignedCapableResources(n);return widget.wkbIsLanguageTranslation&&(r=await a.getTranslatedObjects(r)),r},_addAssignedCapableResources:async function(s){if("capable"!==widget.getValue("resType"))return s;var a=[],l=new Map;const c=new o(r,n);for(let o=0;o<s.length;o+=1)if(e.is(s[o].capableResourceLinkPIDs)&&s[o].capableResourceLinkPIDs.length>0){const n=s[o].capableResourceLinkPIDs;for(let s=0;s<n.length;s+=1){const o=t.getPrimaryCapableResourceFromLink(n[s]);e.is(o)&&!a.includes(o.resource)&&(a.push(o.resource),l.set(o.id,o.resource))}}const i=await c.getCapableResourceObjects(a);if(e.is(i)&&i.length>0){const a=new Map(i.map(e=>[e.physicalId,e]));for(let t=0;t<s.length;t+=1)if(e.is(s[t].capableResourceLinkPIDs)&&s[t].capableResourceLinkPIDs.length>0){const e=s[t].capableResourceLinkPIDs;s[t].capableResources=[];for(let o=0;o<e.length;o+=1)s[t].capableResources.push(a.get(l.get(e[o])))}}return s}})});