define("DS/3DWorkbook/js/views/WkbMainView",["UWA/Core","UWA/Class","DS/CoreEvents/ModelEvents","DS/Windows/DockingElement","DS/DataDragAndDrop/DataDragAndDrop","DS/3DWorkbook/js/WkbSwipeGesture"],function(i,e,n,t,o,s){"use strict";var r=!1,a=[];return e.extend({init:function(i){this.rightDocking=null,this.mainDiv=null,this.modelEvtManager=i.modelEvtManager||new n,this.ematrixURL=null,this.appURL=null,this.swipe=null,r=i.hideOperPanel},show:function(){this.mainDiv.show()},hide:function(){this.mainDiv.hide()},closeDetailsPanel:function(i){this.rightDocking.collapseDockingZoneFlag=!0},openDetailsPanel:function(i){this.rightDocking.collapseDockingZoneFlag=!1},closeNavPanel:function(i){this.leftDocking.collapseDockingZoneFlag=!0},openNavPanel:function(i){this.leftDocking.collapseDockingZoneFlag=!1},hideDropContainer:function(i){this.dropDiv.setStyle("display","none")},showDropContainer:function(){this.dropDiv.setStyle("display","flex")},_insertDragDropSystem:function(e,n){var t=this;this.dropDiv=i.createElement("div",{id:"wkbDragDrop",class:"blue_background_container"}),this.dropDiv.onmouseup=function(){t.hideDropContainer()},widget.onmouseup=function(){t.hideDropContainer()};var s=i.createElement("div",{id:"wkbDropBg",class:"background_container_display "}),r=i.createElement("div",{id:"wkbDropIcon",class:"drop_container_display fonticon fonticon-5x fonticon-drag-drop"});s.inject(this.dropDiv),r.inject(this.dropDiv),this.dropDiv.onclick=function(){t.hideDropContainer()},this.hideDropContainer(),this.dropDiv.inject(e),o.droppable(e,{counter:0,drop:function(i){n(i),t.hideDropContainer()},over:function(i,e){},enter:function(i,e){e.stopPropagation(),e.preventDefault(),this.counter++,t.showDropContainer(),console.log("drag enter on widget")},leave:function(i){this.counter--,console.log("drag leave on widget "+this.counter),0===this.counter&&t.hideDropContainer()}})},removeLeftDockingListener:function(e,n){i.is(this.leftDocking)&&this.leftDocking.removeEventListener(e,n)},addLeftDockingListener:function(e,n){i.is(this.leftDocking)&&this.leftDocking.addEventListener(e,n)},removeRightDockingListener:function(e,n){i.is(this.rightDocking)&&this.rightDocking.removeEventListener(e,n)},addRightDockingListener:function(e,n){i.is(this.rightDocking)&&this.rightDocking.addEventListener(e,n)},getProcessFlowDiv:function(){return this.processFlowDiv},buildWidget:function(e,n){this.mainDiv=i.createElement("div",{id:"wkbMainDiv",class:"wkbMainDiv"}),this.mainDiv.style.height="100%",this.processFlowDiv=i.createElement("div",{id:"",class:"processFlow"}),this.processFlowDiv.inject(this.mainDiv),this._insertDragDropSystem(this.mainDiv,n.onSelectedObjectsSearch);var o=.51*screen.width;i.is(n.hideOperPanel)&&(r=n.hideOperPanel);var c={useBordersFlag:!1,side:WUXDockAreaEnum.LeftDockArea,maxSize:o,minSize:320,dockingZoneSize:320,visibleDockingZoneFlag:!0,collapseDockingZoneFlag:r,dockingZoneContent:n.wkbNavPanel.getContainer()};this.leftDocking=new t(c),this.leftDocking.elements.dockingZone.style.overflow="hidden";var h={useBordersFlag:!1,side:WUXDockAreaEnum.RightDockArea,maxSize:o,minSize:320,dockingZoneSize:320,collapsibleFlag:!0,dockingZoneContent:n.wkbDetails};this.rightDocking=new t(h),this.rightDocking.elements.dockingZone.style.overflow="hidden";var l,D={useBordersFlag:!1,side:WUXDockAreaEnum.TopDockArea,maxSize:38,minSize:38,dockingZoneSize:38,collapsibleFlag:!1,dockingZoneContent:n.wkbHeader};(this.headerDocking=new t(D),this.headerDocking.freeZoneContent=n.wkb3DViewer.getContainer(),this.rightDocking.freeZoneContent=this.headerDocking,this.leftDocking.freeZoneContent=this.rightDocking,this.leftDocking.inject(this.mainDiv),widget.setBody(this.mainDiv),"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0)&&(this.swipe=new s({element:this.mainDiv,modelEvtManager:this.modelEvtManager,threshold:.8*this.leftDocking.elements.dockingZone.clientWidth}),l=this.modelEvtManager.subscribe({event:"WkbSwipeGesture-onRightZoneSwipeLeftCb"},()=>{this.openDetailsPanel()}),a.push(l),l=this.modelEvtManager.subscribe({event:"WkbSwipeGesture-onRightZoneSwipeRightCb"},()=>{this.closeDetailsPanel()}),a.push(l),l=this.modelEvtManager.subscribe({event:"WkbSwipeGesture-onLeftZoneSwipeLeftCb"},()=>{this.closeNavPanel()}),a.push(l),l=this.modelEvtManager.subscribe({event:"WkbSwipeGesture-onLeftZoneSwipeRightCb"},()=>{this.openNavPanel()}),a.push(l))},destroy:function(){i.is(this.swipe)&&(a.forEach(i=>{this.modelEvtManager.unsubscribe(i)}),a=[],this.swipe.destroy(),this.swipe=null),i.is(this.processFlowDiv)&&(this.processFlowDiv.destroy(),this.processFlowDiv=null),i.is(this.mainDiv)&&(o.clean(this.mainDiv),i.is(this.dropDiv)&&(this.dropDiv.onmouseup=null,this.dropDiv.onclick=null,this.mainDiv.removeChild(this.dropDiv),this.dropDiv.destroy(),this.dropDiv=null)),i.is(this.leftDocking)&&(this.leftDocking.destroy(),this.leftDocking=null),i.is(this.rightDocking)&&(this.rightDocking.destroy(),this.rightDocking=null),i.is(this.headerDocking)&&(this.headerDocking.destroy(),this.headerDocking=null)}})});