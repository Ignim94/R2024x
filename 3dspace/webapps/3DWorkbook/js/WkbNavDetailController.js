define("DS/3DWorkbook/js/WkbNavDetailController",["UWA/Core","UWA/Class"],function(e,t){"use strict";var i=!1,n=0,s=0,a=0,r=null,o=null,c=null,h=0,l=0,d=1,u=2,g=3,f=4,C=6,m=7,b=8,v="ibInstructions",k="ibParts",P="ibTools";return t.singleton({init:function(e){o=e.modelEvtManager,this._addEventListeners(o),h=d},setDetailsPanel:function(e){c=e},getNavMode:function(){return h},disableNav:function(){i=!1},clearPrehighlight:function(t,i){e.is(t)||(t=document.querySelectorAll(i)),t.forEach(e=>e.classList.remove("prehighlight"))},clearInstructionPrehighlight:function(e){this.clearPrehighlight(e,".MainInstructionList .wkiItem")},clearDCItemsPrehighlight:function(e){this.clearPrehighlight(e,".DataCollectLists .wkiItem")},clearPartPrehighlight:function(e){this.clearPrehighlight(e,".mainPartList .wkbDetailsCard")},clearToolPrehighlight:function(e){this.clearPrehighlight(e,".mainToolList .wkbDetailsCard")},clearSecToolPrehighlight:function(e){this.clearPrehighlight(e,".secondaryToolsList .wkbDetailsCard")},clearMfgKitPrehighlight:function(e){this.clearPrehighlight(e,"div.mfgKitChildList .wkbDetailsCard")},cardPrehighlight:function(e){this.clearPrehighlight(r),r[e].classList.add("prehighlight"),r[e].scrollIntoView(!1),c.flashBorder(r[e]),n=e},nextCardPrehighlight:function(){const e=n+1;e<r.length&&this.cardPrehighlight(e)},previousCardPrehighlight:function(){const e=n-1;e<r.length&&e>-1&&this.cardPrehighlight(e)},_getDCCardList:function(){return document.querySelectorAll('.DataCollectLists .dcPlanChildItems[style=""]  .dcPlanChildItem.wkiItem')},_getInstructionCardList:function(){return document.querySelectorAll(".MainInstructionList .wkiItem")},_getToolCardList:function(){return document.querySelectorAll(".OperChildList .mainToolList .wkbDetailsCard")},_getSecToolCardList:function(){return document.querySelectorAll('.secondaryToolsList .secCapResource[style=""] .toolItem')},_getPartCardList:function(){return document.querySelectorAll(".mainPartList .wkbDetailsCard")},_getMfgKitCardList:function(){return document.querySelectorAll('.OperChildList .mfgKitChildList[style=""] .partItem')},changeNavMode:function(e){switch(e){case d:{this.clearPrehighlight(r);const t=this.enabledMenus[this.menuIndex].id;c.selectOperIconBarItem(t),e!==h&&(l=h);break}case C:l=h,s=n,n=-1,r=this._getDCCardList();break;case u:h===C&&(n=s),r=(e=h!==d||l!==u&&l!==C?u:l)===u?this._getInstructionCardList():this._getDCCardList();break;case b:l=h,s=n,n=-1,r=this._getMfgKitCardList();break;case g:h===b&&(n=0),r=(e=h!==d||l!==g&&l!==b?g:l)===g?this._getPartCardList():this._getMfgKitCardList();break;case m:l=h,s=n,n=-1,r=this._getSecToolCardList();break;case f:h===m&&(n=a),r=(e=h!==d||l!==f&&l!==m?f:l)===f?this._getToolCardList():this._getSecToolCardList()}h=e},reset:function(){h=0,r=null,n=-1,l=0,s=-1,a=-1},beginNav:function(){if(this.enabledMenus=c.getEnabledOperMenuItems(),h=d,!(this.enabledMenus.length>0))return h=0,void this.endNav();e.is(this.menuIndex)||(this.menuIndex=0),this.changeNavMode(d),setTimeout(function(){i=!0},500)},endNav:function(e){i=!1,e||o.publish({event:"WkbNavDetailController-Done",data:{}})},_selectDCPlanExpand:function(){const t=r[n].getElementsByClassName("wkb-nav-arrow");e.is(t)&&0!==t.length&&t[0].click()},nextMenuItem:function(){const e=this.enabledMenus.length,t=this.menuIndex+1;if(0===e||t>=e)return;const i=this.enabledMenus[t].id;c.selectOperIconBarItem(i),this.menuIndex=t,n=-1},previousMenuItem:function(){const e=this.enabledMenus.length,t=this.menuIndex-1;if(0===e||t<0)return;const i=this.enabledMenus[t].id;c.selectOperIconBarItem(i),this.menuIndex=t,n=-1},navDCItemsToInstructions:function(){const t=document.querySelector(".wkb-dcplanchild-menu");e.is(t)&&t.click()},navSecondaryToMainTools:function(){const t=document.querySelector(".OperChildList .wkb-toolchild-menu");e.is(t)&&t.click()},navMfgKitToMainParts:function(){const t=document.querySelector(".OperChildList .PartList .secChildHeader .wkb-childList-menu");e.is(t)&&t.click()},_moveToToolSecondary:function(e){a=n,e.click()},onEnterKey:function(e){switch(h){case u:c.selectInstructionCard(n);break;case g:c.selectPartCard(n);break;case b:c.selectMfgKitCard(n);break;case f:c.selectToolCard(n);break;case m:c.selectSecondaryToolCard(n);break;case C:c.selectDCCard(n)}},onUpArrow:function(e){switch(h){case b:case g:if(n<1)return this.clearPartPrehighlight(),void this.changeNavMode(d);this.previousCardPrehighlight();break;case f:case m:if(n<1)return this.clearToolPrehighlight(),void this.changeNavMode(d);this.previousCardPrehighlight();break;case C:case u:if(n<1)return this.clearInstructionPrehighlight(),void this.changeNavMode(d);this.previousCardPrehighlight()}},onDownArrow:function(e){if(h===d)switch(n=-1,this.enabledMenus[this.menuIndex].id){case v:this.changeNavMode(u);break;case k:this.changeNavMode(g);break;case P:this.changeNavMode(f)}switch(h){case b:case g:case f:case m:case C:case u:this.nextCardPrehighlight()}},onLeftArrow:function(){switch(h){case d:0===this.menuIndex?this.endNav():this.previousMenuItem();break;case C:this.clearDCItemsPrehighlight(r),this.navDCItemsToInstructions(),this.changeNavMode(u);break;case m:this.clearSecToolPrehighlight(r),this.navSecondaryToMainTools(),this.changeNavMode(f);break;case b:this.clearMfgKitPrehighlight(r),this.navMfgKitToMainParts(),this.changeNavMode(g);break;default:this.endNav()}},onRightArrow:function(){var t=null;switch(h){case d:this.nextMenuItem();break;case u:r[n].classList.contains("dcItem")&&(this._selectDCPlanExpand(),this.changeNavMode(C));break;case f:if(t=r[n].getElementsByClassName("wkb-nav-arrow"),e.is(t)&&t.length>0)return t=t[0],this._moveToToolSecondary(t),void this.changeNavMode(m);break;case g:if(t=r[n].getElementsByClassName("wkb-nav-arrow"),e.is(t)&&t.length>0)return t=t[0],this._moveToToolSecondary(t),void this.changeNavMode(b)}},onKeyDown:function(e){if(i)switch(e.keyCode){case 13:this.onEnterKey(e);break;case 37:this.onLeftArrow();break;case 38:this.onUpArrow(e);break;case 39:this.onRightArrow();break;case 40:this.onDownArrow(e)}},_addEventListeners:function(e){document.addEventListener("keydown",this.onKeyDown.bind(this))}})});