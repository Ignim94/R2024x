/*!  COPYRIGHT DASSAULT SYSTEMES 2015   */
function PowerByHome(e){"use strict";var t={widget:null,powerByApp:null,homeWebInWinOpts:{widget:null,action_bar_opts:null,layout:{}},init:function(e){this.widget=e.widget,this.widget.addEvent("onLoad",this.onLoad.bind(this)),this.widget.addEvent("onRefresh",this.onRefresh.bind(this)),this.widget.addEvent("onSearch",this.onSearch.bind(this)),this.widget.addEvent("onResetSearch",this.onResetSearch.bind(this))},onLoad:function(){var e=this;e.widget.setValue("tenantAware",!1);var t=e.widget.getUrl().search("[?&]devmode=1")>0;require(["DS/PADUtils/PADWebInWinServices","DS/PADUtils/PADSettingsMgt","DS/PADCommands/PADModelEvents","text!DS/PowerByHome/assets/PowerByHome_settings.json"],function(n,o,i,s){n.initialize(e.widget);var a=JSON.parse(s);o.setApp(a.padsettings,"pswebinwin",!0),t||n.isWebInWinContext()||!o.getSetting("activateWebView")?require(["UWA/Core","UWA/Utils/Client","DS/PowerByHome/utils/PowerBySettings","DS/PowerByHome/PowerByWebInWinProxy","DS/PADUtils/views/PADAlert","DS/PowerByHome/HomeComponent","DS/PlatformAPI/PlatformAPI","DS/ENOXCADUtils/utils/XCADModelEvents","DS/PADUtils/PADContext","DS/Menu/Menu"],function(t,n,s,r,l,c,d,u,p,m){if(null===e.powerByApp){var h=e.homeWebInWinOpts;h.widget=e.widget,h.lang=e.widget.lang,o.setSetting("lang",e.widget.lang),h.action_bar_opts=n.Features.touchEvents&&!n.Features.pointerEvents?a.action_bar.touch:a.action_bar.standard,h.action_bar_opts.language=e.widget.lang,h.active_view="treelistview",h.layout.propertiesFacet=o.getSetting("propertiesFacet"),i.subscribe({event:"HomeComponent/Ready"},function(t){e.powerByApp=t,e.widget.setBody(e.powerByApp.render());var n={add:{direction:["toWeb"],formatIn_toWeb:{operation:"add",operationVersion:"1.0",content:[]},formatOut_toWeb:{content:[]},callback_toWeb_name:"addFromWin",callback_toWeb_fn:function(e){i.publish({event:"PowerByTreeDocument/initContentFromSession",data:e.content})}},removeRoot:{direction:["toWeb"],formatIn_toWeb:{operation:"removeRoot",operationVersion:"1.0",content:[]},formatOut_toWeb:{content:[]},callback_toWeb_name:"removeRootFromWin",callback_toWeb_fn:function(e){i.publish({event:"PowerByTreeDocument/removeRootFromSession",data:e.content})}},setTitle:{direction:["toWeb"],formatIn_toWeb:{operation:"setTitle",operationVersion:"1.0",content:{}},formatOut_toWeb:{content:{}},callback_toWeb_name:"setTitleFromWin",callback_toWeb_fn:function(e){i.publish({event:"PowerByTreeDocument/setTitle",data:e.content})}},updateSecurityContext:{direction:["toWeb"],formatIn_toWeb:{operation:"updateSecurityContext",operationVersion:"1.0",content:{}},formatOut_toWeb:{content:{}},callback_toWeb_name:"updateSecurityContextFromWin",callback_toWeb_fn:function(e){i.publish({event:"PowerByTreeDocument/updateSecurityContext",data:e.content})}},updateNodes:{direction:["toWeb"],formatIn_toWeb:{operation:"updateNodes",operationVersion:"1.0",content:[]},formatOut_toWeb:{content:[]},callback_toWeb_name:"updateNodesFromWin",callback_toWeb_fn:function(e){i.publish({event:"PowerByTreeDocument/updateNodes",data:e.content})}},saveSession:{direction:["toWin"],formatIn_toWin:{content:{pids:[]}},formatOut_toWin:{operation:"saveSession",operationVersion:"1.0",content:{context:"PowerByHome"}},callback_toWin_name:"saveSession"},batchSave:{direction:["toWin"],formatIn_toWin:{content:{pids:[]}},formatOut_toWin:{operation:"batchSave",operationVersion:"1.0",content:{context:"PowerByHome"}},callback_toWin_name:"batchSave"},share:{direction:["toWin"],formatIn_toWin:{content:{cadidPaths:[]}},formatOut_toWin:{operation:"share",operationVersion:"1.0",content:{cadidPaths:[]}},callback_toWin_name:"share"},newFromTemplateForREVIT:{direction:["toWin"],formatIn_toWin:{content:{pids:[]}},formatOut_toWin:{operation:"newFromTemplateForREVIT",operationVersion:"1.0",content:{context:"PowerByHome"}},callback_toWin_name:"newFromTemplateForREVIT"},manageLocalCache:{direction:["toWin"],formatIn_toWin:{content:{pids:[]}},formatOut_toWin:{operation:"manageLocalCache",operationVersion:"1.0",content:{context:"PowerByHome"}},callback_toWin_name:"manageLocalCache"},saveWorkInProgressDesigns:{direction:["toWin"],formatIn_toWin:{content:{pids:[]}},formatOut_toWin:{operation:"saveWorkInProgressDesigns",operationVersion:"1.0",content:{context:"PowerByHome"}},callback_toWin_name:"saveWorkInProgressDesigns"},saveSessionAsNew:{direction:["toWin"],formatIn_toWin:{content:{pids:[]}},formatOut_toWin:{operation:"saveSessionAsNew",operationVersion:"1.0",content:{context:"PowerByHome"}},callback_toWin_name:"saveSessionAsNew"},shareAsPicture:{direction:["toWin"],formatIn_toWin:{content:{pids:[]}},formatOut_toWin:{operation:"shareAsPicture",operationVersion:"1.0",content:{context:"PowerByHome"}},callback_toWin_name:"shareAsPicture"},shareAs3D:{direction:["toWin"],formatIn_toWin:{content:{pids:[]}},formatOut_toWin:{operation:"shareAs3D",operationVersion:"1.0",content:{context:"PowerByHome"}},callback_toWin_name:"shareAs3D"},createStructuralSimulation:{direction:["toWin"],formatIn_toWin:{content:{pids:[]}},formatOut_toWin:{operation:"createStructuralSimulation",operationVersion:"1.0",content:{context:"PowerByHome"}},callback_toWin_name:"createStructuralSimulation"},showProperties:{direction:["toWin"],formatIn_toWin:{content:{cadidPaths:[]}},formatOut_toWin:{operation:"showProperties",operationVersion:"1.0",content:{cadidPaths:[]}},callback_toWin_name:"showProperties"},save:{direction:["toWin"],formatIn_toWin:{content:{cadidPaths:[]}},formatOut_toWin:{operation:"save",operationVersion:"1.0",content:{cadidPaths:[]}},callback_toWin_name:"save"},saveAsNew:{direction:["toWin"],formatIn_toWin:{content:{cadidPaths:[]}},formatOut_toWin:{operation:"saveAsNew",operationVersion:"1.0",content:{cadidPaths:[]}},callback_toWin_name:"saveAsNew"},saveWithOptions:{direction:["toWin"],formatIn_toWin:{content:{cadidPaths:[]}},formatOut_toWin:{operation:"saveWithOptions",operationVersion:"1.0",content:{cadidPaths:[]}},callback_toWin_name:"saveWithOptions"},rename:{direction:["toWin"],formatIn_toWin:{content:{cadidPaths:[]}},formatOut_toWin:{operation:"rename",operationVersion:"1.0",content:{cadidPaths:[]}},callback_toWin_name:"rename"},options:{direction:["toWin"],formatIn_toWin:{content:{}},formatOut_toWin:{operation:"options",operationVersion:"1.0",content:{}},callback_toWin_name:"options"},openWebInWin:{direction:["toWin"],formatIn_toWin:{content:{}},formatOut_toWin:{operation:"openWebInWin",operationVersion:"1.0",content:{}},callback_toWin_name:"openWebInWin"},manageLocalFiles:{direction:["toWin"],formatIn_toWin:{content:{}},formatOut_toWin:{operation:"manageLocalFiles",operationVersion:"1.0",content:{}},callback_toWin_name:"manageLocalFiles"},insertUnderActiveDocument:{direction:["toWin"],formatIn_toWin:{content:{}},formatOut_toWin:{operation:"insertUnderActiveDocument",operationVersion:"1.0",content:{}},callback_toWin_name:"insertUnderActiveDocument"},getAttributesForAll:{direction:["toWin"],formatIn_toWin:{content:{}},formatOut_toWin:{operation:"getAttributesForAll",operationVersion:"1.0",content:{}},callback_toWin_name:"getAttributesForAll"},setContext:{direction:["toWin"],formatIn_toWin:{content:{context:""}},formatOut_toWin:{operation:"setContext",operationVersion:"1.0",content:{}},callback_toWin_name:"setContext"},setWorkUnder:{direction:["toWin"],formatIn_toWin:{content:{context:""}},formatOut_toWin:{operation:"setWorkUnder",operationVersion:"1.0",content:{}},callback_toWin_name:"setWorkUnder"},updateSecCtxtResponse:{direction:["toWin"],formatIn_toWin:{content:{context:""}},formatOut_toWin:{operation:"updateSecCtxtResponse",operationVersion:"1.0",content:{}},callback_toWin_name:"updateSecCtxtResponse"},saveCGR:{direction:["toWin"],formatIn_toWin:{content:{cadidPaths:[]}},formatOut_toWin:{operation:"saveCGR",operationVersion:"1.0",content:{cadidPaths:[]}},callback_toWin_name:"saveCGR"},getRevision:{direction:["toWin"],formatIn_toWin:{content:{cadidPaths:[]}},formatOut_toWin:{operation:"getRevision",operationVersion:"1.0",content:{cadidPaths:[]}},callback_toWin_name:"getRevision"},replaceByRevision:{direction:["toWin"],formatIn_toWin:{content:{cadidPaths:[]}},formatOut_toWin:{operation:"replaceByRevision",operationVersion:"1.0",content:{cadidPaths:[]}},callback_toWin_name:"replaceByRevision"},replaceByLatestRevision:{direction:["toWin"],formatIn_toWin:{content:{cadidPaths:[]}},formatOut_toWin:{operation:"replaceByLatestRevision",operationVersion:"1.0",content:{cadidPaths:[]}},callback_toWin_name:"replaceByLatestRevision"},updateRevisions:{direction:["toWin"],formatIn_toWin:{content:{cadidPaths:[]}},formatOut_toWin:{operation:"updateRevisions",operationVersion:"1.0",content:{cadidPaths:[]}},callback_toWin_name:"updateRevisions"},revisions:{direction:["toWin"],formatIn_toWin:{content:{cadidPaths:[]}},formatOut_toWin:{operation:"revisions",operationVersion:"1.0",content:{cadidPaths:[]}},callback_toWin_name:"revisions"},reloadFromServer:{direction:["toWin"],formatIn_toWin:{content:{cadidPaths:[]}},formatOut_toWin:{operation:"reloadFromServer",operationVersion:"1.0",content:{cadidPaths:[]}},callback_toWin_name:"reloadFromServer"},refreshHome:{direction:["toWin"],formatIn_toWin:{content:{pids:[]}},formatOut_toWin:{operation:"refresh",operationVersion:"1.0",content:{context:"PowerByHome"}},callback_toWin_name:"refreshHome"},reserve:{direction:["toWin"],formatIn_toWin:{content:{cadidPaths:[]}},formatOut_toWin:{operation:"reserve",operationVersion:"1.0",content:{cadidPaths:[]}},callback_toWin_name:"reserve"},unreserve:{direction:["toWin"],formatIn_toWin:{content:{cadidPaths:[]}},formatOut_toWin:{operation:"unreserve",operationVersion:"1.0",content:{cadidPaths:[]}},callback_toWin_name:"unreserve"},maturity:{direction:["toWin"],formatIn_toWin:{content:{cadidPaths:[]}},formatOut_toWin:{operation:"maturity",operationVersion:"1.0",content:{cadidPaths:[]}},callback_toWin_name:"maturity"},reload:{direction:["toWin"],formatIn_toWin:{content:{pids:[]}},formatOut_toWin:{operation:"reload",operationVersion:"1.0",content:{pids:[]}},callback_toWin_name:"reload"},pageReady:{direction:["toWin"],formatIn_toWin:{content:{}},formatOut_toWin:{operation:"pageReady",operationVersion:"1.0",content:{context:"PowerByHome"}},callback_toWin_name:"pageReady"},init:{direction:["toWeb"],formatIn_toWeb:{operation:"init",operationVersion:"1.0",content:{JSONSchema:{}}},formatOut_toWeb:{content:[]},callback_toWeb_name:"initFromWin",callback_toWeb_fn:function(e){i.publish({event:"HomeComponent/initCusto",data:e.content})}},displayNotification:{direction:["toWeb"],formatIn_toWeb:{operation:"displayNotification",operationVersion:"1.0",content:{}},formatOut_toWeb:{content:[]},callback_toWeb_name:"displayNotificationFromWin",callback_toWeb_fn:function(e){UWA.is(e.content,"object")&&UWA.is(e.content.eventID,"string")&&UWA.is(e.content.msg,"string")&&l.displayNotification(e.content)}},readyForInit:{direction:["toWin"],formatIn_toWin:{content:{}},formatOut_toWin:{operation:"readyForInit",operationVersion:"1.0",content:{context:"PowerByHome",lang:o.getSetting("lang")}},callback_toWin_name:"readyForInit"},setCA:{direction:["toWeb"],formatIn_toWeb:{operation:"setCA",operationVersion:"1.0",content:{JSONSchema:{}}},formatOut_toWeb:{content:[]},callback_toWeb_name:"setCAFromWin",callback_toWeb_fn:function(e){i.publish({event:"HomeComponent/setCA",data:e.content})}},columnValue:{direction:["toWeb"],formatIn_toWeb:{operation:"columnValue",operationVersion:"1.0",content:{JSONSchema:{}}},formatOut_toWeb:{content:[]},callback_toWeb_name:"columnValueFromWin",callback_toWeb_fn:function(e){i.publish({event:"PowerByTreeDocument/columnValue",data:e.content})}},showColumn:{direction:["toWeb"],formatIn_toWeb:{operation:"showColumn",operationVersion:"1.0",content:{}},formatOut_toWeb:{content:[]},callback_toWeb_name:"showColumnFromWin",callback_toWeb_fn:function(e){i.publish({event:"PowerByTreeListView/showColumn",data:e.content})}},hideColumn:{direction:["toWeb"],formatIn_toWeb:{operation:"hideColumn",operationVersion:"1.0",content:{}},formatOut_toWeb:{content:[]},callback_toWeb_name:"hideColumnFromWin",callback_toWeb_fn:function(e){i.publish({event:"PowerByTreeListView/hideColumn",data:e.content})}},removeCA:{direction:["toWin","toWeb"],formatIn_toWin:{operation:"removeCA",operationVersion:"1.0",content:{}},formatOut_toWin:{operation:"removeCA",operationVersion:"1.0",content:{}},callback_toWin_name:"removeCA",callback_toWeb_name:"removeCAFromWin",callback_toWeb_fn:function(e){i.publish({event:"HomeComponent/disableCA",data:e.content})}},toggleActiveCA:{direction:["toWin"],formatIn_toWin:{content:{}},formatOut_toWin:{operation:"toggleActiveCA",operationVersion:"1.0",content:{}},callback_toWin_name:"toggleActiveCA"},toggleDeActiveCA:{direction:["toWin"],formatIn_toWin:{content:{}},formatOut_toWin:{operation:"toggleDeActiveCA",operationVersion:"1.0",content:{}},callback_toWin_name:"toggleDeActiveCA"},changeCA:{direction:["toWin"],formatIn_toWin:{content:{}},formatOut_toWin:{operation:"changeCA",operationVersion:"1.0",content:{}},callback_toWin_name:"changeCA"},replaceContent:{direction:["toWin"],formatIn_toWin:{content:{cadidPaths:[]}},formatOut_toWin:{operation:"replaceContent",operationVersion:"1.0",content:{cadidPaths:[]}},callback_toWin_name:"replaceContent"},replaceSelectedOccurrence:{direction:["toWin"],formatIn_toWin:{content:{cadidPaths:[]}},formatOut_toWin:{operation:"replaceSelectedOccurrence",operationVersion:"1.0",content:{cadidPaths:[]}},callback_toWin_name:"replaceSelectedOccurrence"},replaceAllOccurrences:{direction:["toWin"],formatIn_toWin:{content:{cadidPaths:[]}},formatOut_toWin:{operation:"replaceAllOccurrences",operationVersion:"1.0",content:{cadidPaths:[]}},callback_toWin_name:"replaceAllOccurrences"},getAttributesForSelected:{direction:["toWin"],formatIn_toWin:{content:{cadidPaths:[]}},formatOut_toWin:{operation:"getAttributesForSelected",operationVersion:"1.0",content:{cadidPaths:[]}},callback_toWin_name:"getAttributesForSelected"},columnValueResult:{direction:["toWin"],formatIn_toWin:{content:[]},formatOut_toWin:{operation:"columnValueResult",operationVersion:"1.0",content:[]},callback_toWin_name:"columnValueResult"}};r.setupEventHandler(n),i.publish({event:"readyForInit"})}),i.subscribe({event:"HomeComponent/readyToBuildViews"},function(){i.publish({event:"HomeComponent/buildViews"})}),i.subscribe({event:"HomeComponent/pageReady"},function(){i.publish({event:"pageReady"})}),u.subscribe({event:"ENOXCAD-PowerByHome/ToWin"},function(e){d.publish("webinwin:web:notification",JSON.stringify(e))}),d.subscribe("webinwin:win:notification",function(e){var t=UWA.is(e,"string")?JSON.parse(e):e;if(null!=t.data&&null!=t.data.tokenid&&"ENOXCAD"===t.data.tokenid)switch(t.operation){case"openCADExport":u.publish({event:"XCADExchangeExportCmd/LaunchExport"});break;default:u.publish({event:"PowerByHome/ToWeb-ENOXCAD",data:t})}else require(["DS/PowerByHome/PowerByWebInWinProxy"],function(e){var n=t.operation+"FromWin";e[n]&&("select"!==t.operation&&"add"!==t.operation&&"removeRoot"!==t.operation||m.hide(),e[n](t))})}),new c(h)}}):require(["DS/PowerByHome/views/PowerByWebView"],function(t){new t({callback:function(){e.widget.setBody(this.render()),this.show(),i.publish({event:"pageReady"})}})})})},onRefresh:function(){require("DS/PADCommands/PADModelEvents").publish({event:"HomeComponent/refreshHome"})},onSearch:function(e){require("DS/PADCommands/PADModelEvents").publish({event:"PowerByHome:HomeComponent:onSearch",data:e})},onResetSearch:function(){require("DS/PADCommands/PADModelEvents").publish({event:"PowerByHome:HomeComponent:onResetSearch"})}};return t.init(e),t}define("DS/PowerByHome/commands/SwitchReservationCmd",["UWA/Core","DS/ApplicationFrame/Command","DS/PADUtils/PADContext","DS/PADCommands/PADModelEvents"],function(e,t,n,o){"use strict";return t.extend({init:function(e){this._parent(e),this._check_select(),n.get().options.model.getXSO().onChange(this._check_select.bind(this))},_check_select:function(){if(!0===!!n.get().options.model.getXSO().get().length)if(widget.getValue("requireResourceidCommands").includes(this.options.ID)){for(var e=!0,t=n.get().options.model.getXSO().get(),o=0;o<t.length;o++){if(!t[o].getID()){e=!1;break}}e?this.enable():this.disable()}else this.enable();else this.disable()},execute:function(){var e=n.get().getPADTreeDocument()._buildSelectData();switch(this._arguments[0].ID){case"Reserve":o.publish({event:"reserve",data:{cadidPaths:e.cadidPaths}});break;case"Unreserve":o.publish({event:"unreserve",data:{cadidPaths:e.cadidPaths}})}}})}),define("DS/PowerByHome/commands/SaveSession",["UWA/Core","DS/ApplicationFrame/Command","DS/PADCommands/PADModelEvents"],function(e,t,n){"use strict";return t.extend({init:function(e){var t=this;this._parent(e),this.disable(),n.subscribe({event:"PADCommand/RootVisibilityChange"},function(e){for(var n=[],o=0;o<e.availableRoots.length;o++){var i=e.availableRoots[o].search({match:function(e){return"sessionNotModified"!==e.nodeModel.options.grid.sessionStatus}},[]);n.push.apply(n,i)}0===n.length?t.disable():t.enable()})},execute:function(){n.publish({event:"saveSession",data:{columns:this.options.columns}})}})}),define("DS/PowerByHome/mixins/PowerByKeyboardInputs",["UWA/Core","UWA/Class","UWA/Event","DS/ApplicationFrame/CommandsManager"],function(e,t,n,o){"use strict";return t.extend({_component:null,init:function(e){this._parent(e),this._component=e.component,this._onKeyDown_binded=this._onKeyDown.bind(this)},startObservingKeyboard:function(t){e.Element.addEvent.call(document,"keydown",this._onKeyDown_binded)},_onKeyDown:function(e){var t,i,s=n.whichKey(e);switch(s){case"ctrl+a":t="SelectAll",(i=o.getCommand(t))&&i.isEnabled()&&(i.begin(),n.stop(e))}}})}),define("DS/PowerByHome/commands/ReloadFromServer",["DS/ApplicationFrame/Command","DS/PADCommands/PADModelEvents","DS/PADUtils/PADContext"],function(e,t,n){"use strict";return e.extend({init:function(e){this._parent(e),this._checkSelection(),n.get().options.model.getXSO().onChange(this._checkSelection.bind(this))},_checkSelection:function(){if(!0===!!n.get().options.model.getXSO().get().length)if(widget.getValue("requireResourceidCommands").includes(this.options.ID)){for(var e=!0,t=n.get().options.model.getXSO().get(),o=0;o<t.length;o++){if(!t[o].getID()){e=!1;break}}e?this.enable():this.disable()}else this.enable();else this.disable()},execute:function(){var e=n.get().getPADTreeDocument()._buildSelectData();t.publish({event:"reloadFromServer",data:{cadidPaths:e.cadidPaths}})}})}),define("DS/PowerByHome/commands/NewFromTemplateForREVIT",["UWA/Core","DS/ApplicationFrame/Command","DS/PADUtils/PADContext","DS/PADCommands/PADModelEvents"],function(e,t,n,o){"use strict";return t.extend({init:function(e){this._parent(e)},execute:function(){o.publish({event:"newFromTemplateForREVIT",data:{}})}})}),define("DS/PowerByHome/commands/ManageLocalCache",["DS/ApplicationFrame/Command","DS/PADCommands/PADModelEvents"],function(e,t){"use strict";return e.extend({init:function(e){this._parent(e)},execute:function(){t.publish({event:"manageLocalCache",data:{}})}})}),define("DS/PowerByHome/commands/Rename",["UWA/Core","DS/ApplicationFrame/Command","DS/PADUtils/PADContext","DS/PADCommands/PADModelEvents"],function(e,t,n,o){"use strict";return t.extend({init:function(e){this._parent(e),this._check_select(),n.get().options.model.getXSO().onChange(this._check_select.bind(this))},_check_select:function(){!0===!!n.get().options.model.getXSO().get().length?this.enable():this.disable()},execute:function(){var e=n.get().getPADTreeDocument()._buildSelectData();o.publish({event:"rename",data:{cadidPaths:e.cadidPaths}})}})}),define("DS/PowerByHome/commands/GetAttributesForSelected",["UWA/Core","DS/ApplicationFrame/Command","DS/PADUtils/PADContext","DS/PADCommands/PADModelEvents"],function(e,t,n,o){"use strict";return t.extend({init:function(e){this._parent(e),this._check_select(),n.get().options.model.getXSO().onChange(this._check_select.bind(this))},_check_select:function(){!0===!!n.get().options.model.getXSO().get().length?this.enable():this.disable()},execute:function(){var e=n.get().getPADTreeDocument()._buildSelectData();o.publish({event:"getAttributesForSelected",data:{cadidPaths:e.cadidPaths}})}})}),define("DS/PowerByHome/commands/RelationalIPExplorerCmd",["DS/ApplicationFrame/Command","DS/PADCommands/PADModelEvents","DS/PADUtils/PADContext"],function(e,t,n){"use strict";return e.extend({init:function(e){this._parent(e),this._checkSelection(),n.get().options.model.getXSO().onChange(this._checkSelection.bind(this))},_checkSelection:function(){for(var e=!1,t=n.get().options.model.getXSO().get(),o=0;o<t.length;o++)if("sessionCreated"!==t[o]._options.grid.sessionStatus){e=!0;break}!0===e?this.enable():this.disable()},execute:function(){require(["DS/PADUtils/PADUtilsServices","i18n!DS/PADUtils/assets/nls/PADUtils.json"],function(e,t){e.setObject_on_compass({nodes_2_open:n.get().getPADTreeDocument().getSelectedNodes()}),e.open_app({appId:"ENORIPE_AP"},function(e){})})}})}),define("DS/PowerByHome/commands/ReplaceByRevision",["DS/ApplicationFrame/Command","DS/PADCommands/PADModelEvents","DS/PADUtils/PADContext"],function(e,t,n){"use strict";return e.extend({init:function(e){this._parent(e),this._checkSelection(),n.get().options.model.getXSO().onChange(this._checkSelection.bind(this))},_checkSelection:function(){if(!0===!!n.get().options.model.getXSO().get().length)if(widget.getValue("requireResourceidCommands").includes(this.options.ID)){for(var e=!0,t=n.get().options.model.getXSO().get(),o=0;o<t.length;o++){if(!t[o].getID()){e=!1;break}}e?this.enable():this.disable()}else this.enable();else this.disable()},execute:function(){var e=n.get().getPADTreeDocument()._buildSelectData();t.publish({event:"replaceByRevision",data:{cadidPaths:e.cadidPaths}})}})}),define("DS/PowerByHome/utils/PowerBySettings",["UWA/Class","DS/WAFData/WAFData","DS/WebappsUtils/WebappsUtils","DS/PADUtils/PADSettingsMgt"],function(e,t,n,o){"use strict";var i={},s=null,a=[],r=null,l=["bi_color","selection","hide_show","find_in_ctx","instanceName","instanceMatrix","ds6w:cadMaster","thumbnail"];function c(e){if((null===s||!0===e)&&(i.defaultAttributes&&!0===o.getSetting("columnParametrization")?(s={tree:"",available_columns:[],columns4BI:[]},i.defaultAttributes.forEach(function(e){var t=e.name.split("/");e.name=t[t.length-1],!0===e.tree?s.tree=e.name:s.available_columns.push(e.name),!0!==e.hardcoded&&(o.options.webapi_options.fetch.select_predicate.push(e.name),o.options.webapi_options.navigate.select_bo.push(e.name))})):i.available_attr&&(s={tree:"",available_columns:[],columns4BI:[]},i.available_attr.forEach(function(e){var t=e.name.split("/");e.name=t[t.length-1],!0===e.tree?s.tree=e.name:s.available_columns.push(e.name),o.options.webapi_options.fetch.select_predicate.push(e.name),"select_ds6w_facet"===e.cv_type&&(e.cv_type="select_bo"),e.cv_type?o.options.webapi_options.navigate[e.cv_type].push(e.name):"svg"!==e.name&&o.options.webapi_options.navigate.select_bo.push(e.name)})),i.columnDefinition&&(s={tree:"",available_columns:[],columns4BI:[]},r={},i.columnDefinition.forEach(function(e){e.ds6w?(r[e.ds6w]=e.dataIndex,"tree"===e.dataIndex?s.tree=e.ds6w:s.available_columns.push(e.ds6w),o.options.webapi_options.fetch.select_predicate.push(e.ds6w)):s.available_columns.push(e.dataIndex)})),a.length))for(var t=0;t<a.length;t++)-1===s.available_columns.indexOf(a[t])&&s.available_columns.push(s.available_columns,a[t])}var d=e.singleton({loadSettingsSync:function(e){i=e,c()},loadSettings:function(e){var o=n.getWebappsAssetUrl(e.module,e.file);t.request(o,{onComplete:function(t){var n=UWA.is(t,"string")?JSON.parse(t):t;i=n.view_settings?n.view_settings:n,c(),e.onComplete()}})},setAvailableAttr:function(e,t){i.available_attr=e,c(t)},getSetting:function(e){return i[e]},getAvailableColumns:function(){return s},addAsyncAttributes:function(e){if(s)for(var t=0;t<e.length;t++)-1===s.available_columns.indexOf(e[t])&&s.available_columns.push(s.available_columns,e[t]);a.push.apply(a,e)},getAdditionalColumns:function(){return a},addAvailableColumn:function(e,t,n){if(s&&s.available_columns&&(s.available_columns.push(e),t)){"instanceMatrix"!==e?(o.options.webapi_options.fetch.select_predicate.push(e),o.options.webapi_options.navigate.select_bo.push(e)):(o.options.webapi_options.fetch.select_predicate.push("matrixtxt"),o.options.webapi_options.navigate.select_bo.push("matrixtxt"));var i=o.getSetting("filterNls");i.push(e),o.setSetting("filterNls",i),n&&s.columns4BI.push(e)}},removeAvailableColumn:function(e){if(s&&s.available_columns&&-1!==s.available_columns.indexOf(e)){s.available_columns.splice(s.available_columns.indexOf(e),1);var t=o.options.webapi_options.fetch.select_predicate.indexOf(e),n=o.options.webapi_options.navigate.select_bo.indexOf(e);-1!==t&&o.options.webapi_options.fetch.select_predicate.splice(t,1),-1!==n&&o.options.webapi_options.navigate.select_bo.splice(n,1)}},removeBIColumn:function(e){if(s&&s.columns4BI&&-1!==s.columns4BI.indexOf(e)&&s&&s.available_columns&&-1!==s.available_columns.indexOf(e)){s.available_columns.splice(s.available_columns.indexOf(e),1);var t=o.options.webapi_options.fetch.select_predicate.indexOf(e),n=o.options.webapi_options.navigate.select_bo.indexOf(e);-1!==t&&o.options.webapi_options.fetch.select_predicate.splice(t,1),-1!==n&&o.options.webapi_options.navigate.select_bo.splice(n,1),s.columns4BI.splice(s.columns4BI.indexOf(e),1)}},updateSettings:function(e){for(var t=0;t<e.length;t++)s&&s.available_columns&&s&&-1===s.available_columns.indexOf(e[t])&&d.addAvailableColumn(e[t],!0)},getAttributeMap:function(){return r},buildDefaultColumns:function(e){for(var t=[],n=0;n<i.defaultAttributes.length;n++){var o={dataIndex:i.defaultAttributes[n].tree?"tree":i.defaultAttributes[n].name,minWidth:50,xnav_options:{name:i.defaultAttributes[n].name,layout:{removable:!0,hidden:!1},exportable:{lock:!1,value:!0},hardcoded:i.defaultAttributes[n].hardcoded}};switch(i.defaultAttributes[n].name){case"hide_show":case"find_in_ctx":o.width=40,o.minWidth=40,o.maxWidth=40,o.xnav_options.exportable.lock=!0,o.xnav_options.exportable.value=!1;break;case"ds6w:cadMaster":o.width=50;break;case"ds6w:label":o.minWidth=100,o.width=250,o.xnav_options.exportable.lock=!0}"tree"===o.dataIndex&&(o.xnav_options.layout.removable=!1),t.push(o)}require(["DS/PADUtils/PADPredicatesNls"],function(n){n.updateColumnsWithNLS(t,e)})},isHardcodedColumn:function(e){var t=!1;if(-1!==l.indexOf(e)&&(t=!0),i.defaultAttributes)for(var n=0;n<i.defaultAttributes.length&&!0===t;n++)i.defaultAttributes[n].name===e&&!0===i.defaultAttributes[n].hardcoded&&(t=!0);return t}});return d}),define("DS/PowerByHome/commands/XCADExchangeExportCmd",["UWA/Core","UWA/Utils/InterCom","DS/Utilities/Utils","DS/ApplicationFrame/Command","DS/i3DXCompassServices/i3DXCompassPubSub","DS/PADUtils/PADContext","DS/PADCommands/PADModelEvents","DS/ENOXCADUtils/utils/XCADModelEvents","DS/ENOXCADUtils/XCADNotification","i18n!DS/PowerByHome/assets/nls/PowerByApps"],function(e,t,n,o,i,s,a,r,l,c){"use strict";var d,u,p=null;return o.extend({_context:null,init:function(e){var o=this;this._parent(e),this._context=s.get();var c=this._context.options.model.getXSO(),u=n.debounce(function(){o._selectionChange()},100);c.onPostAdd(u),c.onPostRemove(u),c.onEmpty(u),o._selectionChange(),a.subscribe({event:"PADCommand/RootVisibilityChange"},o._selectionChange.bind(this)),r.subscribe({event:"ENOXCAD-Launch-Import"},function(){o.launchApp("ImportApp")}),null===p&&(p=new t.Socket).subscribeServer("com.ds.compass",window.parent),i.subscribe("exchange:ENOUXEH:app:open",function(e){d=!1}),r.subscribe({event:"XCADExchangeExportCmd/LaunchExport"},function(){p.dispatchEvent("isENOUXEHAPlaunched",{msg:"ExchangeApOpen"},"exchange_socket_ENOUXEH_AP"),o.launchApp("ExportApp")}),widget.getValue("isplmcsaEnabled")&&r.subscribe({event:"PowerByHome/ToWeb-ENOXCAD"},function(e){"xcadselectednode"===e.operation&&null!=e.data.message&&("failure"===e.data.status?l.warningMsg(e.data.message):o.launchApp("ExportApp"))})},_selectionChange:function(){0==(u=this._context.options.model.getXSO().get()).length?this._check_roots():u.length>1?this.disable():this.enable()},_check_roots:function(){this._context.getPADTreeDocument().getRoots().length>0?(u=this._context.getPADTreeDocument().getRoots(),this.enable()):this.disable()},execute:function(){var e=this;d=!0,p.dispatchEvent("isENOUXEHAPlaunched",{msg:"ExchangeApOpen"},"exchange_socket_ENOUXEH_AP"),setTimeout(function(){if(Boolean(d))r.publish({event:"ENOXCAD-PowerByHome/ToWin",data:{operation:"xcadselectednode",version:"1.0",data:{cadid:u[0].getCADID(),label:u[0].getLabel()}}}),sessionStorage.setItem("isplmcsaEnabled",widget.getValue("isplmcsaEnabled")),Boolean(widget.getValue("isplmcsaEnabled"))||e.launchApp("ExportApp");else{let e=c.exchange_app_close+" Unified X-CAD Design Exchange "+c.exchange_app_close_info;l.infoMsg(e)}},600)},launchApp:function(e){require(["DS/PADUtils/PADUtilsServices"],function(t){sessionStorage.setItem("XCADExchangeCmd",e),t.launchApp({appId:"ENOUXEH_AP",widgetId:t.getWidgetId()})})}})}),define("DS/PowerByHome/mixins/PowerByDnD",["UWA/Class","DS/PADUtils/PADUtilsServices","DS/PADUtils/views/PADAlert","DS/PADUtils/PADTypesMgt","DS/PADUtils/PADContext","DS/PADUtils/PADSettingsMgt","DS/PADUtils/views/PADDropTooltip","DS/ApplicationFrame/CommandsManager","i18n!DS/PADUtils/assets/nls/PADUtils.json"],function(e,t,n,o,i,s,a,r,l){"use strict";return e.extend({setDnD_onGraph:function(){this.options.views.graphview.getContainer().addEventListener("dragover",this.onDragOverGraph.bind(this)),this.options.views.graphview.getContainer().addEventListener("drop",this.onDropBlankGraph.bind(this)),this.options.views.graphview.getContainer().addEventListener("dragenter",this.onDragLeaveGraph.bind(this)),this.options.views.graphview.getContainer().addEventListener("dragleave",this.onDragLeaveGraph.bind(this)),this.options.views.graphview.getContainer().addEventListener("dragend",this.onDragLeaveGraph.bind(this))},doDnDDragStart:function(e,t,n){var o=this.dropdata_from_selected_nodes(t);return e.setData("Text",JSON.stringify(o)),!0},shouldAcceptDnDDrop:function(e,t,n,o){return!1},doDnDDrop:function(e,t,n,o){return!1},onDragOverGraph:function(e){return!1},onDragLeaveGraph:function(e){return!1},onDropBlankGraph:function(e){return!1},onDragEnterBlank:function(e,t){return!1},onDragOverBlank:function(e,t){return!1},onDragEndBlank:function(e,t){return!1},onDragLeaveBlank:function(e,t){return!1},onDropBlank:function(e,t){return!1},onDragEnterCell:function(e,t){return!1},onDragEndCell:function(e,t){return!1},onDragStartCell:function(e,t){var n=t.nodeModel,o=this.options.model.getXSO().get().slice(0);if(o[0]!==n){var i=o.indexOf(n),s=o[0];o[0]=n,o[i]=s}var a=this.dropdata_from_selected_nodes(o);return e.dataTransfer.setData("Text",JSON.stringify(a)),e.stopPropagation(),!1},onDragOverCell:function(e,t){return!1},onDragLeaveCell:function(e,t){return!1},onDropCell:function(e,t){},onDragEnterColumnHeader:function(e,t){},onDragEndColumnHeader:function(e,t){return!1},onDragOverColumnHeader:function(e,t){return!1},onDragLeaveColumnHeader:function(e,t){return!1},onDropColumnHeader:function(e,t){return!1},onDragStartColumnHeader:function(e,t){return!1},dropOnInvite:function(e){},dropdata_from_selected_nodes:function(e){var t=this,n={protocol:"3DXContent",version:"1.1",source:widget&&widget.getValue("x3dAppId")?widget.getValue("x3dAppId"):"ENOSTDE_AP",widgetId:this.getWidgetId(),data:{items:[]}};return e.forEach(function(e){n.data.items.push(t.dropdata_from_node(e))}),n},dropdata_from_node:function(e,t){var n=[e.options.type];return t&&t[e.options.type]&&(n=t[e.options.type]),{envId:this.getPlatformId(),serviceId:"3DSpace",contextId:s.getSetting("pad_security_ctx")?s.getSetting("pad_security_ctx"):void 0,objectId:e.getID(),cadId:e.getCADID(),objectType:e.options.type,objectTaxonomies:n,displayName:e.options.display?e.options.display:e.getLabel(),displayType:e.options.grid["ds6w:type"],path:e.getOccurencePathWithType?e.getOccurencePathWithType():void 0}},getWidgetId:function(){return"undefined"!=typeof widget?widget.id:-1},getPlatformId:function(){return"undefined"!=typeof widget&&widget.getValue("x3dPlatformId")?widget.getValue("x3dPlatformId"):s.getSetting("x3dPlatformId")}})}),define("DS/PowerByHome/utils/ComboSelector",["i18n!DS/PowerByHome/assets/nls/TreeLst","UWA/Core","UWA/Controls/Abstract","UWA/Class/Events","DS/Menu/Menu"],function(e,t,n,o,i){"use strict";return n.extend(o,{defaultOptions:{treedocument:null,withMore:!1,disabled:!1,title:null,multisel:!0},init:function(e){this._parent(e);if(this.elements.container=t.createElement("div",{class:"padComboSelector "+(e.className?e.className:"")}),this.elements.inner=t.createElement("div",{class:"padComboSelector-inner"}).inject(this.elements.container),this.elements.text=t.createElement("div",{class:"padComboSelector-text"}).inject(this.elements.inner),this.options.title&&t.createElement("p",{text:this.options.title,title:this.options.title}).inject(this.elements.text),this.elements.expander=t.createElement("span",{class:"padComboSelector-expander wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-expand-down"}).inject(this.elements.inner),this.elements.container.addEventListener("click",this._launchCtxMenu.bind(this)),this.elements.container.addEventListener("contextmenu",this._launchCtxMenu.bind(this)),null===this.options.treedocument)throw new Error("Invalid attribute in constructor. Missing treedocument");this.options.treedocument.getXSO().onPostAdd(this._redrawInnerText.bind(this)),this.options.treedocument.getXSO().onPostRemove(this._redrawInnerText.bind(this)),this.disabled(this.options.disabled),this._redrawInnerText()},disabled:function(e){e?(this.elements.container.setAttribute("disabled",""),this.options.disabled=e):(this.elements.container.removeAttribute("disabled",""),this.options.disabled=e)},_launchCtxMenu:function(t){var n=[],o=this;if(!1===this.options.disabled){for(var s=this.options.treedocument.getRoots(),a=0;a<s.length;a++){var r=s[a].options.icons&&s[a].options.icons.length&&s[a].options.icons[0].iconName?{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-"+s[a].options.icons[0].iconName}:void 0;n.push({title:s[a].getLabel(),type:"CheckItem",state:s[a].isSelected()?"selected":void 0,fonticon:r,action:{this:this,context:s[a],callback:this._typeSelectedInMenu.bind(this)}})}if(this.options.withMore&&(n.push({type:"SeparatorItem"}),n.push({title:e.more,type:"PushItem",action:{this:this,callback:function(e){o.dispatchEvent("onMore")}}})),n.length){var l=this.elements.container.getBoundingClientRect();i.show(n,{position:{x:l.left,y:l.bottom}})}}},_typeSelectedInMenu:function(e){var t=e.context;!0===this.options.multisel?t.isSelected()?(t.unselect(),this.dispatchEvent("onUnselect",t)):(t.select(),this.dispatchEvent("onSelect",t)):(t.select(!0),this.dispatchEvent("onSelect",t)),this.dispatchEvent("onSelectionChange"),this._redrawInnerText()},_redrawInnerText:function(){if(!(t.is(this.options.title,"string")&&this.options.title.length>0)){this.elements.text.empty();for(var e="",n=[],o=this.options.treedocument.getSelectedNodes(),i=0;i<o.length;i++)n.push(o[i].getLabel());if(e=n.length?n.join(", "):this.options.nlsEmptySelection,!1===this.options.multisel&&1===o.length&&o[0].options.icons){t.createElement("div",{class:"iconMenu wux-ui-3ds wux-ui-3ds-2x wux-ui-3ds-"+o[0].options.icons[0].iconName}).inject(this.elements.text);o[0].options.subLabel&&(this.elements.text.title=o[0].options.subLabel)}t.createElement("p",{text:e}).inject(this.elements.text)}}})}),define("DS/PowerByHome/commands/Revisions",["DS/ApplicationFrame/Command","DS/PADCommands/PADModelEvents","DS/PADUtils/PADContext"],function(e,t,n){"use strict";return e.extend({init:function(e){this._parent(e),this.checkSelection(),n.get().options.model.getXSO().onChange(this.checkSelection.bind(this))},checkSelection:function(){if(n.get().options.model.getXSO().get().length){if(widget.getValue("requireResourceidCommands").includes(this.options.ID)){let e=!0,t=n.get().options.model.getXSO().get();for(let n=0;n<t.length;n++){if(!t[n].getID()){e=!1;break}}e?this.enable():this.disable()}else this.enable()}else this.disable()},execute:function(){let e=n.get().getPADTreeDocument()._buildSelectData();t.publish({event:"revisions",data:{cadidPaths:e.cadidPaths}})}})}),define("DS/PowerByHome/models/PowerByWS",["UWA/Core","DS/WAFData/WAFData","DS/PADUtils/PADUtilsServices"],function(e,t,n){"use strict";var o={url:"/resources/v1/ENODerivedOutputStreamServices/derivedformat_services/getLinkableInformation",verb:"POST"},i={url:"/resources/PLMDerivedOutputWSAPI/derivedoutput_services/getJobsInformation",verb:"POST"},s=function(n,o,i){return new e.Promise(function(e,s){o.onComplete=function(t){let n="string"==typeof(o=t)?JSON.parse(o):o;var o;e(n)},o.onFailure=function(e){s(i+" Failure")},o.onTimeout=function(e){s(i+" Timeout")},o.data&&(o.data=JSON.stringify(o.data)),t.authenticatedRequest(n,o)})};return{getdoinfo:async function(e){let t=o,i=n.getPlatformId(),a=n.get3DSpaceUrl(i)+t.url+"?tenant="+i;var r=widget.getPreference("pad_security_ctx"),l=r?r.value:"";let c={timeout:25e4,method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json",SecurityContext:encodeURIComponent(l)},data:{ids:e,attributes:["format","isSync"]}};widget.setValue("isDoInfoWS",!0);return s(a,c,"Error: getLinkableInformation webservice")},getdojobinfo:async function(e){let t=i,o=n.getPlatformId(),a=n.get3DSpaceUrl(o)+t.url+"?tenant="+o,r=widget.getPreference("pad_security_ctx"),l=r?r.value:"";let c={timeout:25e4,method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json",SecurityContext:encodeURIComponent(l)},data:{ids:e}};widget.setValue("isDoJobInfoWS",!0);return s(a,c,"Error: getJobsInformation webservice")}}}),define("DS/PowerByHome/commands/Properties",["UWA/Core","DS/ApplicationFrame/Command","DS/PADUtils/PADContext","DS/PADCommands/PADModelEvents"],function(e,t,n,o){"use strict";return t.extend({init:function(e){this._parent(e),this._check_select(),n.get().options.model.getXSO().onChange(this._check_select.bind(this))},_check_select:function(){if(!0===!!n.get().options.model.getXSO().get().length)if(widget.getValue("requireResourceidCommands").includes(this.options.ID)){for(var e=!0,t=n.get().options.model.getXSO().get(),o=0;o<t.length;o++){if(!t[o].getID()){e=!1;break}}e?this.enable():this.disable()}else this.enable();else this.disable()},execute:function(){var e=n.get().getPADTreeDocument()._buildSelectData();o.publish({event:"showProperties",data:{cadidPaths:e.cadidPaths}})}})}),define("DS/PowerByHome/commands/ReplaceAllOccurrences",["UWA/Core","DS/ApplicationFrame/Command","DS/PADUtils/PADContext","DS/PADCommands/PADModelEvents"],function(e,t,n,o){"use strict";return t.extend({init:function(e){this._parent(e),this._check_select(),n.get().options.model.getXSO().onChange(this._check_select.bind(this))},_check_select:function(){!0===!!n.get().options.model.getXSO().get().length?this.enable():this.disable()},execute:function(){var e=n.get().getPADTreeDocument()._buildSelectData();o.publish({event:"replaceAllOccurrences",data:{cadidPaths:e.cadidPaths}})}})}),define("DS/PowerByHome/models/PowerByNodeModel",["DS/TreeModel/TreeNodeModel","DS/WebappsUtils/WebappsUtils"],function(e,t){"use strict";function n(t){this.options={label:"",icons:[],grid:{},resourceid:"",type:"",relationid:"",relationtype:"",children:[],thumbnail:null},this.options=UWA.extend(this.options,t),e.call(this,this.options)}return n.prototype=Object.create(e.prototype),n.prototype.getID=function(){return this.options.resourceid},n.prototype.getCADID=function(){return this.options.cadid},n.prototype.getOccurencePath=function(e){if(UWA.is(e,"function")&&e(this),!this.isRoot()&&this.getParent()){var t=this.getParent().getOccurencePath(e);return t.push(this.options.relationid),t.push(this.options.resourceid),t}return[this.options.resourceid]},n.prototype.getOccurenceCADIDPath=function(e){if(UWA.is(e,"function")&&e(this),!this.isRoot()&&this.getParent()){var t=this.getParent().getOccurenceCADIDPath(e);return t.push(this.options.relid),t.push(this.options.cadid),t}return[this.options.cadid]},n.prototype.getNodeByPath=function(e,t,n,o){if(("number"!=typeof t||t<0)&&(t=0),("number"!=typeof n||n<0||n>=e.length)&&(n=e.length-1),this.options.cadid){if(this.options.cadid instanceof Array&&this.options.cadid.indexOf(e[t])>=0||this.options.cadid===e[t]){if(t!==n&&(this.isExpanded()||void 0!==o&&!1!==o)){var i=e[t+1];if((r=this.getChildren())&&0!==r.length){for(var s=null,a=0;a<r.length&&null===s;a++){i===(l=r[a]).options.relid&&(s=l)}return null===s?this:s.getNodeByPath(e,t+2,n,o)}return this}return this}}else if(this.options.resourceid instanceof Array&&this.options.resourceid.indexOf(e[t])>=0||this.options.resourceid===e[t]){if(t!==n&&(this.isExpanded()||void 0!==o&&!1!==o)){var r;i=e[t+1];if((r=this.getChildren())&&0!==r.length){for(s=null,a=0;a<r.length&&null===s;a++){var l;i!==(l=r[a]).options.relationid&&i!==l.options.relid||(s=l)}return null===s?this:s.getNodeByPath(e,t+2,n,o)}return this}return this}},n.prototype.getDepth=function(){for(var e=this,t=0;!e.isRoot();)e=e.getParent(),t++;return t},n}),define("DS/PowerByHome/commands/CreateStructuralSimulation",["DS/ApplicationFrame/Command","DS/PADCommands/PADModelEvents","DS/PADUtils/PADContext"],function(e,t,n){"use strict";return e.extend({init:function(e){this._parent(e)},execute:function(){t.publish({event:"createStructuralSimulation",data:{}})}})}),define("DS/PowerByHome/commands/ManageLocalFiles",["UWA/Core","DS/ApplicationFrame/Command","DS/PADUtils/PADContext","DS/PADCommands/PADModelEvents"],function(e,t,n,o){"use strict";return t.extend({init:function(e){this._parent(e)},execute:function(){o.publish({event:"manageLocalFiles",data:{}})}})}),define("DS/PowerByHome/views/PowerByWebView",["css!DS/PowerByHome/PowerByHome","UWA/Core","UWA/Controls/Abstract","UWA/Class/Options","UWA/Class/Events","DS/UIKIT/Alert","i18n!DS/PowerByHome/assets/nls/PowerByHome.json"],function(e,t,n,o,i,s,a){"use strict";return n.extend(o,i,{defaultOptions:{},init:function(e){this._parent(e),this._buildSkeleton(),this.options.callback&&this.options.callback.call(this)},render:function(){return this.elements.container},_buildSkeleton:function(){t.is(this.elements.container)||(this.elements.container=UWA.createElement("div",{class:"PowerByWebView"}))},show:function(){var e=new s({closable:!1,visible:!0,autoHide:!1,closeOnClick:!1,messages:{className:"error",message:a.webViewErrorMessage}}).inject(this.elements.container).elements.container.querySelector(".close");e.parentElement.removeClassName("alert-closable"),e.parentElement.removeChild(e)}})}),define("DS/PowerByHome/commands/ReplaceByLatestRevision",["DS/ApplicationFrame/Command","DS/PADCommands/PADModelEvents","DS/PADUtils/PADContext"],function(e,t,n){"use strict";return e.extend({init:function(e){this._parent(e),this._checkSelection(),n.get().options.model.getXSO().onChange(this._checkSelection.bind(this))},_checkSelection:function(){if(!0===!!n.get().options.model.getXSO().get().length)if(widget.getValue("requireResourceidCommands").includes(this.options.ID)){for(var e=!0,t=n.get().options.model.getXSO().get(),o=0;o<t.length;o++){if(!t[o].getID()){e=!1;break}}e?this.enable():this.disable()}else this.enable();else this.disable()},execute:function(){var e=n.get().getPADTreeDocument()._buildSelectData();t.publish({event:"replaceByLatestRevision",data:{cadidPaths:e.cadidPaths}})}})}),define("DS/PowerByHome/commands/InsertUnderActiveDocument",["UWA/Core","DS/ApplicationFrame/Command","DS/PADUtils/PADContext","DS/PADCommands/PADModelEvents"],function(e,t,n,o){"use strict";return t.extend({init:function(e){var t=this;this._parent(e),this.disable(),o.subscribe({event:"PADCommand/RootVisibilityChange"},function(e){e.availableRoots.length>0?t.enable():t.disable()})},execute:function(){o.publish({event:"insertUnderActiveDocument",data:{}})}})}),define("DS/PowerByHome/commands/BatchSave",["UWA/Core","DS/ApplicationFrame/Command","DS/PADUtils/PADContext","DS/PADCommands/PADModelEvents"],function(e,t,n,o){"use strict";return t.extend({init:function(e){this._parent(e)},execute:function(){o.publish({event:"batchSave",data:{}})}})}),define("DS/PowerByHome/commands/ShareAsPicture",["UWA/Core","DS/ApplicationFrame/Command","DS/PADUtils/PADContext","DS/PADCommands/PADModelEvents"],function(e,t,n,o){"use strict";return t.extend({init:function(e){var t=this;this._parent(e),this.disable(),o.subscribe({event:"PADCommand/RootVisibilityChange"},function(e){e.availableRoots.length>0?t.enable():t.disable()})},execute:function(){o.publish({event:"shareAsPicture",data:{}})}})}),define("DS/PowerByHome/commands/GetAttributesForAll",["UWA/Core","DS/ApplicationFrame/Command","DS/PADUtils/PADContext","DS/PADCommands/PADModelEvents"],function(e,t,n,o){"use strict";return t.extend({init:function(e){var t=this;this._parent(e),this.disable(),o.subscribe({event:"PADCommand/RootVisibilityChange"},function(e){e.availableRoots.length>0?t.enable():t.disable()})},execute:function(){o.publish({event:"getAttributesForAll",data:{}})}})}),define("DS/PowerByHome/commands/SaveWithOptions",["DS/ApplicationFrame/Command","DS/PADCommands/PADModelEvents","DS/PADUtils/PADContext"],function(e,t,n){"use strict";return e.extend({init:function(e){this._parent(e),this._checkSelection(),n.get().options.model.getXSO().onChange(this._checkSelection.bind(this))},_checkSelection:function(){!0===!!n.get().options.model.getXSO().get().length?this.enable():this.disable()},execute:function(){var e=n.get().getPADTreeDocument()._buildSelectData();t.publish({event:"saveWithOptions",data:{cadidPaths:e.cadidPaths}})}})}),define("DS/PowerByHome/commands/UpdateRevisions",["DS/ApplicationFrame/Command","DS/PADCommands/PADModelEvents","DS/PADUtils/PADContext"],function(e,t,n){"use strict";return e.extend({init:function(e){this._parent(e),this._checkSelection(),n.get().options.model.getXSO().onChange(this._checkSelection.bind(this))},_checkSelection:function(){if(!0===!!n.get().options.model.getXSO().get().length)if(widget.getValue("requireResourceidCommands").includes(this.options.ID)){for(var e=!0,t=n.get().options.model.getXSO().get(),o=0;o<t.length;o++){if(!t[o].getID()){e=!1;break}}e?this.enable():this.disable()}else this.enable();else this.disable()},execute:function(){var e=n.get().getPADTreeDocument()._buildSelectData();t.publish({event:"updateRevisions",data:{cadidPaths:e.cadidPaths}})}})}),define("DS/PowerByHome/mixins/PowerByCtx",["UWA/Class","i18n!DS/PADCommands/assets/nls/PADCommands.json","i18n!DS/PowerByHome/assets/nls/PowerByHome.json","i18n!DS/PADUtils/assets/nls/PADUtils.json","DS/ApplicationFrame/CommandsManager","DS/WebappsUtils/WebappsUtils","DS/etree/syncwidget","DS/PADCommands/PADModelEvents","DS/PADUtils/PADSettingsMgt","text!DS/PowerByHome/assets/CtxMenuList.json"],function(e,t,n,o,i,s,a,r,l,c){"use strict";var d,u=JSON.parse(c),p=e.extend({setSubMenuTypes:function(e){d=e},getOnContextualEvent:function(e,t,n){return{this:this,callback:function(o){return this.treeViewMenu(o,e,t,n)}}},treeViewMenu:function(e,n,i,a){var r=[],l=this;function c(e){var t="";if(""===e.text||null===e.text||void 0===e.text){var n="treelistview_customization_"+e.dataIndex;t=UWA.is(o[n])?o[n]:e.dataIndex}else t=e.text;return t}if(e.treeview.isHeader){var d=e.treeview.manager,u=e.treeview.dataIndex,p={type:"PushItem",icon:"url("+s.getWebappsAssetUrl("PADCommands","icons/32/I_FitToColumn.png")+")",title:t.PAD_CMDColumnToFit,action:{context:u,callback:function(e){d.sizeColumnToFit(e.context)}}};r.push(p);for(var m=[],h=0;h<d.options.columns.length;h++){var g=d.options.columns[h],f=g.customisation.layout.lock?"disabled|":null;!1===g.isHidden&&(f=f?f+"selected|":"selected|"),m.push({type:"CheckItem",title:c(g),state:f,action:{context:g.dataIndex,callback:function(e){d.getColumnOptions(e.context).customisation.layout.hidden?(d.showColumn(e.context),d.getColumnOptions(e.context).customisation.layout.hidden=!1):(d.hideColumn(e.context),d.getColumnOptions(e.context).customisation.layout.hidden=!0)}}})}m.push({type:"PushItem",title:t.PAD_CMDCustoColumnMore,fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-cog",family:WUXManagedFontIcons.Font3DS},action:{callback:function(e){l._launchAction({command:"ColumnVisibility"})}}});var v={type:"PushItem",fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-cog",family:WUXManagedFontIcons.Font3DS},title:t.PAD_CMDCustoColumn,submenu:m};r.push(v)}else{var b=e.treeview.nodeModel?e.treeview.nodeModel:e.treeview.cellModel;if(b){let e=n,t=b.options.menuid;if(i&&null!=t)for(let n=0;n<a.length;n++){if(a[n].id===t){e=a[n].commands;break}}!1===b.isSelected()&&b.select(!0),r=this.commonMenu(b,e)}}return r},commonMenu:function(e,o){var i=[],a={},r=this;function l(e,o){return{title:"PADCommands"==o?t["PAD_CMD"+u[e].title]:n[u[e].title],icon:"url("+s.getWebappsAssetUrl(o,u[e].icon)+")",type:"PushItem",action:{callback:r[u[e].callback].bind(r)}}}if(null!=e){var c=r.options.model.getSelectedNodes(),p=!1;c.length>1&&(p=!0),o.forEach(function(e){if(void 0===e.multiselection&&(e.multiselection=!0),"command"===e.type){if(e.multiselection||!p){var o=e.id;if(-1!==u.lifecyclecmd.indexOf(o))i.push(l(o,"LifecycleCmd"));else if(-1===u.padcmd.indexOf(o))if("Relations_web"===o){let e=!1;for(let t=0;t<c.length;t++)if("sessionCreated"!==c[t]._options.grid.sessionStatus){e=!0;break}!0===e&&i.push(l(o,"PowerByHome"))}else i.push(l(o,"PowerByHome"));else{var m=!1;if(("ExpandAll_web"===o||"CollapseAll_web"===o)&&c.length>0)for(var h=0;h<c.length;h++)if("expandState"===c[h]._expandState||"collapseState"===c[h]._expandState){m=!0;break}m&&i.push(l(o,"PADCommands"))}}}else if("subMenu"===e.type)for(var g in e.commands.forEach(function(t){if(void 0===t.multiselection&&(t.multiselection=!0),t.multiselection||!p){var n=t.id;void 0===a[e.label]&&(a[e.label]=[]),-1!==u.padcmd.indexOf(n)?a[e.label].push(l(n,"PADCommands")):-1!==u.lifecyclecmd.indexOf(n)?a[e.label].push(l(n,"LifecycleCmd")):a[e.label].push(l(n,"PowerByHome"))}}),a){var f={type:"PushItem",title:n.lifecycle,submenu:a[g]};i.push(f)}else if("subtypespecificmenu"===e.type&&(void 0===e.multiselection&&(e.multiselection=!0),e.multiselection||!p)){let o=d.find(t=>t.id===e.id);var v;v=-1!==u.padcmd.indexOf(o.withDefaultCmd)?"PADCommands":-1!==u.lifecyclecmd.indexOf(o.withDefaultCmd)?"LifecycleCmd":"PowerByHome";var b={type:"PushItem",id:o.id,title:"PADCommands"==v?t["PAD_CMD"+u[o.withDefaultCmd].title]:n[u[o.withDefaultCmd].title],icon:"url("+s.getWebappsAssetUrl(v,u[o.withDefaultCmd].icon)+")",HelpResourceFile:"",submenu:[]};o.commands.forEach(function(e){var i=e.id;v=-1!==u.padcmd.indexOf(i)?"PADCommands":-1!==u.lifecyclecmd.indexOf(i)?"LifecycleCmd":"PowerByHome";var a=function(e,o,i){return{title:"PADCommands"==i?t["PAD_CMD"+u[e].title]:n[u[e].title],icon:"url("+s.getWebappsAssetUrl(i,u[e].icon)+")",type:"RadioItem",action:{context:{params:o,commandId:e,funtoCall:u[e].callback},callback:function(e){e.context.params&&e.context.params.withDefaultCmd&&e.context.params.withDefaultCmd!==e.context.commandId&&(e.context.params.withDefaultCmd=e.context.commandId),r[e.context.funtoCall]()}}}}(i,o,v);b.submenu.push(a),i===o.withDefaultCmd&&(b.action={callback:r[u[i].callback].bind(r)},a.state="selected")}),i.push(b)}"separator"===e.type&&i.push({type:"SeparatorItem"})})}return i}});return p.prototype._expandAll=function(){this._launchAction({command:"ExpandAll"})},p.prototype._collapseAll=function(){this._launchAction({command:"CollapseAll"})},p.prototype._properties_native=function(){this._launchAction({command:"PropertiesHdr"})},p.prototype._properties_web=function(){this._launchAction({command:"ActionBar_Attributes"})},p.prototype._save_native=function(){this._launchAction({command:"SaveHdr"})},p.prototype._saveWorkInProgressDesigns_native=function(){this._launchAction({command:"SaveWorkInProgressDesignsHdr"})},p.prototype._saveAsNew_native=function(){this._launchAction({command:"SaveAsNewHdr"})},p.prototype._saveWithOptions_native=function(){this._launchAction({command:"SaveWithOptionsHdr"})},p.prototype._rename_native=function(){this._launchAction({command:"RenameHdr"})},p.prototype._getRevision_native=function(){this._launchAction({command:"GetRevisionHdr"})},p.prototype._replaceByRevision_native=function(){this._launchAction({command:"ReplaceByRevisionHdr"})},p.prototype._replaceByLatestRevision_native=function(){this._launchAction({command:"ReplaceByLatestRevisionHdr"})},p.prototype._updateRevision_native=function(){this._launchAction({command:"UpdateRevisionsHdr"})},p.prototype._revisions_native=function(){this._launchAction({command:"RevisionsHdr"})},p.prototype._reloadFromServer_native=function(){this._launchAction({command:"ReloadFromServerHdr"})},p.prototype._replaceContent_native=function(){this._launchAction({command:"ReplaceContentHdr"})},p.prototype._replaceSelectedOccurrence_native=function(){this._launchAction({command:"ReplaceSelectedOccurrenceHdr"})},p.prototype._replaceAllOccurrences_native=function(){this._launchAction({command:"ReplaceAllOccurrencesHdr"})},p.prototype._getAttributesForSelected_native=function(){this._launchAction({command:"GetAttributesForSelectedHdr"})},p.prototype._maturity_web=function(){this._launchAction({command:"MaturityHdr"})},p.prototype._revise_web=function(){this._launchAction({command:"RevisionHdr"})},p.prototype._reserve_native=function(){this._launchAction({command:"ReserveHdr"})},p.prototype._reserve_web=function(){this._launchAction({command:"ActionBar_ReserveCmd"})},p.prototype._unreserve_native=function(){this._launchAction({command:"UnreserveHdr"})},p.prototype._unreserve_web=function(){this._launchAction({command:"ActionBar_UnreserveCmd"})},p.prototype._relations_web=function(){this._launchAction({command:"RelationIPExplorer"})},p.prototype._open_native=function(){require(["DS/PowerByHome/commands/OpenCmd"],function(e){(new e).execute()})},p.prototype._replaceFromPkg_native=function(){require(["DS/PADUtils/PADContext","DS/PlatformAPI/PlatformAPI"],function(e,t){let n={operation:"replacepkgContent",operationVersion:"1.0",content:{cadidPaths:e.get().getPADTreeDocument()._buildSelectData().cadidPaths}};t.publish("webinwin:web:notification",JSON.stringify(n))})},p.prototype._launchAction=function(e){var t=i.getCommand(e.command,this.options.action_bar_opts&&this.options.action_bar_opts.context?this.options.action_bar_opts.context:null);t&&t.begin()},p}),define("DS/PowerByHome/commands/OpenCmd",["UWA/Core","UWA/Class","DS/PADUtils/PADContext","DS/PADCommands/PADModelEvents"],function(e,t,n,o){"use strict";return t.extend({init:function(){},execute:function(){var e=n.get().getPADTreeDocument()._buildSelectData();o.publish({event:"openFromWeb",data:{cadidPaths:e.cadidPaths}})}})}),define("DS/PowerByHome/commands/GetRevision",["DS/ApplicationFrame/Command","DS/PADCommands/PADModelEvents","DS/PADUtils/PADContext"],function(e,t,n){"use strict";return e.extend({init:function(e){this._parent(e),this._checkSelection(),n.get().options.model.getXSO().onChange(this._checkSelection.bind(this))},_checkSelection:function(){!0===!!n.get().options.model.getXSO().get().length?this.enable():this.disable()},execute:function(){var e=n.get().getPADTreeDocument()._buildSelectData();t.publish({event:"getRevision",data:{cadidPaths:e.cadidPaths}})}})}),define("DS/PowerByHome/views/PowerByGraphView",["css!DS/PowerByHome/PowerByHome","UWA/Core","UWA/Controls/Abstract","UWA/Class/Options","UWA/Class/Events","DS/etree/syncwidget","css!egraph/views","css!etree/syncviews","css!DS/etree/overviewui.css"],function(e,t,n,o,i,s,a,r){"use strict";return n.extend(o,i,{_treegraph:null,defaultOptions:{fittingArea:{paddingLeft:15,paddingRight:0,paddingTop:0,paddingBottom:80},layout:s.LayoutMode.LAYERED,viewport:null},init:function(e){this._parent(e),this._buildSkeleton(),this.getOption("renderTo")&&!0===e.isActiveView&&this.render().inject(this.getOption("renderTo"))},_buildSkeleton:function(){t.is(this.elements.container)||(this.elements.container=UWA.createElement("div",{class:"powerBygraph"}),this._treegraph=new s.SyncEGraphTree(this.elements.container,this.options),this._treegraph.createOverview(),this._treegraph.setAutogroups&&this._treegraph.setAutogroups(!0),this._treegraph.setFittingArea(this.options.fittingArea),UWA.is(this._treegraph.setHTML5DnD,"function")&&(this._treegraph.setHTML5DnD(!0),this._treegraph.setMultiSelectionDrag(!0)))}})}),define("DS/PowerByHome/commands/OpenWebInWin",["UWA/Core","DS/ApplicationFrame/Command","DS/PADUtils/PADContext","DS/PADCommands/PADModelEvents"],function(e,t,n,o){"use strict";return t.extend({init:function(e){this._parent(e)},execute:function(){o.publish({event:"openWebInWin",data:{}})}})}),define("DS/PowerByHome/commands/Share",["UWA/Core","DS/ApplicationFrame/Command","DS/PADUtils/PADContext","DS/PADCommands/PADModelEvents"],function(e,t,n,o){"use strict";return t.extend({init:function(e){this._parent(e),this._check_selection(),n.get().options.model.getXSO().onChange(this._check_selection.bind(this))},_check_selection:function(){n.get().options.model.getXSO().get().length?this.enable():this.disable()},execute:function(){const e=n.get().getPADTreeDocument()._buildSelectData();o.publish({event:"share",data:{cadidPaths:e.cadidPaths}})}})}),define("DS/PowerByHome/commands/ShareAs3D",["UWA/Core","DS/ApplicationFrame/Command","DS/PADUtils/PADContext","DS/PADCommands/PADModelEvents"],function(e,t,n,o){"use strict";return t.extend({init:function(e){var t=this;this._parent(e),this.disable(),o.subscribe({event:"PADCommand/RootVisibilityChange"},function(e){e.availableRoots.length>0?t.enable():t.disable()})},execute:function(){o.publish({event:"shareAs3D",data:{}})}})}),define("DS/PowerByHome/commands/SaveWorkInProgressDesigns",["UWA/Core","DS/ApplicationFrame/Command","DS/PADCommands/PADModelEvents"],function(e,t,n){"use strict";return t.extend({init:function(e){var t=this;this._parent(e),this.disable(),n.subscribe({event:"PADCommand/RootVisibilityChange"},function(e){for(var n=[],o=0;o<e.availableRoots.length;o++){var i=e.availableRoots[o].search({match:function(e){return"sessionNotModified"!==e.nodeModel.options.grid.sessionStatus}},[]);n.push.apply(n,i)}0===n.length?t.disable():t.enable()})},execute:function(){n.publish({event:"saveWorkInProgressDesigns",data:{columns:this.options.columns}})}})}),define("DS/PowerByHome/mixins/PowerByCompatibility",["UWA/Class","DS/UIKIT/Mask"],function(e,t){"use strict";return e.extend({getPADTreeDocument:function(){return this.options.model},getPADTreeListView:function(){return this.options.views.treelistview},getSelectedNodes:function(){return this.options.model.getSelectedNodes()},beginBlockingTransaction:function(e){t.mask(this.elements.main,e)},endBlockingTransaction:function(){t.unmask(this.elements.main)},displayNotification:function(e){require(["DS/PADUtils/views/PADAlert"],function(t){t.displayNotification(e)})},togglePanel:function(e,t){this.elements.appBody.togglePanel(e,t)}})}),define("DS/PowerByHome/commands/ReplaceContentCmd",["UWA/Core","DS/ApplicationFrame/Command","DS/PADUtils/PADContext","DS/PADCommands/PADModelEvents"],function(e,t,n,o){"use strict";return t.extend({init:function(e){this._parent(e),this._check_select(),n.get().options.model.getXSO().onChange(this._check_select.bind(this))},_check_select:function(){if(!0===!!n.get().options.model.getXSO().get().length)if(widget.getValue("requireResourceidCommands").includes(this.options.ID)){for(var e=!0,t=n.get().options.model.getXSO().get(),o=0;o<t.length;o++){if(!t[o].getID()){e=!1;break}}e?this.enable():this.disable()}else this.enable();else this.disable()},execute:function(){var e=n.get().getPADTreeDocument()._buildSelectData();o.publish({event:"replaceContent",data:{cadidPaths:e.cadidPaths}})}})}),define("DS/PowerByHome/commands/SaveSessionAsNew",["UWA/Core","DS/ApplicationFrame/Command","DS/PADCommands/PADModelEvents"],function(e,t,n){"use strict";return t.extend({init:function(e){this._parent(e),this.disable(),n.subscribe({event:"PADCommand/RootVisibilityChange"},this.toggleCommand.bind(this)),n.subscribe({event:"PADCommand/ResourceIdUpdated"},this.toggleCommand.bind(this))},toggleCommand:function(e){for(var t=!1,n=0;n<e.availableRoots.length;n++){if(e.availableRoots[n].getID()){t=!0;break}}t?this.enable():this.disable()},execute:function(){n.publish({event:"saveSessionAsNew",data:{}})}})}),define("DS/PowerByHome/commands/SaveAsNew",["DS/ApplicationFrame/Command","DS/PADCommands/PADModelEvents","DS/PADUtils/PADContext"],function(e,t,n){"use strict";return e.extend({init:function(e){this._parent(e),this._checkSelection(),n.get().options.model.getXSO().onChange(this._checkSelection.bind(this))},_checkSelection:function(){!0===!!n.get().options.model.getXSO().get().length?this.enable():this.disable()},execute:function(){var e=n.get().getPADTreeDocument()._buildSelectData();t.publish({event:"saveAsNew",data:{cadidPaths:e.cadidPaths}})}})}),define("DS/PowerByHome/commands/Options",["UWA/Core","DS/ApplicationFrame/Command","DS/PADUtils/PADContext","DS/PADCommands/PADModelEvents"],function(e,t,n,o){"use strict";return t.extend({init:function(e){this._parent(e)},execute:function(){o.publish({event:"options",data:{}})}})}),define("DS/PowerByHome/PowerByWebInWinProxy",["text!DS/PowerByHome/assets/PowerByWebInWinProxyResources.json","UWA/Core","UWA/Class","DS/PlatformAPI/PlatformAPI","DS/PADCommands/PADModelEvents"],function(e,t,n,o,i){"use strict";var s=JSON.parse(e);return n.singleton({init:function(e){this._parent(e)},setupEventHandler:function(e){var t,n=this;t=e?UWA.extend(s,e,!0):s;for(var a=Object.getOwnPropertyNames(t),r=0;r<a.length;r++){var l=t[a[r]];UWA.is(l.callback_toWin_fn,"function")?this[l.callback_toWin_name]=l.callback_toWin_fn:function(e){n[e.callback_toWin_name]=function(t){var n=UWA.clone(e.formatOut_toWin);t&&UWA.extend(n.content,t,!0),o.publish("webinwin:web:notification",UWA.is(n,"string")?n:JSON.stringify(n))}}(l),i.subscribe({event:l.callback_toWin_name},this[l.callback_toWin_name].bind(this)),UWA.is(l.callback_toWeb_fn,"function")?this[l.callback_toWeb_name]=l.callback_toWeb_fn:function(e){n[e.callback_toWeb_name]=function(t){var n=t.content;i.publish({event:e.callback_toWeb_name,data:n})}}(l)}}})}),define("DS/PowerByHome/commands/Save",["DS/ApplicationFrame/Command","DS/PADCommands/PADModelEvents","DS/PADUtils/PADContext"],function(e,t,n){"use strict";return e.extend({init:function(e){this._parent(e),this._checkSelection(),n.get().options.model.getXSO().onChange(this._checkSelection.bind(this))},_checkSelection:function(){!0===!!n.get().options.model.getXSO().get().length?this.enable():this.disable()},execute:function(){var e=n.get().getPADTreeDocument()._buildSelectData();t.publish({event:"save",data:{cadidPaths:e.cadidPaths}})}})}),define("DS/PowerByHome/commands/ReplaceSelectedOccurrence",["UWA/Core","DS/ApplicationFrame/Command","DS/PADUtils/PADContext","DS/PADCommands/PADModelEvents"],function(e,t,n,o){"use strict";return t.extend({init:function(e){this._parent(e),this._check_select(),n.get().options.model.getXSO().onChange(this._check_select.bind(this))},_check_select:function(){!0===!!n.get().options.model.getXSO().get().length?this.enable():this.disable()},execute:function(){var e=n.get().getPADTreeDocument()._buildSelectData();o.publish({event:"replaceSelectedOccurrence",data:{cadidPaths:e.cadidPaths}})}})}),define("DS/PowerByHome/HomeComponent",["DS/PADUtils/PADSession","UWA/Core","UWA/Promise","UWA/Controls/Abstract","DS/UIKIT/Mask","DS/PADCommands/PADModelEvents","DS/PADUtils/PADPromise","DS/PADUtils/PADUtilsServices","DS/CoreEvents/ModelEvents","DS/ENOXTriptych/js/ENOXTriptych","DS/PowerByHome/mixins/PowerByCtx","DS/PowerByHome/mixins/PowerByKeyboardInputs","DS/PowerByHome/mixins/PowerByDnD","DS/PlatformAPI/PlatformAPI","DS/i3DXCompassServices/i3DXCompassPubSub","DS/MessageBus/MessageBus","DS/PowerByHome/mixins/PowerByCompatibility","DS/PowerByHome/utils/PowerBySettings","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","DS/ENOXCADUtils/views/CADSearch","DS/ENOXCADUtils/XCADNotification","i18n!DS/PowerByHome/assets/nls/PowerByApps.json"],function(e,t,n,o,i,s,a,r,l,c,d,u,p,m,h,g,f,v,b,_,S,w){"use strict";var C,D,P="powerbyHomeComponent",A={};return e.softInit(!0),o.extend(d,f,u,p,{_cadsearchview:null,_selectedIdx:null,_matchedNodesSize:null,_matchedNodesList:null,_valueToSearch:null,defaultOptions:{amd_custo:{TreeDocument:"DS/PowerByHome/models/PowerByTreeDocument",TreeListView:"DS/PowerByHome/views/PowerByTreeListView",TreeGraph:"DS/PowerByHome/views/PowerByGraphView"},views:{treelistview:null,graphview:null}},init:function(e){this._parent(e),this.options=t.extend(this.options,e,!0);var o=this;this._buildSkeleton(),this._buildModel(),this._subscribe();var i=a.getPromises(),r=i.slice(),l=new n(function(e,t){n.all(r).then(function(t){s.publish({event:"HomeComponent/Ready",data:o}),e()})});l.name="dispatch Ready",i.push(l)},render:function(){return this.elements.container},_buildSkeleton:function(){this.elements.container=UWA.createElement("div",{class:P}),this.elements.left=UWA.createElement("div",{class:P+"-left"}),this.elements.main=UWA.createElement("div",{class:P+"-main"}),this.elements.right=UWA.createElement("div",{class:P+"-right"});var e={left:{resizable:!1,originalSize:295,originalState:"close",overMobile:!0},right:{resizable:!0,originalSize:295,originalState:"close",overMobile:!0},withoverflowhidden:!0,container:this.elements.container,withtransition:!0,modelEvents:s.getModelEvents()};this.elements.appBody=new c,this.elements.appBody.init(e,this.elements.left,this.elements.main,this.elements.right),this.elements.appBody.togglePanel=function(e){"left"===e?s.getModelEvents().publish({event:"triptych-toggle-panel",data:"left"}):s.getModelEvents().publish({event:"triptych-toggle-panel",data:"right"})},i.mask(this.elements.main)},_subscribe:function(){var e=this;s.subscribe({event:"HomeComponent/initCusto"},function(t){if(void 0===t.action_bar)throw new Error("ActionBar Is Not Defined");if(void 0===t.contextual_menu)throw new Error("Contextual Menu Is Not Defined");if(void 0===t.view_settings)throw new Error("View Settings Is Not Defined");void 0!==t.title&&e.options.widget.setTitle(t.title);let n=void 0!==t.plmcsaEnabled&&t.plmcsaEnabled;e.options.widget.setValue("isplmcsaEnabled",n);const o=void 0!==t.makeFromFacet&&t.makeFromFacet;if(e.options.widget.setValue("makeFromFacet",o),void 0===t.require_resourceid_commands?e.options.widget.setValue("requireResourceidCommands",[]):e.options.widget.setValue("requireResourceidCommands",t.require_resourceid_commands),void 0!==t.computelinkablefromchild&&!0===t.computelinkablefromchild&&e.options.widget.setValue("computelinkablefromchild",!0),localStorage.getItem("ENOWSES_AP_Custo")&&"reset"!==localStorage.getItem("ENOWSES_AP_Custo")){console.log("MySession- in subscribe -- second loading.."),A.workUnder=t.workUnder,A.changeControlActivation=t.workUnderVisibility,A.changeControlPosition=t.workUnderPosition,A.action_bar=t.action_bar,A.contextual_menu=t.contextual_menu,A.dynamic_menus=t.dynamic_menus,A.subTypeSpecificMenu=t.subtypespecificmenu,A.view_settings=JSON.parse(localStorage.getItem("ENOWSES_AP_Custo"));for(var i=0;i<A.view_settings.columnDefinition.length;i++)for(var a=0;a<t.view_settings.columnDefinition.length;a++)A.view_settings.columnDefinition[i].dataIndex===t.view_settings.columnDefinition[a].dataIndex&&void 0===A.view_settings.columnDefinition[i].customisation.titleModified&&(A.view_settings.columnDefinition[i].text=t.view_settings.columnDefinition[a].text);v.loadSettingsSync(A.view_settings),s.publish({event:"HomeComponent/readyToBuildViews"})}else"reset"===localStorage.getItem("ENOWSES_AP_Custo")?(localStorage.setItem("ENOWSES_AP_Custo",JSON.stringify(t.view_settings)),A.view_settings=t.view_settings,v.loadSettingsSync(A.view_settings),A.customisation={},A.customisation.view_settings=A.view_settings,s.publish({event:"HomeComponent/rebuildColumns",data:A})):(console.log("MySession - in subscribe -- first loading.."),A.workUnder=t.workUnder,A.action_bar=t.action_bar,A.changeControlActivation=t.workUnderVisibility,A.changeControlPosition=t.workUnderPosition,A.contextual_menu=t.contextual_menu,A.dynamic_menus=t.dynamic_menus,A.subTypeSpecificMenu=t.subtypespecificmenu,localStorage.setItem("ENOWSES_AP_Custo",JSON.stringify(t.view_settings)),A.view_settings=t.view_settings,v.loadSettingsSync(A.view_settings),s.publish({event:"HomeComponent/readyToBuildViews"}))}),s.subscribe({event:"HomeComponent/buildViews"},this._buildViews.bind(this)),s.subscribe({event:"HomeComponent/refreshHome"},this._refresh.bind(this)),s.subscribe({event:"HomeComponent/setCA"},function(e){require(["DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext"],function(t){t.set2(e,function(e){})})}),m.subscribe("_MySession/AuthKey",function(e){s.publish({event:"changeCA",data:e})}),m.subscribe("toggleActiveCA_MySession/AuthKey",function(e){require(["DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext"],function(e){var t=e.get();s.publish({event:"toggleActiveCA",data:t})})}),m.subscribe("toggleDeActiveCA_MySession/AuthKey",function(e){require(["DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext"],function(e){var t=e.get();s.publish({event:"toggleDeActiveCA",data:t})})}),m.subscribe("removeAuthCtxEvent_MySession/AuthKey",function(e){s.publish({event:"removeCA",data:e})}),s.subscribe({event:"HomeComponent/disableCA"},function(e){null==e.change.id&&require(["DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext"],function(e){e.deactivateBubble(),e.cleanAuthDetails(),e.closePopoverDialog(!1)})}),s.subscribe({event:"selectFromWin"},function(t){var n=e.options.model.getSelectedNodes();n&&n.length>0&&e.options.views.treelistview&&e.options.views.treelistview.centerNode(n[0])}),e.isSetTypesCallbackSubscribed||(h.subscribe("setTypesCallback",function(t){if(t.widgetId===r.getWidgetId()){var n=e.options.model.getSelectedNodes(),o=UWA.clone({version:"2.1",results:[],structures:[],viewpoint:[],workUnder:{version:"1.0",AuthoringContextHeader:null,change:{id:"",name:"",context:[],title:"",description:"",severity:""},evolution:{id:"",displayExpression:""}}});for(var i in n){var s=n[i].getID();s&&(0,o.results.push({id:s,phid:s}),o.structures.push({structure:[{id:s,show:!0,select:!0,children:[]}]}))}var a=JSON.stringify(o),l={appId:t.appId,widgetId:t.widgetId,fileName:"-file",fileContent:a};h.publish("launchApp",l)}}),e.isSetTypesCallbackSubscribed=!0),s.subscribe({event:"PowerByHome:HomeComponent:onSearch"},function(t){e.options.views.treelistview&&e.callSearchEvent(t)}),s.subscribe({event:"PowerByHome:HomeComponent:onResetSearch"},function(){})},_refresh:function(){this.options.widget.setValue("tenantAware",!1),this.options.model.getXSO().empty(),s.publish({event:"refreshHome"})},_buildModel:function(){var e=this,t={},o=a.getPromises(),i=o.slice(),s=new n(function(o){n.all(i).then(function(){require([e.options.amd_custo.TreeDocument],function(n){e.options.model=new n(t),e._keyboardListener=new u({component:e}),e._keyboardListener.startObservingKeyboard(e.elements.container),o()})})});s.name="build",o.push(s)},_getSecurityContext:function(e){var t=e.callback,o=e.tenant;"undefined"!=typeof widget&&widget.lang;require(["DS/PADUtils/PADWSAccess","DS/PADUtils/PADSecurityCtxConverter"],function(e,i){new n(function(t,n){e.getscandcollab({tenant:o,onComplete:function(e){var n=UWA.is(e,"string")?JSON.parse(e):e,o=i.prepareForStorage(n);t({securityContext:o.securityContext,securityContextList:o.cspaces})},onFailure:function(e){n(e)}})}).then(function(e){t(e)}).catch(function(e){t(null)})})},_setSecurityContext:function(){try{if(widget.getPreference("pad_security_ctx")){var e=widget.getPreference("pad_security_ctx").value;s.publish({event:"setContext",data:{context:e}}),sessionStorage.setItem("PADSecurityCtx",e),widget.setValue("pad_security_ctx",e)}}catch(e){}},getSecurityContext:function(){return widget.getPreference("pad_security_ctx")?{SecurityContext:widget.getPreference("pad_security_ctx").value}:null},onChangeControlActivation:function(e,t){var n="bottom-left";widget.getValue("changeControlPosition")&&(n=widget.getValue("changeControlPosition")),t?this.showChangeControlPositionPreference(n):this.hideChangeControlPositionPreference(n),widget.dispatchEvent("onEdit")},onEndEditWidgetForChangeControl:function(e,t){let n=!0;void 0!==widget.getValue("changeControlActivation")&&(n=widget.getBool("changeControlActivation"));let o="bottom-left";widget.getValue("changeControlPosition")&&(o=widget.getValue("changeControlPosition")),e&&e.submitted&&(n?(t.setPosition(o),t.show()):(t.setPosition(o),t.hide()),sessionStorage.setItem("changeControlActivation",n),sessionStorage.setItem("changeControlPosition",o),s.publish({event:"setWorkUnder",data:{workUnderVisibility:n,workUnderPosition:o}}))},showChangeControlActivationPreference:function(e){widget.addPreference({name:"changeControlActivation",defaultValue:e,type:"boolean",label:"changeControlActivation_label",onchange:"changeControlActivationChangeHandler"})},showChangeControlPositionPreference:function(e){widget.addPreference({name:"changeControlPosition",defaultValue:e,type:"list",label:"changeControlPosition_label",options:[{label:"bottom-left_label",value:"bottom-left"},{label:"bottom-right_label",value:"bottom-right"},{label:"top-right_label",value:"top-right"}]})},hideChangeControlPositionPreference:function(e){widget.addPreference({name:"changeControlPosition",type:"hidden",defaultValue:e})},addWorkUnderChangePrefrences:function(){var e=this;return new n(function(t){A.workUnder?require(["DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext"],function(n){let o=!0;null!==sessionStorage.getItem("changeControlActivation")?o="true"===sessionStorage.getItem("changeControlActivation"):void 0!==A.changeControlActivation&&(o=A.changeControlActivation),e.showChangeControlActivationPreference(o);let i="bottom-left";sessionStorage.getItem("changeControlPosition")?i=sessionStorage.getItem("changeControlPosition"):A.changeControlPosition&&(i=A.changeControlPosition),o?(e.showChangeControlPositionPreference(i),n.setPosition(i),n.show()):(e.hideChangeControlPositionPreference(i),n.setPosition(i),n.hide()),widget.addEvent("changeControlActivationChangeHandler",function(t,n){e.onChangeControlActivation(t,n)}),widget.addEvent("endEdit",function(t){e.onEndEditWidgetForChangeControl(t,n)}),t()}):t()})},_buildViews:function(){var e=this,t=a.getPromises(),o=t.slice(),r=new n(function(e){n.all(o).then(function(){require(["DS/PADUtils/PADUtilsServices","DS/PADUtils/PADProbes"],function(t,n){t.app_initialization(function(){e()},void 0,!1)})})});r.name="app init",t.push(r),o.push(r);var l=new n(function(t){n.all(o).then(function(){require(["DS/PADUtils/PADUtilsServices","DS/PADUtils/PADProbes"],function(n,o){var i={tenant:n.getPlatformId(),callback:function(e){if(e){var n=e.securityContext,o=e.securityContextList,i=o.find(e=>"Default"===e.csName);null!=i&&o.splice(o.indexOf(i),1),C={name:"pad_security_ctx",type:"list",label:"pad_security_ctx",defaultValue:n,options:o},console.log("Settings added")}t()}};e._getSecurityContext(i),widget.addEvent("endEdit",function(){e._setSecurityContext()})})})});l.name="app initSettings",t.push(l),new n(function(o){n.all(t).then(function(){require(["DS/PADUtils/PADUtilsServices","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","DS/PADUtils/PADSettingsMgt"],function(t,n,o){n.getPlatformServices({onComplete:function(n){var o=n,i=[];if(!UWA.is(o,"array"))throw new Error("Platform services not initialize yet");o.forEach(function(e){i.push({label:e.displayName,value:e.platformId})});var s,a=t.getPlatformId();console.log("The tenant id from PAD Service--\x3e>"+a);for(var r=0;r<i.length;r++)if(i[r].value===a){s=i[r].label;break}console.log("Its tenant label from i3DX service--\x3e>"+s);var l={name:"MySessionPlatformId",type:"text",label:w.MySession_tenant,defaultValue:s,disabled:!0};if(widget.setValue("current_tenant",s),t.isCloud()&&"onPremises"!==s){console.log("This is a cloud environment.So, add the tenant label as preference.."),widget.addPreference(l);let t=e.options.widget.title.concat(" ("+s+")");e.options.widget.setTitle(t)}null!=C&&widget.addPreference(C)},onFailure:function(e){logger.error("Cannot retrieve the Platform Services")}})})})}).name="tenant_preferences";var c=t.slice(),d=new n(function(t){n.all(c).then(function(){var o=[];A.action_bar.language=e.options.action_bar_opts.language;var a=new n(function(t){A.action_bar?require(["DS/PADCommands/PADActionBar"],function(n){e.elements.actionbar=new n({xnav_app:e,action_bar:A.action_bar,renderTo:e.elements.main,callback:{onactionbarcb:function(e){t()}}})}):t()});a.name="action bar",o.push(a);var r=new n(function(t){A.workUnder?require(["DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext"],function(n){n.initialize2(e.elements.main,"_MySession","show","bottom-left",function(e){t()})}):t()});r.name="authoring context",o.push(r);var l=new n(function(t){var n={treelistview:e._buildTreeListView.bind(e),graphview:e._buildGraphView.bind(e)},o=A;n[e.options.active_view]({renderTo:e.elements.main,customisation:o},t),setTimeout(function(){for(var t in n)n.hasOwnProperty(t)&&t!==e.options.active_view&&n[t]({renderTo:e.elements.main,customisation:o},null)}.bind(e),750)});l.name="webux views",o.push(l);new n(function(a){n.all(o).then(function(){e.addWorkUnderChangePrefrences().then(function(){i.unmask(e.elements.main),s.publish({event:"HomeComponent/pageReady",version:"1.0"}),a(),t()})})})})});d.name="views",t.push(d)},_buildTreeListView:function(e,t){var n=e||{},o=this;n.active_view=UWA.clone(o.options.active_view),n.isActiveView="treelistview"===n.active_view,n.customisation=e.customisation,n.onDragStartCell=o.onDragStartCell.bind(o),s.subscribe({event:"PowerByHome/TreeListView/Ready"},function(e){o.options.views.treelistview=e,n.isActiveView&&o.options.views.treelistview.setModel(o.options.model),t&&t()});var i=!1;s.subscribe({event:"HomeComponent/preExpand/expandAllNode"},function(e){i=e}),o.options.model.onPreExpand(function(e){if(null!=widget.getValue("isExpandNodeProtocol")&&Boolean(widget.getValue("isExpandNodeProtocol"))&&null!=e.target.getChildren()&&0==e.target.getChildren().length){var t=e.target.getOccurenceCADIDPath();t[t.length-1];s.publish({event:"PowerByTreeDocument/updateNodes/isExpandallNode",data:i}),m.publish("webinwin:web:notification",JSON.stringify({operation:"expandNode",operationVersion:"1.0",content:{expandall:i,cadidPath:e.target.getOccurenceCADIDPath()}}))}e.target.preExpandDone()}),console.log("MySession - in buildview 1--dyn menus->"+n.customisation.dynamic_menus);let a=!1;Array.isArray(n.customisation.dynamic_menus)&&(a=!0),console.log("MySession - in buildview 1--dyn menus=>"+a),console.log("MySession - in buildview 1--model cadid=>"+o.options.model),o.setSubMenuTypes(n.customisation.subTypeSpecificMenu),n.onContextualEvent=o.getOnContextualEvent(n.customisation.contextual_menu,a,n.customisation.dynamic_menus),require([o.options.amd_custo.TreeListView],function(e){new e(n)})},_buildGraphView:function(e,t){var n=e||{},o=this;n.active_view=UWA.clone(o.options.active_view),n.isActiveView="graphview"===n.active_view,n.onContextualEvent=o.getOnContextualEvent(),require([o.options.amd_custo.TreeGraph],function(e){o.options.views.graphview=new e(n),n.isActiveView&&o.options.views.graphview.setModel(o.options.model),!0===n.isActiveView&&o.options.views.graphview.reframeAll(),t&&t()})},callSearchEvent:function(e){var t=this;t._matchedNodesSize=0,D=!1,t.closeSearch(),document.querySelector(".powerbyHomeComponent-main .wux-scroller").addEventListener("click",e=>{t._matchedNodesList.length>0&&(t.closeSearch(),t.options.model.getXSO().get().length>0&&t.options.model.getXSO().get()[0].highlight())});let n=t.options.views.treelistview.options.columns.filter(e=>!e.isHidden).map(e=>e.dataIndex);if(t._matchedNodesList=t.options.model.search({match:function(o){o.nodeModel.options.grid.tree=o.nodeModel.options.label;for(let i in o.nodeModel.options.grid)if(n.includes(i)){let n=o.nodeModel.options.grid[i];if(null!=n&&"boolean"!=typeof n&&t.matchExpressions(n.toLowerCase(),e.toLowerCase()))return!0}return!1}}),t.options.model.prepareUpdate(),t._matchedNodesList.forEach(function(e,t){e.reverseExpand()}),t.options.model.pushUpdate(),t._matchedNodesList.length>0?(t.options.model.unselectAll(),t._matchedNodesList[0].highlight(),t.options.views.treelistview.centerNode(t._matchedNodesList[0])):S.infoMsg(w.no_object_found),t._matchedNodesList.length>1&&(t._matchedNodesSize=t._matchedNodesList.length,t._valueToSearch=e,t.initCADSearch(),null!=t._cadsearchview)){t._selectedIdx=0;let e="1/"+t._matchedNodesSize;t._cadsearchview.setLabel(e),t._cadsearchview.show()}},matchExpressions:function(e,t){if(t.includes("*")||t.includes("?")){let n=t.replace(/[.+^${}()|[\]\\]/g,"\\$&");return new RegExp(`^${n.replace(/\*/g,".*").replace(/\?/g,".")}$`,"i").test(e)}return e.includes(t)},initCADSearch:function(){var e=this;null===e._cadsearchview&&(e._cadsearchview=new _({renderTo:document.body,callbacks:{onPrevious:function(){e.focusChange({event:"previous"})},onNext:function(){e.focusChange({event:"next"})},onSelectAll:function(){D=!0;for(let t=0;t<e._matchedNodesSize;t++)e._matchedNodesList[t].highlight();let t=e._matchedNodesSize+"/"+e._matchedNodesSize;e._cadsearchview.setLabel(t)},onClose:function(){e.closeSearch()}}}))},focusChange:function(e){var t=this;if(null!==t._cadsearchview){if(D){for(let e=0;e<t._matchedNodesSize;e++)t._matchedNodesList[e].unhighlight();t._selectedIdx="previous"==e.event?t._matchedNodesSize-1:0}"previous"==e.event&&t._selectedIdx>0?(t._matchedNodesList[t._selectedIdx].unhighlight(),t._selectedIdx--,t._matchedNodesList[t._selectedIdx].highlight()):"next"==e.event&&t._selectedIdx<t._matchedNodesSize-1&&(t._matchedNodesList[t._selectedIdx].unhighlight(),!D&&t._selectedIdx++,t._matchedNodesList[t._selectedIdx].highlight()),D=!1;let n=t._selectedIdx+1+"/"+t._matchedNodesSize;t._cadsearchview.setLabel(n),t.options.views.treelistview.centerNode(t._matchedNodesList[t._selectedIdx])}},closeSearch:function(){var e=this;if(e._cadsearchview&&(e._cadsearchview.hide(),delete e._cadsearchview),null!=e._matchedNodesList&&e._matchedNodesList.length>0){let t=e._matchedNodesList.length;for(let n=0;n<t;n++)e._matchedNodesList[n].unhighlight();e._matchedNodesList=[]}}})}),define("DS/PowerByHome/utils/PADCustomizeView",["css!DS/UIKIT/UIKIT","css!DS/PowerByHome/PowerByHome","i18n!DS/PowerByHome/assets/nls/TreeLst","UWA/Controls/Abstract","UWA/Class/Events","DS/Controls/Button","DS/Controls/Toggle","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/Tree/TreeListView","DS/Core/PointerEvents","DS/PowerByHome/utils/ComboSelector"],function(e,t,n,o,i,s,a,r,l,c,d,u){"use strict";console.warn("DEPRECATED AMD [DS/ENXNavTreeLst/utils/PADCustomizeView]");var p={apiVersion:2,defaultCellHeight:40,isEditable:!1,show:{columnHeaders:!0},resize:{columns:!1},height:"auto",isSortable:!1,columns:[]};return o.extend(i,{name:"padcustomizeview",_command_id:"",_applyOnlyToThisApp:!1,init:function(e){this._parent(e),this._reverts=[];var t=this;require(["DS/ENOFloatingPanel/ENOFloatingPanel"],function(o){e.events&&t.addEvents(e.events),t.render_div=document.querySelector(t.options.render_div),t._command_id=e.id,t.elements.container=t._createContent(e),t.elements.floatingpanel=new o({className:t.name,body:t.elements.container,footer:t._buildFooter(e),title:n[t.name+"_"+e.id+"_title"],overlay:!0,closable:!0,animate:!0,resizable:!0,visible:!0,events:{onClose:function(){t._closePanel(),t.elements.floatingpanel.destroy()}}}),t.elements.floatingpanel.inject(t.render_div)})},_closePanel:function(){this.options.cmd&&this.options.cmd.enable(),"ColumnVisibility"===this.options.id&&(!0===this._applyOnlyToThisApp?this.dispatchEvent("custoViewChange"):this.dispatchEvent("saveAsTemplate"))},_createContent:function(e){var t=this,o=UWA.createElement("div",{class:"padcustomizeview_content"}),i=UWA.createElement("div",{class:"padcustomizeview_body"}).inject(o);UWA.createElement("div",{class:this.name+"_instruction",content:n[this.name+"_"+e.id+"_instruction"]}).inject(i),this.content_document=new r({useAsyncPreExpand:!0,shouldAcceptDrag:function(e,t){return!1},shouldAcceptDrop:function(e){return!1}}),this.content_document.onNodeModelUpdate(this._onNodeModelUpdate.bind(this));var s=UWA.clone(p);if(s.columns.push({width:40,dataIndex:"pad_toggle",isDraggable:!1,isSortable:!1,setValue:function(e){t.content_document.withTransactionUpdate(function(){e.nodeModel.updateOptions({updateType:"visibility",grid:{pad_toggle:e.value}})});var n=t.content_treelist.getManager().getColumnIDFromDataIndex("pad_toggle");t.content_treelist.getManager().updateCellView(-1,n)},getValue:function(e){return t._isSelected(e.nodeModel)},onCellChange:function(e){return e.event.target.dsModel.checkFlag},onCellRequest:function(e){var n;if(e.isHeader)""===e.cellView.getContent().innerHTML&&((n=new a({checkFlag:t._isEveryVisibleNodeSelected()&&t.columnHeader,mixedState:!t._isNoVisibleNodeSelected()&&!t._isEveryVisibleNodeSelected()})).getContent().addEventListener(d.POINTERDOWN,function(e){e.stopPropagation()}),n.getContent().addEventListener("focus",function(e){e.preventDefault(),e.stopPropagation()}),n.getContent().addEventListener("change",function(e){e.dsModel.checkFlag||e.dsModel.mixedState?(t.columnHeader=e.dsModel.checkFlag,t._toggleAllVisibleNodes(!0)):(t.columnHeader=e.dsModel.checkFlag,t._toggleAllVisibleNodes(!1))}),e.cellView.getContent().setHTML(n));else if(t._isLocked(e.nodeModel))e.cellView.getContent().setHTML('<span class="fonticon fonticon-block " style="padding-left:5px;color: #b2b4b8;"></span>');else{var o=e.cellView.reuseCellContent("_pad_toggle");o&&(o.checkFlag=t._isSelected(e.nodeModel),o.disabled=t._isLocked(e.nodeModel))}}}),s.columns.push({text:n.padcustomizeview_column_name_header,dataIndex:"tree",width:"auto",isDraggable:!1}),"ColumnVisibility"===this.options.id&&(s.isEditable=!0,s.columns.push({text:n.padcustomizeview_color_header,dataIndex:"column_color",width:60,isDraggable:!0,isColumnMovable:!1,isEditable:!1,onCellRequest:function(e){if(!e.isHeader){var t="#ffffff";e.nodeModel.options.grid&&e.nodeModel.options.grid.column_color&&(t=e.nodeModel.options.grid.column_color["background-color"]?e.nodeModel.options.grid.column_color["background-color"]:"#ffffff"),t=t.replace(/;/g,"");var o="#000000";e.nodeModel.options.grid&&e.nodeModel.options.grid.column_color&&(o=e.nodeModel.options.grid.column_color.color?e.nodeModel.options.grid.column_color.color:"#0000"),o=o.replace(/;/g,"");var i=UWA.createElement("div",{class:"padcustomizeview_colorpicker font-3dsregular",text:n.PADColorView_content,styles:{"background-color":t,color:o}});i.addEvent("click",function(t){t.preventDefault(),t.stopPropagation(),require(["DS/PADServices/views/private/ColorPicker"],function(t){var n=e.nodeModel.options.grid.column_color,o="#ffffff",i="#000000";n.color;n&&(o=n["background-color"].toLowerCase().replace(";",""),i=n.color.toLowerCase().replace(";","")),new t({selected_color:{background_color:o,color:i},renderTo:document.body,events:{onColorOK:function(t){e.nodeModel.updateOptions({updateType:"color",grid:{column_color:{"background-color":t.background_color+";",color:t.color+";"}}})}}})})}),e.cellView.getContent().setHTML(i)}}})),s.shouldDisplayTooltip=this.provideTooltip.bind(this),s.shouldBeEditable=this.shouldBeEditable.bind(this),this.content_treelist=new c(s),this.content_treelist.getManager().registerReusableCellContent({id:"_pad_toggle",buildContent:function(){var e=new a({checkFlag:!1});return e.getContent().addEventListener(d.POINTERDOWN,function(e){e.stopPropagation()}),e.getContent().addEventListener("focus",function(e){e.preventDefault(),e.stopPropagation()}),e}}),"ColumnVisibility"===this.options.id&&this.options.events.saveAsTemplate?this.content_treelist.getContent().addClassName("padcustomizeview_columnvisibility"):this.content_treelist.getContent().addClassName("padcustomizeview_options"),this.content_treelist.inject(i),this.content_treelist.getManager().loadDocument(this.content_document),this.loadRows(e),"ColumnVisibility"===this.options.id&&this.options.events.saveAsTemplate){var m=UWA.createElement("div",{class:"padcustomizeview_footer"}).inject(o);m.addClassName("compactModeAvailable"),i.addClassName("compactModeAvailable");var h=new r,g=new l({viewMode:"comfortable",label:n.Comfortable,subLabel:n.ComfortableExplanation,children:null,icons:[{iconName:"view-big-tile",fontIconFamily:WUXManagedFontIcons.Font3DS}]});h.addRoot(g);var f=new l({viewMode:"compact",label:n.Compact,subLabel:n.CompactExplanation,children:null,icons:[{iconName:"view-list",fontIconFamily:WUXManagedFontIcons.Font3DS}]});h.addRoot(f),this._hasThumbNail?(this.options.viewMode="comfortable",g.select(!0)):"compact"===this.options.viewMode?f.select(!0):g.select(!0),this.comboCompact=new u({className:"compactModeSelector",treedocument:h,withMore:!1,disabled:this.options.thumbnails,multisel:!1,events:{onSelectionChange:function(){t.dispatchEvent("compactMode",{viewMode:h.getSelectedNodes()[0].options.viewMode})}}}),this._hasThumbNail&&this.comboCompact.disabled(!0);var v=UWA.createElement("div",{class:this.name+"_footerArea comboDiv"});UWA.createElement("div",{class:"comboLabel",text:n.density}).inject(v),this.comboCompact.inject(v),v.inject(m),this.applyToggle=new a({label:n.padcustomizeview_apply_to_this_app});var b=UWA.createElement("div",{class:this.name+"_footerArea applyToggle",content:this.applyToggle});this.applyToggle.inject(b),b.inject(m),this.applyToggle.addEventListener("change",function(e){var n=e.dsModel;t._applyOnlyToThisApp=n.checkFlag})}return o},_buildFooter:function(e){var t=this,o=UWA.createElement("div",{class:"footerModal"});if("ColumnVisibility"===this.options.id){var i=new s({label:n.padcustomizeview_button_close,emphasize:"primary",touchMode:!0});i.addEventListener("click",function(){t._closePanel(),t.elements.floatingpanel.destroy()}),i.inject(o)}else{var a=new s({label:n.padcustomizeview_button_save,emphasize:"primary",touchMode:!0});a.addEventListener("click",function(){t._closePanel(),t.elements.floatingpanel.destroy(),"PrintOptions"!==t.options.id&&"ExportCSVOptions"!==t.options.id||t.dispatchEvent("ok")}),a.inject(o);var r=new s({label:n.padcustomizeview_button_cancel,emphasize:"secondary",touchMode:!0});r.addEventListener("click",function(){t._processReverts(),t.elements.floatingpanel.destroy()}),r.inject(o)}var l=new s({label:n.padcustomizeview_button_reset,touchMode:!0});return l.inject(o),l.addEventListener("click",function(){window.top.performance.mark("reset_event_begin"),t.dispatchEvent("reset"),!1===require("DS/PADUtils/PADSettingsMgt").getSetting("readsettingsv2")&&(t._closePanel(),t.elements.floatingpanel.destroy())}),o},provideTooltip:function(e){var t="";if(e.model.options.isHeader)t="";else switch(e.dataIndex){case"pad_toggle":t=this._isLocked(e.nodeModel)?t=n.padcustomizeview_tooltip_cannot_hide:n.padcustomizeview_tooltip_show_or_hide;break;case"tree":t="";break;case"column_color":t=n.padcustomizeview_tooltip_set_color;break;default:t=""}return{longHelp:t}},shouldBeEditable:function(e){var t=!0;if(!0===e.isHeader)t=!1;else if("tree"===e.dataIndex){var n=e.nodeModel.options.origin_dataIndex;"selection"!==n&&"hide_show"!==n&&"find_in_ctx"!==n&&"thumbnail"!==n&&"ds6w:reserved"!==n||(t=!1)}return t},loadRows:function(e,t){var o=this;function i(e,t){var i={label:function(e){var t="";if(""===e.text||null===e.text||void 0===e.text){var o="treelistview_customization_"+e.dataIndex;if(UWA.is(n[o]))t=n[o];else{var i=e.dataIndex.split(":");t=i&&2===i.length?i[1]:e.dataIndex}}else t=e.text;return t}(e),children:null,grid:{pad_toggle:!e.isHidden},origin_dataIndex:e.dataIndex,editableLabel:!(""===e.text||null===e.text||void 0===e.text)},s=e.customisation?e.customisation:e.xnav_options;switch(t){case"PrintOptions":case"ExportCSVOptions":i.grid.pad_toggle=!s.exportable||s.exportable.value,i.lock=!s.exportable||s.exportable.lock;break;case"ColumnVisibility":i.lock=!!s.layout&&(void 0!==s.layout.removable?!1===s.layout.removable:!!s.layout.lock&&s.layout.lock);var a={"background-color":"#ffffff",color:"#000000"};s.layout&&void 0!==s.layout.styles&&Object.keys(s.layout.styles).length>0&&(a={"background-color":s.layout.styles.backgroundColor?s.layout.styles.backgroundColor:s.layout.styles["background-color"],color:s.layout.styles.color}),i.grid.column_color=a,"thumbnail"===e.dataIndex&&!1===e.isHidden&&(o._hasThumbNail=!0)}return i}this.content_document&&(this.content_document.unselectAll(),this.content_document.removeRoots()),o.content_document.withTransactionUpdate(function(){e.columns.forEach(function(n){if(function(e,t){var n=!0,o=e.customisation?e.customisation:e.xnav_options;if(o)switch(t){case"PrintOptions":case"ExportCSVOptions":o.exportable&&!0===o.exportable.lock&&!1===o.exportable.value&&(n=!1)}else n=!1;return n}(n,e.id)){var s=i(n,e.id);!0===t&&"thumbnail"===s.origin_dataIndex&&!1===s.grid.pad_toggle&&o.comboCompact&&(o.comboCompact.disabled(!1),o.comboCompact.dispatchEvent("onSelectionChange")),o.content_document.addRoot(s)}})})},_isSelected:function(e){return e.options.grid.pad_toggle},_isLocked:function(e,t){var n=e.options.lock;return"tree"===e.options.origin_dataIndex&&(n=!0),n},_isEveryVisibleNodeSelected:function(){for(var e=!0,t=this.content_document.getRoots(),n=0;n<t.length&&e;n++)t[n].isVisible()&&!1===t[n].options.lock&&!1===t[n].options.grid.pad_toggle&&(e=!1);return e},_isNoVisibleNodeSelected:function(){for(var e=!0,t=this.content_document.getRoots(),n=0;n<t.length&&e;n++)t[n].isVisible()&&!1===t[n].options.lock&&!0===t[n].options.grid.pad_toggle&&(e=!1);return e},_toggleAllVisibleNodes:function(e){var t=this;this.content_document.withTransactionUpdate(function(){for(var n=t.content_document.getRoots(),o=0;o<n.length;o++)!0!==n[o].options.lock&&n[o].updateOptions({updateType:"visibility",grid:{pad_toggle:e}})})},_onNodeModelUpdate:function(e){var t={dataIndex:e.target.options.origin_dataIndex};switch(this._command_id){case"PrintOptions":case"ExportCSVOptions":t.exportable=e.target.options.grid.pad_toggle;for(var n={dataIndex:t.dataIndex,exportable:!t.exportable},o=!1,i=0;i<this._reverts.length;i++)if(this._reverts[i].dataIndex===n.dataIndex){o=!0;break}o||this._reverts.push(n);break;case"ColumnVisibility":e.target.options.editableLabel&&(t.headerName=e.target.options.label),t.column_color=e.target.options.grid.column_color,t.isHidden=!e.target.options.grid.pad_toggle}if("thumbnail"===t.dataIndex&&"visibility"===e.target.options.updateType&&this.comboCompact)if(t.isHidden)this.comboCompact.disabled(!1);else{for(var s=this.comboCompact.options.treedocument.getRoots(),a=0;a<s.length;a++){var r=s[a];"compact"===r.options.viewMode&&r.unselect(),"comfortable"===r.options.viewMode&&r.select()}this.comboCompact.dispatchEvent("onSelectionChange"),this.comboCompact.disabled(!0)}this.dispatchEvent("modifyColumRendering",t)},_processReverts:function(){var e=this;this._reverts.forEach(function(t){e.dispatchEvent("modifyColumRendering",t)}),this._reverts.length=0}})}),define("DS/PowerByHome/models/PowerByTreeDocument",["UWA/Core","DS/TreeModel/TreeDocument","DS/i3DXCompassServices/i3DXCompassPubSub","DS/PADCommands/PADModelEvents","DS/PADUtils/PADSettingsMgt","DS/PADUtils/PADUtilsServices","DS/PADUtils/PADWSAccess","DS/PADUtils/PADSession","DS/PADUtils/views/PADAlert","DS/PADUtils/PADCommandProxy","DS/PADUtils/PADTransactionManager","i18n!DS/PADUtils/assets/nls/PADUtils.json","DS/PowerByHome/models/PowerByNodeModel","DS/PowerByHome/models/PowerByWS","UWA/Utils/InterCom","DS/PADUtils/PADSecurityCtxConverter","i18n!DS/PowerByHome/assets/nls/PowerByApps.json","css!DS/PowerByHome/PowerByHome"],function(e,t,n,o,i,s,a,r,l,c,d,u,p,m,h,g,f){"use strict";var v,b,_;return t.extend(d,{defaultOptions:{detachTreeDocument:null,viewport:{}},init:function(i){var s=i||{};e.is(s.shouldAcceptDrop)||(s.shouldAcceptDrop=this._shouldAcceptDrop.bind(this)),e.is(s.shouldAcceptDrag)||(s.shouldAcceptDrag=this._shouldAcceptDrag.bind(this)),this._parent(i);var a=this;this.options.detachTreeDocument=new t,this.invalidateViewPort(),a.isPromiseExecuting=!1,o.subscribe({event:"PowerByTreeDocument/initContentFromSession"},a._initContentFromSession.bind(a)),o.subscribe({event:"PowerByTreeDocument/updateNodes"},a._updateNodes.bind(a)),o.subscribe({event:"PowerByTreeDocument/updateSecurityContext"},a._updateSecurityContext.bind(a)),o.subscribe({event:"PowerByTreeDocument/columnValue"},a._columnValue.bind(a)),o.subscribe({event:"PowerByTreeDocument/removeRootFromSession"},a._removeRootFromSession.bind(a)),o.subscribe({event:"PowerByTreeDocument/setTitle"},a._setTitle.bind(a)),o.subscribe({event:"selectFromWin"},a._selectFromBroadcast.bind(a)),o.subscribe({event:"PowerByTreeDocument/updateNodes/isExpandallNode"},function(e){v=e});var r=function(){if(!a._doNotBroadcastSelect){a._selected_paths=[];var e=a._buildSelectData();o.publish({event:"selectFromWeb",data:e});var t={widgetId:widget.id};n.publish("setTypes",t),a._set3DXContentData()}};this.getXSO().onPostAdd(r),this.getXSO().onPostRemove(r),this.getXSO().onEmpty(function(){!1===a._emptyFromProxy?a._doNotBroadcastSelect=!1:a._emptyFromProxy=!1,r()}),this.getXSO().onPreEmpty(function(){!1===a._emptyFromProxy&&(a._doNotBroadcastSelect=!0)});document.addEventListener("keyup",function(e){27===e.keyCode&&a.getXSO().empty()}),_=new Set},addDataToQueue:function(e){this.nodesToUpdate||(this.nodesToUpdate=[]),this.nodesToUpdateJobs||(this.nodesToUpdateJobs=[]),-1==this.nodesToUpdate.indexOf(e)&&this.nodesToUpdate.push(e)},_checkNodesToUpdate:function(){if(this.nodesToUpdate&&this.nodesToUpdate.length)for(var e=this.nodesToUpdate.length-1;e>=0;e--){null===this.getUniqueNodeById(this.nodesToUpdate[e])&&(this.nodesToUpdate.splice(e,1),this.nodesToUpdateJobs.erase(this.nodesToUpdate[e]))}},updateLinkableStatus:async function(t){this.isPromiseExecuting=!0;var n=t.from.nodesToUpdate;if(!n)return void(this.isPromiseExecuting=!1);let o=!1;try{if(n&&n.length>0){let n=await m.getdoinfo(t.from.nodesToUpdate);if(o=!0,this._computeDoInfo(t,n),t.from.nodesToUpdateJobs&&t.from.nodesToUpdateJobs.length>0){let e=await m.getdojobinfo(t.from.nodesToUpdateJobs);this._computeDoJobInfo(t,e)}console.log("wait for 5 seconds . . . . "),await new e.Promise((e,t)=>setTimeout(e,5e3)),console.log("5 seconds Timer expired . . . . "),console.log("-- XCAD updateLinkableStatus recursive call ---"),this.updateLinkableStatus({from:t.from})}else this.isPromiseExecuting=!1}catch(e){if(!o){let e=[];for(let n=0;n<t.from.nodesToUpdate.length;n++)e.push(t.from.nodesToUpdate[n]);t.from._updateNodesLinkable(e,"Unknown"),1==widget.getValue("computelinkablefromchild")&&0<e.length&&this.updateParentLinkableStatus({from:t.from})}this.isPromiseExecuting=!1,console.error(e)}},_computeDoInfo:function(e,t){var n=e.from.nodesToUpdate.slice(0);let o=t.ids,i=[];for(let t=0;t<o.length;t++)if(o[t].streams&&o[t].streams.length>0)for(let s=0;s<o[t].streams.length;s++)if("ExactGeometry"===o[t].streams[s].format){o[t].id&&n.erase(o[t].id);let a=o[t].streams[s].isSync;("boolean"==typeof a?a:"TRUE"===a.toUpperCase())?(i.push(o[t].id),_.has(o[t].id)&&_.delete(o[t].id)):-1==e.from.nodesToUpdateJobs.indexOf(o[t].id)&&e.from.nodesToUpdateJobs.push(o[t].id)}else-1==e.from.nodesToUpdateJobs.indexOf(o[t].id)&&e.from.nodesToUpdateJobs.push(o[t].id);else-1==e.from.nodesToUpdateJobs.indexOf(o[t].id)&&e.from.nodesToUpdateJobs.push(o[t].id);for(var s=0;s<n.length;s++)-1==e.from.nodesToUpdateJobs.indexOf(n[s])&&e.from.nodesToUpdateJobs.push(n[s]);e.from._updateNodesLinkable(i,"OK"),1==widget.getValue("computelinkablefromchild")&&0<i.length&&this.updateParentLinkableStatus({from:e.from})},_computeDoJobInfo:function(e,t){for(var n=t.ids,o=[],i=[],s=[],a=e.from.nodesToUpdateJobs.slice(0),r=0;r<n.length;r++)if(n[r].dojobs&&n[r].dojobs.length>0){for(var l=!1,c=!1,d=0;d<n[r].dojobs.length;d++)"ExactGeometry"===n[r].dojobs[d].target&&(l=!0,"Running"===n[r].dojobs[d].status||"Submitted"===n[r].dojobs[d].status?(s.push(n[r].id),c=!0):"Failed"===n[r].dojobs[d].status&&(i.push(n[r].id),c=!0));_.has(n[r].id)&&_.delete(n[r].id),l&&c&&a.erase(n[r].id)}else _.has(n[r].id)?_.delete(n[r].id):(_.add(n[r].id),a.erase(n[r].id));e.from._updateNodesLinkable(s,"Running"),e.from._updateNodesLinkable(i,"KO");for(d=0;d<a.length;d++)o.push(a[d]);e.from._updateNodesLinkable(o,"NA"),1==widget.getValue("computelinkablefromchild")&&0<s.length+i.length+o.length&&this.updateParentLinkableStatus({from:e.from})},_updateNodesLinkable:function(e,t){if(e.length>0){var n=this.getNodesByResourceIds(e);if(n.length>0&&this.withTransactionUpdate(function(){for(var e=0;e<n.length;e++)n[e].options.cadid&&!n[e].isHidden()&&n[e].updateOptions({cadid:n[e].options.cadid,grid:{linkableStatus:t}})}),"OK"===t||"NA"===t||"Unknown"===t||"KO"===t)for(var o=0;o<e.length;o++)this.nodesToUpdate.erase(e[o]),this.nodesToUpdateJobs.erase(e[o])}},updateParentLinkableStatus:function(e){var t=new Map;var n=e.from._getTrueRoot();n.getChildren()&&n.getChildren().forEach(function(n){var o=function n(o){var i="";if(o.getChildren()){let a=o.getChildren().length,r=0,l=0,c=0;for(const a of o.getChildren()){var s="";if(a.getChildren()&&null!=a._options.supportlinkableonchild&&1==a._options.supportlinkableonchild)if(s=n(a),null==a._options.resourceid?s="Empty":e.from.addNodetoUpdateToDoneList(s,a,t),"Empty"==s)c++;else{if("KO"==s){i="KO";break}if("Running"==s||"Unknown"==s){i="Running";break}"NA"==s?l++:"OK"==s&&r++}else if(a._options.grid&&a._options.resourceid&&null!=a._options.supportlinkableonchild&&1==a._options.supportlinkableonchild)e.from.addNodetoUpdateToDoneList("Empty",a,t),c++;else if(null==a._options.resourceid)c++;else{if(a._options.grid&&"KO"===a._options.grid.linkableStatus){i="KO";break}if(a._options.grid&&("Running"===a._options.grid.linkableStatus||"Unknown"===a._options.grid.linkableStatus)){i="Running";break}a._options.grid&&"NA"===a._options.grid.linkableStatus?l++:a._options.grid&&"OK"===a._options.grid.linkableStatus&&r++}}c==a?i="Empty":l+c==a?i="NA":l+r+c==a&&(i="OK")}return i}(n);n.getChildren()&&n._options.resourceid&&null!=n._options.supportlinkableonchild&&1==n._options.supportlinkableonchild&&null!=o?e.from.addNodetoUpdateToDoneList(o,n,t):n._options.resourceid&&n._options.grid&&null!=n._options.supportlinkableonchild&&1==n._options.supportlinkableonchild&&e.from.addNodetoUpdateToDoneList("Empty",n,t)}),t.forEach(function(t,n){"Empty"===n?e.from._updateNodesLinkable(t,void 0):e.from._updateNodesLinkable(t,n)})},addNodetoUpdateToDoneList:function(e,t,n){if(""!=e){var o=t._options.grid.linkableStatus,i=n.get(e);void 0===i&&(i=[],n.set(e,i)),e!==o&&-1==i.indexOf(t._options.resourceid)&&i.push(t._options.resourceid)}},_setTitle:function(e){s.isCloud()&&"onPremises"!==widget.getValue("current_tenant")&&(e.title=e.title.concat(" ("+widget.getValue("current_tenant")+")")),widget.setTitle(e.title)},_removeRootFromSession:function(e){function t(e){e.unselect(),e.getChildren()&&e.getChildren().forEach(function(e){t(e)})}this._doNotBroadcastSelect=!0;for(var n=this.getNodesByIds(e),i=0;i<n.length;i++)t(n[i]),this.removeRoot(n[i]);this._checkNodesToUpdate(),this._doNotBroadcastSelect=!1,o.publish({event:"PADCommand/RootVisibilityChange",data:{availableRoots:this.getRoots(),detachedRoot:this.options.detachTreeDocument}})},_initContentFromSession:function(e){let t=!1;var n=this;function i(e){var o=e;if(null!=o.showfilter&&Boolean(o.showfilter)&&(o.badges={bottomRight:"filter"}),o.children){for(var s=o.children,a=[],r=0;r<s.length;r++){var l=i(s[r]);l.hasChildren()&&l.setState({state:"expanded"}),a.push(l)}o.children=a}return o.grid&&o.resourceid&&""===o.grid.linkableStatus&&(n.addDataToQueue(o.resourceid),t=!0),1==widget.getValue("computelinkablefromchild")&&o.grid&&null!=o.supportlinkableonchild&&1==o.supportlinkableonchild&&(o.resourceid?o.grid.linkableStatus="":o.grid.compParentLinkableStatus=!0),new p(o)}for(var s=0;s<e.length;s++){var a=i(e[s]);a.hasChildren()&&a.setState({state:"expanded"}),this.addRoot(a)}1!=widget.getValue("computelinkablefromchild")||null!=n.nodesToUpdate&&0!==n.nodesToUpdate.length||n.updateParentLinkableStatus({from:n}),Boolean(t)&&(console.log("Before calling in init linkable status "),Boolean(n.isPromiseExecuting)||(console.log("Promise not running and executing init linkable status "),n.updateLinkableStatus({from:n}))),o.publish({event:"PADCommand/RootVisibilityChange",data:{availableRoots:this.getRoots(),detachedRoot:this.options.detachTreeDocument}})},_updateNodes:function(t){let n=!1,i=!1;var s=e.is(t,"string")?JSON.parse(t):t,a=this;a.withTransactionUpdate(function(){var e=a.getAllDescendants().filter(function(e){return!e.isHidden()}),t=new Map;e.forEach(function(e){var n=t.get(e.options.cadid);n?n.push(e):t.set(e.options.cadid,[e])});for(var o=[],r=0;r<s.length;r++){var l=t.get(s[r].cadid);l&&l.forEach(function(e){if(s[r].grid&&s[r].resourceid&&null!=s[r].grid.linkableStatus&&""===s[r].grid.linkableStatus&&(a.addDataToQueue(s[r].resourceid),i=!0),1==widget.getValue("computelinkablefromchild")&&s[r].grid&&s[r].resourceid&&null!=e.options.grid.compParentLinkableStatus&&1==e.options.grid.compParentLinkableStatus&&(s[r].grid.linkableStatus=""),null!=widget.getValue("isExpandNodeProtocol")&&Boolean(widget.getValue("isExpandNodeProtocol"))){b=!1;var n=!1;if(null!=s[r].singleupdateprotocol&&(n=s[r].singleupdateprotocol),null!=s[r].children&&null!=s[r].children)for(var l=0;l<s[r].children.length;l++){var c=a.updateChildNodes(s[r].children[l],t,o);c.hasChildren()&&c.getChildren().length>0&&Boolean(v)&&c.setState({state:"expanded"}),e.addChild(c)}else if(Boolean(n))null!=s[r].showfilter&&Boolean(s[r].showfilter)&&(s[r].badges={bottomRight:"filter"}),e.updateOptions(s[r]);else if(null==s[r].children){e.options.children=null,"noChildren"!=e.getState()&&e.setState({state:"noChildren"})}Boolean(b)&&(i=!0)}else null!=s[r].showfilter&&Boolean(s[r].showfilter)&&(s[r].badges={bottomRight:"filter"}),e.updateOptions(s[r])}),s[r].resourceid&&(n=!0)}1!=widget.getValue("computelinkablefromchild")||null!=a.nodesToUpdate&&0!==a.nodesToUpdate.length||a.updateParentLinkableStatus({from:a}),Boolean(i)&&(console.log("Before executing update linkable status "),Boolean(a.isPromiseExecuting)||(console.log("Promise not running and executing update linkable status "),a.updateLinkableStatus({from:a})))}),n&&o.publish({event:"PADCommand/ResourceIdUpdated",data:{availableRoots:this.getRoots()}})},updateChildNodes:function(e,t,n){var o=this;var i=function(e){if(null===e||"object"!=typeof e)return e;var t=e.constructor();for(var n in e)t[n]=e[n];return t}(e);if(i.grid&&i.resourceid&&null!=i.grid.linkableStatus&&""===i.grid.linkableStatus&&(o.addDataToQueue(i.resourceid),b=!0),null!=i.showfilter&&Boolean(i.showfilter)&&(i.badges={bottomRight:"filter"}),i.children){for(var s=i.children,a=[],r=0;r<s.length;r++){var l=o.updateChildNodes(s[r],t,n);l.hasChildren()&&l.getChildren().length>0&&Boolean(v)&&l.setState({state:"expanded"}),a.push(l)}if(!n.includes(i.cadid))(c=t.get(i.cadid))&&c.forEach(function(e){if(null!=e.getChildren()&&0==e.getChildren().length)for(var i=0;i<s.length;i++){var a=o.updateChildNodes(s[i],t,n);a.hasChildren()&&a.getChildren().length>0&&Boolean(v)&&a.setState({state:"expanded"}),e.addChild(a)}}),n.push(i.cadid);i.children=a}else if(null==i.children){var c;if(!n.includes(i.cadid))(c=t.get(i.cadid))&&c.forEach(function(e){null!=e.getChildren()&&0==e.getChildren().length&&(e.options.children=null,"noChildren"!=e.getState()&&e.setState({state:"noChildren"}))}),n.push(i.cadid)}return new p(i)},_processSecCtxts:function(t,n){var i=e.is(t,"string")?JSON.parse(t):t,s=g.prepareForStorage(i),a=s.securityContext,r=s.cspaces;console.log("---Results from GetSecCtxt WS..list---"+r),console.log("---Results from GetSecCtxt WS..default---"+a);for(var l=!1,c=0;c<r.length;c++){var d=r[c];if(n.context==d.value){console.log("---match found----"),l=!0;break}}if(l){console.log("-Match found for SecCtx to be updated--"+n.context),sessionStorage.removeItem("pad_security_ctx");for(var u={name:"pad_security_ctx",type:"list",label:"pad_security_ctx",options:[]},p=0;p<r.length;p++)u.options.push({value:r[p].value,label:r[p].label});widget.addPreference(u),widget.setValue("pad_security_ctx",n.context),console.log("---Widget pref updated----"),widget.dispatchEvent("endEdit")}else console.log("Not a valid security context"),o.publish({event:"updateSecCtxtResponse",data:{status:"failure",message:f.updateSecurityContext_NotValidSC}})},_updateSecurityContext:function(t){var n=e.is(t,"string")?JSON.parse(t):t;console.log("---Request to update SecCtxt to----"+n.context);var o=this,i=s.getPlatformId();a.getscandcollab({tenant:i,onComplete:function(e){console.log("---result of SCs----"+e),o._processSecCtxts(e,n)},onFailure:function(e){console.log("---get SCs failed---- "+e)}})},getUniqueNodeById:function(e){var t=this.getNodesById(e);return t&&t.length>0?t[0]:null},getUniqueNodesByIds:function(e){for(var t=[],n=0;n<e.length;n++){var o=this.getNodesById(e[n]);o&&o.length>0&&t.push(o[0])}return t},getNodesByIds:function(e){for(var t=[],n=0;n<e.length;n++){var o=this.getNodesById(e[n]);t.push.apply(t,o)}return t},getNodesById:function(e){return this.search({match:function(t){return t.nodeModel.options.cadid===e||t.nodeModel.options.resourceid===e}})},getNodesByResourceIds:function(e){return this.search({match:function(t){return e.indexOf(t.nodeModel.options.resourceid)>=0}})},getNodeByOccurencePath:function(e){for(var t=this.getRoots(),n=0;n<t.length;n++){var o=t[n].getNodeByPath(e,void 0,void 0,!0);if(o)return o}},_columnValue:function(t){for(var n=e.is(t,"string")?JSON.parse(t):t,i=this.getUniqueNodesByIds(n.cadids),s=[],a=0;a<i.length;a++){var r=i[a];if(r){var l=r.getAttributeValue(n.column),c={cadid:r.options.cadid};c[n.column]=l,s.push(c)}}o.publish({event:"columnValueResult",data:s})},_shouldAcceptDrop:function(){return!1},_shouldAcceptDrag:function(){return!0},invalidateViewPort:function(){this.options.viewport={graph:null,tree:null,tiles:null,thumbnails:null}},prepareBroadcastSelect:function(){},pushBroadcastSelect:function(){},_buildSelectData:function(){var e=[],t=this._selected_paths;!0===i.getSetting("add_objects_when_select")&&t.length&&this.getXSO().get().length?this.getRoots().forEach(function(n){for(var o=0;o<t.length;o++){var i=n.getNodeByPath(t[o],void 0,void 0,!0);i&&e.push(i)}}):e=this.getXSO().get();var n,o={paths:[],cadidPaths:[]};o.attributes={},o.version="1.1";return n=function(e){if(e.getCADID()){var t=e.getCADID();this.attributes.hasOwnProperty(t)||(this.attributes[t]={type:e.options.type,label:e.options.label})}if(e.getID()){var n=e.getID();this.attributes.hasOwnProperty(n)||this.attributes.hasOwnProperty(t)||(this.attributes[n]={type:e.options.type,label:e.options.label})}}.bind(o),o.paths=e.map(function(e){return e.getOccurencePath(n)}),o.cadidPaths=e.map(function(e){return e.getOccurenceCADIDPath(n)}),o},_selectOccurence:function(){var e=this.getRoots(),t=this._selected_paths;if(t.length>0){this._doNotBroadcastSelect=!0,this.prepareUpdate();var n=[];e.forEach(function(e){for(var o=0;o<t.length;o++){var i=e.getNodeByPath(t[o]);i&&(n.push(i),i.isSelected()||i.select())}});for(var o=this.getSelectedNodes(),i=0;i<o.length;i++){var s=o[i];n.indexOf(s)<0&&s.unselect()}this.pushUpdate(),this._doNotBroadcastSelect=!1}},_selectFromBroadcast:function(t){var n=this,o=(t.paths,t.cadidPaths);void 0!==o&&(n._selected_paths=e.clone(o));!function(){try{n._doNotBroadcastSelect=!0;for(var e=0;e<n._selected_paths.length;e++)if(null===n._selected_paths[e])return;n._selected_paths.length?n._selectOccurence():(n._emptyFromProxy=!0,n.unselectAll());for(var t=[],o=0;o<n._selected_paths.length;o++)n.getNodeByOccurencePath(n._selected_paths[o])&&t.push(n._selected_paths[o]);n._selected_paths=t}finally{setTimeout(function(){n._doNotBroadcastSelect=!1},500)}}()},_set3DXContentData:function(){var t=e.is(widget)&&widget.id?"padcompassSocket_"+widget.id:"padcompassSocket";this.padintercom||(this.padintercom=new h.Socket(t),this.padintercom.subscribeServer("com.ds.compass",window.parent));var n=this.getSelectedNodes();if(0===n.length)this.padintercom.dispatchEvent("onResetX3DContent",{},t);else{var o={protocol:"3DXContent",version:"1.0",source:widget&&widget.getValue("x3dAppId")?widget.getValue("x3dAppId"):"ENOSTDE_AP",data:{items:[]}};n.forEach(function(e){e.getID()&&o.data.items.push({envId:s.getPlatformId(),serviceId:"3DSpace",contextId:i.getSetting("pad_security_ctx")?i.getSetting("pad_security_ctx"):void 0,objectId:e.getID(),objectType:e.options.type,path:void 0})}),this.padintercom.dispatchEvent("onSetX3DContent",o,t)}}})}),define("DS/PowerByHome/PowerByTreeListViewUtils",["UWA/Core","UWA/Class","DS/PowerByHome/utils/PowerBySettings","DS/PADUtils/PADUtilsServices","DS/PADUtils/PADSettingsMgt","DS/PADCommands/PADModelEvents","DS/Utilities/Dom","DS/Utilities/Utils","DS/PADUtils/PADPredicatesNls","i18n!DS/PowerByHome/assets/nls/PowerByApps.json","i18n!DS/PADUtils/assets/nls/PADUtils.json"],function(e,t,n,o,i,s,a,r,l,c,d){"use strict";var u=null,p=null;return t.extend({buildTreeListColumns:function(t,o){for(var i=this,s=[],a=[],r=[],l=n.getSetting("columnDefinition"),c=[],d={width:40,minWidth:40,maxWidth:40,dataIndex:"selection",type:"selection",isDraggable:!0,isHidden:!0,customisation:{exportable:{lock:!0,value:!1},layout:{lock:!1,hidden:!0}}},u=0;u<l.length;u++){var p=l[u];e.is(p.ds6w)&&-1===p.ds6w.indexOf("ds6wg")?a.push(p.ds6w):r.push(p.dataIndex),c.push(p.dataIndex)}var m=function(t){var n=e.extend({isDraggable:!t.customisation.layout.lock,isHidden:t.customisation.layout.hidden,minWidth:15,overloadedTooltip:t.tooltip?t.tooltip:void 0},t,!0);return n.text=t.text,e.is(i.onCellRequest[t.dataIndex],"function")&&(n.onCellRequest=i.onCellRequest[t.dataIndex]),n};!function(t){if(t){for(var n=[],o=0;o<t.length;o++)n.push(t[o].dataIndex);-1===n.indexOf("selection")&&s.push(d);for(var i=0;i<t.length;i++){var a=t[i],r=null,u=c.indexOf(a.dataIndex);if("selection"===a.dataIndex&&(s.push(a),u=-1),-1!==u&&(r=m(a)),r){var p=e.extend(r,a,!0);s.push(p)}}}else for(s.push(d),i=0;i<l.length;i++){var h=m(l[i]);s.push(h)}}(t.customisation&&t.customisation.view_settings?t.customisation.view_settings.columnDefinition:null),o(s)},onShouldDisplayTooltip:function(t){var n={longHelp:""};if(t.isHeader){n.longHelp=function(t){var n="";if(""===t.text||null===t.text||void 0===t.text){var o="treelistview_customization_"+t.dataIndex;n=e.is(d[o])?d[o]:t.dataIndex}else n=t.text;return n}(this.getManager().getColumnOptions(t.dataIndex))}else{var o=this.getManager().getColumnOptions(t.dataIndex).overloadedTooltip;if(e.is(this.onProvideTooltip[t.dataIndex]))n=this.onProvideTooltip[t.dataIndex](t);else if(o&&t.nodeModel.options.grid[o])n.longHelp=t.nodeModel.options.grid[o];else{var i="";switch(typeof t.cellModel.options.value){case"string":-1<(i=t.cellModel.options.value).search("&quot;")&&(i=i.replace(/&quot;/g,'"'));break;case"boolean":i=t.cellModel.options.value?"TRUE":"FALSE";break;case"undefined":i=""}n.longHelp=i}}return n},onProvideTooltip:{selection:function(e){return{longHelp:e.nodeModel.isSelected?e.nodeModel.isSelected()?d.selected:d.notSelected:""}},tree:function(e){return{longHelp:e.nodeModel.getLabel?e.nodeModel.getLabel():""}},"ds6w:reserved":function(e){var t="undefined"!=typeof widget?widget.getValue("enoxcadodtenv"):"false",n={longHelp:""},i=e.nodeModel.options.grid["ds6w:reserved"];if(null!=i){n.longHelp=d.notReserved;var s=e.nodeModel.options.grid.reservedById?e.nodeModel.options.grid.reservedById:"",a=e.nodeModel.options.grid["ds6w:reservedBy"]?e.nodeModel.options.grid["ds6w:reservedBy"]:"";if("boolean"==typeof i?i:null){null===u&&(u=o.getUserLogin()),null===p&&(p=o.getUserName()),"true"===t&&(u="",p="");var r=!0;s.trim().length>0&&u?r=s.toUpperCase().trim()===u.toUpperCase().trim()||!1:a.trim().length>0&&((r=a.toUpperCase().trim()===u.toUpperCase().trim()||!1)||(r=a.toUpperCase().trim()===p.toUpperCase().trim()||!1)),n.longHelp=r?d.reservedByMe:d.replace(d.get("reservedByOther"),{who:a})}}return n}},onCellClickAction:function(t){if(!(t.cellModel&&t.cellModel.options&&t.cellModel.options.isHeader)){var n=this.onCellClick[t.dataIndex];e.is(n,"function")&&n.call(this,t)}},onCellRequest:{"ds6w:reserved":function(e){var t="undefined"!=typeof widget?widget.getValue("enoxcadodtenv"):"false";if(console.log("New code to detect ODT env: isodtenv->"+t),e.isHeader)e.cellView.getContent().empty();else{var n=!1,i=void 0!==e.nodeModel.options.grid["ds6w:reserved"]?e.nodeModel.options.grid["ds6w:reserved"]:"";if(null!=i){var s=e.nodeModel.options.grid.reservedById?e.nodeModel.options.grid.reservedById:"",a=e.nodeModel.options.grid["ds6w:reservedBy"]?e.nodeModel.options.grid["ds6w:reservedBy"]:"";n="boolean"==typeof i?i:null;var r=e.cellView.reuseCellContent("padresuable_unreserved");if(r&&n){null===u&&(u=o.getUserLogin()),null===p&&(p=o.getUserName()),"true"===t&&(u="",p="");var l=!0;s.trim().length>0&&u?l=s.toUpperCase().trim()===u.toUpperCase().trim()||!1:a.trim().length>0&&((l=a.toUpperCase().trim()===u.toUpperCase().trim()||!1)||(l=a.toUpperCase().trim()===p.toUpperCase().trim()||!1)),r=l?e.cellView.reuseCellContent("padresuable_reserved"):e.cellView.reuseCellContent("padresuable_reservedBy_other")}}else e.cellView.getContent().empty()}},"ds6wg:PLMReference.V_isLastVersion":function(e){if(!e.isHeader){var t=e.cellModel.options.value?e.cellModel.options.value:e.nodeModel.options.grid["ds6wg:PLMReference.V_isLastVersion"]?e.nodeModel.options.grid["ds6wg:PLMReference.V_isLastVersion"]:"";void 0!==t&&""!==t?(t="boolean"==typeof t?t:"TRUE"===t.toUpperCase())?e.cellView.reuseCellContent("check"):e.cellView.reuseCellContent("wrong"):e.cellView.getContent().empty()}},isLastRevision:function(e){if(!e.isHeader){let t=e.nodeModel.options.grid.isLastRevision;void 0!==t&&""!==t&&null!==t?(t="boolean"==typeof t?t:"TRUE"===t.toUpperCase())?e.cellView.reuseCellContent("check_green"):e.cellView.reuseCellContent("wrong_red"):e.cellView.getContent().empty()}},"ds6w:created":function(e){if(!e.isHeader){var t=e.cellModel.options.value,n=Date.parse(t);isNaN(n)||(t=new Date(n).toLocaleString()),e.cellView.getContent().setHTML(t)}},"ds6w:modified":function(e){if(!e.isHeader){var t=e.cellModel.options.value,n=Date.parse(t);isNaN(n)||(t=new Date(n).toLocaleString()),e.cellView.getContent().setHTML(t)}}},onCellClick:{},registerReusableCellContent:function(){this.getManager().registerReusableCellContent({id:"padresuable_unreserved",buildContent:function(){return a.createElement("span",{class:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-lock-open pad_unlock",style:"color:#b4b6ba; font-size: 22px;"})}}),this.getManager().registerReusableCellContent({id:"padresuable_reserved",buildContent:function(){return a.createElement("span",{class:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-key pad_lock",style:"color:#57b847; font-size: 22px;"})}}),this.getManager().registerReusableCellContent({id:"padresuable_reservedBy_other",buildContent:function(){var e=a.createElement("span",{class:"pad_reserved_by",style:"font-size: 22px;"}),t=a.createElement("span",{class:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-lock pad_lock",style:"color:#ea4f37; font-size: 22px;"});return e.appendChild(t),e}}),this.getManager().registerReusableCellContent({id:"check",buildContent:function(){return a.createElement("span",{class:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-check"})}}),this.getManager().registerReusableCellContent({id:"wrong",buildContent:function(){return a.createElement("span",{class:"wux-ui-3ds wux-ui-3ds-1x  wux-ui-3ds-wrong"})}}),this.getManager().registerReusableCellContent({id:"check_green",buildContent:function(){return a.createElement("span",{class:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-check",style:"color:#57B847"})}}),this.getManager().registerReusableCellContent({id:"wrong_red",buildContent:function(){return a.createElement("span",{class:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-wrong",style:"color:red"})}})},initializePreferencesMgt:function(){var e=this,t=this.getManager(),n=r.debounce(function(t){e.custoViewChange()},1e3);t.onReady(function(){t.onColumnWidthUpdate(n),t.onMoveColumn(n),e.custoViewChange()})},custoViewChange:function(){var e,t={};t.columnDefinition=this.getManager().getColumns(),e=JSON.parse(localStorage.getItem("ENOWSES_AP_Custo")),t.basicTreelistopts=e.basicTreelistopts,localStorage.setItem("ENOWSES_AP_Custo",JSON.stringify(t))},modifyColumRendering:function(t,n){var o=e.is(t,"string")?JSON.parse(t):t,i=this.getManager().getColumnOptions(o.dataIndex),s=!1;if(i){var a=i.text;if(o.headerName&&o.headerName!==a&&(i.text=o.headerName,i.customisation&&(!0===n?delete i.customisation.titleModified:i.customisation.titleModified=!0),s=!0),void 0!==o.isHidden&&o.isHidden!==i.isHidden&&(i.isHidden?this.getManager().showColumn(i.dataIndex):this.getManager().hideColumn(i.dataIndex),i.customisation.layout.hidden=i.isHidden),void 0!==o.exportable&&o.exportable!==i.customisation.exportable.value&&(i.customisation.exportable.value=o.exportable),o.column_color){i.customisation.layout.styles=o.column_color,i.customisation.layout.styles||(i.customisation.layout.styles={}),i.customisation.layout.styles.color=o.column_color.color,i.customisation.layout.styles["background-color"]=o.column_color["background-color"];var r=i.customisation.layout.styles;this._updateColumnStyles(i.dataIndex,r),this.custoViewChange()}}s&&this.getManager().updateView(!0)},reset:function(){localStorage.setItem("ENOWSES_AP_Custo","reset");var e=this,t=s.subscribe({event:"HomeComponent/rebuildColumns"},function(n){s.unsubscribe(t),e.buildTreeListColumns(n,function(t){e.loadColumns(t);for(var n=0;n<t.length;n++){var o={};o=t[n].customisation.layout.styles?t[n].customisation.layout.styles:{color:"#000000","background-color":"#ffffff"},e._updateColumnStyles(t[n].dataIndex,o)}})});s.publish({event:"readyForInit"})},_updateColumnStyles:function(t,n){var o=[];try{var i=document.styleSheets[0];i.cssRules?o=i.cssRules:i.rules&&(o=i.rules)}catch(e){console.log("Catch inside _updateColumnStyles")}var s="."+this.name+' .wux-datagrid-cell[data-index="'+t+'"]',a=this._getBrowserSelector(s),r=function(e,t,n){for(var o=e.length;--o;){var i=e[o];if(n(t,i))return{item:i,index:o}}return null}(o,a,function(e,t){return t.selectorText==e});null!==r&&i.deleteRule(r.index);var l="{}";e.is(n,"object")&&(l=(l=(l=JSON.stringify(n)).replace(/"/g,"")).replace(/,/g,"")),"{}"!=l&&i.insertRule(a+l,o.length)},_getBrowserSelector:function(e){var t=document.styleSheets,n=t[t.length-1],o=-1,i=null;try{if(n.cssRules)o=n.insertRule(e+"{}",n.cssRules.length),i=(n.cssRules||n.rules)[o].selectorText}catch(e){console.log("Catch inside _getBrowserSelector")}finally{o>=0&&n.deleteRule(o)}return i}})}),define("DS/PowerByHome/views/PowerByTreeListView",["DS/Tree/TreeListView","DS/PowerByHome/utils/PowerBySettings","DS/PADCommands/PADModelEvents","DS/Utilities/Dom","DS/PowerByHome/PowerByTreeListViewUtils","DS/WebappsUtils/WebappsUtils","i18n!DS/PowerByHome/assets/nls/PowerByApps.json"],function(e,t,n,o,i,s,a){"use strict";var r=["CATIAV5","SOLIDWORKS","NX","CREO","SOLIDEDGE","ALTIUM","INVENTOR","AUTOCAD","CAAUPSAPP","CADENCEALLEGRO","3DEXPERIENCE","EPLAN","DRAFTSIGHT","REVIT"],l=["NA","Obsolete","Running","OK","KO","Unknown",""];return e.extend(i,{name:"powerBytreelst",init:function(e){var o=this,i=require("DS/PADUtils/PADSettingsMgt"),s=e||{},a=this._parent.bind(this);null!=(s=UWA.extend(s,t.getSetting("basicTreelistopts"),!0)).enableprotocol_expandnode&&widget.setValue("isExpandNodeProtocol",s.enableprotocol_expandnode),this.buildTreeListColumns({customisation:e.customisation},function(t){s.columns=t,s.shouldDisplayTooltip=o.onShouldDisplayTooltip.bind(o),a(s),o.getContent().setStyles({position:"absolute",top:0,left:0,bottom:0,right:0}),o.getContent().addClassName(o.name),"powerBytreelst"!==o.name&&o.getContent().addClassName("powerBytreelst"),e.renderTo&&!0===e.isActiveView&&o.inject(e.renderTo),!0===i.getSetting("enablePerformanceAnalysis")&&o.getManager().enablePerformanceAnalysis(),o.registerReusableCellContent(),o.initializePreferencesMgt(),o.getManager().onCellClick(o.onCellClickAction.bind(o)),o.updateColumns(),n.publish({event:"PowerByHome/TreeListView/Ready",data:o})}),widget.showColumnToken&&n.unsubscribe(widget.showColumnToken),widget.showColumnToken=n.subscribe({event:"PowerByTreeListView/showColumn"},o._showColumn.bind(o)),widget.hideColumnToken&&n.unsubscribe(widget.hideColumnToken),widget.hideColumnToken=n.subscribe({event:"PowerByTreeListView/hideColumn"},o._hideColumn.bind(o))},_showColumn:function(e){try{const t=(UWA.is(e,"string")?JSON.parse(e):e).dataIndex;let n=this.getManager().getColumnOptions(t);n.isHidden&&(this.getManager().showColumn(t),n.customisation.layout.hidden=!1)}catch(e){console.error("Failed in PowerByTreeListView _showColumn() method. Please send valid dataIndex."),console.log(e)}},_hideColumn:function(e){try{const t=(UWA.is(e,"string")?JSON.parse(e):e).dataIndex;let n=this.getManager().getColumnOptions(t);n.isHidden||(this.getManager().hideColumn(t),n.customisation.layout.hidden=!0)}catch(e){console.error("Failed in PowerByTreeListView _hideColumn() method. Please send valid dataIndex."),console.log(e)}},setModel:function(e){this.inject(this.options.renderTo),this.options.isActiveView=!0,this.getManager().loadDocument(e),null!==e.options.viewport.tree&&void 0!==e.options.viewport.tree&&this.getManager().setScrollerPosition(e.options.viewport.tree)},unsetModel:function(){var e=this.getManager();e.getScrollerPosition&&(this.getDocument().options.viewport.tree=e.getScrollerPosition()),this.getOption("renderTo").removeChild(this.elements.container),this.options.isActiveView=!1,this.getManager().unloadDocument()},updateColumns:function(){for(var e=this.getManager().getColumns(),t=0;t<e.length;t++)e[t].customisation.layout&&e[t].customisation.layout.styles&&this._updateColumnStyles(e[t].dataIndex,e[t].customisation.layout.styles)},registerReusableCellContent:function(){this._parent(),this.getManager().registerReusableCellContent({id:"asyncSave",buildContent:function(){var e=s.getWebappsAssetUrl("PowerByHome","icons/status/I_asyncSave.png");return o.createElement("img",{src:e,width:22,height:22})}}),this.getManager().registerReusableCellContent({id:"newInCAD",buildContent:function(){var e=s.getWebappsAssetUrl("PowerByHome","icons/status/I_newInCAD.png");return o.createElement("img",{src:e,width:22,height:22})}}),this.getManager().registerReusableCellContent({id:"notDownloaded",buildContent:function(){var e=s.getWebappsAssetUrl("PowerByHome","icons/status/I_notDownloaded.png");return o.createElement("img",{src:e,width:22,height:22})}}),this.getManager().registerReusableCellContent({id:"incorrectFileLocation",buildContent:function(){var e=s.getWebappsAssetUrl("PowerByHome","icons/status/I_incorrectFileLocation.png");return o.createElement("img",{src:e,width:22,height:22})}}),this.getManager().registerReusableCellContent({id:"unknownByServer",buildContent:function(){var e=s.getWebappsAssetUrl("PowerByHome","icons/status/I_unknownByServer.png");return o.createElement("img",{src:e,width:22,height:22})}}),this.getManager().registerReusableCellContent({id:"knownByServer_localFileOlderThanServerFile",buildContent:function(){var e=s.getWebappsAssetUrl("PowerByHome","icons/status/I_knownByServer_localFileOlderThanServerFile.png");return o.createElement("img",{src:e,width:22,height:22})}}),this.getManager().registerReusableCellContent({id:"knownByServer_metadataHaveChangedOnServer",buildContent:function(){var e=s.getWebappsAssetUrl("PowerByHome","icons/status/I_knownByServer_metadataHaveChangedOnServer.png");return o.createElement("img",{src:e,width:22,height:22})}}),this.getManager().registerReusableCellContent({id:"knownByServer_modifiedInCADSession",buildContent:function(){var e=s.getWebappsAssetUrl("PowerByHome","icons/status/I_knownByServer_modifiedInCADSession.png");return o.createElement("img",{src:e,width:22,height:22})}}),this.getManager().registerReusableCellContent({id:"knownByServer_modifiedSinceDownload",buildContent:function(){var e=s.getWebappsAssetUrl("PowerByHome","icons/status/I_knownByServer_modifiedSinceDownload.png");return o.createElement("img",{src:e,width:22,height:22})}}),this.getManager().registerReusableCellContent({id:"knownByServer_modifiedBySynchronization",buildContent:function(){var e=s.getWebappsAssetUrl("PowerByHome","icons/status/I_knownByServer_modifiedBySynchronization.png");return o.createElement("img",{src:e,width:22,height:22})}}),this.getManager().registerReusableCellContent({id:"knownByServer_unmodifiedSinceDownload",buildContent:function(){var e=s.getWebappsAssetUrl("PowerByHome","icons/status/I_knownByServer_unmodifiedSinceDownload.png");return o.createElement("img",{src:e,width:22,height:22})}}),this.getManager().registerReusableCellContent({id:"modifiedAfterExport",buildContent:function(){var e=s.getWebappsAssetUrl("PowerByHome","icons/status/I_modifiedAfterExport.png");return o.createElement("img",{src:e,width:22,height:22})}}),this.getManager().registerReusableCellContent({id:"replaceFromPkg",buildContent:function(){var e=s.getWebappsAssetUrl("PowerByHome","icons/status/I_replaceFromPkg.png");return o.createElement("img",{src:e,width:22,height:22})}});for(var e=0;e<r.length;e++)this.getManager().registerReusableCellContent({id:r[e],buildContent:function(){var e=o.createElement("span",{class:"cadmaster"}),t=o.createElement("img",{class:"cadmasterIcon",src:s.getWebappsAssetUrl("PowerByHome","icons/cad/I_CADMaster"+this._identifier+".png")});return e.appendChild(t),e}});for(var t=0;t<l.length;t++)this.getManager().registerReusableCellContent({id:l[t],buildContent:function(){var e=o.createElement("span",{class:"linkablestatus"}),t=o.createElement("img",{class:"linkablestatusIcon",src:s.getWebappsAssetUrl("PowerByHome","icons/linkable/I_LinkableStatus"+this._identifier+".png")});return e.appendChild(t),e}})},onProvideTooltip:{sessionStatus:function(e){var t={longHelp:""};switch(e.nodeModel.options.grid.sessionStatus){case"asyncSave":t.longHelp=a.asyncSave;break;case"newInCAD":t.longHelp=a.newInCAD;break;case"notDownloaded":t.longHelp=a.notDownloaded;break;case"incorrectFileLocation":t.longHelp=a.incorrectFileLocation;break;case"unknownByServer":t.longHelp=a.unknownByServer;break;case"knownByServer_localFileOlderThanServerFile":t.longHelp=a.knownByServer_localFileOlderThanServerFile;break;case"knownByServer_metadataHaveChangedOnServer":t.longHelp=a.knownByServer_metadataHaveChangedOnServer;break;case"knownByServer_modifiedInCADSession":t.longHelp=a.knownByServer_modifiedInCADSession;break;case"knownByServer_unmodifiedSinceDownload":t.longHelp=a.knownByServer_unmodifiedSinceDownload;break;case"knownByServer_modifiedSinceDownload":t.longHelp=a.knownByServer_modifiedSinceDownload;break;case"knownByServer_modifiedBySynchronization":t.longHelp=a.knownByServer_modifiedBySynchronization;break;case"modifiedAfterExport":t.longHelp=a.modifiedAfterExport;break;case"replaceFromPkg":t.longHelp=a.replaceFromPkg_toolTip}return t},linkableStatus:function(e){var t={longHelp:""};switch(e.nodeModel.options.grid.linkableStatus){case"":t.longHelp=a.linkableStatus_Initial;break;case"NA":t.longHelp=a.linkableStatus_NA;break;case"Running":t.longHelp=a.linkableStatus_Running;break;case"KO":t.longHelp=a.linkableStatus_KO;break;case"OK":t.longHelp=a.linkableStatus_OK;break;case"Obsolete":t.longHelp=a.linkableStatus_Outdated;break;case"Unknown":t.longHelp=a.linkableStatus_Unknown}return t}},onCellRequest:{sessionStatus:function(e){if(!e.isHeader)switch(e.nodeModel.options.grid.sessionStatus){case"asyncSave":e.cellView.reuseCellContent("asyncSave");break;case"newInCAD":e.cellView.reuseCellContent("newInCAD");break;case"notDownloaded":e.cellView.reuseCellContent("notDownloaded");break;case"incorrectFileLocation":e.cellView.reuseCellContent("incorrectFileLocation");break;case"unknownByServer":e.cellView.reuseCellContent("unknownByServer");break;case"knownByServer_localFileOlderThanServerFile":e.cellView.reuseCellContent("knownByServer_localFileOlderThanServerFile");break;case"knownByServer_metadataHaveChangedOnServer":e.cellView.reuseCellContent("knownByServer_metadataHaveChangedOnServer");break;case"knownByServer_modifiedInCADSession":e.cellView.reuseCellContent("knownByServer_modifiedInCADSession");break;case"knownByServer_unmodifiedSinceDownload":e.cellView.reuseCellContent("knownByServer_unmodifiedSinceDownload");break;case"knownByServer_modifiedSinceDownload":e.cellView.reuseCellContent("knownByServer_modifiedSinceDownload");break;case"knownByServer_modifiedBySynchronization":e.cellView.reuseCellContent("knownByServer_modifiedBySynchronization");break;case"modifiedAfterExport":e.cellView.reuseCellContent("modifiedAfterExport");break;case"replaceFromPkg":e.cellView.reuseCellContent("replaceFromPkg")}},"ds6w:cadMaster":function(e){if(!e.isHeader){var t=null,n=e.cellModel.options.value;if(n&&(n=n.replace(/[\[\]]/g,"")),-1!==r.indexOf(n)&&(t=e.cellView.reuseCellContent(n)),t){var i=e.manager.getRowHeight();26===i&&!1===o.hasClass(t,"compact")?t.className="cadmaster compact":38===i&&o.hasClass(t,"compact")&&(t.className="cadmaster")}else e.cellView.getContent().setHTML(e.cellModel.options.value)}},linkableStatus:function(e){if(!e.isHeader){var t=null,n=e.cellModel.options.value;if(-1!==l.indexOf(n)&&(t=e.cellView.reuseCellContent(n)),t){var i=e.manager.getRowHeight();26===i&&!1===o.hasClass(t,"compact")?t.className="linkablestatus compact":38===i&&o.hasClass(t,"compact")&&(t.className="linkablestatus")}else e.cellView.getContent().setHTML(e.cellModel.options.value)}}},centerNode:function(e){this.getManager().scrollToNode(e,"middle",!0)}})});