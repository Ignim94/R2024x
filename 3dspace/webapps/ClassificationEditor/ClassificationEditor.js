function ClassificationEditor(e){"use strict";var t={leftPanelState:!0,isWelcomePanelCollapsed:!1},i={rightPanelState:!1,size:300},a={widget:null,filterFromWin:null,libraryContent_Cont:null,libraryContentController:null,libraryTree_div:null,libraryTreeDoc_div:null,libraryTree_Cont:null,libraryIdCard_div:null,libraryIdCard_Cont:null,core:null,widthToHideLeftPanel:300,_actionbar:null,libraryTree_W_NotLinked:!1,css_view_class:"windowed",_mouseEventsManager:{unlockMouseMove:!1,draggingXSlider:null,mouseStartXSlider:null,initialMouseStartXSlider:null,dragginDirection:null,cancelDragging:!1,spanPosition:null,widthLeftDiv:null,widthRightDiv:null,widthLeftDivSave:null,widthRightDivSave:null,widthGlobalDiv:null,newWidthGlobalDiv:null},init:function(e){var a=this;require(["DS/ClassificationEditor/dataProvider/LibraryContentDataProvider","DS/IPClassifyUX/utils/IPClassifyWidgetData"],function(e,t){t.setIsEditModeEnabled(!1),e.hasLibrarianRole().then(function(e){e="string"==typeof e?JSON.parse(e):e,t.setReadOnly(e.readOnly)}).catch(e=>console.log(e.message))}),require(["DS/ClassificationEditor/utils/ClassificationEditorUtil"],function(e){var a=e.getLeftPanelStatus(),r=e.getRightPanelStatus();Promise.all([a,r]).then(function(e){t=e[0],i=e[1]})}),require(["DS/PADUtils/PADSettingsMgt"],function(e){e.setSetting("columnParametrization",!0),e.setSetting("activateTXO",!0)}),require(["DS/IPClassifyUtil/IPClassifyUtility"],function(e){e.isCustomizedEnv(),e.initURLSAsync().then(function(){a.migratePreferences()})}),this.widget=e.widget,this.dataForActiveClassODT=e.dataForActiveClassODT,e.defaultSelectionPath&&(this.widget.defaultSelectionPathFromWin="root,LibrarySection_AllLibraries,"+e.defaultSelectionPath),require(["DS/ClassificationEditor/utils/ClassificationEditorcontrol"],function(e){e.setWidgetRefresh(a.onRefresh.bind(a))}),require(["DS/ClassificationEditor/utils/Library_CSO"],function(t){e.reInitialize&&(t._currentLibrary={noTree:!0,getType:function(){return"Exception"}},t._currentLibraryPath=null)}),this.widget.removeEvent("onLoad"),this.widget.removeEvent("onRefresh"),this.widget.removeEvent("onDestroy"),this.widget.removeEvent("onResize"),this.widget.removeEvent("onEdit"),this.widget.removeEvent("endEdit"),this.widget.addEvent("onLoad",this.onLoad.bind(this)),this.widget.addEvent("onRefresh",this.onRefresh.bind(this)),this.widget.addEvent("onDestroy",this.onDestroy.bind(this)),this.widget.addEvent("onResize",this.onResize.bind(this)),this.widget.changeInPreference={};var r={},n={};this.widget.addEvent("onEdit",function(){a.widget.preferences.forEach(function(e){"hidden"!==e.type&&(r[e.name]=a.widget.getValue(e.name))})}),this.widget.addEvent("endEdit",function(e){!(!e||!e.submitted&&!e.needRefresh)&&(a.widget.changeInPreference={},Object.keys(r).forEach(function(e){n[e]=a.widget.getValue(e),r[e]!==n[e]&&(a.widget.changeInPreference[e]=n[e])}))})},doRefresh:function(e,t,i,a,r,n){var o=this,s=[];s.push(r.initURLSAsync()),o.widget.changeInPreference.x3dPlatformId&&(o.widget.changeInPreference={}),Promise.all(s).then(function(){var s=r.isIndexedMode();if(a.getContent().updateFilterBI(s),a.getContent().updateComputedColumns(),o.libraryContent_Cont.addEvent("onCompleteRefreshNodes",function(e){this.removeEvent("onCompleteRefreshNodes"),t.displayNotification({message:i.msg_info_refresh,className:"primary"})}),n&&UWA.is(n.authored.deleted,"array")){var l=e.getCurrentLibrary();null!=l&&l.getID()===n.authored.deleted[0]&&l.getParent().select(!0)}a.getTreeCont().refreshLibraryTree(),a.getContent().refreshLibraryContent()})},onRefresh:function(e){var t=this;e&&e.reInitialize?t._onReInit():require(["DS/ClassificationEditor/utils/Library_CSO","DS/IPClassifyUtil/IPClassifyAlert","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor","DS/PADUtils/PADContext","DS/ClassificationEditor/utils/ClassificationEditorcontrol","DS/IPClassifyUtil/IPClassifyUtility","DS/ClassificationEditor/ActionBar/ClassificationCommandManager","DS/ClassificationEditor/utils/ClassificationEditorUtil","DS/IPClassifyUX/utils/IPClassifyWidgetData","DS/IPClassifyUXUtil/IPClassifyConfirmation"],function(i,a,r,n,o,s,l,d,c,u){c.getIsEditModeEnabled()?null==document.querySelector(".right-actions.fonticon.fonticon-cancel")&&u.launch({title:r.command_CancelUpdates,content:r.confirmation_cancel_attributesSure,confirmLabel:r.confirmation_ok},function(){var u=n.get(),f=u.options.views?u.options.views.datagridview:void 0;if(f){f.options.dgv.prepareUpdateView();var g=f.options.dgvLayout.getLeafColumns();g&&Array.isArray(g)&&g.forEach(function(e){e.toggleToEdit&&!0===e.toggleToEdit&&(e.getCellEditableState=function(e){return!1},e.getCellTypeRepresentation=function(e){return"string"}),"AuthorizedValues"===e.dataIndex&&(e.getCellValue=function(e){if(e.nodeModel){let t=e.nodeModel.getAttributeValue("AuthorizedValues"),i=d.getOldNodeValues()[e.nodeModel.options.grid.Name];return i&&(t=i),{label:t,func:"",module:""}}})}),f.options.dgv.treeDocument.cancelChanges(),f.options.dgv.treeDocument.setUseChangeTransactionMode(!1),f.options.dgv.pushUpdateView({updateCellContent:!0,updateCellLayout:!0,updateCellAttributes:!0},!0),c.setIsEditModeEnabled(!1),d.emptyOldNodeValues(),d.emptyUpdatedNodes(),l.updateCommands()}t.doRefresh(i,a,r,o,s,e)}):t.doRefresh(i,a,r,o,s,e)})},onDestroy:function(){},onResize:function(){var e=this;setTimeout(function(){e.libraryGlobal_div&&e.libraryIdCard_Cont&&0!==e.libraryGlobal_div.clientWidth&&e.libraryIdCard_Cont.updateDisplayPath()},500)},migratePreferences:function(){return new Promise(function(e){require(["text!DS/ClassificationEditor/assets/classificationVersion.json","DS/ClassificationEditor/utils/ClassificationMigration","DS/IPClassifyUtil/IPClassifyPreference"],function(t,i,a){let r=JSON.parse(t);var n=[];let o=new Promise(function(e){a.get("LibraryFavPrefVersion",function(t){!t||!t.version||t.version<r.LibraryFavPrefVersion?i.migrateFavPreferences(null,r.LibraryFavPrefVersion).then(function(){e()}):e()},!1)});n.push(o);let s=new Promise(function(e){a.get("LibraryTreeStrcutPrefVersion",function(t){!t||!t.version||t.version<r.LibraryTreeStrcuturePrefVersion?i.migrateTreeStructurePreferences(null,r.LibraryTreeStrcuturePrefVersion).then(function(){e()}):e()})});n.push(s),Promise.all(n).then(function(){e()})})})},_onReInit:function(){delete a.libraryTree_Cont,a.libraryTree_Cont=null,delete a.libraryContent_Cont,a.libraryContent_Cont=null,delete a.libraryIdCard_Cont,a.libraryIdCard_Cont=null,a.widget.body.container=null,a.libraryTree_W_NotLinked=!1,a.init({widget:this.widget,reInitialize:!0})},onLoad:function(){this.probeHeader=this.widget.id+"_"+this.widget.getTitle()+"_",window.top.performance.mark("onLoad_begin"),window.top.performance.measure(this.probeHeader+"createToOnLoad","createWidget_begin","onLoad_begin");var e=this;require(["DS/PADUtils/Configuration","DS/IPClassifyUX/utils/IPClassifyWidgetData","text!DS/ClassificationEditor/assets/ClassificationEditorConf.json","DS/PADServices/utils/AttributesMgt","DS/ClassificationEditor/utils/ClassificationEditorUtil","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor"],function(t,i,a,r,n,o){var s=JSON.parse(a),l=i.getWidgetData(),d="";l&&l.currentWidgetTab&&l.currentWidgetTab!==n.CONTENT_TABS.LIBRARIES?(s.settings.dgvOptions.value.dgv.showModelChangesFlag=!0,s.settings.dgvOptions.value.dgv.rowsHeader=!0,s.settings.dgvOptions.value.dgv.showColumnBorderFlag=!0,d=s.columnsCusto.ATTRIBUTES,Array.isArray(d.attributes)&&d.attributes.forEach(function(e){let t=o[e.nls_key]?o[e.nls_key]:e.dataIndex;e.text=t;let i=e.children;i&&i.forEach(function(e){e.text=o[e.nls_key]?o[e.nls_key]:e.dataIndex})})):(s.settings.dgvOptions.value.dgv.defaultColumnDef.typeRepresentation="string",s.settings.dgvOptions.value.dgv.showModelChangesFlag=!1,s.settings.dgvOptions.value.dgv.showColumnBorderFlag=!1,s.settings.dgvOptions.value.dgv.rowsHeader=!1,d=s.columnsCusto.LIBRARIES),t.mergeConfig(s),r.updateAttributesList(d),require(["UWA/Core","DS/PADUtils/PADContext","DS/PADUtils/PADCommandProxy","DS/PADUtils/PADSettingsMgt","DS/PADUtils/PADSharedSettings","DS/PADUtils/PADUtilsServices","DS/IPClassifyUX/LibraryContent","DS/ClassificationEditor/dataProvider/LibraryContentDataProvider","DS/IPClassifyUX/LibraryIdCardCont","DS/ClassificationEditor/dataProvider/LibraryIdCardDataProvider","DS/IPClassifyUX/LibraryTree","DS/ClassificationEditor/dataProvider/LibraryTreeDataProvider","DS/ClassificationEditor/utils/Library_CSO","DS/ClassificationEditor/dataProvider/LibraryCSODataProvider","DS/ClassificationEditor/dataProvider/LibraryDnDServiceProvider","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor","DS/ClassificationEditor/service/LibraryServices","DS/ClassificationEditor/service/LibraryTypeService","DS/IPClassifyUtil/IPClassifyAlert","DS/ClassificationEditor/utils/ClassificationEditorcontrol","DS/UIKIT/Mask","DS/ClassificationEditor/utils/ClassificationEditorKeyboardListener","DS/ClassificationEditor/utils/ClassificationEditorUtil","DS/IPClassifyUtil/IPClassifyUtility","DS/PADUtils/PADProbes","DS/ClassificationEditor/utils/FilterUtils","DS/IPClassifyUX/IPClassifyUXEvents","DS/IPClassifyUX/utils/IPClassifyModeManager","DS/WidgetServices/WidgetServices","DS/IPClassifyUXUtil/CredentialsView","text!DS/ClassificationEditor/assets/library_settings.json","DS/MessageBus/MessageBus","DS/ClassificationEditor/dataProvider/ClassificationTabBarProvider","DS/Windows/ImmersiveFrame"],function(t,i,a,r,n,o,s,l,d,c,u,f,g,p,m,C,b,y,h,v,_,S,D,E,A,P,T,I,L,w,x,N,U){try{P.init()}catch(e){}var M=e;M.options={},M.addEvent=(()=>{}),M.checkOnCommand=!1,i.set(M),window.top.performance.mark("loadRequire_end"),window.top.performance.measure(e.probeHeader+"loadRequire","createWidget_begin","loadRequire_end"),widget.setValue("tenantAware",!0),r.addEventOnce("onNoSecurityContext",function(e){if(!0!==e){v._isSecurityCTXInitialized=!1,widget.setBody(" ");var t=UWA.createElement("div",{text:C.get("authentication_error")});t.set("styles",{position:"absolute",top:"40%",bottom:"30%",left:"30%",right:"30%"}),t.inject(widget.body)}}),r.addEvent("onPad_security_ctx",function(e){v.getContent()&&v.getContent().getView()&&v.getContent().getView().options&&v.getContent().getView().options.model&&v.getContent().getView().options.model.getModelEvents()&&v.getContent().getView().options.model.getModelEvents().publish({event:"titleRecalc",data:g.getCurrentLibrary()._options.label})}),widget.addPreference({name:"pad_security_ctx",type:"hidden"});var O=JSON.parse(x);if(r.setApp(O.padsettings,"enopad",!0),r.setSetting("activate_padprobes",!0),r.setSetting("add_objects_when_select",!1),A.initialize({padid:widget.id,padtitle:widget.getTitle()}),n.addSharedSettings(widget,["x3dPlatformId"]),widget.setValue("editProperties_readOnly",!1),widget&&widget.lang&&r.setSetting("lang",widget.lang),e.widget.addEvent("endEdit",r.updateWidgetPreferences.bind(r)),r.updateWidgetPreferences(),e.updateSecurityPreference(),I.addModeIntervalPreferences({refreshView:function(){require(["DS/ClassificationEditor/utils/ClassificationEditorcontrol"],function(e){e.getTreeCont().refreshLibraryTree(),e.getContent().refreshLibraryContent()})},updateTaggerAndComputeColumns:function(e){require(["DS/ClassificationEditor/utils/ClassificationEditorcontrol"],function(t){t.getContent().updateFilterBI(e),t.getContent().updateComputedColumns()})}}),e.widget.getValue("x3dSharedId")||e.widget.getValue("x3dAppId")||e.widget.addPreference({name:"x3dAppId",type:"hidden",defaultValue:"ENOPACX_AP"}),e.widget.getValue("x3dSharedId")||e.widget.addPreference({name:"x3dSharedId",type:"hidden",defaultValue:"ClassificationEditor_"+o.getWidgetId()}),w.render(),null===e.libraryTree_Cont||void 0===e.libraryTree_Cont){e.core=t,e.widget.body.empty(),e._buildSkeleton();e.widget.addEvent("endEdit",function(){e.widget.getPreferences().forEach(function(t){var i="boolean"===t.type&&UWA.is(t.value,"string")?e.convertToBool(t.value):t.value;e.widget.setValue(t.name,i)})}),e.libraryGlobal_div=e.widget.body.container,e.libraryTreeDoc_div=e.widget.body.right_side_div,e.libraryIdCard_div=e.widget.body.top_right_side_div,e.libraryContent_div=e.widget.body.bottom_right_side_div;var F=e._initializeClassificationEditorComponent.bind(e);if(null===e.libraryContent_Cont){var R={x3dAppId:e.widget.getValue("x3dAppId"),lang:e.widget.lang?e.widget.lang:e.widget.getValue("lang"),layout:{view_customization:null,css_view_class:e.css_view_class,store_roots_in_pref:!0,padshell:!0},authorize_setStructure:!0,settings:O};e.widget.getValue("LibraryCusto_treelistview_v1")?(R.layout.view_customization=JSON.parse(E.jsonUnzip(e.widget.getValue("LibraryCusto_treelistview_v1"))),F(R)):o.app_initialization(function(){require(["DS/IPClassifyUtil/service/IPClassifyUtilWebService"],function(t){t.getUserPreferences({name:e.widget.getValue("x3dAppId")+"_Classification_v1",onComplete:function(e){var t=null;e&&e.length>0&&(t=JSON.parse(E.jsonUnzip(e))),R.layout.view_customization=t,F(R)},onFailure:function(e){F(R)}})})}),e.getSelectedNodes=function(){return g.getSelectedNodes()},e.getCurrentLibrary=function(){var e=D.getCurrentSecurityContextAndLibraryData(!0);return JSON.stringify(e)},e.getSecurityContext=function(){return{SecurityContext:r.getSetting("pad_security_ctx"),tenant:widget.getValue("pad_tenant")}},e.beginBlockingTransaction=function(t){_.mask(e.libraryContent_div,t)},e.endBlockingTransaction=function(){_.unmask(e.libraryContent_div)},e.author=function(e){},e.displayNotification=function(e){h.displayNotification({message:e.msg,className:e.eventID})},e.getPADTreeDocument=function(){return v.getContent().getView()?v.getContent().getView().getPADTreeDocument():null},e.toggleView=function(e){UWA.is(v.getContent().getView().toggleView(e))&&v.getContent().getView().toggleView(e)},e.getPADTreeListView=function(){return v.getContent().getView().getPADTreeListView()},e.getContent=function(){return v.getContent()}}}})})},_slidderMoveEndCallback:function(){this.libraryIdCard_Cont&&this.libraryIdCard_Cont.updateDisplayPath()},_buildSkeleton:function(){if(!this.core.is(this.widget.body.container)){var e=require("DS/Windows/ImmersiveFrame"),t=require("DS/WebUAUtils/WebUAUtils"),i=new UWA.Element("div",{class:"ClassificationEditor-widget-help",style:{"vertical-align":"top"}});if(i.inject(widget.body),this.widget.myImmersiveFrame){this.widget.bottom.destroy();var a=this.widget.myImmersiveFrame}else{a=new e;this.widget.myImmersiveFrame=a,t.setPanelHelpMode({immersiveFrame:this.widget.myImmersiveFrame})}try{t.closePanelHelp()}catch(e){console.log("UA Panel already closed")}a.inject(i),a.getFreeZone().replaceChildren(),this.widget.body.container=UWA.createElement("div",{class:"LibraryEditor_global_container"}).inject(a.getFreeZone(),"top"),this.widget.body.right_side_div=UWA.createElement("div",{class:"LibraryEditor_right_side_div"}).inject(this.widget.body.container),this.widget.body.top_right_side_div=UWA.createElement("div",{class:"LibraryEditor_top_right_side_div"}).inject(this.widget.body.right_side_div),this.widget.bottom=this.widget.body.bottom_right_side_div=UWA.createElement("div",{class:"LibraryEditor_bottom_right_side_div"}).inject(this.widget.body.right_side_div);var r=UWA.createElement("div",{class:"LibraryEditor_containerTools"}),n=this;require(["DS/PADServices/utils/GlobalModelEvents"],function(e){e.getModelEvents().subscribe({event:"AddExistingAttributesCmd/Views/showInWidgetBody"},function(e){e.html?(r.empty(),e.html.inject(r),r.inject(widget.body),e.keepOpacity||n.widget.body.right_side_div.setStyle("opacity",.5)):!0===e.restore&&(r.remove(),n.widget.body.right_side_div.setStyle("opacity",1))})})}},convertToBool:function(e){return"true"===e.toLowerCase()},_initializeClassificationEditorComponent:function(e){var a=this,r=require("DS/IPClassifyUX/LibraryTree"),n=require("DS/ClassificationEditor/dataProvider/LibraryTreeDataProvider"),o=require("DS/ClassificationEditor/utils/ClassificationEditorcontrol"),s=require("DS/IPClassifyUX/LibraryIdCardCont"),l=require("DS/ClassificationEditor/dataProvider/LibraryIdCardDataProvider"),d=require("DS/IPClassifyUX/LibraryContent"),c=require("DS/ClassificationEditor/dataProvider/LibraryContentDataProvider"),u=require("DS/ClassificationEditor/utils/ClassificationEditorKeyboardListener"),f=require("DS/PADUtils/PADUtilsServices"),g=require("DS/ClassificationEditor/dataProvider/LibraryCSODataProvider"),p=require("DS/ClassificationEditor/dataProvider/LibraryDnDServiceProvider"),m=require("i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor"),C=require("DS/ClassificationEditor/service/LibraryTypeService"),b=require("DS/ClassificationEditor/utils/ClassificationEditorUtil"),y=require("DS/PADServices/utils/GlobalModelEvents"),h=require("DS/ClassificationEditor/dataProvider/ClassificationTabBarProvider");f.app_initialization(function(){f.getSecurityContext(function(v){if(v&&""!==v.securityContext&&v.securityContextList.length>0){if(0==b.CURRENT_TAB_VALUE)null===a.libraryTree_Cont&&f.app_initialization(function(){var s=new r({lang:a.widget.lang?a.widget.lang:a.widget.getValue("lang"),css_view_class:a.css_view_class,dataProvider:n,CSOProvider:g,DnDProvider:p,LibraryTypeService:C,events:{onReady:function(){if(o.setTreeCont(this),a.libraryTree_Cont=this._libraryTreeView,null!==a.libraryTree_Cont)a.libraryTree_Cont.setOption("_libraryContentView",this._libraryTreeView);else{if(!0===a.libraryTree_W_NotLinked)throw"LibraryTree are not linked !!!";a.libraryTree_W_NotLinked=!0}var r=a._retrieveinitializationOpts(),n=UWA.extend(e,r);n.placeholderData={},n.placeholderData.multiplePlaceholders=!0,n.placeholderData.placeholders={},n.placeholderData.placeholders.favoriteSection={},n.placeholderData.placeholders.favoriteSection.labelNLS=m.placeholder_Msg_FavoriteSection,n.placeholderData.placeholders.createNewDefinitionLibrary={},n.placeholderData.placeholders.createNewDefinitionLibrary.labelNLS=m.placeholder_Msg_CreateStandardOrDefinitonLib,n.placeholderData.placeholders.createNewDefinitionLibrary.commandNLS=m.placeholder_CMD1_CrteLib,n.placeholderData.placeholders.createNewDefinitionLibrary.command="CreateNewDefinitionLibrary",n.placeholderData.placeholders.createNewStandardLibrary={},n.placeholderData.placeholders.createNewStandardLibrary.labelNLS=m.placeholder_Msg_CreateStandardOrDefinitonLib,n.placeholderData.placeholders.createNewStandardLibrary.commandNLS=m.placeholder_CMD2_CrteLib,n.placeholderData.placeholders.createNewStandardLibrary.command="CreateNewStandardLibrary",n.placeholderData.placeholders.addClassAttributes={},n.placeholderData.placeholders.addClassAttributes.labelNLS=m.placeholder_Msg_classAttributes,n.placeholderData.placeholders.addClassAttributes.commandNLS=m.command_addExistingAttribute,n.placeholderData.placeholders.addClassAttributes.command="AddExistingAttributes",n.placeholderData.placeholders.createNewClass={},n.placeholderData.placeholders.createNewClass.labelNLS=m.placeholder_Msg,n.placeholderData.placeholders.createNewClass.labelNLS_Cls=m.placeholder_Msg_Cls,n.placeholderData.placeholders.createNewClass.commandNLS=m.placeholder_CMD1,n.placeholderData.placeholders.createNewClass.command="CreateNewClass",n.placeholderData.placeholders.newClassAttributes={},n.placeholderData.placeholders.newClassAttributes.labelNLS=m.placeholder_Msg_newClassAttributes,n.placeholderData.placeholders.newClassAttributes.commandNLS=m.placeholder_CMD2,n.placeholderData.placeholders.newClassAttributes.command="CreateClassAttributes",n.leftTriptychElem=a.libraryTree_Cont.elements.container,n.dataProvider=c,n.CSOProvider=g,n.DnDProvider=p,n.libraryEditorUtil=b,n.libraryControl=o,n.leftState=t,n.rightState=i,n.libraryContent_div=a.libraryContent_div,n.tabBarProvider=h,n.css_view_class=a.css_view_class,a.libraryContentController=new d(n),o.setContent(a.libraryContentController),a.widget.dispatchEvent("onClassificationEditorReady")}}});o.setTreeCont(s)});else{var _=a._retrieveinitializationOpts(),S=UWA.extend(e,_);S.placeholderData={},S.placeholderData.multiplePlaceholders=!0,S.placeholderData.placeholders={},S.placeholderData.placeholders.favoriteSection={},S.placeholderData.placeholders.favoriteSection.labelNLS=m.placeholder_Msg_FavoriteSection,S.placeholderData.placeholders.createNewDefinitionLibrary={},S.placeholderData.placeholders.createNewDefinitionLibrary.labelNLS=m.placeholder_Msg_CreateStandardOrDefinitonLib,S.placeholderData.placeholders.createNewDefinitionLibrary.commandNLS=m.placeholder_CMD1_CrteLib,S.placeholderData.placeholders.createNewDefinitionLibrary.command="CreateNewDefinitionLibrary",S.placeholderData.placeholders.createNewStandardLibrary={},S.placeholderData.placeholders.createNewStandardLibrary.labelNLS=m.placeholder_Msg_CreateStandardOrDefinitonLib,S.placeholderData.placeholders.createNewStandardLibrary.commandNLS=m.placeholder_CMD2_CrteLib,S.placeholderData.placeholders.createNewStandardLibrary.command="CreateNewStandardLibrary",S.placeholderData.placeholders.addClassAttributes={},S.placeholderData.placeholders.addClassAttributes.labelNLS=m.placeholder_Msg_classAttributes,S.placeholderData.placeholders.addClassAttributes.commandNLS=m.command_addExistingAttribute,S.placeholderData.placeholders.addClassAttributes.command="AddExistingAttributes",S.placeholderData.placeholders.createNewClass={},S.placeholderData.placeholders.createNewClass.labelNLS=m.placeholder_Msg,S.placeholderData.placeholders.createNewClass.labelNLS_Cls=m.placeholder_Msg_Cls,S.placeholderData.placeholders.createNewClass.commandNLS=m.placeholder_CMD1,S.placeholderData.placeholders.createNewClass.command="CreateNewClass",S.placeholderData.placeholders.newClassAttributes={},S.placeholderData.placeholders.newClassAttributes.labelNLS=m.placeholder_Msg_newClassAttributes,S.dataProvider=c,S.CSOProvider=g,S.DnDProvider=p,S.tabBarProvider=h,S.libraryContent_div=a.libraryContent_div,S.thumbnailAttributeDelayed=!0,a.libraryContentController=new d(S),o.setContent(a.libraryContentController),a.widget.dispatchEvent("onClassificationEditorReady"),y.subscribe({event:"/NLSRange/updated"},function(e){b.uppendChangestoList(e)})}null===a.libraryIdCard_Cont&&(a.libraryIdCard_Cont=new s({lang:a.widget.lang?a.widget.lang:a.widget.getValue("lang"),css_view_class:a.css_view_class,parentDiv:a.libraryIdCard_div,leftState:t,rightState:i,modelEvents:y.getModelEvents(),libraryCSODataProvider:g,libraryDataProvider:l,TabBarProvider:h,TabCont:a.widget.body.top_right_side_div,events:{onReady:function(){a.libraryIdCard_Cont=this,a.libraryIdCard_Cont.render().inject(a.libraryIdCard_div)}}})),a._keyboardListener||(a._keyboardListener=new u,a._keyboardListener.startObservingKeyboard())}})})},updateSecurityPreference:function(){window.library&&require(["DS/PADUtils/PADSettingsMgt"],function(e){var t="ctx::"+window.library.params.securityContext;e.setSetting("pad_security_ctx",t)})},_retrieveinitializationOpts:function(){var e=this;return{renderTo:e.libraryContent_div,events:{onActionBarReadyToBuild:function(){var a=require("DS/IPClassifyUX/LibraryIdCardCont"),r=require("DS/PADServices/utils/GlobalModelEvents"),n=require("DS/ClassificationEditor/dataProvider/LibraryCSODataProvider"),o=require("DS/ClassificationEditor/dataProvider/LibraryIdCardDataProvider"),s=require("DS/ClassificationEditor/dataProvider/ClassificationTabBarProvider");window.DEBUG_ActionBar_Require=!0,window.DEBUG_ActionBar_CmdInstantiation=!0,window.DEBUG_ActionBar_Xml=!0,window.DEBUG_ActionBar_ProcessCommandHeader=!0,window.DEBUG_ActionBar_Init=!0,e.elements=this.elements,e.options=this.options,e.togglePanel=this.togglePanel,null===e.libraryIdCard_Cont&&(e.libraryIdCard_Cont=new a({lang:e.widget.lang?e.widget.lang:e.widget.getValue("lang"),css_view_class:e.css_view_class,parentDiv:e.libraryIdCard_div,leftState:t,rightState:i,modelEvents:r.getModelEvents(),libraryCSODataProvider:n,libraryDataProvider:o,TabBarProvider:s,TabCont:e.widget.body.top_right_side_div,events:{onReady:function(){e.libraryIdCard_Cont=this,e.libraryIdCard_Cont.render().inject(e.libraryIdCard_div)}}}))},onReady:function(){e.libraryContent_Cont=this,e.addEvent=e.libraryContent_Cont.addEvent.bind(e.libraryContent_Cont),e.libraryContent_Cont.dropInvitContainer&&(e.libraryContent_Cont._dropInvitContainer=e.libraryContent_Cont.dropInvitContainer),e.libraryContent_Cont.options.renderTo&&(e.libraryContent_Cont._dropInvitContainer.hide(),e.libraryContent_Cont.render().inject(e.libraryContent_Cont.options.renderTo));require("DS/PADUtils/PADSettingsMgt");e.updateSecurityPreference()},onCustoViewChange:function(t){require(["DS/IPClassifyUtil/IPClassifyUtility"],function(i){e.widget.setValue("LibraryCusto_treelistview_v1",i.jsonZip(JSON.stringify(t)))})},onSaveAsTemplate:function(t){require(["DS/IPClassifyUtil/service/IPClassifyUtilWebService","DS/IPClassifyUtil/IPClassifyUtility"],function(i,a){e.widget.setValue("LibraryCusto_treelistview_v1",a.jsonZip(JSON.stringify(t))),i.saveUserPreferences({name:e.widget.getValue("x3dAppId")+"_Classification_v1",value:a.jsonZip(JSON.stringify(t)),onComplete:function(e){console.log("Saved as template")},onFailure:function(e){console.warn("Cannot save customization template")}})})},onSwitchView:function(){require("DS/ClassificationEditor/ActionBar/ClassificationCommandManager").updateCommands()},onToggleView:function(){require("DS/ClassificationEditor/ActionBar/ClassificationCommandManager").updateCommands()}}}}};return a.init(e),a}define("DS/ClassificationEditor/service/LibraryServices",["DS/ClassificationEditor/utils/Library_CSO","DS/ClassificationEditor/service/ClassificationEditorWebService","DS/ClassificationEditor/service/LibraryTypeService","DS/IPClassifyUtil/IPClassifyAlert","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor"],function(e,t,i,a,r){"use strict";return{DeleteLibrary:function(e){if(!UWA.is(e.callbacks,"object"))throw new Error("No callbacks function defined");if(!UWA.is(e.callbacks.onComplete,"function"))throw new Error("No onComplete callback function defined");if(!UWA.is(e.callbacks.onFailure,"function"))throw new Error("No onFailure callback function defined");e.IDs.length>0?t.deleteLibrary({IDs:e.IDs,onComplete:function(t){var i=t?JSON.parse(t):void 0;if(i&&i.error){var a=i.error;console.log("Delete Library WebService Err : "+a),a.length>200&&(a=null),e.callbacks.onFailure(a)}else e.callbacks.onComplete(t)},onFailure:e.callbacks.onFailure}):e.callbacks.onFailure(e)},DeleteClass:function(e){if(!UWA.is(e.callbacks,"object"))throw new Error("No callbacks function defined");if(!UWA.is(e.callbacks.onComplete,"function"))throw new Error("No onComplete callback function defined");if(!UWA.is(e.callbacks.onFailure,"function"))throw new Error("No onFailure callback function defined");e.IDs.length>0?t.deleteClass({IDs:e.IDs,onComplete:function(t){var i=t?JSON.parse(t):void 0;if(i&&i.error){var a=i.error;console.log("Delete Class WebService Err : "+a),a.length>200&&(a=null),e.callbacks.onFailure(a)}else e.callbacks.onComplete(t)},onFailure:e.callbacks.onFailure}):e.callbacks.onFailure(e)},MoveClass:function(e){if(!UWA.is(e.callbacks,"object"))throw new Error("No callbacks function defined");if(!UWA.is(e.callbacks.onComplete,"function"))throw new Error("No onComplete callback function defined");if(!UWA.is(e.callbacks.onFailure,"function"))throw new Error("No onFailure callback function defined");var i=e.targetLibrary,a=i?i.id:"";a.length&&e.IDs.length?t.moveClass({classPhysicalIds:e.IDs,targetLibraryPhysicalId:a,carryOverAttributeGroups:e.carryOverAttributeGroups,onComplete:function(t){var i=t?JSON.parse(t):void 0;if(i&&i.error){var a=i.error;console.log("MoveClass WebService Err : "+a),a.length>200&&(a=null),e.callbacks.onFailure(a)}else e.callbacks.onComplete(t)},onFailure:e.callbacks.onFailure}):e.callbacks.onFailure(e)}}}),define("DS/ClassificationEditor/utils/LibrarySearch",["UWA/Class","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor","text!DS/ClassificationEditor/assets/library_exclude_columns.json"],function(e,t,i){"use strict";return e.singleton({init:function(e){this._parent(e),this._predicateToHeaderMap=null,this._dynamicHeaderMap=[],this._dynamicMapSorted=!1,this._searchInfo=null,this._defaultPredicates=["ds6w:label","physicalid","mxid","ds6w:type","owner","ds6w:classificationUsage"],this._authModePredicates=["ds6w:label","physicalid","mxid","ds6w:description","ds6w:modified","ds6w:created","ds6w:responsible","ds6w:type","ds6w:identifier","ds6w:status","ds6w:reservedBy","owner","policy","ds6w:classificationUsage"],this._authPersonAttributes=["ds6w:reservedby","ds6w:responsible"];this._searchInfo={with_indexing_date:!0,select_predicate:this._defaultPredicates.slice(0),select_file:["icon","thumbnail_2d"],order_field:"ds6w:modified",order_by:"desc",nresults:25}},getSearchInfo:function(e){var t=Object.assign({},this._searchInfo);return!0===e&&(t.select_predicate=this._authModePredicates),t},filterExcludeListColumns:function(e){var t=[],a=JSON.parse(i);if(a){a=a.columnToExclude;for(var r=0;r<e.length;++r)-1==a.indexOf(e[r].dataIndex)&&t.push(e[r])}return t},setPredicates:function(e,t){var a=this,r=JSON.parse(i),n=[];r&&(n=r.predicateToExclude,r=r.columnToExclude),Array.isArray(e)&&e.forEach(function(e){var t=e.ds6w;t||(t=e.dataIndex),"tree"===t||-1===a._searchInfo.select_predicate.indexOf(t)&&-1===r.indexOf(t)&&-1===n.indexOf(t)&&a._searchInfo.select_predicate.push(t)})},removeAllPredicates:function(){this._searchInfo.select_predicate=[],this._searchInfo.select_predicate=this._searchInfo.select_predicate.concat(this._defaultPredicates)},removePredicates:function(e){for(var t=[],i=[],a=0;a<e.length;++a)i.push(e[a].dataIndex);this._searchInfo.select_predicate.forEach(function(e){-1===i.indexOf(e)&&t.push(e)}),this._searchInfo.select_predicate=t},getPersonPredicatesForAuth:function(){return this._authPersonAttributes},setAttrNameToPredMapping:function(e){this._attrNameToPredMapping||(this._attrNameToPredMapping={}),this._attrNameToPredMapping&&e&&(this._attrNameToPredMapping[e.key]=e.value)},getAttrNameToPredMapping:function(){return this._attrNameToPredMapping||(this._attrNameToPredMapping={}),this._attrNameToPredMapping},resetAttrNameToPredMapping:function(){this._attrNameToPredMapping=null},initPredicateToHeaderMap:function(e){if(!this._predicateToHeaderMap){this._predicateToHeaderMap=[];for(var t=0;t<e.length;t++){var i=e[t],a=i.text?i.text.toLowerCase():null;if(a&&i.ds6w){var r={header:a,predicate:i.ds6w};this._predicateToHeaderMap.push(r)}}}},addToPredicateHeaderMap:function(e){for(var t=0;t<e.length;++t){var i=e[t],a=i.text?i.text.toLowerCase():null;if(a&&i.ds6w){var r={header:a,predicate:i.ds6w};this._predicateToHeaderMap.push(r)}}},removeFromPredicateHeaderMap:function(e){this._predicateToHeaderMap=this._predicateToHeaderMap.filter(function(e){for(var t=0;t<this.length;++t)if(this[t].ds6w==e.predicate)return!1;return!0},e)}})}),define("DS/ClassificationEditor/service/LibraryTypeService",["UWA/Controls/Abstract","text!DS/PADUtils/assets/PADOpenCommandsSettings.json"],function(e,t){return e.singleton({TYPE_ROOT_LIBRARY_1:"General Library",TYPE_ROOT_LIBRARY_2:"Part Library",TYPE_ROOT_LIBRARY_3:"RootLibrary",TYPE_LIBRARY_1:"General Class",TYPE_LIBRARY_2:"Library",TYPE_LIBRARIES_SECTION:"LibrarySection_AllLibraries",TYPE_FAVORITES_SECTION:"LibrarySection_favorite",RELATIONSHIP_SUBCLASS:"Subclass",STANDARD_USAGE:"STANDARD",openTypes:[],getOpenAvailableForTypes:function(e){if(0==this.openTypes.length&&e){var i=JSON.parse(t);i["openInCAD_"+e+"_supported_types"]&&(this.openTypes=i["openInCAD_"+e+"_supported_types"])}return this.openTypes},init:function(){},isRootLibrary:function(e){return e===this.TYPE_ROOT_LIBRARY_1||e===this.TYPE_ROOT_LIBRARY_2||e===this.TYPE_ROOT_LIBRARY_3},isLibrary:function(e){return e===this.TYPE_LIBRARY_1||e===this.TYPE_LIBRARY_2},inFamilyLibrary:function(e){return this.isRootLibrary(e)||this.isLibrary(e)},isSection:function(e){return e===this.TYPE_LIBRARIES_SECTION||e===this.TYPE_FAVORITES_SECTION},getPlmTypeFromContentDetails:function(e){if(e&&!(e.length<1)){for(var t,i,a,r,n="Content",o=0,s=e.length;o<s;++o)if("flattenedtaxonomies"===e[o].name){if("types/Classification"===e[o].value?t=!0:"types/General Class"===e[o].value?i=!0:"types/Libraries"===e[o].value?a=!0:"types/General Library"===e[o].value&&(r=!0),"types/Classification"===e[o].value[0]&&"types/General Class"===e[o].value[1]){n="Library";break}if("types/Libraries"===e[o].value[0]&&"types/General Library"===e[o].value[1]){n="RootLibrary";break}}return t&&i&&(n="Library"),a&&r&&(n="RootLibrary"),n}},getPLMTypeOfLibraryTreeNode:function(e){var t="";if(e){var i=e.plmType;t="Library"==i?"General Class":"RootLibrary"==i?"General Library":i}return t}})}),define("DS/ClassificationEditor/commands/ActionBar_ExpandNCmd",["UWA/Core","DS/ApplicationFrame/Command"],function(e,t){"use strict";return t.extend({labelTopBar:e.i18n("Expand N levels"),isInsert:!0,datas:{},init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!1}),require(["DS/IPClassifyUtil/IPClassifyAlert","DS/PADUtils/views/PADLevelSel","DS/ClassificationEditor/utils/Library_CSO","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor"],function(e,t,i,a){})},beginExecute:function(){},execute:function(){var e=require("DS/IPClassifyUtil/IPClassifyAlert"),t=require("DS/PADUtils/views/PADLevelSel"),i=require("DS/ClassificationEditor/utils/Library_CSO"),a=require("i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor"),r=null;null===(r=i.getCurrentLibrary())?e.displayNotification({message:a.msg_warning_noselection,className:"warning"}):new t({css_style:"",events:{onApply:function(e){r.expandNLevels({numberOfLevelsToExpand:parseInt(e),initialLevel:r.getNodeDepth()})}}})},endExecute:function(){}})}),define("DS/ClassificationEditor/utils/FilterUtils",["UWA/Class"],function(e){"use strict";return e.singleton({init:function(e){this.libraryFilter='flattenedtaxonomies:"types/General Library"',this.classFilter=["General Class"],this.classTreeFilter='flattenedtaxonomies:"types/General Class"',this.classTreeFilterAuth="General Class",this.endItemFilter=null,this.excludeBOTypesFromContentView=["Document Family","Part Family"]}})}),define("DS/ClassificationEditor/utils/ClassificationEditorcontrol",["UWA/Controls/Abstract"],function(e){return e.singleton({_Content:null,_TreeCont:null,_IdCardCont:null,_onWidgetRefresh:null,getContent:function(){return this._Content},setContent:function(e){this._Content=e},getTreeCont:function(){return this._TreeCont},setTreeCont:function(e){this._TreeCont=e},getIdCardCont:function(){return this._IdCardCont},setIdCardCont:function(e){this._IdCardCont=e},setWidgetRefresh:function(e){this._onWidgetRefresh=e},getWidgetRefresh:function(){return this._onWidgetRefresh}})}),define("DS/ClassificationEditor/utils/ClassificationMigration",["DS/IPClassifyUtil/IPClassifyPreference","DS/IPClassifyUtil/IPClassifyUtility"],function(e,t){return{migrateFavPreferences:function(i,a){return new Promise(function(i){1==a?e.get("ipcFavoriteList_v1",function(r){e.set(t.getTenantAwarePreferenceName("ipcFavoriteList_v1"),r,!1,!1),e.set("LibraryFavPrefVersion",{version:a},!1),i()},!1):i()})},migrateTreeStructurePreferences:function(i,a){return new Promise(function(i){1==a?e.get("ipcTreeStrucure_v1",function(r){e.set(t.getTenantAwarePreferenceName("ipcTreeStrucure_v1"),r),e.get("ipcTreeSelectedNode_v1",function(r){e.set(t.getTenantAwarePreferenceName("ipcTreeSelectedNode_v1"),r),e.set("LibraryTreeStrcutPrefVersion",{version:a}),i()})}):i()})}}}),define("DS/ClassificationEditor/commands/ClassificationIconBar_NewIntegerAttribute",["UWA/Core","DS/ApplicationFrame/Command","DS/ClassificationEditor/utils/ClassificationEditorcontrol","DS/PADUtils/PADProbes","DS/IPClassificationAttributes/CreateNewAttributes"],function(e,t,i,a,r){"use strict";return t.extend({labelTopBar:e.i18n("New Integer Attribute"),isInsert:!0,data:{},_modalChooser:null,init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!1})},beginExecute:function(){},execute:function(){(new r).loadAttrCreatePanel({attrType:"Integer",container:i.getContent().getView().elements.container,grid:i.getContent().getView().getPADTreeListView().getManager()})},endExecute:function(){}})}),define("DS/ClassificationEditor/commands/ClassificationIconBar_NewBooleanAttribute",["UWA/Core","DS/ApplicationFrame/Command","DS/ClassificationEditor/utils/ClassificationEditorcontrol","DS/PADUtils/PADProbes","DS/IPClassificationAttributes/CreateNewAttributes"],function(e,t,i,a,r){"use strict";return t.extend({labelTopBar:e.i18n("New Boolean Attribute"),isInsert:!0,data:{},_modalChooser:null,init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!1})},beginExecute:function(){},execute:function(){(new r).loadAttrCreatePanel({attrType:"Boolean",container:i.getContent().getView().elements.container,grid:i.getContent().getView().getPADTreeListView().getManager()})},endExecute:function(){}})}),define("DS/ClassificationEditor/commands/ClassificationIconBar_NewStringAttribute",["UWA/Core","DS/ApplicationFrame/Command","DS/IPClassifyUtil/IPClassifyUtility","DS/IPClassifyUX/utils/IPClassifyModeManager","DS/ClassificationEditor/utils/ClassificationEditorcontrol","DS/PADUtils/PADProbes","DS/IPClassificationAttributes/CreateNewAttributes","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor"],function(e,t,i,a,r,n,o,s){"use strict";return t.extend({labelTopBar:e.i18n("New String Attribute"),isInsert:!0,data:{},_modalChooser:null,init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!1})},beginExecute:function(){},execute:function(){(new o).loadAttrCreatePanel({attrType:"String",container:r.getContent().getView().elements.container,grid:r.getContent().getView().getPADTreeListView().getManager()})},endExecute:function(){}})}),define("DS/ClassificationEditor/commands/ClassificationIconBar_NewDateAttribute",["UWA/Core","DS/ApplicationFrame/Command","DS/ClassificationEditor/utils/ClassificationEditorcontrol","DS/PADUtils/PADProbes","DS/IPClassificationAttributes/CreateNewAttributes"],function(e,t,i,a,r){"use strict";return t.extend({labelTopBar:e.i18n("New Date Attribute"),isInsert:!0,data:{},_modalChooser:null,init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!1})},beginExecute:function(){},execute:function(){(new r).loadAttrCreatePanel({attrType:"Date",container:i.getContent().getView().elements.container,grid:i.getContent().getView().getPADTreeListView().getManager()})},endExecute:function(){}})}),define("DS/ClassificationEditor/commands/ClassificationIconBar_DeleteClass",["UWA/Core","DS/ApplicationFrame/Command","DS/IPClassifyUtil/IPClassifyUtility","DS/IPClassifyUX/utils/IPClassifyModeManager","DS/ClassificationEditor/utils/ClassificationEditorcontrol","DS/IPClassifyUXUtil/IPClassifyConfirmation","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor"],function(e,t,i,a,r,n,o){"use strict";return t.extend({labelTopBar:e.i18n("Delete Class"),isInsert:!0,data:{},_modalChooser:null,init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!1})},beginExecute:function(){},execute:function(){var e=require("DS/ClassificationEditor/utils/Library_CSO"),t=require("DS/IPClassifyUtil/IPClassifyAlert"),i=require("DS/ApplicationFrame/CommandsManager"),s=require("DS/ClassificationEditor/service/LibraryServices"),l=require("DS/ClassificationEditor/commands/LibraryCommands"),d=require("DS/IPClassifyUX/events/IPClassifyEvents");n.launch({title:o.confirmation_deleteClass_title,content:o.confirmation_deleteClass_message},function(){var n=e.getSelectedNodes(),c=!1;c=!!n[0].pathId;var u=n.length;if(u>0){l._startProgressBar(o.deleteClass_loading);var f=i.getCommand("DeleteClass",r.getContent());f.disable();var g=[],p=null;n.forEach(function(e){null===p&&"noExpandState"!==e._expandState&&!0===widget.getBool("filtered-content")&&(p=!0),g.push(UWA.is(e.id)?e.id:e.options.resourceid)}),s.DeleteClass({IDs:g,callbacks:{onComplete:function(t){var i=o.msg_info_classesDeleted;1===u&&(i=o.replace(o.msg_info_classDeleted,{classname:n[0]._options.label})),a.setAuthoringMode("authoring",i),a.updateRefreshTime();for(var s=0;s<g.length;s++){var f=g[s],p=e._currentLibrary;c&&"RootLibrary"!=p.plmType&&(p=p._parentNode),p.select(),r.getTreeCont().performOperationOnNode(p,"collapse"),r.getTreeCont().performOperationOnNode(p,"expand"),d.notifyRemoveNodeInContent(f)}0===r.getContent()._libraryContentView.options.model.getAllDescendants().length&&r.getContent().getView()._addPlaceHolder(),l._offProgressBar()},onFailure:function(e,i,a){l._offProgressBar(),f.enable();var r=l.extractMyErrorMessage(e,i,a);t.displayNotification({message:r?o.msg_error_deleteClass+"<br>"+r:o.msg_error_deleteClass,className:"error"})}}})}})},endExecute:function(){}})}),define("DS/ClassificationEditor/commands/ClassificationIconBar_NewRealAttribute",["UWA/Core","DS/ApplicationFrame/Command","DS/ClassificationEditor/utils/ClassificationEditorcontrol","DS/PADUtils/PADProbes","DS/IPClassificationAttributes/CreateNewAttributes"],function(e,t,i,a,r){"use strict";return t.extend({labelTopBar:e.i18n("New Real Attribute"),isInsert:!0,data:{},_modalChooser:null,init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!1})},beginExecute:function(){},execute:function(){(new r).loadAttrCreatePanel({attrType:"Double",container:i.getContent().getView().elements.container,grid:i.getContent().getView().getPADTreeListView().getManager()})},endExecute:function(){}})}),define("DS/ClassificationEditor/commands/ClassificationIconBar_DeleteLibrary",["UWA/Core","DS/ApplicationFrame/Command","DS/IPClassifyUtil/IPClassifyUtility","DS/IPClassifyUX/utils/IPClassifyModeManager","DS/ClassificationEditor/utils/ClassificationEditorcontrol","DS/IPClassifyUXUtil/IPClassifyConfirmation","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor"],function(e,t,i,a,r,n,o){"use strict";return t.extend({labelTopBar:e.i18n("Delete Library"),isInsert:!0,data:{},_modalChooser:null,init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!1})},beginExecute:function(){},execute:function(){var e=require("DS/ClassificationEditor/utils/Library_CSO"),t=require("DS/IPClassifyUtil/IPClassifyAlert"),i=require("DS/ApplicationFrame/CommandsManager"),s=require("DS/ClassificationEditor/service/LibraryServices"),l=require("DS/ClassificationEditor/commands/LibraryCommands"),d=require("DS/IPClassifyUX/events/IPClassifyEvents");n.launch({title:o.confirmation_deleteLibrary_title,content:o.confirmation_deleteLibrary_message},function(){var n=e.getSelectedNodes(),c=n.length;if(c>0){l._startProgressBar(o.deleteLibrary_loading);var u=i.getCommand("DeleteLibrary",r.getContent());u.disable();var f=[],g=null;n.forEach(function(e){null===g&&"noExpandState"!==e._expandState&&!0===widget.getBool("filtered-content")&&(g=!0),f.push(UWA.is(e.id)?e.id:e.options.resourceid)}),s.DeleteLibrary({IDs:f,callbacks:{onComplete:function(e){var t=o.msg_info_librariesDeleted;1===c&&(t=o.replace(o.msg_info_libraryDeleted,{libraryname:n[0]._options.label})),a.setAuthoringMode("authoring",t),a.updateRefreshTime();for(var i=0;i<f.length;i++){var s=f[i],u=r.getTreeCont().getView()._rootNodeLibraries;u.select(),r.getTreeCont().performOperationOnNode(u,"collapse"),r.getTreeCont().performOperationOnNode(u,"expand"),d.notifyRemoveNodeInContent(s)}0===r.getContent()._libraryContentView.options.model.getAllDescendants().length&&r.getContent().getView()._addPlaceHolder(),l._offProgressBar()},onFailure:function(e,i,a){l._offProgressBar(),u.enable();var r=l.extractMyErrorMessage(e,i,a);t.displayNotification({message:r?o.msg_error_deletelibrary+"<br>"+r:o.msg_error_deletelibrary,className:"error"})}}})}})},endExecute:function(){}})}),define("DS/ClassificationEditor/commands/ActionBar_ClassAttributesToolsCmd",["UWA/Core","DS/ApplicationFrame/Command","DS/ClassificationEditor/utils/ClassificationEditorcontrol","DS/PADUtils/PADProbes","DS/IPClassificationAttributes/CreateNewAttributes"],function(e,t,i,a,r){"use strict";return t.extend({labelTopBar:e.i18n("New Boolean Attribute"),isInsert:!0,data:{},_modalChooser:null,init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!1})},beginExecute:function(){},execute:function(){(new r).buildToolsMenu({container:i.getContent().getView().elements.container,grid:i.getContent().getView().getPADTreeListView().getManager()})},endExecute:function(){}})}),define("DS/ClassificationEditor/commands/ClassificationIconBar_NewDimentionalAttribute",["UWA/Core","DS/ApplicationFrame/Command","DS/ClassificationEditor/utils/ClassificationEditorcontrol","DS/PADUtils/PADProbes","DS/IPClassificationAttributes/CreateNewAttributes"],function(e,t,i,a,r){"use strict";return t.extend({labelTopBar:e.i18n("New Attribute With Dimention"),isInsert:!0,data:{},_modalChooser:null,init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!1})},beginExecute:function(){},execute:function(){(new r).loadAttrCreatePanel({attrType:"DoubleWithDim",container:i.getContent().getView().elements.container,grid:i.getContent().getView().getPADTreeListView().getManager()})},endExecute:function(){}})}),define("DS/ClassificationEditor/service/ClassificationEditorWebService",["UWA/Core","DS/WAFData/WAFData","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor","DS/PADUtils/PADSettingsMgt","DS/PADUtils/PADUtilsServices","DS/ClassificationEditor/utils/LibrarySearch","DS/ClassificationEditor/utils/FilterUtils","DS/IPClassifyUtil/IPClassifyUtility","text!DS/ClassificationEditor/assets/ClassificationEditorProps.json","DS/ClassificationEditor/service/LibraryTypeService"],function(e,t,i,a,r,n,o,s,l,d){"use strict";return{_pageCount:50,content:function(e){var t={};UWA.extend(t,e);var i="";t.searchQuery?i="*"+e.searchQuery+'* (flattenedtaxonomies:"types/General Class" AND classification: '+e.mxid+")":(i='flattenedtaxonomies:"types/General Class"',!0===e.isAuthoringMode&&(i='type == "General Class"'),t.isExpand=!0),t.searchPageCount=this._pageCount,this._performSearchQuery(t,i,"content")},roots:function(e){var t='flattenedtaxonomies:"types/Libraries"',i=o.libraryFilter;i&&null!=i&&(t=i),!0===e.isAuthoringMode&&(t='type == "General Library"'),!0!==e.fetchAll&&(e.searchPageCount=this._pageCount),this._performSearchQuery(e,t,"roots")},favourites:function(e){this._performFetchQuery(e,"favourites")},libraries:function(e){var t={};UWA.extend(t,e),t.expand_iter="1",e.isExpandAll&&(t.expand_iter="-1");var i=o.classTreeFilter;e.isAuthoringMode&&(i=o.classTreeFilterAuth),t.filter=i,this._performExpandQuery(t,"libraries")},deleteLibrary:function(e){var t=e;if(!UWA.is(t,"object"))throw new Error("Invalid inputs for ClassificationEditorWebService.deleteLibrary");var i=r.get3DSpaceUrl()+"/resources/IPClassificationReuse/library/"+t.IDs[0]+"/delete";t.headers={"content-type":"application/json"},t.method="POST",t.timeout=12e4,this._executeRequest(i,t,"deleteLibrary")},deleteClass:function(e){var t=e;if(!UWA.is(t,"object"))throw new Error("Invalid inputs for ClassificationEditorWebService.deleteClass");var i=r.get3DSpaceUrl()+"/resources/IPClassificationReuse/class/"+t.IDs[0]+"/delete";t.headers={"content-type":"application/json"},t.method="POST",t.timeout=12e4,this._executeRequest(i,t,"deleteClass")},moveClass:function(e){var t=e;if(!UWA.is(t,"object"))throw new Error("Invalid inputs for ClassificationEditorWebService.moveClass");var i=s.get3DSpaceUrl()+"/resources/IPClassificationReuse/class/"+t.classPhysicalIds[0]+"/moveClassification?carryOver="+t.carryOverAttributeGroups;t.headers={"content-type":"application/json"},t.data={id:t.targetLibraryPhysicalId},t.data=UWA.Json.encode(t.data),t.method="POST",t.timeout=12e4,this._executeRequest(i,t,"moveClass")},setProperties:function(e){var t={};if(UWA.extend(t,e),!UWA.is(t,"object"))throw new Error("Invalid inputs for ClassificationEditorWebService.setProperties");if(!UWA.is(t.pid,"string"))throw new Error("Invalid inputs for ClassificationEditorWebService.setProperties");var i=r.get3DSpaceUrl()+"/resources/IPClassificationReuse/library/"+t.pid+"/updateClassificationProps",a=n.getSearchInfo(e.isAuthoringMode).select_predicate;a=a.concat(["flattenedtaxonomies"]),t.payload={};var o=["svg","bi_color"],l=a.filter(function(e){return o.indexOf(e)<0});t.payload.physicalid=t.pid,t.payload.select_predicate=l,t.payload.properties=t.properties,s.isIndexedMode()?(t.payload.person_predicate=[],t.payload.compute_select_bo=["icon","thumbnail_2d"]):(t.payload.person_predicate=n.getPersonPredicatesForAuth(),t.payload.compute_select_bo=["icon","thumbnail_2d"]),t.method="POST",t.headers={"content-type":"application/json",Accept:"application/json"},t.type="json",t.data={properties:t.properties,fetchPayload:t.payload},t.data=UWA.Json.encode(t.data),this._executeRequest(i,t,"setProperties")},getLibraryPathLength:function(e){e.fetchClassification=!0,this._performFetchQuery(e,"getLibraryPathLength")},getLibraryPath:function(e){var t={};UWA.extend(t,e);for(var i={},a=t.depth,r=1;r<=a;r++)i["GET_PARENT_"+r+"_LIBRARY"]=[{id:2,iter:r}];t.patterns=i,this._performNavigateQuery(t,"getLibraryPath")},_performNavigateQuery:function(e){if(!UWA.is(e,"object"))throw new Error("Invalid inputs for ClassificationEditorWebService.content");var t={};UWA.extend(t,e);var i=a.getSetting("pad_security_ctx"),s=r.get3DSpaceUrl()+"/cvservlet/navigate";!0===e.isAuthoringMode&&(s=r.get3DSpaceUrl()+"/resources/IPClassificationReuse/Navigate/navigate"),s+="?SecurityContext="+i;var l=widget.lang?widget.lang:widget.getValue("lang"),d=[];d.push(e.pid),t.payload={},t.payload.input_physical_ids=d;var c=o.classFilter;c&&null!=c&&"RootLibrary"==e.selectedType?t.payload.primitives=[{navigate_to_rel:{id:1,filter:{bo_type:c}},navigate_from_rel:{id:2}}]:t.payload.primitives=[{navigate_to_rel:{id:1},navigate_from_rel:{id:2}}],t.payload.patterns=t.patterns;var u=n.getSearchInfo(!0).select_predicate;if(u=u.concat(["flattenedtaxonomies"]),e.dynamicattrs&&e.dynamicattrs.length>0){var f=u.concat(e.dynamicattrs);t.payload.attributes=f}else t.payload.attributes=u;t.payload.version=3;var g=new Date;return t.payload.label=("LibraryWidgetNavigate_"+g.getTime()).replace(new RegExp(" ","g"),"_").replace(new RegExp(",","g"),"").replace(new RegExp("/","g"),"-"),t.method="POST",t.headers={Accept:"application/json","content-type":"application/json","Accept-Language":l},t.type="json",t.data=UWA.Json.encode(t.payload),this._executeRequest(s,t,"searchInLibrary")},_performExpandQueryIndex:function(e,t,i){var n={};UWA.extend(n,e);let o=r.get3DSpaceUrl()+"/cvservlet/progressiveexpand/v2?output_format=cvjson",s=[];return n.pid&&(n.children||(n.children=[]),n.children.push(n.pid)),n.children.forEach((e,i)=>{let a={label:t+"_"+i,root:{physical_id:e},parameters:{graph_advise:1,limit_max_path:1e4},graph:{descending_condition_object:{uql:'(flattenedtaxonomies:"types/General Class") OR (flattenedtaxonomies:"types/General Library") '}},filter:{all:1}};n.expand_iter>=0&&(a.aggregation_processors=[{truncate:{max_distance_from_prefix:n.expand_iter,prefix_filter:{prefix_path:[{physical_id_path:[e]}]}}}]),s.push(a)}),n.payload={batch:{expands:s},outputs:{select_object:i,format:"entity_relation_occurrence",hits:{predefined_computation:["mythumbnail2d","icons"]}}},n.headers={SecurityContext:a.getSetting("pad_security_ctx"),"content-type":"application/json"},n.type="json",n.data=UWA.Json.encode(n.payload),n.method="POST",this._executeRequest(o,n,"expandFolder")},_performExpandQuery:function(e){if(!UWA.is(e,"object"))throw new Error("Invalid inputs for ClassificationEditorWebService.content");var t=n.getSearchInfo(!0).select_predicate;t=t.concat(["flattenedtaxonomies"]);var i=["svg","bi_color"],a=t.filter(function(e){return i.indexOf(e)<0});let o=("LibraryWidgetExpand_"+(g=new Date).getTime()).replace(new RegExp(" ","g"),"_").replace(new RegExp(",","g"),"").replace(new RegExp("/","g"),"-");if(!0!==e.isAuthoringMode)return e.dynamicattrs&&e.dynamicattrs.length>0&&(a=a.concat(e.dynamicattrs)),this._performExpandQueryIndex(e,o,a);var s={};UWA.extend(s,e);var l=null;!0===e.isAuthoringMode&&(l=r.get3DSpaceUrl()+"/resources/IPClassificationReuse/Expand/expand");var d=widget.lang?widget.lang:widget.getValue("lang");if(s.payload={},s.payload.expand_iter=e.expand_iter,s.children&&s.children.length>0){var c=[];c.push(e.pid);for(var u=0;u<s.children.length;++u)c.push(s.children[u]);s.payload.multi_root_physicalid=c}else s.payload.root_physicalid=e.pid;if(s.filter&&!1===e.isAuthoringMode&&(s.payload["q.iterative_filter_query_bo"]=e.filter),s.filter&&!0===e.isAuthoringMode&&(s.payload.iterative_filter_query_bo=e.filter,s.payload.person_predicate=n.getPersonPredicatesForAuth()),e.dynamicattrs&&e.dynamicattrs.length>0){var f=a.concat(e.dynamicattrs);s.payload.select_bo=f}else s.payload.select_bo=a;s.payload.compute_select_bo=["icon","thumbnail_2d"];var g=new Date;return s.payload.label=("LibraryWidgetExpand_"+g.getTime()).replace(new RegExp(" ","g"),"_").replace(new RegExp(",","g"),"").replace(new RegExp("/","g"),"-"),s.payload.max_count_path="10000",s.method="POST",s.headers={Accept:"application/json","content-type":"application/json","Accept-Language":d},s.type="json",s.data=UWA.Json.encode(s.payload),this._executeRequest(l,s,"Expand")},_performFetchQuery:function(e){if(!UWA.is(e,"object"))throw new Error("Invalid inputs for ClassificationEditorWebService.content");var t={};UWA.extend(t,e);var i=a.getSetting("pad_security_ctx"),o=r.get3DSpaceUrl()+"/cvservlet/fetch/v2";o+="?SecurityContext="+i;var s=widget.lang?widget.lang:widget.getValue("lang"),l=n.getSearchInfo(e.isAuthoringMode).select_predicate;l=l.concat(["flattenedtaxonomies"]),t.payload={},e.dynamicAttrs&&e.dynamicAttrs.length>0&&(t.payload.classification_attribute=e.dynamicAttrs,l=l.concat(e.dynamicAttrs));var d=["svg","bi_color"],c=l.filter(function(e){return d.indexOf(e)<0});!0===e.fetchClassification&&c.push("classification"),t.payload.physicalid=t.ids,t.payload.select_predicate=c,!0===e.isAuthoringMode&&(o=r.get3DSpaceUrl()+"/resources/IPClassificationReuse/classifiedItem/getContentDetails",t.payload.person_predicate=n.getPersonPredicatesForAuth(),t.payload.compute_select_bo=["icon","thumbnail_2d"]);var u=new Date;return t.payload.label=("LibraryWidgetFetch_"+u.getTime()).replace(new RegExp(" ","g"),"_").replace(new RegExp(",","g"),"").replace(new RegExp("/","g"),"-"),t.method="POST",t.headers={Accept:"application/json","content-type":"application/json","Accept-Language":s},t.type="json",t.data=UWA.Json.encode(t.payload),this._executeRequest(o,t,"Fetch")},_performSearchQuery:function(e,t){if(!UWA.is(e,"object"))throw new Error("Invalid inputs for ClassificationEditorWebService.content");var i={};UWA.extend(i,e);var o=r.get3DSearchUrl()+"/search",s=widget.lang?widget.lang:widget.getValue("lang");i.payload=Object.assign({},n.getSearchInfo(e.isAuthoringMode));var l=i.payload.select_predicate;i.securityContextRequired=!1,!0===e.isAuthoringMode?(i.securityContextRequired=!0,o=r.get3DSpaceUrl()+"/resources/IPClassificationReuse/Search/search",i.payload.person_predicate=n.getPersonPredicatesForAuth(),i.payload.root_physicalid=e.pid):i.payload.login={"3dspace":{SecurityContext:a.getSetting("pad_security_ctx")}},l=l.concat(["flattenedtaxonomies"]),e.dynamicattributes&&e.dynamicattributes.length>0&&(l=l.concat(e.dynamicattributes)),i.payload.select_predicate=l;var c=new Date,u=Math.random();u.toString(36);var f=u.toString(36).substr(2,9);return i.payload.label=("LibraryWidgetSearch_"+f+"_"+c.getTime()).replace(new RegExp(" ","g"),"_").replace(new RegExp(",","g"),"").replace(new RegExp("/","g"),"-"),i.payload.locale=s,i.payload.query=t,i.payload.tenant=r.getPlatformId(),i.payload.next_start=e.next_start,i.payload.start=e.start,i.method="POST",i.headers={Accept:"application/json","content-type":"application/json","Accept-Language":s},i.type="json",e.order_field&&(i.payload.order_field=e.order_field,i.payload.order_by=e.order_by),e.searchPageCount&&(i.payload.nresults=e.searchPageCount),!0===e.fetchAll&&(i.payload.nresults=1e3),e.isExpand&&!1===e.isAuthoringMode&&(i.payload.source=["3dspace"],i.payload.specific_source_parameter={"3dspace":{search_in_context:{expand:{root_physicalid:e.pid,expand_iter:"1",type_filter_rel:[d.RELATIONSHIP_SUBCLASS]}},option:{with_Idx_Search:!0}}}),e.filters&&!1===e.isAuthoringMode&&(i.payload.refine=e.filters),i.data=UWA.Json.encode(i.payload),this._executeRequest(o,i,"searchInLibrary")},_executeRequest:function(e,r,n){var o=Math.round(1e3*Math.random()).toString(),s=widget.id+"_"+widget.getTitle()+"_";window.top.performance.mark("libraryRequest_begin"+o);var l={};if(UWA.extend(l,r),!l.payload&&e.indexOf("cvservlet")>-1){l.payload={};var d=new Date;l.payload.label=("LibraryWidgetExecute_"+d.getTime()).replace(new RegExp(" ","g"),"_").replace(new RegExp(",","g"),"").replace(new RegExp("/","g"),"-")}UWA.is(l.onTimeout,"function")||(l.onTimeout=function(){var e={type:"timeout",toString:function(){return i.msg_InfoAction_Timeout}};l.onFailure(e)},l.onComplete=function(e){window.top.performance.mark("libraryRequest_end"+o);var t=window.top.performance.getEntriesByName("libraryRequest_begin"+o);t&&1===t.length&&(window.top.performance.measure(s+"_Request"+n,"libraryRequest_begin"+o,"libraryRequest_end"+o),window.top.performance.clearMarks("libraryRequest_end"+o),window.top.performance.clearMarks("libraryRequest_begin"+o)),r.onComplete(e)});var c={Accept:"application/json","Accept-Language":widget.lang?widget.lang:widget.getValue("lang")};return!1!==l.securityContextRequired&&(c.SecurityContext=a.getSetting("pad_security_ctx")),r.headers?l.headers=UWA.extend(c,r.headers):l.headers=c,t.authenticatedRequest(e,l)},getClassificationAttributes:function(e){if(!UWA.is(e,"object"))throw new Error("Invalid inputs for ClassificationEditorWebService.getClassificationAttributes");var t={};UWA.extend(t,e);var i=r.get3DSpaceUrl()+"/resources/IPClassificationReuse/ClassAttribute/"+t.classid+"/getClassAttributes?timezoneOffset="+(new Date).getTimezoneOffset()/60;return t.method="GET",t.timeout=12e4,this._executeRequest(i,t,"getClassificationAttributes")},fetchDataForClassAttributesTab:function(e){if(!UWA.is(e,"object"))throw new Error("Invalid inputs for ClassificationEditorWebService.fetchAllTheClassificationAttributes");var t={};UWA.extend(t,e);var i=r.get3DSpaceUrl()+"/resources/IPClassificationReuse/ClassAttribute/getDataForClassAttributesTab?timezoneOffset="+(new Date).getTimezoneOffset()/60;return t.method="GET",t.timeout=12e4,t.securityContextRequired=!0,this._executeRequest(i,t,"fetchDataForClassAttributesTab")},fetchAllTheClassificationAttributes:function(e){if(!UWA.is(e,"object"))throw new Error("Invalid inputs for ClassificationEditorWebService.fetchAllTheClassificationAttributes");var t={};UWA.extend(t,e);var i=r.get3DSpaceUrl()+"/resources/IPClassificationReuse/ClassAttribute/fetchAttributes?timezoneOffset="+(new Date).getTimezoneOffset()/60;return t.method="GET",t.timeout=12e4,this._executeRequest(i,t,"fetchAllTheClassificationAttributes")},addClassAttributes:function(e){if(!UWA.is(e,"object"))throw new Error("Invalid inputs for ClassificationEditorWebService.addClassAttributes");var t={};UWA.extend(t,e);var i=r.get3DSpaceUrl()+"/resources/IPClassificationReuse/ClassAttribute/"+t.pid+"/addAttributes";if(t.headers={"content-type":"application/json"},t.attributes){var a=t.attributes,n=[];a.forEach(function(e){n.push(e.name)}),t.data={attributes:n},t.data=UWA.Json.encode(t.data)}t.method="POST",t.timeout=12e4,this._executeRequest(i,t,"addClassAttributes")},removeClassAttributes:function(e){if(!UWA.is(e,"object"))throw new Error("Invalid inputs for ClassificationEditorWebService.removeClassAttributes");var t={};UWA.extend(t,e);var i=r.get3DSpaceUrl()+"/resources/IPClassificationReuse/ClassAttribute/"+t.pid+"/removeAttributes";t.headers={"content-type":"application/json"},t.attributes&&(t.data={attributes:t.attributes},t.data=UWA.Json.encode(t.data)),t.method="POST",t.timeout=12e4,this._executeRequest(i,t,"removeClassAttributes")},exportClassificationAttributes:function(e){if(!UWA.is(e,"object"))throw new Error("Invalid inputs for ClassificationEditorWebService.exportClassificationAttributes");var t={};UWA.extend(t,e);var i=JSON.parse(l);t.headers={Accept:"application/zip","Content-Type":"application/zip","Accept-Language":widget.lang},t.package=i.package_name,t.tenant=r.getPlatformId(),t.type="blob",t.method="GET",t.timeout=18e5;var a=r.get3DSpaceUrl()+"/resources/dictionary/ExportData?tenant="+t.tenant+"&package="+t.package;this._executeRequest(a,t,"exportClassificationAttributes")},downloadCatNls:function(e){if(!UWA.is(e,"object"))throw new Error("Invalid inputs for ClassificationEditorWebService.exportClassificationAttributes");var t={};UWA.extend(t,e);JSON.parse(l);t.headers={Accept:"application/zip","Content-Type":"application/zip","Accept-Language":widget.lang},t.tenant=r.getPlatformId(),t.type="blob",t.method="GET",t.timeout=18e5;var i=r.get3DSpaceUrl()+"/resources/IPClassificationReuse/ClassAttribute/downloadCATNls";this._executeRequest(i,t,"downloadCATNls")},exportLibraryStructure:function(e){if(!UWA.is(e,"object"))throw new Error("Invalid inputs for ClassificationEditorWebService.exportLibraryStructure");var t={};UWA.extend(t,e);var i=r.get3DSpaceUrl()+"/resources/IPClassificationReuse/library/"+t.pid+"/exportStructure";t.headers={"content-type":"application/json",Accept:"application/json"},t.method="GET",t.timeout=6e5,this._executeRequest(i,t,"exportLibraryStructure")},importLibraryStructure:function(e){if(!UWA.is(e,"object"))throw new Error("Invalid inputs for ClassificationEditorWebService.importLibraryStructure");var t={};UWA.extend(t,e);var i=r.get3DSpaceUrl()+"/resources/IPClassificationReuse/library/importStructure";t.headers={"content-type":"application/json",Accept:"application/json"},t.fileContent&&(t.data={isValidate:t.isValidate,fileContent:t.fileContent},t.data=UWA.Json.encode(t.data)),t.method="POST",t.timeout=6e5,this._executeRequest(i,t,"importLibraryStructure")},hasLibrarianRole:function(e){var t=e;if(!UWA.is(t,"object"))throw new Error("Invalid inputs for LibraryEditorWebService.hasLibrarianRole");var i=s.get3DSpaceUrl()+"/resources/IPClassificationReuse/library/canManageClassificationAttributes";return t.method="GET",this._executeRequest(i,t,"hasLibrarianRole")},checkModifyAccessOnItems:function(e){var t=e;if(!UWA.is(t,"object"))throw new Error("Invalid inputs for LibraryEditorWebService.addcontent");var i=s.get3DSpaceUrl()+"/resources/IPClassificationReuse/classifiedItem/checkModifyAccess";t.headers={"content-type":"application/json"},t.data={objectIds:e.objectIds},t.data=UWA.Json.encode(t.data),t.method="POST",t.timeout=12e4,this._executeRequest(i,t,"checkModifyAccess")}}}),define("DS/ClassificationEditor/utils/ClassificationEditorDataConversion",["DS/WebappsUtils/WebappsUtils","DS/ClassificationEditor/service/LibraryTypeService","DS/PADServices/utils/AttributesMgt","DS/ClassificationEditor/utils/LibrarySearch","DS/IPClassifyUtil/IPClassifyUtility","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor"],function(e,t,i,a,r,n){var o=function(e){var t=e.toLowerCase(),a=null;i.getAvailableColumns()&&(a=i.getAvailableColumns());var r=i.getTreeColumn(),n=null;return Array.isArray(a)&&a.every(function(e){return"tree"===e&&(e=r),t==e.toLowerCase()&&(n=e),null===n}),n=n||e},s={convertToExaleadDataFormatFederated:function(e){var t={children:null},i=e.attributes,n=a.getAttrNameToPredMapping(),s={"ds6w:type":"type","ds6w:label":"label","ds6w:classificationUsage":"usage"},l={};return i.forEach(function(e){if("resourceid"==e.name||"physicalid"==e.name)t.physicalid=e.value,t.resourceid=e.value;else if("mxid"==e.name)t.mxid=e.value;else if("nonNlsStatus"==e.name)t.status=e.value;else if("type_icon_url"===e.name)t.icons=[e.value];else if("preview_url"===e.name)t.thumbnail=e.value;else if(e.name.startsWith("ds6w")){var i=e.name.split("/");"ds6w:type"===(f=i[i.length-1])&&(m=e.value,["CATIA Embedded Component","CATPart","CATProduct","CATProcess","CATDrawing","CATAnalysis","CATShape"].indexOf(m)>=0)?t.children=[]:"ds6w:created"===f&&(t.created=e.value);var a=e.object?e.object:e.value;if(a=a||e.dispValue,n[f]){if(l[f]){a=[a];var d=l[f];Array.isArray(d)||(d=[d]),a=a.concat(d)}f=n[f]}if("ds6w:created"===f||"ds6w:modified"===f){if(a.indexOf("T")<0&&(!r.isOnPremise()||r.isOnPremise()&&!0===r.isIndexedMode())){a=new Date(a);var c=new Date(a).getTimezoneOffset();a=new Date(new Date(a).getTime()+Math.abs(60*c*1e3))}else a=new Date(a);a=a.toString()}l[f]=a,l[e.name]=a;var u=s[f];u&&(t[u]=a)}else{var f=e.name;n[f]&&(f=n[f]);var g=l[o(e.name)];if(g)if(Array.isArray(g))g.push(e.value);else{var p=[g,e.value];l[o(e.name)]=p,l[f]=p}else l[o(e.name)]=e.value,l[f]=e.value}var m}),e.id||(e.id=t.resourceid),t.grid=l,t.padgrid={"ds6w:leaf":"False","ds6w:root":"True"},t},convertAttributeFromDicoToExaleadDataFormat:function(t){var i={children:null},a={};for(var r in t)if(t.hasOwnProperty(r)){if("nls_hasDefault"===r)a.hasDefault=t[r];else if("name"===r)a["ds6w:label"]=t[r],i.label=t[r],a.Name=t[r],i.Name=t[r];else if("isInDico"===r)a.isInDico=t[r];else if("nls_predicate"===r)a.Predicates=t[r];else if("default"===r)a.DefaultValue=t[r];else if("description"===r)a.Description=t[r];else if("nls_type"===r)a.Type=t[r],i.type=t[r];else if("nls_dimension"===r)a.Dimension=t[r];else if("manipulationUnit"===r)a.prefUnit=t[r];else if("origin"===r)a.origin=t[r],i.origin=t[r];else if("range"===r){var n=t[r];(n="string"==typeof n?JSON.parse(n):n).forEach(function(e){if("between"==e.operator){var t=e.value.split(" ");a.Minimum=t[0],a.Maximum=t[2]}else a.AuthorizedValues?a.AuthorizedValues+=","+e.value:a.AuthorizedValues=e.value})}else"nls_valuetype"===r?a.IsMultivalue=t[r]:"nls_multiline"===r?a.IsMultiline=t[r]:"attr_nls_en"===r?a.nls_EN=t[r]:"attr_nls_fr"===r?a.nls_FR=t[r]:"attr_nls_de"===r?a.nls_DE=t[r]:"attr_nls_ja"===r?a.nls_JA=t[r]:"attr_nls_ko"===r?a.nls_KO=t[r]:"attr_nls_ru"===r?a.nls_RU=t[r]:"attr_nls_zh"===r?a.nls_ZH=t[r]:"nls_isParametric"===r&&(a.attrIsParametric=t[r]);a.values={isInDico:t.actual_is_InDico?t.actual_is_InDico.toString():"false",hasDefault:t.hasDefault,type:t.type}}return i.icons=[e.getWebappsAssetUrl("ClassificationEditor","icons/attributes.png")],i.grid=a,i.padgrid={"ds6w:leaf":"False","ds6w:root":"True"},i},convertAttributeToExaleadDataFormat:function(t){var i={children:null},a={};for(var r in t)if(t.hasOwnProperty(r))if("nls_label"===r)a["ds6w:label"]=t[r],i.label=t[r];else if("nls_hasDefault"===r)a.hasDefault=t[r];else if("isInDico"===r)a.isInDico=t[r];else if("name"===r)a.Name=t[r];else if("nls_predicate"===r)a.Predicates=t[r];else if("default"===r)a.DefaultValue=t[r];else if("description"===r)a.Description=t[r];else if("nls_type"===r)a.Type=t[r],i.type=t[r];else if("nls_dimension"===r)a.Dimensions=t[r],t.manipulationUnit&&t.manipulationUnit.length>0&&(a.Dimensions+="("+t.manipulationUnit+")");else if("origin"===r)a.origin=t[r],i.origin=t[r];else if("range"===r){var o=t[r];(o="string"==typeof o?JSON.parse(o):o).forEach(function(e){if("between"==e.operator){var t=e.value.split(" ");a.Minimum=t[0],a.Maximum=t[2]}else a.AuthorizedValues?a.AuthorizedValues+=","+e.value:a.AuthorizedValues=e.value})}else"valuetype"===r?a.IsMultivalue=t[r]&&"multival"==t[r]?n.VALUE_TYPE_TRUE:n.VALUE_TYPE_FALSE:"nls_isParametric"===r&&(a.attrIsParametric=t[r]);return i.icons=[e.getWebappsAssetUrl("ClassificationEditor","icons/attributes.png")],i.grid=a,i.padgrid={"ds6w:leaf":"False","ds6w:root":"True"},i},convertExpandToSearchFormat:function(e,t){var i=[];return t.forEach(function(t){var a=!1;t.attributes&&t.attributes.forEach(function(t){"physicalid"===t.name&&t.value!=e&&(a=!0)}),a&&i.push(t)}),i},convertNavigateToSearchFormat:function(e){var t=[],i=e[0].outputs.GET_CONTENT;return i&&i.forEach(function(e){var i=[];for(var a in e)i.push({name:a,value:e[a]});t.push({attributes:i})}),t},convertNavigateToFlatFormat:function(e,t){var i=[];if(t.length<=0)return i;for(var a=t[0],r=a.input_object,n=a.outputs,o=e,s=0;o>0;o--){var l=n["GET_PARENT_"+o+"_LIBRARY"];l&&((l=l[0]).level=s++,i.push(l))}return i.push(r),i},getLibraryDepth:function(e){var t=e.results[0].attributes,i=[];return t.forEach(function(e){"classification"===e.name&&i.push(e.value)}),i.length+1},getPathsAndObjectsFromExpand:function(e){if(e&&!(e.length<=0)){for(var t=[],i={},a={},n={},o=0,l=e.length;o<l;++o){var d=e[o];if(d.attributes){for(var c,u,f=!0,g=0,p=d.attributes.length;g<p;++g)"physicalid"===d.attributes[g].name?(f=!1,u=d.attributes[g].value):"did"===d.attributes[g].name&&(c=d.attributes[g].value);f||(i[u]=d,a[c]=u)}else if(d.path)t.push(d.path);else if(d.Path)t.push(d.Path);else if(d.icon__default_thumbnail_2d)for(var m=0;m<d.icon__default_thumbnail_2d.length;m++)for(var C=d.icon__default_thumbnail_2d[m].did,b=0;b<C.length;b++){var y=[];y.push(d.icon__default_thumbnail_2d[m].icon),y.push(d.icon__default_thumbnail_2d[m].thumbnail_2d),n[C[b]]=y}}for(var h in i)for(var v,_=i[h],S=0;S<_.attributes.length;S++)if("did"===_.attributes[S].name){v=_.attributes[S].value,_.attributes.push({name:"icons",value:n[v]});break}for(var D in i){var E=i[D],A=s.convertToExaleadDataFormatFederated(E);i[D]=A}var P=1;r.isIndexedMode()&&(P=2);var T=[];for(o=0;o<t.length;++o){var I=t[o],L=[];for(g=0;g<I.length;g+=P)L.push(a[I[g]]);T.push(L)}return{paths:T,objects:i}}}};return s}),define("DS/ClassificationEditor/utils/Library_CSO",["DS/Selection/XSO","DS/Logger/Logger","DS/ClassificationEditor/service/LibraryTypeService","DS/ClassificationEditor/service/ClassificationEditorWebService","DS/IPClassifyUX/IPClassifyUXEvents","DS/ClassificationEditor/utils/ClassificationEditorDataConversion","DS/PADUtils/PADProbes","DS/IPClassifyUtil/IPClassifyUtility"],function(e,t,i,a,r,n,o,s){"use strict";var l=e.singleton({name:"library_cso",_logger:null,_currentLibrary:null,init:function(e){var i={areEquals:function(e,t){return e===t}};UWA.extend(i,e),this._parent(i),this._logger=t.getLogger(l);var a=this;this.onPostAdd(function(e){var t="CONTENT",i=e;UWA.is(e,"array")&&(e=e[0]),e&&UWA.is(e.getID,"function")&&e.getID()==a.getCurrentLibraryID()&&(t="TREE"),UWA.is(e)&&r.notifyLibrarySelected({context:t,selectedNode:e,allSelectNodes:i})})},addInLibraryCSO:function(e,t){if(!UWA.is(e))throw new Error("No libraryNode specified");if(!UWA.is(t))throw new Error("No context specified");var l=o.createProbe("library_addInLibraryCSO");if("TREE"==(t=t.toUpperCase())){var d=this;this.empty(!1);var c=this._currentLibrary;this._currentLibrary=e;var u=function(e,t){r.notifyCurrentLibraryChange({previousNode:e,currentNode:t}),d.add(t),l.end()};this._currentLibraryPath=[{id:e.id,type:i.getPLMTypeOfLibraryTreeNode(e),label:e.getLabel(),mxid:e.options.mxid}];var f=!1;if(i.inFamilyLibrary(e.plmType)){if(e.isVisible&&e.isVisible()&&e.getPath){var g=e.getPath();if(Array.isArray(g)&&g.length>=2&&g[0]&&"LibrarySection_AllLibraries"===g[0].plmType){this._currentLibraryPath=[];for(var p=1;p<g.length;p++){var m=g[p];this._currentLibraryPath.push({id:m.id,type:i.getPLMTypeOfLibraryTreeNode(m),label:m.getLabel()})}f=!0}}}else f=!0;f?u(c,e):a.getLibraryPathLength({ids:[e.id],onComplete:function(t){!t.results&&t.error&&(d._logger.warn("Unable to retrieve LibraryPath using Index/Search"),u(c,d._currentLibrary));var i=n.getLibraryDepth(t);if(1===i){var r={};r.id=e.id,r.type=e.plmType,r.label=e.options.label,d._currentLibrary&&r.id==d._currentLibrary.id?(d._currentLibraryPath=[],d._currentLibraryPath.push({id:r.id,type:r.type,label:r.label}),u(c,d._currentLibrary)):d._logger.log("LibraryPath returned by Index do not corresponds to the current Library")}else if(i>1){var o=i-1;a.getLibraryPath({depth:o,pid:e.id,isAuthoringMode:!s.isIndexedMode(),onComplete:function(e){var t=n.convertNavigateToFlatFormat(o,e.result);d._currentLibrary&&t[i-1].physicalid==d._currentLibrary.id&&(d._currentLibraryPath=[],t.forEach(function(e){d._currentLibraryPath.push({id:e.physicalid,type:e["ds6w:type"],label:e["ds6w:label"]})}),u(c,d._currentLibrary))},onFailure:function(e){d._logger.warn("Unable to retrieve LibraryPath using Index/Navigate"),u(c,d._currentLibrary)}})}},onFailure:function(e){d._logger.warn("Unable to retrieve LibraryPathLength using Index/Search"),u(c,d._currentLibrary)}})}else{this.empty(!1);var C=null;0===(C="array"==UWA.typeOf(e)?e:[e]).length?(null==this._currentLibrary&&(this._currentLibrary={noTree:!0,getType:function(){return"Exception"}}),this.add(this._currentLibrary),l.end()):(this.add(C),l.end())}},removeFromLibraryCSO:function(e){if(!UWA.is(e))throw new Error("No libraryNode specified");this.remove(e),0===this.getSelectedNodes().length&&e!=this._currentLibrary&&this.add(this._currentLibrary)},removeAllFromLibraryCSO:function(){this.empty(!0)},getCurrentLibrary:function(){return this._currentLibrary},getCurrentLibraryID:function(){var e=null;return this._currentLibrary&&this._currentLibrary.getID&&(e=this._currentLibrary.getID()),e},getCurrentLibraryPath:function(){var e=[];return this._currentLibraryPath&&this._currentLibraryPath.forEach(function(t){e.push({id:t.id,type:t.type,label:t.label})}),e},getSelectedNodes:function(){var e=[];return this.get()&&this.get().forEach(function(t){t.getIconUrl=function(){return""},e.push(t)}),e},getSelectedNodesID:function(){var e=[];return this.get()&&this.get().forEach(function(t){e.push(t.getID())}),e},getCAChangeAccessOnClass:function(e){return!!this.CAChangeAccess&&this.CAChangeAccess[e]},setCAChangeAccessOnClass:function(e,t){this.CAChangeAccess={},this.CAChangeAccess[e]=t}});return l}),define("DS/ClassificationEditor/commands/ActionBar_AddToFavoritesCmd",["UWA/Core","DS/ApplicationFrame/CommandCheckHeader","DS/ClassificationEditor/utils/Library_CSO","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor","DS/ClassificationEditor/utils/ClassificationEditorcontrol","DS/ClassificationEditor/service/LibraryTypeService"],function(e,t,i,a,r,n){"use strict";return t.extend({labelTopBar:a.label_ActionBar_AddToFavorites,isInsert:!0,datas:{},init:function(t){this._parent(t,{});var o=this;i.onChange(function(){o._adaptStateToCurrentLibrary()}),this.onStateChange(function(){if(o.getState()){if(t=i.getCurrentLibrary()){s=t.getID(),l=t.getType(),d=t.options.label;if(s&&n.inFamilyLibrary(l))if(e.is(r.getTreeCont()))0==r.getTreeCont().isLibraryAmongFavoriteLibraries(s)&&r.getTreeCont().addFavorite({id:s,name:d})}o.labelTopBar=a.label_ActionBar_RemoveFromFavorites}else{var t;if(t=i.getCurrentLibrary()){var s=t.getID(),l=t.getType(),d=t.options.label;if(s&&n.inFamilyLibrary(l))if(e.is(r.getTreeCont()))if(1==r.getTreeCont().isLibraryAmongFavoriteLibraries(s))!1===r.getTreeCont().removeFavorite({id:s,name:d})&&o.setState(!0,!1)}o.labelTopBar=a.label_ActionBar_AddToFavorites}})},_adaptStateToCurrentLibrary:function(){var t=i.getCurrentLibrary();if(t&&t.getID){var a=t.getID();if(e.is(r.getTreeCont())){var n=!1;r.getTreeCont().isLibraryAmongFavoriteLibraries(a)&&(n=!0),this.setState(n,!1)}}}})}),define("DS/ClassificationEditor/dataProvider/LibraryCSODataProvider",["UWA/Class","DS/ClassificationEditor/utils/Library_CSO","DS/IPClassifyUX/utils/IPClassifyWidgetData"],function(e,t,i){"use strict";return e.singleton({getCurrentObject:function(){return t.getCurrentLibrary()},getCurrentObjectPath:function(){return t.getCurrentLibraryPath()},addInCSO:function(e,i){t.addInLibraryCSO(e,i)},getSelectedNodes:function(){return t.getSelectedNodes()},getSelectedNodesID:function(){return t.getSelectedNodesID()},removeBroadcast:function(){if(1==i.getWidgetData().currentWidgetTab)return!1}})}),define("DS/ClassificationEditor/ActionBar/ClassificationCommandManager",["UWA/Class","DS/ApplicationFrame/CommandsManager","DS/ClassificationEditor/utils/ClassificationEditorcontrol","DS/ClassificationEditor/service/LibraryTypeService","DS/ClassificationEditor/utils/Library_CSO","DS/IPClassifyUX/IPClassifyUXEvents","DS/IPClassifyUXUtil/ActionBar/IPCommandManager","DS/PADServices/utils/GlobalModelEvents","DS/IPClassifyUX/utils/IPClassifyWidgetData","DS/IPClassifyUX/events/IPClassifyEvents","DS/IPClassifyUtil/IPClassifyUtility","text!DS/ClassificationEditor/assets/ClassificationProbesCommandMapping.json"],function(e,t,i,a,r,n,o,s,l,d,c,u){"use strict";var f={},g=JSON.parse(u);return e.singleton(o,{noSizeToFit:["classificationLocation"],initialize:function(){var e=this;this.enableAllCommands(!1),r.onEmpty(()=>{e.enableAllCommands(!1)});var t=new Promise(e=>{require(["text!DS/ClassificationEditor/assets/afr/ClassificationEditor.json"],e)});return new Promise(e=>{t.then(t=>{var i={};if(t)for(var a in(i=JSON.parse(t)).headers){i.headers[a].ID=a}f=i.Rules,e(i)})})},revaluateContentValue:function(e,t){if(!0===e.CONTENT)return!0;if(!t.checkWhiteClick&&!t.isFavoriteNode&&t.isCtxMenu&&!1===e.CONTENT.ctxMenu)return!1;var i=!0;if(!1!==i&&e.CONTENT.filter){var a=e.CONTENT.filter;t.isCtxMenu&&a.ctxMenuRestictTo&&Array.isArray(a.ctxMenuRestictTo)&&(i=a.ctxMenuRestictTo.includes(t.plmType)),!1!==i&&a.ctxMenuOnly&&Array.isArray(a.ctxMenuOnly)&&(i=!a.ctxMenuOnly.includes(t.tab)||1==t.isCtxMenu)}return!1!==i&&1==e.CONTENT.favCtxMenuOnly&&(i=t.isCtxMenu&&!t.isMultiSelect&&t.isFavoriteNode),!1!==i&&(!0===e.CONTENT.FavContent?i=t.isFavSection:!1===e.CONTENT.FavContent&&(i=!t.isFavSection)),!1!==i&&(!0===e.CONTENT.RootLibraries?i=t.isRoot:!1===e.CONTENT.RootLibraries&&(i=!t.isRoot||1==t.isCtxMenu&&1==t.isFavoriteNode)),!1!==i&&(!0===e.CONTENT.Libraries?i=t.isLibrary:!1===e.CONTENT.Libraries&&(i=!t.isLibrary)),!1!==i&&(!0===e.CONTENT.FavNode?i=t.isFavoriteNode:!1===e.CONTENT.FavNode&&(i=!t.isFavoriteNode)),!1!==i&&1==t.isCtxMenu&&t.isFavoriteNode&&e.CONTENT&&!0===e.CONTENT.ctxFavOnMultiSel&&(i=!0),i},revaluateTreeValue:function(e,t){if(!0===e.TREE)return!0;if(!t.checkWhiteClick&&!t.isFavoriteNode&&t.isCtxMenu&&!1===e.TREE.ctxMenu)return!1;var i=!0;if(e.TREE.filter){var a=e.TREE.filter;t.isCtxMenu&&a.ctxMenuRestictTo&&Array.isArray(a.ctxMenuRestictTo)&&(i=a.ctxMenuRestictTo.includes(t.plmType)),!1!==i&&a.ctxMenuOnly&&Array.isArray(a.ctxMenuOnly)&&(i=!a.ctxMenuOnly.includes(t.tab)||1==t.isCtxMenu)}return!1!==i&&(!0===e.TREE.Sections?i=t.isSection:!1===e.TREE.Sections&&(i=!t.isSection)),!1!==i&&(!0===e.TREE.RootLibraries?i=t.isRoot:!1===e.TREE.RootLibraries&&(i=!t.isRoot)),!1!==i&&(!0===e.TREE.Libraries?i=t.isLibrary:!1===e.TREE.Libraries&&(i=!t.isLibrary)),!1!==i&&(!0===e.TREE.FavSection?i=t.isFavSection:!1===e.TREE.FavSection&&(i=!t.isFavSection)),!1!==i&&(!0===e.TREE.FavNode?i=t.isFavoriteNode:!1===e.TREE.FavNode&&(i=!t.isFavoriteNode)),i},_manageSwitchOfCommands:function(e,t,i,r){var n=!1,o=i&&!!t&&0===t.length;!e||t&&0!=t.length||o?t&&t.length>0&&(n=t[0].isFavorite):n=e.isFavorite;var s=l.getWidgetData().currentTab,d=l.getWidgetData().currentWidgetTab,c=l.getWidgetData().isEditMode,u=l.getWidgetData().isReadOnly,g=!1,p=!1,m=!1,C=!1,b=!1,y=!1;e&&(b="LibrarySection_favorite"==e.plmType,y="LibrarySection_AllLibraries"==e.plmType,m=a.isRootLibrary(e.plmType),C=a.isLibrary(e.plmType));var h=b||y,v=!1;t&&t.every(function(e){return g=g||a.isRootLibrary(e.plmType),p=p||a.isLibrary(e.plmType),v=v||"Busy"===e.plmType,!g||!p||!v});var _=!0;if((b||v||(y||!e)&&t&&0===t.length)&&(_=!1),i||this.enableAllCommands(_),!v){var S={},D=Object.keys(f);r&&(D=r);var E={};return E.isSection=h,E.isFavSection=b,E.isCtxMenu=i,E.isFavoriteNode=n,E.checkWhiteClick=o,E.tab=s,D.forEach(a=>{var r=f[a];if(r){var l=t&&t.length>0||1==d,b=e&&1!=e.noTree&&(!l||void 0===r.CONTENT),y=!0;"object"==typeof r&&(y&&"edit"==r.WIDGET_MODE&&(y=c),!y||r.WIDGET_MODE&&"view"!=r.WIDGET_MODE||(y=!c||0==d),y&&null!=r.WIDGET_TAB&&(y=r.WIDGET_TAB==d),y&&r.TABS&&Array.isArray(r.TABS)&&(y=r.TABS.includes(s)),(y&&!1===r.TREE&&b||!1===r.CONTENT&&l)&&(y=!1),y&&o&&(y=1==r.white_click||r.white_click==e.plmType||r.white_click===s),y&&void 0!==r.multisel&&(y=!t||t.length<=1),y&&!1===r.NoSelection&&(y=t&&t.length>0),y&&i&&n&&!0!==r.ctxFavorite&&(y=t&&t.length>1&&1==r.CONTENT.ctxFavOnMultiSel),y&&!1===r.CATIAV6&&(y=!0!==widget.getValue("noCompass")),y&&!0===r.roleCheck&&(y=!u),y&&r.TREE&&b&&(E.plmType=e.plmType,E.isRoot=m,E.isLibrary=C,b=this.revaluateTreeValue(r,E)),y&&r.CONTENT&&l&&(E.plmType=t[0]?t[0].plmType:"Attribute",E.isRoot=g,E.isLibrary=p,E.isFavoriteNode=n,E.isCtxMenu=i,E.isMultiSelect=t&&t.length>1,l=this.revaluateContentValue(r,E)),y=y&&(!0===l||!0===b||null===l&&null===b||!1===l&&!1===b&&1==r.noSelection)),S[a]=y,(!i||r.TREE.filter&&r.TREE.filter.ctxMenuOnly||r.CONTENT.filter&&r.CONTENT.filter.ctxMenuOnly||o)&&this._switchCommand(a,y,r.type),i||"openWith"!==a||this.getModelEvents().publish({event:"build_openwith",data:{visible:y,nodes:l?t:[e]}})}}),S}},getCommand:function(e){var i=t.getCommands(e);return i=i||t.getCommandCheckHeader(e)},enableAllCommands:function(e){var i=t.getCommands();for(var a in i){var r=t.getCommand(a);UWA.is(r)&&r.enable&&(e?this._switchCommand(a,!0):this._switchCommand(a,!1))}},getModelEvents:function(){return s.getModelEvents()},updateCommands:function(e,t){if(t||(t=r.getCurrentLibrary()),i.getContent()&&i.getContent().getView().getPADTreeDocument()){a=(a=i.getContent().getView().getPADTreeDocument().getSelectedNodes())||(e?[e]:[]),this._parent(t,a)}else{var a=[];try{a=(a=i.getContent().getView().getPADTreeDocument().getSelectedNodes())||(e?[e]:[])}catch(e){}this._parent(t,a)}},launchCommand:function(e,t,i,a){let r=e;g&&g[e]&&(r=g[e]),"ContextualMenu"===a?c.sendTrackerPageEvent("ClassificationWidget_contextual",r):c.sendTrackerPageEvent("ClassificationWidget_iconBar",r),this._parent.apply(this,arguments)}})}),define("DS/ClassificationEditor/dataProvider/LibraryIdCardDataProvider",["UWA/Class","UWA/Class/Promise","DS/ClassificationEditor/utils/ClassificationEditorcontrol","DS/ClassificationEditor/service/ClassificationEditorWebService","DS/ClassificationEditor/utils/ClassificationEditorDataConversion","DS/ClassificationEditor/ActionBar/ClassificationCommandManager","DS/ClassificationEditor/service/LibraryTypeService","DS/IPClassifyUX/utils/IPClassifyWidgetData","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor"],function(e,t,i,a,r,n,o,s,l){"use strict";return e.singleton({getChildrenInfos:function(e){return new t(function(t){var n=i.getTreeCont()._getVisibleNodeById(e);if(n){var o=n.getChildren();t(o)}else a.libraries({pid:e,onComplete:function(i){var a=[];i.results?a=r.convertExpandToSearchFormat(e,i.results):i.result&&(a=r.convertNavigateToSearchFormat(i.result)),a.forEach(function(e){e.plmType=e.plmType||"Library"}),t(a)},onFailure:function(e){console.warn("WebService libraries Err : "+e),t([])}})})},isSection:function(e){return"LibrarySection_favorite"==e||"LibrarySection_AllLibraries"==e},needSep:function(){if(this.showSeachCommand())return!1},showSeachCommand:function(){var e=s.getWidgetData().currentWidgetTab;let t=s.getIsEditModeEnabled();return 1===e&&!t},showInformationCommand:function(){return 0===s.getWidgetData().currentWidgetTab},getStableAreaWidth:function(){var e=s.getWidgetData();if(0!==e.currentWidgetTab){let t=e.isLeader,i=e.isReadOny;return!t||i?77:s.getIsEditModeEnabled()?49:130}return 0===e.currentTab?143:1===e.currentTab?105:void 0},searchMatchCriteria:function(e,t){var i=!1,a=new RegExp(e,"i");return(a.test(t.nodeModel.options.grid.Name)||a.test(t.nodeModel.options.grid.nls_DE)||a.test(t.nodeModel.options.grid.nls_EN)||a.test(t.nodeModel.options.grid.nls_FR)||a.test(t.nodeModel.options.grid.nls_JA)||a.test(t.nodeModel.options.grid.nls_KO)||a.test(t.nodeModel.options.grid.nls_RU)||a.test(t.nodeModel.options.grid.nls_ZH))&&(i=!0),i},getClassAttributeSearch:function(e){var t=this;e=e||"";var a=i.getContent().getView().getPADTreeDocument();a.withTransactionUpdate(function(){var i=!0;a.search({match:function(a){t.searchMatchCriteria(e,a)?(a.nodeModel.show(),e.length>0&&i?(a.nodeModel.matchSearch(),i=!1):(a.nodeModel.unmatchSearch(),a.nodeModel.unselect())):(a.nodeModel.unmatchSearch(),a.nodeModel.unselect(),a.nodeModel.hide())}})})},isSearchInContextAvailable:function(){return!1},getLibraryControl:function(){return i},getCommandManager:function(){return n},getLibraryTypeService:function(){return o}})}),define("DS/ClassificationEditor/commands/LibraryCommands",["DS/IPClassifyUtil/IPClassifyAlert","DS/ClassificationEditor/utils/Library_CSO","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor","DS/ClassificationEditor/utils/ClassificationEditorcontrol","DS/ApplicationFrame/CommandsManager","DS/PADUtils/views/PADProgressBar","DS/WidgetServices/WidgetServices","text!DS/ClassificationEditor/assets/ClassificationProbesCommandMapping.json","DS/ClassificationEditor/ActionBar/ClassificationCommandManager"],function(e,t,i,a,r,n,o,s,l){"use strict";JSON.parse(s);return{_endProgressBarListener:function(){var e=this;a.getContent().getView().addEvent("onCompleteRefreshNodes",function(t){this.removeEvent("onCompleteRefreshNodes"),e._offProgressBar()})},_offProgressBar:function(){if(0===n._counter)return null;n.off()},_commonError:function(t,i,a){console.error(t,a);var r=i;!UWA.is(a)||a instanceof Error||(r+="<br>"+a),e.displayNotification({message:r,className:"error"})},_startProgressBar:function(e){1===n._counter&&n.off(),n.on(e)},_nbItemsNotNull:function(e){var t,i=e.length,a=0;for(t=0;t<i;++t)e&&a++;return a},convertSystemError:function(e){return-1!=e.indexOf("No fromconnect access to business object")?i.error_no_fromconnect_onParent:(console.error("Unexpected Error:: "+e),i.error_unexpected)},extractMyErrorMessage:function(e,t,a){var r=e;return e&&"timeout"===e.type?r=i.msg_InfoAction_Timeout:t&&(a&&"application/json"===a["content-type"]?(t="string"==typeof t?JSON.parse(t):t).error&&t.error.message&&(r=t.error.message):r="User doesnt have Librarian Role"===t?i.error_no_LibrarianRole:"string"==typeof t&&0===t.indexOf("System Error:")?this.convertSystemError(t):t),r},RenameCmd:function(e,t){if("CONTENT"==t){var i=e.manager.layout.getColumnIndex("tree"),a=e.manager.layout.getCellsFromNodeModel(e.nodeModel)[i],r=e.manager.getEditionManager(a);r.onF2&&(e.manager.setActiveCell(a),r.onF2(a))}else{var n=e.manager.layout.getColumnIndex("tree");a=e.manager.layout.getCellIDFromCoordinates({rowID:e.rowID,columnID:n});e.manager.setCellInEdition(a)}},ExpandAllCmd:function(a,r){a.plmType;var n=[];"TREE"===r&&a?n.push(a):n=t.getSelectedNodes();var o=null;o=t.getCurrentLibrary(),n.length?n.forEach(function(e){null===e.options.children||e.expandAll()}):null===o?e.displayNotification({message:i.msg_warning_nocurrentlibrary,className:"warning"}):o.expandAll()},CollapseAllCmd:function(a,r){a.plmType;var n=[],o=t.getCurrentLibrary();"TREE"===r&&a?n.push(a):n=t.getSelectedNodes(),n.length?n.forEach(function(e){e.collapseAll()}):null===o?e.displayNotification({message:i.msg_warning_noselection,className:"warning"}):o.collapseAll()},ChangeMaturityCmd:function(e,t){var i=r.getCommand("MaturityHdr",a.getContent());i&&i.begin()},AccessRightCmd:function(e,t){var i=r.getCommand("ActionBar_AccessRightCmd",a.getContent());i&&i.begin()},Information:function(){var e=a.getContent()._infoPanelView;e&&(e._context.elements.padshell._isRightOpen||e._modelEv.publish({event:"information-panel-open"}))},RemoveFavoriteCmd:function(e,t){var i=e;if(console.log("  RemoveFavoriteCmd currentFavoriteTreeNode : ",i),i&&i.isFavorite){var r=i.getID(),n=i.options.label;console.log("  currentLibrary Id : ",r),r&&UWA.is(a.getTreeCont())&&a.getTreeCont().removeFavorite({id:r,name:n})}},AddExistingAttributesCmd:function(e,t){var i=r.getCommand("AddExistingAttributes",a.getContent());i&&i.begin()},RemoveAttributesCmd:function(e,t){var i=r.getCommand("RemoveAttributes",a.getContent());i&&i.begin()},GetContextualMenuForAttributes:function(e,i,a){var r=!0===(!!e.white_Click&&e.white_Click)?r=t.getCurrentLibrary():e.nodeModel;return void 0===r&&(r=e),Array.isArray(r)||(r=[r]),"CONTENT"===i?(a||(a={cellInfos:e,data:{event:{pageX:0,pageY:0}}}),Promise.resolve(l.getContextualMenu(r,!1,a))):Promise.resolve([])},GetContextualMenu:function(e,i,r){var n,o=!!e.white_Click&&e.white_Click,s=r?a.getContent().getView().getPADTreeDocument().getSelectedNodes():[];try{n=!0===o?n=t.getCurrentLibrary():s&&s.length>0?s:e.nodeModel}catch(e){n=void 0}return void 0===n&&(n=e),Array.isArray(n)||(n=[n]),r||(r={cellInfos:e,data:{event:{pageX:0,pageY:0}}}),l.getContextualMenu(n,"TREE"===i,r)},_addHiddenInput:function(e){var t=a.getContent().getView();UWA.createElement("a",{href:e,styles:{display:"hidden"}}).inject(t.elements.container).click()}}}),define("DS/ClassificationEditor/commands/CtxCommands",["DS/ApplicationFrame/Command","DS/ClassificationEditor/commands/LibraryCommands","DS/PADUtils/PADContext"],function(e,t,i){"use strict";return e.extend({execute:function(){i.get().ctxInfo;switch(this.options.ID){case"Information":t.Information()}}})}),define("DS/ClassificationEditor/commands/ActionBar_ExportLibraryStructureCmd",["UWA/Core","DS/ApplicationFrame/Command","DS/ClassificationEditor/service/ClassificationEditorWebService","DS/IPClassifyUtil/IPClassifyAlert","DS/ClassificationEditor/commands/LibraryCommands","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor","DS/PADUtils/PADUtilsServices"],function(e,t,i,a,r,n,o){"use strict";return t.extend({labelTopBar:e.i18n("Add Existing Classification Attributes"),init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!1})},execute:function(){var e=this;require(["DS/ClassificationEditor/utils/Library_CSO"],function(t){var s,l,d,c="No Library Selected",u=!1;if(t.getCurrentLibrary()&&(s=(l=t.getCurrentLibrary()).getID(),c=l.getLabel(),d=l.plmType||l.getType()),"RootLibrary"===d)u=!0;else if("LibrarySection_AllLibraries"==d||"LibrarySection_favorite"==d){var f=t.getSelectedNodes(),g=f.length;if(1===g&&"RootLibrary"===f[0].plmType)u=!0,s=f[0].id,c=f[0].getLabel();else{var p=n.msg_exportLibrary_selectLib;g>1&&(p=n.msg_exportLibrary_selectOneLib),a.displayNotification({message:p,className:"warning"})}}else a.displayNotification({message:n.msg_exportLibrary_selectLib,className:"warning"});u&&(r._startProgressBar(n.msg_exportLibrary_loading+c),e.disable(),i.exportLibraryStructure({pid:s,onComplete:function(t,i,s,l){var d=t?JSON.parse(t):void 0;d&&d.fileContent?o.downloadfile(d.fileContent,d.fileName,"text/xml"):a.displayNotification({message:n.replace(n.msg_exportLibrary_failed,{libraryname:c}),className:"error"}),r._offProgressBar(),e.enable()},onFailure:function(t,i,o){if(t&&t.message&&t.message.includes("NetworkError"))a.displayNotification({title:n.msg_error_server_disconnect_unexpectedly_title,subtitle:n.msg_error_server_disconnect_unexpectedly_SubTitle,className:"error"});else{var s=n.replace(n.msg_exportLibrary_failed,{libraryname:c});i&&"User doesnt have Librarian Role"===i&&(s=n.replace(n.error_exportLibrary,{libraryname:c})+"<br>"+n.error_no_LibrarianRole),a.displayNotification({message:s,className:"error"})}r._offProgressBar(),e.enable()},onTimeout:function(t,i){a.displayNotification({message:n.command_exportLibrary+": "+n.msg_InfoAction_Timeout,className:"warning"}),r._offProgressBar(),e.enable()}}))})},endExecute:function(){}})}),define("DS/ClassificationEditor/commands/ActionBar_ExpandAllCmd",["UWA/Core","DS/ApplicationFrame/Command","DS/ClassificationEditor/commands/LibraryCommands","DS/ClassificationEditor/utils/Library_CSO"],function(e,t,i,a){"use strict";return t.extend({labelTopBar:e.i18n("Expand All"),isInsert:!0,datas:{},init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!1})},beginExecute:function(){},execute:function(){var e=a.getSelectedNodes();if(e.length){var t=e[0];i.ExpandAllCmd(t,"CONTENT")}else{var r=a.getCurrentLibrary();i.ExpandAllCmd(r,"TREE")}},endExecute:function(){}})}),define("DS/ClassificationEditor/commands/ActionBar_ImportLibraryStructureCmd",["UWA/Core","DS/ApplicationFrame/Command","DS/ClassificationEditor/service/ClassificationEditorWebService","DS/IPClassifyUtil/IPClassifyAlert","DS/ClassificationEditor/commands/LibraryCommands","DS/IPClassifyUtil/IPClassifyUtility","DS/IPClassifyUX/utils/IPClassifyModeManager","DS/ClassificationEditor/utils/ClassificationEditorcontrol","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor","DS/PADUtils/PADUtilsServices"],function(e,t,i,a,r,n,o,s,l,d){"use strict";return t.extend({labelTopBar:e.i18n("Add Existing Classification Attributes"),init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!1}),this.importPanel=null},beginExecute:function(){},execute:function(){var e=this;require(["DS/PADServices/utils/GlobalModelEvents","DS/IPClassifyUXUtil/FileImportPanel","DS/ClassificationEditor/utils/Library_CSO"],function(t,n,d){var c=d.getCurrentLibrary(),u=t.getModelEvents();e.importPanel=new n({panelHeaderName:l.importLibraryPanelHeader,panelHeaderIcon:{iconName:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-import",fontIconFamily:WUXManagedFontIcons.Font3DS},modelEvents:u,validateFile:e.validateFile,downloadErrorReport:e.downloadErrorReport,closePanelEvent:"AddExistingAttributesCmd/Views/showInWidgetBody",importFileEvent:"ImportLibraryStructureXML/SelectedFileContent",validationInProgressMsg:l.validateLibrary_loading});var f=[];f.push(u.subscribe({event:"ImportLibraryStructureXML/SelectedFileContent"},function(t){t.isValidate||r._startProgressBar(l.importLibrary_loading),e.disable(),i.importLibraryStructure({fileContent:t.selectedFileContent,isValidate:!1,onComplete:function(i){var n=i?JSON.parse(i):void 0;if(n&&n.ErrorDescription){var d=n.ErrorDescription;n.MissingAttributes&&(e.downloadErrorReport(d,t.fileName,n.MissingAttributes),d=l.msg_importLibrary_failedSeeReport+" ImportLibrary_ErrorReport.txt"),a.displayNotification({title:l.get("msg_importLibrary_failed"),message:d,className:"error"})}else{o.setAuthoringMode("authoring",l.msg_importLibrary_success);var u=s.getTreeCont().getView()._rootNodeLibraries;u.isExpanded()&&(s.getTreeCont().performOperationOnNode(u,"collapse"),s.getTreeCont().performOperationOnNode(u,"expand")),n&&n.LibraryMxID&&u.isSelected()&&s.getContent().loadContentAndSelect(c)}r._offProgressBar(),e.enable()},onFailure:function(t,i,n){var o=r.extractMyErrorMessage(t,i,n);o=l.msg_importLibrary_failed+o,t&&t.message&&t.message.includes("NetworkError")?a.displayNotification({title:l.msg_error_MoveInLibraryErrorMessage,subtitle:l.msg_error_server_disconnect_unexpectedly,className:"error"}):a.displayNotification({message:o,className:"error"}),r._offProgressBar(),e.enable()},onTimeout:function(t,i){a.displayNotification({message:l.command_importLibrary+": "+l.msg_InfoAction_Timeout,className:"warning"}),r._offProgressBar(),e.enable()}})})),f.push(u.subscribe({event:"AddExistingAttributesCmd/Views/showInWidgetBody"},function(e){!0===e.restore&&f.forEach(function(e){u.unsubscribe(e)})}))})},validateFile:function(e){var t=this;return new Promise(function(a){var n={};i.importLibraryStructure({fileContent:e.selectedFileContent,isValidate:!0,onComplete:function(i){var r=i?JSON.parse(i):void 0;if(r&&r.ErrorDescription){var o=r.ErrorDescription;r.MissingAttributes&&(t.downloadErrorReport(o,e.fileName,r.MissingAttributes),o=l.msg_importLibrary_failedSeeReport+" ImportLibrary_ErrorReport.txt"),n.success=!1,n.message=l.msg_importLibrary_validationFailed+o}else n.success=!0,n.message=l.msg_importLibrary_validationSucess;a(n)},onFailure:function(e,t,i){var o=r.extractMyErrorMessage(e,t,i);n.success=!1,n.message=l.msg_importLibrary_validationFailed+o,a(n)}})})},downloadErrorReport:function(e,t,i){var a="#############################################\n\t".concat(l.msg_importLibrary_errorReportHeader).concat("\n#############################################\n-----------------------------------------------\n").concat(l.msg_importLibrary_errorReportFile).concat(t).concat("\n-----------------------------------------------\n").concat(l.msg_importLibrary_errorReportMsg).concat(e).concat(": \n");i.forEach(function(e){a=a.concat(e).concat("\n")}),d.downloadfile(a,"ImportLibrary_ErrorReport.txt","text/plain")},endExecute:function(){}})}),define("DS/ClassificationEditor/commands/ActionBar_DeleteAttributesCmd",["UWA/Core","DS/ApplicationFrame/Command","DS/ClassificationEditor/commands/LibraryCommands","DS/IPClassificationAttributes/utils/AttributesUtil","DS/IPClassificationAttributes/dataprovider/DataProvider","DS/IPClassifyUtil/IPClassifyUtility","UWA/Promise","DS/ClassificationEditor/utils/Library_CSO","DS/IPClassifyUXUtil/IPClassifyConfirmation","DS/IPClassifyUtil/IPClassifyAlert","DS/ClassificationEditor/utils/ClassificationEditorcontrol","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor"],function(e,t,i,a,r,n,o,s,l,d,c,u){"use strict";return t.extend({labelTopBar:e.i18n("Delete Class Attribute"),init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!1})},beginExecute:function(){},execute:function(){var t=this,n=c.getContent().getView().getPADTreeDocument().getSelectedNodes();if(n.length>0){var o=[],s=[];if(n.forEach(function(t){"Attribute"===t.plmType&&("false"==t.options.grid.values.isInDico?s.push(e.is(t.options.label)?t.options.label:t.options.grid.Name):(t.getLabel=(()=>t.options.grid.Name),o.push(e.is(t.options.grid.Name)?t.options.grid.Name:t.id)))}),0==o.length&&s.length>0)return void d.displayNotification({message:u.msg_delete_attributesNotPossibleHere+"\n"+u.msg_delete_attributesNotPossibleSuffix,className:"warning"});var f={confirmationBoxText:u.msg_singleAttributeCheckbox,titleLabel:u.title_delete+(1==o.length?" - "+o[0]:" "+o.length+" "+u.attributes),warningMessage:u.msg_deleteSingleAttributeWarning,moreInfo:u.msg_deleteSingleAttributeMoreInfo1+"<br>"+u.msg_deleteSingleAttributeMoreInfo2};f.enableConfirmationBox=!0,o.length+s.length>1&&(t.createDataForDGV(f,n,s),f.showDGV=!0),o.length>1&&(f.confirmationBoxText=u.msg_multipleAttributeCheckbox,f.warningMessage=u.msg_deleteMultipleAttributeWarning,f.moreInfo=u.msg_deleteMultipleAttributeMoreInfo1+"<br>"+u.msg_deleteMultipleAttributeMoreInfo2),l.confirmDialog(f,function(){i._startProgressBar(u.delete_attributes_loading);var e={attributes:o};r.removeClassificationInterfaces(e).then(function(e){var n="string"==typeof e?JSON.parse(e):e,s=a.buildObjectToDelete(o);r.deleteClassAttributes(s).then(function(e){e="string"==typeof e?JSON.parse(e):e;var t=Object.keys(a.extractArributesNode(e)),s=o.filter(function(e){return t.includes(e)});if(r.reloadCache(),o.length>5)c.getContent().RefreshProductStructure=!0,c.getContent().loadContentAndSelect();else for(var l=0;l<o.length;l++)s.includes(o[l])||c.getContent()._libraryContentView.removeNodeInContent(o[l]);0===c.getContent()._libraryContentView.options.model.getAllDescendants().length&&c.getContent().getView()._addPlaceHolder(),s&&s.length>0?d.displayNotification({message:u.confirmation_delete_attributesPrefix+"<br>"+s,className:"error"}):d.displayNotification({message:u.replace(u.msg_info_attributeDeleted,{number:o.length}),className:"success"}),n.CONFLICTED_WITH&&n.CONFLICTED_WITH.length>0&&r.restoreSybolicNames(n.CONFLICTED_WITH).then(function(e){d.displayNotification({message:u.replace(u.msg_info_attributeSymbUpdated,{number:n.CONFLICTED_WITH.length}),className:"infos"})},function(e){i._commonError("DeleteAttributes",u.msg_error_creatingClassAttrSymb,e)}),i._offProgressBar()},function(e){i._offProgressBar(),t.enable(),i._commonError("DeleteAttributes",u.msg_error_deleteClassAttributes,e)})},function(e){i._offProgressBar(),t.enable(),i._commonError("DeleteAttributes",u.msg_error_deleteClassAttributes,e)})})}else d.displayNotification({message:u.msg_warning_noAttributeSelected,className:"warning"})},createDataForDGV:function(t,i,a){var r=[],n=[{dataIndex:"Tree",text:u.Name},{dataIndex:"Type",text:u.Type},{dataIndex:"isDeletable",text:u.Status}],o=u.cannotBeDeleted,s=u.toBeDeleted;i.forEach(function(t){var i={};i.Tree=e.is(t.options.label)?t.options.label:t.options.grid.Name,i.Type=t.options.type,i.isDeletable=a&&a.includes(i.Tree)?o:s,r.push(i)}),t.cols=n,t.data=r},endExecute:function(){}})}),define("DS/ClassificationEditor/utils/ClassificationEditorKeyboardListener",["UWA/Core","UWA/Class","UWA/Event","DS/ClassificationEditor/utils/ClassificationEditorcontrol","DS/ClassificationEditor/commands/LibraryCommands","DS/ClassificationEditor/ActionBar/ClassificationCommandManager","DS/ClassificationEditor/utils/Library_CSO","DS/ClassificationEditor/service/LibraryTypeService","DS/IPClassifyUX/events/IPClassifyEvents","DS/Logger/Logger"],function(e,t,i,a,r,n,o,s,l,d){var c=t.extend({name:"ClassificationEditorKeyboardListener",init:function(e){this._parent(e),this._logger=d.getLogger(c),this._onKeyDown_binded=this._onKeyDown.bind(this)},startObservingKeyboard:function(){e.Element.addEvent.call(document,"keydown",this._onKeyDown_binded)},_onKeyDown:function(e){var t=this,r=i.whichKey(e);e.ODTENVKeyName&&(r=e.ODTENVKeyName);var d,c,u,f=function(){var e=document.activeElement;return!(!e||"INPUT"!==e.tagName&&"TEXTAREA"!==e.tagName)};switch(r){case"ctrl+a":d=r,c="SelectAll",(u=n.getCommand(c))&&u.isEnabled()?f()?t._logger.log("Info : '"+d+"' key pressed in INPUT field, no command launched"):(u.begin(),i.stop(e)):t._logger.log("Info : '"+d+"' key pressed, but command '"+c+"' is disabled");break;case"alt+return":l.notifyInfoExpand();break;case"ctrl+f":var g=a.getIdCardCont();g._isSearchAvailable()&&(g.switchSearch(!0),i.stop(e));break;case"f2":if(f())t._logger.log("Info : '"+r+"' key pressed in INPUT field, no command launched");else{var p=o.getSelectedNodes(),m=o.getCurrentLibrary();if(1!=(Array.isArray(p)?p.length:0))break;var C=p[0];if(C&&s.inFamilyLibrary(C.plmType)&&a.getTreeCont().getView().isTreeNodeModelInstance(C))if(m.getID()==C.getID()){var b=a.getTreeCont();b&&b.switchLibraryTreeNodeLabelToWriteView&&b.switchLibraryTreeNodeLabelToWriteView(m)}else{var y=a.getContent();y&&y.switchLibraryTreeNodeLabelToWriteView&&y.switchLibraryTreeNodeLabelToWriteView(C)}else t._logger.log("Info : '"+r+"' key pressed but selected element is not a Library, no command launched")}}}});return c}),define("DS/ClassificationEditor/commands/ActionBar_CollapseAllCmd",["UWA/Core","DS/ApplicationFrame/Command","DS/ClassificationEditor/commands/LibraryCommands","DS/ClassificationEditor/utils/Library_CSO"],function(e,t,i,a){"use strict";return t.extend({labelTopBar:e.i18n("Collase All"),isInsert:!0,datas:{},init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!1})},beginExecute:function(){},execute:function(){var e=a.getSelectedNodes();if(e.length){var t=e[0];i.CollapseAllCmd(t,"CONTENT")}else{var r=a.getCurrentLibrary();i.CollapseAllCmd(r,"TREE")}},endExecute:function(){}})}),define("DS/ClassificationEditor/commands/ActionBar_RemoveAttributesCmd",["UWA/Core","DS/ApplicationFrame/Command","DS/ClassificationEditor/commands/LibraryCommands","DS/ClassificationEditor/service/ClassificationEditorWebService"],function(e,t,i,a){"use strict";return t.extend({labelTopBar:e.i18n("Remove Class Attributes"),init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!1}),require(["DS/ClassificationEditor/commands/LibraryCommands"],function(e){})},beginExecute:function(){},execute:function(){var t=this;require(["DS/ClassificationEditor/utils/Library_CSO","DS/IPClassifyUXUtil/IPClassifyConfirmation","DS/IPClassifyUtil/IPClassifyAlert","DS/ClassificationEditor/utils/ClassificationEditorcontrol","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor"],function(r,n,o,s,l){var d=r.getCurrentLibrary();if(d){var c=d.getID(),u=r.getCAChangeAccessOnClass(c);if(!u||"true,true"!==u&&"false,true"!==u)i._commonError("RemoveAttributes",l.command_removeAttribute+": ",l.error_noChangeAccessOnCA);else{var f=r.getSelectedNodes();if(f.length>0){var g=[],p=[],m=[],C=[];if(f.forEach(function(t){"Attribute"===t.plmType&&("Inherited"===t.options.origin?(p.push(e.is(t.getLabel())?t.getLabel():t.id),m.push(e.is(t.getLabel())?t.getLabel():t.id)):"UserAG"===t.options.origin?(p.push(e.is(t.getLabel())?t.getLabel():t.id),C.push(e.is(t.getLabel())?t.getLabel():t.id)):(t.getLabel=(()=>t.options.grid.Name),g.push(e.is(t.options.grid.Name)?t.options.grid.Name:t.id)))}),g.length>0){l.confirmation_remove_attributesSure;p.length>0&&(p.length<6?l.confirmation_remove_attributesPrefix+"<br>"+p+".<br><br>"+l.confirmation_remove_attributesSuffix:l.replace(l.confirmation_remove_attributesNumber,{number:p.length}));var b={confirmationBoxText:l.msg_checkBoxSingleRemove,titleLabel:l.command_removeAttribute+" "+g[0],moreInfo:l.msg_removeMoreInfo,deleteButtonLabel:l.command_removeAttribute,warningMessage:l.replace(l.msg_singleRemoveWarning,{attributeName:g[0],className:d._options.label})};g.length>1&&(b.warningMessage=l.replace(l.msg_multipleRemoveWarning,{className:d._options.label}),b.titleLabel=l.command_removeAttribute+" - "+g.length+" "+l.attributes,b.confirmationBoxText=l.msg_checkBoxMultipleRemove),b.enableConfirmationBox=!0,(p.length>1||g.length>1||p.length+g.length>1)&&(!function(t,i,a){var r=[],n=[{dataIndex:"Tree",text:l.Title},{dataIndex:"Type",text:l.Type},{dataIndex:"isDeletable",text:l.Status}],o=l.cannotBeRemoved,s=l.canBeRemoved;i.forEach(function(t){var i={};i.Tree=e.is(t.options.label)?t.options.label:t.options.grid.Name,i.Type=t.options.type,i.isDeletable=a&&a.includes(i.Tree)?o:s,r.push(i)}),t.cols=n,t.data=r}(b,f,p),b.showDGV=!0),n.confirmDialog(b,function(){i._startProgressBar(l.remove_attributes_loading),t.disable(),a.removeClassAttributes({pid:c,attributes:g,onComplete:function(e){var t={},a=JSON.parse(e),r=a?a.attributes:[];if(r&&r.length>0)for(var n=0;n<r.length;n++)t[r[n]]=!0;if(g.length>5)s.getContent().RefreshProductStructure=!0,s.getContent().loadContentAndSelect(d);else for(var c=0;c<g.length;c++){var u=g[c];t[u]||s.getContent()._libraryContentView.removeNodeInContent(u)}0===s.getContent()._libraryContentView.options.model.getAllDescendants().length&&s.getContent().getView()._addPlaceHolder(),i._offProgressBar(),r&&r.length>0?o.displayNotification({message:l.confirmation_remove_attributesPrefix+"<br>"+r,className:"error"}):o.displayNotification({message:l.replace(l.msg_info_attributeremoved,{number:g.length,libraryname:d.options.label}),className:"success"})},onFailure:function(e,a,r){var n=i.extractMyErrorMessage(e,a,r);i._offProgressBar(),t.enable(),i._commonError("RemoveAttributes",l.msg_error_removeClassAttributes,n)}})})}else{var y=l.msg_warning_noAttributeSelected,h=l.msg_error_removeClassAttributes;p.length>0&&(y=l.msg_remove_attributesNotPossibleSuffix,h=l.msg_remove_attributesNotPossibleHere,m.length>0&&C.length<1?(y=l.msg_nonRemovableParent_title,h=l.msg_nonRemovableParent):m.length<1&&C.length>0&&(y=l.msg_nonRemovableAttributeGroup_title,h=l.msg_nonRemovableAttributeGroup),o.displayNotification({title:h,message:y,className:"warning"}))}}else o.displayNotification({message:l.msg_warning_noAttributeSelected,className:"warning"})}}else o.displayNotification({message:l.msg_warning_nocurrentlibrary,className:"warning"})})},endExecute:function(){}})}),define("DS/ClassificationEditor/commands/ClassificationIconBar_RenameCmd",["UWA/Core","DS/ApplicationFrame/Command","DS/ClassificationEditor/commands/LibraryCommands","DS/ClassificationEditor/utils/Library_CSO","DS/ClassificationEditor/utils/ClassificationEditorcontrol"],function(e,t,i,a,r){"use strict";return t.extend({labelTopBar:e.i18n("Rename"),datas:{},init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!1})},beginExecute:function(){},execute:function(){var e=a.getSelectedNodes(),t="",n={},o="";if(e[0].pathId){t="TREE";var s=(n=r.getTreeCont().getView()._libraries_TreeView).layout.getColumnIndex("tree");o=n.layout.getCellIDFromCoordinates({rowID:e[0]._rowID,columnID:s})}else{t="CONTENT";s=(n=r.getContent().getView().getPADTreeListView().getManager()).layout.getColumnIndex("tree");o=n.layout.getCellsFromNodeModel(e[0])[s]}var l=n.getCellInfosAt(o);l.manager||(l.manager=n),i.RenameCmd(l,t)},endExecute:function(){}})}),define("DS/ClassificationEditor/commands/ActionBar_DownloadCATNlsCmd",["UWA/Core","DS/ApplicationFrame/Command","DS/ClassificationEditor/service/ClassificationEditorWebService","DS/IPClassifyUtil/service/IPClassifyUtilWebService","DS/IPClassifyUtil/IPClassifyAlert","DS/ClassificationEditor/commands/LibraryCommands","DS/WidgetServices/WidgetServices","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor"],function(e,t,i,a,r,n,o,s){"use strict";return t.extend({labelTopBar:e.i18n("Export Classification Attributes"),init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!1})},execute:function(){var e=this;n._startProgressBar(s.get("msg_info_downloadProgress")),e.disable(),i.downloadCatNls({onComplete:function(t){var i=document.createElement("a");i.href=window.URL.createObjectURL(t),i.download="CATNls.zip",i.dispatchEvent(new MouseEvent("click")),n._offProgressBar(),e.enable(),r.displayNotification({message:s.get("msg_info_downloadComplete"),className:"success"}),console.log("CatNls download complete")},onFailure:function(t,i,a){var o=s.get("msg_classificationattributes_webservicefailed")+": "+n.extractMyErrorMessage(t,i,a);r.displayNotification({message:o,className:"error"}),n._offProgressBar(),e.enable()}})},endExecute:function(){}})}),define("DS/ClassificationEditor/utils/ClassificationEditorUtil",["UWA/Utils","DS/ClassificationEditor/service/ClassificationEditorWebService","DS/ClassificationEditor/service/LibraryTypeService","DS/IPClassifyUtil/IPClassifyAlert","DS/IPClassifyUX/events/IPClassifyEvents","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor","DS/ClassificationEditor/utils/ClassificationEditorcontrol","DS/ClassificationEditor/utils/Library_CSO","DS/IPClassifyUtil/IPClassifyUtility","DS/IPClassifyUX/utils/IPClassifyModeManager","DS/PADUtils/PADSettingsMgt","DS/IPClassifyUtil/IPClassifyPreference","DS/IPClassifyUX/utils/IPClassifyWidgetData"],function(e,t,i,a,r,n,o,s,l,d,c,u,f){var g={nameRules:{maxLength:127},shouldBeEditable:function(e){return!1},prohibitedOperations:{},updatedNodes:{},oldNodeValues:{},getProhibitedOperations:function(){return this.prohibitedOperations},getOldNodeValues:function(){return this.oldNodeValues},getUpdatedNodes:function(){return this.updatedNodes},emptyProhibitedOperations:function(){this.prohibitedOperations={}},emptyOldNodeValues:function(){this.oldNodeValues={}},emptyUpdatedNodes:function(){this.updatedNodes={}},storeOldNodeValues:function(e,t){this.oldNodeValues[e]=t},cleanValues:function(e){var t={};for(let i in e){let a=e[i],r={};for(let e in a)"value"!=e&&(r[e]=null!=a[e]?a[e]:"");Object.keys(r).length>0&&(t[i]=r)}return t},uppendChangestoList:function(e){if(e&&e.Name){let i=this.updatedNodes[e.Name];if(!i){var t=e.attrType.charAt(0).toUpperCase()+e.attrType.slice(1);i={Name:e.Name,Owner:"ClassificationAttributes",Nature:"Attribute",Type:"Real"==t?"Double":t},"String"==t&&(i.MaxLength="0")}e.nameNLS&&!i.NameNLS&&(i.NameNLS=e.nameNLS),Object.keys(e.nlsRanges).length>0&&(i.AuthorizedValuesNLS=e.nlsRanges);let a=e.authorizedValues?e.authorizedValues.split(";"):[],r=e.originalRange?e.originalRange:[];a.length>0&&(i.AuthorizedValues||(i.AuthorizedValues=[],i.HasRangeDefined="Yes"),a.forEach(function(e){var a="";if("Real"==t||"real"==t||"Double"==t||"double"==t){for(var n in r)if(Number(r[n])==Number(e)){a=r[n];break}0==a.length&&(a="add:"+e)}else a=r.includes(e)?"":"add:"+e;0==a.trim().length||i.AuthorizedValues.includes(a.trim())||i.AuthorizedValues.push(a.trim())})),this.updatedNodes[e.Name]=i}},onNodeModelUpdate:function(e){var s=e.data.nodeModel;if(1==f.getWidgetData().currentWidgetTab){if(s){var l=this.updatedNodes[s.options.grid.Name];if(l||(l={Name:s.options.grid.Name,Nature:"Attribute"}),e.data.attributes)for(let t in e.data.attributes)if("DefaultValue"==t){var c=e.data.attributes[t];try{if("date/time"==e.data.nodeModel.options.grid.values.type||"timestamp"==e.data.nodeModel.options.grid.values.type){let e=new Date(c.toDateString()+" 10:00:00 GMT");c=Math.floor(e.getTime()/1e3).toString()}l.Default=c,l.HasDefault="Yes"}catch(e){console.log("date format error :"+l.Default)}}else if("AuthorizedValues"==t){let i=e.data.attributes[t]?e.data.attributes[t].split(","):[];if(i.length>0){l.AuthorizedValues=[];var u=this.oldNodeValues[s.options.grid.Name];if(u){var p=u.split(","),m=this.prohibitedOperations.removeRangeNotAllowed;if(m||(m=this.prohibitedOperations.removeRangeNotAllowed=[]),p.some(function(e){return!i.includes(e)}))m.includes(s.options.grid.Name)||m.push(s.options.grid.Name);else{var C=m.indexOf(s.options.grid.Name);m.splice(C,1),0==m.length&&(this.prohibitedOperations={},i.forEach(function(e){l.AuthorizedValues.push("add:"+e)}),l.AuthorizedValues.length>0&&(l.HasRangeDefined="Yes"))}}}}else if(t.startsWith("nls_")){l.NameNLS||(l.NameNLS={en:s.options.grid.nls_EN,fr:s.options.grid.nls_FR,de:s.options.grid.nls_DE,ja:s.options.grid.nls_JA,ko:s.options.grid.nls_KO,ru:s.options.grid.nls_RU,zh:s.options.grid.nls_ZH});let i=t.split("_")[1].toLowerCase();l.NameNLS[i]=e.data.attributes[t]}}(l.NameNLS&&Object.keys(l.NameNLS).length>0||"Yes"==l.HasRangeDefined||"Yes"==l.HasDefault)&&(this.updatedNodes[s.options.grid.Name]=l)}else{if(!i.inFamilyLibrary(s.plmType))return;var b=s._lastUpdateTime?s._lastUpdateTime:0,y=Date.now()-b;if(s._lastUpdateTime=Date.now(),console.log("lastUpdateTime : "+b+", elapsedTime : "+y),0!==b&&y<300)return;if(s._resetting)return void(s._resetting=!1);var h=s.getID(),v=s.options.label,_=s.options.oldLabel;if(void 0===_&&(_=""),v===_)return;v&&v.trim&&(v=v.trim());var S=!0;if(v.length>g.nameRules.maxLength&&(a.displayNotification({message:n.replace(n.get("msg_error_name_maxlength"),{name:v,maxLength:g.nameRules.maxLength}),className:"error"}),S=!1),0==v.trim().length&&(a.displayNotification({message:n.get("msg_error_name_empty"),className:"error"}),S=!1),S)if(s.isFavorite){if(UWA.is(o.getTreeCont())){var D={id:h,name:_};o.getTreeCont().renameFavorite(D,v,s)}}else t.setProperties({pid:h,plmType:s.plmType,properties:{title:v},onComplete:function(e){var t;"RootLibrary"===s.plmType?t=n.replace(n.get("msg_info_renameLibrary"),{name1:_,name2:v}):"Library"===s.plmType&&(t=n.replace(n.get("msg_info_renameClass"),{name1:_,name2:v})),d.setAuthoringMode("authoring",t),d.updateRefreshTime(),s.options.oldLabel=v,r.notifyLibraryRename({oldNode:s,newLabel:v});var i={},a=[];a.push(h),i.modified=a,i.fromRenameOp=!0,o.getContent()._libraryContentView.getPADTreeDocument().refreshNodeById(i)},onFailure:function(e){a.displayNotification({message:n.replace(n.get("msg_error_rename"),{name1:_}),className:"error"}),s._resetting=!0,setTimeout(function(){s.withTransactionUpdate(function(){this.setLabel(_)}),s._resetting=!1})}});else s.withTransactionUpdate(function(){this.setLabel(_)})}},getCurrentSecurityContextAndLibraryData:function(e){var t=s.getCurrentLibrary(),a=c.getSetting("pad_security_ctx"),r=widget.getValue("pad_tenant"),n={From:"ClassificationEditor",LibraryID:null,LibraryType:null,IsInDeletedItems:!1,Timestamp:Date.now(),Tenant:r,SecurityContext:a};return t&&(i.inFamilyLibrary(t.plmType)||e)&&(n.LibraryID=t.getID(),n.LibraryType=t.getType()),n},sortColumn:function(e,t){var a=i.inFamilyLibrary(e.plmType),r=i.inFamilyLibrary(t.plmType);return a&&!r?-1:!a&&r?1:0},setLeftPanelStatus:function(e){u.set("classEditor_view_status",{leftPanelState:e},!0,!1)},setRightPanelStatus:function(e){u.set("classEditor_view_status",{rightPanelState:e},!0,!1)},getLeftPanelStatus:function(){return new Promise(function(e){u.get("classEditor_view_status",function(t){t&&t.hasOwnProperty("leftPanelState")?e(t.leftPanelState):e({leftPanelState:!0,isWelcomePanelCollapsed:!1})},!0)})},getRightPanelStatus:function(){return new Promise(function(e){u.get("classEditor_view_status",function(t){t&&t.hasOwnProperty("rightPanelState")?e(t.rightPanelState):e({rightPanelState:!1,size:250})},!0)})},sortAttributeColumn:function(e,t,i){var a=e.options.grid[i.order_field]?e.options.grid[i.order_field]:"",r=t.options.grid[i.order_field]?t.options.grid[i.order_field]:"",n=a.localeCompare(r);return"asc"===i.order_by?n:-n},CONTENT_TABS:{CLASSES:0,CLASSIFICATION_ATTRIBUTES:1,LIBRARIES:0,EXCEPTIONS:1},CURRENT_TAB_VALUE:0};return g}),define("DS/ClassificationEditor/commands/ActionBar_SaveUpdatesCmd",["UWA/Core","DS/ApplicationFrame/Command","DS/IPClassifyUX/utils/IPClassifyWidgetData","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor","DS/ClassificationEditor/ActionBar/ClassificationCommandManager","DS/PADUtils/PADContext","DS/ClassificationEditor/utils/ClassificationEditorUtil","DS/IPClassificationAttributes/dataprovider/DataProvider","DS/ClassificationEditor/commands/LibraryCommands","DS/IPClassificationAttributes/utils/AttributesUtil","text!DS/IPClassificationAttributes/assets/IPClassificationAttributesProps.json","DS/IPClassifyUtil/IPClassifyAlert","DS/ClassificationEditor/utils/ClassificationEditorcontrol"],function(e,t,i,a,r,n,o,s,l,d,c,u,f){"use strict";return t.extend({labelTopBar:e.i18n("Save Changes"),init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!1})},beginExecute:function(){},execute:function(){var e=o.getProhibitedOperations();if(Object.keys(e).length>0){var t="";return Object.keys(e).forEach(function(i){t=a[i]+"<br>"+e[i].join("<br>")}),void u.displayNotification({message:t,className:"error"})}var g=o.getUpdatedNodes();if(0!=Object.keys(g).length){var p=JSON.parse(c);s.updateClassAttributes(d.formatObjectToSend(g)).then(function(e){var t=(e="string"==typeof e?JSON.parse(e):e).Dictionary.Interfaces[p.interface_name].Attributes,l=[];if(Object.keys(g).forEach(function(e){var i=g[e],a=t[e],r=t[e].Type;Object.keys(i).forEach(function(t){let n=i[t],o=a[t];if("boolean"===(r=r.toLowerCase())&&"Default"==t&&("Yes"!=o&&"No"!=o||(o="Yes"==o)),"NameNLS"==t&&o)Object.keys(n).forEach(function(t){n[t]==o[t]||l.includes(e)||l.push(e)});else if("AuthorizedValues"==t&&o){"double"==r&&(o=o.map(e=>Number(e).toString())),n.every(function(e){var t=e;return e.indexOf(":")>-1&&(t=e.split(":")[1]),"double"==r&&(t=Number(t).toString()),o.includes(t)})||l.includes(e)||l.push(e)}else"AuthorizedValuesNLS"==t&&o?Object.keys(n).forEach(function(t){let i=n[t];Object.keys(i).forEach(function(a){"value"==a||i[a]==o[t][a]||l.includes(e)||l.push(e)})}):"Default"!=t||n==o||l.includes(e)||l.push(e)})}),l&&l.length>0)u.displayNotification({message:a.confirmation_update_attributesPrefix+"<br>"+l,className:"error"});else{u.displayNotification({message:a.replace(a.msg_info_attributeUpdated,{number:Object.keys(g).length}),className:"success"});var d=n.get(),c=d.options.views?d.options.views.datagridview:void 0;if(c){var m=c.options.dgvLayout.getLeafColumns();m&&Array.isArray(m)&&m.forEach(function(e){e.toggleToEdit&&!0===e.toggleToEdit&&(e.getCellEditableState=function(e){return!1},e.getCellTypeRepresentation=function(e){return"string"}),"AuthorizedValues"===e.dataIndex&&(e.getCellValue=function(e){if(e.nodeModel)return{label:e.nodeModel.getAttributeValue("AuthorizedValues"),url:""}})}),c.options.dgv.treeDocument.acceptChanges(),c.options.dgv.treeDocument.setUseChangeTransactionMode(!1),c.options.dgv.getModel().updateRenderedColumn("AuthorizedValues",{updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!1},!0),f.getContent().RefreshProductStructure=!0,s.reloadCache().then(function(){f.getContent().loadContentAndSelect()},function(e){f.getContent().loadContentAndSelect()}),o.emptyOldNodeValues(),o.emptyUpdatedNodes(),o.emptyProhibitedOperations(),i.setIsEditModeEnabled(!1),r.updateCommands()}}},function(e){l._commonError("SaveUpdatesCmd",a.msg_error_updateClassAttributes,e)})}else u.displayNotification({message:a.noAttributetoUpdate,className:"warning"})},endExecute:function(){}})}),define("DS/ClassificationEditor/commands/ActionBar_EditAttributesCmd",["UWA/Core","DS/ApplicationFrame/Command","DS/IPClassifyUX/utils/IPClassifyWidgetData","DS/PADUtils/PADContext","DS/ClassificationEditor/ActionBar/ClassificationCommandManager","DS/ClassificationEditor/utils/ClassificationEditorUtil","DS/IPClassificationAttributes/utils/EventHandler"],function(e,t,i,a,r,n,o){"use strict";return t.extend({labelTopBar:e.i18n("Edite Class Attributes"),init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!1})},beginExecute:function(){},execute:function(){n.emptyUpdatedNodes();var e=a.get(),t=e.options.views?e.options.views.datagridview:void 0;if(t){try{var o=t.options.dgv.layout.getColumnIndex("AuthorizedValues"),s=t.options.dgv.getRowModelLength();if(s)for(var l=0;l<s;l++){var d=t.options.dgv.layout.getCellIDFromCoordinates({rowID:l,columnID:o}),c=t.options.dgv.getCellInfosAt(d);c&&n.storeOldNodeValues(c.nodeModel.options.grid.Name,c.nodeModel.getAttributeValue("AuthorizedValues"))}}catch(e){}var u=t.options.dgvLayout.getLeafColumns();u&&Array.isArray(u)&&u.forEach(function(e){e.getCellEditableState=function(t){try{if("false"==t.nodeModel.options.grid.values.isInDico)return!1;if("DefaultValue"===e.dataIndex)return"TRUE"==t.nodeModel.options.grid.values.hasDefault}catch(e){console.log(e)}return!0===e.toggleToEdit},"AuthorizedValues"===e.dataIndex&&(e.getCellTypeRepresentation=function(e){return"url"},e.getCellValue=function(e){if(e.nodeModel)return e.nodeModel.options.grid.AuthorizedValues&&e.nodeModel.options.grid.AuthorizedValues.length>0&&"true"==e.nodeModel.options.grid.values.isInDico?{label:e.nodeModel.getAttributeValue("AuthorizedValues"),func:"valuesClickAction",module:"DS/IPClassificationAttributes/utils/EventHandler"}:{label:e.nodeModel.getAttributeValue("AuthorizedValues"),func:"",module:""}},e.setCellValue=function(e,t){if(e.nodeModel){var i={grid:{}};t.hasOwnProperty("label")&&(i.grid.AuthorizedValues=t.label),e.nodeModel.updateOptions(i)}}),"DefaultValue"===e.dataIndex&&(e.getCellTypeRepresentation=function(e){if(e.nodeModel&&e.nodeModel.options.grid.values.type){var t=e.nodeModel.options.grid.values.type;return"boolean"==t.toLowerCase()||e.nodeModel.options.grid.AuthorizedValues?"string":"date/time"==t.toLowerCase()||"timestamp"==t.toLowerCase()?"date":"real"==t.toLowerCase()?"double":e.nodeModel.options.grid.values.type.toLowerCase()}return"string"},e.getCellSemantics=function(e){if(e.nodeModel&&e.nodeModel.options.grid.values.type){if("boolean"===e.nodeModel.options.grid.values.type.toLowerCase())return{possibleValues:["false","true"]};var t=e.nodeModel.options.grid.AuthorizedValues;if(t)return{possibleValues:t.split(",")}}return{}})}),t.options.dgv.treeDocument.setUseChangeTransactionMode(!0),t.options.dgv.getModel().updateRenderedColumn("AuthorizedValues",{updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!1},!0),i.setIsEditModeEnabled(!0),r.updateCommands()}},endExecute:function(){}})}),define("DS/ClassificationEditor/commands/ActionBar_CancelUpdatesCmd",["UWA/Core","DS/ApplicationFrame/Command","DS/IPClassifyUXUtil/IPClassifyConfirmation","DS/IPClassifyUX/utils/IPClassifyWidgetData","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor","DS/ClassificationEditor/ActionBar/ClassificationCommandManager","DS/PADUtils/PADContext","DS/ClassificationEditor/utils/ClassificationEditorUtil","DS/IPClassificationAttributes/dataprovider/DataProvider","DS/IPClassifyUtil/IPClassifyAlert"],function(e,t,i,a,r,n,o,s,l,d){"use strict";return t.extend({labelTopBar:e.i18n("Undo Edit"),init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!1})},beginExecute:function(){},execute:function(){var e=this,t=s.getUpdatedNodes();0==Object.keys(t).length?(d.displayNotification({message:r.noCangesToUndo,className:"warning"}),e.cancelChanges()):i.launch({title:r.command_CancelUpdates,content:r.confirmation_cancel_attributesSure,confirmLabel:r.confirmation_ok},function(){e.cancelChanges()})},cancelChanges:function(){var e=o.get(),t=e.options.views?e.options.views.datagridview:void 0;if(t){var i=t.options.dgvLayout.getLeafColumns();i&&Array.isArray(i)&&i.forEach(function(e){e.getCellEditableState=function(e){return!1},e.toggleToEdit&&!0===e.toggleToEdit&&(e.getCellTypeRepresentation=function(e){return"string"}),"AuthorizedValues"===e.dataIndex&&(e.getCellValue=function(e){if(e.nodeModel){let t=e.nodeModel.getAttributeValue("AuthorizedValues"),i=s.getOldNodeValues()[e.nodeModel.options.grid.Name];return i&&(t=i,e.nodeModel.options.grid.AuthorizedValues=t),{label:t,func:"",module:""}}})}),t.options.dgv.treeDocument.cancelChanges(),t.options.dgv.treeDocument.setUseChangeTransactionMode(!1),t.options.dgv.getModel().updateRenderedColumn("AuthorizedValues",{updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!1},!0),a.setIsEditModeEnabled(!1),s.emptyOldNodeValues(),s.emptyUpdatedNodes(),n.updateCommands(),s.emptyProhibitedOperations(),l.setSavedNlsRanges(void 0,{})}},endExecute:function(){}})}),define("DS/ClassificationEditor/dataProvider/LibraryContentDataProvider",["UWA/Class","UWA/Class/Promise","DS/PADUtils/PADProbes","DS/WebappsUtils/WebappsUtils","DS/ClassificationEditor/utils/ClassificationEditorDataConversion","DS/ClassificationEditor/service/ClassificationEditorWebService","DS/ClassificationEditor/service/LibraryTypeService","DS/IPClassifyUtil/IPClassifyPreference","DS/ClassificationEditor/utils/ClassificationEditorUtil","DS/ClassificationEditor/utils/LibrarySearch","DS/ClassificationEditor/commands/LibraryCommands","DS/IPClassifyUtil/IPClassifyAlert","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor","DS/ClassificationEditor/utils/Library_CSO","DS/IPClassificationAttributes/utils/EventHandler","DS/IPClassifyUtil/IPClassifyUtility","DS/ClassificationEditor/utils/ClassificationEditorcontrol","DS/IPClassifyUX/utils/IPClassifyWidgetData","DS/ClassificationEditor/ActionBar/ClassificationCommandManager"],function(e,t,i,a,r,n,o,s,l,d,c,u,f,g,p,m,C,b,y){"use strict";var h={FAVORITES:"ipcFavoriteList_v1",getFavorites:function(){return m.getTenantAwarePreferenceName(this.FAVORITES)}},v=null,_={order_field:"Name",order_by:"asc"},S=e.singleton({getObjectsForRefresh:function(e,i){var a=this;return new t(function(t){var o=[];i.forEach(function(e){e.isDynamic&&-1===o.indexOf(e.dataIndex)&&o.push(e.dataIndex)}),n._performFetchQuery({ids:e,dynamicAttrs:o,isAuthoringMode:!0,onComplete:function(e){var i=[];e.results&&e.results.length>0&&e.results.forEach(function(e){let t=r.convertToExaleadDataFormatFederated(e);a.setIconsForLibraries(t),i.push(t)}),t(i)},onFailure:function(){console.error("Unable to update Content root node, Error in getting content Properties"),t(null)}})})},setIconsForLibraries:function(e,t){var i,r=e.options?e.options:e,n=r.thumbnail;"General Class"==r.type&&"Definition"==r.grid["ds6w:classificationUsage"]&&((i=[]).push(a.getWebappsAssetUrl("LibraryEditor","icons/categorizationIcons/GeneralClass_small.png")),n.includes("I_GeneralClass")&&(r.thumbnail=a.getWebappsAssetUrl("LibraryEditor","icons/categorizationIcons/GeneralClass_Tile.png")),r.icons=i);"General Library"==r.type&&"Standard"==r.grid["ds6w:classificationUsage"]&&((i=[]).push(a.getWebappsAssetUrl("LibraryEditor","icons/categorizationIcons/GeneralLibrary_small.png")),n.includes("I_GeneralLibrary")&&(r.thumbnail=a.getWebappsAssetUrl("LibraryEditor","icons/categorizationIcons/GeneralLibrary_Tile.png")),r.icons=i)},getExceptionTabContents:function(e){return _.order_field=e.order_field,_.order_by=e.order_by,new t(function(e,t){var a=i.createProbe("probeFindClassificationAttrs");n.fetchDataForClassAttributesTab({onComplete:function(t){var i=JSON.parse(t),n=i.attribute;n||(n=i.Attribute);var o=function(e){var t={},i=[];e.forEach(function(e){var t=r.convertAttributeFromDicoToExaleadDataFormat(e);t.plmType="Attribute",i.push(t)}),t.results=i;var a={};return a.nhits=i.length,a.nresults=i.length,a.next_start="0 0",t.infos=a,t}(n);p&&p.setAttributeNameList(n),e({results:o.results,infos:o.infos,facets:{}}),a.end()},onFailure:function(e,i,r){t({results:[],facets:{}}),u.displayNotification({message:f.get("msg_classificationattributes_webservicefailed")+": "+i,className:"error"}),a.end()}})})},_getAttributesTabContents:function(e){return _.order_field=e.order_field,_.order_by=e.order_by,new t(function(t,a){var o=i.createProbe("probeFetchClassificationAttrs");n.getClassificationAttributes({classid:e.pid,onComplete:function(i){var a=JSON.parse(i),n=a.attribute;n||(n=a.Attribute),g.setCAChangeAccessOnClass(e.pid,a.changeaccess);var s=function(e){var t={},i=[];e.forEach(function(e){var t=r.convertAttributeToExaleadDataFormat(e);t.plmType="Attribute",i.push(t)}),t.contents=i;var a={};return a.nhits=i.length,a.nresults=i.length,a.next_start="0 0",t.infos=a,t}(n);t({contents:s.contents,infos:s.infos,facets:{}}),o.end()},onFailure:function(e,t,i){var r=f.get("msg_classificationattributes_webservicefailed")+": "+c.extractMyErrorMessage(e,t,i);a({msg:r}),o.end()}})})},_getDefaultTabContents:function(e){return new t(function(t,i){n.content({pid:e.pid,mxid:e.mxid,searchQuery:e.searchQuery,isExactSearch:e.isExactSearch,selectedType:e.selectedType,dynamicattributes:e.dynamicattributes,filters:e.filters,start:e.start,next_start:e.next_start,order_field:e.order_field,order_by:e.order_by,grid:e.grid,isAuthoringMode:!m.isIndexedMode(),onComplete:function(i){if((i="string"==typeof i?JSON.parse(i):i).result)return a=r.convertNavigateToSearchFormat(i.result),void t({contents:n(a),infos:i.infos,facets:i.facets});var a=function(e,t){var i=[];null!=e&&e.forEach(function(e){var a=!1;e.attributes&&e.attributes.forEach(function(e){"physicalid"===e.name&&e.value!=t&&(a=!0)}),a&&i.push(e)});return i}(i.results,e.pid);function n(e){var t=[];return e.forEach(function(e){var i=r.convertToExaleadDataFormatFederated(e),a=e.attributes;i.plmType=o.getPlmTypeFromContentDetails(a),i.Documentlocked=e.Documentlocked,i.publishOnConnect=e.publishOnConnect,t.push(i)}),t}t({contents:n(a),infos:i.infos,facets:i.facets})},onFailure:function(e,t){i({err:e,serverErr:t,msg:f.msg_error_contentnotavailable})}})})},getObjectContents:function(e){return v=e.widgetData,new t(function(t,i){var a=e.widgetData;!a||!a.currentTab&&!a.currentWidgetTab||a.currentTab===l.CONTENT_TABS.CLASSES&&a.currentWidgetTab===l.CONTENT_TABS.LIBRARIES?S._getDefaultTabContents(e).then(function(e){t(e)},function(e){i(e)}):1===a.currentTab&&0===a.currentWidgetTab?S._getAttributesTabContents(e).then(function(e){t(e)},function(e){i(e)}):1===a.currentWidgetTab&&S.getExceptionTabContents(e).then(function(e){t(e)},function(e){i(e)})})},getPaginatedSectionContents:function(e){return v=e.widgetData,new t(function(t,i){n.roots({filters:e.filters,start:e.start,next_start:e.next_start,order_field:e.order_field,order_by:e.order_by,isAuthoringMode:!m.isIndexedMode(),onComplete:function(e){var i=[];e.results&&e.results.forEach(function(e){var t=r.convertToExaleadDataFormatFederated(e),a=e.attributes;t.plmType=o.getPlmTypeFromContentDetails(a),t.Documentlocked=e.Documentlocked,t.publishOnConnect=e.publishOnConnect,i.push(t)}),t({results:i,infos:e.infos,facets:e.facets})},onFailure:function(){i()}})})},getPreferenceSectionContents:function(e){return v=e.widgetData,new t(function(t,i){n.favourites({ids:e.ids,onComplete:function(e){for(var i=(e="string"==typeof e?JSON.parse(e):e).results?e.results:[],a=[],n=0;n<i.length;++n){var s=o.getPlmTypeFromContentDetails(i[n].attributes),l=r.convertToExaleadDataFormatFederated(i[n]);l.plmType=s,a.push(l)}t(a)},onFailure:function(e){i(e)}})})},getContextualMenu:function(e,t,i,a){return i&&i.currentTab&&i.currentTab!==l.CONTENT_TABS.CLASSES?i.currentTab===l.CONTENT_TABS.CLASSIFICATION_ATTRIBUTES?c.GetContextualMenuForAttributes(e,t,a):[]:c.GetContextualMenu(e,t,a)},comparator:function(e,t){return 1==b.getWidgetData().currentWidgetTab?l.sortAttributeColumn(e,t,_):v&&v.currentTab&&v.currentTab!==l.CONTENT_TABS.CLASSES?v.currentTab===l.CONTENT_TABS.CLASSIFICATION_ATTRIBUTES?l.sortAttributeColumn(e,t,_):void 0:l.sortColumn(e,t)},getPreferenceSectionName:function(){return h.getFavorites()},isValidType:function(e){return o.inFamilyLibrary(e)},isValidTypeForPlaceholder:function(e,t){return!0},showClassTabs:function(){return 0===b.getWidgetData().currentWidgetTab},getFilterOptions:function(){return 1===b.getWidgetData().currentWidgetTab?{Type:{filterId:"string",filterModel:{condition1:{type:"contains",filter:""}}}}:void 0},toEnableTreeColumnEdit:function(e,t){return 1!==t.currentWidgetTab&&(!t||!t.currentTab||t.currentTab===l.CONTENT_TABS.CLASSES)},isSection:function(e){return"LibrarySection_favorite"==e||"LibrarySection_AllLibraries"==e},isPreferenceSection:function(e){return"LibrarySection_favorite"==e},isPaginatedSection:function(e){return"LibrarySection_AllLibraries"==e},shouldBeEditable:function(e){return l.shouldBeEditable(e)},onContentUpdate:function(e){return l.onNodeModelUpdate(e)},onAddColumn:function(e){d.filterExcludeListColumns(e).length>0&&(d.setPredicates(e),d.addToPredicateHeaderMap(e))},onRemoveColumn:function(e){d.removePredicates(e),d.removeFromPredicateHeaderMap(e)},onResetColumn:function(e,t){d.removeAllPredicates(),d.setPredicates(e,t)},setColumnNames:function(e,t){d.setPredicates(e,t)},initColumns:function(e){d.initPredicateToHeaderMap(e)},getPageTabs:function(){var e=[];return e.push({label:f.classes_tab,isSelected:!0,value:l.CONTENT_TABS.CLASSES,icon:{iconName:"library-class",fontIconFamily:WUXManagedFontIcons.Font3DS}}),e.push({label:f.classification_attributes_tab,value:l.CONTENT_TABS.CLASSIFICATION_ATTRIBUTES,icon:{iconName:"attributes",fontIconFamily:WUXManagedFontIcons.Font3DS}}),e},getTabsVisOnSelectionChange:function(){if(!g.getCurrentLibrary())return!1;var e=g.getCurrentLibrary().getType();return!this.isSection(e)&&"RootLibrary"!==e},reloadAfterSort:function(){return 1!=b.getWidgetData().currentWidgetTab},getColumnConfig:function(e){return!e||!e.currentTab&&!e.currentWidgetTab||e.currentTab===l.CONTENT_TABS.CLASSES&&e.currentWidgetTab===l.CONTENT_TABS.LIBRARIES?[{dataIndex:"ds6w:classificationUsage"},{dataIndex:"ds6w:type"},{dataIndex:"ds6w:status"},{dataIndex:"ds6w:description"},{dataIndex:"ds6w:responsible"},{dataIndex:"ds6w:modified"},{dataIndex:"ds6w:created"},{dataIndex:"ds6w:identifier"},{dataIndex:"ds6w:reservedBy"}]:[{dataIndex:"Name",text:f.column_Name,defaultSortOrder:"asc"},{dataIndex:"Type",text:f.column_Type},{dataIndex:"Description",text:f.column_Description},{dataIndex:"DefaultValue",text:f.column_DefaultValue},{dataIndex:"hasDefault",text:f.hasDefault},{dataIndex:"Dimensions",text:f.column_Dimensions},{dataIndex:"Predicates",text:f.column_Predicates},{dataIndex:"AuthorizedValues",text:f.column_Authorized_Values},{dataIndex:"attrIsParametric",text:f.column_Is_Parametric},{dataIndex:"IsMultivalue",text:f.column_Is_Multivalue},{dataIndex:"Minimum",text:f.column_Minimum},{dataIndex:"Maximum",text:f.column_Maximum},{dataIndex:"isInDico",text:f.existInDictionary}]},isDNDSupported:function(){return!0},showContentPlaceholder:function(){return!0},doSelect:function(){return 1!=b.getWidgetData().currentWidgetTab},hasWelcomePanel:function(){return 1!=b.getWidgetData().currentWidgetTab},hasLibrarianRole:function(){return new t(function(e,t){n.hasLibrarianRole({onComplete:function(t){e({readOnly:JSON.parse(t).isAuthorized.readOnly})},onFailure:function(){t({readOnly:!1})}})})},getLibraryControl:function(){return C},getLibraryEditorUtil:function(){return l},getLibraryTypeService:function(){return o},getStatus:function(e,t){return!1===e.contains(".")&&(e=t&&t.contains(" ")?t+"."+e.toUpperCase():t&&t.contains("_")?t+"."+(e=e.replace(" ","_")).toUpperCase():t&&e.contains(" ")?t+"."+(e=e.replace(" ","")):t+"."+e),e}});return S}),define("DS/ClassificationEditor/dataProvider/ClassificationTabBarProvider",["UWA/Class","DS/ClassificationEditor/utils/ClassificationEditorUtil","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor","DS/ClassificationEditor/utils/ClassificationEditorcontrol"],function(e,t,i,a){"use strict";return e.singleton({getTabBars:function(){var e=[],a={};a.tabOptions={label:i.library_tab,value:t.CONTENT_TABS.LIBRARIES,icon:{iconName:"library",fontIconFamily:WUXManagedFontIcons.Font3DS}},a.showTreeView=!0,a.plmType="LibrarySection_AllLibraries",e.push(a);var r={};return r.tabOptions={label:i.exception_tab,value:t.CONTENT_TABS.EXCEPTIONS,icon:{iconName:"attributes-cog",fontIconFamily:WUXManagedFontIcons.Font3DS}},r.showTreeView=!1,r.plmType="LibrarySection_AllExceptions",e.push(r),e},updateLayoutOnTabChange:function(e){t.CURRENT_TAB_VALUE=e,a.getWidgetRefresh()({reInitialize:!0})}})}),define("DS/ClassificationEditor/dataProvider/LibraryTreeDataProvider",["UWA/Class","UWA/Class/Promise","DS/ClassificationEditor/service/LibraryTypeService","DS/ClassificationEditor/utils/ClassificationEditorUtil","DS/ClassificationEditor/service/ClassificationEditorWebService","DS/ClassificationEditor/utils/ClassificationEditorDataConversion","DS/ClassificationEditor/commands/LibraryCommands","DS/WebappsUtils/WebappsUtils","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor","DS/IPClassifyUtil/IPClassifyUtility","DS/IPClassifyUtil/IPClassifyAlert"],function(e,t,i,a,r,n,o,s,l,d,c){"use strict";var u={FAVORITES:"ipcFavoriteList_v1",getFavorites:function(){return d.getTenantAwarePreferenceName(this.FAVORITES)}};return e.singleton({expandObject:function(e){return new t(function(t,i){r.libraries({pid:e.pid,mxid:e.mxid,children:e.children,isExpandAll:e.isExpandAll,isAuthoringMode:!d.isIndexedMode(),onComplete:function(i){i="string"==typeof i?JSON.parse(i):i,d.isIndexedMode()&&(i.results=d.convertExpandV2toV1(i.results));var a=n.getPathsAndObjectsFromExpand(i.results);if(null==a)t({paths:[],objects:[]});else if(a.paths&&a.paths.length<=0){var r=[];i.results&&(r=n.convertExpandToSearchFormat(e.pid,i.results));var o=[];for(var s in a.objects)a.objects.hasOwnProperty(s)&&s!==e.pid&&o.push(s);t({objects:function(e){var t=[];e&&e.length>0&&e.forEach(function(e){var i=n.convertToExaleadDataFormatFederated(e);"Standard"==i.grid["ds6w:classificationUsage"]?i.icons=[{iconName:"library-class"}]:i.icons=[{iconName:"library-class-filled"}],i.plmType="Library",t.push(i)});return t}(r),childIds:o,paths:a.paths})}else{for(var s in a.objects)a.objects.hasOwnProperty(s)&&("Standard"==a.objects[s].grid["ds6w:classificationUsage"]?a.objects[s].icons=[{iconName:"library-class"}]:a.objects[s].icons=[{iconName:"library-class-filled"}],a.objects[s].plmType="Library");t({paths:a.paths,objects:a.objects})}},onFailure:function(e){i(e)}})})},getRootSectionContents:function(e){return new t(function(e,t){r.roots({fetchAll:!0,isAuthoringMode:!d.isIndexedMode(),onComplete:function(t){var i=(t="string"==typeof t?JSON.parse(t):t).results?t.results:[],a=[],r=[];i.forEach(function(e){var t=n.convertToExaleadDataFormatFederated(e);"Standard"==t.grid["ds6w:classificationUsage"]?t.icons=[{iconName:"library-lined"}]:t.icons=[{iconName:"library"}],t.plmType="RootLibrary",r.push(t),a.push(t.physicalid)}),e({objects:r,ids:a,infos:t.infos})},onFailure:function(e){t(e)}})})},getObjectPathLength:function(e){return new t(function(t,i){r.getLibraryPathLength({ids:e.ids,onComplete:function(e){if(e.results){var a=n.getLibraryDepth(e);t(a)}else c.displayNotification({message:l.msg_error_BOdeleted,className:"error"}),i()},onFailure:function(e){that._logger.log("WebService getObjectPathLength Err : "+e),i(e)}})})},getObjectPath:function(e){return new t(function(t,i){r.getLibraryPath({depth:e.depth,pid:e.pid,isAuthoringMode:!d.isIndexedMode(),onComplete:function(i){var a=n.convertNavigateToFlatFormat(e.depth,i.result);t(a)},onFailure:function(e){that._logger.log("WebService getObjectPath Err : "+e),i(e)}})})},getPreferenceSectionContents:function(e){return new t(function(t,a){r.favourites({ids:e.ids,onComplete:function(e){for(var a=(e="string"==typeof e?JSON.parse(e):e).results?e.results:[],r=[],o=0;o<a.length;++o){var s=i.getPlmTypeFromContentDetails(a[o].attributes),l=n.convertToExaleadDataFormatFederated(a[o]);l.plmType=s,"RootLibrary"===l.plmType?"Standard"==l.grid["ds6w:classificationUsage"]?l.icons=[{iconName:"library-lined"}]:l.icons=[{iconName:"library"}]:"Standard"==l.grid["ds6w:classificationUsage"]?l.icons=[{iconName:"library-class"}]:l.icons=[{iconName:"library-class-filled"}],r.push(l)}t(r)},onFailure:function(e){a(e)}})})},comparator:function(e,t){var i,a="LibrarySection_favorite"===e.getParent().plmType;if(a)return null;if(e.isRoot()&&t.isRoot()||a)return null;if("date"!==widget.getValue("sortMode"))return e.options.label.localeCompare(t.options.label);try{i=new Date(e.options.created)>new Date(t.options.created)?1:new Date(e.options.created)<new Date(t.options.created)?-1:0}catch(a){i=e.options.created<t.options.created?-1:1}finally{return i}},shouldBeEditable:function(e){return a.shouldBeEditable(e)},getContextualMenu:function(e){return o.GetContextualMenu(e,"TREE")},onContentUpdate:function(e){return a.onNodeModelUpdate(e)},isValidType:function(e){return i.inFamilyLibrary(e)},isSection:function(e){return"LibrarySection_favorite"==e||"LibrarySection_AllLibraries"==e},isTreeNodeEditable:function(e){if(e&&e.nodeModel){var t=e.nodeModel.plmType;return!("LibrarySection_favorite"==t||"LibrarySection_AllLibraries"==t)}return!1},isPreferenceSection:function(e){return"LibrarySection_favorite"==e},getSectionsData:function(){var e=[],t={};t.label=l.name_Section_FavoriteLibraries,t.icon=s.getWebappsAssetUrl("ClassificationEditor","icons/libraryfavorites.png"),t.plmType="LibrarySection_favorite",e.push(t);var i={};return i.label=l.name_Section_AllLibraries,i.icon=s.getWebappsAssetUrl("ClassificationEditor","icons/librarysectionall.png"),i.plmType="LibrarySection_AllLibraries",i.defaultSelectedSection=!0,e.push(i),e},getPreferenceSectionName:function(){return u.getFavorites()},getSecurityContextAndData:function(){return a.getCurrentSecurityContextAndLibraryData()},getObjectNotVisiblemessage:function(){return l.msg_error_NoVisibleRootLibrary},isDNDSupported:function(){return!0},isRoot:function(e){return!(!e||!e.flattenedtaxonomies||"types/Libraries"!==e.flattenedtaxonomies[0]||"types/General Library"!==e.flattenedtaxonomies[1])}})}),define("DS/ClassificationEditor/commands/PLMNewClassCmd",["DS/UIKIT/Mask","DS/ENONewWidget/ENONew/Events","DS/ENONewWidget/command/NewContentCommandBase","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor","DS/ClassificationEditor/utils/Library_CSO","DS/ClassificationEditor/utils/ClassificationEditorcontrol"],function(e,t,i,a,r,n){"use strict";var o,s;return i.extend({defaults:{type:o},init:function(i,a){s="new_class",o="General Class",this.defaults.type=o,t.addEvent("onCreationDialogAction",function(t){if(t&&"ready"===t.action){var i=n.getContent().getView().getContent().getChildren()[1].getChildren()[0];e.unmask(i)}}),this._parent(i)},getType(){return this.defaults.type},execute:function(){var t=n.getContent().getView().getContent().getChildren()[1].getChildren()[0];e.mask(t),this.launchCreationDialog()},launchCreationDialog:function(){var e=this.getCreateOptions({});this.launchCreateNew(e)},getOptions:function(){var e,t=r.getCurrentLibrary()._options.usage;return e=r.getCurrentLibrary().getID(),{options:{typeName:o,parentPIDs:[e],attributes:{"Class Usage":t}},context:{serviceBaseUrl:this.options.serviceBaseUrl,tenant:this.options.tenant,header:{SecurityContext:this.options.securityContext},getENONewContext:function(){return{}}},events:this.options.callbacks,viewType:"listView",labelTopBar:a.get(s),activeTopBar:!0,silentMode:!1,type:o}}})}),define("DS/ClassificationEditor/commands/ActionBar_ClassCreationCmd",["DS/ApplicationFrame/Command","DS/ClassificationEditor/commands/PLMNewClassCmd","DS/IPClassifyUX/service/SettingsManagement","DS/PADUtils/PADSettingsMgt","DS/ApplicationFrame/CommandsManager","DS/ClassificationEditor/utils/ClassificationEditorcontrol","DS/ClassificationEditor/utils/Library_CSO","DS/IPClassifyUtil/IPClassifyAlert","DS/IPClassifyUX/utils/IPClassifyModeManager","DS/ClassificationEditor/service/ClassificationEditorWebService","DS/ClassificationEditor/utils/ClassificationEditorDataConversion","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor"],function(e,t,i,a,r,n,o,s,l,d,c,u){"use strict";return e.extend({isInsert:!0,init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!1})},beginExecute:function(){},execute:function(){var e=r.getCurrentCmdId(),f={fetchSecurityContext:function(){return a.getSetting("pad_security_ctx")},getWorkUnderHeaders:function(){return{}},getSelectedNodes:function(){return n.getContent().getView().getPADTreeDocument().getSelectedNodes()},getDocumentFromNodeModel:function(e){return e.options.data},getOrigin:function(){return{source:UWA.is(widget.data.appId)?widget.data.appId:widget.environment.data._data._x_appId,widgetId:widget.id,component:"toolbar"}},platformUrls:i.getPlatformURLs().platformurls},g={onSuccess:function(e){var t=[o.getCurrentLibrary()];d._performFetchQuery({ids:[e.result[0].identifier],dynamicAttrs:[],isAuthoringMode:!0,onComplete:function(i){var a=[],r="library-class";i.results&&i.results.length>0&&(i.results.forEach(function(e){a.push(c.convertToExaleadDataFormatFederated(e))}),a[0].usage&&"Definition"==a[0].usage&&(r="library-class-filled")),n.getTreeCont().addNewNode({physicalid:a[0].physicalid,label:a[0].label,plmType:"Library",type:a[0].type,mxid:a[0].mxid,parentid:o.getSelectedNodes()[0].getID(),icons:[{iconName:r}]}),l.setAuthoringMode("authoring","none"),UWA.is(n.getContent())&&n.getContent().loadContentAndSelect(t[0],e.result[0].identifier),s.displayNotification({message:u.replace(u.msg_info_classcreated,{classname:a[0].label}),className:"success"})},onFailure:function(){}})},onFailure:function(e){console.log("object creation failure")},onCancel:function(e){localStorage.setItem("PLMNewClassCmd"+(UWA.is(widget.data.appId)?widget.data.appId:widget.environment.data._data._x_appId),e.preferedType),console.log("object creation cancellled")}};new t({preferedType:localStorage.getItem("PLMNewClassCmd"+(UWA.is(widget.data.appId)?widget.data.appId:widget.environment.data._data._x_appId)),serviceBaseUrl:f.platformUrls["3DSpace"],tenant:f.platformUrls.platformId,securityContext:f.fetchSecurityContext(),callbacks:g},e).execute()},endExecute:function(){}})}),define("DS/ClassificationEditor/dataProvider/ClassAttributesDataProvider",["UWA/Class","UWA/Class/Promise","DS/ClassificationEditor/service/ClassificationEditorWebService","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor","DS/IPClassifyUtil/IPClassifyAlert","DS/WebappsUtils/WebappsUtils"],function(e,t,i,a,r,n){"use strict";return e.singleton({hasLibrarianRole:function(){return new t(function(e,t){i.hasLibrarianRole({onComplete:function(t){e({readOnly:JSON.parse(t).isAuthorized.readOnly})},onFailure:function(){t({readOnly:!0})}})})},fetchTheObjects:function(){return new t(function(e){i.fetchAllTheClassificationAttributes({onComplete:function(t){var i=JSON.parse(t).attribute||[],r=n.getWebappsAssetUrl("ClassificationEditor","icons/attributes.png"),o=[];i.forEach(function(e){var t="",i="",n="",s="string"==typeof s?JSON.parse(e.range):e.range;s&&s.length>0&&(s.forEach(function(e){if("between"==e.operator){var a=e.value.split(" ");t=a[0],i=a[2]}else n+=","+e.value}),n.length>0&&(n=n.substring(n.indexOf(",")+1))),o.push({label:e.name,icons:[r],grid:{attrName:e.name,attrTitle:e.nls_label,attrDesc:e.description,attrKind:e.nls_type,attrDefault:e.default,attrHasDefault:e.nls_hasDefault,attrDim:e.manipulationUnit&&e.manipulationUnit.length>0?e.nls_dimension+"("+e.manipulationUnit+")":e.nls_dimension,attrPredi:e.nls_predicate,attrAuthorizedValues:n,attrMinimum:t,attrMaximum:i,attrIsMultivalue:e.valuetype&&"multival"==e.valuetype?a.VALUE_TYPE_TRUE:a.VALUE_TYPE_FALSE,attrIsParametric:e.nls_isParametric,attrIsInDico:e.isInDico,attrSel:!1}})}),e({objectsList:o})},onFailure:function(t,i,n){var o=a.get("msg_classificationattributes_webservicefailed");i&&"User doesnt have Librarian Role"===i&&(o=o+": <br>"+a.error_no_LibrarianRole),r.displayNotification({message:o,className:"error"}),e({})}})})},fetchPlaceHolder:function(){return a.classAttributesPanel_Placeholder},initialSortModel:function(){return[{dataIndex:"attrTitle",sort:"asc"}]},searchMatchCriteria:function(e,t){var i=!1,a=new RegExp(e,"i");return(a.test(t.nodeModel.options.grid.attrTitle)||a.test(t.nodeModel.getLabel())||a.test(t.nodeModel.options.grid.attrKind)||a.test(t.nodeModel.options.grid.attrDim))&&(i=!0),i},fetchColumns:function(){return{checkBoxColumn:"attrSel",objectIdentifier:"attrName",columns:[{icon:{iconName:"check",fontIconFamily:1},dataIndex:"attrSel",pinned:"left",typeRepresentation:"boolean",alwaysVisibleFlag:!0,width:40,resizableFlag:!1,editableFlag:!0,editionPolicy:"EditionInPlace",getCellEditableState:function(e){return e.nodeModel,!0}},{dataIndex:"tree",text:a.column_ActualName||"Name",tooltip:a.column_ActualName||"Actual Name"},{dataIndex:"attrTitle",text:a.column_DisplayName||"Display Name",tooltip:a.column_DisplayName||"Display Name",editableFlag:!1,sortableFlag:!0,resizableFlag:!0},{dataIndex:"attrKind",text:a.column_Type||"Type",tooltip:a.column_Type||"Type",editableFlag:!1,sortableFlag:!0,resizableFlag:!0},{dataIndex:"attrDesc",text:a.column_Description||"Description",tooltip:a.column_Description||"Description",editableFlag:!1,sortableFlag:!0,resizableFlag:!0},{dataIndex:"attrDefault",text:a.column_DefaultValue||"Default Value",tooltip:a.column_DefaultValue||"Default Value",editableFlag:!1,sortableFlag:!0,resizableFlag:!0},{dataIndex:"attrHasDefault",text:a.hasDefault||"Has Default",tooltip:a.hasDefault||"Has Default",editableFlag:!1,sortableFlag:!0,resizableFlag:!0},{dataIndex:"attrDim",text:a.column_Dimensions||"Dimension",tooltip:a.column_Dimensions||"Dimension",editableFlag:!1,sortableFlag:!0,resizableFlag:!0},{dataIndex:"attrPredi",text:a.column_Predicates||"Predicate",tooltip:a.column_Predicates||"Predicate",editableFlag:!1,sortableFlag:!0,resizableFlag:!1},{dataIndex:"attrAuthorizedValues",text:a.column_Authorized_Values||"Authorized Values",tooltip:a.column_Authorized_Values||"Authorized Values",editableFlag:!1,sortableFlag:!0,resizableFlag:!0},{dataIndex:"attrIsParametric",text:a.column_Is_Parametric||"Is Parametric",tooltip:a.column_Is_Parametric||"Is Parametric",editableFlag:!1,sortableFlag:!0,resizableFlag:!0},{dataIndex:"attrIsMultivalue",text:a.column_Is_Multivalue||"Is Multivalue",tooltip:a.column_Is_Multivalue||"Is Multivalue",editableFlag:!1,sortableFlag:!0,resizableFlag:!0},{dataIndex:"attrMinimum",text:a.column_Minimum||"Minimum",tooltip:a.column_Minimum||"Minimum",editableFlag:!1,sortableFlag:!0,resizableFlag:!0},{dataIndex:"attrMaximum",text:a.column_Maximum||"Maximum",tooltip:a.column_Maximum||"Maximum",editableFlag:!1,sortableFlag:!0,resizableFlag:!0},{dataIndex:"attrIsInDico",text:a.existInDictionary,tooltip:a.existInDictionary,editableFlag:!1,sortableFlag:!1,resizableFlag:!0}]}}})}),define("DS/ClassificationEditor/commands/ActionBar_AddExistingAttributesCmd",["UWA/Core","DS/ApplicationFrame/Command","DS/ClassificationEditor/service/ClassificationEditorWebService","DS/IPClassifyUtil/IPClassifyAlert","DS/ClassificationEditor/utils/ClassificationEditorcontrol","DS/ClassificationEditor/dataProvider/ClassAttributesDataProvider","DS/ClassificationEditor/commands/LibraryCommands","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor","DS/IPClassificationAttributes/CreateNewAttributes"],function(e,t,i,a,r,n,o,s,l){"use strict";var d=!1;return t.extend({labelTopBar:e.i18n("Add Existing Classification Attributes"),init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!1}),this.attributesPanel=null,n.hasLibrarianRole().then(function(e){e="string"==typeof e?JSON.parse(e):e,d=e.readOnly}).catch(e=>console.log(e.message))},beginExecute:function(){},execute:function(){var e=this;require(["DS/PADServices/utils/GlobalModelEvents","DS/PADUtils/PADContext","DS/IPClassifyUXUtil/ObjectsSelectionPanel","DS/ClassificationEditor/utils/Library_CSO","DS/ClassificationEditor/utils/ClassificationEditorcontrol"],function(t,c,u,f,g){var p,m,C=c.get(),b="No Class Selected";f.getCurrentLibrary()&&(m=f.getCurrentLibrary(),p=m.getID(),b=m.getLabel());var y=[];try{y=g.getContent()._libraryContentView.getPADTreeDocument().getRoots()}catch(e){}var h={};y.forEach(function(e){h[e.options.grid.Name]=!0});var v=[],_=f.getCurrentLibrary().getID();v.push(_),i.checkModifyAccessOnItems({objectIds:v,onComplete:function(c){if((c?JSON.parse(c):void 0).unModifiableIds.length>0)o._commonError("AddExistingAttributes",s.command_addExistingAttribute+": ",s.error_noChangeAccessOnCA);else if(C.options.views?C.options.views.datagridview:void 0){var f=t.getModelEvents();e.attributesPanel=new u({panelHeader:s.command_addExistingAttribute+" - "+b,okButtonLabel:s.classAttributesPanel_okButtonLabel,cancelButtonLabel:s.classAttributesPanel_cancelButtonLabel,okEventName:"AddExistingClassificationAttributes/selectedAttributes",cancelOrCloseEventName:"AddExistingAttributesCmd/Views/showInWidgetBody",modelEvents:f,objectsToSkip:h,dataProvider:n,newAttributeUI:l,isReadOnly:d});var g=[];g.push(f.subscribe({event:"AddExistingClassificationAttributes/selectedAttributes"},function(t){o._startProgressBar(s.command_addExistingAttribute),e.disable(),i.addClassAttributes({pid:p,attributes:t.selectedObjects,onComplete:function(i){var n=i?JSON.parse(i):void 0;if(n&&n.error){var l=n.error;a.displayNotification({message:s.msg_addclassificationattributes_failed+l,className:"error"})}else a.displayNotification({message:s.replace(s.msg_addclassificationattributes_success,{number:t.selectedObjects.length,libraryname:b}),className:"success"}),r.getContent().loadContentAndSelect(m);o._offProgressBar(),e.enable()},onFailure:function(t,i,a){var r=o.extractMyErrorMessage(t,i,a);o._offProgressBar(),e.enable(),o._commonError("AddExistingAttributes",s.msg_addclassificationattributes_failed,r)}}),g.forEach(function(e){f.unsubscribe(e)})})),g.push(f.subscribe({event:"AddExistingAttributesCmd/Views/showInWidgetBody"},function(e){!0===e.restore&&g.forEach(function(e){f.unsubscribe(e)})}))}},onFailure:function(e){o._commonError("AddExistingAttributes",s.command_addExistingAttribute+": ",s.error_noChangeAccessOnCA)}})})},endExecute:function(){}})}),define("DS/ClassificationEditor/dataProvider/LibraryDnDServiceProvider",["UWA/Class","DS/IPClassifyUtil/IPClassifyAlert","DS/ClassificationEditor/commands/LibraryCommands","DS/ClassificationEditor/service/LibraryServices","DS/ClassificationEditor/utils/ClassificationEditorcontrol","DS/ClassificationEditor/utils/Library_CSO","DS/ClassificationEditor/service/LibraryTypeService","DS/IPClassifyUtil/IPClassifyUtility","DS/IPClassifyUX/utils/IPClassifyModeManager","DS/IPClassifyUXUtil/IPClassifyConfirmation","DS/IPClassifyUXUtil/IPClassifyConfirmationWthCheckBx","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor"],function(e,t,i,a,r,n,o,s,l,d,c,u){"use strict";return e.singleton({shouldAcceptDrag:function(){var e=!0,t=n.getSelectedNodes();if(1==t.length){for(var i=0;i<t.length;++i)if("Library"!==t[i].plmType){e=!1;break}}else e=!1;return e},shouldAcceptDrop:function(e){var t=!1;return e||(e=n.getCurrentLibrary()),"LibrarySection_AllLibraries"===e.plmType&&"LibrarySection_Favorites"===e.plmType||!o.inFamilyLibrary(e.plmType)||(t=!0),t},addContentInObject:function(e,i,a,r){t.displayNotification({message:u.msg_warning_dndnotsupported,className:"warning"})},addClassesInLibrary:function(e,s,f,g,p){if(e&&e.plmType&&o.inFamilyLibrary(e.plmType)&&f){var m=f;if(m.length<1)return void console.warn("  Error in LibraryDnDServiceProvider.addClassesInLibrary, lContentId list is empty");if(e.id===s)return i._offProgressBar(),void t.displayNotification({message:u.msg_error_MoveInSamelibrary,className:"error"});for(var C=0;C<m.length;C++){var b=m[C];if(e.id===b)return i._offProgressBar(),void t.displayNotification({message:u.msg_error_MoveInSamelibrary,className:"error"})}var y=p,h=n.getCurrentLibrary();if("LibrarySection_favorite"===h.getType())return i._offProgressBar(),void t.displayNotification({message:u.msg_warning_dndnotsupported,className:"warning"});h.getID()===f[0]&&(h=h.getParent());var v=n.getSelectedNodes(),_=e&&o.inFamilyLibrary(e.plmType)?e:null;function S(e,r,n){a.MoveClass({IDs:e,targetLibrary:r,carryOverAttributeGroups:n,callbacks:{onComplete:function(e){D(e)},onFailure:function(e,a,r){i._offProgressBar();var n=i.extractMyErrorMessage(e,a,r);t.displayNotification({message:n?u.msg_error_moveClass+"<br>"+n:u.msg_error_moveClass,className:"error"})}}})}function D(e){i._offProgressBar();var t=u.replace(u.msg_info_classesmoved,{number:L,libraryname:_._options.label});1===I&&(t=u.replace(u.msg_info_classmoved,{classmovedname:v[0]._options.label,libraryname:_._options.label})),l.setAuthoringMode("authoring",t),r.getContent().loadContentAndSelect(h),h.isExpanded()&&(r.getTreeCont().performOperationOnNode(h,"collapse"),r.getTreeCont().performOperationOnNode(h,"expand")),y?(_=r.getTreeCont()._getNodesById(_.id)[0]).isExpanded()&&(r.getTreeCont().performOperationOnNode(_,"collapse"),r.getTreeCont().performOperationOnNode(_,"expand")):_.isExpanded()&&(r.getTreeCont().performOperationOnNode(_,"collapse"),r.getTreeCont().performOperationOnNode(_,"expand"))}if(_||(_=n.getCurrentLibrary()),!v)return;var E=[],A=[],P=[],T=[],I=v.length;I>0?v.forEach(function(e){E.push(UWA.is(e.id)?e.id:e.options.resourceid),o.isLibrary(e.plmType)?(A.push(UWA.is(e.id)?e.id:e.options.resourceid),P.push(e)):o.isRootLibrary(e.plmType)?"RootLibrary"===e.plmType&&A.push(UWA.is(e.id)?e.id:e.options.resourceid):T.push(UWA.is(e.id)?e.id:e.options.resourceid)}):(E.push(v),"Library"==node.plmType?(A.push(v.id),P.push(v)):o.isRootLibrary(node.plmType)||T.push(v.id));var L=A.length;_?A.length>0&&(void 0!==_._options.usage&&h._options.usage!==(_._options.usage?_._options.usage:_._options.classUsage)?(i._offProgressBar(),t.displayNotification({title:u.msg_error_MoveInLibraryErrorTitle,subtitle:u.msg_error_MoveInLibraryErrorSubTitle,message:u.msg_error_MoveInLibraryErrorMessage,className:"error"})):!function(e,t,i,a){if(i.id!=t.id){if("MOVE_CLASS"===e&&!o.isRootLibrary(t.plmType)&&UWA.is(a,"array")&&1===a.length&&a[0]===t){var r=t.getParent();if(r&&r.id===i.id)return!1}return!0}}("MOVE_CLASS",h,_,v)?(i._offProgressBar(),t.displayNotification({message:u.msg_error_MoveInSamelibrary,className:"error"})):"RootLibrary"===h.plmType?d.launch({title:u.confirmation_move_title+" - "+v[0].getLabel(),content:u.replace(u.confirmation_move_message,{parentlibrary:_.getLabel()}),confirmLabel:u.confirmMoveYes,cancelLabel:u.confirmMoveNo},function(){i._startProgressBar(u.Move_Class_loading),S(A,_,!1)},null,function(){i._offProgressBar()}):"Library"===h.plmType&&a.MoveClass({IDs:A,targetLibrary:_,carryOverAttributeGroups:"",callbacks:{onComplete:function(e){JSON.parse(e).hasInheritedAttributes?c.launch({title:u.confirmation_move_title+" "+v[0].getLabel(),confirmLabel:u.confirmMoveYes,cancelLabel:u.confirmMoveNo,mainDivContent:{divHeaderShow:u._class+v[0].getLabel()+u.moveClassAttributesLostMsg_Part1+h.getLabel(),divFooterHide:u.moveClassAttributesLostMsg_Part2+JSON.parse(e).noOfClassifiedItemsAffected+u.moveClassAttributesLostMsg_Part3,checkBoxParams:{label:u.includeInheritedAttributes}}},function(){i._startProgressBar(u.Move_Class_loading),c.getChkBoxCheckedFlag()?S(A,_,!0):S(A,_,!1)},null,function(){i._offProgressBar()}):d.launch({title:u.confirmation_move_title+" "+v[0].getLabel(),content:u.replace(u.confirmation_move_message,{parentlibrary:_.getLabel()}),confirmLabel:u.confirmMoveYes,cancelLabel:u.confirmMoveNo},function(){i._startProgressBar(u.Move_Class_loading),S(A,_,!1)},null,function(){i._offProgressBar()})},onFailure:function(e,a,r){i._offProgressBar();var n=i.extractMyErrorMessage(e,a,r);t.displayNotification({message:n?u.msg_error_moveClass+"<br>"+n:u.msg_error_moveClass,className:"error"})}}})):(i._offProgressBar(),t.displayNotification({message:u.msg_warning_nocurrentlibrary,className:"warning"}))}},getDroppedData:function(e){var t=[],i=[],a=[];if(e&&e.data&&e.data.items&&Array.isArray(e.data.items)){for(var r=0;r<e.data.items.length;r++){var n=e.data.items[r],s=n.objectId,l=n.objectType_Internal;if(l||(l=n.objectType),Array.isArray(l)){for(var d=l.length,c=d>0?l[d-1]:void 0,u=0;u<d;++u)if(o.inFamilyLibrary(l[u])){c=l[u];break}l=c}var f=n.displayName;f||(f=l),f||(f=s);var g={droppedItem_id:s,droppedItem_type:l,droppedItem_name:f,droppedSourceLibrary_id:n.libraryId,droppedItem_tenantId:n.envId};o.isRootLibrary(l)?t.push(g):o.isLibrary(l)?i.push(g):a.push(g)}var p={};return p.RootLibrary_itemList=t,p.Library_itemList=i,p.Content_itemList=a,p}},inFamilyLibrary:function(e){return o.inFamilyLibrary(e)}})}),define("DS/ClassificationEditor/commands/ClassificationIconBar_MoveClass",["UWA/Core","DS/ApplicationFrame/Command","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor","DS/LibraryActive/LibraryActive","DS/ClassificationEditor/utils/Library_CSO","DS/ClassificationEditor/dataProvider/LibraryDnDServiceProvider"],function(e,t,i,a,r,n){"use strict";return t.extend({labelTopBar:i.moveClass_ActiveClassify_LabelTopbar,isInsert:!0,datas:{},init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!1})},beginExecute:function(){},execute:function(){this.popover?(this.popover.nestedMenuInContext.popover.title=i.confirmation_move_title+" - "+r.getSelectedNodes()[0].getLabel(),this.popover.showPopover()):(this.popover=new a({container:document.body.querySelector('[data-command="ActionBar_ActiveClassificationCmd"]'),topBarLabel:i.confirmation_move_title+" - "+r.getSelectedNodes()[0].getLabel(),selectBtnLabel:i.confirmMoveYes,isChooserPanel:!0,panelIcon:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-move-to",couldBeValid:function(e){e&&e.getID&&e.getID();if(e&&e.getType){if(e.getType())return"General Class"===e.getType()||"General Library"===e.getType();if("General Class"===e.plmType||"General Library"===e.plmType)return!0}return!1},isMaturityFilterDisabled:!0}),this.popover.addEvent("onSetActive",function(e){var t=e,i=r.getCurrentLibrary().getID(),a=[r.getSelectedNodes()[0].getID()];n.addClassesInLibrary(t,i,a,!1,!0),require("DS/ClassificationEditor/commands/LibraryCommands")._offProgressBar()}))},endExecute:function(){}})}),define("DS/ClassificationEditor/commands/PLMNewLibraryCmd",["DS/UIKIT/Mask","DS/ENONewWidget/ENONew/Events","DS/ENONewWidget/command/NewContentCommandBase","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor","DS/ClassificationEditor/utils/ClassificationEditorcontrol"],function(e,t,i,a,r){"use strict";var n,o,s;return i.extend({defaults:{type:n},init:function(i,a){n="General Library","CreateNewDefinitionLibrary"===a?(o="new_definition_library",s="Definition"):(o="new_standard_library",s="Standard"),this.defaults.type=n,t.addEvent("onCreationDialogAction",function(t){if(t&&"ready"===t.action){var i=r.getContent().getView().getContent().getChildren()[1].getChildren()[0];e.unmask(i)}}),this._parent(i)},getType(){return this.defaults.type},execute:function(){var t=r.getContent().getView().getContent().getChildren()[1].getChildren()[0];e.mask(t),this.launchCreationDialog()},launchCreationDialog:function(){var e=this.getCreateOptions({});this.launchCreateNew(e)},getOptions:function(){return{options:{typeName:n,attributes:{"Library Usage":s}},context:{serviceBaseUrl:this.options.serviceBaseUrl,tenant:this.options.tenant,header:{SecurityContext:this.options.securityContext},getENONewContext:function(){return{}}},events:this.options.callbacks,viewType:"listView",labelTopBar:a.get(o),activeTopBar:!0,silentMode:!1,type:n}}})}),define("DS/ClassificationEditor/commands/ActionBar_LibraryCreationCmd",["DS/ApplicationFrame/Command","DS/ClassificationEditor/commands/PLMNewLibraryCmd","DS/IPClassifyUX/service/SettingsManagement","DS/PADUtils/PADSettingsMgt","DS/ApplicationFrame/CommandsManager","DS/IPClassifyUX/utils/IPClassifyModeManager","DS/ClassificationEditor/utils/ClassificationEditorcontrol","DS/ClassificationEditor/utils/Library_CSO","DS/IPClassifyUtil/IPClassifyAlert","DS/ClassificationEditor/service/ClassificationEditorWebService","DS/ClassificationEditor/utils/ClassificationEditorDataConversion","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor"],function(e,t,i,a,r,n,o,s,l,d,c,u){"use strict";return e.extend({isInsert:!0,init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!1})},beginExecute:function(){},execute:function(){var e=r.getCurrentCmdId(),f={fetchSecurityContext:function(){return a.getSetting("pad_security_ctx")},getWorkUnderHeaders:function(){return{}},getSelectedNodes:function(){return o.getContent().getView().getPADTreeDocument().getSelectedNodes()},getDocumentFromNodeModel:function(e){return e.options.data},getOrigin:function(){return{source:UWA.is(widget.data.appId)?widget.data.appId:widget.environment.data._data._x_appId,widgetId:widget.id,component:"toolbar"}},platformUrls:i.getPlatformURLs().platformurls},g={onSuccess:function(e){var t=[s.getCurrentLibrary()];d._performFetchQuery({ids:[e.result[0].identifier],dynamicAttrs:[],isAuthoringMode:!0,onComplete:function(i){var a=[];i.results&&i.results.length>0&&i.results.forEach(function(e){a.push(c.convertToExaleadDataFormatFederated(e))}),o.getTreeCont().addNewNode({physicalid:a[0].physicalid,label:a[0].label,usage:a[0].usage,plmType:"RootLibrary",type:a[0].type,mxid:a[0].mxid,icons:[{iconName:"library"}]}),n.setAuthoringMode("authoring","none"),UWA.is(o.getContent())&&o.getContent().loadContentAndSelect(t[0],e.result[0].identifier,!1,!1,!0),l.displayNotification({message:u.replace(u.msg_info_librarycreated,{libraryname:a[0].label}),className:"success"})},onFailure:function(){}})},onFailure:function(e){console.log("object creation failure")},onCancel:function(e){localStorage.setItem("PLMNewLibraryCmd"+(UWA.is(widget.data.appId)?widget.data.appId:widget.environment.data._data._x_appId),e.preferedType),console.log("object creation cancellled")}};new t({preferedType:localStorage.getItem("PLMNewLibraryCmd"+(UWA.is(widget.data.appId)?widget.data.appId:widget.environment.data._data._x_appId)),serviceBaseUrl:f.platformUrls["3DSpace"],tenant:f.platformUrls.platformId,securityContext:f.fetchSecurityContext(),callbacks:g},e).execute()},endExecute:function(){}})});