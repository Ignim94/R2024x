define("DS/ENOXComponentQualification/helpers/EngineeringHelper",["DS/ENOXSourcingUXInfra/service/ENOXSourcingPlatformServices","DS/ENOXSourcingUXInfra/PropertiesView/EditPropertiesWidgetWrapper","DS/ENOXSourcingUXInfra/CommonUtils/CommonUtils","DS/TreeModel/TreeNodeModel","DS/ENOXSourcingUXInfra/Constants/ENOXSourcingConstants","WebappsUtils/WebappsUtils","DS/ENOXSourcingUXInfra/Utilities/HyperLinkHelper","DS/UIKIT/SuperModal"],function(e,t,i,n,o,a,r,l){"use strict";var s=function(e){this.controller=e,this.NLS=this.controller.app.i18NProvider};return s.prototype.processData=function(e,t,n){var o=this;return new Promise(a=>{o.formatSearchData(e,n).then(e=>{e.map(function(e){t.map(function(n,a){if(n.pid===e.pid){var r=[{label:o.NLS.title,data:e.title},{label:o.NLS.type,data:e.typeUI},{label:o.NLS.revision,data:e.revision},{label:o.NLS.maturity_state,data:e.maturityStatus},{label:o.NLS.owner,data:e.responsible},{label:o.NLS.modified,data:i.getDateStringForDisplay(e.modificationDate)},{label:o.NLS.name,data:e.objName}],l=e.typeUI+" | "+e.revision+" | "+e.maturityStatus+" | "+e.responsible+" | "+e.modificationDate+" | "+e.objName,s={grid:e,label:e.title,subLabel:l,description:e.objName,thumbnail:require.toUrl(e.image),tooltip:r,id:e.pid};t[a]=Object.assign(n,s)}})}),t=t.filter(e=>e.hasOwnProperty("grid")),a(t)})})},s.prototype.formatSearchData=function(e,t){return new Promise(n=>{var o=[];if(e.results){var a={"ds6w:status":[],"ds6w:type":[]};e.results.map(function(e){var t={};e.attributes.forEach(e=>{t[e.name]=e.value}),a["ds6w:status"].push(t["ds6w:what/ds6w:status"]?t["ds6w:what/ds6w:status"]:t["ds6w:status"]),a["ds6w:type"].push(t["ds6w:what/ds6w:type"]?t["ds6w:what/ds6w:type"]:t["ds6w:type"]);var n={pid:t.physicalid?t.physicalid:t.resourceid,title:t["ds6w:label"],creationDate:i.getDateStringForDisplay(t["ds6w:when/ds6w:created"]?t["ds6w:when/ds6w:created"]:t["ds6w:created"]),modificationDate:i.getDateStringForDisplay(t["ds6w:when/ds6w:modified"]?t["ds6w:when/ds6w:modified"]:t["ds6w:modified"]),maturityStatus:t["ds6w:what/ds6w:status"]?t["ds6w:what/ds6w:status"]:t["ds6w:status"],image:t.preview_url?t.preview_url:"ENOXSourcingUXInfra/assets/icons/I_VPMNavProduct108x144.png",icon:t.type_icon_url?t.type_icon_url:"ENOXComponentQualification/assets/icons/16/I_VPMNavProduct16.png",responsible:t["ds6w:who/ds6w:responsible"]?t["ds6w:who/ds6w:responsible"]:t["ds6w:responsible"],revision:t["ds6wg:revision"],type:t["ds6w:what/ds6w:type"]?t["ds6w:what/ds6w:type"]:t["ds6w:type"],actualType:t["ds6w:what/ds6w:type"]?t["ds6w:what/ds6w:type"]:t["ds6w:type"],objName:t.name?t.name:t["ds6w:identifier"],id:t.physicalid?t.physicalid:t.resourceid,tree:t["ds6w:label"],project:t["ds6w:where/ds6w:context/ds6w:project"]?t["ds6w:where/ds6w:context/ds6w:project"]:t["ds6w:project"],organization:t["ds6w:who/ds6w:responsible/ds6w:organizationResponsible"]?t["ds6w:who/ds6w:responsible/ds6w:organizationResponsible"]:t["ds6w:organizationResponsible"],partNumber:t["ds6wg:EnterpriseExtension.V_PartNumber"]?t["ds6wg:EnterpriseExtension.V_PartNumber"]:""};o.push(n)}),a["ds6w:status"]=[...new Set(a["ds6w:status"])],a["ds6w:type"]=[...new Set(a["ds6w:type"])],t.searchUtil.getNlsOfPropertiesValues(a).then(function(e){o.forEach(t=>{t.typeUI=e["ds6w:type"][t.type]?e["ds6w:type"][t.type]:t.type,t.maturityStatus=e["ds6w:status"][t.maturityStatus]?e["ds6w:status"][t.maturityStatus]:t.maturityStatus})}).finally(function(){n(o)})}else n(o)})},s.prototype.getEngSearchPayload=function(t,i){var n=t.map(e=>e.pid);n=n.filter(e=>void 0!==e);var a="";return i&&(i.map(function(e){a+=' flattenedtaxonomies:"types/'+e+'"'+o.OR}),a=a.substring(0,a.length-3).trim()),{nresults:n.length>1e3?999:n.length,label:"test",locale:widget.lang,select_predicate:["ds6w:label","physicalid","name","ds6w:identifier","ds6w:created","ds6w:modified","ds6w:responsible","ds6w:responsibleUid","ds6w:project","ds6w:dataSource","ds6w:community","ds6wg:EnterpriseExtension.V_PartNumber","bo.ManufacturerEquivalentItemExtension.ManufacturerName","ds6wg:ManufacturerEquivalentItemExtension.ManufacturerPartNumber","ds6wg:revision","ds6w:what/ds6w:status","ds6w:status","partnumber","ds6w:type","organization","ds6w:organizationResponsible"],select_file:["icon","thumbnail_2d"],query:a,source:["3dspace"],tenant:e.getPlatformId(),resourceid_in:n}},s.prototype.renderPropertiesView=function(e){let i={container:e.controller.app._triptychWrapper.getRightPanelContainer(),facets:["FACET_PROPERTIES","FACET_SWYMCOMMENTS","FACET_RELATIONS"]},n={objectId:e.id},o=new t({viewOptions:i,dataOptions:n}).render;e.controller.app._applicationChannel.publish({event:"xsourcing-collectionview-selected-object-id",data:{selectedObject:!0,openDetails:o}})},s.prototype.processDetailsData=function(e,t,i,n,a){let r=this,l=[],s=t.filter(e=>e["ds6w:globalType"]===o.TYPE_DS6W_PART),c=r.sourceProcessor(i);return new Promise(t=>{let i={"ds6w:status":[],"ds6w:type":[]},d=s.filter(t=>t.resourceid===e);d[0].thumbnail_2d=a[0].preview_url,d[0].type_icon_url=a[0].type_icon_url;let u=n.filter(t=>Object.keys(t)[0]===e)[0][e],p=r.structureDataForTNM(d[0],u,!0),m={grid:p,label:d[0]["ds6w:label"]};if(i["ds6w:status"].push(p.maturityStatus),i["ds6w:type"].push(p.type),l.push(m),m.grid.children)if(c.length>0)l[0].grid.children.push(r.getDummySourceNodeData()),l[0].grid.children[0].children.push(...c);else if(u!==o.PROCUREMENT_INTENT_BUY){s.filter(t=>t.resourceid!==e).forEach(e=>{let t=r.structureDataForTNM(e,n.filter(t=>Object.keys(t)[0]===e.resourceid)[0][e.resourceid],!1);i["ds6w:status"].push(t.maturityStatus),i["ds6w:type"].push(t.type),l[0].grid.children.push(t)})}i["ds6w:status"]=[...new Set(i["ds6w:status"])],i["ds6w:type"]=[...new Set(i["ds6w:type"])],r.controller.searchUtil.getNlsOfPropertiesValues(i).then(function(e){l[0].grid.maturityStatusDisplay=e["ds6w:status"][l[0].grid.maturityStatus]?e["ds6w:status"][l[0].grid.maturityStatus]:l[0].grid.maturityStatus,l[0].grid.typeDisplay=e["ds6w:type"][l[0].grid.type]?e["ds6w:type"][l[0].grid.type]:l[0].grid.type,l[0].grid.children&&l[0].grid.children.forEach(t=>{t.type!==r.getDummySourceNodeType()?(t.maturityStatusDisplay=e["ds6w:status"][t.maturityStatus]?e["ds6w:status"][t.maturityStatus]:t.maturityStatus,t.typeDisplay=e["ds6w:type"][t.type]?e["ds6w:type"][t.type]:t.type):t.children.forEach(t=>{t.maturityStatusDisplay=e["ds6w:status"][t.maturityStatusDisplay]?e["ds6w:status"][t.maturityStatusDisplay]:t.maturityStatusDisplay})})}).finally(function(){t(l)})})},s.prototype.getDummySourceNodeType=function(){return"dummySourceNode"},s.prototype.getDummySourceNodeData=function(){return{title:this.NLS.sources,type:this.getDummySourceNodeType(),actualType:this.getDummySourceNodeType(),children:[]}},s.prototype.handleNewEQPostProcess=function(e,t){let i=this;if(e.isExpanded()&&!e.hasChildren())e.collapse(),e.expandAll();else if(e.hasChildren()||null===e.getChildren()){t.forEach(t=>{let o=i.sourceProcessor(t);if(null!==e.getChildren()&&1===e.getChildren().filter(e=>e.getAttributeValue("type")===i.getDummySourceNodeType()).length){e.getChildren().filter(e=>e.getAttributeValue("type")===i.getDummySourceNodeType())[0].addChild(new n({label:o[0].title,grid:{...o[0]}}))}else{let t=i.getDummySourceNodeData();e.addChild(new n({label:t.title,grid:{...t}})),e.getChildren().filter(e=>e.getAttributeValue("type")===i.getDummySourceNodeType())[0].addChild(new n({label:o[0].title,grid:{...o[0]}}))}});let o=e.getChildren().filter(e=>e.getAttributeValue("type")===i.getDummySourceNodeType());e.isExpanded()?0===e.getVisibleChildren()&&(e.collapse(),e.expand()):e.expand(),o[0].isExpanded()||o[0].expand()}else e.expandAll();t.forEach(e=>{widget.notificationUtil.showSuccess(i.NLS.qualification+' "'+e.data[0].dataelements.name+'" '+i.NLS.created_successfully)})},s.prototype.simplifyExpandItems=function(e){var t=[];return e.results&&e.results.map(function(e){let i={};e.attributes&&(e.attributes.map(e=>{i[e.name]=e.value}),t.push(i))}),t},s.prototype.sourceProcessor=function(e){let t=this;return e.data.map(e=>{let i=e.relateddata.target[0],n=[],a="";if(e.relateddata["context-restrictions"]&&e.relateddata["context-restrictions"].length>=0){a=e.relateddata["context-restrictions"].length;for(let t=0;t<a;t++)n.push(e.relateddata["context-restrictions"][t])}return{id:i.id,isMEI:i.dataelements.type===o.VPMREFERENCE,isManufacturingItem:!(i.dataelements.type===o.VPMREFERENCE),title:i.dataelements.Title?i.dataelements.Title:i.dataelements.Proxy_Title,revision:i.dataelements.Revision,manufacturer:i.dataelements["Manufacturer Name"],maturityStatusDisplay:i.dataelements.type===o.TYPE_VENDOR_ITEM?t.NLS[i.dataelements.Proxy_State]:i.dataelements.Proxy_State,partNumber:i.dataelements["Part Number"],actualType:i.dataelements.type,eqId:e.id,eqType:e.type,eqModifyAccess:e.dataelements.modifyAccess,eqName:e.dataelements.name+" ("+e.dataelements.revision+")",eqMaturityStatus:e.dataelements.state,eqMaturityStatusDisplay:e.dataelements.stateDisplay,eqPrefered:e.dataelements["SRC Preferred"],eqPreferredDisplay:e.dataelements["SRC Preferred"]===o.FALSE?t.NLS.no:t.NLS.yes,eqApproved:e.dataelements["SRC Approved"],eqComments:e.dataelements["SRC Comments"],eqContextRestrictions:a,eqProof:e.dataelements.isProofExists,eqContextRestriction:n,eqTitle:e.dataelements.title,gqId:i.dataelements.genQualificationId?i.dataelements.genQualificationId:void 0,gqType:o.TYPE_QUALIFICATION_LIST[0],gqName:i.dataelements.genQualificationName?i.dataelements.genQualificationName+" ("+i.dataelements.genQualificationRevision+")":"",gqMaturityStatus:i.dataelements.state?i.dataelements.state:void 0,gqMaturityStatusDisplay:i.dataelements.stateDisplay?i.dataelements.stateDisplay:void 0,gqApproved:i.dataelements.genQualificationApproved?i.dataelements.genQualificationApproved:"",gqModifyAccess:i.dataelements.genQualificationModifyAccess,gqProof:i.dataelements.isProofExists,gqContextRestrictions:i.dataelements.genQualificationId&&i.dataelements["context-restriction"]?Number(i.dataelements["context-restriction"]):"",gqTitle:i.dataelements.genQualificationTitle}})},s.prototype.contextProcessor=function(e){let t=this;return new Promise(i=>{t.controller.qualificationController.helper.processRelatedQualifications(e).then(function(e){let t=e.map(e=>{return{grid:{id:e.id,modifyAccess:e.grid.modifyAccess,maturityStatus:e.grid.qualificationMaturity,maturityStatusDisplay:e.grid.qualificationMaturityDisplay,preferred:e.grid.preferred,approved:e.grid.approved,comments:e.grid.comments,actualType:e.grid.actualType,contextName:e.grid.enterpriseItem,contextType:e.grid.contextTypeActual,contextTypeDisplay:e.grid.contextType,contextId:e.grid.eng_id,contextSource:e.grid.contextTypeSource?e.grid.contextTypeSource:o.SOURCE_3DSPACE},label:e.grid.name+" ("+e.grid.revision+")"}});i(t)}).catch(function(){widget.notificationUtil.showError(t.NLS.loading_ctx_qualifications_failed)})})},s.prototype.structureDataForTNM=function(e,t,i){return{isEngineeringItem:!0,id:e.resourceid,creationDate:this.controller.commonUtils.getDateStringForDisplay(e["ds6w:created"]),modificationDate:this.controller.commonUtils.getDateStringForDisplay(e["ds6w:modified"]),maturityStatus:e.current,image:e.thumbnail_2d,icon:e.type_icon_url?e.type_icon_url:"ENOXComponentQualification/assets/icons/16/I_VPMNavProduct16.png",responsible:e["ds6w:responsible"],revision:e.revision,type:e["ds6w:type"],actualType:e["ds6w:type"],isRoot:i,title:e["ds6w:label"],partNumber:e["ds6wg:EnterpriseExtension.V_PartNumber"],procurementIntentDisplay:this.NLS[t],procurementIntent:t,children:[]}},s.prototype.getProcurementIntents=function(e,t){return t.map(t=>{if(0===e.result.length)return{[t]:o.PROCUREMENT_INTENT_NONE};let i=e.result.filter(e=>e.input_object&&e.input_object.physicalid===t);if(0===i.length||i[0]&&i[0].outputs&&0===Object.keys(i[0].outputs).length)return{[t]:o.PROCUREMENT_INTENT_NONE};{let e=[],n=[];i[0].outputs.scopeInverse_pathSR&&i[0].outputs.scopeInverse_pathSR.forEach(t=>{t.elements.forEach(t=>{e.push(t.type)})}),i[0].outputs.resultingInverse_pathSR&&i[0].outputs.resultingInverse_pathSR.forEach(e=>{e.elements.forEach(e=>{n.push(e.type)})});let a=[...e,...n];return 0===a.length?{[t]:o.PROCUREMENT_INTENT_NONE}:1===a.length?o.DELFMIFUNCTIONREFERENCE_PROVIDE_TYPES.includes(a[0])?{[t]:o.PROCUREMENT_INTENT_BUY}:{[t]:o.PROCUREMENT_INTENT_MAKE}:{[t]:o.PROCUREMENT_INTENT_MULTIPLE}}})},s.prototype.openQualification=function(e){let t=e.cellView.collectionView.getColumnOrGroup(e.columnID).dataIndex,i={contextObjId:e.cellModel.objId?e.cellModel.objId:e.nodeModel._options.grid.id,callControllerMethod:e.nodeModel._options.grid.actualType===o.TYPE_VENDOR_ITEM&&"tree"===t?this.controller.vendorItemController:this.controller.qualificationController,updateTable:function(i){let n="",o={};"eqName"===t?(n="eqId",o={grid:{eqPrefered:i.grid.preferred,eqApproved:i.grid.approved,eqComments:i.grid.qualificationComments,eqMaturityStatus:i.grid.qualificationMaturity,eqMaturityStatusDisplay:i.grid.qualificationMaturityDisplay,eqContextRestrictions:i.grid.eqContextRestrictions,eqTitle:i.grid.qualtitle}}):"gqName"===t?(n="gqId",o={grid:{gqMaturityStatus:i.grid.qualificationMaturity,gqMaturityStatusDisplay:i.grid.qualificationMaturityDisplay,gqApproved:i.grid.approved,gqContextRestrictions:i.grid.gqContextRestrictions,gqTitle:i.grid.qualtitle}}):(n="id",o={grid:{maturityStatus:i.grid.qualificationMaturity?i.grid.qualificationMaturity:i.grid.maturity_status,maturityStatusDisplay:i.grid.qualificationMaturityDisplay?i.grid.qualificationMaturityDisplay:i.grid.maturity_status_display,approved:i.grid.approved,comments:i.grid.qualificationComments}});var a=e.cellView.collectionView.getTreeDocument().getAllDescendants().filter(e=>e._options.grid[n]===i.grid.id);a&&1===a.length&&a[0].updateOptions(o)}};e.cellModel.tabToOpen&&(i.tabToOpen=e.cellModel.tabToOpen),this.controller.app._applicationChannel.publish({event:"information-panel-add-content",data:{openDetails:(new r).getObjectDetailsInInfoPanel(i)}}),this.controller.app._applicationChannel.publish({event:"information-panel-open-without-reload-content"})},s.prototype.getEngViewColumns=function(e){let t=this;return[{text:t.NLS.title,dataIndex:"tree",pinned:"left",width:220,typeRepresentation:"url",hyperlinkTarget:"_self",typesNAForHyperlink:[t.getDummySourceNodeType()],getCellValue:function(i){if(i.nodeModel.getLabel()){let n;return n={icon:{iconPath:i.nodeModel.getAttributeValue("isMEI")?require.toUrl("ENOXComponentQualification/assets/icons/16/I_ManufacturerEquivalentItem16.png"):i.nodeModel.getAttributeValue("actualType")&&o.DELFMIFUNCTIONREFERENCE_TYPES.includes(i.nodeModel.getAttributeValue("actualType"))?require.toUrl("ENOXComponentQualification/assets/icons/32/"+o.DELFMIFUNCTIONREFERENCE_TYPE_ICONS[i.nodeModel.getAttributeValue("actualType")]+".png"):i.nodeModel.getAttributeValue("actualType")&&o.TYPE_VENDOR_ITEM===i.nodeModel.getAttributeValue("actualType")?require.toUrl("ENOXComponentQualification/assets/icons/VendorItem_Thumbnail.png"):i.nodeModel.getAttributeValue("icon")&&require.toUrl(i.nodeModel.getAttributeValue("icon")),iconSize:{height:"16px",width:"16px"}},label:i.nodeModel.getLabel(),url:"javascript:;",hyperlinkClickCallback:i.nodeModel.getAttributeValue("actualType")&&o.TYPE_VENDOR_ITEM===i.nodeModel.getAttributeValue("actualType")?t.openQualification.bind(t):i.nodeModel.options.grid.grouped?void 0:t.controller.engMEIHyperlinkAction.bind(e)},i.nodeModel.getAttributeValue("type")===t.getDummySourceNodeType()&&(delete n.hyperlinkClickCallback,delete n.url,delete n.icon),n}}},...e.configs.name!==o.MFG_ITEM_DETAILS_PAGE_ROUTE?[{text:t.NLS.procurementIntent,dataIndex:"procurementIntentDisplay"}]:[],{text:t.NLS.revision,dataIndex:"revision"},{text:t.NLS.manufacturer_part_number,dataIndex:"partNumber",width:200},{text:t.NLS.manufacturer,dataIndex:"manufacturer"},{text:t.NLS.maturity_state,dataIndex:"maturityStatusDisplay",width:125,typeRepresentation:"url",hyperlinkTarget:"_self",typesNAForHyperlink:[o.VPMREFERENCE,...o.DELFMIFUNCTIONREFERENCE_TYPES],getCellValue:function(i){let n=i.nodeModel,a={label:n.getAttributeValue("maturityStatusDisplay"),url:"javascript:;",hyperlinkClickCallback:function(){e.app._applicationChannel.subscribeOnce({event:"update-id-card-mei"},function(e){n.setAttribute("maturityStatusDisplay",e.grid.state)});var t={meiId:n.getAttributeValue("id"),applicationChannel:e.app._applicationChannel};e.showMEI.getLifecycleView(t).render()}};return i.nodeModel.getAttributeValue("isMEI")||(o.TYPE_VENDOR_ITEM!==i.nodeModel.getAttributeValue("actualType")?(delete a.hyperlinkClickCallback,delete a.url):o.TYPE_VENDOR_ITEM===i.nodeModel.getAttributeValue("actualType")&&(a.hyperlinkClickCallback=function(i){e.app._applicationChannel.subscribeOnce({event:"maturity-state-updated-vendor-items"},function(e){n.setAttribute("maturityStatusDisplay",e.stateDisplay)}),e.selectedNodes=[i.nodeModel],e.data.id=e.id=i.nodeModel.options.grid.id,e.viewObj={tableView:t.controller.engContextDetailsView.engineeringCollectionView},e.app.dataControllers.engineeringContextController.vendorItemController.loadLifecycleView(e)})),a}},{text:t.NLS.equivalent_qualification,dataIndex:"equivalentQualificationDetails",children:[{text:t.NLS.title,dataIndex:"eqTitle",width:100,setCellValue:function(e,i){e.nodeModel.getAttributeValue("eqTitle")!==i&&t.controller.qualificationController.gridCellUpdateV2({id:e.nodeModel.getAttributeValue("eqId"),type:e.nodeModel.getAttributeValue("eqType"),attribute:"Title",value:i,successMessage:t.NLS.qualification_title_updated,cellInfos:e}).then(t=>{let i={eqTitle:t.data[0].dataelements.title};e.nodeModel.updateOptions({grid:i})})},getCellEditableState:function(e){return!(!e.nodeModel||!e.nodeModel.getAttributeValue("eqModifyAccess"))&&e.nodeModel.getAttributeValue("eqModifyAccess")===o.TRUE}},{text:t.NLS.name,dataIndex:"eqName",width:125,typeRepresentation:"url",hyperlinkTarget:"_self",getCellValue:function(e){let i=e.nodeModel;if(i.getAttributeValue("eqName"))return{icon:{iconPath:require.toUrl("ENOXComponentQualification/assets/icons/16/I_Qualification16.png"),iconSize:{height:"16px",width:"16px"}},objId:i.getAttributeValue("eqId"),label:i.getAttributeValue("eqName"),url:"javascript:;",hyperlinkClickCallback:t.openQualification.bind(t)}}},{text:t.NLS.proof,dataIndex:"eqProof",typeRepresentation:"functionIcon",getCellValue:function(e){let i=e.nodeModel,n=i.getAttributeValue("eqProof");return{objId:i.getAttributeValue("eqId"),tabToOpen:"proof",hyperlinkClickCallback:!(!n||"FALSE"===n)&&t.openQualification.bind(t)}},getCellSemantics:function(e){let t=e.nodeModel.getAttributeValue("eqProof");return{icon:t&&"FALSE"!==t?{iconName:"doc-text-shield",fontIconFamily:1}:""}},alignment:"center",width:100,getCellValueForExport:function(e){return e.nodeModel?e.cellModel&&e.cellModel.objId&&!1!==e.cellModel.hyperlinkClickCallback?t.NLS.yes:e.cellModel&&e.cellModel.objId&&!1===e.cellModel.hyperlinkClickCallback?t.NLS.no:e.cellModel:e.cellModel}},{text:t.NLS.maturity_state,dataIndex:"eqMaturityStatusDisplay",width:125,typeRepresentation:"ENOXSourcing_QualificationStatusType",getCellValue:function(e){let t=e.nodeModel;return{objId:t.getAttributeValue("eqId"),label:t.getAttributeValue("eqName"),status:t.getAttributeValue("eqMaturityStatusDisplay"),statusActual:t.getAttributeValue("eqMaturityStatus"),type:t.getAttributeValue("eqType"),maturity_index:"eqMaturityStatus",maturity_index_display:"eqMaturityStatusDisplay",modifyAccess:"eqModifyAccess"}},getCellValueForExport:function(e){return e.nodeModel?e.cellModel.status:e.cellModel}},{text:t.NLS.preferred,dataIndex:"eqPrefered",width:100,editableFlag:!0,typeRepresentation:"preferredDropDown",setCellValue:function(e,i){e.nodeModel.getAttributeValue("eqPrefered")!==i&&t.controller.qualificationController.gridCellUpdateV2({id:e.nodeModel.getAttributeValue("eqId"),type:e.nodeModel.getAttributeValue("eqType"),attribute:o.ATTRIBUTE_QUALIFICATION_PREFERRED,value:i,successMessage:t.NLS.qualification_preferred_updated,cellInfos:e}).then(t=>{let i={eqPrefered:t.data[0].dataelements["SRC Preferred"]};e.nodeModel.updateOptions({grid:i})})},getCellEditableState:function(e){return!(!e.nodeModel||!e.nodeModel.getAttributeValue("eqModifyAccess"))&&e.nodeModel.getAttributeValue("eqModifyAccess")===o.TRUE},getCellValueForExport:function(e){return e.nodeModel?e.cellModel===o.TRUE?t.NLS.yes:e.cellModel===o.FALSE?t.NLS.no:e.cellModel:e.cellModel}},{text:t.NLS.qualification_status,dataIndex:"eqApproved",editableFlag:!0,width:100,typeRepresentation:"statusDropDown",setCellValue:function(e,i){e.nodeModel.getAttributeValue("eqApproved")!==i&&t.controller.qualificationController.gridCellUpdateV2({id:e.nodeModel.getAttributeValue("eqId"),type:e.nodeModel.getAttributeValue("eqType"),attribute:o.ATTRIBUTE_QUALIFICATION_APPROVED,value:i,successMessage:t.NLS.qualification_approved_updated,cellInfos:e}).then(t=>{let i={eqApproved:t.data[0].dataelements["SRC Approved"]};e.nodeModel.updateOptions({grid:i})})},getCellEditableState:function(e){return!(!e.nodeModel||!e.nodeModel.getAttributeValue("eqModifyAccess"))&&e.nodeModel.getAttributeValue("eqModifyAccess")===o.TRUE},getCellValueForExport:function(e){return e.nodeModel?"Yes"===e.cellModel?t.NLS.yes:"No"===e.cellModel?t.NLS.no:e.cellModel:e.cellModel}},{text:t.NLS.context_restrictions,dataIndex:"eqContextRestrictions",editableFlag:!1,alignment:"center",width:150,typeRepresentation:"url",hyperlinkTarget:"_self",getCellValue:function(e){let i=e.nodeModel;return{label:e.nodeModel.options.grid.eqContextRestrictions,url:"javascript:;",objId:i.getAttributeValue("eqId"),tabToOpen:"context_restrictions",hyperlinkClickCallback:t.openQualification.bind(t)}},getCellValueForExport:function(e){return e.nodeModel&&e.cellModel&&e.cellModel.objId&&e.cellModel.label>=0?e.cellModel.label.toString():e.cellModel}},{text:t.NLS.comments,dataIndex:"eqComments",editableFlag:!0,setCellValue:function(e,i){e.nodeModel.getAttributeValue("eqComments")!==i&&t.controller.qualificationController.gridCellUpdateV2({id:e.nodeModel.getAttributeValue("eqId"),type:e.nodeModel.getAttributeValue("eqType"),attribute:o.ATTRIBUTE_QUALIFICATION_COMMENTS,value:i,successMessage:t.NLS.qualification_comments_updated,cellInfos:e}).then(t=>{let i={eqComments:t.data[0].dataelements["SRC Comments"]};e.nodeModel.updateOptions({grid:i})})},getCellEditableState:function(e){return!(!e.nodeModel||!e.nodeModel.getAttributeValue("eqModifyAccess"))&&e.nodeModel.getAttributeValue("eqModifyAccess")===o.TRUE}}]},{text:t.NLS.general_qualification,dataIndex:"genQualificationDetails",children:[{text:t.NLS.title,dataIndex:"gqTitle",width:100,setCellValue:function(e,i){e.nodeModel.getAttributeValue("gqTitle")!==i&&t.controller.qualificationController.gridCellUpdateV2({id:e.nodeModel.getAttributeValue("gqId"),type:e.nodeModel.getAttributeValue("gqType"),attribute:"Title",value:i,successMessage:t.NLS.qualification_title_updated,cellInfos:e}).then(t=>{let i={gqTitle:t.data[0].dataelements.title};e.nodeModel.updateOptions({grid:i})})},getCellEditableState:function(e){return!(!e.nodeModel||!e.nodeModel.getAttributeValue("gqModifyAccess"))&&e.nodeModel.getAttributeValue("gqModifyAccess")===o.TRUE}},{text:t.NLS.name,dataIndex:"gqName",width:125,typeRepresentation:"url",hyperlinkTarget:"_self",getCellValue:function(e){let i=e.nodeModel;if(i.getAttributeValue("gqName"))return{icon:{iconPath:require.toUrl("ENOXComponentQualification/assets/icons/16/I_Qualification16.png"),iconSize:{height:"16px",width:"16px"}},objId:i.getAttributeValue("gqId"),label:i.getAttributeValue("gqName"),url:"javascript:;",hyperlinkClickCallback:t.openQualification.bind(t)}}},{text:t.NLS.proof,dataIndex:"gqProof",typeRepresentation:"functionIcon",getCellValue:function(e){let i=e.nodeModel,n=i.getAttributeValue("gqProof");return{objId:i.getAttributeValue("gqId"),tabToOpen:"proof",hyperlinkClickCallback:!(!n||"FALSE"===n)&&t.openQualification.bind(t)}},getCellSemantics:function(e){let t=e.nodeModel.getAttributeValue("gqProof");return{icon:t&&"FALSE"!==t?{iconName:"doc-text-shield",fontIconFamily:1}:""}},alignment:"center",width:100,getCellValueForExport:function(e){return e.nodeModel?e.cellModel&&e.cellModel.objId&&!1!==e.cellModel.hyperlinkClickCallback?t.NLS.yes:e.cellModel&&e.cellModel.objId&&!1===e.cellModel.hyperlinkClickCallback?t.NLS.no:e.cellModel:e.cellModel}},{text:t.NLS.maturity_state,dataIndex:"gqMaturityStatusDisplay",width:125,typeRepresentation:"ENOXSourcing_QualificationStatusType",getCellValue:function(e){let t=e.nodeModel;return{objId:t.getAttributeValue("gqId"),label:t.getAttributeValue("gqName"),status:t.getAttributeValue("gqMaturityStatusDisplay"),statusActual:t.getAttributeValue("gqMaturityStatus"),type:t.getAttributeValue("gqType"),maturity_index:"gqMaturityStatus",maturity_index_display:"gqMaturityStatusDisplay",modifyAccess:"gqModifyAccess"}},getCellValueForExport:function(e){return e.nodeModel?e.cellModel.status:e.cellModel}},{text:t.NLS.qualification_status,dataIndex:"gqApproved",editableFlag:!0,typeRepresentation:"statusDropDown",setCellValue:function(e,i){e.nodeModel.getAttributeValue("gqApproved")!==i&&t.controller.qualificationController.gridCellUpdateV2({id:e.nodeModel.getAttributeValue("gqId"),type:e.nodeModel.getAttributeValue("gqType"),attribute:o.ATTRIBUTE_QUALIFICATION_APPROVED,value:i,successMessage:t.NLS.qualification_approved_updated,cellInfos:e}).then(t=>{let i={gqApproved:t.data[0].dataelements["SRC Approved"]};e.nodeModel.updateOptions({grid:i})})},getCellEditableState:function(e){return!(!e.nodeModel||!e.nodeModel.getAttributeValue("gqModifyAccess"))&&e.nodeModel.getAttributeValue("gqModifyAccess")===o.TRUE},getCellValueForExport:function(e){return e.nodeModel?"Yes"===e.cellModel?t.NLS.yes:"No"===e.cellModel?t.NLS.no:e.cellModel:e.cellModel}},{text:t.NLS.context_restrictions,dataIndex:"gqContextRestrictions",editableFlag:!1,alignment:"center",width:150,typeRepresentation:"url",hyperlinkTarget:"_self",getCellValue:function(e){let i=e.nodeModel;return{label:e.nodeModel.options.grid.gqContextRestrictions,url:"javascript:;",objId:i.getAttributeValue("gqId"),tabToOpen:"context_restrictions",hyperlinkClickCallback:t.openQualification.bind(t)}},getCellValueForExport:function(e){return e.nodeModel&&e.cellModel&&e.cellModel.objId&&e.cellModel.label>=0?e.cellModel.label.toString():e.cellModel}}]}]},s.prototype.getToolbar=function(t){let i=this;return[{fonticon:"plus",text:i.NLS.add,content:[{text:i.NLS.equivalent_qualification,className:"header"},{text:i.NLS.new_mei,icon:a.getWebappsAssetUrl("ENOXComponentQualification","icons/22/NewManufacturerEquivalentItem-22.png"),id:"addNewMEI",disabled:!0,handler:function(){let e=i.controller.engContextDetailsView.engineeringCollectionView._xsourcingCollectionViewUI._gridModel.getSelectedNodes()[0];i.controller.meiController.newMEI({...t,blockDetailsViewNavigation:!0,successCallback:i.controller.createEquivalentQualification.bind(i.controller,e)})}},{text:i.NLS.existing_mei,id:"addExistingMEI",disabled:!0,icon:a.getWebappsAssetUrl("ENOXSourcingUXInfra","icons/22/I_ExistingMEI_22.png"),handler:async function(){let e=i.controller.engContextDetailsView.engineeringCollectionView._xsourcingCollectionViewUI._gridModel.getSelectedNodes()[0];i.controller.qualificationController.model.getAllEquivalentItemsFromContextItemId({id:e.getAttributeValue("id"),isMEQ:!(t.configs.name===o.ENG_ITEM_DETAILS_PAGE_ROUTE),includeParams:"$include=context-restrictions,target,Context"}).then(async function(t){let n=(await i.sourceProcessor(t)).map(e=>e.id);i.controller.meiController.helper.invokeMEI3DSearch({resourceid_not_in:n,callBack:i.controller.createEquivalentQualification.bind(i.controller,e)})})}},...t.configs.name===o.ENG_ITEM_DETAILS_PAGE_ROUTE?[]:[{text:i.NLS.existing_mi,id:"addExistingMI",disabled:!0,icon:a.getWebappsAssetUrl("ENOXComponentQualification","icons/32/AddExistingManufacturingItem-32.png"),handler:async function(){let e=i.controller.engContextDetailsView.engineeringCollectionView._xsourcingCollectionViewUI._gridModel.getSelectedNodes()[0];i.controller.qualificationController.model.getAllEquivalentItemsFromContextItemId({id:e.getAttributeValue("id"),isMEQ:!(t.configs.name===o.ENG_ITEM_DETAILS_PAGE_ROUTE),includeParams:"$include=context-restrictions,target,Context"}).then(async function(t){let n=(await i.sourceProcessor(t)).map(e=>e.id);n.push(e.getAttributeValue("id")),i.controller.mfgHelper.invokeMfg3DSearch({resourceid_not_in:n,callBack:i.controller.createEquivalentQualification.bind(i.controller,e)})})}},{text:i.NLS.existing_vi,id:"addExistingVI",disabled:!0,icon:a.getWebappsAssetUrl("ENOXComponentQualification","icons/VendorItem_Thumbnail.png"),handler:async function(){let e=i.controller.engContextDetailsView.engineeringCollectionView._xsourcingCollectionViewUI._gridModel.getSelectedNodes()[0];i.controller.qualificationController.model.getAllEquivalentItemsFromContextItemId({id:e.getAttributeValue("id"),isMEQ:!(t.configs.name===o.ENG_ITEM_DETAILS_PAGE_ROUTE),includeParams:"$include=context-restrictions,target,Context"}).then(async function(t){let n=(await i.sourceProcessor(t)).map(e=>e.id);n.push(e.getAttributeValue("id")),i.controller.meiController.helper.invokeMEI3DSearch({resourceid_not_in:n,vendorItem:!0,callBack:i.controller.createEquivalentQualification.bind(i.controller,e)})})}}]]},{id:"removeMEI",text:i.NLS.remove_source,fonticon:"remove",disabled:!0,handler:function(){let e=i.controller.engContextDetailsView.engineeringCollectionView._xsourcingCollectionViewUI._gridModel.getSelectedNodes()[0];i.handleRemoveSource(e)}},{id:"exportToCSV",fonticon:"export-to-csv",text:i.NLS.export_to_csv,handler:function(){let t=i.controller.app.router.getState().name===o.ENG_ITEM_DETAILS_PAGE_ROUTE?"EngineeringContextExport_":"ManufacturingContextExport_";t+=e.getPlatformId()+".csv";i.controller.engContextDetailsView.engineeringCollectionView._xsourcingCollectionViewUI.exportDataToCSV({forceQuotes:!0,allColumns:!0,addLevelInformation:!0},t)}}]},s.prototype.handleRemoveSource=function(e){let t=this,i=e.getAttributeValue("title"),n=e.getAttributeValue("eqId");new l({renderTo:widget.body,okButtonText:t.NLS.remove}).confirm(t.NLS.remove_confirmation,t.NLS.remove+" - "+i,function(i){i&&t.controller.qualificationController.model.deletePromise({id:n}).then(()=>{let i=e.getTreeDocument(),n=e.getParent();i.prepareUpdate(),1===n.getVisibleChildren().length?i.removeRoot(n):i.removeRoot(e),i.pushUpdate(),widget.notificationUtil.showSuccess(t.NLS.qualification_deleted_sucessfully)},e=>{let t=e.internalError&&500===e.statusCode?e.internalError:e.error;widget.notificationUtil.showError(t)}).catch(e=>{let t=e.internalError&&500===e.statusCode?e.internalError:e.error;widget.notificationUtil.showError(t)})})},s.prototype.recursivelyLoadChildNodes=function(e,t){let i=this;t&&t.children&&t.children.length>0&&t.children.forEach(function(t){let o=new n({label:t.title,grid:t,...void 0!==t.children?{children:[]}:{}});e.addChild(o),i.recursivelyLoadChildNodes(o,t)})},s.prototype.updateMEIRow=function(e){let t=this._xsourcingCollectionViewUI._gridModel.getAllDescendants().filter(t=>t.getAttributeValue("isMEI")&&t.getAttributeValue("id")===e.grid.id);if(t&&1===t.length){let i={maturityStatusDisplay:e.grid.stateDisplay,partNumber:e.grid.partNumber};t[0].updateOptions({grid:i,label:e.grid.title})}},s.prototype.processMEIENGProxyPayload=function(t,i){return{data:[...this.getMEIProxyPayload(i),{id:t.getAttributeValue("id"),type:this.controller.app.router.getState()===o.ENG_ITEM_DETAILS_PAGE_ROUTE?o.ENG_ITEM_PROXY:o.MANUFACTURING_ITEM_PROXY,dataelements:{"ProxyItem.Proxy_Title":t.getLabel(),"ProxyItem.Proxy_Service":o.SOURCE_3DSPACE,"ProxyItem.Proxy_State":t.getAttributeValue("maturityStatus"),"ProxyItem.Proxy_Tenant":e.getPlatformId()}}]}},s.prototype.getMEIProxyPayload=function(t){return t.map(t=>({id:t.id,type:o.MEI_PROXY,dataelements:{"ProxyItem.Proxy_Title":t.grid?t.grid.title:t["ds6w:label"],"ProxyItem.Proxy_Service":o.SOURCE_3DSPACE,"ProxyItem.Proxy_State":t.grid?t.grid.status_value:t["ds6w:status_value"],"ProxyItem.Proxy_Tenant":e.getPlatformId()}}))},s.prototype.processContextItemProxyPayload=function(t,i){return{data:[{id:t.id,type:i,dataelements:{"ProxyItem.Proxy_Title":t["ds6w:label"],"ProxyItem.Proxy_Service":t.sourceid?t.sourceid.split(":")[0]:"","ProxyItem.Proxy_State":t["ds6w:status_value"],"ProxyItem.Proxy_Tenant":e.getPlatformId()}}]}},s.prototype.setDynamicCountUpdater=function(e){let t=this;e.onUpdate(function(){t.controller.engContextDetailsView.engineeringCollectionView._xsourcingCollectionViewUI.collectionToolbar.currentNbitems!==e.getNumberOfVisibleDescendants()&&t.controller.engContextDetailsView.engineeringCollectionView._xsourcingCollectionViewUI._toolbarChannel.publish({event:"enox-collection-toolbar-items-count-update",data:e.getNumberOfVisibleDescendants()})})},s}),define("DS/ENOXComponentQualification/components/ApplicationTopBar/ApplicationTopBarWrapper",["DS/ENOXSourcingUXInfra/InformationPanel/InformationPanelUI"],function(e){"use strict";var t=function(){};return t.prototype.init=function(e,t,i){this._applicationChannel=e,this.triptych=t,this._subscribeToEvents(),this.NLS=i},t.prototype._subscribeToEvents=function(){var t=this;this._applicationChannel.subscribe({event:"welcome-panel-collapse"},function(){t._applicationChannel.publish({event:"triptych-set-size",data:{size:40,side:"left"}}),t._applicationChannel.publish({event:"triptych-show-panel",data:"left"})}),this._applicationChannel.subscribe({event:"welcome-panel-expand"},function(){t._applicationChannel.publish({event:"show-welcomepanel-icon"}),t._applicationChannel.publish({event:"triptych-set-size",data:{size:350,side:"left"}}),t._applicationChannel.publish({event:"triptych-show-panel",data:"left"})}),this._applicationChannel.subscribe({event:"welcome-panel-hide"},function(){t._applicationChannel.publish({event:"hide-welcomepanel-icon"}),t._applicationChannel.publish({event:"welcome-panel-collapse"}),t._applicationChannel.publish({event:"triptych-hide-panel",data:"left"}),t._applicationChannel.publish({event:"information-panel-close"})}),this._applicationChannel.subscribe({event:"information-panel-close"},function(){t._applicationChannel.publish({event:"triptych-hide-panel",data:"right"});var e=widget.getElement(".xCS-triptych-wrapper-right");e&&(e.innerHTML="")}),this._applicationChannel.subscribe({event:"information-panel-open"},function(){t._applicationChannel.publish({event:"triptych-show-panel",data:"right"}),t._applicationChannel.publish({event:"information-panel-visible",data:null}),t._applicationChannel.publish({event:"information-panel-add-content",data:t.selectedObject})}),this._applicationChannel.subscribe({event:"information-panel-open-without-reload-content"},function(){t._applicationChannel.publish({event:"triptych-show-panel",data:"right"}),t._applicationChannel.publish({event:"information-panel-visible",data:null})}),this._applicationChannel.subscribe({event:"triptych-show-panel"},function(){var e=document.querySelector(".information-icon");null!==e&&(e.className.contains("active")||e.classList.add("active"))}),this._applicationChannel.subscribe({event:"triptych-panel-hidden"},function(e){if("right"===e){t._applicationChannel.publish({event:"information-panel-hidden",data:null});var i=widget.getElement(".xCS-triptych-wrapper-right");i&&(i.innerHTML="")}var n=widget.getElement("#sourcinginfoicon");if(n){var o=n.getChildren()[0];o.className.contains("enox-collection-toolbar-filter-activated")&&o.removeClassName("enox-collection-toolbar-filter-activated")}var a=document.querySelector(".information-icon");null!==a&&a.className.contains("active")&&a.classList.remove("active"),t._applicationChannel.publish({event:"destroy-document-view"})}),this._applicationChannel.subscribe({event:"xsourcing-collectionview-selected-object-id"},function(e){e.selectedObject&&!e.fromInfoPanel&&(t.selectedObject=e,t.triptych._triptych._isRightOpen&&t._applicationChannel.publish({event:"information-panel-add-content",data:e}))}),this._applicationChannel.subscribe({event:"xsourcing-collectionview-unselected-object-id"},function(e){t.selectedObject=null,e&&!e.isDocumentView&&t._applicationChannel.publish({event:"information-panel-add-content",data:t.selectedObject})}),this._applicationChannel.subscribe({event:"information-panel-add-content"},function(i){var n=widget.getElement(".xCS-triptych-wrapper-right");if(n&&(n.innerHTML=""),i&&"multipleSelected"===i.selectedObject){let e=UWA.createElement("span",{styles:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%,-50%)"},text:t.NLS.select_only_one_item});n.appendChild(e)}else if(i&&i.openDetails)i.openDetails();else if(i&&i.selectedObject){new e(i.selectedObject).init(i.selectedObject)}else{let e=UWA.createElement("div",{styles:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%,-50%)"},text:t.NLS.no_valid_item_selected});n&&n.appendChild(e)}}),this._applicationChannel.subscribe({event:"make-information-panel-disappear"},function(e){if(!e.forInfo){t._applicationChannel.publish({event:"information-panel-close"});var i=widget.getElement(".information-panel.panel-icon-wrapper");i&&(i.style.display="none")}})},t}),define("DS/ENOXComponentQualification/models/VendorItems",["DS/ENOXSourcingUXInfra/service/ENOXSourcingService","DS/ENOXSourcingUXInfra/Constants/ENOXSourcingConstants"],function(e,t){"use strict";var i=function(){this.source=t.SOURCE_SOURCING};return i.prototype.VendorItemsDetails=function(t){t.endpoint="/resources/v1/modeler/dssourcing/vendoritems/"+t.id+"?$fields=organization,collabSpace",t.source=this.source,e.getService(t)},i.prototype.VendorItemsDetailsWithMei=function(t){return t.statesRequired||(t.statesRequired="all"),t.endpoint=`/resources/v1/modeler/dssourcing/manufacturer-equivalent-items/vendor-items?$states=${t.statesRequired}`,t.source=this.source,e.performPostPromise(t)},i.prototype.create=function(t){t.endpoint="/resources/v1/modeler/dssourcing/vendoritems?$simpleJSON=true",t.source=this.source,e.createService(t)},i.prototype.updateVendorItem=function(t){t.endpoint="/resources/v1/modeler/dssourcing/vendoritems?$fields=organization,collabSpace",t.source=this.source,e.updateService(t)},i.prototype.getLifeCycleDataProviderPromise=function(t){var i={endpoint:"/resources/lifecycle/maturity/getStateGraph"};return i.lifeCycleData=t.getLifecyclePayload,i.source=this.source,e.performLifeCycleAction(i)},i.prototype.performLifeCycleAction=function(t){var i={endpoint:"/resources/lifecycle/maturity/promote"};return i.source=this.source,i.lifeCycleData=t.lifeCycleData,e.performLifeCycleAction(i)},i.prototype.getProxyObjectId=function(t){return t.endpoint="/resources/dssourcing/ProxyObject",t.source=this.source,t.postData=t.data,e.performPostPromise(t)},i.prototype.getAttributesRange=function(t){return t.endpoint="/resources/dssourcing/getAttributeRange",t.source=this.source,t.postData=t.data,e.performPostPromise(t)},i.prototype.deleteVIs=function(t){var i={endpoint:"/resources/v1/modeler/dssourcing/vendoritems"};return i.source=this.source,i.deleteData=t.deleteData,e.deleteServicePromise(i)},i.prototype.getUserPreferedCurrency=function(){var t={endpoint:"/resources/dssourcing/expressiondetails/UserPreferredCurrency"};return t.source=this.source,e.getDataPromise(t)},i}),define("DS/ENOXComponentQualification/config/serviceProviders",function(){"use strict"}),define("DS/ENOXComponentQualification/helpers/ManufacturingHelper",["DS/UIKIT/Mask","DS/ENOXSourcingUXInfra/Constants/ENOXSourcingConstants","DS/ENOXSourcingUXInfra/Search/ENOXSourcingSearch"],function(e,t,i){"use strict";var n=function(e){this.controller=e,this.NLS=this.controller.app.i18NProvider};return n.prototype.simplifyExpandItems=function(e){var t=[];return e.results&&e.results.map(function(e){let i={};e.attributes&&(e.attributes.map(e=>{i[e.name]=e.value}),t.push(i))}),t},n.prototype.processDetailsData=function(e,t,i,n,o){let a=this,r=[],l=a.sourceProcessor(n);return new Promise(n=>{let s={"ds6w:status":[],"ds6w:type":[]},c=t.filter(t=>t.resourceid===e);c[0].thumbnail_2d=o[0].preview_url;let d=i.filter(t=>t.from===e),u=a.structureDataForTNM(c[0],!0),p={grid:u,label:c[0]["ds6w:label"]};if(s["ds6w:status"].push(u.maturityStatus),s["ds6w:type"].push(u.type),r.push(p),p.grid.children)if(l.length>0)r[0].grid.children.push(a.getDummySourceNodeData()),r[0].grid.children[0].children.push(...l);else{t.filter(t=>t.resourceid!==e).forEach(e=>{if(d.some(t=>t.to===e.resourceid)){let t=a.structureDataForTNM(e,!1);s["ds6w:status"].push(t.maturityStatus),s["ds6w:type"].push(t.type),r[0].grid.children.push(t)}})}s["ds6w:status"]=[...new Set(s["ds6w:status"])],s["ds6w:type"]=[...new Set(s["ds6w:type"])],a.controller.searchUtil.getNlsOfPropertiesValues(s).then(function(e){r[0].grid.maturityStatusDisplay=e["ds6w:status"][r[0].grid.maturityStatus]?e["ds6w:status"][r[0].grid.maturityStatus]:r[0].grid.maturityStatus,r[0].grid.typeDisplay=e["ds6w:type"][r[0].grid.type]?e["ds6w:type"][r[0].grid.type]:r[0].grid.type,r[0].grid.children&&r[0].grid.children.forEach(t=>{t.type!==a.getDummySourceNodeType()?(t.maturityStatusDisplay=e["ds6w:status"][t.maturityStatus]?e["ds6w:status"][t.maturityStatus]:t.maturityStatus,t.typeDisplay=e["ds6w:type"][t.type]?e["ds6w:type"][t.type]:t.type):t.children.forEach(t=>{t.maturityStatusDisplay=e["ds6w:status"][t.maturityStatusDisplay]?e["ds6w:status"][t.maturityStatusDisplay]:t.maturityStatusDisplay})})}).finally(function(){n(r)})})},n.prototype.sourceProcessor=function(e){let i=this;return e.data.map(e=>{let n=e.relateddata.target[0],o=[];if(e.relateddata["context-restrictions"]&&e.relateddata["context-restrictions"].length>=0)for(let t=0;t<e.relateddata["context-restrictions"].length;t++)o.push(e.relateddata["context-restrictions"][t]);return{id:n.id,isMEI:n.dataelements.type===t.VPMREFERENCE,isManufacturingItem:!(n.dataelements.type===t.VPMREFERENCE),title:n.dataelements.Title?n.dataelements.Title:n.dataelements.Proxy_Title,revision:n.dataelements.Revision,manufacturer:n.dataelements["Manufacturer Name"],maturityStatusDisplay:n.dataelements.type===t.TYPE_VENDOR_ITEM?i.NLS[n.dataelements.Proxy_State]:n.dataelements.Proxy_State,partNumber:n.dataelements["Part Number"],actualType:n.dataelements.type,eqId:e.id,eqType:e.type,eqModifyAccess:e.dataelements.modifyAccess,eqName:e.dataelements.name+" ("+e.dataelements.revision+")",eqMaturityStatus:e.dataelements.state,eqMaturityStatusDisplay:e.dataelements.stateDisplay,eqPrefered:e.dataelements["SRC Preferred"],eqPreferredDisplay:e.dataelements["SRC Preferred"]===t.FALSE?i.NLS.no:i.NLS.yes,eqApproved:e.dataelements["SRC Approved"],eqComments:e.dataelements["SRC Comments"],eqProof:e.dataelements.isProofExists,eqContextRestrictions:e.relateddata["context-restrictions"]?e.relateddata["context-restrictions"].length:0,eqContextRestriction:o,eqTitle:e.dataelements.title?e.dataelements.title:e.dataelements.name,gqId:n.dataelements.genQualificationId?n.dataelements.genQualificationId:void 0,gqType:t.TYPE_QUALIFICATION_LIST[0],gqName:n.dataelements.genQualificationName?n.dataelements.genQualificationName+" ("+n.dataelements.genQualificationRevision+")":"",gqMaturityStatus:n.dataelements.state?n.dataelements.state:void 0,gqMaturityStatusDisplay:n.dataelements.stateDisplay?n.dataelements.stateDisplay:void 0,gqApproved:n.dataelements.genQualificationApproved?n.dataelements.genQualificationApproved:"",gqModifyAccess:n.dataelements.genQualificationModifyAccess,gqProof:n.dataelements.isProofExists,gqContextRestrictions:n.dataelements.genQualificationId&&n.dataelements["context-restriction"]?Number(n.dataelements["context-restriction"]):"",gqTitle:n.dataelements.genQualificationTitle?n.dataelements.genQualificationTitle:n.dataelements.genQualificationName}})},n.prototype.structureDataForTNM=function(t,i){let n=this;return void 0===t?(widget.notificationUtil.showError(n.NLS.object_not_found_not_indexed),void e.unmask(widget.body)):{id:t.resourceid,isManufacturingItem:!0,creationDate:n.controller.commonUtils.getDateStringForDisplay(t["ds6w:created"]),modificationDate:n.controller.commonUtils.getDateStringForDisplay(t["ds6w:modified"]),maturityStatus:t.current,image:t.thumbnail_2d,icon:t.icon,responsible:t["ds6w:responsible"],revision:t.revision,type:t["ds6w:type"],actualType:t["ds6w:type"],isRoot:i,title:t["ds6w:label"],children:[]}},n.prototype.getDummySourceNodeData=function(){return{title:this.NLS.sources,type:this.getDummySourceNodeType(),actualType:this.getDummySourceNodeType(),children:[]}},n.prototype.getDummySourceNodeType=function(){return"dummySourceNode"},n.prototype.invokeMfg3DSearch=function(e){let n={};n.resourceid_not_in=e.resourceid_not_in,n.callbackMethod=e.callBack,n.title=this.NLS.manufacturing_items,n.types=t.DELFMIFUNCTIONREFERENCE_TYPES,n.excludeCondition=t.EXCLUDE_OBSOLETE,n.predicates=t.UTILITY_PREDICATE_SELECTORS,n.multiSel=!0,(new i).init(n)},n}),define("DS/ENOXComponentQualification/views/Qualification/NewQualification",["DS/ENOXSourcingUXInfra/components/ModalWindowWrapper/ModalWindowWrapper","DS/UIKIT/Scroller","DS/ENOXSourcingUXInfra/xsourcingformview/ENOXSourcingForm","DS/UIKIT/Mask","DS/ENOXSourcingUXInfra/Mediator","DS/ENOXSourcingUXInfra/Constants/ENOXSourcingConstants","DS/ENOXSourcingUXInfra/service/ENOXSourcingPlatformServices","DS/ENOXSourcingUXInfra/xsourcingformview/ENOXSourcingFormHelpers","css!DS/ENOXComponentQualification/ENOXComponentQualification.css"],function(e,t,i,n,o,a,r,l){"use strict";var s=function(e){this.controller=e,this.form=null,this.NLS=this.controller.app.i18NProvider};return s.prototype.render=function(s){var c=this;this.isVendorItemQual=s.isVendorItemQual;var d=UWA.createElement("div",{id:"newQualification",class:"newQualification modalBodyDiv"});let u=new o;s.createQualificationChannel=u.createNewChannel(),this.form=new i({grid:"4,8",applicationChannel:s.createQualificationChannel,fields:c.getQualificationFormsFields(s),events:{onSubmit:async function(){var e=!0;this.texts.length>0&&(e=this.FormValidations.charLimitValidate(this.texts));let t,i=this.buttonGroups[0].getActive()[0].options.name;if(this.wuxAutocompletes.length>0){let n="switchToGeneral"===i?this.wuxAutocompletes.filter(e=>"target"===e.options.name):"switchToManufacturingEquivalent"===i?this.wuxAutocompletes.filter(e=>"manufacturingContext"===e.options.name):"switchToEquivalent"===i?this.wuxAutocompletes.filter(e=>"context"===e.options.name):this.wuxAutocompletes;e=(e=this.FormValidations.wuxAutoCompleteValidation(n))&&this.FormValidations.wuxAutoCompleteMaskingValidation(n),t=this.wuxAutocompletes.filter(e=>"contextRestrictions"===e.options.name)[0].selectedItems}if(m&&m.destroy&&e){switch(n.mask(m.elements.content,c.NLS.creating_qualification),c.controller.app._utility.disableOrEnableButton(!0),s.formValues=this.getValues(),i){case"switchToGeneral":s.formValues.type="type_SRCGeneralQualification";break;case"switchToEquivalent":s.formValues.type="type_SRCEquivalentQualification",s.formValues.contextId=this.getField("context").id;break;case"switchToManufacturingEquivalent":s.formValues.type="type_SRCManufacturingEquivalentQualification",s.formValues.contextId=this.getField("manufacturingContext").id}if(s.formValues.targetId=this.getField("target").id,!0===s.fromRelatedQualifications&&(s.formValues.targetId=s.data.respParams.mei_proxy_id),!0===s.isVendorItemQual&&(s.formValues.targetId=s.data.respParams.id),s.formValues.prereqId=this.getField("usage").id,s.formValues["context-restrictions"]=[],s.qualificationCreateCallBack=function(){n.unmask(m.elements.content),m.destroy()},s.createFailureCallback=function(){n.unmask(m.elements.content),c.controller.app._utility.disableOrEnableButton(!1)},t)if(r.getPlatformId()!==a.ONPREMISE){var o={data:[]};let e=a.CONTEXT_RESTRICTION_ALLOWED_TYPES,i=t.map(e=>e.getAttributeValue("ds6w:type_value")||e.getAttributeValue("type")),n=(await c.controller.gettypeshierarchy(i)).types_hierarchies;t.forEach(t=>{let i=t.getAttributeValue("sourceid")?t.getAttributeValue("sourceid").split(":")[0]:"",a=t.getAttributeValue("sourceid")?t.getAttributeValue("sourceid").split(":")[1]:"",r=t.getAttributeValue("ds6w:type_value")||t.getAttributeValue("type"),l=n.find(e=>e["ds6w:type_value"]===r||e.type===r),s=l&&l.hierarchy;o.data.push({id:t.getAttributeValue("id")||t.getAttributeValue("physicalid")||t.getAttributeValue("value"),type:e.includes(r)?r:s.filter(t=>e.includes(t))[0],dataelements:{"ProxyItem.Proxy_Title":t.getAttributeValue("label"),"ProxyItem.Proxy_Service":i,"ProxyItem.Proxy_Tenant":a}})}),c.controller.model.getProxyObjectId({data:o}).then(function(e){s.formValues["context-restrictions"]=Object.values(e),c.controller.create(s)})}else s.formValues["context-restrictions"]=t.map(e=>e.getAttributeValue("id")||e.getAttributeValue("physicalid")),c.controller.create(s);else c.controller.create(s)}},onChange:function(){this.texts.length>0&&this.FormValidations.charLimitValidate(this.texts)}}}).inject(d),this.isVendorItemQual&&l.switchToManufacturingEquivalentMand({applicationChannel:this.form.buttonGroups[0].options.applicationChannel},this.form);var p=UWA.createElement("span",{id:"modalButtons",class:"modal-buttons"});UWA.createElement("button",{type:"submit",name:"create",id:"createBtn",form:"myForm",class:"btn btn-primary",text:c.NLS.create,value:c.NLS.create}).inject(p),UWA.createElement("button",{type:"reset",id:"closeModalBtn",class:"btn btn-default",text:c.NLS.cancel,value:c.NLS.cancel,events:{click:function(){m.destroy()}}}).inject(p);let m=new e({app:{widget:widget},draggable:!0,resizable:!0,escapeToClose:!0,onHideCB:()=>m.destroy(),height:"480px",classNames:"create-npr-details-modal"}).getModal();m.show(),m.setHeader(c.NLS.new_qualification),d.inject(m.getBody()),p.inject(m.getFooter()),new t({element:d}).inject(m.getBody()),widget.getElement(".xSourcingForm").setAttribute("id","myForm"),s.createQualificationChannel.subscribe({event:"qualification-type-switched"},function(e){s.fromRelatedQualifications||(s.type=e)}),window.odtGQFOrmObjRef&&(window.odtGQFOrmObjRef=this.form)},s.prototype.getQualificationFormsFields=function(e){var t=this;return[{type:"buttonGroup",name:"switchForm",label:t.NLS.qualification_type,buttons:[{name:"switchToEquivalent",value:t.NLS.eng_equivalent,action:"switchToEquivalent",active:!this.isVendorItemQual,disabled:this.isVendorItemQual},{name:"switchToManufacturingEquivalent",value:t.NLS.manufacturing_equivalent,action:"switchToManufacturingEquivalent",active:this.isVendorItemQual,disabled:!this.isVendorItemQual},{name:"switchToGeneral",value:t.NLS.general,action:"switchToGeneral"}]},{type:"text",label:t.NLS.title,name:"title",placeholder:t.NLS.enter_title,isLengthy:!1,helperText:t.NLS.length_100_limit},{type:"autocompleteWithSearch",required:!0,label:t.NLS.context_item,placeholder:t.NLS.placeholder,errorText:t.NLS.please_enter_eng_item,name:"context",typeSearch:[a.VPMREFERENCE],excludeCondition:a.EXCLUDE_MEI+a.AND+a.EXCLUDE_OBSOLETE,sources:[a.SOURCE_3DSPACE],callback:async function(e){n.mask(e.getWrapperDiv(),t.NLS.fetching_details);let i=e.options.form.wuxAutocompletes.filter(e=>"context"===e.options.name);if(i&&i[0].selectedItems){let e=[i[0].selectedItems.getAttributeValue("id")||i[0].selectedItems.getAttributeValue("physicalid")];(await t.controller.searchUtil.getNonIndexedObjectIds(e)).length>0&&(widget.notificationUtil.showError(t.NLS.one_or_more_object_not_indexed),i[0].selectedItems=[])}var o=e.getInputField();if(o.value="",o.id="",o.setAttribute("identifier",""),e.getSelectedObjectAttrValue("value")){let i=e.getSelectedObjectAttrValue("label"),l=e.getSelectedObjectAttrValue("sourceid")?e.getSelectedObjectAttrValue("sourceid").split(":")[0]:"",s=e.getSelectedObjectAttrValue("sourceid")?e.getSelectedObjectAttrValue("sourceid").split(":")[1]:"";var r={data:[{id:e.getSelectedObjectAttrValue("value"),type:a.ENG_ITEM_PROXY,dataelements:{"ProxyItem.Proxy_Title":i,"ProxyItem.Proxy_Service":l,"ProxyItem.Proxy_State":e.getSelectedObjectAttrValue("ds6w:status_value"),"ProxyItem.Proxy_Tenant":s}}]};t.controller.model.getProxyObjectId({data:r}).then(function(t){t&&t[e.getSelectedObjectAttrValue("value")]?(o.setAttribute("identifier",t[e.getSelectedObjectAttrValue("value")]),o.value=i,o.id=t[e.getSelectedObjectAttrValue("value")]):(o.value="",o.id="",o.setAttribute("identifier",""))}).catch(function(){widget.notificationUtil.showError(t.NLS.error_getting_proxy_sourcing),o.value="",o.id="",o.setAttribute("identifier","")}).finally(function(){n.unmask(e.getWrapperDiv())})}else n.unmask(e.getWrapperDiv())}},{type:"autocompleteWithSearch",required:!0,label:t.NLS.context_item,placeholder:t.NLS.placeholder,errorText:t.NLS.please_enter_manufacturing_item,name:"manufacturingContext",completePreCond:"("+a.DELFMIFUNCTIONREFERENCE_QUERY+")"+a.AND+a.EXCLUDE_OBSOLETE,sources:[a.SOURCE_3DSPACE],hide:!0,callback:async function(e){n.mask(e.getWrapperDiv(),t.NLS.fetching_details);let i=e.options.form.wuxAutocompletes.filter(e=>"manufacturingContext"===e.options.name);if(i&&i[0].selectedItems){let e=[i[0].selectedItems.getAttributeValue("id")||i[0].selectedItems.getAttributeValue("physicalid")];(await t.controller.searchUtil.getNonIndexedObjectIds(e)).length>0&&(widget.notificationUtil.showError(t.NLS.one_or_more_object_not_indexed),i[0].selectedItems=[])}var o=e.getInputField();if(o.value="",o.id="",o.setAttribute("identifier",""),e.getSelectedObjectAttrValue("value")){let i=e.getSelectedObjectAttrValue("label"),l=e.getSelectedObjectAttrValue("sourceid")?e.getSelectedObjectAttrValue("sourceid").split(":")[0]:"",s=e.getSelectedObjectAttrValue("sourceid")?e.getSelectedObjectAttrValue("sourceid").split(":")[1]:"";var r={data:[{id:e.getSelectedObjectAttrValue("value"),type:a.MANUFACTURING_ITEM_PROXY,dataelements:{"ProxyItem.Proxy_Title":i,"ProxyItem.Proxy_Service":l,"ProxyItem.Proxy_State":e.getSelectedObjectAttrValue("ds6w:status_value"),"ProxyItem.Proxy_Tenant":s}}]};t.controller.model.getProxyObjectId({data:r}).then(function(t){t&&t[e.getSelectedObjectAttrValue("value")]?(o.setAttribute("identifier",t[e.getSelectedObjectAttrValue("value")]),o.value=i,o.id=t[e.getSelectedObjectAttrValue("value")]):(o.value="",o.id="",o.setAttribute("identifier",""))}).catch(function(){widget.notificationUtil.showError(t.NLS.error_getting_proxy_sourcing),o.value="",o.id="",o.setAttribute("identifier","")}).finally(function(){n.unmask(e.getWrapperDiv())})}else n.unmask(e.getWrapperDiv())}},{type:"text",label:t.NLS.target_item,name:"target",value:e.data.respParams.title,id:e.data.respParams.mei_proxy_id,identifier:e.data.respParams.mei_proxy_id,disabled:!0},{type:"searchWithChooser",searchEvent:"onUsageSearch",required:!1,label:t.NLS.usage_item,placeholder:t.NLS.placeholder_usage_item,width:"100px",name:"usage",hide:!0,typeSearch:"VPMReference",subType:"EnterpriseExtension"},{type:"textarea",label:t.NLS.comments,name:"qualificationComments",placeholder:t.NLS.enter_comments,width:"70%",errorText:t.NLS.max_char_limit_err_msg,isLengthy:!0,helperText:t.NLS.length_256_limit},{type:"concealableList",label:t.NLS.preferred,width:"100px",name:"preferred",options:[{label:t.NLS.yes,value:"Yes"},{label:t.NLS.no,value:"No",selected:"true"}]},{type:"concealableList",label:t.NLS.is_orderable,width:"100px",hide:!0,name:"orderable",options:[{label:t.NLS.yes,value:"Yes",selected:!0},{label:t.NLS.no,value:"No"}]},{type:"autocompleteWithSearch",label:t.NLS.context_restrictions,multiSelect:!0,name:"contextRestrictions",placeholder:t.NLS.placeholder,completePreCond:"("+a.FLATTENEDTAXONOMIES+'"types/'+a.VPMREFERENCE+'"'+a.AND+a.EXCLUDE_MEI+a.AND+a.EXCLUDE_OBSOLETE+")"+a.OR+"("+a.FLATTENEDTAXONOMIES+'"types/'+a.TYPE_PROJECT_SPACE+'"'+a.OR+'[dsplan:type]:"'+a.DSPLAN_PROJECT+'"'+a.AND+a.EXCLUDE_COMPLETE+a.AND+a.EXCLUDE_ARCHIVE+")"+a.OR+"("+a.FLATTENEDTAXONOMIES+'"types/'+a.TYPE_PLANT+'"'+a.AND+a.EXCLUDE_INACTIVE+")"+a.OR+"(("+a.FLATTENEDTAXONOMIES+'"'+a.TYPEMODEL+'"'+a.OR+a.FLATTENEDTAXONOMIES+'"'+a.TYPEMODELVERSION+'")'+a.AND+a.EXCLUDE_INACTIVE+a.AND+a.EXCLUDE_OBSOLETE+")",sources:[a.SOURCE_3DSPACE,a.SOURCE_3DPLAN],callback:async function(e){let i=e.options.form.wuxAutocompletes.filter(e=>"contextRestrictions"===e.options.name);if(i&&i[0].selectedItems.length>0){let e=i[0].selectedItems.map(e=>e.getAttributeValue("id")||e.getAttributeValue("physicalid")),n=await t.controller.searchUtil.getNonIndexedObjectIds(e);n.length>0&&(widget.notificationUtil.showError(t.NLS.one_or_more_object_not_indexed),n.forEach(function(e){i[0].selectedItems=i[0].selectedItems.filter(t=>t._options.resourceid!==e)}))}}}]},s}),define("DS/ENOXComponentQualification/models/Manufacturing",["DS/ENOXSourcingUXInfra/Constants/ENOXSourcingConstants","DS/ENOXSourcingUXInfra/service/ENOXSourcingService","DS/ENOXSourcingUXInfra/service/ENOXSourcingPlatformServices"],function(e,t,i){"use strict";var n=function(e){this.controller=e};return n.prototype.expandItem=function(i){let n={postData:e.CVSERVLET_EXPAND_QUERY};return n.postData.csrf&&delete n.postData.csrf,n.postData.SecurityContext3DSpace&&delete n.postData.SecurityContext3DSpace,n.postData.batch.expands[0].root.physical_id=i.id,n.source=e.SERVICE_3DSPACE,n.endpoint=e.CVSERVLET_ENDPOINTS.expand,t.performPostPromise(n)},n.prototype.fetchItem=function(n){let o={postData:e.CVSERVLET_FETCH_QUERY};return o.postData.csrf&&delete o.postData.csrf,o.postData.SecurityContext3DSpace&&delete o.postData.SecurityContext3DSpace,o.postData.physicalid.length=0,o.postData.physicalid.push(n.id),o.postData.tenant=i.getPlatformId(),o.source=e.SERVICE_3DSPACE,o.endpoint=e.CVSERVLET_ENDPOINTS.fetch,t.performPostPromise(o)},n.prototype.getTagsRead=function(e){var i={endpoint:"/resources/v3/e6w/service/Tags/read"};return i.postData=e,i.source=this.source,i.contentType="application/x-www-form-urlencoded; charset=utf-8",t.performPostPromise(i)},n}),define("DS/ENOXComponentQualification/views/VendorItems/VendorItemsView",["UWA/Core","UWA/Class/View","DS/Utilities/Dom","DS/ENOXSourcingUXInfra/xsourcingCollectionView/xsourcingCollectionView","DS/ENOXSourcingUXInfra/Utilities/Utility"],function(e,t,i,n,o){"use strict";return t.extend({name:"vendor-items",tagName:"div",domEvents:{},init:function(e){this.model=e.model,this.utility=new o,this.modelEvent=this.model.get("modelEvent"),["container","template","tagName","domEvents"].forEach(function(t){delete e[t]}),this._parent(this,e)},setup:function(){this.container.addClassName(this.getClassNames("-container")),this.listenTo(this.model,"onChange",this.render)},update:function(){let e=this.outerDiv.parentElement.parentElement.getBoundingClientRect();this.outerDiv.style.height=e.height+"px"},render:function(){let t=this;t.controller=t.model.get("VIController"),t.NLS=t.controller.app.i18NProvider,t.container.empty(),t.outerDiv=e.createElement("div",{class:"outerDiv",styles:{height:"100%"}}).inject(t.container);let o={};o.app=t.controller.app,o.applicationChannel=t.model.get("applicationChannel"),o.router=t.model.get("router"),o.uniqueIdentifier="VendorItemsList",o.meiId=t.model.get("id"),o.proxyPayload=t.model.get("proxyPayload"),o.container=t.outerDiv,o.data=[],o.viewObj=t,t.loadData(o),o.sort=[{id:"tree",text:t.NLS.title,type:"string"}],o.views=["Grid","Tile"],o.showToolbar=!0,o.toolbarActions=t.populateToolbar(o),o.forInfo=t.model.get("forInfo"),o.columnsConfigurations=t.controller.getColumnConfiguration(o),o.onContextualEventCallback=function(e){var i=[];if(e){var n=e.cellInfos&&e.cellInfos.nodeModel?e.cellInfos.nodeModel:null;if(-1===(e.cellInfos?e.cellInfos.rowID:null)||!n)return this._contextualMenuBuilder?this._contextualMenuBuilder.buildMenu(e,o):[];var a=e.cellInfos.nodeModel?e.cellInfos.nodeModel:e.cellInfos.cellModel;a&&i.push({id:"deleteVendorItemRMB",type:"PushItem",title:t.NLS.delete,fonticon:{content:"wux-ui-3ds wux-ui-3ds-trash"},action:{callback:function(){o.selectedNodes=[a],t.deleteVendorItems(o)}}})}return i},t.tableView=new n,o.descriptionLinesNumber=1,o.displayedOptionalCellProperties=["All"],o.getStatusbarIcons=function(e){return t.controller.getStatusbarIcons(e)},o.getStatusbarIconsTooltips=function(e){return t.controller.getStatusbarIconsTooltips(e)},t.tableView.init(o),t.model.get("applicationChannel").subscribe({event:"udated-vendor-item-count"},function(){t.loadData(o)}),t.tableView.collectionViewEvents.subscribe({event:"xsourcing-collectionview-selection-updated"},function(e){if(e.selectedNodes.length>0&&!o.forInfo)if(t.tableView.collectionViewEvents.publish({event:"xsourcing-collectionview-enable-toolbar-button",data:"deleteVendorItem"}),1===e.selectedNodes.length){let i=event&&event.dsModel&&event.dsModel.activeNode?event.dsModel.activeNode:{options:e.selectedNodes[e.selectedNodes.length-1]},n=i.options.getAttributeValue?i.options.getAttributeValue("id"):i.options.id,o=t.controller.getQualificationOpenInInfoPanel(n);t.model.get("applicationChannel").publish({event:"xsourcing-collectionview-selected-object-id",data:{selectedObject:i.options,openDetails:o}})}else t.model.get("applicationChannel").publish({event:"xsourcing-collectionview-selected-object-id",data:{selectedObject:"multipleSelected"}});else if(o.forInfo)e.selectedNodes.length>0?t.tableView.collectionViewEvents.publish({event:"xsourcing-collectionview-enable-toolbar-button",data:"deleteVendorItem"}):t.tableView.collectionViewEvents.publish({event:"xsourcing-collectionview-disable-toolbar-button",data:"deleteVendorItem"});else{t.tableView.collectionViewEvents.publish({event:"xsourcing-collectionview-disable-toolbar-button",data:"deleteVendorItem"}),t.model.get("applicationChannel").publish({event:"xsourcing-collectionview-unselected-object-id",data:{selectedObject:null}});let e={contextObjId:o.meiId,callControllerMethod:t.model.get("meicontroller")};t.model.get("applicationChannel").publish({event:"xsourcing-collectionview-selected-object-id",data:{selectedObject:!0,openDetails:t.model.get("meicontroller").hyperlinkHelper.getObjectDetailsInInfoPanel(e)}})}});var a={uomDropDown:{stdTemplate:"enumCombo",semantics:{valueType:"enumString",possibleValues:widget.getAttributeRange("Unit of Measure")}},countryDropDown:{stdTemplate:"enumCombo",semantics:{valueType:"enumString",possibleValues:widget.getAttributeRange("Country")}},currencyDropDown:{stdTemplate:"enumCombo",semantics:{valueType:"enumString",possibleValues:widget.getAttributeRange("Currency")}}};return t.tableView._xsourcingCollectionViewUI._dataGridView.getTypeRepresentationFactory().registerTypeRepresentations(JSON.stringify(a)),i.addResizeListener(t.outerDiv,function(){t.update()},0),t.container},onDestroy:function(){return this._parent.apply(this,arguments)},loadData:async function(e){let t=await this.controller.getVendorItemsDetails(e);this.tableView._setData(t),this.tableView._xsourcingCollectionViewUI._allData=t,this.update()},populateToolbar:function(e){let t=this;return[{id:"createNewVendorItem",text:t.NLS.new_vendor_item,fonticon:"plus",handler:function(){t.controller.newVendorItem(e)}},{id:"deleteVendorItem",text:t.NLS.delete,fonticon:"trash",disabled:!0,handler:function(){e.selectedNodes=t.tableView._gridModel.getSelectedNodes(),t.deleteVendorItems(e)}},{id:"filterVI",text:t.NLS.filter_vi,fonticon:"fonticon fonticon-list-filter",content:[t.getFilterObject(t.NLS["In Work"],"in_work",e),t.getFilterObject(t.NLS.Released,"released",e),t.getFilterObject(t.NLS.Obsolete,"obsolete",e),t.getFilterObject(t.NLS.all,"all",e)]}]},deleteVendorItems:function(e){var t=this;t.tableView._xsourcingCollectionViewUI.checkIfExceedsDeleteLimit(e.selectedNodes)||require(["DS/UIKIT/SuperModal"],function(i){if(0===e.selectedNodes.length)return widget.notificationUtil.showError(t.NLS.select_atleast_one+" "+NLS.vendor_item),!1;var n=new i({renderTo:widget.body,okButtonText:t.NLS.delete}),o=1===e.selectedNodes.length?e.selectedNodes[0].options.label:e.selectedNodes.length+" "+t.NLS.vendor_items;n.confirm(t.NLS.delete_confirmation,t.NLS.delete+" - "+o,function(i){i&&t.controller.deleteVendorItems(e)})})},getFilterObject:function(e,t,i){let n=this;return{text:e,title:e,id:t,selectable:!0,selected:i.statesRequired===t,handler:function(e,t){i.statesRequired=t.id,widget.setValue("vi_filter_id",t.id),n.loadData(i)}}}})}),define("DS/ENOXComponentQualification/helpers/SearchEngineeringItem",["DS/ENOXSourcingUXInfra/Search/ENOXSourcingSearch","DS/ENOXSourcingUXInfra/Constants/ENOXSourcingConstants"],function(e,t){"use strict";var i=function(){},n={};return i.prototype.init=function(o){n=this,this.options=o,this.NLS=this.options.app.i18NProvider;var a={};a.title=this.NLS.engineering_item,a.types=o.allowedTypes,a.excludeCondition=t.EXCLUDE_MEI,a.callbackMethod=i.prototype.openEngineeringItem,(new e).init(a)},i.prototype.openEngineeringItem=async function(e){var t={engItemId:e[0].id,pid:e[0].id,engItem:e[0]["ds6w:label"],title:e[0]["ds6w:label"],partNumber:e[0]["ds6w:label_value"],maturityStatus:e[0]["ds6w:status"],image:e[0].preview_url,responsible:e[0]["ds6w:responsible"],modificationDate:e[0]["ds6w:modified"],creationDate:e[0]["ds6w:created"],revision:e[0]["ds6wg:revision"],type:e[0]["ds6w:type_value"],objName:e[0]["ds6w:identifier"]};let i=[t.engItemId];if((await n.options.app.dataControllers.engineeringContextController.searchUtil.getNonIndexedObjectIds(i)).length>0)widget.notificationUtil.showError(n.NLS.one_or_more_object_not_indexed),n.options.app.router.navigate(n.options.routeDetails.name,n.options.data);else{t.platformServices=n.options.platformServices;var o=n.options.nxtNavigationPath;n.options.nxtNavigationPath=void 0,t.pid=t.engItemId,n.options.app.router.navigate(o,t)}},i}),define("DS/ENOXComponentQualification/components/Triptych/TriptychWrapper",["DS/ENOXTriptych/js/ENOXTriptych","css!DS/ENOXComponentQualification/components/Triptych/TriptychWrapper.css"],function(e){"use strict";var t=function(){};return t.prototype.init=function(t,i){this._left=UWA.createElement("div"),this._left.classList.add("xCS-triptych-wrapper-left"),this._main=UWA.createElement("div"),this._main.classList.add("xCS-triptych-wrapper-middle"),this._right=UWA.createElement("div"),this._right.classList.add("xCS-triptych-wrapper-right"),this._applicationChannel=t,this._triptych=new e;var n={left:{resizable:!1,originalSize:350,originalState:widget.body.offsetWidth<550?"close":"open",overMobile:!0},right:{resizable:!0,originalSize:450,originalState:"close",withClose:!0,overMobile:!0,minWidth:406},borderRight:!0,borderLeft:!0,container:i,withtransition:!0,modelEvents:this._applicationChannel};this._triptych.init(n,this._left,this._main,this._right)},t.prototype.inject=function(e){this._triptych.inject(e)},t.prototype._getTriptych=function(){return this._triptych},t.prototype.getLeftPanelContainer=function(){return this._left},t.prototype.getRightPanelContainer=function(){return this._right},t.prototype.getMainPanelContainer=function(){return this._main},t}),define("DS/ENOXComponentQualification/config/routerConfig",["DS/ENOXSourcingUXInfra/Constants/ENOXSourcingConstants"],function(e){"use strict";return{routes:[{name:"home",path:"/home"},{name:"home.ManufacturerEquivalentItems",path:"/ManufacturerEquivalentItems",routeController:"listViewRouteController",dataController:"meiController",titleNLS:"manufacturer_equivalent_items",showTitle:!1},{name:"home.RecentEngineeringItem",path:"/RecentEngineeringItem",routeController:"listViewRouteController",dataController:"listRecentEngineeringController",titleNLS:"my_engineering_item_recent",removalNLS:"eng_item_removed_sucessfully",showTitle:!1,recentTrackerWidgetPreference:"xsrcRecentEngItem",loadingMaskNLSKey:"loading_recent_eng_items",dropAllowedTypes:[e.VPMREFERENCE],detailsRoutename:"home.OpenEngineeringItem"},{name:"home.RecentManufacturingItem",path:"/RecentManufacturingItem",routeController:"listViewRouteController",dataController:"listRecentEngineeringController",titleNLS:"my_manufacturing_item_recent",removalNLS:"mfg_item_removed_sucessfully",showTitle:!1,recentTrackerWidgetPreference:"xsrcRecentMfgItem",loadingMaskNLSKey:"loading_recent_mfg_items",dropAllowedTypes:e.DELFMIFUNCTIONREFERENCE_TYPES,detailsRoutename:"home.OpenManufacturingItem"},{name:"home.MEIDetails",path:"/MEIDetails",routeController:"detailsViewRouteController",dataController:"meiController"},{name:"home.OpenEngineeringItem",path:"/OpenEngineeringItem",routeController:"detailsViewRouteController",dataController:"engineeringContextController",openLoadingMaskNLSKey:"opening_eng_item",recentTrackerWidgetPreference:"xsrcRecentEngItem"},{name:"home.OpenManufacturingItem",path:"/OpenManufacturingItem",routeController:"detailsViewRouteController",dataController:"engineeringContextController",openLoadingMaskNLSKey:"opening_mfg_item",recentTrackerWidgetPreference:"xsrcRecentMfgItem"},{name:"home.OpenQualification",path:"/OpenQualification",routeController:"detailsViewRouteController",dataController:"qualificationController"},{name:"home.admin",path:"/admin"}],options:{defaultRoute:"home.ManufacturerEquivalentItems",defaultParams:{},trailingSlash:!1,useTrailingSlash:void 0,autoCleanUp:!0,strictQueryParams:!0,allowNotFound:!1}}}),define("DS/ENOXComponentQualification/models/ManufacturerEquivalentItem",["DS/ENOXSourcingUXInfra/service/ENOXSourcingService"],function(e){"use strict";var t=function(){this.source="3DSpace"};return t.prototype.create=function(t){t.source=this.source,t.endpoint="/resources/v1/modeler/dssrc/dssrc:ManufacturerEquivalentItem?$mask=dsmvsrc:ManufacturerEquivalentItem.Details",e.createServiceXInfra(t)},t.prototype.createMEIWithEngItem=function(t){t.source=this.source,t.endpoint="/resources/v1/modeler/dssrc/dssrc:ManufacturerEquivalentItems?$mask=dsmvsrc:ManufacturerEquivalentItem.Details",e.createServiceXInfra(t)},t.prototype.delete=function(t){t.source=this.source,t.endpoint="/resources/v1/modeler/dssrc/dssrc:ManufacturerEquivalentItem/delete",e.deleteServiceXInfra(t)},t.prototype.list=function(t){t.source=this.source,t.endpoint="/resources/v1/modeler/dssrc/dssrc:ManufacturerEquivalentItem?$mask=dsmvsrc:ManufacturerEquivalentItem.Details",t.top&&(t.skip||0===t.skip)&&(t.endpoint="/resources/v1/modeler/dssrc/dssrc:ManufacturerEquivalentItem?$mask=dsmvsrc:ManufacturerEquivalentItem.Details&$top="+t.top+"&$skip="+t.skip),e.getService(t)},t.prototype.listSearch=function(t){t.source=this.source,t.endpoint="/resources/v1/modeler/dssrc/dssrc:ManufacturerEquivalentItem/search?$mask=dsmvsrc:ManufacturerEquivalentItem.Details",t.top&&(t.skip||0===t.skip)&&(t.endpoint="/resources/v1/modeler/dssrc/dssrc:ManufacturerEquivalentItem/search?$mask=dsmvsrc:ManufacturerEquivalentItem.Details&$top="+t.top+"&$skip="+t.skip),e.getService(t)},t.prototype.update=function(t){t.source=this.source,t.endpoint="/resources/v1/modeler/dssrc/dssrc:ManufacturerEquivalentItem/"+t.id+"?$mask=dsmvsrc:ManufacturerEquivalentItem.Details",e.updateServiceXInfra(t)},t.prototype.getTargetDetails=function(t){return t.source=this.source,t.endpoint="/resources/v1/modeler/dssrc/dssrc:ManufacturerEquivalentItems/Locate?$mask=dsmvsrc:ManufacturerEquivalentItem.Details",e.performPostPromise(t)},t.prototype.getDetails=function(t){return t.source=this.source,t.endpoint="/resources/v1/modeler/dssrc/dssrc:ManufacturerEquivalentItem/"+t.id+"?$mask=dsmvsrc:ManufacturerEquivalentItem.Details&$fields=dsmveno:CustomerAttributes,dsmvsrc:computed.interfaceDetails&$mva=true",e.getDataPromise(t)},t.prototype.get=function(t){return t.source=this.source,t.endpoint="/resources/v1/modeler/dssrc/dssrc:ManufacturerEquivalentItem/"+t.id+"?$mask=dsmvsrc:ManufacturerEquivalentItem.Details&$fields=dsmveno:CustomerAttributes&$mva=true",e.getService(t)},t.prototype.updateClassification=function(t){return t.source=this.source,t.endpoint="/resources/v1/modeler/dslib/dslib:ClassifiedItem/"+t.id+"?$mask=dslib:ClassificationAttributesMask",e.updateServiceXInfraPromise(t)},t.prototype.getClassifiedItem=function(t){let i={};return i.source=this.source,i.endpoint="/resources/v1/modeler/dslib/dslib:ClassifiedItem/"+t.id+"?$mask=dslib:ClassificationAttributesMask",e.getDataPromise(i)},t.prototype.getClassDetails=function(t){return t.source=this.source,t.endpoint="/resources/v1/modeler/dslib/dslib:Class/"+t.id+"?$mask=dslib:ClassAttributesMask",e.getDataPromise(t)},t.prototype.cloneAndCreateEng=function(t){return t.source=this.source,t.endpoint="/resources/v1/modeler/dssrc/dssrc:ManufacturerEquivalentItem/"+t.id+"/CLONE?$mask=dsmvsrc:ManufacturerEquivalentItem.Basic",e.performPostPromise(t)},t.prototype.getDocuments=function(t){return t.source=this.source,t.endpoint="/resources/v1/modeler/documents/parentId/"+t.id+"?parentRelName=Reference%20Document&parentDirection=from&$include=versions",e.getDataPromise(t)},t.prototype.getProxyObjectId=function(t){return t.endpoint="/resources/dssourcing/ProxyObject",t.source=this.source,t.postData=t.data,e.performPostPromise(t)},t.prototype.getContextQualificationsForMEI=function(t){return t.endpoint="/resources/v1/modeler/dssourcing/qualifications/target/"+t.id,t.includeParams&&(t.endpoint=t.endpoint+"?"+t.includeParams),t.source=this.source,e.getDataPromise(t)},t}),define("DS/ENOXComponentQualification/models/Engineering",["DS/ENOXSourcingUXInfra/Constants/ENOXSourcingConstants","DS/ENOXSourcingUXInfra/service/ENOXSourcingService"],function(e,t){"use strict";var i=function(e){this.controller=e};return i.prototype.navigate=function(i){let n={postData:e.NAVIGATE_QUERY_PAYLOAD};return n.postData.input_physical_ids=i.ids,n.source=e.SERVICE_3DSPACE,n.endpoint=e.CVSERVLET_ENDPOINTS.navigate.replace("${SECURITY_CONTEXT}",t.getSecurityContext(e.SERVICE_3DSPACE)),t.performPostPromise(n)},i}),define("DS/ENOXComponentQualification/views/ManufacturerEquivalentItem/ReviseMEI",["DS/LifecycleCmd/ReviseCmd","DS/ENOXSourcingUXInfra/service/ENOXSourcingService","DS/LifecycleServices/LifecycleServicesSettings","DS/ENOXSourcingUXInfra/Search/SearchUtility"],function(e,t,i,n){"use strict";let o=!0;return{getSecurityContextforLifecycleWidget:function(){return{SecurityContext:t.getSecurityContext()}},revise:function(t){var a=this,r=e.extend({execute:function(e){var t=this;require(["DS/ReviseWidget/ReviseWidget"],function(i){o&&(o=!1,t.executeCmd(new i,e,function(){o=!0}))})}});i.app_initialization(function(){var e={};e.context={getSecurityContext:a.getSecurityContextforLifecycleWidget},new r(e).execute({physicalid:t.meiId})}),(new n).getPlatfromAPIObj().unsubscribe("Lifecycle.Modification"),(new n).getPlatfromAPIObj().subscribe("Lifecycle.Modification",async function(e){let i=JSON.parse(e);if("Lifecycle"===i.From&&"Revise"===i.Refresh.created[0].operation){let e=i.Refresh?i.Refresh.created[0].physicalid:"",n={};n.addData=t.qualificationController.helper.getCopyQualificationPayload({id:t.meiId,Target_ID:e}),await t.qualificationController.copyQualification(n)}a.openMEI(e)})},openMEI:function(e){if(e){let i=JSON.parse(e);if("Lifecycle"===i.From&&"Revise"===i.Refresh.created[0].operation){var t=i.Refresh.created[0].physicalid;widget.app.router.navigate("home.MEIDetails",{pid:t,id:t},{reload:!0})}(new n).getPlatfromAPIObj().unsubscribe("Lifecycle.Modification")}}}}),define("DS/ENOXComponentQualification/views/ManufacturerEquivalentItem/NewManufacturerEquivalentItem",["UWA/Class/View","DS/Utilities/Dom","DS/UIKIT/Mask","DS/ENOXSourcingUXInfra/components/ModalWindowWrapper/ModalWindowWrapper","DS/UIKIT/Scroller","DS/ENOXSourcingUXInfra/xsourcingformview/ENOXSourcingForm","DS/ENOXSourcingUXInfra/Constants/ENOXSourcingConstants","DS/ENOXSourcingUXInfra/service/ENOXSourcingPlatformServices","DS/ENOXSourcingUXInfra/DragAndDrop/ENOXSourcingDataDragAndDrop","DS/TreeModel/TreeNodeModel","DS/Controls/TooltipModel","css!DS/ENOXComponentQualification/ENOXComponentQualification.css"],function(e,t,i,n,o,a,r,l,s,c,d){"use strict";return e.extend({setup:function(e){this.controller=e,this.supplyNetworkController=e.app.viewControllers.supplyNetworkSearchController,this.form=null,this.form=void 0,this.NLS=this.controller.app.i18NProvider},render:function(e,u){var p=this,m=UWA.createElement("div",{id:"newManufacturerEquivalentItem",class:"newManufacturerEquivalentItem modalBodyDiv"});this.form=new a({grid:"4,8",novalidate:!0,fields:[...u?[{type:"autocompleteWithSearch",required:!0,label:p.NLS.physical_product,placeholder:p.NLS.placeholder,errorText:p.NLS.error_enter_physical_product,name:"engitem",typeSearch:[r.VPMREFERENCE],excludeCondition:r.EXCLUDE_MEI,showRevisionWithLabel:!0,resourceid_not_in:[],sources:[r.SOURCE_3DSPACE],callback:async function(e){let t=e.options.form.wuxAutocompletes.filter(e=>"engitem"===e.options.name),i=e.options.form.wuxAutocompletes.filter(e=>"contextRestrictions"===e.options.name)[0];if(t&&t[0].selectedItems){let e=t[0].selectedItems.getAttributeValue("id")||t[0].selectedItems.getAttributeValue("physicalid");if((await p.controller.searchUtil.getNonIndexedObjectIds([e])).length>0)return widget.notificationUtil.showError(p.NLS.one_or_more_object_not_indexed),void(t[0].selectedItems=[]);if(r.ENTERPRISE_EXTENSION===t[0].selectedItems.getAttributeValue("ds6w:kind_value")||r.ENTERPRISE_EXTENSION===t[0].selectedItems.getAttributeValue("ds6w:what/ds6w:kind"))return widget.notificationUtil.showError(p.NLS.physicalproduct_has_EnterpriseExtension),void(t[0].selectedItems=[]);i&&i.fieldController.options.resourceid_not_in.push(e),await p.controller.isEngItemUsed(e)&&(widget.notificationUtil.showError(p.NLS.physicalproduct_already_connectedto_qualification),t[0].selectedItems=[])}else i&&(i.fieldController.options.resourceid_not_in=[])}}]:[{type:"text",required:"true",label:p.NLS.title,placeholder:p.NLS.enter_title,width:"40%",name:"title",errorText:p.NLS.please_enter_title,isLengthy:!1,helperText:p.NLS.length_100_limit}],{type:"text",required:"true",label:p.NLS.manufacturer_part_number,placeholder:p.NLS.enter_part_number,width:"40%",name:"partNumber",errorText:p.NLS.please_enter_man_part_num,isLengthy:!1,helperText:p.NLS.length_100_limit},{type:"autocompleteWithSearch",searchOptions:{type:"Company",title:"Manufacturers"},required:"true",errorText:p.NLS.please_enter_manufacturer,label:p.NLS.manufacturer,placeholder:p.NLS.placeholder,name:"manufacturer",nresults:20,completePreCond:"([ds6w:type]:"+r.TYPE_COMPANY+r.AND+"current:"+r.STATE_ACTIVE+")",sources:[r.SOURCE_3DSPACE],allowChooserCallback:function(){return r.ONPREMISE!==l.getPlatformId()&&"3DSpace"!==widget.getValue("xsrcManufacturerSource")},chooserCallback:async function(e,t,n){let o={disallowedSearchCriteria:["country"],nonEmphasizeInactiveSupplier:!0,collaborationPanelHide:!0},a=e.getModelDiv();p.formReference=e,i.mask(a);if(n){return await p.supplyNetworkController.manageSupplyNetworkSearch({viewOptions:{wizardOptions:void 0,viewOptions:o},field:t,maskingDiv:a},n)}p.supplyNetworkController.manageSupplyNetworkSearch({viewOptions:{wizardOptions:void 0,viewOptions:o},field:t,maskingDiv:a,selectCallback:function(e){this.formReference.wuxAutocompletes.filter(e=>"manufacturer"===e.options.name)[0].selectedItems=e}.bind(p)})}},{type:"textarea",label:p.NLS.description,name:"description",placeholder:p.NLS.ENTER_DESCRIPTION,width:"70%",errorText:p.NLS.max_char_limit_err_msg,isLengthy:!0,helperText:p.NLS.length_256_limit},{type:"text",label:p.NLS.part_source,placeholder:p.NLS.enter_part_source,width:"40%",name:"partSource",errorText:p.NLS.max_char_limit_err_msg,isLengthy:!1,helperText:p.NLS.length_100_limit},{type:"text",label:p.NLS.part_url,placeholder:p.NLS.enter_part_url,width:"40%",name:"partSourceURL"},{type:"justLabel",label:p.NLS.general_qualification},{type:"text",label:p.NLS.title,name:"qualTitle",placeholder:p.NLS.enter_title,isLengthy:!1,helperText:p.NLS.length_100_limit},{type:"textarea",label:p.NLS.comments,name:"qualificationComments",placeholder:p.NLS.enter_comments,width:"70%",errorText:p.NLS.max_char_limit_err_msg,isLengthy:!0,helperText:p.NLS.length_256_limit},{type:"autocompleteWithSearch",label:p.NLS.context_restrictions,multiSelect:!0,name:"contextRestrictions",placeholder:p.NLS.placeholder,completePreCond:r.CONTEXT_RESTRICTION_SEARCH_QUERY,sources:[r.SOURCE_3DSPACE,r.SOURCE_3DPLAN],resourceid_not_in:[],callback:async function(e){let t=e.options.form.wuxAutocompletes.filter(e=>"contextRestrictions"===e.options.name),i=e.options.form.wuxAutocompletes.filter(e=>"engitem"===e.options.name)[0];if(t&&t[0].selectedItems.length>0){let e=t[0].selectedItems.map(e=>e.getAttributeValue("id")||e.getAttributeValue("physicalid"));i&&(i.fieldController.options.resourceid_not_in=[...new Set([e])]);let n=await p.controller.searchUtil.getNonIndexedObjectIds(e);n.length>0&&(widget.notificationUtil.showError(p.NLS.one_or_more_object_not_indexed),n.forEach(function(e){t[0].selectedItems=t[0].selectedItems.filter(t=>t._options.resourceid!==e)}))}else i&&(i.fieldController.options.resourceid_not_in=[])}}],events:{onSubmit:async function(){i.mask(g.elements.content,p.NLS.creating_mei),p.controller.app._utility.disableOrEnableButton(!0);var t=!0;this.texts.length>0&&(t=this.FormValidations.charLimitValidate(this.texts));let n=this.FormValidations.wuxAutoCompleteValidation(this.wuxAutocompletes),o=this.FormValidations.mandatoryFieldValidation(this.texts);if(g&&g.destroy&&t&&o&&n){e.formValues=this.getValues(),e.formValues["context-restrictions"]=[];let t=this.wuxAutocompletes.filter(e=>"contextRestrictions"===e.options.name).length>0?this.wuxAutocompletes.filter(e=>"contextRestrictions"===e.options.name)[0].selectedItems:[],n=this.wuxAutocompletes.filter(e=>"manufacturer"===e.options.name)[0].selectedItems._options;e.formValues.manufacturer=(n.id,e.formValues.manufacturer);let o=this.wuxAutocompletes.filter(e=>"engitem"===e.options.name);if(o=o.length>0?o[0].selectedItems:{},e.createMEICallback=function(){i.unmask(g.elements.content),"create another"===e.target?(document.getElementsByName("engitem").length>0?p.form.wuxAutocompletes.filter(e=>"engitem"===e.options.name)[0].selectedItems=[]:document.getElementsByName("title")[0].value="",document.getElementsByName("partNumber")[0].value="",document.getElementsByName("qualTitle")[0].value="",p.controller.app._utility.disableOrEnableButton(!1)):g.destroy()},e.createFailureCallback=function(){i.unmask(g.elements.content),p.controller.app._utility.disableOrEnableButton(!1)},0!==Object.keys(o).length&&(e.formValues["eng-item"]={source:o.getAttributeValue("sourceid"),type:o.getAttributeValue("ds6w:type_value")||o.getAttributeValue("type"),identifier:o.getAttributeValue("id")||o.getAttributeValue("physicalid")}),t&&t.length>0)if(r.ONPREMISE!==l.getPlatformId()){var a={data:[]};let i=r.CONTEXT_RESTRICTION_ALLOWED_TYPES,n=t.map(e=>e.getAttributeValue("ds6w:type_value")||e.getAttributeValue("type")),o=(await p.controller.qualificationController.gettypeshierarchy(n)).types_hierarchies;t.forEach(e=>{let t=e.getAttributeValue("sourceid")?e.getAttributeValue("sourceid").split(":")[0]:"",n=e.getAttributeValue("sourceid")?e.getAttributeValue("sourceid").split(":")[1]:"",r=e.getAttributeValue("ds6w:type_value")||e.getAttributeValue("type"),l=o.find(e=>e["ds6w:type_value"]===r||e.type===r),s=l&&l.hierarchy;a.data.push({id:e.getAttributeValue("id")||e.getAttributeValue("physicalid")||e.getAttributeValue("value"),type:i.includes(r)?r:s.filter(e=>i.includes(e))[0],dataelements:{"ProxyItem.Proxy_Title":e.getAttributeValue("label"),"ProxyItem.Proxy_Service":t,"ProxyItem.Proxy_Tenant":n}})}),p.controller.model.getProxyObjectId({data:a}).then(function(t){e.formValues["context-restrictions"]=Object.values(t),p.controller.create(e)})}else e.formValues["context-restrictions"]=t.map(e=>e.getAttributeValue("id")||e.getAttributeValue("physicalid")),p.controller.create(e);else p.controller.create(e)}else i.unmask(g.elements.content),p.controller.app._utility.disableOrEnableButton(!1)},onChange:function(){this.texts.length>0&&this.FormValidations.charLimitValidate(this.texts)}}}).inject(m);var f=UWA.createElement("span",{id:"modalButtons",class:"modal-buttons"});UWA.createElement("button",{type:"submit",name:"create",id:"createBtn",form:"myForm",class:"btn btn-primary",text:p.NLS.create,value:p.NLS.create}).inject(f),UWA.createElement("button",{type:"submit",name:"create another",id:"createanotherBtn",form:"myForm",class:"btn btn-primary",text:p.NLS.create_another,value:p.NLS.create_another,events:{click:function(t){e.target=t.target.name}}}).inject(f),UWA.createElement("button",{type:"reset",id:"closeModalBtn",class:"btn btn-default",text:p.NLS.cancel,value:p.NLS.cancel,events:{click:function(){g.destroy()}}}).inject(f);let g=new n({app:{widget:widget},draggable:!0,resizable:!0,escapeToClose:!0,onHideCB:()=>g.destroy(),classNames:"create-npr-details-modal"}).getModal();g.show(),g.setHeader(p.NLS.new_mei),m.inject(g.getBody()),f.inject(g.getFooter()),new o({element:m}).inject(g.getBody()),widget.getElement(".xSourcingForm").setAttribute("id","myForm");let h={};(h.onDropCallback=function(e){if(e.objectType!==r.TYPE_SOURCE)return void widget.notificationUtil.showError(p.NLS.only_source_drop_supported);p.form.getField("partNumber").value=e["SRC Manufacturer Part Number"],p.form.getField("partSource").value=e["SRC Part Source"],p.form.getField("partSourceURL").value=e["SRC Part Source URL"];let t=p.form.wuxAutocompletes.filter(e=>"manufacturer"===e.options.name)[0];if(t&&0!==Object.keys(t).length){let i=[];i.push(new c({label:e["SRC Manufacturer"],customNode:!0})),t.selectedItems=i}},h.dropStrategy="CREATE",h.multiObjs=!1,h.applicationChannel=e.app._mediator.createNewChannel(),h.dropArea=m.getElement("#myForm"),h.dropArea)&&(new s).makeAreaDroppable(h);m.getElement("#myForm")&&t.generateIcon({iconName:"info wux-ui-3ds",className:"infoIcon",tooltipInfos:new d({shortHelp:p.NLS.manufacturer_info})}).inject(m.getElement("#myForm").getChildren()[2].getChildren()[0])}})}),define("DS/ENOXComponentQualification/config/appConfigurator",["i18n!DS/ENOXComponentQualification/assets/nls/ENOXComponentQualification"],function(e){"use strict";return{_modelersRoot:"DS/ENOXSourcingUXInfra/modelers/",_modelersList:["ComponentRequest","ManufacturerEquivalentItem","RequestTemplate"],_controllersRoot:["DS/ENOXComponentQualification/controllers/"],_controllersList:[{name:"ManufacturerEquivalentItemController",label:"meiController"},{name:"QualificationController",label:"qualificationController"},{name:"EngineeringContextController",label:"engineeringContextController"},{name:"ListRecentEngineeringController",label:"listRecentEngineeringController"}],_serviceViewControllersList:[{name:"controllers/ModalWindowController",label:"modalWindowController",initializeController:!1},{name:"controllers/AdminPanelController",label:"adminPanelController",initializeController:!1},{name:"SupplyNetworkSearchView/SupplyNetworkSearchController",label:"supplyNetworkSearchController",initializeController:!0}],_viewControllersRoot:[],_viewControllersList:[],routeControllersRoot:["DS/ENOXSourcingUXInfra/controllers/"],routeControllersList:[{name:"ListViewRouteController",label:"listViewRouteController"},{name:"DetailsViewRouteController",label:"detailsViewRouteController"}],_wizardConfigurator:{_wizardStepsList:["type","category","details","summary"],_wizardViews:[{name:"CreateRequestForm",path:"DS/ENOXSourcingUXInfra/components/CreateRequestForm/CreateRequestForm"},{name:"SingleTileSelector",path:"DS/ENOXSourcingUXInfra/components/SingleTileSelector/SingleTileSelector"},{name:"RequestCreationSummary",path:"DS/ENOXSourcingUXInfra/components/SummarizeAndSubmit/SummarizeAndSubmit"}],_wizardDataprovider:"compRequest"},widgetPreferences:[{name:"xsrcRecentEngItem",type:"hidden",defaultValue:"[]"},{name:"xsrcRecentMfgItem",type:"hidden",defaultValue:"[]"},{name:"defaultRoute",type:"hidden",defaultValue:"home.ManufacturerEquivalentItems"},{name:"lastVisitedRouteName",type:"hidden",defaultValue:"xpflLastVisitedRoute"},{name:"xsrcRecentEngMaxSize",type:"list",label:e.recent_max_size,defaultValue:"10",options:[{label:"5",value:"5"},{label:"10",value:"10"},{label:"20",value:"20"},{label:"50",value:"50"}]}],welcomePanelActivities:[{id:"actions",actions:[{id:"NewSourcedItem",nlsKey:"new_mei",fonticon:"fonticon fonticon-plus",className:"action-new",isNotHighlightable:!0},{id:"ManufacturerEquivalentItems",nlsKey:"manufacturer_equivalent_items",fonticon:"fonticon fonticon-trolley",className:"action-new"},{id:"RecentEngineeringItem",nlsKey:"my_engineering_item",fonticon:"fonticon fonticon-3dproduct",className:"action-new"},{id:"RecentManufacturingItem",nlsKey:"my_manufacturing_item",fonticon:"fonticon fonticon-product-made-from-part",className:"action-new"}]}],nlsSources:[{path:"DS/ENOXComponentQualification/assets/nls/ENOXComponentQualification"},{path:"DS/ENOXSourcingUXInfra/assets/nls/ENOXSourcingUXInfra"}]}}),define("DS/ENOXComponentQualification/views/ManufacturerEquivalentItem/ListManufacturerMigration",["UWA/Class/View","DS/UIKIT/Mask","DS/Controls/Label","DS/ENOXSourcingUXInfra/xsourcingCollectionView/xsourcingCollectionView"],function(e,t,i,n){"use strict";let o;return e.extend({name:"list-manufacturer-migration",tagName:"div",eventTokens:[],className:function(){return this.getClassNames("-container")},setup:function(e){this.controller=e,this.app=e.app,o=this.app.i18NProvider,this.helper=e.helper,this.collectionView=new n,this.eventBroker=this.app._applicationChannel,this.supplyNetworkController=this.app.viewControllers.supplyNetworkSearchController},render:function(){let e=widget.getElement(".information-panel.panel-icon-wrapper");e&&e.style.setProperty("display","none");let t=this,i={container:this.container,collectionViewEvents:this.eventBroker,columnsConfigurations:this.getColumns(this),showToolbar:!0,toolbarActions:this.getToolbar(),getSubLabel:this.helper.getCompanyLabel,getDescription:this.getMigrationDescription,shouldAllowUnsafeHTMLAt:["description"],onContextualEventCallback:function(e){return t.onContextualEvent.call(this,e,i,t)},data:[]};return this.collectionView.init(i),this.subscribeToEvents(this),this},updateModel:function(e){return this.collectionView._setData(e)},getColumns:function(e){return[{text:o.title,dataIndex:"tree",resizableFlag:!0,sortableFlag:!0,pinned:"left",width:130,typeRepresentation:"url",hyperlinkTarget:"_self",hyperlinkClickCallback:function(t){e.app.router.navigate("home.MEIDetails",t.nodeModel.options.grid)},getCellValue:function(e){return{icon:{iconPath:require.toUrl("ENOXComponentQualification/assets/icons/16/I_ManufacturerEquivalentItem16.png"),iconSize:{height:"16px",width:"16px"}},label:e.nodeModel.options.label,url:"javascript:;",hyperlinkClickCallback:e.nodeModel.options.grid.grouped?void 0:this.layout.getColumnOptionValue(e.columnID,"hyperlinkClickCallback")}}},{text:o.manufacturer_part_number,dataIndex:"partNumber",width:200},{text:o.name,dataIndex:"name"},{text:o.revision,dataIndex:"revision"},{text:o.manufacturer,dataIndex:"organization"},{text:o.description,dataIndex:"description"},{text:o.maturity_state,dataIndex:"stateDisplay",width:125},{text:o.owner,dataIndex:"owner"},{text:o.creation_date,dataIndex:"created",width:150},{text:o.modified_date,dataIndex:"modified",width:150}]},getToolbar:function(){return[{id:"migrateSelected",text:o.migrate_manufacturer,fonticon:"database-migration ",handler:function(){t.mask(this.container),this.supplyNetworkController.manageSupplyNetworkSearch({viewOptions:{viewOptions:{actionLabel:"migrate",disallowedSearchCriteria:["country"]}},selectCallback:this.supplierMigrationCallback.bind(this,this.collectionView._gridModel.getSelectedNodes())})}.bind(this)}]},onContextualEvent:function(e,t,i){var n=e.cellInfos&&e.cellInfos.nodeModel?e.cellInfos.nodeModel:null;if(-1===(e.cellInfos?e.cellInfos.rowID:null)||!n)return this._contextualMenuBuilder?this._contextualMenuBuilder.buildMenu(e,t):[];var o=e.cellInfos.nodeModel?e.cellInfos.nodeModel:e.cellInfos.cellModel;return i.getContextualMenuItems(i,o)},getMigrationDescription:function(e){let t="";return e&&e.options.grid?(t=e.options.grid.migrated?o.manufacturer_migrated:"",new i({value:t,emphasize:"success"})):t},getContextualMenuItems:function(e,i){return[{type:"PushItem",title:o.open,fonticon:{content:"wux-ui-3ds wux-ui-3ds-open"},action:{callback:function(){e.app.router.navigate("home.MEIDetails",i.options.grid)}}},{type:"PushItem",title:o.migrate_manufacturer,fonticon:{content:"wux-ui-3ds wux-ui-3ds-database-migration"},action:{callback:function(){t.mask(e.container),e.supplyNetworkController.manageSupplyNetworkSearch({maskingDiv:e.container,viewOptions:{viewOptions:{actionLabel:"migrate",disallowedSearchCriteria:["country"]}},selectCallback:e.supplierMigrationCallback.bind(e,[i])})}}}]},supplierMigrationCallback:function(e,i){t.mask(this.container);let n=this;this.controller.migrateManufacturers(e,i).catch(e=>{throw new Error(e)}).then(t=>{t&&t.member&&t.member instanceof Array&&(n.collectionView._gridModel.prepareUpdate(),t.member.forEach(t=>{t.migrated=!0,t.organization=t.manufacturer,e.find(e=>t.id===e.options.id).updateOptions({grid:t})}),n.collectionView._gridModel.pushUpdate(),widget.notificationUtil.showSuccess(o.migration_success))}).catch(function(){widget.notificationUtil.showError(o.migration_failure)}).finally(()=>{t.unmask(this.container)})},subscribeToEvents:function(e){let i=this.container;this.eventTokens.push(this.collectionView.collectionViewEvents.subscribe({event:"xsourcing-collectionview-cell-dblclick"},function(t){e.app.router.navigate("home.MEIDetails",t)})),this.eventTokens.push(this.eventBroker.subscribe({event:"supplier-search-view-loaded"},function(){t.unmask(i)}))},unsubscribeFromEvents:function(){this.eventTokens.forEach(e=>this.eventBroker.unsubscribe(e),this)},destroy:function(){this.unsubscribeFromEvents()}})}),define("DS/ENOXComponentQualification/models/Qualification",["DS/ENOXSourcingUXInfra/service/ENOXSourcingService","DS/ENOXSourcingUXInfra/Constants/ENOXSourcingConstants"],function(e,t){"use strict";var i=function(e){this.source="sourcing",this.NLS=e.i18NProvider};return i.prototype.init=function(){},i.prototype.create=function(t){t.endpoint="/resources/v1/modeler/dssourcing/qualifications?$include=target,Context,context-restrictions&app=enxspiq",t.source=this.source,e.createService(t)},i.prototype.createQualification=function(t){return t.endpoint="/resources/v1/modeler/dssourcing/qualifications?$include=context-restrictions,target,Context&app=enxspiq",t.source=this.source,e.createServicePromise(t)},i.prototype.reviseQualification=function(t){return t.endpoint="/resources/v1/modeler/dssourcing/qualifications?action=Revise&$include=target,Context&app=enxspiq",t.source=this.source,e.createServicePromise(t)},i.prototype.delete=function(t,i){t.endpoint="/resources/v1/modeler/dssourcing/qualifications/"+i,t.deleteData&&(t.endpoint="/resources/v1/modeler/dssourcing/qualifications"),t.endpoint=t.endpoint+"?$include=target,Context",t.source=this.source,e.deleteService(t)},i.prototype.deletePromise=function(t){return t.endpoint="/resources/v1/modeler/dssourcing/qualifications/"+t.id,t.endpoint=t.endpoint+"?$include=target,Context",t.source=this.source,e.performDeletePromise(t)},i.prototype.getDetails=function(t){return t.endpoint="/resources/v1/modeler/dssourcing/qualifications/"+t.data.params.qualificationId,t.source=this.source,t.includeParams&&(t.endpoint=t.endpoint+"?"+t.includeParams),e.getDataPromise(t)},i.prototype.getQualificationsListPageMEI=function(t){return t.endpoint="/resources/v1/modeler/dssourcing/generalqualifications",t.include&&(t.endpoint=t.endpoint+"?"+t.include),t.source=this.source,e.performPostPromise(t)},i.prototype.getAllEquivalentItemsFromContextItemId=function(t){let i=t.isMEQ?"manufacturingequivalentqualifications":"equivalentqualifications";return t.endpoint="/resources/v1/modeler/dssourcing/qualifications/context/"+t.id+"/"+i,t.includeParams&&(t.endpoint=t.endpoint+"?"+t.includeParams),t.source=this.source,e.getDataPromise(t)},i.prototype.getAllTargetQualificationsFromMEI=function(t){return t.endpoint="/resources/v1/modeler/dssourcing/qualifications/target/"+t.id,t.includeParams&&(t.endpoint=t.endpoint+"?"+t.includeParams),t.source=this.source,e.getDataPromise(t)},i.prototype.getAttributeGroups=function(t){t.endpoint="/resources/v1/modeler/dssourcing/attributes_groups?type=type_SRC_RFQAttributeGroup",t.source=this.source,e.getService(t)},i.prototype.createEquivalentQualification=function(t){var i={},n={data:[t.data],csrf:{name:"ENO_CSRF_TOKEN",value:t.platformServices.ENO_CSRF_TOKEN}};i.addData=n,i.onComplete=t.callBackMethod,i.onFailure=function(){widget.notificationUtil.showError(this.NLS.equivalent_qualification_create_fail)},i.platformServices=t.platformServices,i.endpoint="/resources/v1/modeler/dssourcing/qualifications?app=enxspiq",i.source=this.source,e.createService(i)},i.prototype.updateEquivalentQualification=function(t){t.endpoint="/resources/v1/modeler/dssourcing/qualifications/"+t.id,t.includeParams&&(t.endpoint=t.endpoint+"?"+t.includeParams),t.source=this.source,e.updateService(t)},i.prototype.updateQualificationPromise=function(t){return t.endpoint="/resources/v1/modeler/dssourcing/qualifications/"+t.qualId,t.endpoint=t.endpoint+"?$include=target,Context",t.source=this.source,e.updateServicePromise(t)},i.prototype.getDocuments=function(t){var i={};return i.endpoint="/resources/v1/modeler/dssourcing/qualifications/"+t.data.respParams.id+"/documents",i.source=this.source,e.getDataPromise(i)},i.prototype.attachDocument=function(t){var i={};return i.endpoint="/resources/v1/modeler/dssourcing/qualifications/"+t.data.respParams.id+"/documents",i.source=this.source,i.attachDocumentData=t.attachDocumentData,e.performPatchPromise(i)},i.prototype.detachDocument=function(t){var i={};return i.endpoint="/resources/v1/modeler/dssourcing/qualifications/"+t.data.respParams.id+"/documents/"+t.data.params.documentId,i.source=this.source,e.performDeletePromise(i)},i.prototype.getLifeCycleDataProviderPromise=function(t){var i={endpoint:"/resources/lifecycle/maturity/getStateGraph"};return i.lifeCycleData=t.getLifecycleData,i.source=this.source,e.performLifeCycleAction(i)},i.prototype.performLifeCycleAction=function(t){var i={endpoint:"/resources/lifecycle/maturity/promote"};return i.source=this.source,i.lifeCycleData=t.lifeCycleData,e.performLifeCycleAction(i)},i.prototype.getProxyObjectId=function(t){return t.endpoint="/resources/dssourcing/ProxyObject",t.source=this.source,t.postData=t.data,e.performPostPromise(t)},i.prototype.getAllEquivalentQualificationForGivenContext=function(t){return t.endpoint="/resources/v1/modeler/dssourcing/qualifications/allcontext/"+t.id,t.source=this.source,e.getDataPromise(t)},i.prototype.getProofs=function(t){var i={};return i.endpoint="/resources/v1/modeler/dssourcing/qualifications/"+t+"/proof",i.source=this.source,e.getDataPromise(i)},i.prototype.updateProofs=function(t){t.endpoint="/resources/v1/modeler/dssourcing/qualifications/"+t.id+"/proof",t.source=this.source,e.updateService(t)},i.prototype.gettypeshierarchy=function(i){var n={};return n.source=t.SERVICE_3DSPACE,n.endpoint="/resources/enong/dico/gettypeshierarchy",n.postData={types:i},e.performPostPromise(n)},i.prototype.getContextRestrictions=function(t){var i={};return i.endpoint="/resources/v1/modeler/dssourcing/qualifications/"+t+"/context-restrictions",i.source=this.source,e.getDataPromise(i)},i.prototype.updateContextRestrictions=function(t){t.endpoint="/resources/v1/modeler/dssourcing/qualifications/"+t.id+"/context-restrictions",t.includeParams&&(t.endpoint=t.endpoint+"?"+t.includeParams),t.source=this.source,e.updateService(t)},i.prototype.getObjectInfo=function(i,n="",o=""){var a={endpoint:"/resources/v3/e6w/service/ObjectInfo/read"};return a.endpoint=""!==n?a.endpoint+"?$fields=none,"+n:a.endpoint,a.postData=i,a.source=""!==o?o:t.SERVICE_3DSPACE,e.performPostPromise(a)},i.prototype.getTagsRead=function(t){var i={endpoint:"/resources/v3/e6w/service/Tags/read"};return i.postData=t,i.source=this.source,i.contentType="application/x-www-form-urlencoded; charset=utf-8",e.performPostPromise(i)},i.prototype.getQualificationTargetDetails=function(t,i,n){var o,a="none",r="none";return i&&(a=[a,...i].join()),n&&(r=[r,...n].join()),o="?$include="+r+"&$fields="+a,t.endpoint="/resources/v1/modeler/dssrc/qualifications/targetLocate"+o,t.postData.data.source=this.source,t.source=this.source,e.performPostPromise(t)},i.prototype.getQualificationContextDetails=function(t,i,n){var o,a="none",r="none";return i&&(a=[a,...i].join()),n&&(r=[r,...n].join()),o="?$include="+r+"&$fields="+a,t.endpoint="/resources/v1/modeler/dssrc/qualifications/contextLocate"+o,t.postData.data.source=this.source,t.source=this.source,e.performPostPromise(t)},i.prototype.copyQualification=function(t){return t.endpoint="/resources/v1/modeler/dssourcing/qualifications?action=copyQualification&$include=target,Context&app=enxspiq",t.source=this.source,e.createServicePromise(t)},i}),define("DS/ENOXComponentQualification/components/CustomTweakers/ENOXColorTextfieldTweaker",["DS/Tweakers/StringViewModules","DS/Utilities/Utils","DS/Tweakers/TweakerString","DS/Controls/LineEditor","css!DS/ENOXComponentQualification/components/CustomTweakers/ENOXColorTextfieldTweaker.css"],function(e,t,i,n){"use strict";var o=function(){};return o.prototype.getColorCodeArray=function(){var e={"In Draft":"#007DA3","In Work":"#007DA3",Review:"#007DA3",Released:"#757575",Obsolete:"#BABABA"};return e},o.prototype.createTypeRepresentation=function(o,a,r){var l=function(t,i){e.Base.call(this,t,i)};t.applyMixin(l,e.Base),l.prototype.buildView=function(){this._tweaker.elements.container.addClassName("customview");var e=new n;r&&(e.elements.inputField.readOnly=!0,e.addEventListener("click",t.debounce(()=>{r.callBack(this._tweaker._properties.executionContext.value.nodeModel,this._tweaker._properties.executionContext.value.cellModel)},300))),this._view=e,this.setPossibleValues(this._tweaker.possibleValues),this.setValue(this._tweaker.value,this._tweaker._properties.executionContext.value.cellModel)},l.prototype.destroy=function(){this._tweaker.elements.container&&(this._tweaker.elements.container.style.backgroundColor="",this._tweaker.elements.container.removeClassName("customview"))},l.prototype.handleEvents=function(){var e=this._tweaker,t=this._view;"enumDyn"===e.valueType&&"function"==typeof e.possibleValues&&t.addEventListener("preDropdown",this._loadEntriesBinded)},l.prototype.setValue=function(e,t){var i,n=this._view;try{n.value=JSON.parse(e).status,i=JSON.parse(e)}catch(o){n.value=e,i=t}void 0!==i.statusActual?(this._tweaker.elements.container.style.backgroundColor=a[i.statusActual],this._view.elements.container.firstElementChild.style.background=a[i.statusActual],this._view.elements.container.firstElementChild.style.color="white",this._view.elements.container.firstElementChild.style["text-align"]="center",this._view.elements.container.firstElementChild.style.cursor="pointer"):(this._tweaker.elements.container.style.backgroundColor="initial",this._view.elements.container.firstElementChild.style.background="initial",this._view.elements.container.firstElementChild.style.color="",this._view.elements.container.firstElementChild.style.cursor="")},i.prototype.VIEW_MODULES.statusView={classObject:l},i.prototype.VIEW_MODULES.statusView_readOnly={classObject:l},o.getTypeRepresentationFactory().registerTypeTemplates({statusView:{path:"DS/Tweakers/TweakerString",options:{displayStyle:"statusView"}}})},o}),define("DS/ENOXComponentQualification/components/IDCardInfo/IDCardInfo",["DS/CoreEvents/ModelEvents","DS/ENOXIDCard/js/IDCard","UWA/Class/View","UWA/Class/Model","DS/Handlebars/Handlebars","text!DS/ENOXComponentQualification/components/IDCardInfo/html/InfoSection.html","text!DS/ENOXComponentQualification/components/IDCardInfo/html/AttributesPartial.html"],function(e,t,i,n,o,a,r){"use strict";return i.extend({className:"id-card-info",setup:function(e){this.template=o.compile(a),o.registerPartial("ExtraAttributes",r),this.attributes=e.infoAttributes},render:function(){var e=this.template({attributes:this.attributes});return this.container.setHTML(e),this.container},destroy:function(){this._parent()}})}),define("DS/ENOXComponentQualification/views/Qualification/RelatedQualifications",["UWA/Core","UWA/Class/View","DS/Utilities/Dom","DS/UIKIT/Mask","DS/ENOXSourcingUXInfra/xsourcingCollectionView/xsourcingCollectionView","DS/UIKIT/SuperModal","DS/ENOXSourcingUXInfra/Constants/ENOXSourcingConstants","WebappsUtils/WebappsUtils","DS/ENOXSourcingUXInfra/service/ENOXSourcingPlatformServices","DS/ENOXSourcingUXInfra/Utilities/Utility","DS/ENOXSourcingUXInfra/Utilities/HyperLinkHelper","DS/ENOXSourcingUXInfra/MembersView/MembersView","DS/ENOXSourcingUXInfra/components/MemberInfoProvider/MemberInfoProvider"],function(e,t,i,n,o,a,r,l,s,c,d,u,p){"use strict";return t.extend({name:"related-qualifications-view",tagName:"div",domEvents:{},init:function(e){this.model=e.model,this.utility=new c,this.modelEvent=this.model.get("modelEvent"),["container","template","tagName","domEvents"].forEach(function(t){delete e[t]}),this._parent(this,e)},setup:function(){this.container.addClassName(this.getClassNames("-container")),this.listenTo(this.model,"onChange",this.render)},update:function(){var e=this.outerDiv.parentElement.parentElement.getBoundingClientRect();this.outerDiv.style.height=e.height+"px"},render:function(){var t=this;t.controller=t.model.get("qualificationController"),t.NLS=t.controller.app.i18NProvider,t.container.empty(),t.outerDiv=e.createElement("div",{class:"outerDiv",styles:{height:"100%"}}).inject(t.container),n.mask(t.container,t.NLS.loading_qualifications);var a={};return a._mediator=t.model.get("mediator"),a.applicationChannel=t.model.get("applicationChannel"),a.router=t.model.get("router"),a.uniqueIdentifier="relatedQualifications",a.columnToSearch=r.XSP_COLUMNS_TO_SEARCH,a.data=[],t.model.get("contextObject")&&t.loadData(),a.showToolbar=!0,a.toolbarActions=t.populateToolbar(a),a.columnsConfigurations=t.getColumnConfigurations(a),a.views=["Grid"],a.enableDrag=!0,a.onContextualEventCallback=function(i){var n=i.cellInfos&&i.cellInfos.nodeModel?i.cellInfos.nodeModel:null,o=i.cellInfos?i.cellInfos.rowID:null;let l=t.model.get("parentOptions");if(-1===o||!n)return this._contextualMenuBuilder?this._contextualMenuBuilder.buildMenu(i,l):[];var s=i.cellInfos.nodeModel?i.cellInfos.nodeModel:i.cellInfos.cellModel;let c=s.options.grid.maturityState;var d=[];let m=i.cellInfos?i.cellInfos.columnID:null;m<0&&(m=0);let f=i.collectionView?i.collectionView.layout.getColumnIdentifiers(m).dataIndex:"";return!n.options.grid.grouped&&("tree"===f||"enterpriseItem"===f&&n.options.grid.enterpriseItem)?("tree"===f&&(d=[{type:"PushItem",title:t.NLS.revise,state:c===r.RELEASED||c===r.OBSOLETE?"enabled":"disabled",fonticon:{content:"wux-ui-3ds wux-ui-3ds-flow-line-add"},action:{callback:function(){a.contextualNode=[n],a.fromRelatedQualifications=!0,t.controller.reviseQualificationItem(t,a)}}},{type:"PushItem",title:t.NLS.delete,fonticon:{content:"wux-ui-3ds wux-ui-3ds-trash"},action:{callback:function(){a.contextualNode=[n],t.deleteQualification(t,a)}}},{type:"PushItem",fonticon:{content:"wux-ui-3ds wux-ui-3ds-forward"},title:t.NLS.share,action:{callback:function(){var i=new e.Class.Model({id:n._options.grid.id,changeAccess:n._options.grid.modifyAccess,excludeQuery:'AND NOT [ds6w:identifier]:("'+n._options.grid.modifyAccess+'")',mediator:a._mediator,modelEvent:a._mediator.createNewChannel(),infoContainer:t.controller.app._triptychWrapper.getRightPanelContainer()}),o=new u({model:i});let r=`${t.NLS.share} - ${n._options.grid.name}`,l=t.NLS.can_view;o.memberInfoProvider=new p,o.launchWebUXPopup({shareName:r,canView:l})}}}]),t.controller.helper.appendOpenWithMenu({menu:d,model:s,columnModel:i.collectionView?i.collectionView.getColumnOrGroup(i.cellInfos.columnID):void 0})):d},a.enableDrag=!0,t.tableView=new o,a.container=t.outerDiv,a.enableCellDrag=!0,a.onDragStartCell=function(e,i){let n="";if("enterpriseItem"!==this.getColumnOrGroup(i.columnID).dataIndex)n=t.tableView._xsourcingCollectionViewUI.formatDataForDnD(i.draggedNodes);else{let e={options:{grid:{actualType:i.nodeModel._options.grid.contextTypeActual,displayType:i.nodeModel._options.grid.contextType,actualId:i.nodeModel._options.grid.eng_id,service:r.SOURCE_3DSPACE},label:i.nodeModel._options.grid.enterpriseItem}};n=t.tableView._xsourcingCollectionViewUI.formatDataForDnD([e])}return e.dataTransfer.setData("text/plain",JSON.stringify(n)),e},a.rowUnSelectCallback=function(){if(t._selectedRow&&0===t._selectedRow.length){let e={contextObjId:t.model.get("parentOptions").meiId,callControllerMethod:t.model.get("parentOptions").meicontroller};t.controller.app._applicationChannel.publish({event:"xsourcing-collectionview-selected-object-id",data:{selectedObject:!0,openDetails:t.model.get("parentOptions").meicontroller.hyperlinkHelper.getObjectDetailsInInfoPanel(e)}})}},t.model.get("qualIdToHighlight")&&!t.model.get("parentOptions").data.params.isRefresh&&(a.toHighlight={key:"qualId",id:t.model.get("qualIdToHighlight")}),t.tableView.init(a),t.setListenersAndSubscribers(),window.relatedQualificationReference&&(t.optionsData=a,window.relatedQualificationReference=t),i.addResizeListener(t.outerDiv,function(){t.update()},0),t.container},onDestroy:function(){return this._parent.apply(this,arguments)},loadData:function(){var e=this,t=e.model.get("contextObject"),i=e.model.get("parentOptions"),o=e.model.get("helper"),a={id:i.data.respParams.id,title:i.data.respParams.title,source:"3dspace",state:i.data.respParams.status_value};let l={data:[]},s=o.getProxyPayload(a);t.getProxyObjectId({data:s}).then(function(a){i.data.respParams.mei_proxy_id=a[i.data.respParams.id],t.getAllTargetQualificationsFromMEI({id:i.data.respParams.mei_proxy_id,includeParams:"$include=Context,PreReq,context-restrictions"}).then(function(t){t.data.forEach(e=>{e.relateddata.Context.length>0&&l.data.push({id:e.relateddata.Context[0].dataelements.Proxy_Id})}),e.controller.queryObjectInfo(l).then(function(i){o.processRelatedQualifications(t,i.data).then(function(t){e.tableView._setData(t),e.tableView._xsourcingCollectionViewUI._allData=t;let i={lifecycleCallback:e.model.get("helper").qualificationLifeCycleLaunch.bind(e),collectionView:e.tableView};if(e.model.get("helper").addingTypeRepresentations(i),e.tableView._xsourcingCollectionViewUI._dataGridView.prepareUpdateView(),e.tableView._xsourcingCollectionViewUI._dataGridView.groupRows({dataIndexesToGroup:["typeNLS"]}),e.tableView._xsourcingCollectionViewUI._dataGridView.pushUpdateView(),e.tableView._xsourcingCollectionViewUI.options.toHighlight){e.tableView._xsourcingCollectionViewUI.selectNodeModel(e.tableView._xsourcingCollectionViewUI.options.toHighlight);let t=e.tableView._xsourcingCollectionViewUI.options.toHighlight.id;widget.app._applicationChannel.publish({event:"information-panel-add-content",data:{openDetails:e.getQualificationOpenInInfoPanel(t)}}),widget.app._applicationChannel.publish({event:"information-panel-open-without-reload-content"})}let o=[],a=[];t.forEach(e=>{o.push(e.grid.id),a.push(e)}),e.utility.get6WTagsForIDs(o,e.controller.model).then(async function(t){let i={};const n=t.data;n.forEach(e=>{e[r.CONTEXT_RESTRICTION_TAG]=[],e[r.CONTEXT_RESTRICTION_TYPE_TAG]=[],e[r.CONTEXT_RESTRICTION_REVISION_TAG]=[],e[r.CONTEXT_REVISION_TAG]=[],e[r.QUALIFICATION_TARGET]=[],e[r.QUALIFICATION_TARGET_TYPE]=[],e[r.TARGET_REVISION_TAG]=[],e[r.QUALIFICATION_CONTEXT]=[],e[r.QUALIFICATION_CONTEXT_TYPE]=[]});for(let t=0;t<n.length;t++)n[t][r.TYPE_TAG]&&n[t][r.TYPE_TAG][0]!==e.NLS["SRC General Qualification"]&&(n[t][r.QUALIFICATION_CONTEXT].push(a[t].grid.enterpriseItem),n[t][r.QUALIFICATION_CONTEXT_TYPE].push(a[t].grid.contextType));i=e.utility.buildTagObjectData(n),e.controller.app.taggerProxy.closeFacetTagger(),e.controller.app.taggerProxy.onCloseTagger(),e.controller.app.taggerProxy.initTaggerProxy(a,i,e.tableView)}),e.container&&n.unmask(e.container)}).catch(function(){widget.notificationUtil.showError(e.NLS.error_listing_qualifications)})}).catch(function(){widget.notificationUtil.showError(e.NLS.error_listing_qualifications)})}).catch(function(){widget.notificationUtil.showError(e.NLS.error_listing_qualifications)})}).catch(function(){widget.notificationUtil.showError(e.NLS.error_getting_proxy_sourcing)})},populateToolbar:function(e){var t=this;return[{fonticon:"plus",text:t.NLS.add,disabled:!!t.model.get("isToolbarActionNotAllowed")&&t.model.get("isToolbarActionNotAllowed"),content:[{id:"newQualification",text:t.NLS.new_qualification,icon:l.getWebappsAssetUrl("ENOXComponentQualification","icons/22/NewUsageQualificationforEngineeringContext-22.png"),handler:function(){t.model.get("qualificationController").newQualification(t.model.get("parentOptions"))}},{id:"newEquivalentEngItem",text:t.NLS.new_equivalent_eng_item,icon:l.getWebappsAssetUrl("ENOXComponentQualification","icons/22/I_InsertNewProd.png"),handler:function(){t.newEquivalentEngItem(t,e)}}]},{id:"reviseQualification",text:t.NLS.revise,fonticon:"flow-line-add",disabled:!0,handler:function(){e.fromRelatedQualifications=!0,t.controller.reviseQualificationItem(t,e)}},{id:"delete",text:t.NLS.delete,fonticon:"trash",disabled:!0,handler:function(){t.deleteQualification(t,e)}}]},getQualificationOpenInInfoPanel:function(e,t){var i=this;let n={contextObjId:e,callControllerMethod:i.model.get("qualificationController"),updateTable:function(e){var t=i.tableView._gridModel.getAllDescendants().filter(t=>t._options.grid.id===e.grid.id);t&&1===t.length&&t[0].updateOptions(e)}};return t&&(n.tabToOpen=t.tabToOpen),(new d).getObjectDetailsInInfoPanel(n)},getColumnConfigurations:function(e){var t=this;return[{text:t.NLS.qualification_name,dataIndex:"tree",resizableFlag:!0,sortableFlag:!0,pinned:"left",width:150,typeRepresentation:"url",hyperlinkTarget:"_self",hyperlinkClickCallback:function(e){let i=e.nodeModel.options.grid.id;t.controller.app._applicationChannel.publish({event:"information-panel-add-content",data:{openDetails:t.getQualificationOpenInInfoPanel(i)}}),t.controller.app._applicationChannel.publish({event:"information-panel-open-without-reload-content"})},getCellValue:function(e){return{icon:{iconPath:require.toUrl("ENOXComponentQualification/assets/icons/16/I_Qualification16.png"),iconSize:{height:"16px",width:"16px"}},label:e.nodeModel.options.label,url:"javascript:;",hyperlinkClickCallback:e.nodeModel.options.grid.grouped?void 0:this.layout.getColumnOptionValue(e.columnID,"hyperlinkClickCallback")}}},{text:t.NLS.title,width:100,dataIndex:"qualtitle",editableFlag:!0,setCellValue:function(i,n){e.fromRelatedQualifications=!0,i.nodeModel.options.grid.qualtitle!==n&&t.model.get("qualificationController").gridCellUpdate(e,i,n,"Title",t.NLS.qualification_title_updated)},getCellEditableState:function(e){return!!e.nodeModel&&t.model.get("helper").getEditAccess(e.nodeModel.options.grid.modifyAccess)}},{text:t.NLS.revision,width:100,dataIndex:"revision"},{text:t.NLS.type,dataIndex:"typeNLS"},{text:t.NLS.context_item_title,dataIndex:"enterpriseItem",typeRepresentation:"url",hyperlinkTarget:"_self",typesNAForHyperlink:[r.TYPE_QUALIFICATION_LIST[3]],getCellValue:function(e){return{label:e.nodeModel.options.grid.enterpriseItem,url:"javascript:;",hyperlinkClickCallback:e.nodeModel.options.grid.grouped?void 0:this.layout.getColumnOptionValue(e.columnID,"hyperlinkClickCallback")}},hyperlinkClickCallback:function(e){let i=e.nodeModel.options.grid.contextTypeActual,n=e.nodeModel.options.grid.contextTypeSource,o={};o.pid=e.nodeModel.options.grid.eng_id,o.title=e.nodeModel.options.grid.enterpriseItem,o.getData=!0,i===r.ENG_ITEM_PROXY||i===r.VPMREFERENCE?t.controller.app.router.navigate(r.ENG_ITEM_DETAILS_PAGE_ROUTE,o):i===r.MANUFACTURING_ITEM_PROXY||r.DELFMIFUNCTIONREFERENCE_TYPES.includes(i)?t.controller.app.router.navigate(r.MFG_ITEM_DETAILS_PAGE_ROUTE,o):t.utility.gettypeshierarchy(i).then(function(i){let a=i.types_hierarchies[0].hierarchy.includes(r.VPMREFERENCE),l=i.types_hierarchies[0].hierarchy.filter(e=>r.DELFMIFUNCTIONREFERENCE_TYPES.includes(e));if(a)t.controller.app.router.navigate(r.ENG_ITEM_DETAILS_PAGE_ROUTE,o);else if(l.length>0)t.controller.app.router.navigate(r.MFG_ITEM_DETAILS_PAGE_ROUTE,o);else if(n===r.SOURCE_3DSPACE||r.ONPREMISE===s.getPlatformId())window.open(s._platforms[r.SERVICE_3DSPACE]+"/common/emxNavigator.jsp?objectId="+e.nodeModel.options.grid.eng_id);else{let t=encodeURIComponent(e.nodeModel.options.grid.eng_id.replace("<","").replace(">",""));window.open(s._platforms[r.SERVICE_3DDASHBOARD]+"#dashboard:/tab:/app:ENXPLAN_AP/content:ids="+t+"&tenant="+s.getPlatformId()+"&x3dPlatformId="+s.getPlatformId())}}).catch(function(e){widget.notificationUtil.showError(e)})}},{text:t.NLS.context_item_type,dataIndex:"contextType"},{text:t.NLS.context_restrictions,dataIndex:"contextRestrictonsLength",editableFlag:!1,width:150,alignment:"center",typeRepresentation:"url",hyperlinkTarget:"_self",hyperlinkClickCallback:function(e){let i=e.nodeModel.options.grid.id;t.controller.app._applicationChannel.publish({event:"information-panel-add-content",data:{openDetails:t.getQualificationOpenInInfoPanel(i,{tabToOpen:"context_restrictions"})}}),t.controller.app._applicationChannel.publish({event:"information-panel-open-without-reload-content"})},getCellValue:function(e){return{label:e.nodeModel.options.grid.contextRestrictonsLength,url:"javascript:;",hyperlinkClickCallback:e.nodeModel.options.grid.grouped?void 0:this.layout.getColumnOptionValue(e.columnID,"hyperlinkClickCallback")}}},{text:t.NLS.proof,dataIndex:"proof",typeRepresentation:"functionIcon",getCellValue:function(e){return e.nodeModel.options.grid.isProofExists&&"FALSE"!==e.nodeModel.options.grid.isProofExists?()=>(function(e){let i=e.nodeModel.options.grid.id;t.controller.app._applicationChannel.publish({event:"information-panel-add-content",data:{openDetails:t.getQualificationOpenInInfoPanel(i,{tabToOpen:"proof"})}}),t.controller.app._applicationChannel.publish({event:"information-panel-open-without-reload-content"})})(e):""},getCellSemantics:function(e){return{icon:e.nodeModel.options.grid.isProofExists&&"FALSE"!==e.nodeModel.options.grid.isProofExists?{iconName:"doc-text-shield",fontIconFamily:1}:""}},alignment:"center",width:100},{text:t.NLS.comments,dataIndex:"qualificationComments",editableFlag:!0,setCellValue:function(i,n){i.nodeModel.options.grid.qualificationComments!==n&&(e.fromRelatedQualifications=!0,t.model.get("qualificationController").gridCellUpdate(e,i,n,"attribute_SRCQUALIFICATION.Comments",t.NLS.qualification_comments_updated))},getCellEditableState:function(e){return!!e.nodeModel&&t.model.get("helper").getEditAccess(e.nodeModel.options.grid.modifyAccess)}},{text:t.NLS.preferred,dataIndex:"preferred",width:100,editableFlag:!0,typeRepresentation:"preferredDropDown",setCellValue:function(i,n){i.nodeModel.options.grid.preferred!==n&&(e.fromRelatedQualifications=!0,t.model.get("qualificationController").gridCellUpdate(e,i,n,"attribute_SRCQUALIFICATION.Preferred",t.NLS.qualification_preferred_updated))},getCellEditableState:function(e){let i=!1;return e.nodeModel&&(i=e.nodeModel.options.grid.type!==r.TYPE_QUALIFICATION_LIST[0]&&t.model.get("helper").getEditAccess(e.nodeModel.options.grid.modifyAccess)),i}},{text:t.NLS.qualification_status,dataIndex:"approved",editableFlag:!0,width:100,typeRepresentation:"statusDropDown",setCellValue:function(i,n){i.nodeModel.options.grid.approved!==n&&(e.fromRelatedQualifications=!0,t.model.get("qualificationController").gridCellUpdate(e,i,n,"attribute_SRCQUALIFICATION.Approved",t.NLS.qualification_approved_updated))},getCellEditableState:function(e){return!!e.nodeModel&&t.model.get("helper").getEditAccess(e.nodeModel.options.grid.modifyAccess)}},{text:t.NLS.maturity_state,dataIndex:"qualificationMaturityDisplay",width:125,typeRepresentation:"ENOXSourcing_QualificationStatusType",getCellValue:function(e){return{objId:e.nodeModel.options.grid.id,label:e.nodeModel.options.grid.name,status:e.nodeModel.options.grid.qualificationMaturityDisplay,statusActual:e.nodeModel.options.grid.qualificationMaturity,type:e.nodeModel.options.grid.type,maturity_index:"qualificationMaturity",maturity_index_display:"qualificationMaturityDisplay"}}},{text:t.NLS.creation_date,width:150,dataIndex:"created",typeRepresentation:"datetime"},{text:t.NLS.modified_date,width:150,dataIndex:"modified",typeRepresentation:"datetime"}]},setListenersAndSubscribers:function(){var e=this;e._selectedRow=[],e.tableView._gridModel.addEventListener("select",function(t){e._selectedRow.push(t.data.nodeModel.options.grid)}),e.tableView._gridModel.addEventListener("unselect",function(t){e._selectedRow.length>0&&(e._selectedRow=e._selectedRow.filter(e=>e.id!==t.data.nodeModel.options.grid.id))}),e.tableView.collectionViewEvents.subscribe({event:"xsourcing-collectionview-selection-updated"},function(t){e.selectionCallback(t)}),e.model.get("applicationChannel").subscribe({event:"add-model"},function(){e.loadData()}),e.controller.app._applicationChannel.subscribe({event:"update-proof-dgv"},function(t){let i=e.tableView._xsourcingCollectionViewUI._dataGridView.getTreeDocument().getAllDescendants().filter(e=>e._options.grid.id===t.qualId),n={isProofExists:"FALSE"};0!==t.proofData.length&&(n.isProofExists="TRUE"),i[0]&&i[0].updateOptions&&i[0].updateOptions({grid:n})}),e.controller.app._applicationChannel.subscribe({event:"update-context-restrictions-dgv"},function(t){let i=e.tableView._xsourcingCollectionViewUI._dataGridView.getTreeDocument().getAllDescendants().filter(e=>e._options.grid.id===t.qualId),n={contextRestrictonsLength:0};0!==t.contextRestrictions.length&&(n.contextRestrictonsLength=t.contextRestrictions.length),i[0]&&i[0].updateOptions&&i[0].updateOptions({grid:n})})},selectionCallback:function(e){if(e.selectedItems.length>0){this.model.get("isToolbarActionNotAllowed")||this.tableView.collectionViewEvents.publish({event:"xsourcing-collectionview-enable-toolbar-button",data:"delete"});var t=event&&event.dsModel&&event.dsModel.activeNode?event.dsModel.activeNode:{options:e.selectedItems[e.selectedItems.length-1]},i=this.getQualificationOpenInInfoPanel(t.options.grid.id);1===e.selectedItems.length?(!e.selectedNodes[0]||e.selectedNodes[0].options.grid.maturityState!==r.RELEASED&&e.selectedNodes[0].options.grid.maturityState!==r.OBSOLETE||this.model.get("isToolbarActionNotAllowed")||this.tableView.collectionViewEvents.publish({event:"xsourcing-collectionview-enable-toolbar-button",data:"reviseQualification"}),this.model.get("applicationChannel").publish({event:"xsourcing-collectionview-selected-object-id",data:{selectedObject:t.options.grid,openDetails:i,fromInfoPanel:this.model.get("fromInfoPanel")}})):this.model.get("applicationChannel").publish({event:"xsourcing-collectionview-selected-object-id",data:{selectedObject:"multipleSelected",fromInfoPanel:this.model.get("fromInfoPanel")}})}else this.tableView.collectionViewEvents.publish({event:"xsourcing-collectionview-disable-toolbar-button",data:"delete"}),this.tableView.collectionViewEvents.publish({event:"xsourcing-collectionview-disable-toolbar-button",data:"reviseQualification"}),this.model.get("applicationChannel").publish({event:"xsourcing-collectionview-unselected-object-id",data:{selectedObject:null}})},deleteQualification:function(e,t){if(t.selectedNodes=e.tableView._gridModel.getSelectedNodes().filter(function(e){return!0!==e._options.grid.grouped}),!e.tableView._xsourcingCollectionViewUI.checkIfExceedsDeleteLimit(t.selectedNodes)&&(t.contextualNode&&(t.selectedNodes=t.contextualNode.slice()),t.contextualNode=void 0,t.selectedNodes.length>0)){var i=[];t.selectedNodes.forEach(e=>{i.push({id:e.getAttributeValue("id")})}),t.deleteData={data:i};var o=new a({renderTo:widget.body,okButtonText:e.NLS.delete}),r=1===t.selectedNodes.length?t.selectedNodes[0].options.label:t.selectedNodes.length+" "+e.NLS.qualifications_small;o.confirm(e.NLS.delete_confirmation,e.NLS.delete+" - "+r,function(i){i&&(n.mask(e.container,e.NLS.loading_qualifications),t.onComplete=function(){t.selectedNodes.forEach(e=>e.getTreeDocument().removeRoot(e)),e.tableView.collectionViewEvents.publish({event:"xsourcing-collectionview-update-count"}),e.model.get("applicationChannel").publish({event:"information-panel-add-content",data:{selectedObject:null}}),widget.notificationUtil.showSuccess(e.NLS.qualification_deleted_sucessfully),e.loadData()},t.onFailure=function(t){widget.notificationUtil.showError(t.internalError&&500===t.statusCode?t.internalError:t.error),n.unmask(e.container)},e.model.get("contextObject").delete(t,t.selectedNodes[0].options.id))})}},newEquivalentEngItem:function(e,t){var i=e.model.get("parentOptions");let o={};o.id=i.meiId,o.postData=e.processXInfraCloneData(o),e.model.get("parentOptions").meicontroller.model.cloneAndCreateEng(o).then(function(o){widget.notificationUtil.showSuccess(e.NLS.engineering_item+' "'+o.member[0].name+'" '+e.NLS.created_successfully),n.mask(widget.body,e.NLS.creating_qualification);var a=o.member[0].id;e.getProxyDetails(e,t,o.member[0]).then(function(n){i.data.respParams.eng_proxy_id=n[a],t.formValues={},t.formValues.targetId=i.data.respParams.mei_proxy_id,t.formValues.contextId=i.data.respParams.eng_proxy_id,t.formValues.preferred="No",t.formValues.qualificationComments="",t.formValues.type=r.SYMBOLIC_TYPE_SRC_EQUIVALENT_QUALIFICATION,t.qualificationCreateCallBack=function(){},t.applicationChannel=e.model.get("applicationChannel"),t.fromRelatedQualifications=!0,e.model.get("qualificationController").create(t)}).catch(function(){widget.notificationUtil.showError(e.NLS.error_getting_proxy_sourcing)})},function(e){widget.notificationUtil.showError(e.error?e.error:e.message)})},processXInfraCloneData:function(e){return[{id:e.id,identifier:e.id,source:r.SERVICE_3DSPACE}]},getProxyDetails:function(e,t,i){var n=e.model.get("contextObject");i.source=r.SOURCE_3DSPACE,i.type=r.ENG_ITEM_PROXY;let o=e.model.get("helper").getProxyPayload(i);return n.getProxyObjectId({data:o})}})}),define("DS/ENOXComponentQualification/helpers/MEIHelper",["DS/ENOXSourcingUXInfra/service/ENOXSourcingPlatformServices","DS/ENOXSourcingUXInfra/Constants/ENOXSourcingConstants","DS/ENOXSourcingUXInfra/CommonUtils/CommonUtils","DS/ENOXSourcingUXInfra/Search/ENOXSourcingSearch","DS/ENOXSourcingUXInfra/Search/SearchUtility"],function(e,t,i,n,o){"use strict";var a=function(e){this.controller=e,this.NLS=this.controller.app.i18NProvider,this.searchUtil=new o};return a.prototype.getSearchPayload=function(){return{label:"test",locale:widget.lang,select_predicate:["ds6w:label","physicalid","name","ds6w:description","ds6w:identifier","ds6w:status","ds6w:created","ds6w:modified","ds6w:responsible","ds6w:who/ds6w:responsible/ds6w:manufacturer","ds6w:manufacturer","ds6wg:EnterpriseExtension.V_PartNumber","bo.ManufacturerEquivalentItemExtension.ManufacturerName","ds6wg:ManufacturerEquivalentItemExtension.ManufacturerPartNumber","ds6wg:revision","partnumber","ds6w:type"],select_file:["icon","thumbnail_2d"],query:"([ds6w:type]:VPMReference AND [ds6wg:ManufacturerEquivalentItemExtension.ManufacturerPartNumber]:/.+/)",source:["3dspace"],tenant:e.getPlatformId()}},a.prototype.processSearchItem=function(e){return e.map(e=>({title:e["ds6w:label"],name:e["ds6w:identifier"],description:e["ds6w:description"],id:e.resourceid,revision:e["ds6wg:revision"],type:e["ds6w:type"]?e["ds6w:type"]:e["ds6w:what/ds6w:type"],state:e["ds6w:status_displayValue"]?e["ds6w:status_displayValue"]:e["ds6w:what/ds6w:status"],status:e["ds6w:status"]?e["ds6w:status"]:"",status_value:e["ds6w:status_displayValue"]?e["ds6w:status_displayValue"]:e["ds6w:what/ds6w:status"],created:e["ds6w:created"]?e["ds6w:created"]:e["ds6w:when/ds6w:created"],modified_value:e["ds6w:modified"]?e["ds6w:modified"]:e["ds6w:when/ds6w:modified"],manufacturer:e["ds6wg:ManufacturerEquivalentItemExtension.ManufacturerName"],manufacturerPartNumber:e["ds6wg:ManufacturerEquivalentItemExtension.ManufacturerPartNumber"],owner:e["ds6w:responsible"]?e["ds6w:responsible"]:e["ds6w:who/ds6w:responsible"],collabspace:e["ds6w:project"]?e["ds6w:project"]:e["ds6w:where/ds6w:context/ds6w:project"],sourceid:e.sourceid}))},a.prototype.updateExistingNodesData=function(e,t){let n=t._xsourcingCollectionViewUI._gridModel.getRoots();if(n.length>0){let o=n.filter(t=>e.some(e=>e.id===t.getAttributeValue("id")));o.length>0&&(t._xsourcingCollectionViewUI._gridModel.prepareUpdate(),o.forEach(function(t){let n=e.filter(e=>t.getAttributeValue("id")===e.id)[0],o={title:n.title,label:n.title,partNumber:n.manufacturerPartNumber,status_value:n.status_value,owner:n.owner,modified:i.getDateStringForDisplay(n.modified_value),description:n.description};t.updateOptions({grid:o})}),t._xsourcingCollectionViewUI._gridModel.pushUpdate())}},a.prototype.processXInfraData=function(e){return e.member?e.member.map(e=>this.convertItemToNodeModel(this.processXInfraItem(e)),this):[]},a.prototype.processXInfraItem=function(e){return{image:"ENOXComponentQualification/assets/icons/MEI-Thumbnail.png",title:e.title,name:e.name,description:e.description,id:e.id,revision:e.revision,type:e.type,state:e.state,status_value:e.status_value,stateDisplay:e.state,createdActual:e.created_generic?new Date(e.created_generic):new Date(e.created),modifiedActual:e.modified_generic?new Date(e.modified_generic):e.modified_value?new Date(e.modified_value):new Date(e.modified),created:e.created_generic?i.getDateStringForDisplay(e.created_generic):i.getDateStringForDisplay(e.created),modified:e.modified_generic?i.getDateStringForDisplay(e.modified_generic):e.modified?i.getDateStringForDisplay(e.modified):i.getDateStringForDisplay(e.modified_value),owner:e.owner,organization:e.manufacturer,partNumber:e.manufacturerPartNumber,collabspace:e.collabspace,organizationResponsible:e.organization,partSource:e.partSource,partSourceURL:e.partSourceURL,qualificationStatus:e.qualificationStatus,preferred:e.preferred,preferredDisplay:this.NLS[e.preferred],qualificationId:e.qualificationId,qualificationType:e.qualificationType,modifyAccess:e.modifyAccess,marketStatus:e.marketStatus,usageAuthorization:e.usageAuthorization,isOrderable:e.isOrderable,qualificationState:e.qualificationState,qualificationStateDisplay:this.NLS[e.qualificationState],cestamp:e.cestamp,mei_id:e.mei_id,mei_proxy_id:e.mei_proxy_id,service:t.SERVICE_3DSPACE,actualType:t.VPMREFERENCE,additionalDragData:{objectTaxonomies:[t.MEI_EXTENSION]},ClassificationAttributes:e.ClassificationAttributes,customerAttributes:e.customerAttributes,isLastVersion:this.NLS[e.isLastVersion]}},a.prototype.convertItemToNodeModel=function(e){return{grid:e,label:e.title,thumbnail:require.toUrl(e.image),id:e.id}},a.prototype.getCompanyLabel=function(e){let t=UWA.createElement("div");return function(e){let t;e.hasOwnProperty("organization")?t=e:e.options.grid&&e.options.grid.hasOwnProperty("organization")&&(t=e.options.grid);let i=UWA.createElement("div",{name:"CompanyLabel"});return UWA.createElement("span",{class:"xsourcing-company-icon fonticon fonticon-fonticon fonticon-factory"}).inject(i),UWA.createElement("span",{class:"xsourcing-company-name"}).inject(i).innerHTML=t?t.organization:void 0,i}(e).inject(t),t},a.prototype.getDescription=function(e){let{state:t,revision:i,owner:n}=e.options.grid,o={state:t,revision:i,owner:n};return Object.values(o).filter(e=>e).join(" | ")},a.prototype.hasQualification=function(e){return e.getAttributeValue("qualificationId")&&e.getAttributeValue("qualificationType")},a.prototype.getQualificationStatusIcon=function(e){let t;switch(e.getAttributeValue("approved")){case"Yes":t="check";break;case"No":t="wrong";break;case"":t="clock";break;default:t=""}return t},a.prototype.getQualificationStatusTooltip=function(e){let t,i=this;switch(e.getAttributeValue("approved")){case"Yes":t=i.NLS.qualification_status_tooltip+": "+i.NLS.approved;break;case"No":t=i.NLS.qualification_status_tooltip+": "+i.NLS.rejected;break;case"":t=i.NLS.qualification_status_tooltip+": "+i.NLS.pending;break;default:t=""}return t},a.prototype.getStatusbarIcons=function(e){let t=[];if(this.hasQualification(e)){t.push("badge");let i=this.getQualificationStatusIcon(e);i&&t.push(i)}return t},a.prototype.getStatusbarIconsTooltips=function(e){let t=[];if(this.hasQualification(e)){t.push(this.NLS.mei_qualified);let i=this.getQualificationStatusTooltip(e);i&&t.push(i)}return t},a.prototype.getCustomTooltip=function(e){let{title:t,stateDisplay:i,revision:n,description:o}=e.options.grid;return function(e){let t="";return e.forEach(function(e){""!==e.data&&void 0!==e.data&&(""!==t&&(t+="\n"),t=t+e.label+": "+e.data)}),t}([{label:this.NLS.title,data:t},{label:this.NLS.maturity_state,data:i},{label:this.NLS.revision,data:n},{label:this.NLS.description,data:o}])},a.prototype.setStatusbarStyle=function(e){let t=e.cellView,i=t?t.contentView:void 0,n=i?i.elements:void 0,o=i.statusbarIcons,a=n?n.statusbaricons:void 0;return a&&a.length>0&&o&&-1!==o.indexOf("check")&&("Yes"===e.cellModel.options.grid.approved?a[o.indexOf("check")].addClassName("xsourcing-approved"):a[o.indexOf("check")].removeClassName("xsourcing-approved")),a&&a.length>0&&o&&-1!==o.indexOf("clock")&&(""===e.cellModel.options.grid.approved?a[o.indexOf("clock")].addClassName("xsourcing-pending"):a[o.indexOf("clock")].removeClassName("xsourcing-pending")),a&&a.length>0&&o&&-1!==o.indexOf("wrong")&&("No"===e.cellModel.options.grid.approved?a[o.indexOf("wrong")].addClassName("xsourcing-rejected"):a[o.indexOf("wrong")].removeClassName("xsourcing-rejected")),e},a.prototype.onStatusbarIconPointerDown=function(e){"badge"===e.cellInfos.cellView.contentView.statusbarIcons[e.clickedIconIndex]&&this.controller.app.router.navigate("home.MEIDetails",{id:e.cellInfos.nodeModel.options.id,activeTab:"allQualifications"})},a.prototype.preparePayloadTargetLocate=function(i){let n={engItem:[]};return i.map(function(i){n.engItem.push({source:e.getServiceURL(t.SERVICE_3DSPACE),type:t.VPMREFERENCE,identifier:i,relativePath:"resource/v1/dseng/dseng:EngItem/"+i})}),n},a.prototype.invokeMEI3DSearch=function(e){let i=this,o={};o.resourceid_not_in=e.resourceid_not_in,o.callbackMethod=e.callBack,o.title=i.NLS.manufacturer_equivalent_items,e.vendorItem?(o.typeSearch=t.TYPE_VENDOR_ITEM,o.title=i.NLS.vendor_items):(o.searchType=t.VPMREFERENCE,o.subType=t.MEI_EXTENSION,o.title=i.NLS.manufacturer_equivalent_items),o.excludeCondition=t.EXCLUDE_OBSOLETE,o.predicates=t.UTILITY_PREDICATE_SELECTORS,o.multiSel=!0,(new n).init(o)},a.prototype.processDataForContextQualifications=function(i){let n=this;return new Promise(o=>{if(e.getPlatformId()!==t.ONPREMISE){var a={id:i.data.id,title:i.data.title,source:"3dspace",state:i.data.status_value},r=n.getProxyPayload(a);n.controller.model.getProxyObjectId({data:r}).then(function(e){let t=e[i.data.id];n.processContextQualifications(t,o)})}else n.processContextQualifications(i.data.id,o)})},a.prototype.processContextQualifications=function(e,i){var n=this,o=[];n.controller.model.getContextQualificationsForMEI({id:e,includeParams:"$include=Context"}).then(function(e){if(e&&e.data&&e.data.length>0){e.data.forEach(function(e){e.relateddata&&e.relateddata.Context&&e.relateddata.Context.length>0&&e.relateddata.Context.forEach(t=>{t.target_type=e.type,o.push(t)})});var a="";if(0===o.length)i([]);else{let e="";o.forEach(function(i){e+='physicalid:"'+i.dataelements.Proxy_Id+'"'+t.OR});let i={completePreCond:e=e.substring(0,e.length-4),nresults:o.length,start:"0",with_nls:!1};a=n.searchUtil.getSearchPayload([],[],[t.SOURCE_SOURCING,t.SOURCE_3DSPACE,t.SOURCE_3DPLAN],i)}n.searchUtil.callFederatedSearch(a).then(function(e){let a=n.searchUtil.processResults(e);0===a.length&&i([]);let r=[],l=[],s=[],c=[];a.forEach(function(e){for(let[i]of o.entries()){let a=o[i];a.dataelements.Proxy_Id===e.resourceid&&(a.target_type===t.TYPE_QUALIFICATION_LIST[1]?l.push(n.getGridForRelatedItem(e)[0]):a.target_type===t.TYPE_QUALIFICATION_LIST[3]?s.push(n.getGridForRelatedItem(e)[0]):a.target_type===t.TYPE_QUALIFICATION_LIST[2]&&c.push(n.getGridForRelatedItem(e)[0]))}});l&&r.push({isHeader:!0,relIdentifier:"context",label:n.NLS.engineering_eq_qualification,contentItems:l}),s&&r.push({isHeader:!0,relIdentifier:"context",label:n.NLS.manufacturing_eq_qualification,contentItems:s}),c&&r.push({isHeader:!0,relIdentifier:"context",label:n.NLS.context_qualification,contentItems:c}),0!==r.length?(n.handleTranslations(r,i),i(r)):i(r)})}else i([])}).catch(function(){widget.notificationUtil.showError(n.NLS.err_getting_equivalent_components)})},a.prototype.getProxyPayload=function(i){var n=t.MEI_PROXY;return i.type===t.ENG_ITEM_PROXY&&(n=i.type),{data:[{id:i.id,type:n,dataelements:{"ProxyItem.Proxy_Title":i.title,"ProxyItem.Proxy_Service":i.source,"ProxyItem.Proxy_State":i.state,"ProxyItem.Proxy_Tenant":e.getPlatformId()}}]}},a.prototype.getGridForRelatedItem=function(e){return[{grid:{title:e["ds6w:label"],name:e["ds6w:identifier"],revision:e["ds6wg:revision"],modificationDate:e["ds6w:when/ds6w:modified"],owner:e["ds6w:who/ds6w:responsible"],maturity:e["ds6w:what/ds6w:status"],type:e["ds6w:what/ds6w:type"],organization:e.organization},thumbnail:e.preview_url,id:e.resourceid}]},a.prototype.handleTranslations=function(e,t){let i={"ds6w:status":[],"ds6w:type":[]};e.forEach(e=>{e.contentItems.forEach(e=>{i["ds6w:status"].push(e.grid.maturity),i["ds6w:type"].push(e.grid.type)})}),this.searchUtil.getNlsOfPropertiesValues(i).then(function(t){e.forEach(e=>{e.contentItems.forEach(e=>{e.grid.maturityDisplay=t["ds6w:status"][e.grid.maturity]?t["ds6w:status"][e.grid.maturity]:e.grid.maturity,e.grid.typeDisplay=t["ds6w:type"][e.grid.type]?t["ds6w:type"][e.grid.type]:e.grid.type,e.grid.actualType=e.grid.type})})}).finally(function(){t(e)})},a}),define("DS/ENOXComponentQualification/views/VendorItems/NewVendorItem",["DS/UIKIT/Scroller","DS/UIKIT/Mask","DS/ENOXSourcingUXInfra/xsourcingformview/ENOXSourcingForm","UWA/Core","DS/ENOXSourcingUXInfra/Constants/ENOXSourcingConstants","DS/ENOXSourcingUXInfra/SupplyNetworkSearchView/SupplyNetworkSearchController","DS/ENOXSourcingUXInfra/service/ENOXSourcingPlatformServices","i18n!DS/ENOXSourcingUXInfra/assets/nls/ENOXSourcingUXInfra","DS/ENOXSourcingUXInfra/CommonUtils/CommonUtils","DS/ENOXSourcingUXInfra/DragAndDrop/ENOXSourcingDataDragAndDrop","DS/ENOXSourcingUXInfra/components/ModalWindowWrapper/ModalWindowWrapper","DS/ENOXComponentQualification/models/VendorItems","DS/Utilities/Dom","DS/Controls/TooltipModel"],function(e,t,i,n,o,a,r,l,s,c,d,u,p,m){"use strict";var f=function(e){this.controller=e,this.NLS=e.app.i18NProvider};return f.prototype.selectCallBack=function(e){var i=this;let n=o.SERVICE_3DNETWORK,a=r.getPlatformId(),l=e[0]._options.grid.name;var c={data:[{id:e[0]._options.grid.id,type:"Company",dataelements:{name:s.getSupplierProxyName(e[0]._options.grid.id),"ProxyItem.Proxy_Title":l,"ProxyItem.Proxy_Service":n,"ProxyItem.Proxy_Tenant":a}}]};(new u).getProxyObjectId({data:c}).then(function(t){var n=document.querySelector('input[name="'+i.textfield.options.name+'"]');t&&t[e[0]._options.grid.id]?(n.setAttribute("identifier",t[e[0]._options.grid.id]),n.value=l,n.id=t[e[0]._options.grid.id]):(n.value="",n.id="",n.setAttribute("identifier",""))}).catch(function(){widget.notificationUtil.showError(i.NLS.error_getting_proxy_sourcing),vendorField.value="",vendorField.id="",vendorField.setAttribute("identifier","")}).finally(function(){i.formReference&&t.unmask(i.formReference.getModelDiv())})},f.prototype.render=function(s){this._container=s._container,s.isTokenRequired=!1,this.supplyNetworkController=new a(s),this.platformServices=s.platformServices,this.router=s.router,this._applicationChannel=s._applicationChannel;var u=this,f=void 0;u.controller.model.getUserPreferedCurrency().then(function(e){f=e.UserPreferredCurrency}).catch(function(){widget.notificationUtil.showError("error_fetching_prefered_currency")}).finally(function(){u.countryMap=widget.getAttributeRange("Country");var a=widget.getAttributeRange("Currency");let g=widget.getAttributeDefaultValue("Currency");var h=f||g;u.currencyMap=[];for(var y=0;y<a.length;y++)u.currencyMap.push({label:a[y].label,value:a[y].value,selected:a[y].value===h});var S=widget.getAttributeRange("Unit of Measure"),w=widget.getAttributeDefaultValue("Unit of Measure");u.uomMap=[];for(y=0;y<S.length;y++)u.uomMap.push({label:S[y].label,value:S[y].value,selected:S[y].value===w});var E=n.createElement("div",{id:"NewVendorItem",class:"NewVendorItem modalBodyDiv",styles:{height:"100%"}}),_=new i({fields:[{type:"text",required:!0,label:u.NLS.title,placeholder:u.NLS.enter_title,width:"100px",name:"title",errorText:l.please_enter_title,isLengthy:!1,helperText:l.length_100_limit},{type:"text",required:!0,label:u.NLS.vendor_part_number,name:"vendor_part_number",placeholder:u.NLS.enter_vendor_part_number,width:"100px",errorText:u.NLS.please_enter_vendor_part_number,isLengthy:!1,helperText:l.length_100_limit},{type:"autocompleteWithSearch",searchOptions:{type:"Company",title:"Manufacturers"},required:"true",errorText:u.NLS.please_enter_vendor,label:u.NLS.vendor,placeholder:u.NLS.placeholder,name:"vendor",nresults:20,completePreCond:"([ds6w:type]:"+o.TYPE_COMPANY+o.AND+"current:"+o.STATE_ACTIVE+")",sources:[o.SOURCE_3DSPACE],excludeCondition:'NOT([ds6w:identifier]:"Company Name")',allowChooserCallback:function(){return null!=r._platforms["3dnetwork"]},chooserCallback:async function(e,i,n){let o={nonEmphasizeInactiveSupplier:!0,collaborationPanelHide:!0},a=e.getModelDiv();t.mask(a);let r={};if(r.formReference=e,r.textfield=i,n){return await u.supplyNetworkController.manageSupplyNetworkSearch({viewOptions:{wizardOptions:void 0,viewOptions:o},field:i,maskingDiv:a},n)}u.supplyNetworkController.manageSupplyNetworkSearch({viewOptions:{wizardOptions:void 0,viewOptions:o,search_label:u.NLS.vendor_search_label,select_label:u.NLS.vendor_select_label},field:i,maskingDiv:a,selectCallback:u.selectCallBack.bind(r)})}},{type:"select",label:u.NLS.coo,name:"coo",options:u.countryMap},{type:"customNumberField",label:u.NLS.std_package_size,placeholder:u.NLS.std_package_size_placeholder,name:"std_pack_size",subtype:"Real",isLengthy:!1,value:1,minValue:0},{type:"select",label:u.NLS.currency,name:"currency",options:u.currencyMap},{type:"customNumberField",label:u.NLS.catalog_price,placeholder:u.NLS.catalog_price_placeholder,name:"catalog_price",subtype:"Real",isLengthy:!1,value:1,minValue:0},{type:"select",label:u.NLS.unit_of_measure,name:"uom",options:u.uomMap},{type:"text",label:u.NLS.part_source,placeholder:u.NLS.enter_part_source,name:"partSource",errorText:l.max_char_limit_err_msg,isLengthy:!1,helperText:l.length_100_limit},{type:"text",label:u.NLS.part_url,placeholder:u.NLS.enter_part_url,width:"40%",name:"partSourceURL",helperText:u.NLS.helper_text_part_source_url}],events:{onSubmit:async function(){var e=!0;if(this.texts.length>0){let t=this.FormValidations.charLimitValidate(this.texts),i=this.FormValidations.validateNumberField(this.numbers);t&&i||(e=!1)}if(v&&v.destroy&&e){s.formValues=_.getValues();let e=this.getField("vendor");if(e&&e.getAttribute("identifier"))if(e.getAttribute("identifier").includes("uuid")){let t=await u.getProxyObjectId(e,s);s.formValues.vendorId=t}else s.formValues.vendorId=e.getAttribute("identifier");s.formValues.mei_id=s.meiId,s.createVICallback=(()=>{v.destroy()}),u.controller.create(s)}},onChange:function(){this.texts.length>0&&this.FormValidations.charLimitValidate(this.texts)}}}).inject(E);s&&s.router&&s.router._router.getState().params&&s.router._router.getState().params.partSourceURL&&(_.getField("partSourceURL").value=s.router._router.getState().params.partSourceURL,_.getField("partSource").value=u.NLS.part_supply);let b={onDropCallback:function(e){e&&e.objectType===o.TYPE_PART_SUPPLY_FILE?u.partSupplyDropCallback(e,_):widget.notificationUtil.showError(u.NLS.only_part_supply_drop_supported)},dropStrategy:"CREATE",multiObjs:!1};b.applicationChannel=s.app._mediator.createNewChannel(),b.dropArea=_.getField("partSourceURL").getParent(),(new c).makeAreaDroppable(b);var C=n.createElement("span",{id:"modalButtonsVendorItem",class:"modal-buttons"});n.createElement("button",{type:"submit",name:"createBtn",id:"createBtn",form:"myForm",class:"btn btn-primary",text:u.NLS.create,value:u.NLS.create}).inject(C),n.createElement("button",{type:"reset",id:"closeModalBtn",class:"btn btn-default",text:u.NLS.cancel,value:u.NLS.cancel,events:{click:function(){v.hide()}}}).inject(C);var v=new d({app:{widget:widget},draggable:!0,resizable:!0,escapeToClose:!1,width:"100%",onHideCB:()=>v.destroy()}).getModal();v.show(),v.setHeader(u.NLS.new_vendor_item),E.inject(v.getBody()),C.inject(v.getFooter()),new e({element:E}).inject(v.getBody()),widget.getElement(".xSourcingForm").setAttribute("id","myForm");let I=p.generateIcon({iconName:"info wux-ui-3ds",className:"infoIcon",tooltipInfos:new m({shortHelp:u.NLS.manufacturer_info})});E.getElement("#myForm")&&I.inject(E.getElement("#myForm").getChildren()[2].getChildren()[0]),n.createElement("span",{text:" "}).inject(I,"before")})},f.prototype.partSupplyDropCallback=function(e,t){t.elements.container.getChildren().map(function(t){let i=t.getElementsByTagName&&t.getElementsByTagName("input")[0];i&&"partSourceURL"===i.name?i.value=e.opApi.url:i&&"partSource"===i.name&&(i.value=that.NLS.part_supply)})},f.prototype.getProxyObjectId=async function(e,t){let i=new u,n=o.SERVICE_3DNETWORK,a=r.getPlatformId();var l={data:[{id:e.getAttribute("identifier"),type:"Company",dataelements:{name:s.getSupplierProxyName(e.getAttribute("identifier")),"ProxyItem.Proxy_Title":t.formValues.vendor,"ProxyItem.Proxy_Service":n,"ProxyItem.Proxy_Tenant":a}}]};let c=await i.getProxyObjectId({data:l});return c&&c[e.getAttribute("identifier")]?c[e.getAttribute("identifier")]:""},f}),define("DS/ENOXComponentQualification/views/Admin/AdminPanel",["UWA/Class/View","DS/Controls/Tab","DS/ENOXComponentQualification/views/ManufacturerEquivalentItem/ListManufacturerMigration"],function(e,t,i){"use strict";let n;return e.extend({name:"admin-panel",tagName:"div",className:function(){return this.getClassNames("-container")},setup:function(e){if(!e.app)throw new Error("Controller must provide application handler");this.controller=e,this.app=e.app,n=this.app.i18NProvider,this.helper=e.helper,this.eventBroker=this.app._applicationChannel,this.tab=new t({displayStyle:"strip"}),this.migrationView=new i(this.controller);let o=UWA.createElement("div",{styles:{height:"100%"}});this.migrationView.render().inject(o),this.tab.add({index:0,label:n.migrate_manufacturers,content:o,isSelected:!0,icon:{iconName:"database-migration ",fontIconFamily:WUXManagedFontIcons.Font3DS}})},render:function(){return this.tabContainer=UWA.createElement("div",{id:"tab"}),this.tab.inject(this.tabContainer),this.tabContainer.inject(this.container),this},updateModel:function(e){this.migrationView.updateModel(e)}})}),define("DS/ENOXComponentQualification/ENOXComponentQualification",["DS/ENOXSourcingUXInfra/service/ENOXSourcingPlatformServices","DS/ENOXComponentQualification/components/Triptych/TriptychWrapper","DS/ENOXComponentQualification/components/ApplicationTopBar/ApplicationTopBarWrapper","DS/ENOXSourcingUXInfra/xSourcingRouter/xSourcingRouter","DS/ENOXSourcingUXInfra/components/WelcomePanel/WelcomePanelWrapper","DS/Notifications/NotificationsManagerUXMessages","DS/Notifications/NotificationsManagerViewOnScreen","DS/Handlebars/Handlebars","DS/ENOXSourcingUXInfra/ENOXSourcingExtensionManager","DS/ENOXComponentQualification/config/appConfigurator","DS/ENOXComponentQualification/config/routerConfig","WebappsUtils/WebappsUtils","DS/ENOXSourcingUXInfra/controllers/xSourcingBootstrapController","text!DS/ENOXComponentQualification/ENOXComponentQualification_template.html","DS/ENOXSourcingUXInfra/TNProxyImpl/SourcingTNProxy","DS/ENOXSourcingUXInfra/UpdateWidgetTitle/UpdateWidgetTitle","DS/ENOXSourcingUXInfra/DragAndDrop/ENOXSourcingDataDragAndDrop","DS/ENOXSourcingUXInfra/Utilities/Utility","DS/ENOXSourcingUXInfra/ENOXSourcingLogger","DS/Windows/ImmersiveFrame","DS/ENOXSourcingUXInfra/NotificationsUtil/NotificationsUtil","DS/ENOXSourcingUXInfra/Mediator","DS/ENOXSourcingUXInfra/extensions/ENOXSourcingi18nProvider","DS/ENOXSourcingUXInfra/Constants/ENOXSourcingConstants","DS/ENOXSourcingUXInfra/Utilities/Menu","DS/ENOXSourcingUXInfra/JSCacheBust/JSCacheBust","DS/ENOXSourcingUXInfra/AttributeRange/AttributeRange","css!DS/ENOXComponentQualification/ENOXComponentQualification.css"],function(e,t,i,n,o,a,r,l,s,c,d,u,p,m,f,g,h,y,S,w,E,_,b,C,v,I,N){"use strict";var x=new g;const D=d;var T={onLoad:function(e){I.onLoad(e,T.loadApp.bind(T))},loadApp:async function(){widget.body.empty(),widget.setIcon(u.getWebappsAssetUrl("ENOXComponentQualification","icons/ENOVIA_WIDGET_Favicon.png"));var e=T;e.widget=widget,widget.app=e,e.configurator=c,e._utility=new y,e._utility.initializeGlobalMethods(),e.initializeGlobalMethods(),e.i18NProvider=await b.initialize(e),e.logger=new S(e),e.logname="ENOXComponentQualification",e.immersiveFrame=(new w).inject(widget.body),widget.notificationUtil=E,e._mediator=new _,e._applicationChannel=e._mediator.getApplicationBroker(),e.taggerProxy=new f,this.notifs=a,window.notifs=this.notifs,r.setNotificationManager(this.notifs),e.setPreferences(),e._initTriptychAndToolbar(),e.mandatoryStartupPromises=[],e.extManager=new s(e,"DS/ENOXSourcingUXInfra/extensions/"),e.mainController=new p(e),e.use("ENOXSourcingViewControllerProvider"),e.use("ENOXSourcingDataProvider"),e.use("ENOXSourcingControllerProvider"),e.use("ENOXSourcingRouteControllerProvider"),UWA.Promise.all([e.extManager.init()]).then(function(){UWA.Promise.all(e.mandatoryStartupPromises).then(function(){e._initWelcomePanel(),e._initPlatformServices()})})},onRefresh:function(){if(T.router){var t=T.router._router.getState().name,i=T.router._router.getState().params;i.isRefresh=!0,T.router.navigate(t,i,{reload:!0})}else T._initPlatformServices();v.hide(),e.setCredentialPreference()},endEdit:function(){T.logger.setLevel(widget.getValue("debug")?S.LEVEL.DEBUG:S.LEVEL.ERROR)},onResize:function(){var e=T.router?T.router.getRouter().getState().name:"";let t=T.router._routes.filter(e=>"detailsViewRouteController"===e.routeController).map(e=>e.name);widget.body.offsetWidth>550&&!t.includes(e)?T._applicationChannel.publish({event:"welcome-panel-expand"}):T._applicationChannel.publish({event:"triptych-hide-panel",data:"left"})},_initTriptychAndToolbar:function(){this._applicationContainer=UWA.createElement("div"),this._applicationContainer.classList.add("xCS-application"),widget.body.appendChild(this._applicationContainer),this._triptychWrapper=new t,this._pageToolBarComponent=new i;var e=UWA.createElement("div");e.innerHTML=l.compile(m)(),e=e.firstChild,this._applicationContainer.appendChild(e),this._mainPanelApplicationContent=e.querySelector(".xCS-content"),this._triptychWrapper.init(this._applicationChannel,this._mainPanelApplicationContent),this._pageToolBarComponent.init(this._applicationChannel,this._triptychWrapper,this.i18NProvider),this._middleContainer=document.createElement("div"),this._middleContainer.appendChild(this._triptychWrapper.getMainPanelContainer()),this._applicationChannel.publish({event:"triptych-set-content",data:{side:"middle",content:this._middleContainer}})},reactivateWP:function(){widget.setRefreshViewParams("xpflLastVisitedRoute",JSON.stringify({name:"home.ManufacturerEquivalentItems"})),T.router.navigate("home.ManufacturerEquivalentItems"),T._applicationChannel.publish({event:"welcome-panel-expand"})},deactivateWP:function(){},_initRouter:function(){var e=this;n.addRouteMethods("home",{}),n.setDependency("app",this),widget.setRefreshViewParams("xpflLastVisitedRoute",JSON.stringify({route:widget.getValue("defaultRoute")}));var t=JSON.parse(widget.getRefreshViewParams("xpflLastVisitedRoute"));null!=t&&t.name||(t={},widget.setRefreshViewParams("xpflLastVisitedRoute",JSON.stringify({name:widget.getValue("defaultRoute")})),t.route=widget.getValue("defaultRoute")),n.setDependency("app",this),n.start(function(){var i=decodeURIComponent(top.location.href).split("X3DContentId=");if(i&&2===i.length){i[1].includes("/fullscreen")&&(i[1]=i[1].split("/fullscreen")[0]);var n=JSON.parse(i[1]);e.dataControllers.qualificationController.decideRouteUsingURL(n)}else T.router.navigate(t.route,{id:t.objectId?t.objectId:"",name:t.viewName?t.viewName:""})})},_initWelcomePanel:function(){var t=T.configurator.welcomePanelActivities;t[0].actions.find(e=>"NewSourcedItem"===e.id).callback=function(){T.dataControllers.meiController.newMEI(a)},this._welcomePanelComponent=new o,T._triptychWrapper.getLeftPanelContainer().innerHTML="";var i="";i="OnPremise"===e.getPlatformId()?"ENXSpiqUserMap/enxspiq-c-ov.htm":"ENXSpiqUserCloudMap/enxspiq-c-ov.htm";var a={title:C.SUPPLIER_ITEM_QUALIFICATION,description:T.i18NProvider.welcome_message,activities:t,eventBroker:T._applicationChannel,container:T._triptychWrapper.getLeftPanelContainer(),router:n,userAssistnceLink:i,trainingLink:"ENXSpiqUserCloudMap/enxspiq-c-ov.htm",app:T};this._welcomePanelComponent.init(a)},onSearch:function(){},use:function(e){return T.extManager.add({ref:e,context:T}),T},_initPlatformServices:function(){e.getPlatformServices(T).then(function(e){T.platformServices=e,x.init(T),T._applicationChannel.publish({event:"platform-service-ready",data:T}),n.initialize(D),T.router=n,T.mainController.initialize(),T.reorderPreferences(),T._initRouter();let t=C.RANGE_ATTRIBUTES.split(",");N.getAttributeRange(t).then(function(e){T._utility.sortArrayAlphabeticallyBasedOnProperty(e.Country.rangeMap,"value"),T._utility.sortArrayAlphabeticallyBasedOnProperty(e.Currency.rangeMap,"value"),e.Currency.defaultValue="Dollar",widget.app.attributeRange=e})},function(){T.logger.warn("Skipping Security Context and CSRF Token retrieval")})},reorderPreferences:function(){let e=widget.getPreferences(),t=e.findIndex(e=>"SC"===e.name);-1!==t&&(e.splice(0,0,e.splice(t,1)[0]),widget.setPreferences(e))},setPreferences:function(e){return widget.setPreferences(e||T.configurator.widgetPreferences)},_initDroppable:function(e){T.dropStrategy="OPEN",T.onDropCallback=T.dropCallBack,T.dropArea=e||T._triptychWrapper.getMainPanelContainer(),(new h).makeAreaDroppable(T)},isAdmin:function(){let e=widget.getPreference("SC");return!!(e&&e.options&&e.options instanceof Array)&&e.options.some(e=>e.value.contains("VPLMAdmin."))},initializeGlobalMethods:function(){widget.getAttributeRange=function(e){if(!widget.app.attributeRange[e])return[];let t=widget.app.attributeRange[e].rangeMap;return t||(t=[]),t},widget.getAttributeDefaultValue=function(e){if(!widget.app.attributeRange[e])return[];let t=widget.app.attributeRange[e].defaultValue;return t||(t=[]),t},widget.getRangeValueNLS=function(e,t){if(!widget.app.attributeRange[e])return t;let i=widget.app.attributeRange[e].nls[t];return i||(i=t),i},widget.getCurrencyShortValue=function(e){return widget.getRangeValueNLS("Currency",e).split("-",1)[0]}}};return T}),define("DS/ENOXComponentQualification/helpers/QualificationHelper",["DS/ENOXSourcingUXInfra/service/ENOXSourcingPlatformServices","DS/ENOXSourcingUXInfra/service/ENOXSourcingService","DS/ENOXComponentQualification/components/CustomTweakers/ENOXColorTextfieldTweaker","DS/ENOXSourcingUXInfra/Constants/ENOXSourcingConstants","DS/UIKIT/Mask","DS/ENOXSourcingUXInfra/Search/SearchUtility","DS/ENOXSourcingUXInfra/openwithservice/ENOXSourcingOpenWithService","DS/ENOXSourcingUXInfra/Search/ENOXSourcingSearch","i18n!DS/ENOXSourcingUXInfra/assets/nls/ENOXSourcingUXInfra"],function(e,t,i,n,o,a,r,l,s){"use strict";var c=function(e){this.searchUtil=new a,this.NLS=e.i18NProvider};return c.prototype.process1=function(e,t){var i=this;return this.totalTime=performance.now(),new Promise(n=>{if(e.data){var o=[];e.data.map(e=>{var t=e.relateddata.Context?e.relateddata.Context[0]:null,i=e.relateddata.target?e.relateddata.target[0]:null;t&&!o.includes(t.dataelements.Proxy_Id)&&o.push(t.dataelements.Proxy_Id),i&&!o.includes(i.dataelements.Proxy_Id)&&o.push(i.dataelements.Proxy_Id)}),o.length>0?n(i.dataProcessor(e,t)):n([])}else n([])})},c.prototype.getTargetDetails=function(e,t,i){let n={};return n.postData=i.preparePayloadTargetLocate(e),t.getTargetDetails(n)},c.prototype.getFormattedRevision=function(e){var t=e["ds6w:label"]?e["ds6w:label"]:"";return t&&e["ds6wg:revision"]&&(t=t+" ("+e["ds6wg:revision"]+")"),t},c.prototype.getFormattedRevisionDB=function(e){if(!e)return"";var t=e.dataelements.Title?e.dataelements.Title:e.dataelements.Proxy_Title?e.dataelements.Proxy_Title:e.dataelements.name?e.dataelements.name:"";return t&&e.dataelements.Revision&&(t=t+" ("+e.dataelements.Revision+")"),t},c.prototype.getContextType=function(e){let t=e["ds6w:what/ds6w:type"],i=this;return t===n.VPMREFERENCE&&e["ds6w:what/ds6w:kind"]===n.MEI_EXTENSION?i.NLS.manufacturer_equivalent_item:t===n.TYPE_PROJECT_SPACE?i.NLS.project:t===n.TYPE_PLANT?i.NLS.plant:t===n.TYPE_MODEL?i.NLS.product:t===n.VPMREFERENCE?i.NLS.engineering_item:""},c.prototype.processRelatedQualifications=function(e,t){var i=this;return new Promise(n=>{e.data?n(i.dataProcessor(e,{},t)):n([])})},c.prototype.dataProcessor=function(e,t,i=[]){var o=this;var a=e.data.filter(e=>"SRC Usage Qualification"!==e.dataelements.type).map(e=>{var t=e.relateddata.Context?e.relateddata.Context[0]:null,a=e.relateddata.target?e.relateddata.target[0]:null;let r="",l=[],s="",d="";e.relateddata.PreReq&&e.relateddata.PreReq.length>0&&(r=e.relateddata.PreReq[0].id,s=e.relateddata.PreReq[0].dataelements.name,d=e.relateddata.PreReq[0].dataelements.Revision),e.relateddata.prereqof&&e.relateddata.prereqof.length>0&&e.relateddata.prereqof.forEach(e=>{l.push(e.id)});let u="",p=e.relateddata.Context;(e.type===n.TYPE_QUALIFICATION_LIST[1]||e.type===n.TYPE_QUALIFICATION_LIST[3])&&p&&p[0]&&(u=p[0].type?p[0].type:p[0].dataelements.type);let m="";p.length>0&&(m=i.filter?i.filter(e=>p[0].dataelements.Proxy_Id===e.id):"");let f=p.length>0?p[0].dataelements.Revision:"";var g={id:e.id,type:e.type,qual_type:e.type,qualId:e.id,typeNLS:o.NLS[e.type],displayType:o.NLS[e.type],actualType:e.type,qualificationType:e.type,contextType:m.length>0?m[0].typeNLS:c.prototype.getContextTypeForContextQualification.call(o,e),contextTypeActual:u,contextRevision:f,preReqOfIDs:l,preReqId:r,preReqName:s?s+" ("+d+")":"",name:e.dataelements.name,tree:e.dataelements.name,revision:e.dataelements.revision,maturityState:e.dataelements.state,qualificationMaturityDisplay:o.NLS[e.dataelements.state],qualificationMaturity:e.dataelements.state,preferred:e.type===n.TYPE_QUALIFICATION_LIST[0]?"":e.dataelements["SRC Preferred"],preferredDisplay:e.type===n.TYPE_QUALIFICATION_LIST[0]?"":"TRUE"===e.dataelements["SRC Preferred"]?o.NLS.yes:o.NLS.no,orderable:e.dataelements["SRC Is Orderable"],isOrderable:e.dataelements["SRC Is Orderable"],comments:e.dataelements["SRC Comments"],restriction:e.dataelements.Restriction,qualificationComments:e.dataelements["SRC Comments"],description:e.dataelements.description,modifyAccess:e.dataelements.modifyAccess,deleteAccess:e.dataelements.deleteAccess,changeAccess:e.dataelements.changesov,owner:e.dataelements.owner,ownerIdentifier:e.dataelements.ownerIdentifier,modified:e.dataelements.modified,created:e.dataelements.originated,lastTimeBuy:e.dataelements["Last Time Buy"],manufacturer_part_number:"",mei_title:"",manufacturer:"",enterpriseItem:o.getFormattedRevisionDB(t),engRevision:t?t.dataelements.Revision:"",thumbnail:require.toUrl("ENOXComponentQualification/assets/icons/Qualification-Thumbnail.png"),image:require.toUrl("ENOXComponentQualification/assets/icons/Qualification-Thumbnail.png"),mei_id:a?a.dataelements.Proxy_Id:"",mei_proxy_id:a?a.id:"",eng_id:t?t.dataelements.Proxy_Id:"",approved:e.dataelements["SRC Approved"],approvedDisplay:o.NLS[e.dataelements["SRC Approved"]],effectivityStartDate:e.dataelements["Effectivity Start Date"],effectivityEndDate:e.dataelements["Effectivity End Date"],isProofExists:e.dataelements.isProofExists,collabSpace:e.dataelements.collabSpace,organization:e.dataelements.organization,mei_proxy_title:a&&a.dataelements.Proxy_Title?a.dataelements.Proxy_Title:"",qualtitle:e.dataelements.title};if(a&&(g.manufacturer_part_number=a.dataelements["Part Number"],g.mei_title=a.dataelements.Title?a.dataelements.Title:a.dataelements.Proxy_Title,g.manufacturer=a.dataelements["Manufacturer Name"]),e.relateddata["context-restrictions"]&&e.relateddata["context-restrictions"].length>=0){let t=[];e.relateddata["context-restrictions"].forEach(e=>{let i=e.dataelements.Proxy_Title?e.dataelements.Proxy_Title:e.dataelements.Title?e.dataelements.Title:e.dataelements.name,n=e.dataelements.Revision?`(${e.dataelements.Revision})`:"";t.push({id:e.dataelements.Proxy_Id,typeSource:e.dataelements.Proxy_Service,title:`${i} ${n}`,type:e.type,tenant:e.dataelements.Proxy_Tenant,revision:e.dataelements.Revision})}),g.contextRestrictions=t,g.contextRestrictonsLength=e.relateddata["context-restrictions"].length}var h=e.relateddata["interface-details"];if(h&&h.length>0){var y=[];h.forEach(function(e){var t={label:e.dataelements.displayName?e.dataelements.displayName:e.dataelements.description?e.dataelements.description:e.id,options:e.children,name:e.id};y.push(t)}),g.extensionDetails=y}var S=[{label:o.NLS.title,data:g.qualtitle},{label:o.NLS.name,data:g.name},{label:o.NLS.maturity_state,data:g.qualificationMaturityDisplay?g.qualificationMaturityDisplay:g.maturityState},{label:o.NLS.revision,data:g.revision},{label:o.NLS.comments,data:g.comments},{label:o.NLS.manufacturer_equivalent_item,data:g.mei_title?g.mei_title:""},{label:i.isVendorItemQual?o.NLS.manufacturering_item:o.NLS.engineering_item,data:g.enterpriseItem?g.enterpriseItem:""},{label:o.NLS.context_restrictions,data:g.eqContextRestrictions}],w={grid:g,label:g.name,subLabel:g.qualificationMaturityDisplay,thumbnail:g.thumbnail,description:g.revision,tooltip:S,id:g.id};if(g.comments&&(w.description+="|"+g.comments),i.isVendorItemQual){let e,t="";"Yes"===g.approved?(e="check",t=o.NLS.approved):"No"===g.approved?(e="wrong",t=o.NLS.rejected):""===g.approved&&(e="clock",t=o.NLS.pending);let i=UWA.createElement("div"),n=UWA.createElement("div",{name:"CompanyLabel"});UWA.createElement("span",{class:"xsourcing-company-icon fonticon fonticon-fonticon fonticon-"+e}).inject(n),UWA.createElement("span",{class:"xsourcing-company-name",text:t}).inject(n),n.inject(i),w={grid:g,label:g.qualtitle+" | "+g.name+" | "+g.revision+" | "+g.qualificationMaturityDisplay,subLabel:i,description:m[0].title+" | "+m[0].revision+" | "+m[0].stateNLS,thumbnail:g.thumbnail,tooltip:S,id:g.id,context_id:m[0].id,statusbarIcons:["badge",{label:g.restriction}],statusbarIconsTooltips:o.NLS.restriction}}return w});return t&&t.fromQualificationList&&(a=a.filter(function(e){return void 0!==e.grid.mei_title})),a},c.prototype.getActualDataFromSearch=function(e,t){if(!e.results)return{};var i=e.results.filter(e=>{return e.attributes.filter(e=>"resourceid"===e.name&&e.value===t).length>0}),n={};return i.length>0&&i[0].attributes.forEach(e=>{e.dispValue?n[e.name]=e.dispValue:n[e.name]=e.value}),n},c.prototype.getActualDataForTarget=function(e,t){var i=[];return e&&e.member&&(i=e.member.filter(e=>e.id===t)),i},c.prototype.getSearchPayload=function(t,i){var o=i?'flattenedtaxonomies:"types/'+i+'"':'flattenedtaxonomies:"types/'+n.VPMREFERENCE+'" OR "types/'+n.TYPE_PLANT+'" OR "types/'+n.TYPE_PROJECT_SPACE+'" OR "types/'+n.TYPE_MODEL+'" OR '+n.DELFMIFUNCTIONREFERENCE_QUERY;return{nresults:t.length>1e3?999:t.length,label:"test",with_nls:!1,locale:widget.lang,select_predicate:["ds6w:label","physicalid","name","ds6w:description","ds6w:identifier","ds6w:status","ds6w:created","ds6w:modified","ds6w:responsible","ds6w:who/ds6w:responsible/ds6w:manufacturer","ds6wg:EnterpriseExtension.V_PartNumber","bo.ManufacturerEquivalentItemExtension.ManufacturerName","ds6wg:ManufacturerEquivalentItemExtension.ManufacturerPartNumber","ds6wg:revision","partnumber","ds6w:type"],select_file:["icon","thumbnail_2d"],query:o,source:["3dspace"],tenant:e.getPlatformId(),resourceid_in:t}},c.prototype.getEditAccess=function(e){return!(!e||"true"!==e.toLowerCase())},c.prototype.getProxyPayload=function(t){var i=n.MEI_PROXY;return t.type===n.ENG_ITEM_PROXY&&(i=t.type),{data:[{id:t.id,type:i,dataelements:{"ProxyItem.Proxy_Title":t.title,"ProxyItem.Proxy_Service":t.source,"ProxyItem.Proxy_State":t.state,"ProxyItem.Proxy_Tenant":e.getPlatformId()}}]}},c.prototype.qualificationLifeCycleLaunch=function(e,t){var i,n;if(i=t.objId,n=t.type,void 0===i)return;var o={data:{params:{qualificationId:i,type:n},respParams:{id:i,type:n},qualificationId:i},applicationChannel:this.model?this.model.get("applicationChannel"):this.controller.app._applicationChannel};o._mediator=this.model?this.model.get("mediator"):this.controller.app._mediator;var a="/resources/v1/modeler/dssourcing/qualifications/generalqualifications";"SRC Engineering Equivalent Qualification"===n?a="/resources/v1/modeler/dssourcing/qualifications/equivalentqualifications":"SRC Usage Qualification"===n&&(a="/resources/v1/modeler/dssourcing/qualifications/usagequalifications");var r={data:[{id:i,physicalid:i,type:n,identifier:i,source:"Sourcing",relativePath:a}]};o.getLifecycleData=r,o.updateTableFunction=function(i){if(i&&i.grid){var n={[t.maturity_index]:i.grid.qualificationMaturity,[t.maturity_index_display]:i.grid.qualificationMaturityDisplay};t.modifyAccess?n[t.modifyAccess]=i.grid.modifyAccess:(n.modifyAccess=i.grid.modifyAccess,n.maturityState=i.grid.qualificationMaturity),e.updateOptions({grid:n})}},(this.model?this.model.get("openQualification").getQualificationLifeCycleUI(o):this.options.openQualification.getQualificationLifeCycleUI(o)).render()},c.prototype.addingTypeRepresentations=function(e){var t={callBack:e.lifecycleCallback},n=new i;n.createTypeRepresentation(e.collectionView._xsourcingCollectionViewUI._dataGridView,n.getColorCodeArray(),t);e.collectionView._model.setUseChangeTransactionMode(!0),e.collectionView._xsourcingCollectionViewUI._dataGridView.getTypeRepresentationFactory().registerTypeRepresentations(JSON.stringify({Qualification:{},ENOXSourcing_QualificationStatusType:{inlinedTemplate:"statusView",stdTemplate:"statusView"}})),e.collectionView._xsourcingCollectionViewUI._dataGridView.getTypeRepresentationFactory().registerTypeRepresentations(JSON.stringify(this.addDropDownTypeRepresentation("preferredDropDown",[{value:"TRUE",label:this.NLS.yes},{value:"FALSE",label:this.NLS.no}]))),e.collectionView._xsourcingCollectionViewUI._dataGridView.getTypeRepresentationFactory().registerTypeRepresentations(JSON.stringify(this.addDropDownTypeRepresentation("statusDropDown",[{label:"",value:""},{value:"Yes",label:this.NLS.yes},{value:"No",label:this.NLS.no}])))},c.prototype.addDropDownTypeRepresentation=function(e,t){return{[e]:{stdTemplate:"enumCombo",semantics:{valueType:"enumString",possibleValues:t}}}},c.prototype.processReviseObjectsToConnect=function(e,t){let i=this,o={reviseConfirmationMessage:"Unhandled case! Please contact administrator"},a=n.TYPE_QUALIFICATION_LIST[1]===t,r=n.TYPE_QUALIFICATION_LIST[2]===t,l=n.TYPE_QUALIFICATION_LIST[3]===t;return t===n.TYPE_QUALIFICATION_LIST[0]?(o.objectToConnect=["target"],o.reviseConfirmationMessage=i.NLS.qual_revise_confirmation_Target):e===n.MEI_DETAILS_PAGE_ROUTE?(o.objectToConnect=a?["context"]:["context","prereq"],o.reviseConfirmationMessage=a?i.NLS.qual_revise_confirmation_Context:i.NLS.qual_revise_confirmation_CtxPrereq):e!==n.ENG_ITEM_DETAILS_PAGE_ROUTE&&e!==n.MFG_ITEM_DETAILS_PAGE_ROUTE||(r?(o.objectToConnect=["target","context"],o.reviseConfirmationMessage=i.NLS.qual_revise_confirmation_TargetCtx):(a||l)&&(o.objectToConnect=["target"],o.reviseConfirmationMessage=i.NLS.qual_revise_confirmation_Target)),o},c.prototype.getRevisePayload=function(e){return{data:[{id:e,dataelements:{securityContext:t.getSecurityContext()}}]}},c.prototype.getContextTypeForContextQualification=function(e){let t=this,i=e.relateddata.Context[0];return i&&i.type===n.TYPE_PROJECT_SPACE_ITEM_PROXY||i&&i.type===n.TYPE_PROJECT_SPACE?t.NLS.project:i&&i.type===n.TYPE_PLANT_ITEM_PROXY||i&&i.type===n.TYPE_PLANT?t.NLS.plant:i&&i.type===n.TYPE_MODEL_PROXY||i&&i.type===n.TYPE_MODEL_VERSION_PROXY||i&&i.type===n.TYPE_MODEL||i&&i.type===n.TYPE_MODEL_VERSION?t.NLS.product:i&&i.type===n.ENG_ITEM_PROXY||i&&i.type===n.VPMREFERENCE||i&&i.dataelements.type===n.ENG_ITEM_PROXY?t.NLS.physical_product:i&&i.type?i.type:""},c.prototype.maskQualificationTable=function(e){let t="usage"===e.type?this.NLS.loading_usage_qualifications:"equivalent"===e.type?this.NLS.loading_equivalent_qualifications:this.NLS.loading_general_qualifications;e.externalContainer?o.mask(e.externalContainer,t):o.mask(widget.body,t)},c.prototype.appendOpenWithMenu=function(t){let i=this,o=t.menu,a=t.model,l=t.columnModel;return a.options.grid.contextTypeActual!==n.TYPE_PLANT&&a.options.grid.contextTypeActual!==n.TYPE_PLANT_ITEM_PROXY&&a.options.grid.contextTypeSource!==n.SOURCE_3DPLAN||"enterpriseItem"!==l.dataIndex?(l&&("mei_title"===l.dataIndex||"enterpriseItem"===l.dataIndex?(a={options:{grid:{id:"mei_title"===l.dataIndex?a.options.grid.mei_id:a.options.grid.eng_id,actualType:"mei_title"===l.dataIndex?n.VPMREFERENCE:a.options.grid.contextTypeActual,title:"mei_title"===l.dataIndex?a.options.grid.mei_title:a.options.grid.enterpriseItem,additionalDragData:{objectTaxonomies:"mei_title"===l.dataIndex?[n.MEI_EXTENSION]:[]}}}},e.getPlatformId()!==n.ON_PREMISE&&-1!==a.options.grid.actualType.toUpperCase().indexOf("PROXY")&&n.PROXY_TYPE_TO_ACTUAL_MAPPER[a.options.grid.actualType]&&(a.options.grid.actualType=n.PROXY_TYPE_TO_ACTUAL_MAPPER[a.options.grid.actualType])):"preReqName"===l.dataIndex&&(a={options:{grid:{id:a.options.grid.preReqId,actualType:n.TYPE_QUALIFICATION_LIST[1],title:a.options.grid.preReqName}}})),r.getOpenWithMenu(a).then(function(e){return o.push({id:"OpenWith",type:"PushItem",title:i.NLS.open_with,icon:"open-menu-dot",submenu:e}),o},function(){return o})):o},c.prototype.processDataForRelationsTab=function(e){return new Promise(t=>{let i=this,o=[],a=[],r=e.data.mei_id,l=e.data.eng_id,c=e.data.contextTypeSource;r&&o.push(r),c===n.SOURCE_3DPLAN?a.push(l):l&&o.push(l),e.data.contextRestrictions&&e.data.contextRestrictions.forEach(e=>{e.typeSource===n.SOURCE_3DPLAN?a.push(e.id):o.push(e.id)}),e.data.qualificationProofs&&e.data.qualificationProofs.forEach(e=>{o.push(e.id)});let d="";a.forEach(e=>{d+='uri:"'+e+'"'+n.OR}),o.forEach(e=>{d+='physicalid:"'+e+'"'+n.OR});let u={completePreCond:d=d.substring(0,d.length-4),nresults:a.length+o.length,start:"0",with_nls:!1},p=i.searchUtil.getSearchPayload([],[],[n.SOURCE_SOURCING,n.SOURCE_3DSPACE,n.SOURCE_3DPLAN],u);i.searchUtil.callFederatedSearch(p).then(function(n){let o=i.searchUtil.processResults(n);0===o.length&&t([]);let a=[];o.forEach(function(e){let t="",n="";e.resourceid===r&&(n="target",t=i.NLS.qualification_target),e.resourceid===l&&(t=i.NLS.qualification_context,n="context"),t&&a.push({isHeader:!0,relIdentifier:n,label:t,contentItems:i.getGridForRelatedItem(e)})});let c=i.NLS.context_restrictions,d="ctxRestriction",u=[];e.data.contextRestrictions&&e.data.contextRestrictions.forEach(function(e){let t=o.filter(t=>t.resourceid===e.id);t.length>0&&u.push(i.getGridForRelatedItem(t[0])[0])}),u.length>0&&a.push({isHeader:!0,relIdentifier:d,label:c,contentItems:u}),c=s.qualification_proofs,d="qualificationProofs";let p=[];e.data.qualificationProofs&&e.data.qualificationProofs.forEach(function(e){let t=o.filter(t=>t.resourceid===e.id);t.length>0&&p.push(i.getGridForRelatedItem(t[0])[0])}),p.length>0&&a.push({isHeader:!0,relIdentifier:d,label:c,contentItems:p}),0!==a.length?i.handleTranslations(a,t):t(a)})})},c.prototype.handleTranslations=function(e,t){let i={"ds6w:status":[],"ds6w:type":[]};e.forEach(e=>{e.contentItems.forEach(e=>{i["ds6w:status"].push(e.grid.maturity),i["ds6w:type"].push(e.grid.type)})}),this.searchUtil.getNlsOfPropertiesValues(i).then(function(t){e.forEach(e=>{e.contentItems.forEach(e=>{e.grid.maturityDisplay=t["ds6w:status"][e.grid.maturity]?t["ds6w:status"][e.grid.maturity]:e.grid.maturity,e.grid.typeDisplay=t["ds6w:type"][e.grid.type]?t["ds6w:type"][e.grid.type]:e.grid.type})})}).finally(function(){t(e)})},c.prototype.getGridForRelatedItem=function(e){return[{grid:{title:e["ds6w:label"],name:e["ds6w:identifier"],revision:e["ds6wg:revision"],modificationDate:e["ds6w:when/ds6w:modified"]?e["ds6w:when/ds6w:modified"]:e["ds6w:modified"],owner:e["ds6w:who/ds6w:responsible"]?e["ds6w:who/ds6w:responsible"]:e["ds6w:responsible"],maturity:e["ds6w:what/ds6w:status"]?e["ds6w:what/ds6w:status"]:e["ds6w:status"],type:e["ds6w:what/ds6w:type"]?e["ds6w:what/ds6w:type"]:e["ds6w:type"],actualType:e["ds6w:what/ds6w:type"]?e["ds6w:what/ds6w:type"]:e["ds6w:type"],organization:e.organization},thumbnail:e.preview_url,id:e.resourceid}]},c.prototype.invoke3DSearchOfItemsForContextQualificationCreation=function(e){let t={resourceid_not_in:[]};t.callbackMethod=e.callBack,t.typeSearch=e.type,t.title=e.commandLabel,e.type===n.VPMREFERENCE?t.excludeCondition=n.EXCLUDE_MEI+n.AND+n.EXCLUDE_OBSOLETE:e.type===n.TYPE_PROJECT_SPACE?(t.typeSearch=n.TYPE_PROJECT_SPACE+'"'+n.OR+'[dsplan:type]:"'+n.DSPLAN_PROJECT,t.excludeCondition=n.EXCLUDE_COMPLETE+n.AND+n.EXCLUDE_ARCHIVE):e.type===n.TYPE_PLANT?t.excludeCondition=n.EXCLUDE_INACTIVE:e.type===n.TYPEMODEL&&(delete t.typeSearch,t.completePreCond="("+n.FLATTENEDTAXONOMIES+'"'+n.TYPEMODEL+'"'+n.OR+n.FLATTENEDTAXONOMIES+'"'+n.TYPEMODELVERSION+'")'+n.AND+n.EXCLUDE_INACTIVE+n.AND+n.EXCLUDE_OBSOLETE),e.contextItemsData.forEach(e=>{e.source!==n.SOURCE_3DSPACE?t.excludeCondition+=n.AND+n.NOT+' uri:"'+e.id+'"':t.resourceid_not_in.push(e.id)}),(new l).init(t)},c.prototype.getEQCreationPayload=function(e,t,i,o){return{data:[{type:i?n.SYMBOLIC_TYPE_SRC_MANUFACTURING_EQUIVALENT_QUALIFICATION:n.SYMBOLIC_TYPE_SRC_EQUIVALENT_QUALIFICATION,dataelements:{Target_ID:e,Context_ID:t,"attribute_SRCQUALIFICATION.Preferred":n.FALSE,contextRestrictions:o}}]}},c.prototype.processFedSearchData=function(e){if(!e.results)return[];let t=[];return e.results.forEach(e=>{let i={};e.attributes.forEach(e=>{e.dispValue?(i[e.name]=e.dispValue,e.dispValue!==e.value&&(i[e.name+"_value"]=e.value)):i[e.name]=e.value}),t.push(i)}),t},c.prototype.getTypeFromTypeHierarchy=function(e,t,i){let n="";return e.length<1||i.includes(t)?n=t:e.forEach(function(e){i.includes(e)&&(n=e)}),n},c.prototype.getCopyQualificationPayload=function(e){return{data:[{id:e.id,dataelements:{securityContext:t.getSecurityContext(),Target_ID:e.Target_ID}}]}},c}),define("DS/ENOXComponentQualification/views/ManufacturerEquivalentItem/ListManufacturerEquivalentItems",["DS/ENOXSourcingUXInfra/xsourcingCollectionView/xsourcingCollectionView","DS/UIKIT/Mask","DS/ENOXSourcingUXInfra/TNProxyImpl/SourcingTNProxy","DS/ENOXSourcingUXInfra/service/ENOXSourcingPlatformServices","DS/ENOXSourcingUXInfra/Constants/ENOXSourcingConstants","DS/ENOXSourcingUXInfra/Search/SearchUtility","DS/ENOXSourcingUXInfra/Utilities/Utility","DS/ENOXComponentQualification/views/ManufacturerEquivalentItem/ReviseMEI","DS/ENOXSourcingUXInfra/openwithservice/ENOXSourcingOpenWithService"],function(e,t,i,n,o,a,r,l,s){"use strict";var c=function(t){this.collectionView=new e,this.controller=t,this.NLS=this.controller.app.i18NProvider,this.helper=t.helper,this.taggerProxy=new i,this.searchUtil=new a,this.utility=new r};return c.prototype.render=function(e){var t=this,i=widget.getElement(".information-panel.panel-icon-wrapper");i&&i.style.removeProperty("display"),t.taggerProxy=e.taggerProxy,t.controller.app._applicationChannel.publish({event:"xsourcing-collectionview-unselected-object-id",data:{selectedObject:null}}),e.hideTitle=!0,e.collectionView=this.collectionView,e.uniqueIdentifier="MEIListPage",e.enableDrag=!0,1===e.data.length?e.itemsName=t.NLS.manufacturer_equivalent_item:e.itemsName=t.NLS.manufacturer_equivalent_items,e.columnsConfigurations=[{text:t.NLS.title,dataIndex:"tree",resizableFlag:!0,sortableFlag:!0,pinned:"left",width:130,typeRepresentation:"url",hyperlinkTarget:"_self",hyperlinkClickCallback:function(e){t.controller.closeTagger();var i=e.nodeModel.options.grid;i.pid=e.nodeModel.options.grid.id,t.controller.app.router.navigate("home.MEIDetails",i)},getCellValue:function(e){return{icon:{iconPath:require.toUrl("ENOXComponentQualification/assets/icons/16/I_ManufacturerEquivalentItem16.png"),iconSize:{height:"16px",width:"16px"}},label:e.nodeModel.options.label,url:"javascript:;",hyperlinkClickCallback:e.nodeModel.options.grid.grouped?void 0:this.layout.getColumnOptionValue(e.columnID,"hyperlinkClickCallback")}}},{text:t.NLS.manufacturer_part_number,dataIndex:"partNumber",width:200},{text:t.NLS.name,dataIndex:"name"},{text:t.NLS.revision,dataIndex:"revision"},{text:t.NLS.manufacturer,dataIndex:"organization"},{text:t.NLS.description,dataIndex:"description"},{text:t.NLS.maturity_state,dataIndex:"stateDisplay",width:125},{text:t.NLS.owner,dataIndex:"owner"},{text:t.NLS.creation_date,dataIndex:"createdActual",width:150,typeRepresentation:"datetime",getCellValueForExport:function(e){if(e.nodeModel)return e.nodeModel.options.grid.created}},{text:t.NLS.modified_date,dataIndex:"modifiedActual",width:150,typeRepresentation:"datetime",getCellValueForExport:function(e){if(e.nodeModel)return e.nodeModel.options.grid.modified}},{text:t.NLS.qualification_status,dataIndex:"approvedDisplay"},{text:t.NLS.qualification_maturity_state,dataIndex:"qualificationStateDisplay",width:200}],e.showToolbar=!0,e.showMobileWelcomePanelIcon=!0,e.toolbarActions=[{id:"newMEI",text:t.NLS.add,fonticon:"plus",content:[{id:"newManufacturerEquivalentItem",text:t.NLS.new_mei,fonticon:"trolley-add wux-ui-3ds",handler:function(){t.controller.newMEI(e)}},{id:"newMEIFromEngIitem",text:t.NLS.new_mei_from_physical_product,fonticon:"plus wux-ui-3ds",handler:function(){t.controller.newMEI(e,!0)}}]},{id:"delete",text:t.NLS.delete,fonticon:"trash",disabled:!0,handler:function(){t.deleteMEI(t,e)}},{id:"exportToCSV",text:t.NLS.export_to_csv,fonticon:"export-to-csv",handler:function(){t.exportToCSV(t)}}],e.sort=[{id:"title",text:t.NLS.title,type:"string"}],e.showToolbarInfoIcon=!0,e.onContextualEventCallback=function(i){var n=i.cellInfos&&i.cellInfos.nodeModel?i.cellInfos.nodeModel:null;if(-1===(i.cellInfos?i.cellInfos.rowID:null)||!n)return this._contextualMenuBuilder?this._contextualMenuBuilder.buildMenu(i,e):[];var o=i.cellInfos.nodeModel?i.cellInfos.nodeModel:i.cellInfos.cellModel,a=o.options.grid,r=[{type:"PushItem",title:t.NLS.open,fonticon:{content:"wux-ui-3ds wux-ui-3ds-open"},action:{callback:function(){t.controller.closeTagger(),a.pid=a.id,t.controller.app.router.navigate("home.MEIDetails",a)}}},{type:"PushItem",title:t.NLS.revise,fonticon:{content:"wux-ui-3ds wux-ui-3ds-flow-line-add"},action:{callback:function(){t.controller.closeTagger(),l.revise({meiId:a.id,qualificationController:t.controller.qualificationController})}}},{type:"PushItem",title:t.NLS.edit_properties,fonticon:{content:"wux-ui-3ds wux-ui-3ds-attributes"},action:{callback:()=>{t.utility.propertyWidget(a.id)}}},{type:"PushItem",title:t.NLS.delete,fonticon:{content:"wux-ui-3ds wux-ui-3ds-trash"},action:{callback:function(){e.contextualNode=[n],t.deleteMEI(t,e)}}}];return s.getOpenWithMenu(o).then(function(e){return r=[...r.slice(0,1),{id:"OpenWith",type:"PushItem",title:t.NLS.open_with,icon:"open-menu-dot",submenu:e},...r.slice(1)]},function(){return r})},e.container=e.externalContainer?e.externalContainer:t.controller.app._triptychWrapper.getMainPanelContainer(),e.onStatusbarIconPointerDown=function(e){t.helper.onStatusbarIconPointerDown(e,t)},e.getEmptyStatusbarVisibleFlag=function(){return!0},e.onPostCellRequest=this.helper.setStatusbarStyle,e.shouldAllowUnsafeHTMLAt=["subtitle"],e.descriptionLinesNumber=1,e.displayedOptionalCellProperties=["All"],e.getSubLabel=this.helper.getCompanyLabel,e.getDescription=this.helper.getDescription,e.getStatusbarIcons=function(e){return t.helper.getStatusbarIcons(e)},e.getStatusbarIconsTooltips=function(e){return t.helper.getStatusbarIconsTooltips(e)},e.getCustomTooltip=this.helper.getCustomTooltip.bind(this.helper),e.enableCellDrag=!0,e.onDragStartCell=function(e,i){if("tree"===this.getColumnOrGroup(i.columnID).dataIndex){var n=t.collectionView._xsourcingCollectionViewUI.formatDataForDnD(i.draggedNodes);return e.dataTransfer.setData("text/plain",JSON.stringify(n)),!1}e.preventDefault()},this.collectionView.init(e),this.collectionView.collectionViewEvents.subscribe({event:"xsourcing-collectionview-cell-dblclick"},function(e){t.controller.closeTagger(),e.pid=e.id,t.controller.app.router.navigate("home.MEIDetails",e)}),this.collectionView.collectionViewEvents.subscribe({event:"xsourcing-collectionview-selection-updated"},function(e){if(e.selectedItems.length>0){t.collectionView.collectionViewEvents.publish({event:"xsourcing-collectionview-enable-toolbar-button",data:"delete"});var i=event&&event.dsModel&&event.dsModel.activeNode?event.dsModel.activeNode:{options:e.selectedItems[e.selectedItems.length-1]};1===e.selectedItems.length?t.controller.app._applicationChannel.publish({event:"xsourcing-collectionview-selected-object-id",data:{selectedObject:i,openDetails:function(){var e={};e.data={id:i.options.grid.id,qualificationId:i.options.grid.qualificationId?i.options.grid.qualificationId:""},e.detailsContainer=t.controller.app._triptychWrapper.getRightPanelContainer(),e.detailsContainer.empty&&e.detailsContainer.empty(),e._mediator=t.controller.app._mediator,e._triptychWrapper=t.controller.app._triptychWrapper,e.router=t.controller.app.router,e.platformServices=t.controller.app.platformServices,e.applicationChannel=t.controller.app._applicationChannel,e.forInfo=!0,e.updateListManufacturerEQTable=function(e,i){t.getMEISpecificAttributeForUpdateForRightSidePanel(e,i)},t.controller.showDetails(e)}}}):t.controller.app._applicationChannel.publish({event:"xsourcing-collectionview-selected-object-id",data:{selectedObject:"multipleSelected"}})}else t.collectionView.collectionViewEvents.publish({event:"xsourcing-collectionview-disable-toolbar-button",data:"delete"}),t.controller.app._applicationChannel.publish({event:"xsourcing-collectionview-unselected-object-id",data:{selectedObject:null}})}),t.controller.app._applicationChannel.subscribe({event:"add-mei"},function(e){t.collectionView.collectionViewEvents.publish({event:"add-model",data:e})}),window.meiListPageReferenceRowReference&&(t.optionsData=e,window.meiListPageReferenceRowReference=t),e.dropArea=this.collectionView._xsourcingCollectionViewUI.viewContainer,require(["DS/ENOXSourcingUXInfra/DragAndDrop/ENOXSourcingDataDragAndDrop"],function(i){var n=new i;e.dropStrategy="OPEN",e.onDropCallback=t.dropCallBack(t.controller.app),t.controller.app.dropCallBack=t.dropCallBack(t.controller.app),n.makeAreaDroppable(e)})},c.prototype.deleteMEI=function(e,t){e.collectionView._xsourcingCollectionViewUI.checkIfExceedsDeleteLimit(e.collectionView._gridModel.getSelectedNodes())||require(["DS/UIKIT/SuperModal"],function(i){if(t.selectedNodes=e.collectionView._gridModel.getSelectedNodes(),t.contextualNode&&(t.selectedNodes=t.contextualNode.slice()),t.contextualNode=void 0,t.selectedNodes.length>0){var n=new i({renderTo:widget.body,okButtonText:e.NLS.delete}),o=1===t.selectedNodes.length?t.selectedNodes[0].options.label:t.selectedNodes.length+" "+e.NLS.mei_small;n.confirm(e.NLS.delete_confirmation,e.NLS.delete+" - "+o,function(i){i&&e.controller.delete(t)})}})},c.prototype.exportToCSV=function(e){let t="MEIExport_"+n.getPlatformId()+".csv";e.collectionView._xsourcingCollectionViewUI.exportDataToCSV({forceQuotes:!0,allColumns:!0,addLevelInformation:!0},t)},c.prototype.getMEIInfoData=function(e){return{fields:[{disable:!0,label:this.NLS.type,placeholder:this.NLS.type,type:"labelValue",icon:require.toUrl("ENOXComponentQualification/assets/icons/22/MEI-22.png"),value:this.NLS[e.options.grid.type]?this.NLS[e.options.grid.type]:e.options.grid.type},{disable:!0,label:this.NLS.name,placeholder:this.NLS.name,type:"labelValue",value:e.options.grid.name},{disable:!0,label:this.NLS.description,placeholder:this.NLS.description,type:"labelValue",value:e.options.grid.description},{disable:!0,label:this.NLS.maturity_state,placeholder:this.NLS.maturity_state,type:"labelValue",value:e.options.grid.state},{disable:!0,label:this.NLS.manufacturer,placeholder:this.NLS.manufacturer,type:"labelValue",value:e.options.grid.organization},{disable:!0,label:this.NLS.owner,placeholder:this.NLS.owner,type:"labelValue",value:e.options.grid.owner},{disable:!0,label:this.NLS.creation_date,placeholder:this.NLS.creation_date,type:"labelValue",value:e.options.grid.created},{disable:!0,label:this.NLS.modified_date,placeholder:this.NLS.modified_date,type:"labelValue",value:e.options.grid.modified}],objectData:{attributes:[{name:this.NLS.name,value:e.options.grid.name},{name:this.NLS.creation_date,value:e.options.grid.created},{name:this.NLS.owner,value:e.options.grid.owner}],image:e.options.grid.image,name:e.options.grid.title}}},c.prototype.getMEISpecificAttributeForUpdateForRightSidePanel=function(e,t){if("updateMEI"===t){let t=this.collectionView._gridModel.getAllDescendants().filter(t=>t._options.grid.id===e.grid.id);if(t&&1===t.length){e.statusbarIcons=t[0]._options.statusbarIcons,e.statusbarIconsTooltips=t[0]._options.statusbarIconsTooltips;var i={mei_id:t[0]._options.grid.mei_id,mei_proxy_id:t[0]._options.grid.mei_proxy_id,qualificationId:t[0]._options.grid.qualificationId,qualificationType:t[0]._options.grid.qualificationType,qualificationStatus:t[0]._options.grid.qualificationStatus,qualificationState:t[0]._options.grid.qualificationState,qualificationStateDisplay:t[0]._options.grid.qualificationStateDisplay};UWA.merge(e.grid,i),t[0].updateOptions(e)}}},c.prototype.dropCallBack=function(e){var t=this;return function(i){if(i)if(-1!==i.objectType.search("Qualification")){let n={data:{items:[{objectId:i.objectId,objectType:i.objectType}]}};t.controller.qualificationController.decideRouteUsingURL(n,e.router)}else{let a=function(n){let a={};n["ds6w:what/ds6w:kind"]&&n["ds6w:what/ds6w:kind"]===o.MEI_EXTENSION||n["ds6wg:ManufacturerEquivalentItemExtension.ManufacturerPartNumber"]?(a.route=o.MEI_DETAILS_PAGE_ROUTE,a.id=i.objectId,e.router.navigate(a.route,a,{reload:!0})):n["ds6w:what/ds6w:type"]&&n["ds6w:what/ds6w:type"]===o.VPMREFERENCE||n["ds6w:type"]&&n["ds6w:type"]===o.VPMREFERENCE?(a.route=o.ENG_ITEM_DETAILS_PAGE_ROUTE,a.pid=i.objectId,a.title=i.displayName,a.getData=!0,e.router.navigate(a.route,a,{reload:!0})):n["ds6w:what/ds6w:type"]&&o.DELFMIFUNCTIONREFERENCE_TYPES.includes(n["ds6w:what/ds6w:type"])||n["ds6w:type"]&&o.DELFMIFUNCTIONREFERENCE_TYPES.includes(n["ds6w:type"])?(a.route=o.MFG_ITEM_DETAILS_PAGE_ROUTE,a.pid=i.objectId,a.title=i.displayName,a.getData=!0,e.router.navigate(a.route,a,{reload:!0})):widget.notificationUtil.showError(t.NLS.invalid_object_dropped)},r=[i.serviceId],l=[i.objectType],s=[i.objectId];var n=t.searchUtil.getSearchPayload(s,l,r);t.searchUtil.callFederatedSearch(n).then(function(e){let i=t.searchUtil.processResults(e);i.length!==n.resourceid_in.length?t.searchUtil.callRecentFederatedSearch(n).then(function(e){i=t.searchUtil.processResults(e);let n=[];i.forEach(e=>{e.resourceid===s[0]&&n.push(e)}),n.map(function(e){a(e)})}):i.map(function(e){a(e)})})}}},c}),define("DS/ENOXComponentQualification/views/Context/Engineering/ListRecentEngineering",["DS/UIKIT/Mask","DS/ENOXSourcingUXInfra/xsourcingCollectionView/xsourcingCollectionView","DS/ENOXSourcingUXInfra/EmptyContent/ENOXSourcingEmptyContent","DS/ENOXSourcingUXInfra/DragAndDrop/ENOXSourcingDataDragAndDrop","DS/ENOXComponentQualification/helpers/SearchEngineeringItem","DS/UIKIT/SuperModal","DS/Controls/DatePicker","DS/ENOXSourcingUXInfra/Search/SearchUtility","DS/ENOXSourcingUXInfra/openwithservice/ENOXSourcingOpenWithService"],function(e,t,i,n,o,a,r,l,s){"use strict";var c=function(e){this.controller=e,this.searchUtil=new l,this.NLS=this.controller.app.i18NProvider};return c.prototype.render=function(a){var r=this;r.controller.app._triptychWrapper.getMainPanelContainer().innerHTML="";var l=widget.getElement(".information-panel.panel-icon-wrapper");if(l&&l.style.removeProperty("display"),r.controller.app._applicationChannel.publish({event:"xsourcing-collectionview-unselected-object-id",data:{selectedObjectId:null}}),a.container=a.externalContainer?a.externalContainer:r.controller.app._triptychWrapper.getMainPanelContainer(),a.allowedTypes=a.configs.dropAllowedTypes,a.uniqueIdentifier="home.RecentEngineeringItem"===a.routeDetails.name?"MyEngItemListPage":"MyMfgItemListPage",a.dropStrategy="OPEN",r.openDetailsFunction=async function(e){let t=[e.objectId];if((await r.controller.searchUtil.getNonIndexedObjectIds(t)).length>0)widget.notificationUtil.showError(r.NLS.one_or_more_object_not_indexed);else{var i={};i.pid=e.objectId,i.title=e.displayName,i.getData=!0,r.controller.app.router.navigate(a.configs.detailsRoutename,i)}},a.onDropCallback=function(e){e&&a.allowedTypes.includes(e.objectType)?r.checkNotMEIAndOpenDetails(e):(a.droppedType=e.objectType,r.controller.util.gettypeshierarchy(a.droppedType).then(function(t){var i=a.allowedTypes.filter(e=>-1!==t.types_hierarchies[0].hierarchy.indexOf(e)).length>0;e&&i?r.checkNotMEIAndOpenDetails(e):widget.notificationUtil.showError('"'+e.displayType+'" '+r.NLS.unsupported_type)}).catch(function(e){widget.notificationUtil.showError(e)}))},a.emptyDataButtonCallback=function(){a.nxtNavigationPath=a.configs.detailsRoutename,a.NLS=r.NLS,(new o).init(a)},0===a.data.length){a.dropArea=a.container,a.emptyContentArea=a.container;var c=new i;a.emptyDataButtonLabel=r.NLS.search_for_content,a.dropIconLabel=r.NLS.DropInvit_drop,a.emptyDataButtonIcon="search",c.init(a)}else{r.options=a,a.hideTitle=!0,a.views=["Grid","Tile","Thumbnail"],a.columnsConfigurations=[{text:r.NLS.title,dataIndex:"tree",resizableFlag:!0,sortableFlag:!0,pinned:"left",width:"190px",typeRepresentation:"url",hyperlinkTarget:"_self",hyperlinkClickCallback:function(e){var t=e.nodeModel.options.grid;t.objectId=e.nodeModel.options.grid.pid,t.displayName=e.nodeModel.options.grid.title,r.openDetailsFunction(t)},getCellValue:function(e){let t={label:e.nodeModel.options.label,url:"javascript:;",hyperlinkClickCallback:e.nodeModel.options.grid.grouped?void 0:this.layout.getColumnOptionValue(e.columnID,"hyperlinkClickCallback")};return e.nodeModel.options.grid.icon&&(t.icon={iconPath:e.nodeModel.options.grid.icon?require.toUrl(e.nodeModel.options.grid.icon):void 0,iconSize:{height:"16px",width:"16px"}}),t}},{text:r.NLS.type,dataIndex:"typeUI"},{text:r.NLS.name,dataIndex:"objName"},{text:r.NLS.revision,dataIndex:"revision"},{text:r.NLS.maturity_state,dataIndex:"maturityStatus"},{text:r.NLS.owner,dataIndex:"responsible"},{text:r.NLS.creation_date,dataIndex:"creationDate",typeRepresentation:"datetime"},{text:r.NLS.modified_date,dataIndex:"modificationDate",typeRepresentation:"datetime"}],a.showToolbar=!0,a.showToolbarInfoIcon=!0,a.displayedOptionalCellProperties=["contextualMenu","subtitle"],a.showMobileWelcomePanelIcon=!0,a.toolbarActions=[],a.toolbarActions.push({id:"openNew",text:"home.RecentEngineeringItem"===a.routeDetails.name?r.NLS.open_engineering_item:r.NLS.open_manufacturing_item,fonticon:"part-open",handler:function(){a.emptyDataButtonCallback()}},{id:"remove",text:r.NLS.remove,fonticon:"remove",disabled:!0,handler:function(){r.remove(r,a)}}),a.onContextualEventCallback=function(e){var t=[];if(e){var i=e.cellInfos&&e.cellInfos.nodeModel?e.cellInfos.nodeModel:null;if(-1===(e.cellInfos?e.cellInfos.rowID:null)||!i)return this._contextualMenuBuilder?this._contextualMenuBuilder.buildMenu(e,a):[];var n=e.cellInfos.nodeModel?e.cellInfos.nodeModel:e.cellInfos.cellModel,o=n.options.grid;return n&&t.push({id:"OpenItem",type:"PushItem",title:r.NLS.open,fonticon:{content:"wux-ui-3ds wux-ui-3ds-open"},action:{callback:function(){o.objectId=o.pid,o.displayName=o.title,r.openDetailsFunction(o)}}},{type:"PushItem",title:r.NLS.remove,fonticon:{content:"wux-ui-3ds wux-ui-3ds-remove"},action:{callback:function(){a.contextualNode=[i],r.remove(r,a)}}}),s.getOpenWithMenu(n).then(function(e){return t=[...t.slice(0,1),{id:"OpenWith",type:"PushItem",title:r.NLS.open_with,icon:"open-menu-dot",submenu:e},...t.slice(1)]},function(){return t})}};var d=new t;a.sort=[{id:"title",text:r.NLS.title,type:"string"}],d.init(a),r.xsourcingCollectionView=d,d.collectionViewEvents.subscribe({event:"xsourcing-collectionview-cell-dblclick"},function(e){var t={};t.objectId=e.pid,t.displayName=e.title,r.openDetailsFunction(t)}),d.collectionViewEvents.subscribe({event:"xsourcing-collectionview-selection-updated"},function(e){if(e.selectedItems.length>0){d.collectionViewEvents.publish({event:"xsourcing-collectionview-enable-toolbar-button",data:"remove"});var t=event&&event.dsModel&&event.dsModel.activeNode?event.dsModel.activeNode:{options:e.selectedItems[e.selectedItems.length-1]};1===e.selectedItems.length?r.controller.helper.renderPropertiesView({id:t._options?t._options.grid.id:t.options.grid.id,controller:r.controller}):r.controller.app._applicationChannel.publish({event:"xsourcing-collectionview-selected-object-id",data:{selectedObject:"multipleSelected"}})}else d.collectionViewEvents.publish({event:"xsourcing-collectionview-disable-toolbar-button",data:"remove"}),r.controller.app._applicationChannel.publish({event:"xsourcing-collectionview-unselected-object-id",data:{selectedObject:null}})}),a.dropArea=d._xsourcingCollectionViewUI.viewContainer,(new n).makeAreaDroppable(a)}e.unmask(widget.body)},c.prototype.remove=function(e,t){if(t.selectedNodes=e.xsourcingCollectionView._gridModel.getSelectedNodes(),t.contextualNode&&(t.selectedNodes=t.contextualNode.slice()),t.contextualNode=void 0,t.selectedNodes.length>0){var i=new a({renderTo:widget.body,okButtonText:e.NLS.remove}),n=1===t.selectedNodes.length?t.selectedNodes[0].options.label:t.selectedNodes.length+" "+e.NLS.remove_recent_my_engineering_item;i.confirm(e.NLS.remove_confirmation,e.NLS.remove+" - "+n,function(i){i&&(t.thatObj=e,e.controller.removeFromRecentlyVisited(t).then(function(){0===e.xsourcingCollectionView._gridModel._trueRoot._treeDocument.getAllDescendants().length&&e.controller.list(t)}))})}},c.prototype.checkNotMEIAndOpenDetails=function(e){var t=this;let i=[e.serviceId],n=[e.objectType],o=[e.objectId];var a=t.searchUtil.getSearchPayload(o,n,i);t.searchUtil.callFederatedSearch(a).then(function(i){let n=t.searchUtil.processResults(i);n.length!==a.resourceid_in.length?t.searchUtil.callRecentFederatedSearch(a).then(function(i){n=t.searchUtil.processResults(i);let a=[];n.forEach(e=>{e.resourceid===o[0]&&a.push(e)}),a.map(function(i){i["ds6wg:ManufacturerEquivalentItemExtension.ManufacturerPartNumber"]?widget.notificationUtil.showError('"'+t.NLS.manufacturer_equivalent_item+'" '+t.NLS.unsupported_type):t.openDetailsFunction(e)})}):n.map(function(i){i["ds6wg:ManufacturerEquivalentItemExtension.ManufacturerPartNumber"]?widget.notificationUtil.showError('"'+t.NLS.manufacturer_equivalent_item+'" '+t.NLS.unsupported_type):t.openDetailsFunction(e)})})},c}),define("DS/ENOXComponentQualification/views/VendorItems/VendorItemQualifications",["UWA/Core","UWA/Class/View","DS/UIKIT/Mask","DS/ENOXSourcingUXInfra/xsourcingCollectionView/xsourcingCollectionView","DS/Utilities/Dom","DS/UIKIT/SuperModal","DS/ENOXSourcingUXInfra/Constants/ENOXSourcingConstants","DS/ENOXSourcingUXInfra/Search/SearchUtility","DS/ENOXSourcingUXInfra/Utilities/Utility","DS/ENOXComponentQualification/models/Qualification","DS/ENOXSourcingUXInfra/service/ENOXSourcingPlatformServices","css!DS/UIKIT/UIKIT.css"],function(e,t,i,n,o,a,r,l,s,c,d){"use strict";return t.extend({name:"vendoritem-qualification-view",tagName:"div",domEvents:{},init:function(e){this.model=e.model,this.NLS=e.model.get("controller").NLS,this.searchUtil=new l,this.modelEvent=this.model.get("modelEvent"),this.utility=new s,this.qualificationModel=new c({i18NProvider:this.NLS}),["container","template","tagName","domEvents"].forEach(function(t){delete e[t]}),this._parent(this,e)},setup:function(){this.container.addClassName(this.getClassNames("-container"))},update:function(){var e=this.outerDiv.parentElement.parentElement?this.outerDiv.parentElement.parentElement.getBoundingClientRect():this.outerDiv.parentElement.getBoundingClientRect();this.outerDiv.style.height=e.height+"px"},render:function(){var t=this;this.container.empty(),this.outerDiv=e.createElement("div",{class:"outerDiv",styles:{height:"100%"}}).inject(this.container),i.mask(this.container,t.NLS.loading);var a={data:[]};return t.loadData(),a._mediator=t.model.get("mediator"),a.showToolbar=!0,a.uniqueIdentifier="VendorItemQualView",a.toolbarActions=[{fonticon:"plus",text:t.NLS.add,id:"add",disabled:!1,handler:function(){t.model.get("controller").app.dataControllers.qualificationController.newQualification(t.model.get("options"))}},{fonticon:"thumbs-up",text:t.NLS.approve,id:"approve",disabled:!0,handler:function(e){a.value="Yes",a.cellInfos=e,t.changeApproveState(t,a)}},{fonticon:"thumbs-down",text:t.NLS.reject,id:"reject",disabled:!0,handler:function(e){a.value="No",a.cellInfos=e,t.changeApproveState(t,a)}},{fonticon:"trash",text:t.NLS.delete,id:"remove",disabled:!0,handler:function(){t.deleteQualification(t,a)}}],a.columnsConfigurations=[{sortableFlag:!0}],a.displayedOptionalCellProperties=["contextualMenu","subtitle"],a.views=["Tile","Grid"],a.sort=[{id:"tree",text:t.NLS.title,type:"string"}],a.onContextualEventCallback=function(e){var i=[];if(e){var n=e.cellInfos&&e.cellInfos.nodeModel?e.cellInfos.nodeModel:e.cellInfos.cellModel;if(-1===(e.cellInfos?e.cellInfos.rowID:null)||!n)return this._contextualMenuBuilder?this._contextualMenuBuilder.buildMenu(e,a):[];var o=e.cellInfos.nodeModel?e.cellInfos.nodeModel:e.cellInfos.cellModel;let l=!1,s="true",c=!1;if(o)return"TRUE"!==o._options.grid.modifyAccess&&!0!==o._options.grid.modifyAccess||o._options.grid.qualificationMaturity===r.RELEASED||o._options.grid.qualificationMaturity===r.OBSOLETE||(l=!0,s="false"),"TRUE"!==o._options.grid.deleteAccess&&!0!==o._options.grid.deleteAccess||(c=!0),i.push({id:"approve",type:"PushItem",title:t.NLS.approve,state:l?"enabled":"disabled",icon:"thumbs-up",action:{callback:e=>{a.contextualNode=[n],a.value="Yes",a.cellInfos=e,t.changeApproveState(t,a)}}}),i.push({type:"SeparatorItem"}),i.push({id:"reject",type:"PushItem",title:t.NLS.reject,state:l?"enabled":"disabled",icon:"thumbs-down",action:{callback:e=>{a.contextualNode=[n],a.value="No",a.cellInfos=e,t.changeApproveState(t,a)}}}),i.push({type:"SeparatorItem"}),i.push({id:"remove",type:"PushItem",title:t.NLS.delete,icon:"trash",state:c?"enabled":"disabled",action:{callback:function(){let i=e.cellInfos&&e.cellInfos.nodeModel?e.cellInfos.nodeModel:e.cellInfos.cellModel;a.contextualNode=[i],t.deleteQualification(t,a)}}}),i}return i},t.tableView=new n,a.container=t.outerDiv,a.rowSelection="multiple",a.displayedOptionalCellProperties=["All"],a.columnsConfigurations=t.getColumnConfigurations(a),t.tableView.init(a),t.loadData(),t.tableView.collectionViewEvents.subscribe({event:"xsourcing-collectionview-selection-updated"},function(e){e.selectedItems.length>0?(1===e.selectedItems.length?(e.selectedItems[0].grid.modifyAccess="TRUE")&&e.selectedItems[0].grid.qualificationMaturity!==r.RELEASED&&e.selectedItems[0].grid.qualificationMaturity!==r.OBSOLET&&(t.tableView.collectionViewEvents.publish({event:"xsourcing-collectionview-enable-toolbar-button",data:"approve"}),t.tableView.collectionViewEvents.publish({event:"xsourcing-collectionview-enable-toolbar-button",data:"reject"})):(t.tableView.collectionViewEvents.publish({event:"xsourcing-collectionview-disable-toolbar-button",data:"approve"}),t.tableView.collectionViewEvents.publish({event:"xsourcing-collectionview-disable-toolbar-button",data:"reject"})),t.tableView.collectionViewEvents.publish({event:"xsourcing-collectionview-enable-toolbar-button",data:"remove"})):(t.tableView.collectionViewEvents.publish({event:"xsourcing-collectionview-disable-toolbar-button",data:"remove"}),t.tableView.collectionViewEvents.publish({event:"xsourcing-collectionview-disable-toolbar-button",data:"approve"}),t.tableView.collectionViewEvents.publish({event:"xsourcing-collectionview-disable-toolbar-button",data:"reject"}))}),t.model.get("controller").app._applicationChannel.subscribe({event:"add-vendor-qual"},function(){t.loadData(),i.unmask(widget.body)}),o.addResizeListener(this.outerDiv,function(){t.update()},0),this.container},onDestroy:function(){return this.multidocdownloaderFrame.remove(),this._parent.apply(this,arguments)},loadData:async function(){let e=this;e.container&&e.container.parentElement&&i.mask(e.container.parentElement,e.NLS.loading_contextRestrictions);let t={data:[]},n=await e.model.get("controller").app.dataControllers.qualificationController.model.getAllTargetQualificationsFromMEI({id:e.model.get("options").data.respParams.id,includeParams:"$include=Context,PreReq,context-restrictions"});n.data.forEach(e=>{e.relateddata.Context.length>0&&t.data.push({id:e.relateddata.Context[0].dataelements.Proxy_Id})});let o=await e.model.get("controller").app.dataControllers.qualificationController.queryObjectInfo(t);o.data.isVendorItemQual=!0;let a=await e.model.get("controller").app.dataControllers.qualificationController.helper.processRelatedQualifications(n,o.data);e.tableView._setData(a),e.tableView._xsourcingCollectionViewUI._allData=a,e.update(),e.container&&e.container.parentElement&&(i.unmask(e.container.parentElement),i.unmask(e.container))},deleteQualification:function(e,t){if(t.selectedNodes=e.tableView._gridModel.getSelectedNodes().filter(function(e){return!0!==e._options.grid.grouped}),!e.tableView._xsourcingCollectionViewUI.checkIfExceedsDeleteLimit(t.selectedNodes)&&(t.contextualNode&&(t.selectedNodes=t.contextualNode.slice()),t.contextualNode=void 0,t.selectedNodes.length>0)){var n=[];let l=[];t.selectedNodes.forEach(e=>{n.push({id:e.getAttributeValue("id")}),l.push(e.getAttributeValue("id"))}),t.deleteData={data:n};var o=new a({renderTo:widget.body,okButtonText:e.NLS.delete}),r=1===t.selectedNodes.length?t.selectedNodes[0].options.label:t.selectedNodes.length+" "+e.NLS.qualifications_small;o.confirm(e.NLS.delete_confirmation,e.NLS.delete+" - "+r,function(n){n&&(i.mask(e.container,e.NLS.loading_qualifications),t.onComplete=function(){t.selectedNodes.forEach(e=>e.getTreeDocument().removeRoot(e)),e.tableView.collectionViewEvents.publish({event:"xsourcing-collectionview-update-count"}),e.model.get("controller").app._applicationChannel.publish({event:"delete-mq-vi-dgv",data:{selectedObject:l}}),widget.notificationUtil.showSuccess(e.NLS.qualification_deleted_sucessfully),e.loadData()},t.onFailure=function(t){widget.notificationUtil.showError(t.internalError&&500===t.statusCode?t.internalError:t.error),i.unmask(e.container)},e.qualificationModel.delete(t,t.selectedNodes[0].options.id))})}},changeApproveState:async function(e,t){t.selectedNodes=e.tableView._gridModel.getSelectedNodes(),t.contextualNode&&(t.selectedNodes=t.contextualNode.slice()),t.contextualNode=void 0;let i={id:t.selectedNodes[0]._options.id,type:t.selectedNodes[0]._options.grid.type,attribute:r.ATTRIBUTE_QUALIFICATION_APPROVED,value:t.value,successMessage:e.NLS.qualification_approved_updated,cellInfos:t.cellInfos,forVendorItem:!0},n=["In Draft","In Work","Review","Released"],o=async function(i){let a={lifeCycleData:{data:[{physicalid:t.selectedNodes[0]._options.id,tostate:n[n.indexOf(i)+1],fromstate:i}]}};await e.qualificationModel.performLifeCycleAction(a).then(function(n){if(n.report[0]&&n.report[0].error)return e.model.get("controller").app._applicationChannel.publish({event:"update-mq-vi-dgv",data:{approve:t.value,mqState:i,qualId:t.selectedNodes[0]._options.id}}),widget.notificationUtil.showError(n.report[0].error),void e.loadData();if("success"===n.status){if("Released"===n.results[0].current)return widget.notificationUtil.showSuccess(e.NLS.qualification+" "+t.selectedNodes[0]._options.grid.name+" "+e.NLS.updated_successfully),e.model.get("controller").app._applicationChannel.publish({event:"update-mq-vi-dgv",data:{approve:t.value,mqState:"Released",qualId:t.selectedNodes[0]._options.id}}),void e.loadData();o(n.results[0].current)}},function(){e.model.get("controller").app._applicationChannel.publish({event:"update-mq-vi-dgv",data:{approve:t.value,mqState:i,qualId:t.selectedNodes[0]._options.id}}),widget.notificationUtil.showError(e.NLS.releasing+" "+t.selectedNodes[0]._options.grid.name+" "+e.NLS.failed),e.loadData()}).catch(function(n){e.model.get("controller").app._applicationChannel.publish({event:"update-mq-vi-dgv",data:{approve:t.value,mqState:i,qualId:t.selectedNodes[0]._options.id}}),widget.notificationUtil.showError(e.NLS.releasing+" "+t.selectedNodes[0]._options.grid.name+" "+e.NLS.failed),e.loadData()})},a={data:[{id:t.selectedNodes[0]._options.context_id},{id:e.model.get("options").data.params.id}]},l=[e.NLS.Obsolete,e.NLS.Released],s=await e.model.get("controller").app.dataControllers.qualificationController.queryObjectInfo(a);l.includes(s.data[0].stateNLS)&&l.includes(s.data[1].stateNLS)?await e.model.get("controller").app.dataControllers.qualificationController.gridCellUpdateV2(i).then(function(){o(t.selectedNodes[0]._options.grid.qualificationMaturity)},function(){widget.notificationUtil.showError(t.selectedNodes[0]._options.grid.name+" "+e.NLS.updated_qualification_fail)}).catch(function(i){widget.notificationUtil.showError(t.selectedNodes[0]._options.grid.name+" "+e.NLS.updated_qualification_fail)}):widget.notificationUtil.showError(e.NLS.qual_release_fail)},getColumnConfigurations:function(e){var t=this;return[{text:t.NLS.qualification_name,dataIndex:"tree",resizableFlag:!0,sortableFlag:!0,pinned:"left",typeRepresentation:"url",width:150,getCellValue:function(e){return{icon:{iconPath:require.toUrl("ENOXComponentQualification/assets/icons/16/I_Qualification16.png"),iconSize:{height:"16px",width:"16px"}},label:e.nodeModel.options.grid.name}}},{text:t.NLS.title,width:100,dataIndex:"qualtitle"},{text:t.NLS.revision,width:100,dataIndex:"revision"},{text:t.NLS.type,dataIndex:"typeNLS"},{text:t.NLS.context_item_title,dataIndex:"enterpriseItem",typeRepresentation:"url",hyperlinkTarget:"_self",typesNAForHyperlink:[r.TYPE_QUALIFICATION_LIST[3]],getCellValue:function(e){return{label:e.nodeModel.options.grid.enterpriseItem,url:"javascript:;",hyperlinkClickCallback:e.nodeModel.options.grid.grouped?void 0:this.layout.getColumnOptionValue(e.columnID,"hyperlinkClickCallback")}},hyperlinkClickCallback:function(e){let i=e.nodeModel.options.grid.contextTypeActual,n=e.nodeModel.options.grid.contextTypeSource,o={};o.pid=e.nodeModel.options.grid.eng_id,o.title=e.nodeModel.options.grid.enterpriseItem,o.getData=!0,i===r.MANUFACTURING_ITEM_PROXY||r.DELFMIFUNCTIONREFERENCE_TYPES.includes(i)?t.model.get("controller").app.router.navigate(r.MFG_ITEM_DETAILS_PAGE_ROUTE,o,{reload:!0}):t.utility.gettypeshierarchy(i).then(function(i){i.types_hierarchies[0].hierarchy.filter(e=>r.DELFMIFUNCTIONREFERENCE_TYPES.includes(e)).length>0?t.model.get("controller").app.router.navigate(r.MFG_ITEM_DETAILS_PAGE_ROUTE,o,{reload:!0}):n!==r.SOURCE_3DSPACE&&r.ONPREMISE!==d.getPlatformId()||window.open(d._platforms[r.SERVICE_3DSPACE]+"/common/emxNavigator.jsp?objectId="+e.nodeModel.options.grid.eng_id)}).catch(function(e){widget.notificationUtil.showError(e)})}},{text:t.NLS.context_item_type,dataIndex:"contextType"},{text:t.NLS.context_restrictions,dataIndex:"contextRestrictonsLength",width:150,alignment:"center"},{text:t.NLS.comments,dataIndex:"qualificationComments"},{text:t.NLS.preferred,dataIndex:"preferredDisplay",width:100,setCellValue:function(i,n){i.nodeModel.options.grid.preferred!==n&&(e.fromRelatedQualifications=!0,t.model.get("qualificationController").gridCellUpdate(e,i,n,"attribute_SRCQUALIFICATION.Preferred",t.NLS.qualification_preferred_updated))}},{text:t.NLS.qualification_status,dataIndex:"approved",width:100,setCellValue:function(i,n){i.nodeModel.options.grid.approved!==n&&(e.fromRelatedQualifications=!0,t.model.get("qualificationController").gridCellUpdate(e,i,n,"attribute_SRCQUALIFICATION.Approved",t.NLS.qualification_approved_updated))}},{text:t.NLS.maturity_state,dataIndex:"qualificationMaturityDisplay",width:125},{text:t.NLS.creation_date,width:150,dataIndex:"created",typeRepresentation:"datetime"},{text:t.NLS.modified_date,width:150,dataIndex:"modified",typeRepresentation:"datetime"}]}})}),define("DS/ENOXComponentQualification/controllers/ListRecentEngineeringController",["DS/UIKIT/Mask","DS/ENOXSourcingUXInfra/service/ENOXSourcingService","DS/ENOXComponentQualification/helpers/EngineeringHelper","DS/ENOXComponentQualification/views/Context/Engineering/ListRecentEngineering","DS/ENOXSourcingUXInfra/Search/SearchUtility","DS/ENOXSourcingUXInfra/Utilities/Utility"],function(e,t,i,n,o,a){"use strict";var r=function(e){this.app=e.app,this.searchUtil=new o,this.util=new a,this.helper=new i(this),this.view=new n(this),this.NLS=this.app.i18NProvider};return r.prototype.list=function(t){var i=this;t.configs=t.routeDetails,e.mask(widget.body,i.NLS[t.configs.loadingMaskNLSKey]);var n=JSON.parse(widget.getValue(t.configs.recentTrackerWidgetPreference)),o=JSON.parse(widget.getValue("xsrcRecentEngMaxSize")),a=o||10;n.length>a&&(n.length=a,widget.setValue(t.configs.recentTrackerWidgetPreference,JSON.stringify(n))),n.length>0?i.getAllDetails(n,t.configs).then(function(e){i.helper.processData(e,n,i).then(e=>{t.data=e,i.view.render(t)})}):(t.data=[],i.view.render(t)),i.app.taggerProxy.closeFacetTagger(),i.app.taggerProxy.onCloseTagger()},r.prototype.getAllDetails=function(e,i){var n=this.helper.getEngSearchPayload(e,i.dropAllowedTypes);return new Promise(e=>{n.nresults>0?t.getFederatedSearchDataPromise({searchPayLoad:n}).then(function(t){e(t)}):e([])})},r.prototype.removeFromRecentlyVisited=function(t){var i=this,n=t.selectedNodes.map(e=>e.getAttributeValue("pid")),o=JSON.parse(widget.getValue(t.configs.recentTrackerWidgetPreference));return new UWA.Promise(function(e){o=o.filter(function(e){return-1===n.indexOf(e.pid)}),t.selectedNodes.forEach(e=>e.getTreeDocument().removeRoot(e)),t.collectionViewEvents.publish({event:"xsourcing-collectionview-update-count"}),widget.notificationUtil.showSuccess(i.NLS[t.configs.removalNLS]),widget.setValue(t.configs.recentTrackerWidgetPreference,JSON.stringify(o)),e()}).catch(function(e){widget.notificationUtil.showError(e)}).finally(function(){e.unmask(widget.body)})},r.prototype.addToRecentlyVisited=function(e,t){var i=JSON.parse(widget.getValue(t));i=i.filter(t=>t.pid!==e.pid);var n={pid:e.pid};i.unshift(n);var o=JSON.parse(widget.getValue("xsrcRecentEngMaxSize")),a=o||10;i.length>a&&i.pop(),widget.setValue(t,JSON.stringify(i))},r}),define("DS/ENOXComponentQualification/views/VendorItems/OpenVendorItem",["DS/UIKIT/Mask","DS/ENOXComponentQualification/models/VendorItems","DS/ENOXSourcingUXInfra/DetailsView/DetailsView","DS/ENOXSourcingUXInfra/PropertiesView/PropertiesView","DS/ENOXSourcingUXInfra/MembersView/MembersView","DS/ENOXSourcingUXInfra/Constants/ENOXSourcingConstants","DS/ENOXSourcingUXInfra/CommonUtils/CommonUtils","i18n!DS/ENOXSourcingUXInfra/assets/nls/ENOXSourcingUXInfra","DS/ENOXComponentQualification/views/VendorItems/VendorItemQualifications"],function(e,t,i,n,o,a,r,l,s){"use strict";var c=function(e){this.controller=e,this.NLS=this.controller.NLS},d={};return c.prototype.render=function(e){if(e.controller=this.controller,!e.detailsContainer){var t=widget.getElement(".information-panel.panel-icon-wrapper");t&&(t.style.display="none"),this.controller.app._applicationChannel.publish({event:"welcome-panel-hide"}),this.controller.app._applicationChannel.publish({event:"information-panel-hidden",data:null})}d=e,this.detailsView(e)},c.prototype.detailsView=function(e){var n=this,o={};this.addIdCardOptions(e,o),this.addTabOptions(e,o),e.detailsViewOptions=o;var a=new t(n.controller.app);let l=new UWA.Class.Model({modelEvent:e.app?e.app._mediator.createNewChannel():e._mediator.createNewChannel(),id:e.data.respParams.id,dataProviderPromise:a.getLifeCycleDataProviderPromise(e),relativePath:"/resources/v1/modeler/dssourcing/vendoritems",callBackForExecuteCmd:function(){e.id=e.data.params.id,e.onComplete=function(t){let i=n.controller.processVendorItem(t.data[0]);e.data.respParams=i.grid,e.controller.app._applicationChannel.publish({event:"update-vendor-item-id-card",data:i.grid}),e.updateQualificationTable&&e.updateQualificationTable(i)}.bind(n),e.onFailure=function(e){widget.notificationUtil.showError(e.error?e.error:e.message)}.bind(n),a.VendorItemsDetails(e)}});e.lifeCycleModel=l;var s=new i;s.init(e),s.mIDCardContainer._idCardContainer.getElementsByClassName("fonticon-open-down")[0].setStyle("display","none"),n.controller.app._applicationChannel.subscribe({event:"update-vendor-item-id-card"},function(e){var t=s.mIDCardContainer,i=[{name:n.NLS.name,value:e.name,displayWhenMinified:!0},{name:n.NLS.maturity_state,id:"maturityState",value:"",type:"type-text",displayWhenMinified:!0},{name:n.NLS.owner,value:e.owner,type:"type-text",displayWhenMinified:!0},{name:n.NLS.vendor,value:e.vendor,type:"type-text"},{name:n.NLS.vendor_part_number,value:e.partno,type:"type-text"},{name:n.NLS.creation_date,value:r.getDateStringForDisplay(e.creation_date),type:"type-text"}];t.getIDCard().model.unset("attributes"),t.getIDCard().model.set("attributes",i),n.propertiesModel.set("modifyAccess",e.modifyAccess),s.lifeCycleView.model.unset("maturityContainer"),s.lifeCycleView.model.set("maturityContainer",t)})},c.prototype.addIdCardOptions=function(e,t){let i=e.data.respParams;t.idCardDetails={name:i.title,thumbnail:require.toUrl("ENOXComponentQualification/assets/icons/VendorItem_Thumbnail.png"),attributes:[{name:this.NLS.name,value:i.name,displayWhenMinified:!0},{name:this.NLS.maturity_state,id:"maturityState",value:"",type:"type-text",displayWhenMinified:!0},{name:this.NLS.owner,value:i.owner,type:"type-text",displayWhenMinified:!0},{name:this.NLS.vendor,value:i.vendor,type:"type-text"},{name:this.NLS.vendor_part_number,value:i.partno,type:"type-text"},{name:this.NLS.creation_date,value:r.getDateStringForDisplay(i.creation_date),type:"type-text"}]}},c.prototype.addTabOptions=function(e,t){var i=this;t.showTabView=!0,t.tabConfiguration=[{label:i.NLS.properties,content:c.prototype.addVIProperties.call(i,e),index:"1",value:"propertiesTblDiv",isSelected:!0,icon:{iconName:"attributes",fontIconFamily:1},events:{click:function(){i.controller.app._applicationChannel.publish({event:"make-information-panel-disappear",data:{forInfo:e.forInfo}})}}},{label:i.NLS.members,content:c.prototype.getMembersTabContainer(e),index:"2",value:"membersDiv",icon:{iconName:"users",fontIconFamily:1},events:{click:function(){i.controller.app._applicationChannel.publish({event:"make-information-panel-disappear",data:{forInfo:e.forInfo}})}}},{label:i.NLS.tab_qualifications,content:c.prototype.getQualificationsTabContainer.call(i,e),index:"3",value:"qualificationsDiv",reload:!0,icon:{iconName:"badge",fontIconFamily:1},events:{click:function(){i.controller.app._applicationChannel.publish({event:"make-information-panel-disappear",data:{forInfo:e.forInfo}})}}}]},c.prototype.addVIProperties=function(i){let o=this;var a,r=c.prototype.addPropertiesFields.call(o,i);return a=new UWA.Class.Model({modifyAccess:i.data.respParams.modifyAccess,stateAccess:!0,fields:r,save:function(n){var a=Object.keys(n),r={};a.forEach(function(e){"SRC_StandardPackageQuantity"!==e&&"SRC_CatalogPrice"!==e?Array.isArray(n[e].getValue())?r[e]=n[e].getValue()[0]:r[e]=n[e].getValue():r[e]=n[e].getInputText()});!function(){var n={id:d.data.respParams.id,dataelements:r},a=[];a.push(n);var l={addData:{data:a},onComplete:function(t){let n=t.data[0];if(!0===t.success){let t=o.controller.processVendorItem(n);e.unmask(widget.body);let r=n.dataelements.title||n.dataelements.Title;widget.notificationUtil.showSuccess(r+" "+o.NLS.updated_successfully),i.data.respParams=t.grid,i.controller.app._applicationChannel.publish({event:"update-vendor-item-id-card",data:t.grid});var a=o.addPropertiesFields(i);o.propertiesModel.unset("fields"),o.propertiesModel.set("fields",a),i.updateQualificationTable&&i.updateQualificationTable(t),e.unmask(widget.body)}},onFailure:function(t){widget.notificationUtil.showError(t.message?t.message:t.internalError.toString()),e.unmask(widget.body)}};new t(o.controller.app).updateVendorItem(l)}(),e.mask(widget.body,o.NLS.loading)}}),o.propertiesModel=a,new n({model:a}).render()},c.prototype.createExpanderUWADiv=function(e){return UWA.createElement("div",{id:e,styles:{position:"relative"}})},c.prototype.addPropertiesFields=function(e){let t=e.data.respParams;return[{type:"string",label:this.NLS.title,name:"Title",disable:!0,nonEditable:!0,value:t.title,isLengthy:!1},{type:"textarea",label:this.NLS.description,name:"description",disable:!0,value:t.description,isLengthy:!0},{type:"string",label:this.NLS.vendor,name:"vendor",disable:!0,nonEditable:!0,value:t.vendor},{type:"string",label:this.NLS.part_number,name:"partno",disable:!0,nonEditable:!0,value:t.partno},{type:"real",label:this.NLS.std_package_size,name:"SRC_StandardPackageQuantity",disable:!0,value:t.PackSize_ActualValue,displayValue:t.pack_size},{type:"real",label:this.NLS.catalog_price,name:"SRC_CatalogPrice",disable:!0,value:t.catalog_price_actual_value,displayValue:t.catalog_price},{type:"string",label:this.NLS.catalog_price_source,name:"SRC_CatalogPriceSource",disable:!0,value:t.catalog_price_source},{type:"select",label:this.NLS.unit_of_measure,name:"Unit of Measure",disable:!0,value:t.unit_of_measure,options:widget.getAttributeRange("Unit of Measure")},{type:"select",label:this.NLS.currency,name:"Currency",disable:!0,value:t.currency,options:widget.getAttributeRange("Currency"),displayValue:widget.getCurrencyShortValue(t.currency),customTooltip:widget.getRangeValueNLS("Currency",t.currency)},{type:"select",label:this.NLS.coo,name:"Country",disable:!0,value:t.coo,options:widget.getAttributeRange("Country")},{type:"text",label:this.NLS.part_source,placeholder:this.NLS.part_source,name:"SRC Part Source",value:t.partSource,disable:!0,errorText:l.max_char_limit_err_msg,isLengthy:!1,helperText:l.length_100_limit},{type:t.partSourceURL.length>0&&this.validateURL(t.partSourceURL)?"hyperlink":"text",label:this.NLS.part_url,placeholder:this.NLS.part_url,name:"SRC Part Source URL",value:t.partSourceURL,disable:!0,callBack:function(){window.open(this.value)}},{type:"string",label:this.NLS.organization,name:"organization",disable:!0,nonEditable:!0,value:t.organization?t.organization:""},{type:"string",label:this.NLS.collabspace,name:"collabSpace",disable:!0,nonEditable:!0,value:t.collabSpace?t.collabSpace:""}]},c.prototype.getMembersTabContainer=function(e){var t=c.prototype.createExpanderUWADiv("membersDiv");t.style.height="100%";var i=new UWA.Class.Model({id:e.data.respParams.id,changeAccess:e.data.respParams.modifyAccess,mediator:e.controller.app._mediator,modelEvent:e.controller.app._mediator.createNewChannel(),infoContainer:e.controller.app._triptychWrapper.getRightPanelContainer()});return new o({model:i}).render().inject(t),t},c.prototype.validateURL=function(e){var t=new RegExp("^(https?:\\/\\/)?((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.)+[a-z]{2,}|((\\d{1,3}\\.){3}\\d{1,3}))(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*(\\?[;&a-z\\d%_.~+=-]*)?(\\#[-a-z\\d_]*)?$","i");return!(!e||""===e)&&!!t.test(e)},c.prototype.getQualificationsTabContainer=function(e){var t=c.prototype.createExpanderUWADiv("vendorItemQualDiv");t.style.height="100%",e.isVendorItemQual=!0;var i=new UWA.Class.Model({options:e,qualDetails:e.data.respParams,controller:e.controller,mediator:e._mediator,modelEvent:e.app?e.app._mediator.createNewChannel():e._mediator.createNewChannel(),infoContainer:e.app?e.app._triptychWrapper.getRightPanelContainer():e._triptychWrapper.getRightPanelContainer()}),n=new s({model:i});return n.render().inject(t),c.vendorItemQualificationsView=n,t},c}),define("DS/ENOXComponentQualification/controllers/VendorItemsController",["DS/UIKIT/Mask","DS/ENOXComponentQualification/models/VendorItems","DS/ENOXSourcingUXInfra/Constants/ENOXSourcingConstants","DS/ENOXSourcingUXInfra/Utilities/HyperLinkHelper","DS/ENOXComponentQualification/views/VendorItems/OpenVendorItem","DS/ENOXSourcingUXInfra/LifeCycleView/LifeCycleViewBis"],function(e,t,i,n,o,a){"use strict";var r=function(e){this.app=e.app,this.NLS=this.app.i18NProvider,this.model=new t(this)};return r.prototype.getVendorItemsDetails=function(t){let i=this;return i.viewObj=t.viewObj,new Promise(function(n){e.mask(t.container,i.NLS.loading_VI),t.meiId?(t.postData={data:[{id:t.meiId}]},i.model.VendorItemsDetailsWithMei(t).then(function(e){n(e.data.map(e=>i.processVendorItem(e,t)))},function(e){widget.notificationUtil.showError(e.error)}).catch(function(e){widget.notificationUtil.showError(e.error)}).finally(function(){e.unmask(t.container)})):i.model.getProxyObjectId({data:t.proxyPayload}).then(function(o){t.meiId=o[t.proxyPayload.data[0].id],t.postData={data:[{id:t.meiId}]},i.model.VendorItemsDetailsWithMei(t).then(function(e){n(e.data.map(e=>i.processVendorItem(e,t)))},function(e){widget.notificationUtil.showError(e.error)}).catch(function(e){widget.notificationUtil.showError(e.error)}).finally(function(){e.unmask(t.container)})})})},r.prototype.getStatusbarIcons=function(e){let t="-";return e.options.grid.pack_size&&(t=e.options.grid.pack_size+" "+widget.getRangeValueNLS("Unit of Measure",e.options.grid.unit_of_measure)),["tokens",{label:t}]},r.prototype.getStatusbarIconsTooltips=function(e){let t="-";return e.options.grid.catalog_price&&(t=e.options.grid.currency+" "+e.options.grid.catalog_price),[this.NLS.catalog_price+": "+t,this.NLS.std_package_size]},r.prototype.processVendorItem=function(e,t){let i=e.dataelements?e.dataelements:e,n={title:i.title||i.Title,tree:i.title||i.Title,name:i.name,type:i.type,description:i.description,maturity_status:i.state,maturity_status_display:i.stateDisplay,owner:e.relateddata?e.relateddata.ownerInfo[0].dataelements.firstname+" "+e.relateddata.ownerInfo[0].dataelements.lastname:i.ownerInfo.firstname+" "+i.ownerInfo.lastname,partno:i["Part Number"],vendor:i.Vendor_Name,creation_date:i.originated,modified_date:i.modified,unit_of_measure:i.UnitofMeasure,pack_size:i["Pack Size"],catalog_price:i["Catalog Price"],catalog_price_source:i["Catalog Price Source"],image:"ENOXComponentQualification/assets/icons/VendorItem_Tile.png",id:i.physicalid,modifyAccess:i.modifyAccess,currency:i.Currency,partSource:i["SRC Part Source"],partSourceURL:i["SRC Part Source URL"],coo:i["Country of Origin"],catalog_price_actual_value:i.CatalogPrice_ActualValue,PackSize_ActualValue:i.PackSize_ActualValue,organization:i.organization,collabSpace:i.collabSpace},o="-";return n.partno&&null!==n.partno&&""!==n.partno&&(o=n.partno),{grid:n,label:i.title||i.Title,subLabel:n.maturity_status_display+" | "+this.NLS.part_number+": "+o,description:this.NLS.vendor+": "+n.vendor,thumbnail:require.toUrl(n.image),customTooltip:t?this._getCustomToolTip(t,n,["tree","maturity_status_display","partno","vendor"]):"",contextualMenu:[""],id:n.id}},r.prototype._getCustomToolTip=function(e,t,i){let n=e.columnsConfigurations,o="";for(let e=0;e<i.length;e++)for(let a=0;a<n.length;a++)if(i[e]===n[a].dataIndex){""!==o&&(o+="\n"),o=o+n[a].text+": "+t[i[e]];break}return o},r.prototype.getColumnConfiguration=function(e){let t=this;return[{text:t.NLS.title,dataIndex:"tree",resizableFlag:!0,sortableFlag:!0,pinned:"left",typeRepresentation:"url",hyperlinkTarget:"_self",property:"title",hyperlinkClickCallback:function(i){if(!e.forInfo){var n=i.nodeModel.options.grid.id;e.app._applicationChannel.publish({event:"information-panel-add-content",data:{openDetails:t.getQualificationOpenInInfoPanel(n)}}),e.app._applicationChannel.publish({event:"information-panel-open-without-reload-content"})}},getCellValue:function(t){let i={label:t.nodeModel.options.grid.title,url:"javascript:;",hyperlinkClickCallback:t.nodeModel.options.grid.grouped||e.forInfo?void 0:this.layout.getColumnOptionValue(t.columnID,"hyperlinkClickCallback")};return i.icon={iconPath:require.toUrl("ENOXComponentQualification/assets/icons/16/type_VendorItem_16x16.png"),iconSize:{height:"20px",width:"20px"}},i}},{text:t.NLS.part_number,dataIndex:"partno",sortableFlag:!0},{text:t.NLS.vendor,dataIndex:"vendor",sortableFlag:!0},{text:t.NLS.catalog_price,dataIndex:"catalogPrice",children:[{text:t.NLS.catalog_price,dataIndex:"catalog_price",sortableFlag:!0,typeRepresentation:"float",setCellValue:function(t,i){this.setCellValueHandler(t,i,"SRC_CatalogPrice","catalog_price",e)}.bind(this),getCellValue:function(e){if(e.nodeModel)return this.isCellInEdition(e.cellID)?e.nodeModel.options.grid.catalog_price_actual_value:e.nodeModel.options.grid.catalog_price},getCellEditableState:function(e){return e.nodeModel&&e.nodeModel.getAttributeValue("modifyAccess")===i.TRUE}},{text:t.NLS.currency,dataIndex:"currency",sortableFlag:!0,typeRepresentation:"currencyDropDown",setCellValue:function(t,i){this.setCellValueHandler(t,i,"Currency","currency",e)}.bind(this),getCellTooltip:function(e){let t=e.cellView.collectionView.model[e.rowID];if(t){let e={};return e.shortHelp=widget.getRangeValueNLS("Currency",t.getAttributeValue("currency")),e}},getCellEditableState:function(e){return e.nodeModel&&e.nodeModel.getAttributeValue("modifyAccess")===i.TRUE}},{text:t.NLS.coo,dataIndex:"coo",sortableFlag:!0,typeRepresentation:"countryDropDown",setCellValue:function(t,i){this.setCellValueHandler(t,i,"Country","coo",e)}.bind(this),getCellEditableState:function(e){return e.nodeModel&&e.nodeModel.getAttributeValue("modifyAccess")===i.TRUE}},{text:t.NLS.catalog_price_source,dataIndex:"catalog_price_source",sortableFlag:!0,minWidth:100,setCellValue:function(t,i){this.setCellValueHandler(t,i,"SRC_CatalogPriceSource","catalog_price_source",e)}.bind(this),getCellEditableState:function(e){return e.nodeModel&&e.nodeModel.getAttributeValue("modifyAccess")===i.TRUE}}]},{text:t.NLS.unit_of_measure,dataIndex:"unit_of_measure",sortableFlag:!0,typeRepresentation:"uomDropDown",setCellValue:function(t,i){this.setCellValueHandler(t,i,"Unit of Measure","unit_of_measure",e)}.bind(this),getCellEditableState:function(e){return e.nodeModel&&e.nodeModel.getAttributeValue("modifyAccess")===i.TRUE}},{text:t.NLS.std_package_size,dataIndex:"pack_size",sortableFlag:!0,typeRepresentation:"float",setCellValue:function(i,n){n<0?widget.notificationUtil.showError(t.NLS.err_positive_numbers_allowed):this.setCellValueHandler(i,n,"SRC_StandardPackageQuantity","pack_size",e)}.bind(this),getCellValue:function(e){if(e.nodeModel)return this.isCellInEdition(e.cellID)?e.nodeModel.options.grid.PackSize_ActualValue:e.nodeModel.options.grid.pack_size},getCellEditableState:function(e){return e.nodeModel&&e.nodeModel.getAttributeValue("modifyAccess")===i.TRUE}},{text:t.NLS.part_source,dataIndex:"partSource",sortableFlag:!0,setCellValue:function(t,i){this.setCellValueHandler(t,i,"SRC Part Source","partSource",e)}.bind(this),getCellEditableState:function(e){return e.nodeModel&&e.nodeModel.getAttributeValue("modifyAccess")===i.TRUE}},{text:t.NLS.part_url,dataIndex:"partSourceURL",sortableFlag:!0,setCellValue:function(t,i){this.setCellValueHandler(t,i,"SRC Part Source URL","partSourceURL",e)}.bind(this),getCellEditableState:function(e){return e.nodeModel&&e.nodeModel.getAttributeValue("modifyAccess")===i.TRUE}},{text:t.NLS.description,dataIndex:"description",sortableFlag:!0,setCellValue:function(t,i){this.setCellValueHandler(t,i,"description","description",e)}.bind(this),getCellEditableState:function(e){return e.nodeModel&&e.nodeModel.getAttributeValue("modifyAccess")===i.TRUE}},{text:t.NLS.maturity_state,dataIndex:"maturity_status_display",sortableFlag:!0,typeRepresentation:"url",hyperlinkTarget:"_self",hyperlinkClickCallback:function(i){e.selectedNodes=[i.nodeModel],e.data.id=e.id=i.nodeModel.options.grid.id,t.loadLifecycleView(e)},getCellValue:function(e){return{label:e.nodeModel.options.grid.maturity_status_display,url:"javascript:;",hyperlinkClickCallback:e.nodeModel.options.grid.grouped?void 0:this.layout.getColumnOptionValue(e.columnID,"hyperlinkClickCallback")}}},{text:t.NLS.creation_date,dataIndex:"creation_date",sortableFlag:!0,typeRepresentation:"datetime"},{text:t.NLS.modified_date,dataIndex:"modified_date",sortableFlag:!0,typeRepresentation:"datetime"}]},r.prototype.getQualificationOpenInInfoPanel=function(e){var t=this;let i={contextObjId:e,callControllerMethod:t,updateTable:function(e){var i=t.viewObj.tableView._gridModel.getAllDescendants().filter(t=>t._options.grid.id===e.grid.id);i&&1===i.length&&i[0]&&i[0].updateOptions(e)}};return(new n).getObjectDetailsInInfoPanel(i)},r.prototype.openInInformationPanel=function(t){let i=this;t.id=t.data.params.id,t.onComplete=function(e){let n=i.processVendorItem(e.data[0]);t.data.respParams=n.grid,t.getLifecyclePayload=i.buildGetLifecyclePayload(n.grid),new o(i).render(t)}.bind(i),t.onFailure=function(n){i.deleteData&&i.deleteData.map(e=>e.id).includes(t.id)||widget.notificationUtil.showError(n.error?n.error:n.message),e.unmask(widget.body)}.bind(i),i.model.VendorItemsDetails(t)},r.prototype.setCellValueHandler=async function(t,n,o,a,r){let l=t.nodeModel,s=this;if("SRC_CatalogPrice"===o||"SRC_StandardPackageQuantity"===o){if(l.setAttribute(a,n),!i.NUM_DECIMAL.test(n)||""===n)return l.setAttribute(a,t.cellModel),widget.notificationUtil.showError(s.NLS.please_enter_numbers),void e.unmask(widget.body)}let c={platformServices:this.platformServices};c.addData={data:[{id:l.options.grid.id,dataelements:{[o]:n.toString().trim()}}]},c.onComplete=function(t){let i=t.data[0];if(t.success){let t=s.processVendorItem(i,r);l.setAttribute(a,t.grid[a]),"SRC_CatalogPrice"===o?l.setAttribute("catalog_price_actual_value",t.grid.catalog_price_actual_value):"SRC_StandardPackageQuantity"===o&&l.setAttribute("PackSize_ActualValue",t.grid.PackSize_ActualValue),e.unmask(widget.body),widget.notificationUtil.showSuccess(t.grid.title+" "+s.NLS.updated_successfully)}},c.onFailure=function(t){widget.notificationUtil.showError(t.message?t.message:t.internalError.toString()),e.unmask(widget.body)},s.model.updateVendorItem(c)},r.prototype.loadLifecycleView=function(e){let t=this;e.app._applicationChannel.subscribeOnce({event:"maturity-state-updated-vendor-items"},function(i){e.selectedNodes.forEach(function(n){e.viewObj.tableView._gridModel.prepareUpdate(),n.setAttribute("maturity_status",i.state),n.setAttribute("maturity_status_display",i.stateDisplay);let o="-";i["Part Number"]&&null!==i["Part Number"]&&""!==i["Part Number"]&&(o=i["Part Number"]),n.options.subLabel=i.stateDisplay+" | "+t.NLS.part_number+": "+o,e.viewObj.tableView._gridModel.pushUpdate()})}),e.getLifecyclePayload=t.buildGetLifecyclePayload(e.selectedNodes[0].options.grid),t._initLifecycleModel(e),t.lifeCycleView.render()},r.prototype.buildGetLifecyclePayload=function(e){return{data:[{id:e.id,physicalid:e.id,type:e.type?e.type:e.actualType,identifier:e.id,source:i.SOURCE_SOURCING,relativePath:"/resources/v1/modeler/dssourcing/vendoritems"}]}},r.prototype.newVendorItem=function(e){let t=this;require(["DS/ENOXComponentQualification/views/VendorItems/NewVendorItem"],function(i){new i(t).render(e)})},r.prototype.processVendorItemForm=function(e){return{data:[{type:"SRC_VendorItem",VendorID:e.formValues.vendorId,"Part Number":e.formValues.vendor_part_number,MEI_ID:e.formValues.mei_id,UnitofMeasure:e.formValues.uom,"Pack Size":e.formValues.std_pack_size,Title:e.formValues.title,Currency:e.formValues.currency,"Country of Origin":e.formValues.coo,CatalogPrice:e.formValues.catalog_price,PartSourceURL:e.formValues.partSourceURL,partSource:e.formValues.partSource}]}},r.prototype.create=function(t){let i=this;e.mask(widget.getElement("div.modal-content"),i.NLS.creating_vendoritem),i.app._utility.disableOrEnableButton(!0),t.addData=this.processVendorItemForm(t),t.onComplete=function(e){if(e.success){let n=i.processVendorItem(e.data[0],t);t.collectionViewEvents.publish({event:"add-model",data:n});let o=e.data[0].title||e.data[0].Title;widget.notificationUtil.showSuccess(o+" "+i.NLS.vendoritem_created_successfully),t.app._applicationChannel.publish({event:"udated-vendor-item-count"}),t.createVICallback()}},t.onFailure=function(t){widget.notificationUtil.showError(t.message?t.message:t.internalError.toString()),e.unmask(widget.getElement("div.modal-content")),i.app._utility.disableOrEnableButton(!1)},this.model.create(t)},r.prototype.deleteVendorItems=function(t){let i=this,n=[];t.selectedNodes.forEach(e=>{n.push({id:e.getAttributeValue("id")})}),t.deleteData={data:n},e.mask(widget.body,i.NLS.deleting_vi),i.model.deleteVIs(t).then(function(){t.selectedNodes.forEach(e=>e.getTreeDocument().removeRoot(e)),t.collectionViewEvents.publish({event:"xsourcing-collectionview-update-count"}),!t.forInfo&&t.app._applicationChannel.publish({event:"information-panel-add-content",data:{selectedObject:null}}),widget.notificationUtil.showSuccess(i.NLS.vi_deleted_successfully),t.app._applicationChannel.publish({event:"udated-vendor-item-count"}),i.deleteData=n},function(e){widget.notificationUtil.showError(e.internalError?e.internalError:e.error?e.error:i.NLS.error_while_deleting_vi)}).catch(function(e){widget.notificationUtil.showError(e.error?e.error:i.NLS.error_while_deleting_vi)}).finally(function(){e.unmask(widget.body)})},r.prototype._initLifecycleModel=function(e){var t=this;t.input_options=e;var i=new UWA.Class.Model({modelEvent:e.app._mediator.createNewChannel(),id:e.data.id,modelOptionsToPass:e,dataProviderPromise:t.model.getLifeCycleDataProviderPromise(e),relativePath:"/resources/v1/modeler/dssourcing/vendoritems",callBackForExecuteCmd:function(){let i={};i.onComplete=function(t){e.app._applicationChannel.publish({event:"maturity-state-updated-vendor-items",data:t.data[0]})}.bind(t),i.onFailure=function(){},i.id=e.id,t.model.VendorItemsDetails(i)}});e.subscribeLifeCycleModification&&(i.set("subscribeLifeCycleModification",e.subscribeLifeCycleModification),i.set("applicationChannel",e.applicationChannel),i.set("forInfoPanel",e.forInfo)),this.lifeCycleModel=i,t.lifeCycleView=new a({model:i})},r}),define("DS/ENOXComponentQualification/views/ContextRestrictionsView/ContextRestrictionsView",["UWA/Core","UWA/Class/View","DS/UIKIT/Mask","DS/ENOXSourcingUXInfra/xsourcingCollectionView/xsourcingCollectionView","DS/Utilities/Dom","DS/UIKIT/SuperModal","DS/ENOXSourcingUXInfra/Constants/ENOXSourcingConstants","DS/ENOXSourcingUXInfra/Search/SearchUtility","DS/ENOXSourcingUXInfra/Search/ENOXSourcingSearch","DS/ENOXSourcingUXInfra/service/ENOXSourcingPlatformServices","DS/ENOXSourcingUXInfra/openwithservice/ENOXSourcingOpenWithService","DS/ENOXComponentQualification/helpers/QualificationHelper","css!DS/UIKIT/UIKIT.css"],function(e,t,i,n,o,a,r,l,s,c,d,u){"use strict";return t.extend({name:"context-restrictions-view",tagName:"div",domEvents:{},init:function(e){this.model=e.model,this.NLS=e.model.get("controller").NLS,this.searchUtil=new l,this.modelEvent=this.model.get("modelEvent"),this.qualHelper=new u({i18NProvider:this.NLS}),["container","template","tagName","domEvents"].forEach(function(t){delete e[t]}),this._parent(this,e)},setup:function(){this.container.addClassName(this.getClassNames("-container"))},update:function(){var e=this.outerDiv.parentElement.parentElement?this.outerDiv.parentElement.parentElement.getBoundingClientRect():this.outerDiv.parentElement.getBoundingClientRect();this.outerDiv.style.height=e.height+"px"},render:function(){var t=this;this.container.empty(),this.outerDiv=e.createElement("div",{class:"outerDiv",styles:{height:"100%"}}).inject(this.container),i.mask(this.container,t.NLS.loading_contextRestrictions);var l={data:[]};return t.loadData(),l._mediator=t.model.get("mediator"),l.showToolbar=!0,l.uniqueIdentifier="ContextRestrictionsView",l.toolbarActions=[{fonticon:"plus",text:t.NLS.add,id:"add",disabled:!t.isUpdateEnabled(),handler:function(){t.launchA3DSearch(t.tableView._gridModel.getChildren()?t.tableView._gridModel.getChildren().map(e=>e._options.grid.id):[])}},{fonticon:"remove",text:t.NLS.remove,id:"remove",disabled:!0,handler:function(){var e=t.tableView._gridModel.getSelectedNodes(),i=new a({renderTo:widget.body,okButtonText:t.NLS.remove}),n=1===e.length?e[0].options.label:e.length+" "+t.NLS.contextRestrictions_small;i.confirm(t.NLS.remove_confirmation,t.NLS.remove+" - "+n,function(i){i&&t.removeContextRestrictions(e)})}}],l.columnsConfigurations=[{sortableFlag:!0}],l.views=["Tile"],l.sort=[{id:"title",text:t.NLS.title,type:"string"}],l.onContextualEventCallback=function(e){var i=[];if(e){var n=e.cellInfos&&e.cellInfos.nodeModel?e.cellInfos.nodeModel:null;if(-1===(e.cellInfos?e.cellInfos.rowID:null)||!n)return this._contextualMenuBuilder?this._contextualMenuBuilder.buildMenu(e,l):[];var o=e.cellInfos.nodeModel?e.cellInfos.nodeModel:e.cellInfos.cellModel;if(o)return d.getOpenWithMenu(o).then(function(e){return i.push({id:"OpenWith",type:"PushItem",title:t.NLS.open_with,icon:"open-menu-dot",submenu:e}),i.push({type:"SeparatorItem"}),t.isUpdateEnabled()&&i.push({id:"remove",type:"PushItem",title:t.NLS.remove,icon:"remove",action:{callback:function(){let e=o.options.grid;new a({renderTo:widget.body,okButtonText:t.NLS.remove}).confirm(t.NLS.remove_confirmation,t.NLS.remove+" - "+e.title,function(e){e&&t.removeContextRestrictions([o])})}}}),i},function(){return t.isUpdateEnabled()&&i.push({id:"remove",type:"PushItem",title:t.NLS.remove,icon:"remove",action:{callback:function(){let e=o.options.grid;new a({renderTo:widget.body,okButtonText:t.NLS.remove}).confirm(t.NLS.remove_confirmation,t.NLS.remove+" - "+e.title,function(e){e&&t.removeContextRestrictions([o])})}}}),i})}return i},l.displayedOptionalCellProperties=["contextualMenu","description","subtitle"],t.tableView=new n,l.container=t.outerDiv,l.rowSelection="multiple",l.enableDrag=!0,t.tableView.init(l),l.dropStrategy="CREATE",l.multiObjs=!0,l.onDropCallback=async function(e){let i=t.searchUtil.getSearchPayload(e.map(e=>e.objectId),[],e.map(e=>e.serviceId),{completePreCond:r.CONTEXT_RESTRICTION_SEARCH_QUERY,nresults:e.length}),n=await t.searchUtil.callFederatedSearch(i);e[0]instanceof File||!n.results||n.results.length!==e.length?widget.notificationUtil.showError(t.NLS.invalid_object_dropped):t.addDroppedObj(n)},t.isUpdateEnabled()&&(l.dropArea=t.tableView._xsourcingCollectionViewUI.viewContainer,require(["DS/ENOXSourcingUXInfra/DragAndDrop/ENOXSourcingDataDragAndDrop"],function(e){(new e).makeAreaDroppable(l)})),t.tableView.collectionViewEvents.subscribe({event:"xsourcing-collectionview-selection-updated"},function(e){e.selectedItems.length>0?t.isUpdateEnabled()&&t.tableView.collectionViewEvents.publish({event:"xsourcing-collectionview-enable-toolbar-button",data:"remove"}):t.tableView.collectionViewEvents.publish({event:"xsourcing-collectionview-disable-toolbar-button",data:"remove"})}),t.modelEvent.subscribe({event:"add-model"},function(){t.loadData(),i.unmask(widget.body)}),o.addResizeListener(this.outerDiv,function(){t.update()},0),this.container},onDestroy:function(){return this.multidocdownloaderFrame.remove(),this._parent.apply(this,arguments)},isUpdateEnabled:function(){return"TRUE"===this.model.get("qualDetails").modifyAccess&&(this.model.get("qualDetails").maturityState===r.STATE_IN_DRAFT||this.model.get("qualDetails").maturityState===r.STATE_IN_WORK)},loadData:async function(){let e=this;e.container&&e.container.parentElement&&i.mask(e.container.parentElement,e.NLS.loading_contextRestrictions);let t=await e.model.get("controller").model.getContextRestrictions(e.model.get("qualDetails").id),n=await e.processContextRestrictionData(t.data);e.tableView._setData(n),e.tableView._xsourcingCollectionViewUI._allData=n,e.update(),e.model.get("controller").app._applicationChannel.publish({event:"update-context-restrictions-dgv",data:{contextRestrictions:n,qualId:e.model.get("qualDetails").id}}),e.container&&e.container.parentElement&&(i.unmask(e.container.parentElement),i.unmask(e.container))},processContextRestrictionData:async function(e){let t=this,i=[];if(e){let n=t.searchUtil.getSearchPayload(e.map(e=>e.id),[],[r.SOURCE_3DSPACE,r.SOURCE_3DPLAN],{completePreCond:r.CONTEXT_RESTRICTION_SEARCH_QUERY,nresults:e.length}),o=await t.searchUtil.callFederatedSearch(n),a={"ds6w:status":[]};t.model.get("controller").helper.processFedSearchData(o).forEach(n=>{a["ds6w:status"].push(n["ds6w:what/ds6w:status"]);let o=e.filter(e=>e.id===n.physicalid)[0],r=new Date(n["ds6w:when/ds6w:modified"]),l=`${r.getUTCMonth()+1}/${r.getUTCDate()}/${r.getUTCFullYear()}`,s=`${r.getUTCMonth()+1}/${r.getUTCDate()}/${r.getUTCFullYear()}  ${r.toLocaleString(widget.lang,{hour:"numeric",minute:"numeric",second:"numeric",hour12:!0})}`,c=t.qualHelper.getContextType(n);var d=[{label:t.NLS.title,data:n["ds6w:label"]},{label:t.NLS.type,data:c},{label:t.NLS.revision,data:n["ds6wg:revision"]},{label:t.NLS.maturity_state,data:o.dataelements.stateDisplay},{label:t.NLS.owner,data:n["ds6w:who/ds6w:responsible"]},{label:t.NLS.modified_date,data:s},{label:t.NLS.collabspace,data:n["ds6w:where/ds6w:context/ds6w:project"]},{label:t.NLS.name,data:n.name}];i.push({grid:{title:n["ds6w:label"],tree:n["ds6w:label"],name:n.name,id:n.physicalid,revision:n["ds6wg:revision"],state:n["ds6w:what/ds6w:status"],type:n["ds6w:what/ds6w:type"],actualType:n["ds6w:what/ds6w:type_value"]||n["ds6w:what/ds6w:type"],image:n.preview_url},label:n["ds6w:label"],subLabel:`${c} | ${n["ds6wg:revision"]} | ${o.dataelements.stateDisplay} | ${n["ds6w:who/ds6w:responsible"]} | ${l} | ${n["ds6w:where/ds6w:context/ds6w:project"]?n["ds6w:where/ds6w:context/ds6w:project"]:""}`,description:`${n.name}`,thumbnail:n.preview_url,tooltip:d,id:n.physicalid,proxy_id:o&&o.id?o.id:n.physicalid})})}return i},launchA3DSearch:function(e){let t=this;var i={multiSel:!0,resourceid_not_in:e,completePreCond:r.CONTEXT_RESTRICTION_SEARCH_QUERY,sources:[r.SOURCE_3DSPACE,r.SOURCE_3DPLAN],callbackMethod:function(e){t.addContextRestrictions(e)}};(new s).init(i)},addContextRestrictions:async function(e){let t=this;var n={sticky:!1,allowUnsafeHTML:!1,subtitle:""};let o={onFailure:function(e){n={level:"error",title:t.NLS.add_failed,subtitle:e.internalError&&500===e.statusCode?e.internalError:e.error?e.error:e},window.notifs.addNotif(n),i.unmask(widget.body)},onProgress:function(){i.mask(widget.body,t.NLS.adding_contextRestrictions)},onComplete:function(e){e=e.data,t.model.get("modelEvent")&&(t.model.get("modelEvent").publish({event:"add-model",data:e}),n={level:"success",title:t.NLS.contextRestrictions_added_successfully},window.notifs.addNotif(n),i.unmask(widget.body))},includeParams:"$include=context-restrictions"};if(o.id=t.model.get("qualDetails").id,o.addData={data:[]},c.getPlatformId()!==r.ONPREMISE){var a={data:[]};let i=r.CONTEXT_RESTRICTION_ALLOWED_TYPES,n=e.map(e=>e["ds6w:type_value"]||e["ds6w:type"]||e["ds6w:what/ds6w:type"]),l=(await t.model.get("controller").gettypeshierarchy(n)).types_hierarchies;e.forEach(e=>{let t=e.sourceid?e.sourceid.split(":")[0]:"",n=e.sourceid?e.sourceid.split(":")[1]:"",o=e["ds6w:type_value"]||e.type||e["ds6w:what/ds6w:type"],r=l.find(e=>e["ds6w:type_value"]===o||e.type===o||e["ds6w:what/ds6w:type"]===o),s=r&&r.hierarchy;a.data.push({id:e.id||e.physicalid||e.value||e.resourceid,type:i.includes(o)?o:s.filter(e=>i.includes(e))[0],dataelements:{"ProxyItem.Proxy_Title":e["ds6w:label"],"ProxyItem.Proxy_Service":t,"ProxyItem.Proxy_Tenant":n}})}),t.model.get("controller").model.getProxyObjectId({data:a}).then(function(e){Object.values(e).forEach(e=>{o.addData.data.push({dataelements:{contextrestriction_id:e,action:"connect"},children:[]})}),t.model.get("controller").model.updateContextRestrictions(o)})}else e.forEach(e=>{o.addData.data.push({dataelements:{contextrestriction_id:e.id||e.physicalid,action:"connect"}})}),t.model.get("controller").model.updateContextRestrictions(o)},removeContextRestrictions:function(e){let t=this;var n={sticky:!1,allowUnsafeHTML:!1,subtitle:""};let o={onFailure:function(e){n={level:"error",title:t.NLS.remove_failed,subtitle:e.internalError&&500===e.statusCode?e.internalError:e.error?e.error:e},window.notifs.addNotif(n),i.unmask(widget.body)},onProgress:function(){i.mask(widget.body,t.NLS.removing_contextRestrictions)},onComplete:function(e){e=e.data,t.model.get("modelEvent")&&(t.model.get("modelEvent").publish({event:"add-model",data:e}),n={level:"success",title:t.NLS.contextRestrictions_removed_successfully},window.notifs.addNotif(n),i.unmask(widget.body))},includeParams:"$include=context-restrictions"};o.id=t.model.get("qualDetails").id,o.addData={data:[]},e.forEach(e=>{o.addData.data.push({dataelements:{contextrestriction_id:c.getPlatformId()!==r.ONPREMISE?e.options.proxy_id:e.options.id,action:"disconnect"},children:[]})}),t.model.get("controller").model.updateContextRestrictions(o)},addDroppedObj:function(e){let t=[];this.model.get("controller").helper.processFedSearchData(e).forEach(e=>{t.push(e)}),this.addContextRestrictions(t)}})}),define("DS/ENOXComponentQualification/views/Qualification/OpenQualification",["DS/UIKIT/Mask","DS/ENOXComponentQualification/models/Qualification","DS/ENOXSourcingUXInfra/DetailsView/DetailsView","DS/ENOXSourcingUXInfra/PropertiesView/SRCRelatedObjectsView/RelatedObjectsView","DS/ENOXSourcingUXInfra/DocumentView/DocumentView","DS/ENOXSourcingUXInfra/LifeCycleView/LifeCycleViewBis","DS/ENOXSourcingUXInfra/MembersView/MembersView","DS/ENOXComponentQualification/helpers/QualificationHelper","DS/ENOXSourcingUXInfra/Constants/ENOXSourcingConstants","DS/ENOXSourcingUXInfra/service/ENOXSourcingPlatformServices","DS/ENOXSourcingUXInfra/CommonUtils/CommonUtils","DS/ENOXSourcingUXInfra/PropertiesView/EditPropertiesWidgetWrapper","DS/ENOXSourcingUXInfra/Utilities/HyperLinkHelper","DS/ENOXSourcingUXInfra/PropertiesView/3DComments/CommentsView","i18n!DS/ENOXSourcingUXInfra/assets/nls/ENOXSourcingUXInfra","DS/ENOXSourcingUXInfra/ProofsView/ProofsView","DS/ENOXComponentQualification/views/ContextRestrictionsView/ContextRestrictionsView","DS/ENOXSourcingUXInfra/ObjectHistory/SourcingTimeline","DS/ENOXSourcingUXInfra/Search/SearchUtility","DS/ENOXComponentQualification/controllers/VendorItemsController"],function(e,t,i,n,o,a,r,l,s,c,d,u,p,m,f,g,h,y,S,w){"use strict";var E=function(e){this.controller=e,this.NLS=this.controller.NLS,this.vendorItemController=new w({app:this.controller.app})},_={};return E.prototype.render=function(e){if(e.controller=this.controller,!e.detailsContainer){var t=widget.getElement(".information-panel.panel-icon-wrapper");t&&(t.style.display="none"),this.controller.app._applicationChannel.publish({event:"welcome-panel-hide"}),this.controller.app._applicationChannel.publish({event:"information-panel-hidden",data:null})}_=e,this.detailsView(e)},E.prototype.detailsView=function(e){var n=this,o={};this.addIdCardOptions(e,o),this.addTabOptions(e,o),e.detailsViewOptions=o;var a="/resources/v1/modeler/dssourcing/qualifications/generalqualifications";e.data.respParams.type===s.TYPE_QUALIFICATION_LIST[1]?a="/resources/v1/modeler/dssourcing/qualifications/equivalentqualifications":e.data.respParams.type===s.TYPE_QUALIFICATION_LIST[2]&&(a="/resources/v1/modeler/dssourcing/qualifications/usagequalifications");var r=new t(n.controller.app);let l=new UWA.Class.Model({modelEvent:e.app?e.app._mediator.createNewChannel():e._mediator.createNewChannel(),id:e.data.respParams.id,dataProviderPromise:r.getLifeCycleDataProviderPromise(e),relativePath:a,callBackForExecuteCmd:function(){c.getPlatformId()!==s.ONPREMISE&&n.callBackAfterSaveFromInfoPanel(e)}});e.lifeCycleModel=l;var u=new i;u.init(e),n.controller.app._applicationChannel.subscribe({event:"update-qualification-id-card"},function(t){var i=u.mIDCardContainer,o=n.getIDCardMenu(e,t.id,t.grid.maturityState,t.label),a=[{name:n.NLS.maturity_state,value:"",id:"maturityState",displayWhenMinified:!0,type:"type-text",editable:!0},{name:n.NLS.target_item,value:t.grid.mei_title?t.grid.mei_title:t.grid.mei_proxy_title,displayWhenMinified:!0},{name:n.NLS.owner,value:t.grid.owner,displayWhenMinified:!0},{name:n.NLS.revision,value:t.grid.revision,displayWhenMinified:!0},{name:n.NLS.creation_date,value:d.getDateStringForDisplay(t.grid.created)},{name:n.NLS.modified_date,value:d.getDateStringForDisplay(t.grid.modified)}];t.grid.type!==s.TYPE_QUALIFICATION_LIST[0]&&(a.splice(2,0,{name:n.NLS.context_item,value:t.grid.enterpriseItem,displayWhenMinified:!0}),a.splice(4,0,{name:n.NLS.preferred,value:t.grid.preferredDisplay,displayWhenMinified:!0})),i.getIDCard().model.unset("attributes"),i.getIDCard().model.set("attributes",a),i.getIDCard().model.set("dropdown",o),u.lifeCycleView.model.unset("maturityContainer"),u.lifeCycleView.model.set("maturityContainer",i)})},E.prototype.getQualificationLifeCycleUI=function(e){let i=this;var n="/resources/v1/modeler/dssourcing/qualifications/generalqualifications";e.data.respParams.type===s.TYPE_QUALIFICATION_LIST[1]?n="/resources/v1/modeler/dssourcing/qualifications/equivalentqualifications":e.data.respParams.type===s.TYPE_QUALIFICATION_LIST[2]&&(n="/resources/v1/modeler/dssourcing/qualifications/usagequalifications");var o=new t(i.controller.app);e.controller={app:i.controller.app};var r=new UWA.Class.Model({modelEvent:e.app?e.app._mediator.createNewChannel():e._mediator?e._mediator.createNewChannel():e.controller.app._mediator.createNewChannel(),id:e.data.respParams.id,dataProviderPromise:o.getLifeCycleDataProviderPromise(e),relativePath:n,callBackForExecuteCmd:function(){i.callBackAfterSaveFromInfoPanel(e)}});return new a({model:r})},E.prototype.addIdCardOptions=function(e,t){let i=this,n=e.data.respParams;t.idCardDetails={name:n.name,thumbnail:n.image,attributes:[{name:i.NLS.maturity_state,value:"",id:"maturityState",displayWhenMinified:!0,type:"type-text",editable:!0},{name:i.NLS.target_item,value:n.mei_title?n.mei_title:n.mei_proxy_title,displayWhenMinified:!0},{name:i.NLS.owner,value:n.owner,displayWhenMinified:!0},{name:i.NLS.revision,value:n.revision,displayWhenMinified:!0},{name:i.NLS.creation_date,value:d.getDateStringForDisplay(n.created)},{name:i.NLS.modified_date,value:d.getDateStringForDisplay(n.modified)}],dropdown:this.getIDCardMenu(e,n.id,n.maturityState,n.name)},n.type!==s.TYPE_QUALIFICATION_LIST[0]&&(t.idCardDetails.attributes.splice(2,0,{name:i.NLS.context_item,value:n.enterpriseItem,displayWhenMinified:!0}),t.idCardDetails.attributes.splice(4,0,{name:i.NLS.preferred,value:"TRUE"===n.preferred?i.NLS.Yes:i.NLS.No,displayWhenMinified:!0}))},E.prototype.getIDCardMenu=function(e,t,i,n){var o=this;let a=!1;return a=i===s.RELEASED||i===s.OBSOLETE,{items:[...e.data.respParams.type===s.TYPE_SRC_GENERAL_QUALIFICATION&&c.getPlatformId()!==s.ONPREMISE?[{text:o.NLS.add_extn_glob_qual,name:"addExtensions",fonticon:"plus",disabled:!1}]:[],{text:o.NLS.revise,name:"revise",fonticon:"flow-line-add",disabled:!a}],events:{onClick:function(i,a){"revise"===a.name&&o.controller.confirmRevisionAction(e,t,n),"addExtensions"===a.name&&require(["DS/ENOXSourcingAddAttributeGroup/AddAttributeGroupController"],function(t){let i=new t;e.callerSource="sourcing",e.endPoints=s.QUALIFICATION_EXTENSION_ENDPOINTS,e.applyExtensionCallback=o.applyExtensionCallback.bind(o),i.view(e,i,e.data.respParams.id,e.data.respParams.type,{},e.controller)})}}}},E.prototype.applyExtensionCallback=function(e){this.render(e)},E.prototype.addTabOptions=function(e,t){var i=this;t.showTabView=!0;let n=UWA.createElement("div",{styles:{height:"100%",width:"100%"}}),o=e.qualTimeline=new y({physicalId:e.data.respParams.id,objectTitle:e.data.respParams.name,historyContainer:n,activityMappingObject:{}});t.tabConfiguration=[{label:i.NLS.properties,content:E.prototype.addQualificationTabContainer(e),index:"1",value:"propertiesTblDiv",isSelected:!0,icon:{iconName:"attributes",fontIconFamily:1},events:{click:function(){i.controller.app._applicationChannel.publish({event:"make-information-panel-disappear",data:{forInfo:e.forInfo}})}}},{label:i.NLS.attachments,content:E.prototype.getDocumentTabContainer(e),index:"2",value:"documentTblDiv",reload:!1,view:E.documentView,icon:{iconName:"attach",fontIconFamily:1}},{label:i.NLS.members,content:E.prototype.getMembersTabContainer(e),index:"2",value:"membersDiv",icon:{iconName:"users",fontIconFamily:1},events:{click:function(){i.controller.app._applicationChannel.publish({event:"make-information-panel-disappear",data:{forInfo:e.forInfo}})}}},{label:f.proof,content:E.prototype.getProofsTabContainer(e),index:"3",value:"proofsDiv",isSelected:"proof"===e.data.params.tabToOpen,reload:!0,icon:{iconName:"doc-text-shield",fontIconFamily:1},events:{click:function(){var e=widget.getElement(".information-panel.panel-icon-wrapper");e&&(e.style.display="none")}}},{label:c.getPlatformId()===s.ONPREMISE?i.NLS.relations:i.NLS.relatedObjects,content:E.prototype.getRelationsTabContainer.call(i,e),index:"4",value:"relationsDiv",icon:{iconName:"object-related",fontIconFamily:1}},{label:i.NLS.context_restrictions,content:E.prototype.getContextRestrictionsTabContainer(e),index:"5",isSelected:"context_restrictions"===e.data.params.tabToOpen,reload:!0,value:"contextRestrictionsDiv",icon:{iconName:"attributes-persistent",fontIconFamily:1}},{label:i.NLS.activity,content:n,index:"6",value:"activity",icon:{iconName:"clock",fontIconFamily:1},reload:!0,view:o,events:{click:function(){}}},{label:i.NLS.comments,content:E.prototype.get3DCommentsContainer.call(i,e),index:"7",reload:!0,value:"commentsDiv",icon:{iconName:"comment",fontIconFamily:1}}]},E.prototype.getDocumentTabContainer=function(e){let i=this;i.NLS=i.NLS?i.NLS:e.controller.NLS;var n=E.prototype.createExpanderUWADiv("documentDiv");n.style.height="100%";var a=new t(e.controller.app),r=new l(e.controller.app),s={},c=new UWA.Class.Model({parentOptions:e,fromInfoPanel:e.forInfo,contextObject:a,mediator:e.controller.app._mediator,modelEvent:e.controller.app._mediator.createNewChannel(),infoContainer:e.controller.app._triptychWrapper.getRightPanelContainer(),additionalHeaders:{},applicationChannel:e.controller.app._applicationChannel,triptychWrapper:e.controller.app._triptychWrapper,isSpecification:!1,controller:e.controller,isDragDropAllowed:Boolean("TRUE"===e.data.respParams.modifyAccess),isUpdateAllowed:Boolean("TRUE"===e.data.respParams.modifyAccess),state:e.data.respParams.qualificationMaturity,helper:r,processForObject:function(t){i.processDocumentInfo(t,e,s)}});return s=new o({model:c}),E.documentView=s,s.render().inject(n),n},E.prototype.processDocumentInfo=async function(i,n,o){let a=this;var r=new t(n.controller.app),l=i[0],d={sticky:!1,allowUnsafeHTML:!1,subtitle:""};let u=l["ds6w:label"]?l["ds6w:label"]:"",p=l.sourceid?l.sourceid.split(":")[0]:s.SOURCE_3DSPACE,m=l.sourceid?l.sourceid.split(":")[1]:c.getPlatformId();var f={data:[{id:l.id,type:s.DOCUMENT,dataelements:{"ProxyItem.Proxy_Title":u,"ProxyItem.Proxy_Service":p.toLowerCase(),"ProxyItem.Proxy_Tenant":m}}]},g={data:[{type:l["ds6w:type"]?l["ds6w:type"]:"",dataelements:{document_ID:l.id,purpose:l.purpose}}]};n.attachDocumentData=g;let h=function(){r.attachDocument(n).then(function(t){o&&o.modelEvent&&(d=i[0]["ds6w:label"]?{level:"success",title:a.NLS.document_added_successfully}:{level:"success",title:a.NLS.document_uploaded_successfully},o.modelEvent.publish({event:"add-model",data:t}),window.notifs.addNotif(d),e.unmask(widget.body))},function(t){d={subtitle:t&&t.internalError&&500===t.statusCode?t.internalError:t&&t.error?t.error:t||a.NLS.upload_failed,level:"error",title:a.NLS.upload_failed},window.notifs.addNotif(d),e.unmask(widget.body)})};l&&l.sourceid&&!l.sourceid.toLocaleLowerCase().contains(s.SOURCE_SOURCING)&&s.ONPREMISE!==c.getPlatformId()?r.getProxyObjectId({data:f}).then(function(e){g.data[0].dataelements.document_ID=e[l.id],h()}):h()},E.prototype.createExpanderUWADiv=function(e){return UWA.createElement("div",{id:e,styles:{position:"relative"}})},E.prototype.getMembersTabContainer=function(e){var t=E.prototype.createExpanderUWADiv("membersDiv");t.style.height="100%";var i=new UWA.Class.Model({id:e.data.respParams.id,changeAccess:e.data.respParams.changeAccess,excludeQuery:'AND NOT [ds6w:identifier]:("'+e.data.respParams.ownerIdentifier+'")',mediator:e.controller.app._mediator,modelEvent:e.controller.app._mediator.createNewChannel(),infoContainer:e.controller.app._triptychWrapper.getRightPanelContainer()});return new r({model:i}).render().inject(t),t},E.prototype.getRelationsTabContainer=function(e){let t=this,i=E.prototype.createExpanderUWADiv("relationsDiv");if(i.style.height="100%",c.getPlatformId()===s.ONPREMISE){let t={container:i,facets:["FACET_RELATIONS"],showIdCard:!1},n={objectId:e.data.params.id?e.data.params.id:e.data.params.qualificationId},o=new u({viewOptions:t,dataOptions:n});void 0!==n.objectId&&o.render()}else t.getSRCRelatedObjectsView({options:e,relationsContainer:i});return i},E.prototype.getSRCRelatedObjectsView=async function(t){let i=this;e.mask(t.relationsContainer,i.NLS.loading),t.options.data.respParams.qualificationProofs=await i.controller.getProofsData(t.options.data.respParams.id),_.controller.helper.processDataForRelationsTab({data:t.options.data.respParams}).then(e=>{let o=new UWA.Class.Model({data:e,ctxCallback:function(e){let n=e.options.id;if(s.TYPE_QUALIFICATION_LIST.includes(e.options.grid.type)){let e={contextObjId:n,callControllerMethod:_.controller};t.options.controller.app._applicationChannel.publish({event:"information-panel-add-content",data:{openDetails:(new p).getObjectDetailsInInfoPanel(e)}}),t.options.controller.app._applicationChannel.publish({event:"information-panel-open-without-reload-content"})}else if(s.VPMREFERENCE===e.options.grid.type||s.TYPE_MODEL===e.options.grid.type||s.DELFMIFUNCTIONREFERENCE_TYPES.includes(e.options.grid.type)){let e={container:t.options.controller.app._triptychWrapper.getRightPanelContainer(),facets:["FACET_PROPERTIES","FACET_SWYMCOMMENTS","FACET_RELATIONS"]},i={objectId:n},o=function(){new u({viewOptions:e,dataOptions:i}).render()};t.options.controller.app._applicationChannel.publish({event:"information-panel-add-content",data:{openDetails:o}}),t.options.controller.app._applicationChannel.publish({event:"information-panel-open-without-reload-content"})}else if(e.options.grid.actualType===s.TYPE_VENDOR_ITEM){let e=i.vendorItemController.getQualificationOpenInInfoPanel(n);t.options.controller.app._applicationChannel.publish({event:"information-panel-add-content",data:{openDetails:e}}),t.options.controller.app._applicationChannel.publish({event:"information-panel-open-without-reload-content"})}else if(s.DSPLAN_PROJECT===e.options.grid.type){let e=encodeURIComponent(n.replace("<","").replace(">",""));window.open(c._platforms[s.SERVICE_3DDASHBOARD]+"#dashboard:/tab:/app:ENXPLAN_AP/content:ids="+e+"&tenant="+c.getPlatformId()+"&x3dPlatformId="+c.getPlatformId())}else window.open(c._platforms[s.SERVICE_3DSPACE]+"/common/emxNavigator.jsp?objectId="+n)}}),a=new n({model:o});window.relatedQualificationReference&&(window.srcRelatedObjectsView=a),a.render().inject(t.relationsContainer)}).catch(function(){widget.notificationUtil.showError(i.NLS.error_loading_related_objects)}).finally(function(){e.unmask(t.relationsContainer)})},E.prototype.get3DCommentsContainer=function(t){let i=UWA.createElement("div",{id:"commentsDiv",styles:{position:"relative"}});return i.style.height="100%",this.get3DCommentsView({options:t,container:i}),e.unmask(i),i},E.prototype.get3DCommentsView=function(t){e.mask(t.container,this.NLS.loading),new m({data:{id:t.options.data.respParams.id,type:s.TYPE_QUALIFICATION,appID:"ENXSPIQ_AP"}}).render().inject(t.container)},E.prototype.getProofsTabContainer=function(e){var t=E.prototype.createExpanderUWADiv("proofsDiv");t.style.height="100%";var i=new UWA.Class.Model({qualDetails:e.data.respParams,controller:e.controller,mediator:e._mediator,modelEvent:e.app?e.app._mediator.createNewChannel():e._mediator.createNewChannel(),infoContainer:e.app?e.app._triptychWrapper.getRightPanelContainer():e._triptychWrapper.getRightPanelContainer()}),n=new g({model:i});return n.render().inject(t),E.proofsView=n,t},E.prototype.getContextRestrictionsTabContainer=function(e){var t=E.prototype.createExpanderUWADiv("contextRestrictionsDiv");t.style.height="100%";var i=new UWA.Class.Model({qualDetails:e.data.respParams,controller:e.controller,mediator:e._mediator,modelEvent:e.app?e.app._mediator.createNewChannel():e._mediator.createNewChannel(),infoContainer:e.app?e.app._triptychWrapper.getRightPanelContainer():e._triptychWrapper.getRightPanelContainer()}),n=new h({model:i});return n.render().inject(t),E.contextRestrictionsView=n,t},E.prototype.addQualificationTabContainer=function(e){let t=this;t.options=e;let i={container:e._triptychWrapper.getRightPanelContainer(),facets:["FACET_PROPERTIES"],typeOfDisplay:"editProp_onlyProperties",showIdCard:!1,readOnly:Boolean("FALSE"===e.data.respParams.modifyAccess),editMode:!1};(new S).getPlatfromAPIObj().unsubscribe("DS/PADUtils/PADCommandProxy/refresh"),(new S).getPlatfromAPIObj().subscribe("DS/PADUtils/PADCommandProxy/refresh",i=>{e.data.params.qualificationId===i.data.authored.modified[0]&&t.callBackAfterSaveFromInfoPanel(t.options)});let n={objectId:e.data.params.qualificationId},o=new u({viewOptions:i,dataOptions:n});o.render();let a=o.tabContainer;return o.tabContainer.elements&&o.tabContainer.elements.container&&(a=o.tabContainer.elements.container),a},E.prototype.callBackAfterSaveFromInfoPanel=function(e){let i=new t(e.controller.app),n=new l(e.controller.app);i.getDetails(e).then(function(t){n.process1(t).then(function(t){var i=t[0];e.applicationChannel.publish({event:"update-qualification-id-card",data:i}),e.updateTableFunction&&e.updateTableFunction(i),e.updateQualificationTable&&e.updateQualificationTable(i),e.qualTimeline&&e.qualTimeline.historyApplicationChannel&&e.qualTimeline.historyApplicationChannel.publish({event:"reload-history-content",data:{}})})})},E}),define("DS/ENOXComponentQualification/controllers/QualificationController",["DS/UIKIT/Mask","DS/ENOXComponentQualification/models/Qualification","DS/ENOXComponentQualification/models/ManufacturerEquivalentItem","DS/ENOXComponentQualification/views/Qualification/NewQualification","DS/ENOXComponentQualification/views/Qualification/OpenQualification","DS/ENOXComponentQualification/helpers/QualificationHelper","DS/ENOXComponentQualification/helpers/MEIHelper","DS/UIKIT/SuperModal","DS/ENOXSourcingUXInfra/Constants/ENOXSourcingConstants","DS/ENOXSourcingUXInfra/CommonUtils/CommonUtils"],function(e,t,i,n,o,a,r,l,s,c){"use strict";var d=function(e){this.app=e.app,this.NLS=this.app.i18NProvider,this.model=new t(this.app),this.meiModel=new i,this.meiHelper=new r(this),this.helper=new a(this.app),this.searchUtil=this.helper.searchUtil};return d.prototype.newQualification=function(e){new n(this).render(e)},d.prototype.createNoUI=function(t){var i=this,n={data:[{id:t.formValues.targetId,type:s.MEI_PROXY,dataelements:{"ProxyItem.Proxy_Title":t.formValues.title,"ProxyItem.Proxy_Service":t.formValues.source,"ProxyItem.Proxy_State":t.formValues.status_value,"ProxyItem.Proxy_Tenant":t.formValues.tenant}}]};i.model.getProxyObjectId({data:n}).then(function(e){let n=e[t.formValues.targetId];t.formValues.targetId=n,t.addData=i.wrapData(i.processMEIForm(t.formValues)),t.onComplete=function(e){i.helper.process1(e).then(function(e){var t=e[0];widget.notificationUtil.showSuccess(i.NLS.qualification+' "'+t.grid.name+'" '+i.NLS.created_successfully),i.app._applicationChannel.publish({event:"qualification-created",data:t})})}.bind(i),t.onFailure=function(e){widget.notificationUtil.showError(e.error?e.error:i.NLS.error_while_creating_qualification),i.app._applicationChannel.publish({event:"qualification-created",data:{}})}.bind(i),i.model.create(t)}).catch(function(){widget.notificationUtil.showError(i.NLS.error_getting_proxy_sourcing)}).finally(function(){e.unmask(widget.body)})},d.prototype.create=function(t){var i=this;t.addData=this.wrapData(this.processFormValues(t.formValues)),t.onComplete=function(n){t.qualificationCreateCallBack(),t.isVendorItemQual?i.app._applicationChannel.publish({event:"add-vendor-qual"}):i.helper.process1(n).then(function(t){var n=t[0];i.app._applicationChannel.publish({event:"add-model",data:n}),e.unmask(widget.body)}),widget.notificationUtil.showSuccess(i.NLS.qualification+' "'+n.data[0].dataelements.name+'" '+i.NLS.created_successfully)}.bind(this),t.onFailure=function(n){t.createFailureCallback&&t.createFailureCallback(),widget.notificationUtil.showError(n.internalError&&500===n.statusCode?n.internalError:n.error?n.error:i.NLS.error_while_creating_qualification),e.unmask(widget.body)}.bind(this),e.mask(widget.body,i.NLS.creating_qualification),this.model.create(t)},d.prototype.showDetails=function(t){var i=this;e.mask(widget.body,i.NLS.opening_qualification),t.data.params={qualificationId:t.data.id},i.model.getDetails(t).then(function(n){i.helper.process1(n).then(function(n){t.data.respParams=n[0].grid,t.getLifecycleData=i.buildGetLifecyclePayload(t),new o(i).render(t),e.unmask(widget.body)})},function(e){widget.notificationUtil.showError(i.NLS.error_getting_qualification_details),i.app.logger.error(e.internalError&&500===e.statusCode?e.internalError:e.error)}).catch(function(e){widget.notificationUtil.showError(i.NLS.error_getting_qualification_details),i.app.logger.error(e.message?e.message:e.toString())}).finally(function(){e.unmask(widget.body)})},d.prototype.openQualificationInformation=function(t){var i=this;let n="context_restrictions"===t.data.params.tabToOpen?i.NLS.opening_context_restriction:"proof"===t.data.params.tabToOpen?i.NLS.opening_proof:i.NLS.opening_qualification;e.mask(t.detailsContainer,n),t.data.params.qualificationId=t.data.params.id,t.includeParams="$include=context-restrictions,target,Context",i.model.getDetails(t).then(function(n){i.helper.process1(n).then(async function(n){n[0].grid.extensionDetails&&n[0].grid.extensionDetails.forEach(e=>{e.options.forEach(e=>{if("timestamp"===e.dataelements.type&&e.dataelements.displayRanges){let t=c.getDateStringForDisplay(e.dataelements.value);e.dataelements.value=t.substring(0,t.lastIndexOf(",")),e.dataelements.displayRanges.forEach((t,i)=>{let n=c.getDateStringForDisplay(t);e.dataelements.displayRanges[i]=n.substring(0,n.lastIndexOf(","))})}})}),t.data.respParams=n[0].grid,t.getLifecycleData=i.buildGetLifecyclePayload(t),new o(i).render(t),e.unmask(t.detailsContainer)})},function(e){widget.notificationUtil.showError(e.internalError&&500===e.statusCode?e.internalError:e.error)}).catch(function(e){widget.notificationUtil.showError(e.message?e.message:e.toString())}).finally(function(){e.unmask(widget.body)})},d.prototype.openInInformationPanel=function(e){this.openQualificationInformation(e)},d.prototype.processMEIForm=function(e){return{type:"type_SRCGeneralQualification",dataelements:{Target_ID:e.targetId,"attribute_SRCQUALIFICATION.Preferred":e.preferred,"attribute_SRCQUALIFICATION.Comments":e.qualificationComments,"attribute_SRCGeneralQualification.IsOrderable":e.orderable,"context-restrictions":e["context-restrictions"],Title:e.qualTitle}}},d.prototype.processFormValues=function(e){var t={Target_ID:e.targetId,"attribute_SRCQUALIFICATION.Preferred":e.preferred,"attribute_SRCQUALIFICATION.Comments":e.qualificationComments,Title:e.title};"type_SRCGeneralQualification"===e.type&&(t=UWA.merge(t,{"attribute_SRCGeneralQualification.IsOrderable":e.orderable}));var i={type:e.type||"type_SRCGeneralQualification",dataelements:t};return"type_SRCEquivalentQualification"!==e.type&&"type_SRCUsageQualification"!==e.type&&"type_SRCManufacturingEquivalentQualification"!==e.type||(t.Context_ID=e.contextId),"type_SRCEquivalentQualification"!==e.type&&"type_SRCManufacturingEquivalentQualification"!==e.type&&"type_SRCGeneralQualification"!==e.type||(t["context-restrictions"]=e["context-restrictions"]),"type_SRCUsageQualification"===e.type&&(t.PreReq_ID=e.targetId),i},d.prototype.wrapData=function(e){return{data:[e]}},d.prototype.update=function(e){this.model.updateEquivalentQualification(e)},d.prototype.updatePromise=function(e){return this.model.updateQualificationPromise(e)},d.prototype.reviseQualification=function(t){var i=this;e.mask(widget.body,i.NLS.creating_qual_revision),this.model.reviseQualification(t).then(function(t){i.helper.process1(t).then(function(t){var n=t[0];i.app._applicationChannel.publish({event:"add-model",data:n}),void 0!==n&&(e.unmask(widget.body),widget.notificationUtil.showSuccess(i.NLS.qualification+' "'+n.grid.name+'" '+i.NLS.created_successfully))})},function(e){widget.notificationUtil.showError(e.internalError&&500===e.statusCode?e.internalError:e.error?e.error:i.NLS.error_while_creating_qualification)}).catch(function(e){widget.notificationUtil.showError(e.message?e.message:e.toString())}).finally(function(){e.unmask(widget.body)})},d.prototype.gridCellUpdate=function(e,t,i,n,o){var a=this;t.nodeModel.options.grid.qualificationid?e.qualId=t.nodeModel.options.grid.qualificationid:(e.qualId=t.nodeModel.options.grid.equivalentQualificationId?t.nodeModel.options.grid.equivalentQualificationId:t.nodeModel.options.grid.usageQualificationId,e.qualId=e.qualId?e.qualId:t.nodeModel.options.grid.qualId);var r="";r=t.nodeModel.options.grid.qualificationtype?t.nodeModel.options.grid.qualificationtype:t.nodeModel.options.grid.qual_type?t.nodeModel.options.grid.qual_type:t.nodeModel.options.grid.qua_type,e.addData={data:[{type:r,dataelements:{[n]:i}}]},this.updatePromise(e).then(function(i){widget.notificationUtil.showSuccess(o+'"'+i.data[0].dataelements.name+'"');let n={qualificationComments:i.data[0].dataelements["SRC Comments"],preferred:i.data[0].dataelements["SRC Preferred"],preferredDisplay:"TRUE"===i.data[0].dataelements["SRC Preferred"]?a.NLS.yes:a.NLS.no,qualtitle:i.data[0].dataelements.title};i.data[0].type!==s.TYPE_QUALIFICATION_LIST[1]&&i.data[0].type!==s.TYPE_QUALIFICATION_LIST[2]&&i.data[0].type!==s.TYPE_QUALIFICATION_LIST[3]||(n.approved=i.data[0].dataelements["SRC Approved"],n.approved_display=a.NLS[i.data[0].dataelements["SRC Approved"]],n.approvedDisplay=a.NLS[i.data[0].dataelements["SRC Approved"]],n.eq_prefered=i.data[0].dataelements["SRC Preferred"],n.eq_prefered_display="TRUE"===i.data[0].dataelements["SRC Preferred"]?a.NLS.yes:a.NLS.no),i.data[0].type===s.TYPE_QUALIFICATION_LIST[0]&&(delete n.preferred,delete n.preferredDisplay,n.genapproved=i.data[0].dataelements["SRC Approved"],n.genapproved_display=a.NLS[i.data[0].dataelements["SRC Approved"]],e.fromRelatedQualifications?(n.approved=n.genapproved=i.data[0].dataelements["SRC Approved"],n.approvedDisplay=n.genapproved_display=a.NLS[i.data[0].dataelements["SRC Approved"]]):delete n.qualificationComments),t.nodeModel.updateOptions({grid:n})},function(e){widget.notificationUtil.showError(e.internalError&&500===e.statusCode?e.internalError:e.error),t.nodeModel.updateOptions({})}).catch(function(e){widget.notificationUtil.showError(e.message?e.message:e.toString()),t.nodeModel.updateOptions({})})},d.prototype.gridCellUpdateV2=function(e){let t={qualId:e.id,addData:{data:[{type:e.type,dataelements:{[e.attribute]:e.value}}]}};return new Promise(i=>{this.updatePromise(t).then(function(t){e.forVendorItem||widget.notificationUtil.showSuccess(e.successMessage+'"'+t.data[0].dataelements.name+'"'),i(t)},function(t){widget.notificationUtil.showError(t.internalError&&500===t.statusCode?t.internalError:t.error),e.cellInfos.nodeModel.updateOptions({})}).catch(function(t){widget.notificationUtil.showError(t.message?t.message:t.toString()),e.cellInfos.nodeModel.updateOptions({})})})},d.prototype.getDetails=function(e){return this.model.getDetails(e)},d.prototype.getQualificationDetails=function(e){return(new t).getDetails(e)},d.prototype.buildGetLifecyclePayload=function(e){var t="/resources/v1/modeler/dssourcing/qualifications/generalqualifications";return"SRC Engineering Equivalent Qualification"===e.data.params.type?t="/resources/v1/modeler/dssourcing/qualifications/equivalentqualifications":"SRC Usage Qualification"===e.data.params.type&&(t="/resources/v1/modeler/dssourcing/qualifications/usagequalifications"),{data:[{id:e.data.respParams.id,physicalid:e.data.respParams.id,type:e.data.respParams.type,identifier:e.data.respParams.id,source:"Sourcing",relativePath:t}]}},d.prototype.closeTagger=function(){this.taggerProxy&&this.taggerProxy.onCloseTagger()},d.prototype.setDataForTagger=function(e,t){var i=s.TAGGER_QUALIFICATION;this.taggerProxy.setTaggerProxyOpts(e,t,i)},d.prototype.confirmRevisionAction=function(e,t,i){var n=this;let o=e.selectedNodes?e.selectedNodes[0].getAttributeValue("actualType"):e.data.respParams.actualType;e.objectToConnectDetails=n.helper.processReviseObjectsToConnect(n.app.router.getRouter().getState().name,o),e.addData=n.helper.getRevisePayload(t),new l({renderTo:widget.body,className:"revise-dialog"}).dialog({body:e.objectToConnectDetails.reviseConfirmationMessage,title:n.NLS.revise+" - "+i,buttons:[{className:"primary",value:n.NLS.Yes,action:function(t){t.hide(),e.addData.data[0].dataelements.objectToConnect=e.objectToConnectDetails.objectToConnect,n.reviseQualification(e)}},{className:"default",value:n.NLS.No,action:function(t){t.hide(),n.reviseQualification(e)}},{className:"default",value:n.NLS.CANCEL_BUTTON,action:function(e){e.hide()}}]})},d.prototype.reviseQualificationItem=function(e,t){if(t.selectedNodes=e.xsourcingCollectionView?e.xsourcingCollectionView._gridModel.getSelectedNodes():e.tableView._gridModel.getSelectedNodes(),t.contextualNode&&(t.selectedNodes=t.contextualNode.slice()),t.contextualNode=void 0,t.selectedNodes.length>0){let i=t.selectedNodes[0].options.grid.maturityState;if(i!==s.RELEASED&&i!==s.OBSOLETE)widget.notificationUtil.showError(e.NLS.qual_released_obsolete_msg);else{let e=t.selectedNodes[0].getAttributeValue("id"),i=t.selectedNodes[0].options.label;this.confirmRevisionAction(t,e,i)}}},d.prototype.decideRouteUsingURL=async function(e){var t=this;if(!e.data.items[0].objectId||-1===e.data.items[0].objectType.search(s.QUALIFICATION)&&-1===e.data.items[0].objectType.search(s.TYPE_QUALIFICATION))if(e.data.items[0].objectTaxonomies&&e.data.items[0].objectTaxonomies.includes(s.MEI_EXTENSION))t.app.router.navigate("home.MEIDetails",{id:e.data.items[0].objectId});else if(e.data.items[0].objectTaxonomies&&e.data.items[0].objectTaxonomies.includes(s.VPMREFERENCE)||e.data.items[0].objectType===s.VPMREFERENCE)if(e.data.items[0].objectTaxonomies){let i={id:e.data.items[0].objectId,title:e.data.items[0].displayName,getData:!0,pid:e.data.items[0].objectId};t.app.router.navigate(s.ENG_ITEM_DETAILS_PAGE_ROUTE,i)}else{let i=t.searchUtil.getSearchPayload(e.data.items[0].objectId,[s.VPMREFERENCE],[]),n=await t.searchUtil.callFederatedSearch(i);if(t.helper.processFedSearchData(n)[0]["ds6w:what/ds6w:kind_value"]===s.MEI_EXTENSION)t.app.router.navigate("home.MEIDetails",{id:e.data.items[0].objectId});else{let i={id:e.data.items[0].objectId,title:e.data.items[0].displayName,getData:!0,pid:e.data.items[0].objectId};t.app.router.navigate(s.ENG_ITEM_DETAILS_PAGE_ROUTE,i)}}else if(s.DELFMIFUNCTIONREFERENCE_TYPES.includes(e.data.items[0].objectType)){let i={id:e.data.items[0].objectId,title:e.data.items[0].displayName,getData:!0,pid:e.data.items[0].objectId};t.app.router.navigate(s.MFG_ITEM_DETAILS_PAGE_ROUTE,i)}else widget.notificationUtil.showError(this.NLS.object_unsupported);else{let i={data:{params:{qualificationId:e.data.items[0].objectId}}};t.model.getDetails(i).then(function(e){let i=e.data[0].relateddata.target[0];if(i.dataelements.interface===s.MEI_EXTENSION||i.dataelements.type===s.MEI_PROXY)t.app.router.navigate("home.MEIDetails",{id:i.dataelements.Proxy_Id||i.id,qualIdToHighlight:e.data[0].id});else if(i.dataelements.type===s.TYPE_VENDOR_ITEM){let i=e.data[0].relateddata.Context[0];t.app.router.navigate("home.OpenManufacturingItem",{pid:i.dataelements.Proxy_Id||i.id,qualIdToHighlight:e.data[0].id})}else widget.notificationUtil.showError(t.NLS.openWithQFM)})}},d.prototype.getProofsData=async function(e){let t=await this.model.getProofs(e);return await this.processProofsData(t.data)},d.prototype.processProofsData=async function(e){let t=this,i=[];if(e){let n=t.searchUtil.getSearchPayload(e.map(e=>e.dataelements.Proxy_Id),[s.DOCUMENT,s.TYPE_TEST_SPECIFICATION],[]),o=await t.searchUtil.callFederatedSearch(n);t.helper.processFedSearchData(o).forEach(t=>{let n=e.filter(e=>e.dataelements.Proxy_Id===t.physicalid)[0];n&&i.push({grid:{title:t["ds6w:label"],tree:t["ds6w:label"],name:t.name,id:t.physicalid,revision:t["ds6wg:revision"],state:t["ds6w:what/ds6w:status"],type:t["ds6w:what/ds6w:type"],actualType:t["ds6w:what/ds6w:type_value"]||t["ds6w:what/ds6w:type"],image:t.preview_url,source:n.Proxy_Service?n.Proxy_Service:t.type!==s.QUALIFICATION_PROOF_PROXY?s.SERVICE_3DSPACE:s.SOURCE_SOURCING,service:n.Proxy_Service?n.Proxy_Service===s.SOURCE_3DSPACE?s.SERVICE_3DSPACE:n.Proxy_Service:t.type!==s.QUALIFICATION_PROOF_PROXY?s.SERVICE_3DSPACE:s.SOURCE_SOURCING},label:t["ds6w:label"],subLabel:t["ds6w:what/ds6w:status"],thumbnail:t.preview_url,id:t.physicalid,proxy_id:n.id})})}return i},d.prototype.gettypeshierarchy=function(e){let t=this;return new Promise((i,n)=>{t.model.gettypeshierarchy(e).then(function(e){i(e)},function(e){n(e)}).catch(function(){widget.notificationUtil.showError(t.NLS.internal_server_error)})})},d.prototype.queryObjectInfo=async function(e,t="",i=""){return await this.model.getObjectInfo(e,t,i)},d.prototype.copyQualification=async function(e){let t=await this.model.copyQualification(e);return widget.notificationUtil.showSuccess(this.NLS.qualification+' "'+t.data[0].dataelements.name+'" '+this.NLS.created_successfully),t},d}),define("DS/ENOXComponentQualification/views/ManufacturerEquivalentItem/ShowManufacturerEquivalentItem",["DS/UIKIT/Mask","UWA/Class/View","DS/ENOXSourcingUXInfra/DetailsView/DetailsView","DS/ENOXComponentQualification/components/IDCardInfo/IDCardInfo","DS/LifecycleCmd/MaturityCmd","DS/ENOXSourcingUXInfra/service/ENOXSourcingService","DS/Notifications/NotificationsManagerUXMessages","DS/Notifications/NotificationsManagerViewOnScreen","DS/ENOXComponentQualification/views/Qualification/RelatedQualifications","DS/ENOXComponentQualification/views/Qualification/OpenQualification","DS/ENOXComponentQualification/models/Qualification","DS/ENOXComponentQualification/helpers/QualificationHelper","DS/ENOXSourcingUXInfra/DocumentView/DocumentView","DS/ENOXComponentQualification/models/ManufacturerEquivalentItem","DS/ENOXSourcingUXInfra/Constants/ENOXSourcingConstants","DS/ENOXComponentQualification/views/ManufacturerEquivalentItem/ReviseMEI","DS/ENOXSourcingUXInfra/PropertiesView/EditPropertiesWidgetWrapper","DS/ENOXSourcingUXInfra/PropertiesView/SRCRelatedObjectsView/RelatedObjectsView","DS/ENOXSourcingUXInfra/service/ENOXSourcingPlatformServices","DS/ENOXSourcingUXInfra/Utilities/HyperLinkHelper","DS/ENOXSourcingUXInfra/Search/SearchUtility","DS/ENOXSourcingUXInfra/Utilities/Utility","DS/ENOXComponentQualification/views/VendorItems/VendorItemsView","DS/ENOXComponentQualification/controllers/VendorItemsController"],function(e,t,i,n,o,a,r,l,s,c,d,u,p,m,f,g,h,y,S,w,E,_,b,C){"use strict";var v=function(e){this.controller=e,this.notifs=r,window.notifs=this.notifs,this.lifeCycleView=void 0,l.setNotificationManager(this.notifs),this.NLS=this.controller.app.i18NProvider,this.qualificationController=this.controller.qualificationController,this.utility=new _};return v.prototype.render=function(t){t.detailsContainer||this.controller.app._applicationChannel.publish({event:"welcome-panel-hide"}),this.options=t,t.meiId=t.data.respParams.id;var i=t.data.params.mei_proxy_id;t.data.params.fromCreate&&(i=""),this.processQualificationTabFinally(this,t,i),this.controller.app._applicationChannel.subscribeOnce({event:"qualification-created"},function(){e.unmask(widget.body)})},v.prototype.relatedQualificationsViewContainer=((e,t)=>{var i=UWA.createElement("div",{id:"relatedQualificationsDiv",styles:{position:"relative"}});i.style.height="100%";var n=new d(e.controller.app),o=new u(e.controller.app),a=new c(e.qualificationController);t.fromRelatedQualifications=!0,t.meicontroller=e.controller;var r=new UWA.Class.Model({id:t.meiId,fromInfoPanel:t.forInfo,parentOptions:t,contextObject:n,openQualification:a,mediator:e.controller.app._mediator,modelEvent:e.controller.app._mediator.createNewChannel(),tenant:widget.getValue("x3dPlatformId"),additionalHeaders:{},platformServices:t.platformServices,applicationChannel:e.controller.app._applicationChannel,triptychWrapper:e.controller.app._triptychWrapper,router:t.router,helper:o,qualificationController:e.controller.qualificationController,qualIdToHighlight:t.data.params.qualIdToHighlight,isToolbarActionNotAllowed:t.isToolbarActionNotAllowed});let l=new s({model:r});return e.relatedQualificationsView=l,l.render().inject(i),i}),v.prototype.vendorItemsContainer=((e,t)=>{let i=UWA.createElement("div",{id:"vendorItemsDiv",styles:{position:"relative"}});var n={id:t.meiId,title:t.data.respParams.title,source:f.SOURCE_3DSPACE,state:t.data.respParams.status_value};let o=e.controller.helper.getProxyPayload(n);i.style.height="100%";let a=new UWA.Class.Model({id:S.getPlatformId()===f.ONPREMISE?t.meiId:t.data.mei_proxy_id,mediator:e.controller.app._mediator,modelEvent:e.controller.app._mediator.createNewChannel(),tenant:widget.getValue("x3dPlatformId"),platformServices:e.controller.app.platformServices,applicationChannel:e.controller.app._applicationChannel,triptychWrapper:e.controller.app._triptychWrapper,router:t.router,VIController:new C({app:e.controller.app}),meicontroller:e.controller,forInfo:t.forInfo,proxyPayload:o}),r=new b({model:a});return e.vendorItemsView=r,r.render().inject(i),i}),v.prototype.processQualificationTabFinally=function(t,o){var a=o.data.respParams?o.data.respParams:{};let r=o.data.params.activeTab||"meiproperties";t.lifeCycleView=t.getLifecycleView(o);var l={showTabView:!0,tabConfiguration:[]};let s=()=>{let e={contextObjId:o.id,callControllerMethod:t.controller};t.controller.app._applicationChannel.publish({event:"xsourcing-collectionview-selected-object-id",data:{selectedObject:!0,openDetails:t.controller.hyperlinkHelper.getObjectDetailsInInfoPanel(e)}})};if(o.forInfo||l.tabConfiguration.push({label:t.NLS.tab_qualifications,content:t.relatedQualificationsViewContainer(t,o),index:"0",value:"meiproperties",isSelected:"meiproperties"===r,icon:{iconName:"badge",fontIconFamily:1},events:{click:function(){t.vendorItemsView.tableView._gridModel.unselectAll(),s()}}},{label:t.NLS.vendor_items,content:t.vendorItemsContainer(t,o),index:"1",value:"vendorItems",icon:require.toUrl("ENOXComponentQualification/assets/icons/16/type_VendorItem_16x16.png"),events:{click:function(){t.relatedQualificationsView.tableView._gridModel.unselectAll(),s()}}}),o.forInfo){(new E).getPlatfromAPIObj().unsubscribe("DS/PADUtils/PADCommandProxy/refresh"),(new E).getPlatfromAPIObj().subscribe("DS/PADUtils/PADCommandProxy/refresh",function(e){let i=!1;e.data.authored&&e.data.authored.modified&&(i=e.data.authored.modified.some(e=>o.id===e||o.id===e.physicalid))&&t.updateMEIViewOnSaveProperties(e)});let e=!1;o.data&&o.data.respParams&&"FALSE"===o.data.respParams.modifyAccess&&(e=!0);let i={container:o._triptychWrapper.getRightPanelContainer(),facets:["FACET_PROPERTIES"],typeOfDisplay:"editProp_onlyProperties",readOnly:e,editMode:!1},n={objectId:o.id},a=new h({viewOptions:i,dataOptions:n});a.render();let s=a.tabContainer;a.tabContainer.elements&&a.tabContainer.elements.container&&(s=a.tabContainer.elements.container),l.tabConfiguration.push({label:t.NLS.properties,content:s,index:"0",value:"meiproperties",isSelected:"meiproperties"===r,icon:{iconName:"attributes",fontIconFamily:1},events:{click:function(){o.applicationChannel.publish({event:"make-information-panel-disappear",data:{forInfo:o.forInfo}})}}},{label:t.NLS.attachments,content:t.getDocumentTabContainer(t,o),index:"3",reload:!1,view:t.documentView,value:"documentTblDiv",isSelected:"documentTblDiv"===r,icon:{iconName:"attach",fontIconFamily:1},events:{click:function(){var e=widget.getElement(".information-panel.panel-icon-wrapper");e&&e.style.removeProperty("display")}}},{label:t.NLS.relations,content:t.getRelationsTabContainer(o),index:"4",value:"relationsDiv",icon:{iconName:"object-related",fontIconFamily:1}},{label:t.NLS.tab_qualifications,content:t.getContextQualificationsTabContainer(o),index:"5",value:"contextQualificationsDiv",icon:{iconName:"badge",fontIconFamily:1}},{label:t.NLS.tab_sharing,content:t.getShareTabContainer(o),index:"6",value:"shareDiv",icon:{iconName:"forward",fontIconFamily:1}})}t.attributeMap=[{name:t.NLS.maturity_state,id:"maturityState",type:"type-text",value:"",editable:!0,displayWhenMinified:!0},{name:t.NLS.owner,value:a.owner,displayWhenMinified:!0},{name:t.NLS.manufacturer,value:a.organization,displayWhenMinified:!0},{name:t.NLS.revision,value:a.revision,displayWhenMinified:!0},{name:t.NLS.type,value:t.NLS[a.type]?t.NLS[a.type]:a.type},{name:t.NLS.name,value:a.name,displayWhenMinified:!0}];var c=new n({infoAttributes:[{name:t.NLS.part_number,value:a.partNumber},{name:t.NLS.creation_date,value:a.created},{name:t.NLS.modified_date,value:a.modified}]});l.idCardDetails={name:a.title,configuration:a.partNumber,thumbnail:a.image?require.toUrl(a.image):"",attributes:t.attributeMap,dropdown:t._getIDCardActionMenu(o),additionalInfomation:[c]},o.callback=function(){o.detailsContainer?e.unmask(o.detailsContainer):e.unmask(widget.body)},o.detailsViewOptions=l,o.customDetailsViewCallback&&o.customDetailsViewCallback(t,o);let d=new UWA.Class.Model({modelEvent:o.app&&o.app._mediator?o.app._mediator.createNewChannel():o.controller&&o.controller.app._mediator.createNewChannel(),id:o.data.respParams.id,relativePath:o.endpoint,source:o.source?o.source:f.SOURCE_3DSPACE,callBackForExecuteCmd:function(){t.controller.getMEIDetails(o).then(function(e){var i=t.controller.processXInfraData(e);o.updatedData=i,t.controller.app._applicationChannel.publish({event:"update-id-card-mei",data:i[0]}),o.updateListManufacturerEQTable&&o.updateListManufacturerEQTable(i[0],"updateMEI")})}});o.lifeCycleModel=d;var u=new i;u.init(o),t.controller.app._applicationChannel.subscribe({event:"update-id-card-mei"},function(e){var i=u.mIDCardContainer;i._idCard.model.set("name",e.grid.title),u.updateWidgetObject.updateTitle(e.grid.title?e.grid.title:e.grid.name),t.attributeMap=[{name:t.NLS.maturity_state,id:"maturityState",value:"",type:"type-text",editable:!0,displayWhenMinified:!0},{name:t.NLS.owner,value:e.grid.owner,displayWhenMinified:!0},{name:t.NLS.manufacturer,value:e.grid.organization,displayWhenMinified:!0},{name:t.NLS.revision,value:e.grid.revision,displayWhenMinified:!0},{name:t.NLS.type,value:t.NLS[e.grid.type]?t.NLS[e.grid.type]:e.grid.type},{name:t.NLS.name,value:e.grid.name,displayWhenMinified:!0}];var a=new n({infoAttributes:[{name:t.NLS.part_number,value:e.grid.partNumber},{name:t.NLS.creation_date,value:e.grid.created},{name:t.NLS.modified_date,value:e.grid.modified}]});i&&i._idCard&&(i._idCard.model.unset("attributes"),i._idCard.model.set("attributes",t.attributeMap),i._idCard.model.set("freezones",[a.render().outerHTML])),u.lifeCycleView.model.unset("maturityContainer"),u.lifeCycleView.model.set("maturityContainer",i),o.data.respParams.cestamp=e.grid.cestamp})},v.prototype._getIDCardActionMenu=function(e){var t=this;return{items:[{text:t.NLS.MATURITY,name:"lifecycle",fonticon:"collaborative-lifecycle-management"},{text:t.NLS.revise,name:"revise",fonticon:"flow-line-add"}],events:{onClick:function(i,n){"lifecycle"===n.name?t.lifeCycleView.render():"revise"===n.name&&(e.qualificationController=t.qualificationController?t.qualificationController:{},g.revise(e))}}}},v.prototype.getLifecycleView=function(e){var i=this;return e.id=e.meiId,new(t.extend({init:function(){this._parent(this,e)},render:function(){var t={};t.context={getSecurityContext:i.getSecurityContextforLifecycleWidget},new o(t).executeAsync({physicalid:e.meiId}).then(function(){i.controller.getMEIDetails(e).then(function(t){var n=i.controller.processXInfraData(t);e.updatedData=n,i.controller.app._applicationChannel.publish({event:"update-id-card-mei",data:n[0]}),e.updateListManufacturerEQTable&&e.updateListManufacturerEQTable(n[0],"updateMEI")})})},destroy:function(){this._parent()}}))},v.prototype.getSecurityContextforLifecycleWidget=function(){return{SecurityContext:a.getSecurityContext()}},v.prototype.getDocumentTabContainer=((e,t)=>{var i=UWA.createElement("div",{id:t.meiId,styles:{position:"relative"}});i.style.height="100%";var n=new m,o=e.controller.qualificationController.helper,a={},r=new UWA.Class.Model({parentOptions:t,fromInfoPanel:t.forInfo,contextObject:n,mediator:e.controller.app._mediator,modelEvent:e.controller.app._mediator.createNewChannel(),infoContainer:e.controller.app._triptychWrapper.getRightPanelContainer(),additionalHeaders:{},applicationChannel:e.controller.app._applicationChannel,triptychWrapper:e.controller.app._triptychWrapper,isSpecification:!1,isReferencial:!0,id:t.meiId,enableDelete:!0,helper:o,controller:e.controller.qualificationController,isDragDropAllowed:Boolean("TRUE"===t.data.respParams.modifyAccess),isUpdateAllowed:Boolean("TRUE"===t.data.respParams.modifyAccess),state:t.data.respParams.state,relationship:f.REFERENCE_DOCUMENT,source:f.SERVICE_3DSPACE});return a=new p({model:r}),e.documentView=a,a.render().inject(i),i}),v.prototype.getRelationsTabContainer=function(t){let i=UWA.createElement("div",{id:"relationsDiv",styles:{position:"relative"}});i.style.height="100%";let n={container:i,facets:["FACET_RELATIONS"],showIdCard:!1},o={objectId:t.meiId};return new h({viewOptions:n,dataOptions:o}).render(),e.unmask(i),i},v.prototype.getContextQualificationsTabContainer=function(e){let t=UWA.createElement("div",{id:"equivalentComponentsDiv",styles:{position:"relative"}});return t.style.height="100%",this.getSRCRelatedObjectsView({options:e,relationsContainer:t}),t},v.prototype.getShareTabContainer=function(e){let t=UWA.createElement("div",{id:"shareDiv",styles:{position:"relative"}});t.style.height="100%";let i={container:t,facets:["FACET_SHARING"],showIdCard:!1},n={objectId:e.meiId};return new h({viewOptions:i,dataOptions:n}).render(),t},v.prototype.getSRCRelatedObjectsView=function(t){var i=this;e.mask(t.relationsContainer,i.NLS.loading),i.controller.helper.processDataForContextQualifications({data:t.options.data.respParams,controller:i.controller}).then(e=>{let n=new UWA.Class.Model({data:e,ctxCallback:function(e){let t=e.options.id;if(f.TYPE_QUALIFICATION_LIST.includes(e.options.grid.type)){let e={contextObjId:t,callControllerMethod:i.controller};i.controller.app._applicationChannel.publish({event:"information-panel-add-content",data:{openDetails:(new w).getObjectDetailsInInfoPanel(e)}}),i.controller.app._applicationChannel.publish({event:"information-panel-open-without-reload-content"})}else if(f.VPMREFERENCE===e.options.grid.type||f.TYPE_MODEL===e.options.grid.type||f.DELFMIFUNCTIONREFERENCE_TYPES.includes(e.options.grid.type))i.utility.propertyWidget(t,[{readOnly:"true"}]);else if(f.DSPLAN_PROJECT===e.options.grid.type){let e=encodeURIComponent(t.replace("<","").replace(">",""));window.open(S._platforms[f.SERVICE_3DDASHBOARD]+"#dashboard:/tab:/app:ENXPLAN_AP/content:ids="+e+"&tenant="+S.getPlatformId()+"&x3dPlatformId="+S.getPlatformId())}else window.open(S._platforms[f.SERVICE_3DSPACE]+"/common/emxNavigator.jsp?objectId="+t)}});new y({model:n}).render().inject(t.relationsContainer)}).catch(function(){widget.notificationUtil.showError(i.NLS.error_loading_related_objects)}).finally(function(){e.unmask(t.relationsContainer)})},v.prototype.updateMEIViewOnSaveProperties=function(e){let t=this,i=[];if(e.data.authored&&e.data.authored.modified&&e.data.authored.modified.forEach(function(e){"object"==typeof e?i.push(e.physicalid):i.push(e)}),i.length>0){let e={};e.source=t.options.source,e.id=i[0],t.controller.model.getDetails(e).then(function(e){let i=e.member[0],n=t.controller.processXInfraItem(i);t.controller.app._applicationChannel.publish({event:"update-mei",data:n}),t.controller.app._applicationChannel.publish({event:"update-id-card-mei",data:n}),t.options.updateListManufacturerEQTable&&t.options.updateListManufacturerEQTable(n,"updateMEI")})}},v}),define("DS/ENOXComponentQualification/controllers/ManufacturerEquivalentItemController",["DS/UIKIT/Mask","DS/ENOXComponentQualification/models/ManufacturerEquivalentItem","DS/ENOXComponentQualification/views/ManufacturerEquivalentItem/ShowManufacturerEquivalentItem","DS/ENOXComponentQualification/controllers/QualificationController","DS/ENOXComponentQualification/models/Qualification","DS/ENOXComponentQualification/views/ManufacturerEquivalentItem/NewManufacturerEquivalentItem","DS/ENOXSourcingUXInfra/InfiniteScrolling/InfiniteScrollingImpl","DS/ENOXComponentQualification/views/ManufacturerEquivalentItem/ListManufacturerEquivalentItems","DS/ENOXSourcingUXInfra/service/ENOXSourcingPlatformServices","DS/ENOXSourcingUXInfra/Constants/ENOXSourcingConstants","DS/ENOXSourcingUXInfra/service/ENOXSourcingService","DS/ENOXComponentQualification/helpers/MEIHelper","DS/ENOXSourcingUXInfra/Utilities/HyperLinkHelper","DS/ENOXSourcingUXInfra/Search/SearchUtility"],function(e,t,i,n,o,a,r,l,s,c,d,u,p,m){"use strict";var f=function(e){this.app=e.app,this.next_start="",this.countDGV=0,this.searchUtil=new m,this.model=new t(this),this.helper=new u(this),this.hyperlinkHelper=new p,this.NLS=this.app.i18NProvider,this.qualificationModel=new o(this.app),this.qualificationController=new n({app:this.app}),this.app.taggerProxy6w=this.app.taggerProxy.serverFilteringProxy();try{this.newView=new a(this)}catch(e){this.newView=void 0}};return f.prototype.list=function(e){var t=this;if(t.options=e,t.taggerProxy=t.app.taggerProxy,t.taggerProxy6w=t.app.taggerProxy6w,e.refine=t.filterCheck(t.app.taggerProxy6w.getCurrentFilter()),t.taggerProxy6w.addEvent("onFilterChange",t.onChangeFilterCall,this),!e.isLazyLoading){t.view=new l(this),t.maskMEITable(e),t.allMEIData&&(t.allMEIData.length=0),e.data=[],e.lockItemCount=!0,t.view.render(e);var i={};i.controller=t,i.view=t.view,t.infiniteScrollingImpl=new r(i),widget.infiniteScrollingImplglo=this.infiniteScrollingImpl,t.setCounter=0,t.countDGV=0,t.next_start=""}t.getPromisesLazyLoading(e,t.setCounter++).then(function(e){t.mergeQualificationDataWithMEI(e.respDataQual,e.setCounter)})},f.prototype.onChangeFilterCall=function(){let e={app:this.options.app,routeDetails:this.options.routeDetails};this.list(e)},f.prototype.filterCheck=function(e){let t={};return e.localfilters&&Object.keys(e.localfilters).length>0&&Object.keys(e.localfilters).forEach(i=>{t[i]||(t[i]=[]),t[i].push(...e.localfilters[i])}),e.allfilters&&Object.keys(e.allfilters).length>0&&Object.keys(e.allfilters).forEach(i=>{t[i]||(t[i]=[]),t[i].push(...e.allfilters[i])}),t},f.prototype.setProxyData=function(e){this.taggerProxy6w.unsetTags(),this.taggerProxy6w.setTags(null,e)},f.prototype.showDetails=function(t){var n=this;t.onComplete=function(e){var o=this.processXInfraData(e);t.data.respParams=o[0].grid,t.data.params=t.data,UWA.merge(t.data.params,t.data.respParams),new i(n).render(t)}.bind(n),t.onFailure=function(t){404===t.status?(widget.notificationUtil.showError(n.NLS.object_may_be_deleted),n.app.router.navigate("home.ManufacturerEquivalentItems")):widget.notificationUtil.showError(t.error?t.error:t.message),e.unmask(widget.body)}.bind(n),t.detailsContainer?e.mask(t.detailsContainer,n.NLS.opening_mei):e.mask(widget.body,n.NLS.opening_mei),t.id=t.data.id?t.data.id:t.data.params.id,n.model.get(t)},f.prototype.openInInformationPanel=function(e){this.showDetails(e)},f.prototype.newMEI=function(e,t){this.newView.render(e,t)},f.prototype.create=function(t){var i=this;t.onComplete=function(n){t.createMEICallback();var o=n.member[0],a=this.processXInfraItem(o);widget.notificationUtil.showSuccess(i.NLS.manufacturer_equivalent_item_small+' "'+a.grid.title+'" '+i.NLS.created_successfully),t.formValues.targetId=a.id,t.formValues.state=a.grid.state,t.formValues.status_value=a.grid.status_value,t.formValues.modified=a.grid.modified,t.formValues.title=a.grid.title,t.formValues.source="3dspace",t.formValues.tenant=s.getPlatformId(),i.app._applicationChannel.subscribeOnce({event:"qualification-created"},function(n){o.qualificationId=n&&n.grid?n.grid.id:"",o.marketStatus=n&&n.grid?n.grid.marketStatus:"",o.usageAuthorization=n&&n.grid?n.grid.usageAuthorization:"",o.isOrderable=n&&n.grid&&(n.grid.isOrderable?n.grid.isOrderable:n.grid.orderable)||"",a=i.processXInfraItem(o),t.successCallback&&"function"==typeof t.successCallback&&t.successCallback(a),t.blockDetailsViewNavigation||i.app.router.navigate("home.MEIDetails",{id:a.id,qualificationId:o.qualificationId,name:a.grid.title},{reload:!0}),t.target=null,e.unmask(widget.body)}),e.mask(widget.body,i.NLS.creating_qualification),this.qualificationController.createNoUI(t)}.bind(this),t.onFailure=function(n){t.createFailureCallback();let o=n.error?n.error:n.message,a=t.formValues["eng-item"]?t.formValues["eng-item"].identifier:"";a&&o.contains(a)&&(o=o.replace(a,i.options.formValues.engitem)),widget.notificationUtil.showError(o),e.unmask(widget.body)}.bind(this),e.mask(widget.body,i.NLS.creating_mei),t.formValues["eng-item"]?(t.addData=this.getCreateMEIFromEngITemPayload(t.formValues),this.model.createMEIWithEngItem(t)):(t.addData=this.processXInfraForm(t.formValues),this.model.create(t))},f.prototype.delete=function(t){var i=this;t.data=t.selectedNodes.map(e=>e.getAttributeValue("id"));t.onComplete=function(){t.selectedNodes.forEach(e=>e.getTreeDocument().removeRoot(e)),this.app._applicationChannel.publish({event:"information-panel-add-content",data:{selectedObject:null}}),widget.notificationUtil.showSuccess(i.NLS.mei_delete_success),e.unmask(widget.body),i.view.collectionView._xsourcingCollectionViewUI._updateCount(i.countDGV-t.selectedNodes.length)},t.onFailure=function(t){widget.notificationUtil.showError(t.error?t.error:t.message),e.unmask(widget.body)},e.mask(widget.body,i.NLS.deleting_mei),this.model.delete(t)},f.prototype.update=function(t){var i=this,n=function(n){var o=n.member[0],a=this.processXInfraItem(o);widget.notificationUtil.showSuccess(i.NLS.manufacturer_equivalent_item+' "'+a.grid.title+'" '+i.NLS.updated_successfully),i.app._applicationChannel.publish({event:"update-mei",data:a}),i.app._applicationChannel.publish({event:"update-id-card-mei",data:a}),t.updateListManufacturerEQTable&&t.updateListManufacturerEQTable(a,"updateMEI"),e.unmask(widget.body)};t.onFailure=function(t){widget.notificationUtil.showError(t.error?t.error:t.message),e.unmask(widget.body)}.bind(this),e.mask(widget.body,i.NLS.updating_mei),0!==Object.keys(t.classificationFormValues).length?(t.addData=t.classificationFormValues,t.addData.cestamp=t.data.respParams.cestamp,this.model.updateClassification(t).then(function(e){t.addData=i.processXInfraUpdateForm(t.formValues),t.addData.cestamp=e.member[0].cestamp,t.onComplete=n.bind(i),i.model.update(t)},function(t){widget.notificationUtil.showError(t.error?t.error:t.message),e.unmask(widget.body)})):(t.addData=this.processXInfraUpdateForm(t.formValues),t.addData.cestamp=t.data.respParams.cestamp,t.onComplete=n.bind(this),this.model.update(t))},f.prototype.processXInfraData=function(e){return e.member?e.member.map(e=>this.processXInfraItem(e),this):[]},f.prototype.processXInfraDataList=function(e){return e?e.map(e=>this.processXInfraItem(e),this):[]},f.prototype.processXInfraItem=function(e){let t=this.helper.processXInfraItem(e);return this.helper.convertItemToNodeModel(t)},f.prototype.processXInfraForm=function(e){return{items:[{attributes:{title:e.title,description:e.description,"dssrc:ManufacturerEquivalentReference":{partSource:e.partSource,partSourceURL:e.partSourceURL,manufacturerPartNumber:e.partNumber,manufacturer:e.manufacturer}}}]}},f.prototype.getCreateMEIFromEngITemPayload=function(e){return[{engItem:{source:e["eng-item"].source,type:e["eng-item"].type,identifier:e["eng-item"].identifier,relativePath:"resources/v1/modeler/dseng/dseng:EngItem/"+e["eng-item"].identifier},manufacturerPartNumber:e.partNumber,manufacturer:e.manufacturer,partSource:e.partSource,partSourceURL:e.partSourceURL}]},f.prototype.processXInfraUpdateForm=function(e){return e.manufacturerPartNumber=e.partNumber,delete e.collabSpace,delete e.manufacturer,delete e.name,delete e.organization,delete e.revision,delete e.type,delete e.partNumber,e},f.prototype.maskMEITable=function(t){t.externalContainer?e.mask(t.externalContainer,this.NLS.list_mei):e.mask(widget.body,this.NLS.list_mei)},f.prototype.getMEIDetails=function(e){return this.model.getDetails(e)},f.prototype.extractMEIIDs=function(e){return e?e.map(e=>({id:e.id})):[]},f.prototype.getQualMapwithMEIids=function(e){var t={};return e.data.forEach(function(e){t[e.dataelements.Target_ID]=e}),t},f.prototype.mergeQualificationDataWithMEI=function(e,t){var i=this,n=i.getQualMapwithMEIids(e);i.view.collectionView._xsourcingCollectionViewUI._gridModel.prepareUpdate(),i.view.collectionView._xsourcingCollectionViewUI._gridModel.getRoots().slice(t*c.lazy_load_chunk_size,(t+1)*c.lazy_load_chunk_size).forEach(function(e){let t=e.getAttributeValue("id");if(n[t]){e.setAttribute("approved",n[t].dataelements["SRC Approved"]),e.setAttribute("approvedDisplay",i.NLS[n[t].dataelements["SRC Approved"]]),e.setAttribute("qualificationState",n[t].dataelements.state),e.setAttribute("qualificationStateDisplay",n[t].dataelements.stateDisplay),e.setAttribute("qualificationId",n[t].id),e.setAttribute("qualificationType",n[t].type),e.setAttribute("mei_id",t);let o=n[t].dataelements.Target_Proxy_ID;e.setAttribute("mei_proxy_id",o||n[t].dataelements.Target_ID),e.options.contextualMenu=[""]}else e.setAttribute("approved",""),e.setAttribute("approvedDisplay",""),e.setAttribute("qualificationState",""),e.setAttribute("qualificationStateDisplay",""),e.options.contextualMenu=[""]}),i.view.collectionView._xsourcingCollectionViewUI._gridModel.pushUpdate()},f.prototype.closeTagger=function(){this.taggerProxy&&this.taggerProxy.onCloseTagger()},f.prototype.getPromisesLazyLoading=function(t,i){let n=this;return new Promise(function(o,a){let r=n.searchUtil.getSearchPayload([],[],[c.SOURCE_3DSPACE],{nresults:100,with_nls:!1,order_field:"ds6w:modified",order_by:"desc",completePreCond:'(flattenedtaxonomies:"types/VPMReference" AND [ds6w:kind]:"ManufacturerEquivalentItemExtension" )'});""!==n.next_start?r.next_start=n.next_start:r.next_start="",t.refine&&Object.keys(t.refine).length>0?r.refine=t.refine:r.refine={};let l=n.searchUtil.getSearchPayload([],[],[c.SOURCE_3DSPACE],{start:0,nresults:999,with_nls:!1});l.select_type=[c.VPMREFERENCE,c.MEI_EXTENSION],n.searchUtil.callFederatedSearch(r).then(function(s){n.searchUtil.callRecentFederatedSearch(l).then(function(l){let d={};n.next_start=s.infos.next_start;let u=n.searchUtil.processResults(s),p=n.helper.processSearchItem(u),m=n.searchUtil.processResults(l);if(0===m.length&&0===i&&0===n.countDGV&&(n.countDGV=s.infos.nhits),m.length>0&&0===i){let e=m.filter(e=>e["ds6wg:ManufacturerEquivalentItemExtension.ManufacturerPartNumber"]),t=n.helper.processSearchItem(e),o=t.filter(e=>p.some(t=>t.id===e.id)),a=t.filter(e=>!p.some(t=>t.id===e.id)),l=p.filter(e=>o.some(t=>t.id===e.id));if(d.previousUpdatedMEI=structuredClone(l),o.length>0&&p.forEach(e=>{let t=o.filter(t=>t.id===e.id)[0];t&&(t.owner=t&&e.owner),Object.assign(e,t)}),Object.keys(r.refine).length>0&&(o=n.processRecentData(o,r.refine),a=n.processRecentData(a,r.refine)),d.recentUpdatedMEI=o,d.recentCreatedMEI=a,0===i&&a.length>0&&p.unshift(...a),o.length!==l.length){let e=l.filter(e=>!o.some(t=>t.id===e.id));p=p.filter(t=>!e.some(e=>e.id===t.id))}n.countDGV=s.infos.nhits-l.length,n.countDGV=n.countDGV+a.length+o.length,n.helper.updateExistingNodesData(t,n.view.collectionView)}n.allMEIData&&n.allMEIData.length>0&&(p=p.filter(function(e){return!n.allMEIData.find(function(t){return t.id===e.id})}));let f={"ds6w:status":[]};f["ds6w:status"].push(...p.map(e=>e.status_value||e.state)),f["ds6w:status"]=[...new Set(f["ds6w:status"])],n.searchUtil.getNlsOfPropertiesValues(f).then(function(r){p.forEach(e=>{e.state=r["ds6w:status"][e.status_value]?r["ds6w:status"][e.status_value]:r["ds6w:status"][e.state]?r["ds6w:status"][e.state]:e.status_value});let l=n.getManufacturerFromMEISearch(p),u=n.getCompanySearchPayLoad(l);n.searchUtil.callFederatedSearch(u).then(function(e){const t=n.processManufcturerDataForMap(e);if(t&&p.forEach(e=>{e.manufacturer=t.get(e.manufacturer)}),s.facets||d.recentUpdatedMEI&&d.recentUpdatedMEI.length>0||d.recentCreatedMEI&&d.recentCreatedMEI.length>0){let e=s.facets?s.facets:[];n.closeTagger(),n.taggerProxy6w.activate();let o=c.MEITAGS;0===i&&n.createTags(o,e,d,t).then(function(e){n.setProxyData(e)})}}).finally(()=>{(r=>{let l=n.extractMEIIDs(r);t.data=n.processXInfraDataList(r),n.allMEIData=n.allMEIData?[...n.allMEIData,...t.data]:t.data,n.view.collectionView._xsourcingCollectionViewUI._allData=n.allMEIData,n.view.collectionView._xsourcingCollectionViewUI._updateCount(n.countDGV),e.unmask(widget.body),n.infiniteScrollingImpl.processReloadData(t.data),n.qualificationModel.getQualificationsListPageMEI({postData:{data:l}}).then(function(e){o({respDataQual:e,setCounter:i})},function(t){widget.notificationUtil.showError(t.error?t.error:t.message),e.unmask(widget.body),a(t)})})(p)})})})}).catch(function(t){widget.notificationUtil.showError(t.error?t.error:t.message),e.unmask(widget.body)})})},f.prototype.closeFacetTagger=function(){this.taggerProxy&&this.taggerProxy.closeFacetTagger()},f.prototype.processRecentData=function(e,t){let i=[],n={};return Object.keys(t).forEach(e=>{let i=e.split("/").reverse()[0];n[i]=t[e].map(e=>e.object)}),e.forEach(e=>{let t=this.processDate(e.created),o=this.processDate(e.modified_value);e.responsible=e.owner,e.project=e.collabspace;let a=!1;Object.keys(n).forEach(i=>{"ds6w:created"===i?t.forEach(e=>{n[i].includes(e)&&(a=!0)}):"ds6w:modified"===i?o.forEach(e=>{n[i].includes(e)&&(a=!0)}):a=!!n[i].includes(e[i.split(":")[1]])}),a&&i.push(e)}),i},f.prototype.setDataForTagger=function(e,t){var i=c.TAGGER_MEI;this.taggerProxy.setTaggerProxyOpts(e,t,i)},f.prototype.getClassificationDetails=function(t){var i=this;return i.model.getClassifiedItem(t).then(function(e){if(e.member[0].ClassificationAttributes&&0!==e.member[0].ClassificationAttributes.totalItems){var t={};t.totalItems=e.member[0].ClassificationAttributes.totalItems;var n=e.member[0].ClassificationAttributes.member;return t.getClass=[],t.member=[],n.forEach(e=>{let n={};n.id=e.ClassID,t[e.ClassID]=e.Attributes,t.getClass.push(i.model.getClassDetails(n))}),t}},function(t){widget.notificationUtil.showError(t.error?t.error:t.message),e.unmask(widget.body)})},f.prototype.getManufacturerFromMEISearch=function(e){let t=[];return e&&e.member&&e.member.forEach(e=>{t.includes(e.manufacturer)||t.push(e.manufacturer)}),t},f.prototype.getCompanySearchPayLoad=function(e){let t="";return e&&e.map(function(e){t+=" [ds6w:identifier]:("+e+") "+c.OR}),t=t.substring(0,t.length-3),this.searchUtil.getSearchPayload([],["Company"],[c.SOURCE_3DSPACE],{start:0,nresults:999,with_nls:!1,completePreCond:t})},f.prototype.processManufcturerDataForMap=function(e){let t=void 0;return e&&e.results&&(t=new Map,e.results.forEach(e=>{let i,n;e.attributes.forEach(e=>{"ds6w:identifier"===e.name&&(i=e.value),"ds6w:label"===e.name&&(n=e.value)}),t.set(i,n)})),t},f.prototype.createTags=function(e,t,i,n){let o=[],a=[],r=[];t.forEach(t=>{e.includes(t.sixw)&&o.push(t),"ds6w:what/ds6w:status"===t.sixw&&r.push({value:t.object,index:o.length-1})});let l={"ds6w:status":r.map(e=>e.value)},s=[],c=[],d=[];s.push(...this.formatFacetToTags(i.recentUpdatedMEI?i.recentUpdatedMEI:[])),c.push(...this.formatFacetToTags(i.recentCreatedMEI?i.recentCreatedMEI:[])),d.push(...this.formatFacetToTags(i.previousUpdatedMEI?i.previousUpdatedMEI:[]));let u={};return o.forEach(e=>{u[e.sixw]||(u[e.sixw]=[]),u[e.sixw].push(e.object)}),n&&o.length>0&&o.forEach(e=>{"ds6w:who/ds6w:responsible/ds6w:manufacturer"===e.sixw&&(e.object=n.get(e.object))}),this.searchUtil.getNlsOfPropertiesValues(l).then(function(e){return r.forEach(function(t){o[t.index].dispValue=e["ds6w:status"][o[t.index].object]}),d.forEach(t=>{"ds6w:what/ds6w:status"===t.sixw&&(t.dispValue=e["ds6w:status"][t.object])}),d.length>0&&!d[0].object&&0===c.length?a=[]:0===o.length?a=c:o.forEach(e=>{s.forEach(t=>{e.sixw===t.sixw&&(e.object===t.object?e.count+=1:u[e.sixw].includes(t.object)||a.includes(t)||a.push(t))}),c.forEach(t=>{e.sixw===t.sixw&&(e.object===t.object?e.count+=1:u[e.sixw].includes(t.object)||a.includes(t)||a.push(t))}),d.forEach(t=>{e.sixw===t.sixw&&e.object===t.object&&(e.count-=1)})}),[...o,...a]})},f.prototype.formatFacetToTags=function(e){let t=[];return e.forEach(e=>{t.push({sixw:"ds6w:what/ds6w:status",type:"string",field:"implicit",object:""!==e.status?e.status:e.state,dispValue:e.status_value,sources:[e.sourceid],count:1},{sixw:"ds6w:when/ds6w:created",type:"date",field:"implicit",object:this.taggerProxy._ConvertToTagDate(e.created),sources:[e.sourceid],count:1},{sixw:"ds6w:when/ds6w:modified",type:"date",field:"implicit",object:this.taggerProxy._ConvertToTagDate(e.modified_value),sources:[e.sourceid],count:1},{sixw:"ds6w:who/ds6w:responsible",type:"string",field:"implicit",object:e.owner,sources:[e.sourceid],count:1},{sixw:"ds6w:who/ds6w:responsible/ds6w:manufacturer",type:"string",field:"implicit",object:e.manufacturer,sources:[e.sourceid],count:1},{sixw:"ds6w:where/ds6w:context/ds6w:project",type:"string",field:"implicit",object:e.collabspace,sources:[e.sourceid],count:1})}),t},f.prototype.processDate=function(e){let t=this.taggerProxy._ConvertToTagDate(e).split("/");return[t[0],t[0]+"/"+t[1],t[0]+"/"+t[1]+"/"+t[2]]},f.prototype.isEngItemUsed=async function(e){let t={},i={postData:{data:[{id:e,tenant:this.app.platformServices.platformId}]}};return!!((t=await this.qualificationModel.getQualificationTargetDetails(i)).data&&t.data.length>0)||!!((t=await this.qualificationModel.getQualificationContextDetails(i)).data&&t.data.length>0)},f}),define("DS/ENOXComponentQualification/views/Context/Engineering/OpenEngineeringItemContext",["DS/ENOXSourcingUXInfra/MembersView/MembersView","DS/ENOXSourcingUXInfra/components/MemberInfoProvider/MemberInfoProvider","DS/ENOXSourcingUXInfra/DetailsView/DetailsView","DS/ENOXSourcingUXInfra/xsourcingCollectionView/xsourcingCollectionView","DS/Handlebars/Handlebars","DS/ENOXSourcingUXInfra/Constants/ENOXSourcingConstants","DS/ENOXComponentQualification/views/Qualification/OpenQualification","DS/ENOXComponentQualification/views/ManufacturerEquivalentItem/ShowManufacturerEquivalentItem","text!DS/ENOXComponentQualification/views/Context/Engineering/OpenEngineeringItemContext.html","css!DS/ENOXComponentQualification/views/Context/Engineering/OpenEngineeringItemContext.css"],function(e,t,i,n,o,a,r,l,s){"use strict";var c=function(e){this.controller=e.controller,this.options=e.options,this.data=e.data,this.rootData=e.data.filter(e=>e.grid.isRoot)[0],this.NLS=this.controller.app.i18NProvider};return c.prototype.render=function(){let e=s;this.controller.app._triptychWrapper.getMainPanelContainer().innerHTML=o.compile(e)(),this.addEngineeringSections(),this.controller.app._applicationChannel.publish({event:"welcome-panel-hide"}),this.controller.engHelper.renderPropertiesView({id:this.rootData.grid.id,controller:this.controller})},c.prototype.addEngineeringSections=function(){var e=this;let t={},n=[{name:e.NLS.maturity_state,value:this.rootData.grid.maturityStatusDisplay,displayWhenMinified:!0},{name:e.NLS.owner,value:this.rootData.grid.responsible,displayWhenMinified:!0},{name:e.NLS.revision,value:this.rootData.grid.revision,displayWhenMinified:!0},{name:e.NLS.creation_date,value:this.rootData.grid.creationDate},{name:e.NLS.modified_date,value:this.rootData.grid.modificationDate}];t.idCardDetails={name:this.rootData.label,thumbnail:this.rootData.grid.image,attributes:n,withActionsButton:!1},e.controller.engHelper.idCardDetails=t.idCardDetails,e.controller.app._applicationChannel.subscribe({event:"update-context-restrictions-dgv"},function(t){let i="",n=e.engineeringCollectionView._xsourcingCollectionViewUI._dataGridView.getTreeDocument().getAllDescendants().filter(e=>e._options.grid.eqId===t.qualId?(i="eqContextRestrictions",e):e._options.grid.gqId===t.qualId?(i="gqContextRestrictions",e):void 0),o={gqContextRestrictions:0,eqContextRestrictions:0};"eqContextRestrictions"===i?(delete o.gqContextRestrictions,o.eqContextRestrictions=t.contextRestrictions.length):"gqContextRestrictions"===i&&(delete o.eqContextRestrictions,o.gqContextRestrictions=t.contextRestrictions.length),n[0]&&n[0].updateOptions&&n[0].updateOptions({grid:o})}),t.showTabView=!1,t.contentView=this.addEngDGV();let o=new i,a="";e.controller.app._applicationChannel.subscribe({event:"update-proof-dgv"},function(t){let i=e.engineeringCollectionView._xsourcingCollectionViewUI._dataGridView.getTreeDocument().getAllDescendants().filter(e=>e._options.grid.eqId===t.qualId?(a="eqProof",e):e._options.grid.gqId===t.qualId?(a="gqProof",e):void 0),n={eqProof:"FALSE",gqProof:"FALSE"};0!==t.proofData.length?"eqProof"===a?(delete n.gqProof,n.eqProof="TRUE"):"gqProof"===a&&(delete n.eqProof,n.gqProof="TRUE"):"eqProof"===a?(delete n.gqProof,n.eqProof="FALSE"):"gqProof"===a&&(delete n.eqProof,n.gqProof="FALSE"),i[0]&&i[0].updateOptions&&i[0].updateOptions({grid:n})}),e.controller.app._applicationChannel.subscribe({event:"update-mq-vi-dgv"},function(t){let i={eqMaturityStatus:t.mqState,eqMaturityStatusDisplay:e.NLS[t.mqState]?e.NLS[t.mqState]:t.mqState,eqApproved:t.approve},n=e.engineeringCollectionView._xsourcingCollectionViewUI._dataGridView.getTreeDocument().getAllDescendants().filter(e=>{if(e._options.grid.eqId===t.qualId)return e});n[0]&&n[0].updateOptions&&n[0].updateOptions({grid:i})}),e.controller.app._applicationChannel.subscribe({event:"delete-mq-vi-dgv"},function(t){let i=e.engineeringCollectionView._xsourcingCollectionViewUI._dataGridView.getTreeDocument().getAllDescendants().filter(e=>{if(t.selectedObject.includes(e._options.grid.eqId))return e});if(i[0]){let t=i[0].getTreeDocument(),n=i[0].getParent();t.prepareUpdate(),1===n.getVisibleChildren().length?t.removeRoot(n):t.removeRoot(i[0]),t.pushUpdate(),e.controller.app._applicationChannel.publish({event:"information-panel-add-content",data:{selectedObject:null}}),e.controller.app._applicationChannel.publish({event:"information-panel-close"})}}),o.init({detailsViewOptions:t,router:this.options.router,data:{respParams:{title:this.rootData.label}},detailsContainer:this.controller.app._triptychWrapper.getMainPanelContainer().querySelector("#engineeringItems"),_mediator:this.controller.app._mediator,applicationChannel:this.controller.app._applicationChannel})},c.prototype.addEngDGV=function(){let i=this,o={};o._mediator=i.controller.app._mediator,o.columnsConfigurations=i.controller.engHelper.getEngViewColumns(this.options);let s=UWA.createElement("div",{id:"assemblyView",styles:{position:"relative",height:"100%"}});o.data=i.data,o.uniqueIdentifier="EngContextTable",o.columnToSearch=a.ENG_COLUMNS_TO_SEARCH,o.container=s,o.views=["Grid"],o.showToolbar=!0,o.toolbarActions=i.controller.engHelper.getToolbar(this.options),o.currentView="Grid View",o.enableCellDrag=!0,o.onDragStartCell=((e,t)=>{i.controller.onDragStartCell(i.controller,e,t)}),o.expandChildrenLevel=1,o.rowSelection="single",o.onContextualEventCallback=function(n){let a=n.cellInfos&&n.cellInfos.nodeModel?n.cellInfos.nodeModel:null,r=n.cellInfos?n.cellInfos.rowID:null,l=n.cellInfos?n.cellInfos.columnID:null,s=n.collectionView?n.collectionView.layout.getColumnIdentifiers(l).dataIndex:"";if(-1===r||!a)return this._contextualMenuBuilder?this._contextualMenuBuilder.buildMenu(n):[];if(a.getAttributeValue("isMEI")){let n=[{type:"PushItem",title:i.NLS.remove,fonticon:{content:"wux-ui-3ds wux-ui-3ds-remove"},action:{callback:function(){i.controller.engHelper.handleRemoveSource(a)}}}];return"eqName"!==s&&"gqName"!==s||n.push({type:"PushItem",fonticon:{content:"wux-ui-3ds wux-ui-3ds-forward"},title:i.NLS.share,action:{callback:function(){var n=new UWA.Class.Model({id:"eqName"===s?a._options.grid.eqId:a._options.grid.gqId,changeAccess:"eqName"===s?a._options.grid.eqModifyAccess:a._options.grid.gqModifyAccess,excludeQuery:'AND NOT [ds6w:identifier]:("'+a._options.grid.modifyAccess+'")',mediator:o._mediator,modelEvent:o._mediator.createNewChannel(),infoContainer:i.controller.app._triptychWrapper.getRightPanelContainer()}),r=new e({model:n});let l=`${i.NLS.share} - ${"eqName"===s?a._options.grid.eqName:a._options.grid.gqName}`,c=i.NLS.can_view;r.memberInfoProvider=new t,r.launchWebUXPopup({shareName:l,canView:c})}}}),n}},o.rowSelectCallback=i.rowSelectCallback.bind(i),o.rowUnSelectCallback=i.rowUnselectCallback.bind(i),o.useAsyncPreExpand=!0,o.onPreExpand=i.controller.onPreExpand.bind(i.controller),o.onPreCollapse=i.controller.onPreCollapse.bind(i.controller),i.engineeringCollectionView=new n,i.engineeringCollectionView.init(o),i.options.openQualification=new r(i.controller),i.options.showMEI=new l(i.controller.meiController);let c={lifecycleCallback:i.controller.qualificationController.helper.qualificationLifeCycleLaunch.bind(i),collectionView:i.engineeringCollectionView};return i.controller.qualificationController.helper.addingTypeRepresentations(c),i.controller.engHelper.setDynamicCountUpdater(i.engineeringCollectionView._xsourcingCollectionViewUI._gridModel),s},c.prototype.rowSelectCallback=function(e){let t=this;if(e.grouped||e.type===t.controller.engHelper.getDummySourceNodeType())t.controller.app._applicationChannel.publish({event:"xsourcing-collectionview-unselected-object-id"}),t.controller.app._applicationChannel.publish({event:"information-panel-add-content",data:{selectedObject:null}});else if(t.toggleToolbarCommands(e),e.isMEI)t.controller.showMEIDetails({options:this.options,data:e,view:t.engineeringCollectionView});else if(e.actualType===a.TYPE_VENDOR_ITEM){let i=t.controller.vendorItemController.getQualificationOpenInInfoPanel(e.id);t.controller.app._applicationChannel.publish({event:"xsourcing-collectionview-selected-object-id",data:{selectedObject:e,openDetails:i}})}else t.controller.engHelper.renderPropertiesView({id:e.id,controller:t.controller})},c.prototype.rowUnselectCallback=function(){this.toggleToolbarCommands(),this.controller.app._applicationChannel.publish({event:"xsourcing-collectionview-unselected-object-id",data:{selectedObject:null}}),this.controller.engHelper.renderPropertiesView({id:this.rootData.grid.id,controller:this.controller})},c.prototype.toggleToolbarCommands=function(e){let t=this;if(void 0===e)return t.engineeringCollectionView.collectionViewEvents.publish({event:"xsourcing-collectionview-disable-toolbar-button",data:"addNewMEI"}),t.engineeringCollectionView.collectionViewEvents.publish({event:"xsourcing-collectionview-disable-toolbar-button",data:"addExistingMEI"}),t.engineeringCollectionView.collectionViewEvents.publish({event:"xsourcing-collectionview-disable-toolbar-button",data:"addExistingMI"}),t.engineeringCollectionView.collectionViewEvents.publish({event:"xsourcing-collectionview-disable-toolbar-button",data:"removeMEI"}),void t.engineeringCollectionView.collectionViewEvents.publish({event:"xsourcing-collectionview-disable-toolbar-button",data:"addExistingVI"});e.type===a.VPMREFERENCE||e.isManufacturingItem?(t.engineeringCollectionView.collectionViewEvents.publish({event:"xsourcing-collectionview-enable-toolbar-button",data:"addNewMEI"}),t.engineeringCollectionView.collectionViewEvents.publish({event:"xsourcing-collectionview-enable-toolbar-button",data:"addExistingMEI"}),t.engineeringCollectionView.collectionViewEvents.publish({event:"xsourcing-collectionview-enable-toolbar-button",data:"addExistingMI"}),t.engineeringCollectionView.collectionViewEvents.publish({event:"xsourcing-collectionview-enable-toolbar-button",data:"addExistingVI"})):e.isMEI&&t.engineeringCollectionView.collectionViewEvents.publish({event:"xsourcing-collectionview-enable-toolbar-button",data:"removeMEI"}),e.actualType===a.TYPE_VENDOR_ITEM&&t.engineeringCollectionView.collectionViewEvents.publish({event:"xsourcing-collectionview-enable-toolbar-button",data:"removeMEI"})},c}),define("DS/ENOXComponentQualification/controllers/EngineeringContextController",["DS/UIKIT/Mask","DS/ENOXComponentQualification/models/Engineering","DS/ENOXComponentQualification/models/Manufacturing","DS/ENOXComponentQualification/controllers/QualificationController","DS/ENOXComponentQualification/views/Context/Engineering/OpenEngineeringItemContext","DS/ENOXComponentQualification/helpers/EngineeringHelper","DS/ENOXComponentQualification/helpers/ManufacturingHelper","DS/ENOXSourcingUXInfra/Search/SearchUtility","DS/ENOXComponentQualification/controllers/ListRecentEngineeringController","DS/ENOXSourcingUXInfra/CommonUtils/CommonUtils","DS/ENOXSourcingUXInfra/Constants/ENOXSourcingConstants","DS/ENOXSourcingUXInfra/Utilities/Utility","DS/ENOXComponentQualification/controllers/VendorItemsController","DS/ENOXSourcingUXInfra/Utilities/HyperLinkHelper"],function(e,t,i,n,o,a,r,l,s,c,d,u,p,m){"use strict";var f=function(e){this.app=e.app,this.engHelper=new a(this),this.mfgHelper=new r(this),this.engModel=new t(this),this.mfgModel=new i(this),this.qualificationController=new n({app:e.app}),this.vendorItemController=new p({app:e.app}),this.meiController=this.app.dataControllers.meiController,this.listRecentEngineeringController=new s({app:e.app}),this.searchUtil=new l,this.utility=new u,this.commonUtils=c,this.NLS=this.app.i18NProvider};return f.prototype.showDetails=function(t){var i=this;t.configs=t.routeDetails,e.mask(widget.body,i.NLS[t.configs.openLoadingMaskNLSKey]);i.getData(t.data.pid,function(n,a){if(i.engContextDetailsView=new o({controller:i,options:t,data:n}),i.engContextDetailsView.render(),i.listRecentEngineeringController.addToRecentlyVisited({pid:t.data.pid},t.configs.recentTrackerWidgetPreference),1===n[0].grid.children.length&&(i.app.taggerProxy.onCloseTagger(),i.setDataForTagger(a,i.mfgModel,n[0].grid.children[0].children)),i.engContextDetailsView.options.data.pid&&i.engContextDetailsView.options.data.qualIdToHighlight){let e={contextObjId:i.engContextDetailsView.options.data.qualIdToHighlight,callControllerMethod:i.qualificationController,updateTable:function(e){let t="",n={};t="eqId",n={grid:{eqPrefered:e.grid.preferred,eqApproved:e.grid.approved,eqComments:e.grid.qualificationComments,eqMaturityStatus:e.grid.qualificationMaturity,eqMaturityStatusDisplay:e.grid.qualificationMaturityDisplay,eqContextRestrictions:e.grid.eqContextRestrictions,eqTitle:e.grid.qualtitle}};var o=i.engContextDetailsView.engineeringCollectionView._xsourcingCollectionViewUI._dataGridView.getTreeDocument().getAllDescendants().filter(t=>t._options.grid.eqId===e.grid.id);o&&1===o.length&&o[0].updateOptions(n)}};i.app._applicationChannel.publish({event:"information-panel-close"}),i.app._applicationChannel.publish({event:"information-panel-add-content",data:{openDetails:(new m).getObjectDetailsInInfoPanel(e)}}),i.app._applicationChannel.publish({event:"information-panel-open-without-reload-content"})}e.unmask(widget.body)},t.configs.name===d.ENG_ITEM_DETAILS_PAGE_ROUTE)},f.prototype.getData=function(e,t,i){i?this.getEngData(e,t):this.getMfgData(e,t)},f.prototype.onPreExpand=function(e){let t=this,i=e.target;if(i.getAttributeValue("id")){let n=e.target.getTreeDocument();if(i.getAttributeValue("type")!==t.engHelper.getDummySourceNodeType()&&0===i.getNumberOfVisibleChildren()){n.prepareUpdate(),i.removeChildren(i.getChildren());let e=function(e){if(0!==e[0].grid.children.length?(t.engHelper.recursivelyLoadChildNodes(i,e[0].grid),n.pushUpdate(),i.preExpandDone()):(n.pushUpdate(),i.preExpandDone()),e[0].grid.children.length<=1&&"Sources"!==i._options.label){let e=[];i._parentNode.options.children.forEach(t=>{"collapseState"===t._expandState&&e.push(t.getAllDescendants())});let n=[];t.engContextDetailsView.engineeringCollectionView.nodeModels=[],e.forEach(e=>{for(let i=1;i<e.length;i++)n.push(e[i]._options.grid.eqId,e[i]._options.grid.gqId),t.engContextDetailsView.engineeringCollectionView.nodeModels.push(e[i])}),t.setDataForTagger(n,t.mfgModel,t.engContextDetailsView.engineeringCollectionView.nodeModels)}};t.getData(i.getAttributeValue("id"),e,!d.DELFMIFUNCTIONREFERENCE_TYPES.includes(i.getAttributeValue("type")))}else i.preExpandDone()}else i.preExpandDone()},f.prototype.getEngData=function(e,t){var i=this;i.mfgModel.expandItem({id:e}).then(function(n){i.qualificationController.model.getAllEquivalentItemsFromContextItemId({id:e,includeParams:"$include=context-restrictions,target,Context"}).then(async function(o){let a=[],r=n.results,l=r.filter(e=>e["ds6w:globalType"]===d.TYPE_DS6W_PART).map(e=>e.resourceid),s=await i.mfgModel.fetchItem({id:e}),c=i.engHelper.simplifyExpandItems(s);i.engModel.navigate({ids:l}).then(n=>{let s=i.engHelper.getProcurementIntents(n,l);i.engHelper.processDetailsData(e,r,o,s,c).then(e=>{1===e[0].grid.children.length&&e[0].grid.children[0].children.forEach(e=>{a.push(e.eqId,e.gqId)}),t(e,a)})}).catch(function(){widget.notificationUtil.showError(i.NLS.loading_eng_item_details_failed)})},function(){widget.notificationUtil.showError(i.NLS.loading_eng_item_details_failed)}).catch(function(){widget.notificationUtil.showError(i.NLS.loading_eng_item_details_failed)})},function(){widget.notificationUtil.showError(i.NLS.loading_eng_item_details_failed)}).catch(function(){widget.notificationUtil.showError(i.NLS.loading_eng_item_details_failed)})},f.prototype.getMfgData=function(t,i){var n=this;n.mfgModel.expandItem({id:t}).then(function(o){if(0===o.results.length)return widget.notificationUtil.showError(n.NLS.object_not_found_not_indexed),void e.unmask(widget.body);n.qualificationController.model.getAllEquivalentItemsFromContextItemId({id:t,includeParams:"$include=context-restrictions,target,Context",isMEQ:!0}).then(async function(e){let a=[],r=o.results,l=r.filter(e=>e.type&&e.type!==d.DELFmiFunctionIdentifiedInstance),s=r.filter(e=>"from"in e&&"to"in e),c=await n.mfgModel.fetchItem({id:t}),u=n.mfgHelper.simplifyExpandItems(c);n.mfgHelper.processDetailsData(t,l,s,e,u).then(e=>{1===e[0].grid.children.length&&e[0].grid.children.forEach(e=>{e.children.forEach(e=>{a.push(e.eqId,e.gqId)})}),i(e,a)})},function(){widget.notificationUtil.showError(n.NLS.loading_mfg_item_details_failed)}).catch(function(){widget.notificationUtil.showError(n.NLS.loading_mfg_item_details_failed)})},function(){widget.notificationUtil.showError(n.NLS.loading_mfg_item_details_failed)}).catch(function(){widget.notificationUtil.showError(n.NLS.loading_mfg_item_details_failed)})},f.prototype.engMEIHyperlinkAction=function(e){let t=e.nodeModel,i=t.getAttributeValue("id");t.getAttributeValue("isMEI")?this.app.router.navigate("home.MEIDetails",{id:i}):t.getAttributeValue("isEngineeringItem")?this.app.router.navigate(d.ENG_ITEM_DETAILS_PAGE_ROUTE,{pid:i},{reload:!0}):this.app.router.navigate(this.configs.name,{pid:i},{reload:!0})},f.prototype.showMEIDetails=function(e){let t=this,i=e.options,n=e.data,o=e.view;t.app._applicationChannel.publish({event:"xsourcing-collectionview-selected-object-id",data:{selectedObject:n,openDetails:function(){var e={};e.data={params:{id:n.id}},e.detailsContainer=t.app._triptychWrapper.getRightPanelContainer(),e.detailsContainer.empty&&e.detailsContainer.empty(),e._mediator=t.app._mediator,e._triptychWrapper=t.app._triptychWrapper,e.router=i.router,e.platformServices=i.platformServices,e.applicationChannel=t.app._applicationChannel,e.forInfo=!0,e.updateListManufacturerEQTable=t.engHelper.updateMEIRow.bind(o),t.meiController.showDetails(e)}}})},f.prototype.createEquivalentQualification=function(t,i){let n=this;e.mask(widget.body,n.NLS.creating_qualification);let o=Array.isArray(i)?i:[i],a=n.engHelper.processMEIENGProxyPayload(t,o);n.qualificationController.model.getProxyObjectId({data:a}).then(function(a){let r=[];o.forEach(o=>{const l=new Promise(r=>{let l=n.qualificationController.helper.getEQCreationPayload(a[o.id],a[t.getAttributeValue("id")],!(n.app.router.getState().name===d.ENG_ITEM_DETAILS_PAGE_ROUTE));i.EEQContextRestrictions&&(l.data[0].dataelements["context-restrictions"]=[],i.EEQContextRestrictions.forEach(e=>{l.data[0].dataelements["context-restrictions"].push(e)})),n.qualificationController.model.createQualification({addData:l}).then(e=>{r({qualificationData:e,meiData:o})}).catch(e=>{widget.notificationUtil.showError(e?e.internalError&&500===e.statusCode?e.internalError:e.error?e.error:n.NLS.equivalent_qualification_create_fail:n.NLS.equivalent_qualification_create_fail)}).finally(()=>{e.unmask(widget.body)})});r.push(l)}),Promise.all(r).then(function(e){n.engHelper.handleNewEQPostProcess(t,e.map(e=>e.qualificationData),e.map(e=>e.meiData))})}).catch(function(){widget.notificationUtil.showError(n.NLS.error_getting_proxy_sourcing),e.unmask(widget.body)})},f.prototype.onDragStartCell=function(e,t,i){let n=e;if("tree"!==n.engContextDetailsView.engineeringCollectionView._xsourcingCollectionViewUI._dataGridView.getColumnOrGroup(i.columnID).dataIndex||i.draggedNodes[0].getAttributeValue("type")===n.engHelper.getDummySourceNodeType())return void t.preventDefault();let o={options:{grid:{actualType:i.draggedNodes[0].getAttributeValue("actualType"),displayType:i.draggedNodes[0].getAttributeValue("typeDisplay"),actualId:i.draggedNodes[0].getAttributeValue("id"),displayName:i.draggedNodes[0].getLabel(),service:d.SOURCE_3DSPACE}}},a=n.engContextDetailsView.engineeringCollectionView._xsourcingCollectionViewUI.formatDataForDnD([o]);return t.dataTransfer.setData("text/plain",JSON.stringify(a)),t},f.prototype.setDataForTagger=function(e,t,i){var n=this;n.utility.get6WTagsForIDs(e,t).then(async function(e){let t={};const o=e.data||[];o.forEach(e=>{e[d.CONTEXT_RESTRICTION_TAG]=[],e[d.CONTEXT_RESTRICTION_TYPE_TAG]=[],e[d.CONTEXT_RESTRICTION_REVISION_TAG]=[],e[d.TARGET_REVISION_TAG]=[],e[d.CONTEXT_REVISION_TAG]=[],e[d.QUALIFICATION_TARGET]=[],e[d.QUALIFICATION_TARGET_TYPE]=[]});var a=0;i.forEach(e=>{if(a<o.length&&o[a].id===(e.eqId?e.eqId:e._options.grid.eqId)){(e.eqContextRestriction?e.eqContextRestriction:e._options.grid.eqContextRestriction).forEach(e=>{o[a][d.CONTEXT_RESTRICTION_TAG].push(e.dataelements.Title),o[a][d.CONTEXT_RESTRICTION_TYPE_TAG].push(e.dataelements.type)})}o[a][d.QUALIFICATION_TARGET].push(e.title?e.title:e._options.grid.title),o[a][d.QUALIFICATION_TARGET_TYPE].push(e.actualType?e.actualType:e._options.grid.actualType),a+=2}),t=n.utility.buildTagObjectData(o),n.app.taggerProxy.closeFacetTagger(),n.app.taggerProxy.onCloseTagger(),n.app.taggerProxy.initTaggerProxy("",t,n.engContextDetailsView.engineeringCollectionView)})},f.prototype.onPreCollapse=function(e){let t=this;if(e.target._parentNode._options.label&&"Sources"!==e.target._options.label){let i=[];e.parent._parentNode._options.children.forEach(e=>{if("collapseState"===e._expandState){let t=e.getAllDescendants();i.push(t),t.forEach(e=>e.show())}});let n=[];t.engContextDetailsView.engineeringCollectionView.nodeModels=[],i.length>0?(i.forEach(e=>{for(let i=1;i<e.length;i++)n.push(e[i]._options.grid.eqId,e[i]._options.grid.gqId),t.engContextDetailsView.engineeringCollectionView.nodeModels.push(e[i])}),t.setDataForTagger(n,t.mfgModel,t.engContextDetailsView.engineeringCollectionView.nodeModels)):t.app.taggerProxy.onCloseTagger()}else"Sources"!==e.target._options.label&&t.app.taggerProxy.onCloseTagger()},f});