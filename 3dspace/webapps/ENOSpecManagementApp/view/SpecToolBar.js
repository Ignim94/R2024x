define("DS/ENOSpecManagementApp/view/SpecToolBar",["UWA/Core","UWA/Class","UWA/Element","UWA/Promise","DS/PlatformAPI/PlatformAPI","DS/XSRCommonComponents/utils/XspecEvents","DS/ENOXCollectionToolBar/js/ENOXCollectionToolBarV2","DS/XSRCommonComponents/utils/Constants","DS/XSRCommonComponents/utils/Notification","DS/ENOSpecManagementApp/control/ToolBarActions","i18n!DS/ENOSpecManagementApp/assets/nls/ENOSpecManagementApp"],function(e,t,o,i,n,s,r,a,l,c,u){"use strict";return t.extend({init:function(e){this._parent(e),this.appCore=e.appCore,this._subscribeList=[],this.initialView=e.initialView,this.initialSort=e.initialSort,this.treeDocument=e.treeDocument,this.toolbarModelEvents=new s},getActionBar:function(e,t){var o=this,i=new c({appCore:o.appCore,treeDocument:o.treeDocument}).getSpecListToolBarMenuView(o);o.toolbarActionCmds=i;var n={modelEvents:o.toolbarModelEvents,withmultisel:!0,multiselActions:null,showItemCount:!0,actions:i,filter:{multiselect:!1,enableCache:!0},sort:[{id:"type",text:u.SortByType,type:"string"},{id:"lastmodified",text:u.SortByLastModified,type:"string"}],views:[{id:a.TILE,text:u.TileView,fonticon:"view-small-tile"},{id:a.THUMBNAIL,text:u.ThumbnailView,fonticon:"view-small-thb"},{id:a.LIST,text:u.ListView,fonticon:"tree-table"}],currentView:o.initialView,currentSort:o.initialSort,currentNbitems:0,currentNbSelections:0},s=new r(n);return s.attachResizeSensor(),o.appCore.toolBarModelEvents=o.toolbarModelEvents,o._subscribeList.push(o.toolbarModelEvents.subscribe({event:a.COLLECTION_TOOLBAR_EVENT_VIEW_ACTIVATED},function(e){t(e)})),o.toolbarModelEvents.publish({event:a.COLLECTION_TOOLBAR_EVENT_VIEW_ACTIVATED,data:n.currentView}),o._subscribeList.push(o.toolbarModelEvents.subscribe({event:a.COLLECTION_TOOLBAR_EVENT_ALL_SELECTED},function(e){o.treeDocument.layout.collectionView.selectAll(!0)})),o._subscribeList.push(o.toolbarModelEvents.subscribe({event:a.COLLECTION_TOOLBAR_EVENT_ALL_UNSELECTED},function(e){o.treeDocument.unselectAll()})),this._subscribeList.push(o.toolbarModelEvents.subscribe({event:a.UPDATE_ITEMVIEW_TOOLBOOR_COUNT},function(e){var t=o.treeDocument?o.treeDocument.getSelectedNodes().length:0;t>0?o.toolbarModelEvents.publish({event:a.COLLECTION_TOOLBAR_CHECKBOX_CHECK_FLAG,data:{}}):o.toolbarModelEvents.publish({event:a.COLLECTION_TOOLBAR_CHECKBOX_UNCHECK_FLAG,data:{}}),o.toolbarModelEvents.publish({event:a.COLLECTION_TOOLBAR_EVENT_UPDATE_COUNT,data:t})})),o._subscribeList.push(o.toolbarModelEvents.subscribe({event:a.COLLECTION_TOOLBAR_SEARCH},function(e){var t=o.treeDocument;(t.prepareUpdate(),t.getChildren().forEach(function(e,t){e.setSearchFilterState(!0),e.applyFilters()}),e.searchValue[0]&&0!==e.searchValue.length)?(t.search({match:function(t){var o=t.nodeModel,i=o.options.grid,n=i.partNumber+" "+i.label+" "+i.current+" "+i.type+" "+i.name+" "+i.revision+" "+i.lastModifiedLocalFormat+" "+i.description;return e.searchValue[0]&&-1!==n.toUpperCase().indexOf(e.searchValue[0].toUpperCase())?(o.setSearchFilterState(!0),!1):(o.setSearchFilterState(!1),!0)},onMatch:function(e){},onunmatch:function(e){}}).forEach(function(e,t){e.unmatchSearch(),e.setSearchFilterState(!1),e.applyFilters()}),t.pushUpdate()):t.pushUpdate()})),o._subscribeList.push(o.toolbarModelEvents.subscribe({event:a.COLLECTION_TOOLBAR_COMMAND_TOGGLE},function(e){if(o.toolbarActionCmds){let t=document.querySelectorAll(".iconbar-root .divider");e.hide?(o.toolbarActionCmds.forEach(function(e){o.toolbarModelEvents.publish({event:a.COLLECTION_TOOLBAR_COMMAND_VISIBILITY,data:{id:e.id,flag:!1}})}),t&&t.length>0&&t[0].setStyle("display","none")):(t&&t.length>0&&t[0].removeAttribute("style"),o.toolbarActionCmds.forEach(function(e){o.toolbarModelEvents.publish({event:a.COLLECTION_TOOLBAR_COMMAND_VISIBILITY,data:{id:e.id,flag:!0}})}))}})),o._subscribeList.push(o.toolbarModelEvents.subscribe({event:a.COLLECTION_TOOLBAR_SORT_ACTIVATED},function(e){var t={id:e.sortAttribute,order:e.sortOrder};widget.setValue("xsrLandingPageSortData",t),o.applySort(t)})),s.inject(e),s},applySort:function(e){this.treeDocument._getTrueRoot().sortChildren({sortFunction:function(t,o){var i=t.options.grid[e.id],n=o.options.grid[e.id],s=e.order;return"ASC"===s?i.localeCompare(n):n.localeCompare(i)}})},destroy:function(){this._subscribeList&&this.toolbarModelEvents.unsubscribeList(this._subscribeList)}})});