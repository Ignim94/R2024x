define("DS/ENOSpecManagementApp/ENOSpecManagementApp",["DS/Controls/Abstract","DS/XSRCommonComponents/utils/Utils","DS/ENOSpecManagementApp/control/XSpecsControl","DS/XSRCommonComponents/service/CommandsService","DS/XSRCommonComponents/service/XSpecsMenuBuilder","DS/XSRCommonComponents/utils/XspecEvents","DS/XSRCommonComponents/utils/RequestUtil","DS/ENOSpecManagementApp/control/XSpecPreferences","DS/ENOSpecManagementApp/util/SpecUtil","DS/ENONewWidget/command/NewContentAppOptions","DS/XSRCommonComponents/components/XPLMNew/XSRNewContentOptions","DS/PlatformAPI/PlatformAPI"],function(e,t,n,i,s,o,a,c,r,p,m,u){"use strict";var S;return e.extend({init:function(){var e=this;a.set3DSpaceURL().then(function(){a.setSecurityContext(),a.setCSRFToken(),a.isCloud()&&a.setMEICSRFToken();var t=new c,d=t.handlePreferences(),f=a.getSecurityContext();d.then(async function(){var a,c={modelEvents:new o,specWidgetPreferences:t},d=function(e){a.then(function(){S=new n(e||c)})};i.initialize(c),s.initialize(c),p.setAppContext(m);var l={};if(widget.getValue("xsr-item")){var C=widget.getValue("xsr-item");C.id&&(l.itemPid=C.id,l.typeActual=C.type,l.isMEI=C.isMEI)}else if(widget.getValue("X3DContentId")){var g=widget.getValue("X3DContentId"),P=JSON.parse(g);l.itemPid=P.data.items[0].objectId,l.openViewer=!0,l.typeActual=P.data.items[0].objectType,l.isMEI=P.data.items[0].objectTaxonomies.includes("ManufacturerEquivalentItemExtension")}if(l&&l.itemPid){var w={data:{itemPid:l.itemPid}};r.checkForObjectExistence(w).then(function(t){t.objectExists&&(c.itemPid=l.itemPid,c.typeActual=l.typeActual,c.typeName=l.typeName,c.isMEI=l.isMEI),f?f&&(a=e.setAdminConfigsPromise(),d(c),(async()=>{await e._setbasicPreConfigs()})()):u.subscribe("sc",async function(){a=e.setAdminConfigsPromise(),d(c),await e._setbasicPreConfigs()})}).catch(function(){d(c),console.log("error occured")})}else f?(a=e.setAdminConfigsPromise(),d(c),await e._setbasicPreConfigs()):u.subscribe("sc",async function(){a=e.setAdminConfigsPromise(),d(c),await e._setbasicPreConfigs()})})}).catch(function(e){console.log(e)})},setAdminConfigsPromise:function(){return t.setAdminConfigs()},_setbasicPreConfigs:async function(){a.getSecurityContext()?(await t.prepareSpecializedTypes(),await t.preparePhysicalProductSubtypes(),await t.prepareRawMaterialSubtypes(),t.prepareTechSpecSubtypes(),await t.prepareUOMTypes(),t.prepareNewProductIncludedtypes(),await t.prepareNewRawMatIncludedtypes(),this.basicPreReqConfigNotSet=!0):this.basicPreReqConfigNotSet=!0},onSearch:function(e){S&&e&&S.onSearch(e)},onResetSearch:function(){S&&S.onSearch()},onRefresh:function(){console.log("called spec refresh"),a.setSecurityContext(),this.basicPreReqConfigNotSet&&this._setbasicPreConfigs(),S?S.onRefresh():this.init()}})});