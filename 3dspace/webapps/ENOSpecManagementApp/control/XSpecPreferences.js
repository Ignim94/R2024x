define("DS/ENOSpecManagementApp/control/XSpecPreferences",["DS/Controls/Abstract","DS/UIKIT/Modal","DS/XSRCommonComponents/utils/RequestUtil","DS/XSRCommonComponents/utils/Constants","DS/XSRCommonComponents/utils/Notification","i18n!DS/ENOSpecManagementApp/assets/nls/ENOSpecManagementApp","DS/XSRCommonComponents/utils/SCChooser","DS/PlatformAPI/PlatformAPI"],function(e,t,n,r,a,i,l,o){"use strict";return e.extend({init:function(){this.userDataCount=0},handlePreferences:function(){var e=this;return new Promise((t,r)=>{var d=widget.hasPreference("Current_security_credentials"),c=widget.hasPreference("CADAuthoring"),s=widget.hasPreference("WorkUnderChange"),u=widget.hasPreference("pad_security_ctx"),f=widget.hasPreference("Intervalswitchpreference"),g=n.getSecurityContext();n.isCloud()&&e.addPlatformPreference(!0),d?t():n.retrieveSCList({callback:function(e){var a=n.getSCPreferenceList(i.SelectCredentials);if(!g)new l({SCManager:a,resolve:t,reject:r});if(g){var o=g.substring(5);widget.setValue("Current_security_credentials",o),widget.setValue("SC",o),widget.setValue("pad_security_ctx",o),widget.setValue("xPref_CREDENTIAL",o),a.defaultValue=o,a.defaultValueNonNls=o}widget.addPreference(a),t()}}),o.subscribe("sc",function(){n.setSecurityContext(),setTimeout(()=>{widget.getValue("Current_security_credentials")||a.displayNotification({eventID:"error",msg:i.NoSecurityContext})},2e3)}),u||e.addPadSecurityCtxPref(),c||e.addCADAuthoringPreference(),s||e.addWorkUnderPreference(),f||e.setIntervalSwitchPreference()})},removePreference:function(e){if(widget.hasPreference(e)){let t=widget.getPreferences();for(let n=0;n<t.length;n++)if(e===t[n].name){widget.preferences.splice(n,1);break}}},addCADAuthoringPreference:function(){var e=widget.getValue("CADAuthoring");widget.addPreference({name:"CADAuthoring",defaultValue:void 0!==e&&e,type:"boolean",label:i.CADAuthoringLabel})},addWorkUnderPreference:function(){var e=widget.getValue("WorkUnderChange");widget.addPreference({name:"WorkUnderChange",defaultValue:void 0===e||e,type:"boolean",label:i.DisplayWorkUnder})},addPadSecurityCtxPref:function(){var e=widget.getValue("pad_security_ctx");widget.addPreference({name:"pad_security_ctx",type:"list",label:"pad_security_ctx",defaultValue:void 0!==e?e:null})},setIntervalSwitchPreference(e){const t={name:"intervalswitchpreference",defaultValue:"180",type:"list",label:i.Auto_Switch_Mode,options:[{label:i.zero_min,value:"0"},{label:i.one_min,value:"60"},{label:i.three_mins,value:"180"},{label:i.five_mins,value:"300"},{label:i.ten_min,value:"600"}]};widget.addPreference(t)},addPlatformPreference:function(e){let t=n.getTenantList(),r=n.getPlatformId();t.forEach(e=>{console.log(e)}),console.log(r);let a=t.find(e=>e.platformId==r);null==a&&(a=t[0],console.log("Preferred Platform not available, using the first one")),widget.addPreference({name:"x3dPlatformId",defaultValue:r,type:e?"list":"hidden",label:i.label_3DEXPERIENCEPlatform,options:t.map(function(e){return{label:e.displayName,value:e.platformId||e.name}}),onchange:"onPlatformIdChange",disabled:t.length<2})}})});