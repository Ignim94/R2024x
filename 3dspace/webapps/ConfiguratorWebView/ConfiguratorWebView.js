var ExperienceKernelPath=function(){for(var e=window.location.search.substring(1).split("&"),t=0;t<e.length;t++){var i=e[t].split("=");if("onWinEnv"==i[0])return"true"==i[1]?"DS/ExperienceKernel/ExperienceKernel":""}return window.__karma__&&window.__karma__.config.args[1]?window.__karma__.config.args[1]:""}();define("DS/ConfiguratorWebView/ConfigurationServices",["UWA/Core","DS/ConfiguratorWebModel/ConfiguratorModel","DS/ConfiguratorWebView/FilterXMLServices","DS/ConfiguratorWebView/PanelController","DS/ConfiguratorWebView/Utilities","UWA/Controls/Accordion",ExperienceKernelPath,"DS/WebappsUtils/WebappsUtils","css!DS/ConfiguratorWebView/ConfiguratorWebView"],function(e,t,i,n,l,r,o,a,s){var d={connectToSolverNode:function(e,i,n){var l=this,r=new t,a=new o.Node({hypervisorIp:e,webSocketPort:i,onText:function(e){l.ApplyAnswer(e)}});r.setNodeSolver(a),r.setNodeSolverName(n);var s=r.getNodeSolver().connect(n).select();r.setSolverId(s);r.getNodeSolver().sendTextOnDisconnection(s,JSON.stringify({_from:"configurator",_to:"solver",_request:"deleteNode",_data:""}))},SetSolverKey:function(e){(new t).setSolverId(e)},EmptyCacheIdWithState:function(){(new t).EmptyCacheIdWithState()},ApplyAnswer:function(i,r){if(null!=i&&""!=i){var o=new t,a=i;try{a=JSON.parse(i)}catch(e){}var s=a._answer,d=a._data,c=a._rc;if("getResultingStatusOriginators"==s){var u=d.listOfIncompatibilitiesIds,p=d.optionSelected;n.createQuestionMarkTooltip(p,u,c),l.RetrieveElement("content")&&l.RetrieveElement("divLoader")&&l.RemoveElement("divLoader")}else if("checkModelConsistency"==s){var g=o.getRulesConsistency();if("Rules_KO"==c||"ERROR"==c){o.setRulesConsistency(!1),o.setRulesActivation("false"),l.deleteInfoBox();var f=e.i18n("InfoInconsistentRules"),m=d.listOfInconsistentRulesIds;if(m.length>0){f+="<br>"+e.i18n("Implied Rules")+":<br>";for(var v=0;v<m.length;v++)f+="<blocquote style='padding-left:20px;'>"+m[v]+"<br></blocquote>"}"ERROR"==c&&(f+="<br>"+e.i18n("InfoComputationAborted")),l.showInfoBox(f,"warning")}else o.setRulesConsistency(!0);g!==o.getRulesConsistency()&&n.updateFilterIcon(),l.RetrieveElement("divLoader")&&l.RemoveElement("divLoader")}else if("solveAndDiagnoseAll"==s){var h=d.configurationCriteria,b=d.modifiedAssumptions,I=d.conflicts,R=d.defaults,y=o.getAction();if(I){if("ERROR"===c){l.deleteInfoBox();f=e.i18n("InfoComplexityOfRules");l.showInfoBox(f,"warning"),o.setErrorOnConflictPanel(!0)}else o.setErrorOnConflictPanel(!1);var S,E=I.listOfListOfConflictingIds,C=I.listOfListOfImpliedRules,w=new Object;for(v=0;v<E.length;v++)for(var x=0;x<E[v].length;x++)S=o.getStateWithId(E[v][x]),(o.isAnOption(E[v][x])||0==E[v][x].indexOf("KeyIn_"))&&("chosen"==S||"chosenInConflict"==S?w[E[v][x]]="chosenInConflict":"dismissed"==S||"dismissedInConflict"==S?w[E[v][x]]="dismissedInConflict":"default"!=S&&"defaultInConflict"!=S||(w[E[v][x]]="defaultInConflict"));for(var W in(!l.onWinEnv()&&"view"!=y.toLowerCase()||l.onWinEnv())&&o.setConfigurationCriteria(h),o.setRulesCompliancyStatus("Invalid"),w)o.setStateWithId(W,w[W]);o.setListOfListOfImpliedRules(C),o.setListOfListOfConflictingIds(E)}else if(h){if(!l.onWinEnv()&&"view"!=y.toLowerCase()||l.onWinEnv())o.setConfigurationCriteria(h);else if(!l.onWinEnv()&&"view"==y.toLowerCase())for(v=0;v<h.length;v++)!o.isAFeature(h[v].Id)||"2"!=h[v].State&&"Required"!=h[v].State||o.setStateWithId(h[v].Id,"requiredFeature");o.setRulesCompliancyStatus("Valid")}if(b.length>0){for(f=e.i18n("InfoIdsIncompatibles")+"<br>",v=0;v<b.length;v++)f+="<blocquote style='padding-left:20px;'>"+l.getFeatureDisplayNameWithId(b[v])+"["+l.getOptionDisplayNameWithId(b[v])+"]<br></blocquote>";l.deleteInfoBox(),(!l.onWinEnv()&&"view"!=y.toLowerCase()||l.onWinEnv())&&l.showInfoBox(f,"warning")}o.setDefaultOptionsList(R),l.RetrieveElement("divLoader")&&l.RemoveElement("divLoader"),l.RetrieveElement("content")&&(n.updateFeatures(!1),l.RetrieveElement("myfeatureOptions")&&n.updateOptionsPanel())}else"setSelectionMode"==s&&!0!==r?l.CallSolveMethodOnSolver():"setMultiSelection"==s&&!0!==r&&l.CallSolveMethodOnSolver()}return!0},setDictionaryJSONAsString:function(e){var i=new t,n=JSON.parse(e);n.dictionary&&i.setDictionary(n.dictionary);i.setConfigurationCriteria([])},setDictionaryJSON:function(e){var i=new t;e&&(e.dictionary?i.setDictionary(e.dictionary):i.setDictionary(e));i.setConfigurationCriteria([])},setConfigurationCriteriaJSON:function(e){var i=new t;if(e){var n=i.checkOptionsAndFeaturesPresenceInDictionary(e);i.setConfigurationCriteria(n)}},getConfigurationCriteria:function(){return(new t).getAdaptedConfigurationCriteria()},getActualConfigurationCriteria:function(){return(new t).getConfigurationCriteria()},getListPrice:function(){return(new t).getTotalPrice()},checkInvalidKeyInFeatures:function(){return"view"==(new t).getAction().toLowerCase()||n.checkInvalidKeyInFeatures()},setAppFuncJSONAsString:function(e){var i=new t,n=JSON.parse(e);n.app_Func&&i.setAppFunc(n.app_Func)},setAppFuncJSON:function(e){var i=new t;e&&(e.app_Func?i.setAppFunc(e.app_Func):i.setAppFunc(e))},setApplicationState:function(e){var i=new t,n=JSON.parse(e);n.applicationState&&i.setApplicationState(n.applicationState)},setAppRulesParamJSONAsString:function(e){var i=new t,n=JSON.parse(e);n&&i.setAppRulesParam(n)},setAppRulesParamJSON:function(e){var i=new t;if(e)return e.appRulesParam?i.setAppRulesParam(e.appRulesParam):i.setAppRulesParam(e)},setPCPurpose:function(e){var i=new t;e&&i.setPCPurpose(e)},setRefineSelMode:function(e){var i=new t;e&&i.setRefineSelMode(e)},getAppRulesParam:function(){return(new t).getAppRulesParam()},initPanel:function(e){if(e&&l.setDefaultOptions(),l.RetrieveElement("MustSelectFeatureDiv")){null!=l.RetrieveElement("prodStatesContainer")?l.RetrieveElement("content").style.height=l.getPageSize().y-(l.RetrieveElement("prodStatesContainer").offsetHeight+115)+"px":l.onWinEnv()?l.RetrieveElement("content").style.height=l.getPageSize().y-87+"px":l.RetrieveElement("content").style.height=l.getPageSize().y-57+"px";var t=l.RetrieveElementByClassName("accordionHeader");if(l.onWinEnv()){if(t&&l.RetrieveElement("configPanel").offsetWidth>30)for(var i=0;i<t.length;i++)t[i].style.width=l.RetrieveElement("configPanel").offsetWidth+"px"}else if(l.RetrieveElement("configPanel").style.width="100%",t)for(i=0;i<t.length;i++)t[i].style.width="100%";l.RetrieveElement("hybridLabel").parentNode.style.paddingLeft=65-l.RetrieveElement("hybridLabel").offsetWidth+"px",l.RetrieveElement("completeLabel").parentNode.style.paddingLeft=75-l.RetrieveElement("completeLabel").offsetWidth+"px",l.RetrieveElement("partialLabel").parentNode.style.paddingLeft=85-l.RetrieveElement("partialLabel").offsetWidth+"px",n.RefreshPanel(),"view"!=this.getAction()&&(l.setAlwaysDiagnosed(),l.CheckRulesConsistency())}else this.LoadPanel(),l.onWinEnv()||(l.RetrieveElement("configPanel").style.width="100%"),l.RetrieveElement("prodStatesContainer")||(n.RefreshPanel(),"view"!=this.getAction()&&(l.setAlwaysDiagnosed(),l.CheckRulesConsistency()));this.checkInvalidKeyInFeatures()},LoadPanel:function(){var i=new t,o=i.getWidget().createElement("div"),s=i.getAction();o.id="configPanel",o.className="ShowConfigPanel";var d="HideAttr";l.onWinEnv()||(d="ShowAttr");var c='<div id="content" style="max-width:'+l.getPageSize().x+'px" class="'+d+'"></div><div id="footer"><div id="MustSelectFeatureDiv" style="padding-top:12px; display:inline-block; width:26px; height:25px;"><img src="'+a.getWebappsAssetUrl("ConfiguratorWebView","icons/ExclamationMark.png")+'"/></div><a id="nbMustSelectFeature" style="vertical-align:top; padding-top:5px;">0</a><div id="DivConflictOnFooter" style="padding-top:12px; display:inline-block; width:23px; height:25px;"><img id="iconConflictOnFooter" src="'+l.getImgPath("chosenInConflict")+'" style="opacity:0;"/></div><a id="nbConflictOnFooter" style="opacity:0; vertical-align:top; padding-top:5px;">0</a><div style="float:right;"><div style="width:1px; display:inline-block; vertical-align:top; margin-top:2px;"><li style="visibility:visible; white-space:nowrap; padding-top:0px; padding-bottom:0px;"><a id="hybridLabel" style="visibility:hidden; color:rgb(49, 87, 132)">'+e.i18n("Hybrid")+'</a></li><li style="visibility:visible; white-space:nowrap; padding-top:0px; padding-bottom:0px;"><a id="completeLabel" style="background-color:rgb(49, 87, 132); visibility:hidden; color:white; padding-left:2px; padding-right:2px;">'+e.i18n("Complete")+'</a></li><li style="visibility:visible; white-space:nowrap; padding-top:0px; padding-bottom:0px;"><a id="partialLabel" style="visibility:hidden; color:rgb(49, 87, 132)">'+e.i18n("Partial")+'</a></li></div><img id="productStateIcon" />';l.onWinEnv()?c=c+'<div style="display:inline-block; vertical-align:top; padding-right:20px;"><li id="RefineButton" style="padding-top:6px; padding-bottom:2px; padding-left:0px; vertical-align:top;"><img id="RefineIcon" style="width:20px; height:14px; padding-right:5px;"/>'+e.i18n("Refine")+'</li><li id="BuildButton" style="padding-top:6px; padding-bottom:2px; padding-left:0px; vertical-align:top;"><img id="BuildIcon" style="width:20px; height:14px; padding-right:5px;"/>'+e.i18n("Build")+"</li></div>":!l.onWinEnv()&&l.isRefineModeEnabled()&&(c=c+'<div style="display:inline-block; vertical-align:top; padding-right:20px;"><li id="RefineButton" style="padding-top:6px; padding-bottom:2px; padding-left:0px; vertical-align:top;"><img id="RefineIcon" style="width:20px; height:14px; padding-right:5px;" src="'+l.getImgPath("refine")+'"/>'+e.i18n("Refine")+'</li><li id="BuildButton" style="padding-top:6px; padding-bottom:2px; padding-left:0px; vertical-align:top;"><img id="BuildIcon" style="width:20px; height:14px; padding-right:5px;" src="'+l.getImgPath("build")+'"/>'+e.i18n("Build")+"</li></div>"),c=c+'<div style="display:inline-block; vertical-align:top; padding-top:12px; padding-right:5px;"><img id="multiSelIcon" style="width:30px; height:30px; padding-right:5px;"/><img id="filterIcon" style="width:30px; height:30px;"/><img id="selectLevelIcon" src='+l.getImgPath("selectLevel")+' style="width:24px; height:30px; vertical-align:top;"/></div></div></div></div>';var u=!1;if(l.onWinEnv())for(var p=window.location.search.substring(1).split("&"),g=0;g<p.length;g++){var f=p[g].split("=");if("debugTool"==f[0]){"true"==f[1]&&(u=!0);break}}else"true"==window.sessionStorage.DS_ConfiguratorCookie_DebugActivated&&(u=!0);u&&(c+="<div id='popupDebug'><div id='popupDebugTitle'>Configurator Debug</div><div id='dumpMessagesDiv'><div id='dumpMessagesTitleDiv'>Dump Solver messages</div><div id='popupDebugPath'>Folder path : </div><input id='debugInputPath' class='inputDebug'></input><br><input id='debugCheckbox' type='checkbox'>Including Solver internal replays</input><br><button id='buttonDebugStart'>Start Dump</button><button id='buttonDebugStop'>Stop Dump</button></div><div>"),o.innerHTML=c;var m=i.getWidget().createElement("div");m.id="prodStatesContainer",m.className="prodStatesContainer";var v=i.getWidget().createElement("div");v.id="prodStatePanel",v.addContent(m);var h=i.getDictionary(),b=n.prodStatesExists(h),I=l.RetrieveElement("topPanel");if(b){var R=new r({className:"accordionHeader"});R.addItem("productStates",{text:e.i18n("Product States")}),R.setContent("productStates",v),I.addContent(R),R.addEvent("onChange",function(){var e=0;l.RetrieveElement("priceInfoPanel")&&(e=23),l.RetrieveElement("content").style.height=l.getPageSize().y-(l.RetrieveElement("prodStatesContainer").offsetHeight+115)+"px",l.RetrieveElement("div_features_table")&&(l.RetrieveElement("div_features_table").style.height=l.RetrieveElement("content").style.height.replace("px","")-33-e+"px")}),(y=new r({className:"accordionHeader"})).addItem("configFeatures",{text:e.i18n("Configuration Features")}),y.setContent("configFeatures",o),I.addContent(y),i.setAccordConfigurationFeature(y),n.showTree(b),R.toggleItem("productStates")}else{var y;if(!l.RetrieveElement("configFeatures"))(y=new r({className:"accordionHeader"})).addItem("configFeatures",{text:e.i18n("Configuration Features")}),y.setContent("configFeatures",o),I.addContent(y),y.toggleItem("configFeatures");l.onWinEnv()||(l.RetrieveElementByClassName("uwa-accordion-item-title")[0].style.display="none")}l.RetrieveElement("hybridLabel").parentNode.style.paddingLeft=65-l.RetrieveElement("hybridLabel").offsetWidth+"px",l.RetrieveElement("completeLabel").parentNode.style.paddingLeft=75-l.RetrieveElement("completeLabel").offsetWidth+"px",l.RetrieveElement("partialLabel").parentNode.style.paddingLeft=85-l.RetrieveElement("partialLabel").offsetWidth+"px",i.getWidget().body.style.padding=0,null!=l.RetrieveElement("prodStatesContainer")?l.RetrieveElement("content").style.height=l.getPageSize().y-(l.RetrieveElement("prodStatesContainer").offsetHeight+115)+"px":l.onWinEnv()?l.RetrieveElement("content").style.height=l.getPageSize().y-87+"px":l.RetrieveElement("content").style.height=l.getPageSize().y-57+"px",(l.onWinEnv()||l.isRefineModeEnabled())&&(l.addEvent("click",l.RetrieveElement("RefineButton"),function(){n.RefineBuildIconCallback(this)}),l.addEvent("click",l.RetrieveElement("BuildButton"),function(){n.RefineBuildIconCallback(this)})),(!l.onWinEnv()&&"view"!=s.toLowerCase()||l.onWinEnv())&&(l.addEvent("click",l.RetrieveElement("multiSelIcon"),function(){n.multiSelIconCallback()}),l.addEvent("click",l.RetrieveElement("filterIcon"),function(){n.filterIconCallback()}),l.addEvent("click",l.RetrieveElement("selectLevelIcon"),function(){n.createFilterPanel()})),l.addEvent("mousedown",l.RetrieveElement("configPanel"),function(e){n.removePanelsOnClick(e)});var S=document.getElementById("popupDebugTitle");S&&(l.addEvent("mousedown",S,n.debugClickDown),l.addEvent("mouseup",S,n.debugClickUp),l.addEvent("click",l.RetrieveElement("buttonDebugStart"),n.debugStartBtnCbk),l.addEvent("click",l.RetrieveElement("buttonDebugStop"),n.debugStopBtnCbk)),window.onbeforeunload=function(e){(!l.onWinEnv()&&"create"==s.toLowerCase()||l.onWinEnv())&&(window.localStorage.setItem("DS_ConfiguratorCookie_AppRulesParam",JSON.stringify(i.getAppRulesParam())),window.localStorage.setItem("DS_ConfiguratorCookie_AppState",JSON.stringify(i.getApplicationState())))}},setAction:function(e){var i=new t;e&&i.setAction(e)},getAction:function(){return(new t).getAction()},GetXMLExpressionForSaveCommand:function(){var e,n,r,o,a=new t,s=new i("FilterExpression"),d={configurationCriteria:a.getConfigurationCriteria(),dictionary:a.getDictionary(),app_RulesParam:a.getAppRulesParam(),app_Func:a.getAppFunc(),evolutionCriteria:a.getEvolutionCriteria()},c=s.json2xml_str(d);e="true"==a.getmultiSelect(),n="true"==a.getRulesActivation(),"RulesMode_EnforceRequiredOptions"==a.getRulesMode()?r="RulesMode_EnforceRequiredOptions":"RulesMode_DisableIncompatibleOptions"==a.getRulesMode()?r="RulesMode_DisableIncompatibleOptions":"RulesMode_ProposeOptimizedConfiguration"==a.getRulesMode()?r="RulesMode_ProposeOptimizedConfiguration":"RulesMode_SelectCompleteConfiguration"==a.getRulesMode()&&(r="RulesMode_SelectCompleteConfiguration"),o=a.getCompletenessStatus();var u="MultiSelectionAllowed:"+e;return u+=";EvaluateRules:"+n,u+=";RuleEvaluationMode:"+r,u+=";RulesCompliancyStatus:"+a.getRulesCompliancyStatus(),u+=";CompletenessStatus:"+o,a.getEvolutionCriteria().productState?u+=";pStateNameAndRev:"+a.getEvolutionCriteria().productState.name+a.getEvolutionCriteria().productState.revision:u+=";pStateNameAndRev:null",u+=";XMLForSaveCommand:"+c,c&&l.send_notif(u),u},setConfigurationCriteriaXML:function(e){var r=new i("FilterExpression"),o=r.xmlToJson(r.parseXml(e));new t;if(l.RemovePanels(),o.CfgFilterExpression.FilterSelection.TreeSeries&&l.RetrieveElement("prodStatesContainer")){var a=o.CfgFilterExpression.FilterSelection.TreeSeries.Single.attributes.Name,s=o.CfgFilterExpression.FilterSelection.TreeSeries.Single.attributes.Revision;n.selectProductState(a,s)}else if(o.CfgFilterExpression.FilterSelection.Context&&o.CfgFilterExpression.FilterSelection.Context.TreeSeries&&l.RetrieveElement("prodStatesContainer")){a=o.CfgFilterExpression.FilterSelection.Context.TreeSeries.Single.attributes.Name,s=o.CfgFilterExpression.FilterSelection.Context.TreeSeries.Single.attributes.Revision;n.selectProductState(a,s)}l.setConfCriteriaFromXMLVar(e)}};return e.namespace("DS/ConfiguratorWebView/ConfigurationServices",d)});var UIKitDatePickerPath=function(){for(var e=window.location.search.substring(1).split("&"),t=0;t<e.length;t++){var i=e[t].split("=");if("onWinEnv"==i[0])return"true"==i[1]?"":"DS/UIKIT/DatePicker"}return"DS/UIKIT/DatePicker"}();define("DS/ConfiguratorWebView/PanelController",["UWA/Core","DS/ConfiguratorWebModel/ConfiguratorModel","DS/ConfiguratorWebView/Utilities",UIKitDatePickerPath,"DS/WebappsUtils/WebappsUtils","css!DS/ConfiguratorWebView/ConfiguratorWebView","DS/ConfiguratorWebExternal/PSTreeLib"],function(e,t,n,l,r,o){var a={RefineBuildIconCallback:function(e){var i=new t,l=i.getConfigurationMode(),r=i.getDictionary().features;if("RefineButton"==e.id&&"selectionMode_Refine"!=l&&"yes"==i.getAppFunc().selectionMode_Refine)i.setConfigurationMode("selectionMode_Refine");else if("BuildButton"==e.id&&"selectionMode_Build"!=l&&"yes"==i.getAppFunc().selectionMode_Build){i.setConfigurationMode("selectionMode_Build");for(var o=0;o<r.length;o++)n.RemoveAllSpecifiedStateOccurrenceInFeature(r[o].ruleId,"dismissed"),n.RemoveAllSpecifiedStateOccurrenceInFeature(r[o].ruleId,"dismissedInConflict")}"true"==i.getRulesActivation()?n.CallSolveMethodOnSolver():a.updateFeatures(!1),this.updateRefineBuildIcons()},RefreshPanel:function(){this.setFeatures(),this.updateMultiSelIcon(!0),this.updateFilterIcon(!1,!1),this.updateRefineBuildIcons()},updateRefineBuildIcons:function(){var i=new t,l=i.getConfigurationMode(),r=n.RetrieveElement("BuildIcon"),o=n.RetrieveElement("RefineIcon");if("selectionMode_Build"==l&&"yes"==i.getAppFunc().selectionMode_Build||"selectionMode_Refine"==l&&"no"==i.getAppFunc().selectionMode_Refine&&"yes"==i.getAppFunc().selectionMode_Build){r.src=n.getImgPath("buildSelected"),o.src=n.getImgPath("refine"),i.setConfigurationMode("selectionMode_Build");for(var a=n.RetrieveElementByClassName("featureInput"),s=0;s<a.length;s++)a[s].placeholder=e.i18n("None");this.RemoveIncludedStateOnBuildMode(),this.updateCompletenessIcon(),n.onWinEnv()&&n.sendXMLtoNativeEnv()}else if("selectionMode_Refine"==l&&"yes"==i.getAppFunc().selectionMode_Refine||"selectionMode_Build"==l&&"no"==i.getAppFunc().selectionMode_Build&&"yes"==i.getAppFunc().selectionMode_Refine){r.src=n.getImgPath("build"),o.src=n.getImgPath("refineSelected"),i.setConfigurationMode("selectionMode_Refine");for(a=n.RetrieveElementByClassName("featureInput"),s=0;s<a.length;s++)"true"==i.getRulesActivation()?a[s].placeholder=e.i18n("All compatibles"):"false"==i.getRulesActivation()&&(a[s].placeholder=e.i18n("All"));this.AddIncludedStateOnRefineMode(),this.updateCompletenessIcon(),n.onWinEnv()&&n.sendXMLtoNativeEnv()}else r.src=n.getImgPath("build"),o.src=n.getImgPath("refine")},multiSelIconCallback:function(){var i=new t;if("false"==i.getmultiSelect()&&"yes"==i.getAppFunc().multiSelection)i.setmultiSelect("true");else if("true"==i.getmultiSelect())if(n.DetectMultiSelOnSingleFeatures()){var l=n.ResetMultiSelOnSingleFeatures();if(i.setmultiSelect("false"),!0,n.deleteInfoBox(),l.length>0){for(var r=e.i18n("InfoUnsettingMultiSelection")+"<br>",o=0;o<l.length;o++)r+="<blocquote style='padding-left:20px;'>"+n.getFeatureDisplayNameWithId(l[o])+"<br></blocquote>";n.showInfoBox(r,"warning")}}else i.setmultiSelect("false");a.updateFeatures(!1),n.RetrieveElement("myfeatureOptions")&&a.updateOptionsPanel(),this.updateMultiSelIcon(!1)},updateMultiSelIcon:function(i){var l=n.RetrieveElement("multiSelIcon"),r=new t,o=r.getAction();if("no"==r.getAppFunc().multiSelection&&r.setmultiSelect("false"),"true"==r.getmultiSelect())l.src=n.getImgPath("multiSelectionSelected"),l.title=e.i18n("Multi-Selection")+": "+e.i18n("enabled"),"view"!=o.toLowerCase()&&this.SetMultiSelOnSolver(!0,i),"true"==r.getRulesActivation()&&1==r._showWarningInfoBox&&(!n.onWinEnv()&&"view"!=o.toLowerCase()||n.onWinEnv())&&n.showInfoBox(e.i18n("InfoMultiSelAndRules"),"info");else if("false"==r.getmultiSelect()){l.src=n.getImgPath("multiSelection"),l.title=e.i18n("Multi-Selection")+": "+e.i18n("disabled"),"view"!=o.toLowerCase()&&this.SetMultiSelOnSolver(!1,i);n.RetrieveElement("InfoBox")}},filterIconCallback:function(){var e=new t;"false"==e.getRulesActivation()?0!=e.getRulesConsistency()&&(e.setRulesActivation("true"),this.updateFilterIcon()):"true"==e.getRulesActivation()&&(e.setRulesActivation("false"),e.setRulesCompliancyStatus("Unknown"),this.updateFilterIcon())},updateFilterIcon:function(i,l){var r,o=n.RetrieveElement("filterIcon"),a=new t,s=a.getAction();if("false"==a.getRulesActivation()){"RulesMode_ProposeOptimizedConfiguration"==a.getRulesMode()?(o.src=n.getImgPath("optim"),o.title=e.i18n("Rules")+": "+e.i18n("disabled")+"\n"+e.i18n("Rules assistance level")+": "+e.i18n("Propose optimized configuration on List Price")):"RulesMode_SelectCompleteConfiguration"==a.getRulesMode()?(o.src=n.getImgPath("completeConfMode"),o.title=e.i18n("Rules")+": "+e.i18n("disabled")+"\n"+e.i18n("Rules assistance level")+": "+e.i18n("Select complete configuration")):"RulesMode_EnforceRequiredOptions"==a.getRulesMode()?(o.src=n.getImgPath("dependencies"),o.title=e.i18n("Rules")+": "+e.i18n("disabled")+"\n"+e.i18n("Rules assistance level")+": "+e.i18n("Enforce required options and select defaults")):"RulesMode_DisableIncompatibleOptions"==a.getRulesMode()&&(o.src=n.getImgPath("incompatibilities"),o.title=e.i18n("Rules")+": "+e.i18n("disabled")+"\n"+e.i18n("Rules assistance level")+": "+e.i18n("Disable incompatible options"));n.RetrieveElement("InfoBox")}else"true"==a.getRulesActivation()&&("RulesMode_ProposeOptimizedConfiguration"==a.getRulesMode()&&"yes"==a.getAppFunc().rulesMode_ProposeOptimizedConfiguration?(o.src=n.getImgPath("optimSelected"),o.title=e.i18n("Rules")+": "+e.i18n("enabled")+"\n"+e.i18n("Rules assistance level")+": "+e.i18n("Propose optimized configuration on List Price"),r="Select_OptimalSelection",i||"true"!=a.getmultiSelect()||1!=a._showWarningInfoBox||(!n.onWinEnv()&&"view"!=s.toLowerCase()||n.onWinEnv())&&n.showInfoBox(e.i18n("InfoMultiSelAndRules"),"info"),n.setOptimizationFunctionOnSolver()):"RulesMode_SelectCompleteConfiguration"==a.getRulesMode()&&"yes"==a.getAppFunc().rulesMode_SelectCompleteConfiguration?(o.src=n.getImgPath("completeConfModeSelected"),o.title=e.i18n("Rules")+": "+e.i18n("enabled")+"\n"+e.i18n("Rules assistance level")+": "+e.i18n("Select complete configuration"),r="Select_ProposedSelection",i||"true"!=a.getmultiSelect()||1!=a._showWarningInfoBox||(!n.onWinEnv()&&"view"!=s.toLowerCase()||n.onWinEnv())&&n.showInfoBox(e.i18n("InfoMultiSelAndRules"),"info")):"RulesMode_EnforceRequiredOptions"==a.getRulesMode()&&"yes"==a.getAppFunc().rulesMode_EnforceRequiredOptions?(o.src=n.getImgPath("dependenciesSelected"),o.title=e.i18n("Rules")+": "+e.i18n("enabled")+"\n"+e.i18n("Rules assistance level")+": "+e.i18n("Enforce required options and select defaults"),r="Select_RequiredAndDefault",i||"true"!=a.getmultiSelect()||1!=a._showWarningInfoBox||(!n.onWinEnv()&&"view"!=s.toLowerCase()||n.onWinEnv())&&n.showInfoBox(e.i18n("InfoMultiSelAndRules"),"info")):"RulesMode_DisableIncompatibleOptions"==a.getRulesMode()&&"yes"==a.getAppFunc().rulesMode_DisableIncompatibleOptions?(o.src=n.getImgPath("incompatibilitiesSelected"),o.title=e.i18n("Rules")+": "+e.i18n("enabled")+"\n"+e.i18n("Rules assistance level")+": "+e.i18n("Disable incompatible options"),r="Select_None",i||"true"!=a.getmultiSelect()||1!=a._showWarningInfoBox||(!n.onWinEnv()&&"view"!=s.toLowerCase()||n.onWinEnv())&&n.showInfoBox(e.i18n("InfoMultiSelAndRules"),"info")):a.setRulesActivation("false"),r&&"view"!=s.toLowerCase()&&n.setSelectionModeOnSolver(r,l));if(o.style.opacity="1",0==a.getRulesConsistency()&&(o.style.opacity="0.3"),"true"!=a.getRulesActivation()){var d=a.getDictionary().features;if("view"!=s.toLowerCase())for(var c=0;c<d.length;c++)n.RemoveAllSpecifiedStateOccurrenceInFeature(d[c].ruleId,"required"),n.RemoveAllSpecifiedStateOccurrenceInFeature(d[c].ruleId,"incompatible"),n.RemoveAllSpecifiedStateOccurrenceInFeature(d[c].ruleId,"recommanded"),n.RemoveAllSpecifiedStateOccurrenceInFeature(d[c].ruleId,"default");var u=a.getConfigurationCriteria();for(c=0;c<u.length;c++)"dismissedInConflict"==u[c].State?a.setStateWithId(u[c].Id,"dismissed"):"chosenInConflict"==u[c].State?a.setStateWithId(u[c].Id,"chosen"):"defaultInConflict"==u[c].State&&a.setStateWithId(u[c].Id,"default");this.updateFeatures(!1),n.RetrieveElement("myfeatureOptions")&&this.updateOptionsPanel()}},changeFilterIcon:function(e){var i=n.RetrieveElement(e);(new t).setRulesMode(i.id),this.updateFilterIcon(!0),n.RetrieveElement("filterPanel")&&n.RemoveElement("filterPanel")},AttrButtonCallback:function(){var e,t,i,l=n.RetrieveElement("content"),r=n.RetrieveElement("ArrowAttrImg"),o=!1;if("ShowAttr"==l.className){n.RetrieveElement("InfoBox")&&"InfoBoxVisible"==n.RetrieveElement("InfoBox").value?(t=n.RetrieveElement("TextInfoBox").innerHTML,i=n.RetrieveElement("IconInfoBox").value,n.deleteInfoBox(),o=!0):n.RetrieveElement("InfoBox")&&n.deleteInfoBox(t),e=n.RetrieveElementByTags("td");for(var a=0;a<e.length;a++)"featureAttr"==e[a].className&&(e[a].style.display="none");n.RetrieveElement("tableAttrTitle").style.display="none",r.src=n.getImgPath("rightArrow"),l.className="HideAttr",null!=n.RetrieveElement("prodStatesContainer")&&(n.RetrieveElement("content").style.height=n.getPageSize().y-(n.RetrieveElement("prodStatesContainer").offsetHeight+115)+"px",n.RetrieveElement("prodStatePanel").style.width=n.RetrieveElement("content").offsetWidth+"px",n.RetrieveElement("prodStatePanel").parentNode.style.width=n.RetrieveElement("content").offsetWidth+"px");var s=n.RetrieveElement("content").scrollWidth+"px",d=n.RetrieveElementByClassName("accordionHeader");for(a=0;a<d.length;a++)d[a].style.width="",d[a].style.width=s;n.onWinEnv()||n.resizeWindow(!1)}else if("HideAttr"==l.className){e=n.RetrieveElementByTags("td");for(a=0;a<e.length;a++)"featureAttr"==e[a].className&&(e[a].style.display="inline-block");n.RetrieveElement("tableAttrTitle").style.display="inline-block",n.SetSizeOfAttributsCellsTable(n.RetrieveElement("tableAttr"),n.RetrieveElement("tableAttrTitle"),n.RetrieveElement("div_features_table")),r.src=n.getImgPath("leftArrow"),l.className="ShowAttr",null!=n.RetrieveElement("prodStatesContainer")&&(n.RetrieveElement("content").style.height=n.getPageSize().y-(n.RetrieveElement("prodStatesContainer").offsetHeight+115)+"px",n.RetrieveElement("prodStatePanel").style.width=n.RetrieveElement("content").offsetWidth+"px",n.RetrieveElement("prodStatePanel").parentNode.style.width=n.RetrieveElement("content").offsetWidth+"px");for(s=n.RetrieveElement("content").scrollWidth+"px",d=n.RetrieveElementByClassName("accordionHeader"),a=0;a<d.length;a++)d[a].style.width="",d[a].style.width=s;n.RetrieveElement("InfoBox")&&"InfoBoxVisible"==n.RetrieveElement("InfoBox").value&&(t=n.RetrieveElement("TextInfoBox").innerHTML,i=n.RetrieveElement("IconInfoBox").value,n.showInfoBox(t,i)),n.onWinEnv()||n.resizeWindow(!0)}var c=n.RetrieveElementByClassName("accordionHeader");if(c&&n.RetrieveElement("configPanel").offsetWidth>30)for(a=0;a<c.length;a++)c[a].style.width="",c[a].style.width=n.RetrieveElement("configPanel").offsetWidth+"px";null!=n.RetrieveElement("prodStatesContainer")&&(n.RetrieveElement("prodStatePanel").style.width=n.RetrieveElement("content").offsetWidth+"px",n.RetrieveElement("prodStatePanel").parentNode.style.width=n.RetrieveElement("content").offsetWidth+"px"),o&&n.showInfoBox(t,i),n.onWinEnv()&&n.updateWebViewerWidthInNativeEnv(!0)},ShowHidePanelCallback:function(){var e=n.RetrieveElement("configPanel");"ShowConfigPanel"==e.className?(e.className="HideConfigPanel",n.RetrieveElement("ArrowPanelImg").src=n.getImgPath("rightArrow"),n.RemovePanels()):"HideConfigPanel"==e.className&&(e.className="ShowConfigPanel",n.RetrieveElement("ArrowPanelImg").src=n.getImgPath("leftArrow"))},removePanelsOnClick:function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0;var t=e.currentTarget?e.currentTarget:e.srcElement;t.className&&"featureInput"!==t.className&&n.RemovePanels()},updateSearchResult:function(e,i,l){var r,o,a,s,d=e.value,c=n.RetrieveElement(i),u=n.RetrieveElement(l),p=new t,g=u.rows.length;for(r=0;r<g;r++)u.deleteRow(0);var f,m=n.RetrieveElementByClassName("selected"),v="";if(c.style.border="none",""!=d)for(e.className="NonEmptyInput",r=0;r<c.rows.length;r++)if(("incompatibleFeature"!=(s=p.getStateWithId(c.rows[r].id.split("_")[1]))||"incompatibleFeature"==s&&n.isIncompatibleWithUserSelection(c.rows[r].id.split("_")[1]))&&(c.rows[r].style.display="table-row"),f=!1,n.onWinEnv()||"keyInOption"!=c.rows[r].cells[0].id)if(m.length>0){for(o=0;o<m.length;o++)if(v="","FeatureAttrLabel"==m[o].id.split("_")[0]&&"tableAttr"==i)for(a=1;a<c.rows[r].cells.length;a++)c.rows[r].cells[a].id=="featureAttrId_"+m[o].id.split("_")[1]&&(v=""!=c.rows[r].cells[a].firstChild.title?c.rows[r].cells[a].firstChild.title:c.rows[r].cells[a].firstChild.textContent),f=-1==v.toUpperCase().indexOf(d.toUpperCase());else if("OptionAttrLabel"==m[o].id.split("_")[0]&&"tableOptionsAttr"==i)for(a=1;a<c.rows[r].cells.length;a++)c.rows[r].cells[a].id=="attrId_"+m[o].id.split("_")[1]&&(v=""!=c.rows[r].cells[a].firstChild.title?c.rows[r].cells[a].firstChild.title:c.rows[r].cells[a].firstChild.textContent),f=-1==v.toUpperCase().indexOf(d.toUpperCase());else f=!0;if(-1==(c.rows[r].cells[0].children[0].children[0].children[0]?c.rows[r].cells[0].children[0].children[0].children[0].children[2].children[0].textContent.toUpperCase():""!=c.rows[r].cells[0].children[1].children[1].title?c.rows[r].cells[0].children[1].children[1].title.toUpperCase():c.rows[r].cells[0].children[1].children[1].textContent.toUpperCase()).indexOf(d.toUpperCase())&&1==f){var h=c.rows[r].cloneNode(!0);u.appendChild(h),c.rows[r].style.display="none";var b=u.rows.length;u.rows[b-1].cells[0].style.width=c.rows[0].cells[0].style.width,"ResultSearchOptions"==u.id?u.rows[b-1].cells[0].childNodes[1].className="disabled":(u.rows[b-1].cells[0].firstChild.disabled="disabled",u.rows[b-1].cells[0].firstChild.firstChild.rows[0].cells[2].children[1].firstChild.value=c.rows[r].cells[0].firstChild.firstChild.rows[0].cells[2].children[1].firstChild.value),c.style.borderBottom="1px solid black",u.rows[b-1].style.opacity=.4}}else if(c.rows[r].cells[0].children[0].children[0].children[0]?c.rows[r].cells[0].children[0].children[0].children[0].children[2].children[0].textContent.toUpperCase():c.rows[r].cells[0].textContent.toUpperCase(),-1==c.rows[r].cells[0].children[0].children[0].children[0].children[2].children[0].textContent.toUpperCase().indexOf(d.toUpperCase())){h=c.rows[r].cloneNode(!0);u.appendChild(h),c.rows[r].style.display="none";b=u.rows.length;u.rows[b-1].cells[0].style.width=c.rows[0].cells[0].style.width,"ResultSearchOptions"==u.id?u.rows[b-1].cells[0].childNodes[1].className="disabled":(u.rows[b-1].cells[0].firstChild.disabled="disabled",u.rows[b-1].cells[0].firstChild.firstChild.rows[0].cells[2].children[1].firstChild.value=c.rows[r].cells[0].firstChild.firstChild.rows[0].cells[2].children[1].firstChild.value),c.style.borderBottom="1px solid black",u.rows[b-1].style.opacity=.4}if(""==d)for(e.className="EmptyInput",r=0;r<c.rows.length;r++)("incompatibleFeature"!=(s=p.getStateWithId(c.rows[r].id.split("_")[1]))||"incompatibleFeature"==s&&n.isIncompatibleWithUserSelection(c.rows[r].id.split("_")[1]))&&(c.rows[r].style.display="table-row")},updateCheckReject:function(e){var i=new t,l=e.parentNode.parentNode.value;"checkIcon"==e.id&&(i.setRefineSelectionModeForSpecifiedFeature(l,"select"),n.RemoveAllSpecifiedStateOccurrenceInFeature(l,"dismissed"),n.RemoveAllSpecifiedStateOccurrenceInFeature(l,"dismissedInConflict")),"rejectIcon"==e.id&&(i.setRefineSelectionModeForSpecifiedFeature(l,"reject"),n.RemoveAllSpecifiedStateOccurrenceInFeature(l,"chosen"),n.RemoveAllSpecifiedStateOccurrenceInFeature(l,"chosenInConflict")),"true"==i.getRulesActivation()?n.CallSolveMethodOnSolver():(a.updateFeatures(!1),n.RetrieveElement("myfeatureOptions")&&this.updateOptionsPanel()),this.updateCheckRejectIcon()},updateCheckRejectIcon:function(){var e=new t,i=n.RetrieveElement("checkIcon"),l=n.RetrieveElement("rejectIcon"),r=i.parentNode.parentNode.value;"select"==e.getRefineSelectionModeForSpecifiedFeature(r)?(i.src=n.getImgPath("checkIconSelected"),l.src=n.getImgPath("rejectIcon")):"reject"==e.getRefineSelectionModeForSpecifiedFeature(r)&&(i.src=n.getImgPath("checkIcon"),l.src=n.getImgPath("rejectIconSelected"))},updateFeatureState:function(e){var i,l,r=new t,o=r.getDictionary().features,a=[],s=!1,d=1,c=!1;if("incompatibleFeature"!=r.getStateWithId(e)||n.isIncompatibleWithUserSelection(e)){if(0==r.getCacheOrderableState()[e])return n.RetrieveElement("LineFeature_"+e).style.display="none",void r.setStateWithId(e,"incompatibleFeature");for(var u=0;u<o.length;u++)if(o[u].ruleId==e){s=!1;for(var p=0;p<o[u].options.length;p++)"chosen"!=(l=r.getStateWithId(o[u].options[p].ruleId))&&"chosenInConflict"!=l&&"defaultInConflict"!=l&&"default"!=l&&"required"!=l||n.DetectMultiSelOnFeature(o[u].name)||""==o[u].options[p].image?s||(""!=o[u].image?n.RetrieveElement("imageFeature"+o[u].ruleId).src=o[u].image:n.RetrieveElement("imageFeature"+o[u].ruleId).src=n.getImgPath("defaultFeatureImage")):(n.RetrieveElement("imageFeature"+o[u].ruleId).src=o[u].options[p].image,s=!0,"chosenInConflict"!=l&&"defaultInConflict"!=l||o[u].options[p].ruleId),l&&"available"!=l&&"included"!=l&&"incompatible"!=l&&("dismissed"!==l&&"dismissedInConflict"!==l||"selectionMode_Build"!==r.getConfigurationMode())&&(-1==n.RetrieveElement("input"+e).value.indexOf(o[u].options[p].displayName)&&(""!=n.RetrieveElement("input"+e).value&&n.RetrieveElement("input"+e).rows++,"dismissed"!=l&&"dismissedInConflict"!=l||(n.RetrieveElement("input"+e).value+="Except "),n.RetrieveElement("input"+e).value+=n.htmlDecode(o[u].options[p].displayName)+"\n"),d++),-1==a.indexOf(r.getStateWithId(o[u].options[p].ruleId))&&a.push(r.getStateWithId(o[u].options[p].ruleId));if(n.RetrieveElement("LineFeature_"+o[u].ruleId).style.display="table-row",!n.onWinEnv()&&o[u].keyInType&&"Blank"!=o[u].keyInType){var g="",f=r.getStateWithId("KeyIn_"+e);if(f&&"available"!=f&&"included"!=f&&"incompatible"!=f&&("dismissed"!==f&&"dismissedInConflict"!==f||"selectionMode_Build"!==r.getConfigurationMode())){g=r.getKeyInValueById("KeyIn_"+e);var m=null;if("Date"==o[u].keyInType){if(!(m=r.getDateKeyInDisplayValueById("KeyIn_"+e))){var v=new Date(parseInt(g));if(!isNaN(Date.parse(v.toString()))){m=v.toLocaleDateString(navigator.language,{year:"numeric",month:"short",day:"numeric"}),r.setDateKeyInDisplayValueById("KeyIn_"+e,m)}}g=m}}g&&(c=!0),c&&(""!=o[u].image?n.RetrieveElement("imageFeature"+o[u].ruleId).src=o[u].image:n.RetrieveElement("imageFeature"+o[u].ruleId).src=n.getImgPath("defaultFeatureImage")),g=n.getElipsisValue(g);var h=n.RetrieveElement("input"+e).value.split("\n");h.length==d?(h[d-1]=g,n.RetrieveElement("input"+e).rows=d,n.RetrieveElement("input"+e).value=h.join("\n"),""==g&&""!=n.RetrieveElement("input"+e).value&&n.RetrieveElement("input"+e).rows--):n.RetrieveElement("input"+e).value+=g,-1==a.indexOf(r.getStateWithId("KeyIn_"+e))&&a.push(r.getStateWithId("KeyIn_"+e))}i=-1!=a.indexOf("chosenInConflict")?"chosenInConflict":-1!=a.indexOf("defaultInConflict")?"defaultInConflict":-1!=a.indexOf("dismissedInConflict")?"dismissedInConflict":-1!=a.indexOf("chosen")&&c?"keyIn":-1!=a.indexOf("chosen")?"chosen":-1!=a.indexOf("dismissed")&&"selectionMode_Refine"===r.getConfigurationMode()?"dismissedFeature":-1!=a.indexOf("default")?"default":-1!=a.indexOf("required")?"requiredByRules":-1!=a.indexOf("recommanded")?"recommanded":(-1!=a.indexOf("incompatible")||-1!=a.indexOf("included")&&a.indexOf("dismissed"),o[u].selectionCriteria&&"MAY"==o[u].selectionCriteria.toUpperCase()&&"requiredFeature"!=r.getStateWithId(e)?"maySelectFeature":"mustSelectFeature"),n.RetrieveElement("iconFeature"+o[u].ruleId).src=n.getImgPath(i),r.setStateWithId(o[u].ruleId,i),"chosenInConflict"==i||"dismissedInConflict"==i||"defaultInConflict"==i?(n.RetrieveElement("divImageFeature"+o[u].ruleId).style.border="2px solid rgb(204, 87, 103)",n.RetrieveElement("divImageFeature"+o[u].ruleId).style.opacity="1"):"chosen"==i||"keyIn"==i||"dismissedFeature"==i||"recommanded"==i||"default"==i||"requiredByRules"==i?(n.RetrieveElement("divImageFeature"+o[u].ruleId).style.border="2px solid rgb(49, 87, 132)",n.RetrieveElement("divImageFeature"+o[u].ruleId).style.opacity="1"):(n.RetrieveElement("divImageFeature"+o[u].ruleId).style.border="2px solid rgba(150, 150, 150, 0.5)",n.RetrieveElement("divImageFeature"+o[u].ruleId).style.opacity="0.5",""!=o[u].image?n.RetrieveElement("imageFeature"+o[u].ruleId).src=o[u].image:n.RetrieveElement("imageFeature"+o[u].ruleId).src=n.getImgPath("defaultFeatureImage")),this.updateListPriceAttribute(e);break}this.updateTotalPrice()}else n.RetrieveElement("LineFeature_"+e).style.display="none"},updateListPriceAttribute:function(e){for(var i=new t,l=i.getDictionary().features,r=0;r<l.length;r++)if(l[r].ruleId==e){for(var o=0,a=0;a<l[r].options.length;a++){"0.0"!=l[r].options[a].listPrice&&i.setPriceById(l[r].options[a].ruleId,l[r].options[a].listPrice);var s=i.getStateWithId(l[r].options[a].ruleId);if("chosen"==s||"chosenInConflict"==s||"defaultInConflict"==s||"default"==s||"required"==s||"recommanded"==s)(d=l[r].options[a].listPrice)&&"NaN"!=(d=parseFloat(d))&&(o+=d)}if(!n.onWinEnv()&&l[r].keyInType&&"Blank"!=l[r].keyInType){var d,c=i.getStateWithId("KeyIn_"+e);if("chosen"==c||"chosenInConflict"==c)(d=l[r].listPrice)&&"NaN"!=(d=parseFloat(d))&&(o+=d)}if(n.RetrieveElement("LineFeature_"+e)&&n.RetrieveElement("LineFeature_"+e).cells.namedItem("featureAttrId_List Price")){var u="-";o>0&&(u=parseFloat(o).toFixed(1));n.RetrieveElement("LineFeature_"+e).cells.namedItem("featureAttrId_List Price").firstChild.innerHTML=u}i.setPriceById(e,o)}},updateTotalPrice:function(){for(var e=new t,i=e.getDictionary().features,l=e.getDictionary().basePrice,r=l=l&&"NaN"!=parseFloat(l)?parseFloat(l):0,o=0;o<i.length;o++){var a=e.getPriceById(i[o].ruleId);a&&"NaN"!=(a=parseFloat(a))&&(r+=a)}if(n.RetrieveElement("totalPriceValue")){var s=parseFloat(r).toFixed(1);e.setTotalPrice(s),n.RetrieveElement("totalPriceValue").textContent=s}},updateConflictingFeatures:function(){for(var i=new t,l=i.getConfigurationCriteria(),r=0,o=0;o<l.length;o++)"chosenInConflict"!=l[o].State&&"dismissedInConflict"!=l[o].State&&"defaultInConflict"!=l[o].State||!i.isAFeature(l[o].Id)||r++;n.RetrieveElement("nbConflictOnFooter").innerHTML=r,n.RetrieveElement("DivConflictOnFooter").title=r+" "+e.i18n("features have conflicting selections"),r>0?(n.RetrieveElement("iconConflictOnFooter").style.opacity=1,n.RetrieveElement("nbConflictOnFooter").style.opacity=1):(n.RetrieveElement("iconConflictOnFooter").style.opacity=0,n.RetrieveElement("nbConflictOnFooter").style.opacity=0)},updateMustSelectFeatureNumber:function(){for(var i=new t,l=i.getConfigurationCriteria(),r=0,o=0;o<l.length;o++)"mustSelectFeature"==l[o].State&&r++;i.setMustSelectFeatureNumber(r),n.RetrieveElement("nbMustSelectFeature").innerHTML=r,n.RetrieveElement("MustSelectFeatureDiv").title=r+" "+e.i18n("features are mandatory and not selected"),this.updateCompletenessIcon()},updateCompletenessIcon:function(){var e,i=new t,l=i.getMustSelectFeatureNumber(),r=i.getDictionary().features,o=!1,a=new Object;this.AddIncludedStateOnRefineMode();for(var s=0;s<r.length;s++){a[r[s].name]=0;for(var d=0;d<r[s].options.length;d++)"chosen"!=(e=i.getStateWithId(r[s].options[d].ruleId))&&"chosenInConflict"!=e&&"included"!=e&&"default"!=e&&"defaultInConflict"!=e||"Single"!=r[s].selectionType||(a[r[s].name]=a[r[s].name]+1);if(!n.onWinEnv()&&r[s].keyInType&&"Blank"!=r[s].keyInType){var c=i.getStateWithId("KeyIn_"+r[s].ruleId);"chosen"!=c&&"chosenInConflict"!=c||(a[r[s].name]=a[r[s].name]+1)}}for(var u in a){if(a[u]>1){o=!0;break}}0==l?0==o?(n.RetrieveElement("productStateIcon").src=n.getImgPath("completeProduct"),n.RetrieveElement("hybridLabel").style.visibility="hidden",n.RetrieveElement("completeLabel").style.visibility="visible",n.RetrieveElement("partialLabel").style.visibility="hidden",i.setCompletenessStatus("Complete")):(n.RetrieveElement("productStateIcon").src=n.getImgPath("hybridProduct"),n.RetrieveElement("hybridLabel").style.visibility="visible",n.RetrieveElement("completeLabel").style.visibility="hidden",n.RetrieveElement("partialLabel").style.visibility="hidden",i.setCompletenessStatus("Hybrid")):1==o?(n.RetrieveElement("productStateIcon").src=n.getImgPath("hybridProduct"),n.RetrieveElement("hybridLabel").style.visibility="visible",n.RetrieveElement("completeLabel").style.visibility="hidden",n.RetrieveElement("partialLabel").style.visibility="hidden",i.setCompletenessStatus("Hybrid")):(n.RetrieveElement("productStateIcon").src=n.getImgPath("partialProduct"),n.RetrieveElement("hybridLabel").style.visibility="hidden",n.RetrieveElement("completeLabel").style.visibility="hidden",n.RetrieveElement("partialLabel").style.visibility="visible",i.setCompletenessStatus("Partial"))},updateOptionState:function(e){if("disabled"!=e.className){var i=new t,l=e.firstChild.id.split("_")[1],r=i.getStateWithId(l);if("select"!=i.getRefineSelectionModeForSpecifiedFeature(i.getFeatureIdWithOptionId(l))||"available"!=r&&"included"!=r&&null!=r||"enabled"!=e.className)if("reject"!=i.getRefineSelectionModeForSpecifiedFeature(i.getFeatureIdWithOptionId(l))||"available"!=r&&"chosen"!=r&&"included"!=r&&null!=r||"enabled"!=e.className)if("enabled"!=e.className||"chosen"!=r&&"chosenInConflict"!=r&&"dismissed"!=r&&"dismissedInConflict"!=r&&"included"!=r)if("enabled"!=e.className||"recommanded"!=r&&"default"!=r&&"defaultInConflict"!=r){if("select"==i.getRefineSelectionModeForSpecifiedFeature(i.getFeatureIdWithOptionId(l))&&"enabled"==e.className&&"dismissed"==r){e.firstChild.src=n.getImgPath("available"),n.RetrieveElement("iconOption_"+l).src=n.getImgPath("noStateIcon"),i.setStateWithId(l,"available");o=n.RetrieveElement("input"+i.getFeatureIdWithOptionId(l)).value.indexOf(n.getOptionDisplayNameWithId(l));n.RetrieveElement("input"+i.getFeatureIdWithOptionId(l)).value=n.RetrieveElement("input"+i.getFeatureIdWithOptionId(l)).value.replace(n.getOptionDisplayNameWithId(l)+"\n",""),""!=n.RetrieveElement("input"+i.getFeatureIdWithOptionId(l)).value&&-1!=o&&n.RetrieveElement("input"+i.getFeatureIdWithOptionId(l)).rows--}}else{e.firstChild.src=n.getImgPath("dismissed"),n.RetrieveElement("iconOption_"+l).src=n.getImgPath("chosen"),i.setStateWithId(l,"dismissed");var o=n.RetrieveElement("input"+i.getFeatureIdWithOptionId(l)).value.indexOf(n.getOptionDisplayNameWithId(l));n.RetrieveElement("input"+i.getFeatureIdWithOptionId(l)).value=n.RetrieveElement("input"+i.getFeatureIdWithOptionId(l)).value.replace(n.getOptionDisplayNameWithId(l)+"\n",""),""!=n.RetrieveElement("input"+i.getFeatureIdWithOptionId(l)).value&&-1!=o&&n.RetrieveElement("input"+i.getFeatureIdWithOptionId(l)).rows--}else{e.firstChild.src=n.getImgPath("available"),n.RetrieveElement("iconOption_"+l).src=n.getImgPath("noStateIcon"),i.setStateWithId(l,"available");var o=n.RetrieveElement("input"+i.getFeatureIdWithOptionId(l)).value.indexOf(n.getOptionDisplayNameWithId(l));n.RetrieveElement("input"+i.getFeatureIdWithOptionId(l)).value=n.RetrieveElement("input"+i.getFeatureIdWithOptionId(l)).value.replace(n.getOptionDisplayNameWithId(l)+"\n",""),""!=n.RetrieveElement("input"+i.getFeatureIdWithOptionId(l)).value&&-1!=o&&n.RetrieveElement("input"+i.getFeatureIdWithOptionId(l)).rows--}else{if(!n.CheckIfDismissedIsPossible(l))return;e.firstChild.src=n.getImgPath("dismissed"),n.RetrieveElement("iconOption_"+l).src=n.getImgPath("chosen"),i.setStateWithId(l,"dismissed"),"chosen"!=r&&(""!=n.RetrieveElement("input"+i.getFeatureIdWithOptionId(l)).value&&n.RetrieveElement("input"+i.getFeatureIdWithOptionId(l)).rows++,n.RetrieveElement("input"+i.getFeatureIdWithOptionId(l)).value+="Except "+n.getOptionDisplayNameWithId(l)+"\n")}else{"false"==i.getmultiSelect()&&(this.SetOptionsAvailableForSingleTypeFeature(n.getFeatureNameWithId(l)),n.RetrieveElement("input"+i.getFeatureIdWithOptionId(l)).value=""),e.firstChild.src=n.getImgPath("check"),n.RetrieveElement("iconOption_"+l).src=n.getImgPath("chosen"),i.setStateWithId(l,"chosen"),"dismissed"!=r&&(""!=n.RetrieveElement("input"+i.getFeatureIdWithOptionId(l)).value&&n.RetrieveElement("input"+i.getFeatureIdWithOptionId(l)).rows++,n.RetrieveElement("input"+i.getFeatureIdWithOptionId(l)).value+=n.htmlDecode(n.getOptionDisplayNameWithId(l))+"\n");var s=i.getFeatureIdWithOptionId(l);"false"==i.getmultiSelect()&&"Single"==i.getSelectionTypeForSpecifiedFeature(s)&&n.RetrieveElement("myfeatureOptions")&&(n.RemoveElement("myfeatureOptions"),n.onWinEnv()&&n.updateWebViewerWidthInNativeEnv(!0))}this.updateFeatureState(l),this.updateMustSelectFeatureNumber(),this.updateConflictingFeatures(),"true"==i.getRulesActivation()?(n.RetrieveElement("myfeatureOptions")&&this.updateOptionsPanel(),n.CallSolveMethodOnSolver()):(a.updateFeatures(!1),n.RetrieveElement("myfeatureOptions")&&this.updateOptionsPanel())}},OptionAttrButtonCallback:function(){var e,t=n.RetrieveElement("myfeatureOptions"),i=n.RetrieveElement("ArrowOptionAttrImg");if(n.RetrieveElement("addAttrColumnPanel")&&n.RemoveElement("addAttrColumnPanel"),"ShowAttr"==t.className){e=n.RetrieveElementByTags("td");for(var l=0;l<e.length;l++)"attr"==e[l].className&&(e[l].style.display="none"),i.src=n.getImgPath("rightArrow");n.RetrieveElement("tableOptionsAttrTitle").style.display="none",t.className="HideAttr","divFeatureOptions"==n.RetrieveElement("divFeatureOptions").id&&(n.RetrieveElement("divFeatureOptions").style.width="")}else if("HideAttr"==t.className){e=n.RetrieveElementByTags("td");for(l=0;l<e.length;l++)"attr"==e[l].className&&(e[l].style.display="inline-block"),i.src=n.getImgPath("leftArrow");n.RetrieveElement("tableOptionsAttrTitle").style.display="inline-block",t.className="ShowAttr",n.SetSizeOfAttributsCellsTable(n.RetrieveElement("tableOptionsAttr"),n.RetrieveElement("tableOptionsAttrTitle"),n.RetrieveElement("divFeatureOptions")),n.RetrieveElement("ResultSearchOptions").rows.length>0&&n.SetSizeOfAttributsCellsTable(n.RetrieveElement("ResultSearchOptions"),n.RetrieveElement("tableOptionsAttrTitle"),n.RetrieveElement("divFeatureOptions"))}n.onWinEnv()&&n.updateWebViewerWidthInNativeEnv(!0)},DeleteColumn:function(e,i){var l,r,o,a,s,d,c,u,p=e.id.split("_")[1];for("feature"==i?(l=n.RetrieveElement("tableAttrTitle"),r=n.RetrieveElement("tableAttr"),s=n.RetrieveElement("SearchFeature"),c="tableAttr",u="ResultSearchFeature",d=n.RetrieveElement("div_features_table")):"option"==i&&(l=n.RetrieveElement("tableOptionsAttrTitle"),r=n.RetrieveElement("tableOptionsAttr"),s=n.RetrieveElement("SearchOptions"),c="tableOptionsAttr",u="ResultSearchOptions",d=n.RetrieveElement("divFeatureOptions")),a=l.rows[0].cells.length,h=0;h<a;h++)if(l.rows[0].cells[h].id.split("_")[1]==p){l.rows[0].deleteCell(h);break}for(h=0;h<r.rows.length;h++)if(n.onWinEnv()||"keyInOption"!=r.rows[h].cells[0].id)for(o=1;o<=a;o++)if(r.rows[h].cells[o].id.split("_")[1]==p){r.rows[h].deleteCell(o);break}var g=new t,f=g.getApplicationState();if("feature"==i)for(h=0;h<f.featuresVisibleAttributes.length;h++)f.featuresVisibleAttributes[h]==p&&f.featuresVisibleAttributes.splice(h,1);else if("option"==i)for(h=0;h<f.optionsVisibleAttributes.length;h++)f.optionsVisibleAttributes[h]==p&&f.optionsVisibleAttributes.splice(h,1);if(g.setApplicationState(f),n.SetSizeOfAttributsCellsTable(r,l,d),this.updateSearchResult(s,c,u),n.RetrieveElement(u).rows.length>0&&n.SetSizeOfAttributsCellsTable(n.RetrieveElement(u),l,d),"feature"==i){if(null!=n.RetrieveElement("prodStatesContainer"))if(n.RetrieveElement("content").style.height=n.getPageSize().y-(n.RetrieveElement("prodStatesContainer").offsetHeight+115)+"px",n.RetrieveElement("prodStatePanel").style.width=n.RetrieveElement("content").offsetWidth+"px",n.RetrieveElement("prodStatePanel").parentNode.style.width=n.RetrieveElement("content").offsetWidth+"px",n.onWinEnv())for(var m=n.RetrieveElement("content").scrollWidth+"px",v=n.RetrieveElementByClassName("accordionHeader"),h=0;h<v.length;h++)v[h].style.width="",v[h].style.width=m;else for(v=n.RetrieveElementByClassName("accordionHeader"),h=0;h<v.length;h++)v[h].style.width="",v[h].style.width="100%";n.onWinEnv()||n.resizeWindow(!0)}if("feature"==i){var b=n.RetrieveElementByClassName("accordionHeader");if(b&&n.RetrieveElement("configPanel").offsetWidth>30)for(h=0;h<b.length;h++)n.onWinEnv()?b[h].style.width=n.RetrieveElement("configPanel").offsetWidth+"px":b[h].style.width="100%"}n.onWinEnv()&&n.updateWebViewerWidthInNativeEnv(!0)},AddColumn:function(i,l,r){if(n.RetrieveElement("addAttrColumnPanel"))n.RemoveElement("addAttrColumnPanel");else{var o,a,s,d,c,u,p=n.CreateElement("div"),g=n.CreateElement("table"),f=[],m=[];if("addAttrColumnFeatures"==i.id){for(d="featureAttr",a=0;a<l.length;a++)if(l[a].attributes)for(m=n.getJsonKeys(l[a].attributes),s=0;s<m.length;s++)n.RetrieveElement("featureAttrTitleId_"+m[s])||-1!=f.indexOf(m[s])||f.push(m[s])}else if("addAttrColumnOptions"==i.id)for(d="optionAttr",a=0;a<l.length;a++)if(l[a].attributes)for(m=n.getJsonKeys(l[a].attributes),s=0;s<m.length;s++)n.RetrieveElement("attrTitleId_"+m[s])||-1!=f.indexOf(m[s])||f.push(m[s]);p.id="addAttrColumnPanel";var v=this;if(0==f.length)(o=n.CreateElement("tr")).innerHTML=e.i18n("No more attribute to add"),o.style.fontStyle="italic",g.appendChild(o);else for(a=0;a<f.length;a++)(o=n.CreateElement("tr")).innerHTML=f[a],o.onmouseover=function(){this.style.backgroundColor="#FFFFFF"},o.onmouseout=function(){this.style.backgroundColor="#ccc"},o.onclick=function(){var e,i,r,o,a,s,p,g;"featureAttr"==d?(e=n.RetrieveElement("tableAttrTitle"),tabFixTitle=n.RetrieveElement("tableFixAttrTitle"),i=n.RetrieveElement("tableAttr"),c="titleFeatureAttr",u="featureAttrTitleId_",p="featureAttr",s="featureAttrId_",g="FeatureAttrLabel_",o=(r=e.rows[0].cells.length)+tabFixTitle.rows[0].cells.length):"optionAttr"==d&&(e=n.RetrieveElement("tableOptionsAttrTitle"),tabFixTitle=n.RetrieveElement("tableOptionsFixAttrTitle"),i=n.RetrieveElement("tableOptionsAttr"),c="title",u="attrTitleId_",p="attr",s="attrId_",g="OptionAttrLabel_",o=(r=e.rows[0].cells.length)+tabFixTitle.rows[0].cells.length),e.rows[0].insertCell(r-1),e.rows[0].cells[r-1].className=c,e.rows[0].cells[r-1].id=u+this.firstChild.wholeText,"featureAttr"==d?(e.rows[0].cells[r-1].innerHTML="<a id='"+g+this.firstChild.wholeText+"' class='unselected'>"+this.firstChild.wholeText+"</a><img id='columnFeature_"+this.firstChild.wholeText+"' style='vertical-align:top; visibility:hidden;' float:right src='./assets/icons/close.png'/>",n.addEvent("click",n.RetrieveElement("columnFeature_"+this.firstChild.wholeText),function(){v.DeleteColumn(this,"feature")})):"optionAttr"==d&&(e.rows[0].cells[r-1].innerHTML="<a id='"+g+this.firstChild.wholeText+"' class='unselected'>"+this.firstChild.wholeText+"</a><img id='column_"+this.firstChild.wholeText+"' style='vertical-align:top; visibility:hidden;' float:right src='./assets/icons/close.png'/>",n.addEvent("click",n.RetrieveElement("column_"+this.firstChild.wholeText),function(){v.DeleteColumn(this,"option"),n.RetrieveElement("addAttrColumnPanel")&&n.RemoveElement("addAttrColumnPanel")})),n.addEvent("mouseover",n.RetrieveElement(u+this.firstChild.wholeText),function(){this.childNodes[1].style.visibility="visible"}),n.addEvent("mouseout",n.RetrieveElement(u+this.firstChild.wholeText),function(){this.childNodes[1].style.visibility="hidden"}),n.addEvent("click",n.RetrieveElement(g+this.firstChild.wholeText),function(){"unselected"==this.className?this.className="selected":"selected"==this.className&&(this.className="unselected")});var f=new t,m=f.getApplicationState();"featureAttr"==d?m.featuresVisibleAttributes.push(this.firstChild.wholeText):"optionAttr"==d&&m.optionsVisibleAttributes.push(this.firstChild.wholeText),f.setApplicationState(m);var h=[];for(S=0,tbindex=0;S<l.length;S++){a=null,l[S].attributes&&(h=n.getJsonKeys(l[S].attributes));var b="";if(("featureAttr"==d||"optionAttr"==d)&&-1!=h.indexOf(this.firstChild.wholeText)){var I="";(b=l[S].attributes[h[h.indexOf(this.firstChild.wholeText)]]).length>this.firstChild.wholeText.length&&(I+="title='"+b+"' "),a="<p "+I+"style='text-align:center; overflow:hidden;text-overflow: ellipsis'>"+b+"</p>"}0==b.length&&(a="<p style='text-align:center'>-</p>"),n.onWinEnv()||"keyInOption"!=i.rows[S].cells[0].id||tbindex++,i.rows[tbindex].insertCell(o),i.rows[tbindex].cells[o].className=p,i.rows[tbindex].cells[o].id=s+this.firstChild.wholeText,i.rows[tbindex].cells[o].innerHTML=a,i.rows[tbindex].cells[o].style.display="inline-block",tbindex++}if("featureAttr"==d){if(n.SetSizeOfAttributsCellsTable(n.RetrieveElement("tableAttr"),n.RetrieveElement("tableAttrTitle"),n.RetrieveElement("div_features_table")),null!=n.RetrieveElement("prodStatesContainer")&&(n.RetrieveElement("content").style.height=n.getPageSize().y-(n.RetrieveElement("prodStatesContainer").offsetHeight+115)+"px",n.RetrieveElement("prodStatePanel").style.width=n.RetrieveElement("content").offsetWidth+"px",n.RetrieveElement("prodStatePanel").parentNode.style.width=n.RetrieveElement("content").offsetWidth+"px",n.onWinEnv()))for(var R=n.RetrieveElement("content").scrollWidth+"px",y=n.RetrieveElementByClassName("accordionHeader"),S=0;S<y.length;S++)y[S].style.width="",y[S].style.width=R;n.onWinEnv()||n.resizeWindow(!0)}else"optionAttr"==d&&n.SetSizeOfAttributsCellsTable(n.RetrieveElement("tableOptionsAttr"),n.RetrieveElement("tableOptionsAttrTitle"),n.RetrieveElement("divFeatureOptions"));if(n.RemoveElement("addAttrColumnPanel"),"featureAttr"==d){var E=n.RetrieveElementByClassName("accordionHeader");if(E&&n.RetrieveElement("configPanel").offsetWidth>30)for(S=0;S<E.length;S++)n.onWinEnv()&&(E[S].style.width=n.RetrieveElement("configPanel").offsetWidth+10+"px");n.onWinEnv()||n.resizeWindow(!1)}n.RetrieveElement("prodStatePanel")&&n.RetrieveElement("configPanel").offsetWidth>30&&(n.RetrieveElement("prodStatePanel").style.width=n.RetrieveElement("configPanel").offsetWidth+"px"),n.onWinEnv()&&n.updateWebViewerWidthInNativeEnv(!0)},g.appendChild(o);p.appendChild(g);var h=new t;e.extendElement(p).inject(h.getWidget().body),p.style.left=i.getBoundingClientRect().left-n.RetrieveElement("configPanel").getBoundingClientRect().left-g.offsetWidth+"px",p.style.top=i.getBoundingClientRect().top+i.offsetHeight+"px",n.RetrieveElement("myfeatureOptions")&&n.addEvent("mousedown",n.RetrieveElement("myfeatureOptions"),v.removeAttrListPanel)}},createFilterPanel:function(){var i,l=this;if(n.RetrieveElement("filterPanel")||(i=!0),n.RemovePanels(),i){var r=n.CreateElement("div");r.id="filterPanel";var o=new t,a=n.getImgPath("optim"),s=n.getImgPath("levelUnselected"),d=n.getImgPath("levelNoIndicator"),c=n.getImgPath("completeConfMode"),u=n.getImgPath("levelUnselected"),p=n.getImgPath("levelNoIndicator"),g=n.getImgPath("dependencies"),f=n.getImgPath("levelUnselected"),m=n.getImgPath("levelNoIndicator"),v=n.getImgPath("incompatibilities"),h=n.getImgPath("levelUnselected"),b=n.getImgPath("levelNoIndicator"),I=n.getImgPath("levelPlus"),R=n.getImgPath("levelMinus");"RulesMode_ProposeOptimizedConfiguration"==o.getRulesMode()?(s=n.getImgPath("levelSelected"),u=n.getImgPath("levelSelected"),f=n.getImgPath("levelSelected"),h=n.getImgPath("levelSelected"),d=n.getImgPath("levelIndicator")):"RulesMode_SelectCompleteConfiguration"==o.getRulesMode()?(u=n.getImgPath("levelSelected"),f=n.getImgPath("levelSelected"),h=n.getImgPath("levelSelected"),p=n.getImgPath("levelIndicator")):"RulesMode_EnforceRequiredOptions"==o.getRulesMode()?(f=n.getImgPath("levelSelected"),h=n.getImgPath("levelSelected"),m=n.getImgPath("levelIndicator")):"RulesMode_DisableIncompatibleOptions"==o.getRulesMode()&&(h=n.getImgPath("levelSelected"),b=n.getImgPath("levelIndicator"));var y="<table style='display:block;'>";if(y+="<tr><th bgcolor=gray colspan='3' style='padding-left:5px;'><font color=white> "+e.i18n("Rules assistance level")+"</font></th></tr>","yes"==o.getAppFunc().rulesMode_ProposeOptimizedConfiguration&&(y+="<tr id='optimLine' style='padding-right:5px;'><td style='padding-top:3px;'><img id='LevelPlus' style='height:32px; width:13px; padding-left:3px; vertical-align:bottom;' src="+I+" /><img id='optimLevel' style='height:32px; vertical-align:bottom;' src="+s+" /><img id='optimLevelIndicator' style='height:32px; vertical-align:bottom;' src=",y+=d+" /><img id='RulesMode_ProposeOptimizedConfiguration' style='width:32px; height:32px; padding-right:5px; vertical-align:bottom;' src="+a+" /></td><td style='vertical-align:middle; padding-right:5px;'>"+e.i18n("Propose optimized configuration on List Price")+"</td></tr>"),"yes"==o.getAppFunc().rulesMode_SelectCompleteConfiguration){var S="<img id='LevelPlus' style='height:32px; width:13px; padding-left:3px; vertical-align:bottom;' src="+I+" />",E="style = 'padding-top:3px;'";if("yes"==o.getAppFunc().rulesMode_ProposeOptimizedConfiguration)E="",S="<img id='LevelEmpty' style='height:32px; width:13px; padding-left:3px; vertical-align:bottom;' src="+n.getImgPath("levelEmpty")+" />";y+="<tr id='completeConfModeLine'><td "+E+">"+S+"<img id='completeConfModeLevel' style='height:32px; vertical-align:bottom;' src="+u+" /><img id='completeConfModeLevelIndicator' style='height:32px; vertical-align:bottom;' src=",y+=p+" /><img id='RulesMode_SelectCompleteConfiguration' style='width:32px; height:32px; padding-right:5px; vertical-align:bottom;' src="+c+" /></td><td style='vertical-align:middle; padding-right:5px;'>"+e.i18n("Select complete configuration")+"</td></tr>"}if("yes"==o.getAppFunc().rulesMode_EnforceRequiredOptions){S="<img id='LevelPlus' style='height:32px; width:13px; padding-left:3px; vertical-align:bottom;' src="+I+" />",E="style = 'padding-top:3px;'";if("yes"==o.getAppFunc().rulesMode_ProposeOptimizedConfiguration||"yes"==o.getAppFunc().rulesMode_SelectCompleteConfiguration)E="",S="<img id='LevelEmpty' style='height:32px; width:13px; padding-left:3px; vertical-align:bottom;' src="+n.getImgPath("levelEmpty")+" />";y+="<tr id='dependenciesLine'><td "+E+">"+S+"<img id='dependenciesLevel' style='height:32px; vertical-align:bottom;' src="+f+" /><img id='dependenciesLevelIndicator' style='height:32px; vertical-align:bottom;' src=",y+=m+" /><img id='RulesMode_EnforceRequiredOptions' style='width:32px; height:32px; padding-right:5px; vertical-align:bottom;' src="+g+" /></td><td style='vertical-align:middle; padding-right:5px;'>"+e.i18n("Enforce required options and select defaults")+"</td><td></tr>"}"yes"==o.getAppFunc().rulesMode_DisableIncompatibleOptions&&(y+="<tr id='incompatibilitiesLine'><td style='padding-bottom:3px;'><img id='LevelMinus' style='height:32px; width:13px; padding-left:3px; vertical-align:bottom;' src="+R+" /><img id='incompatibilitiesLevel' style='height:32px; vertical-align:bottom;' src="),y+=h+" /><img id='incompatibilitiesLevelIndicator' style='height:32px; vertical-align:bottom;' src="+b+" /><img id='RulesMode_DisableIncompatibleOptions' style='width:32px; height:32px; padding-right:5px; vertical-align:bottom;' src="+v+" /></td><td style='vertical-align:middle; padding-right:5px;'>"+e.i18n("Disable incompatible options")+"</td></tr>",y+="</table>",r.innerHTML=y,e.extendElement(r).inject(o.getWidget().body),n.RetrieveElement("selectLevelIcon").offsetLeft-n.RetrieveElement("filterPanel").offsetWidth>=0?n.RetrieveElement("filterPanel").style.left=n.RetrieveElement("selectLevelIcon").offsetLeft-n.RetrieveElement("filterPanel").offsetWidth+"px":n.RetrieveElement("filterPanel").style.left="0px",n.RetrieveElement("filterPanel").style.top=n.RetrieveElement("selectLevelIcon").offsetTop+-n.RetrieveElement("filterPanel").offsetHeight+"px",n.RetrieveElement("optimLine")&&n.addEvent("click",n.RetrieveElement("optimLine"),function(){l.changeFilterIcon("RulesMode_ProposeOptimizedConfiguration")}),n.RetrieveElement("completeConfModeLine")&&n.addEvent("click",n.RetrieveElement("completeConfModeLine"),function(){l.changeFilterIcon("RulesMode_SelectCompleteConfiguration")}),n.RetrieveElement("dependenciesLine")&&n.addEvent("click",n.RetrieveElement("dependenciesLine"),function(){l.changeFilterIcon("RulesMode_EnforceRequiredOptions")}),n.RetrieveElement("incompatibilitiesLine")&&n.addEvent("click",n.RetrieveElement("incompatibilitiesLine"),function(){l.changeFilterIcon("RulesMode_DisableIncompatibleOptions")})}},createOptionsPanel:function(i){var o,a,s,d=this,c=new t,u=c.getDictionary().features,p="Multiple",g=!0,f="",m="";for(ee=0;ee<u.length;ee++)if(i==u[ee].ruleId){o=u[ee].options,a=n.RetrieveElement("input"+i),p=u[ee].selectionType,n.onWinEnv()||(s=u[ee].keyInType,u[ee].listPrice&&(m=u[ee].listPrice));break}if(n.RetrieveElement("myfeatureOptions")&&n.RetrieveElement("myfeatureOptions").value===i&&(g=!1),n.RemovePanels(),n.RetrieveElement("InfoBox")&&"InfoBoxVisible"==n.RetrieveElement("InfoBox").value&&n.hideInfoBox(),g){var v,h,b,I,R,y=n.CreateElement("div"),S=(n.getImgPath("rightArrow"),""),E="",C="",w="",x=[];y.id="myfeatureOptions",y.className="HideAttr",y.value=i,y.style.left=a.getBoundingClientRect().left+"px",y.style.top=a.getBoundingClientRect().bottom+"px",y.style.maxWidth=n.getPageSize().x-a.getBoundingClientRect().left+"px",this.AddIncludedStateOnRefineMode();var W=c.getApplicationState(),A=[],O="";for(this.hasListPrice()||(O="style = 'display : none;'"),v=0;v<o.length;v++)for(o[v].attributes&&(x=n.getJsonKeys(o[v].attributes)),-1==A.indexOf("List Price")&&(w+="<td class='titleDefault' id='attrTitleId_List Price' "+O+" ><a id='OptionAttrLabel_List Price' class='unselected'>"+e.i18n("List Price")+"</a></td>",A.push("List Price")),ee=0;ee<W.optionsVisibleAttributes.length;ee++)-1!=x.indexOf(W.optionsVisibleAttributes[ee])&&-1==A.indexOf(W.optionsVisibleAttributes[ee])&&(E+="<td class='title' id='attrTitleId_"+W.optionsVisibleAttributes[ee]+"'><a id='OptionAttrLabel_"+W.optionsVisibleAttributes[ee]+"' class='unselected'>",E+=W.optionsVisibleAttributes[ee]+"</a><img id='column_"+W.optionsVisibleAttributes[ee]+"' style='vertical-align:top; visibility:hidden;' float:right src='"+r.getWebappsAssetUrl("ConfiguratorWebView","icons/close.png")+"'/></td>",A.push(W.optionsVisibleAttributes[ee]));var F=c.getAction();for(ee=0;ee<o.length;ee++){C="",R=o[ee].ruleId;var P="";0==c.getCacheOrderableState()[R]&&(P=" style='display: none;' "),o[ee].attributes&&(x=n.getJsonKeys(o[ee].attributes));var _,k=o[ee].listPrice,N="";for(k.length>"List Price".length&&(N+="title='"+k+"' "),0!=k.length?C+="<td class = 'defaultAttr' id='attrId_List Price' "+O+" ><p "+N+"style='text-align:center; overflow:hidden;text-overflow: ellipsis'>"+k+"</p></td>":C+="<td class = 'defaultAttr' id='attrId_List Price' "+O+" ><p style='text-align:center'>-</p></td>",h=0;h<W.optionsVisibleAttributes.length;h++)for(v=0;v<x.length;v++)if(-1!=x.indexOf(W.optionsVisibleAttributes[h])){var M=o[ee].attributes[W.optionsVisibleAttributes[h]];N="";M.length>W.optionsVisibleAttributes[h].length&&(N+="title='"+M+"' "),0!=M.length?C+="<td class='attr' id='attrId_"+W.optionsVisibleAttributes[h]+"'><p "+N+"style='text-align:center; overflow:hidden;text-overflow: ellipsis'>"+M+"</p></td>":C+="<td class='attr' id='attrId_"+W.optionsVisibleAttributes[h]+"'><p style='text-align:center'>-</p></td>";break}var T=c.getStateWithId(o[ee].ruleId),B="";"chosenInConflict"==T?(_="check","Single"===p&&"false"===c.getmultiSelect()&&(_+="_radio"),b="chosenInConflict",I="enabled",B="<img id='RedQuestionMark_"+R+"' class='RedMarkImg' style='vertical-align:top; padding-left:4px; width:12px; height:12px;' src="+n.getImgPath("redQuestionMark")+" />"):"defaultInConflict"==T?(_="check","Single"===p&&"false"===c.getmultiSelect()&&(_+="_radio"),b="defaultInConflict",I="enabled",B="<img id='RedQuestionMark_"+R+"' class='RedMarkImg' style='vertical-align:top; padding-left:4px; width:12px; height:12px;' src="+n.getImgPath("redQuestionMark")+" />"):"dismissedInConflict"==T?(_="dismissed","Single"===p&&"false"===c.getmultiSelect()&&(_+="_radio"),b="dismissedInConflict",I="enabled",B="<img id='RedQuestionMark_"+R+"' class='RedMarkImg' style='vertical-align:top; padding-left:4px; width:12px; height:12px;' src="+n.getImgPath("redQuestionMark")+" />"):"chosen"==T?(_="check","Single"===p&&"false"===c.getmultiSelect()&&(_+="_radio"),b="chosen",I="enabled"):"default"==T?(_="check","Single"===p&&"false"===c.getmultiSelect()&&(_+="_radio"),b="noStateIcon",I="enabled"):"recommanded"==T?(_="check","Single"===p&&"false"===c.getmultiSelect()&&(_+="_radio"),b="recommanded",I="enabled"):"required"==T?(_="required","Single"===p&&"false"===c.getmultiSelect()&&(_+="_radio"),b="requiredByRules",I="disabled",B="<img id='imageAskQuestionmark_"+o[ee].ruleId+"' class='BlackMarkImg' style='vertical-align:top; padding-left:4px; width:12px; height:12px;' src="+n.getImgPath("questionMark")+" />"):"included"==T?(_="included","Single"===p&&"false"===c.getmultiSelect()&&(_+="_radio"),b="noStateIcon",I="enabled"):"dismissed"==T?(_="dismissed","Single"===p&&"false"===c.getmultiSelect()&&(_+="_radio"),b="chosen",I="enabled"):"incompatible"==T?(_="incompatible","Single"===p&&"false"===c.getmultiSelect()&&(_+="_radio"),b="noStateIcon",I="disabled",B="<img  id='imageAskQuestionmark_"+o[ee].ruleId+"' class='BlackMarkImg' style='vertical-align:top; padding-left:4px; width:12px; height:12px;' src="+n.getImgPath("questionMark")+" />"):(_="available","Single"===p&&"false"===c.getmultiSelect()&&(_+="_radio"),b="noStateIcon",I="enabled"),n.onWinEnv()||"view"!=F.toLowerCase()||(I="disabled","available"==T&&(_="incompatible","Single"===p&&"false"===c.getmultiSelect()&&(_+="_radio")));var L="";"defaultInConflict"==b?(L="<img  id='imgDefaultSelection_"+o[ee].ruleId+"' style='vertical-align:top; width:18px; height:18px;' src="+n.getImgPath("defaultInConflict")+" />",b="noStateIcon"):n.isDefault(o[ee].ruleId)&&(L="<img  id='imgDefaultSelection_"+o[ee].ruleId+"' style='vertical-align:top; width:18px; height:18px;' src="+n.getImgPath("default")+" />");var D="",V=n.htmlEncode(o[ee].displayName);V.length>40&&(D+="title='"+V+"' ",V=V.substr(0,40),V+="..."),S+="<tr "+P+" ><td id='option'><div style='padding-top:3px; width:18px; height:17px; display:inline-block; vertical-align:top;'><img id='iconOption_"+R+"' style='height:18px; width:18px;' src='"+n.getImgPath(b)+"'/></div>",S+="<div style='padding-top:3px; height:17px; display:inline-block; vertical-align:top;' class='"+I+"'><img id='checkboxOption_"+R+"' style='padding-right:4px; height:17px; width:17px; vertical-align: bottom;' src='",S+=n.getImgPath(_)+"'/><div style='display:inline-block' "+D+">"+V+L+B+"</div></div></td>"+C+"</tr>"}if(!n.onWinEnv()&&s&&"Blank"!=s){var U=c.getKeyInValueById("KeyIn_"+i),q=null;if("Date"==s){if(!(q=c.getDateKeyInDisplayValueById("KeyIn_"+i))){var H=new Date(parseInt(U));if(!isNaN(Date.parse(H.toString()))){q=H.toLocaleDateString(navigator.language,{year:"numeric",month:"short",day:"numeric"}),c.setDateKeyInDisplayValueById("KeyIn_"+i,q)}}U=q}var K=c.getStateWithId("KeyIn_"+i),j="noStateIcon",Q="available";"Single"===p&&"false"===c.getmultiSelect()&&(Q+="_radio");var z="",J="enabled";c.getListOfListOfConflictingIds();U||(U="");var X=this.createKeyInField(i,s,U),G="";G+="<td class = 'defaultAttr' id='attrId_List Price' "+O+" ><p title='"+m+"' style='text-align:center; overflow:hidden;'>"+m+"</p></td>","chosen"==K?(j="keyIn",Q="check","Single"===p&&"false"===c.getmultiSelect()&&(Q+="_radio")):"incompatible"==K?(Q="incompatible","Single"===p&&"false"===c.getmultiSelect()&&(Q+="_radio"),j="noStateIcon",J="disabled",z="<img  id='imageAskQuestionmark_KeyIn_"+i+"' class='BlackMarkImg' style='vertical-align:top; padding-left:4px; width:12px; height:12px;' src="+n.getImgPath("questionMark")+" />"):"chosenInConflict"==K&&(Q="check","Single"===p&&"false"===c.getmultiSelect()&&(Q+="_radio"),j="chosenInConflict",z="<img id='RedQuestionMark_KeyIn_"+i+"' class='RedMarkImg' style='vertical-align:top; padding-left:4px; width:12px; height:12px;' src="+n.getImgPath("redQuestionMark")+" />"),n.onWinEnv()||"view"!=F.toLowerCase()||(J="disabled"),f+="<tr><td id='keyInOption'><div style='padding-top:3px; width:18px; height:20px; display:inline-block; vertical-align:top;'><img id='iconOption_"+i+"' style='height:18px; width:18px;' src='"+n.getImgPath(j)+"'/></div><div style='padding-top:3px;  display:inline-block; vertical-align:top;' class='"+J+"'><img id='checkboxOption_"+i+"' style='padding-right:4px; height:17px; width:17px; vertical-align: middle;' src='"+n.getImgPath(Q)+"'/>"+X+z+"</div></td>"+G+"</tr>"}for(y.innerHTML="<table><tr><td><div style='display:inline-block;'><div><input id='SearchOptions' class='EmptyInput' type='text' placeholder='"+e.i18n("Search for a Configuration Option")+"'/><table id='tableOptionsFixAttrTitle' style='vertical-align: middle; display: inline-block; height:20px'><tr>"+w+"</tr></table><table id='tableOptionsAttrTitle'><tr>"+E+"<td class='title' id='attrTitleId_AddAttr'><img id='addAttrColumnOptions' style='vertical-align:top; ' float:right src='"+r.getWebappsAssetUrl("ConfiguratorWebView","icons/AddColumn.png")+"'/></td></tr></table></div><div id='divFeatureOptions'><table id='tableOptionsAttr' style='margin-bottom:5px;'>"+f+S+"</table><table id='ResultSearchOptions'></table></div></div></td><td style='vertical-align: middle;'><button id='optionAttrButton'><img id='ArrowOptionAttrImg' src='"+r.getWebappsAssetUrl("ConfiguratorWebView","icons/RightArrow.png")+"'/></button></td></tr></table>","selectionMode_Refine"==c.getConfigurationMode()&&(y.innerHTML+="<div id='checkRejectDiv'><img id='checkIcon'/><img id='rejectIcon'/></div>"),e.extendElement(y).inject(c.getWidget().body),n.addEvent("click",n.RetrieveElement("SearchOptions"),function(e){var t=e.pageX-this.getBoundingClientRect().left,i=this.offsetWidth-34,n=this.offsetWidth-18;"NonEmptyInput"==this.className&&t>i&&t<n&&(this.value="",d.updateSearchResult(this,"tableOptionsAttr","ResultSearchOptions"))}),"selectionMode_Refine"==c.getConfigurationMode()&&this.updateCheckRejectIcon(),n.RetrieveElement("divFeatureOptions").offsetHeight>100&&(n.RetrieveElement("divFeatureOptions").style.height="100px"),n.addEvent("click",n.RetrieveElement("optionAttrButton"),d.OptionAttrButtonCallback),ee=0;ee<o.length;ee++)R=o[ee].ruleId,n.RetrieveElement("tableOptionsAttr").rows[ee].cells[0].style.width=n.RetrieveElement("SearchOptions").offsetWidth+"px",n.addEvent("click",n.RetrieveElement("checkboxOption_"+R).parentNode,function(e){d.updateOptionState(this)}),n.RetrieveElement("imageAskQuestionmark_"+R)&&n.addEvent("click",n.RetrieveElement("imageAskQuestionmark_"+R),function(){n.askQuestionMarkReasonToSolver(this,this.id.split("_")[1])});if(!n.onWinEnv()&&s&&"Blank"!=s){var Y=!1;if("incompatible"==(K=c.getStateWithId("KeyIn_"+i))&&(Y=!0),n.onWinEnv()||"view"!=F.toLowerCase()){if(this.typingTimer=0,n.addEvent("keyup",n.RetrieveElement("keyInput_"+i),function(e){clearTimeout(d.typingTimer);var t=this;d.typingTimer=setTimeout(function(){d.updateKeyInOptionState(t)},1e3)}),n.addEvent("click",n.RetrieveElement("checkboxOption_"+i),function(e){d.keyInCheckBoxCallBack(this)}),"Date"==s){n.RetrieveElement("keyInput_"+i).readOnly=!0;var Z=n.RetrieveElement("keyInOption"),$="";n.addEvent("click",n.RetrieveElement("keyInput_"+i),function(e){if("datepicker"!==Z.lastChild.className){var t=this;($=(new l).addEvent("onSelect",function(e,i){var n=this.toString(),l=this.getDate(),r={year:"numeric",month:"short",day:"numeric"},o=new Date(l);n=o.toLocaleDateString(navigator.language,r);o.toLocaleDateString("en-US",r);t.value=Date.parse(l),t.displayValue=n,d.updateKeyInOptionState(t),this.hide()})).inject(Z),$.elements.container.style.display="initial",$.elements.container.style.position="fixed",$.elements.container.getBoundingClientRect().bottom>n.RetrieveElement("topPanel").offsetHeight&&($.elements.container.style.top=Z.getBoundingClientRect().top-$.elements.container.offsetHeight+"px")}else console.log($.elements.container.destroy())})}}else Y=!0;n.RetrieveElement("keyInput_"+i).disabled=Y,n.RetrieveElement("imageAskQuestionmark_KeyIn_"+i)&&n.addEvent("click",n.RetrieveElement("imageAskQuestionmark_KeyIn_"+i),function(){n.askQuestionMarkReasonToSolver(this,"KeyIn_"+i)})}for(a.getBoundingClientRect().bottom+y.offsetHeight>n.RetrieveElement("topPanel").offsetHeight&&(y.style.top=a.getBoundingClientRect().top-y.offsetHeight-6+"px"),ee=0;ee<W.optionsVisibleAttributes.length;ee++)n.RetrieveElement("attrTitleId_"+W.optionsVisibleAttributes[ee])&&(n.addEvent("mouseover",n.RetrieveElement("attrTitleId_"+W.optionsVisibleAttributes[ee]),function(){this.childNodes[1].style.visibility="visible"}),n.addEvent("mouseout",n.RetrieveElement("attrTitleId_"+W.optionsVisibleAttributes[ee]),function(){this.childNodes[1].style.visibility="hidden"}),n.addEvent("click",n.RetrieveElement("OptionAttrLabel_"+W.optionsVisibleAttributes[ee]),function(){"unselected"==this.className?this.className="selected":"selected"==this.className&&(this.className="unselected")}),n.addEvent("click",n.RetrieveElement("column_"+W.optionsVisibleAttributes[ee]),function(){d.DeleteColumn(this,"option"),n.RetrieveElement("addAttrColumnPanel")&&n.RemoveElement("addAttrColumnPanel")}));n.RetrieveElement("attrTitleId_List Price")&&n.addEvent("click",n.RetrieveElement("OptionAttrLabel_List Price"),function(){"unselected"==this.className?this.className="selected":"selected"==this.className&&(this.className="unselected")}),n.addEvent("click",n.RetrieveElement("addAttrColumnOptions"),function(){d.AddColumn(n.RetrieveElement("addAttrColumnOptions"),o,i)}),n.addEvent("keyup",n.RetrieveElement("SearchOptions"),function(){d.updateSearchResult(this,"tableOptionsAttr","ResultSearchOptions")}),n.RetrieveElement("checkIcon")&&n.addEvent("click",n.RetrieveElement("checkIcon"),function(){d.updateCheckReject(n.RetrieveElement("checkIcon"))}),n.RetrieveElement("rejectIcon")&&n.addEvent("click",n.RetrieveElement("rejectIcon"),function(){d.updateCheckReject(n.RetrieveElement("rejectIcon"))});for(var ee=0;ee<n.RetrieveElementByClassName("RedMarkImg").length;ee++)n.addEvent("click",n.RetrieveElementByClassName("RedMarkImg")[ee],d.CreateConflictTooltip);n.onWinEnv()||n.enableScrollInOptionPanel()}n.onWinEnv()&&n.updateWebViewerWidthInNativeEnv(!0)},hasListPrice:function(){var e=new t,n=e.getDictionary().features,l=e.getDictionary().basePrice;if(l&&0!=parseFloat(l))return!0;for(i=0;i<n.length;i++){if(featureOptionsList=n[i].options,(r=n[i].listPrice)&&""!=r&&0!=parseFloat(r))return!0;for(j=0;j<featureOptionsList.length;j++){var r;if((r=featureOptionsList[j].listPrice)&&""!=r&&0!=parseFloat(r))return!0}}return!1},updateKeyInOptionState:function(e){var l=this.validateKeyInValue(e),r=e.id.split("_")[1],o=n.RetrieveElement("checkboxOption_"+r),a=n.RetrieveElement("iconOption_"+r),s=new t,d=s.getDictionary().features,c="Multiple";for(i=0;i<d.length;i++)if(r===d[i].ruleId){c=d[i].selectionType;break}var u=!1;"Single"===c&&"false"===s.getmultiSelect()&&(u=!0);var p=e.value,g=e.displayValue;if(p){var f="check";u&&(f+="_radio"),a.src=n.getImgPath("keyIn"),o.src=n.getImgPath(f),n.RetrieveElement("keyInput_"+r).value=g||p}else{f="available";u&&(f+="_radio"),a.src=n.getImgPath("noStateIcon"),o.src=n.getImgPath(f);var m=s.getStateWithId("KeyIn_"+r);if(!l&&u&&"chosen"!=m&&"chosenInConflict"!=m)return;n.RetrieveElement("imageFeature"+r).src=n.getImgPath("defaultFeatureImage")}"false"==s.getmultiSelect()&&(this.SetOptionsAvailableForSingleTypeFeature(n.getFeatureNameWithId(r)),n.RetrieveElement("input"+r).value=""),s.setKeyInValueById("KeyIn_"+r,p),g&&s.setDateKeyInDisplayValueById("KeyIn_"+r,g),this.updateFeatureState(r),this.updateMustSelectFeatureNumber(),this.updateConflictingFeatures(),"true"==s.getRulesActivation()?(n.RetrieveElement("myfeatureOptions")&&this.updateOptionsPanel(),n.CallSolveMethodOnSolver()):n.RetrieveElement("myfeatureOptions")&&this.updateOptionsPanel()},keyInCheckBoxCallBack:function(e){if("disabled"!=e.parentNode.className){var i=new t,l=e.id.split("_")[1],r=i.getStateWithId("KeyIn_"+l),o=n.RetrieveElement("keyInput_"+l);"chosen"==r||"chosenInConflict"==r?(o.value="",this.updateKeyInOptionState(o)):o.value&&this.updateKeyInOptionState(o)}},createKeyInField:function(e,t,i){var l="background-color: rgba(255, 255, 255, 0.8); border: 1px solid grey; padding-left: 10px; background-image: url("+n.getImgPath(t)+"); background-position: 98% 1px; background-repeat: no-repeat; padding-right: 20px;min-height: 20px; ";return"Text Area"==t?"<textarea id='keyInput_"+e+"'  rows='3' style='"+l+"' >"+i+"</textarea>":"<input type='text' id='keyInput_"+e+"' style='"+l+"' value='"+i+"' />"},validateKeyInValue:function(e){var t,i=e.id.split("_")[1],n=this.getFeatureById(i).keyInType;return"Integer"==n?t=this.inputNumberCheck(e.value,0,1):"Real"==n?t=this.inputNumberCheck(e.value,2,1):"Input"==n||"Text Area"==n?t=this.checkForBadChars(e.value,!1):"Date"==n&&(t=this.inputDateCheck(e.value,"M dd, yy")),!t||(t.isValid||(e.value=t.value),""!=t.message&&alert(t.message),t.isValid)},inputNumberCheck:function(t,i,n){var l,r=!1,o=0,a=new Object;if(a.isValid=!0,a.value=t,a.message="",""==t)return a;if(isNaN(t))return a.message=e.i18n("Invalid character."),a.isValid=!1,a.value="",a;if("-"==t.charAt(o))return a.message=e.i18n("Negative numbers not allowed."),a.isValid=!1,a.value="",a;for(;o<t.length;o++)"."==t.charAt(o)&&(r||(r=!0));return r&&0==i&&(a.isValid=!1),0==(l=t).length&&0==i?a.message=e.i18n("Please Enter an Integer Value."):0==l.length&&2==i&&(a.message=e.i18n("Please Enter a Decimal Value.")),""==l?(a.value="",a):(a.value=parseFloat(l).toFixed(i),a)},inputDateCheck:function(e,t){var i=new Object;i.isValid=!0,i.message="";try{var n=new Date(parseInt(e)),l=Date.parse(n.toString());isNaN(l)&&(i.isValid=!1)}catch(e){i.isValid=!1}return i},getFeatureById:function(e){var n=(new t).getDictionary().features;for(i=0;i<n.length;i++)if(e==n[i].ruleId)return n[i]},checkForBadChars:function(t,i){var n=!1,l=new Array("#","+","|"),r=new Object;r.isValid=!0,r.value=t,r.message="";for(var o="",a=0;a<l.length;a++)t.indexOf(l[a])>-1&&(o+=l[a]+" ");return o.length>0&&(n=!0),n?(r.message=e.i18n("One or more special characters are not allowed."),r.isValid=!1,r.value="",r):r},updateOptionsPanel:function(){var e,i,l,r,o=n.RetrieveElement("myfeatureOptions"),a=o.value,s=n.RetrieveElement("input"+a),d=new t,c=d.getDictionary().features,u="Multiple";if("incompatibleFeature"===d.getStateWithId(a))return n.RemoveElement("myfeatureOptions"),void(n.onWinEnv()&&n.updateWebViewerWidthInNativeEnv(!0));for(f=0;f<c.length;f++)if(a===c[f].ruleId){u=c[f].selectionType;break}o.style.left=s.getBoundingClientRect().left+"px",s.getBoundingClientRect().bottom+o.offsetHeight<=n.RetrieveElement("topPanel").offsetHeight&&(o.style.top=s.getBoundingClientRect().bottom+"px"),this.AddIncludedStateOnRefineMode();for(var p=n.GetOptionsListForSpecifiedFeature(a),g=d.getAction(),f=0;f<p.length;f++){l="","chosenInConflict"==(e=d.getStateWithId(p[f]))?(r="check","Single"===u&&"false"===d.getmultiSelect()&&(r+="_radio"),state="chosenInConflict",i="enabled",l="<img id='RedQuestionMark_"+p[f]+"' class='RedMarkImg' style='vertical-align:top; padding-left:4px; width:12px; height:12px;' src="+n.getImgPath("redQuestionMark")+" />"):"dismissedInConflict"==e?(r="dismissed","Single"===u&&"false"===d.getmultiSelect()&&(r+="_radio"),state="dismissedInConflict",i="enabled",l="<img id='RedQuestionMark_"+p[f]+"' class='RedMarkImg' style='vertical-align:top; padding-left:4px; width:12px; height:12px;' src="+n.getImgPath("redQuestionMark")+" />"):"chosen"==e?(r="check","Single"===u&&"false"===d.getmultiSelect()&&(r+="_radio"),state="chosen",i="enabled"):"default"==e?(r="check","Single"===u&&"false"===d.getmultiSelect()&&(r+="_radio"),state="noStateIcon",i="enabled"):"recommanded"==e?(r="check","Single"===u&&"false"===d.getmultiSelect()&&(r+="_radio"),state="recommanded",i="enabled"):"required"==e?(r="required","Single"===u&&"false"===d.getmultiSelect()&&(r+="_radio"),state="requiredByRules",i="disabled",l="<img id='imageAskQuestionmark_"+p[f]+"' class='BlackMarkImg' style='vertical-align:top; padding-left:4px; width:12px; height:12px;' src="+n.getImgPath("questionMark")+" />"):"included"==e?(r="included","Single"===u&&"false"===d.getmultiSelect()&&(r+="_radio"),state="noStateIcon",i="enabled"):"dismissed"==e?(r="dismissed","Single"===u&&"false"===d.getmultiSelect()&&(r+="_radio"),state="chosen",i="enabled"):"incompatible"==e?(r="incompatible","Single"===u&&"false"===d.getmultiSelect()&&(r+="_radio"),state="noStateIcon",i="disabled",l="<img  id='imageAskQuestionmark_"+p[f]+"' class='BlackMarkImg' style='vertical-align:top; padding-left:4px; width:12px; height:12px;' src="+n.getImgPath("questionMark")+" />"):(r="available","Single"===u&&"false"===d.getmultiSelect()&&(r+="_radio"),state="noStateIcon",i="enabled"),n.onWinEnv()||"view"!=g.toLowerCase()||(i="disabled","available"==e&&(r="incompatible","Single"===u&&"false"===d.getmultiSelect()&&(r+="_radio"))),n.RemoveElement("imgDefaultSelection_"+p[f]);var m="";"defaultInConflict"==state?(m="<img  id='imgDefaultSelection_"+p[f]+"' style='vertical-align:top; width:18px; height:18px;' src="+n.getImgPath("defaultInConflict")+" />",state="noStateIcon"):n.isDefault(p[f])&&(m="<img  id='imgDefaultSelection_"+p[f]+"' style='vertical-align:top; width:18px; height:18px;' src="+n.getImgPath("default")+" />"),n.RetrieveElement("iconOption_"+p[f]).src=n.getImgPath(state),n.RetrieveElement("checkboxOption_"+p[f]).src=n.getImgPath(r),"BlackMarkImg"!=(w=n.RetrieveElement("checkboxOption_"+p[f]).parentNode.lastChild.lastChild).className&&"RedMarkImg"!=w.className||n.RemoveElement(w.id),""!=m&&(n.RetrieveElement("checkboxOption_"+p[f]).parentNode.lastChild.innerHTML+=m),""!=l&&(n.RetrieveElement("checkboxOption_"+p[f]).parentNode.lastChild.innerHTML+=l);for(var v=0;v<n.RetrieveElementByClassName("RedMarkImg").length;v++)n.addEvent("click",n.RetrieveElementByClassName("RedMarkImg")[v],this.CreateConflictTooltip);n.RetrieveElement("imageAskQuestionmark_"+p[f])&&n.addEvent("click",n.RetrieveElement("imageAskQuestionmark_"+p[f]),function(){n.askQuestionMarkReasonToSolver(this,this.id.split("_")[1])}),n.RetrieveElement("checkboxOption_"+p[f]).parentNode.className=i,n.onWinEnv()||"view"!=g.toLowerCase()||(i="disabled","available"==myOptionState&&(r="incompatible","Single"===u&&"false"===d.getmultiSelect()&&(r+="_radio")))}var h;c=d.getDictionary().features;for(f=0;f<c.length;f++)if(a==c[f].ruleId){h=c[f];break}if(!n.onWinEnv()&&h&&h.keyInType&&"Blank"!=h.keyInType){var b,I=d.getKeyInValueById("KeyIn_"+a),R=n.RetrieveElement("iconOption_"+a),y=d.getStateWithId("KeyIn_"+a),S="noStateIcon",E="available";"Single"===u&&"false"===d.getmultiSelect()&&(E+="_radio");var C=!1;d.getListOfListOfConflictingIds();I||(I=""),"chosen"==y?(S="keyIn",E="check","Single"===u&&"false"===d.getmultiSelect()&&(E+="_radio")):"incompatible"==y?(E="incompatible","Single"===u&&"false"===d.getmultiSelect()&&(E+="_radio"),S="noStateIcon",(b=n.CreateElement("img")).id="imageAskQuestionmark_KeyIn_"+a,b.className="BlackMarkImg",b.style="vertical-align:top; padding-left:4px; width:12px; height:12px;",b.src=n.getImgPath("questionMark"),C=!0):"chosenInConflict"==y&&(E="check","Single"===u&&"false"===d.getmultiSelect()&&(E+="_radio"),S="chosenInConflict",(b=n.CreateElement("img")).id="RedQuestionMark_KeyIn_"+a,b.className="RedMarkImg",b.style="vertical-align:top; padding-left:4px; width:12px; height:12px;",b.src=n.getImgPath("redQuestionMark")),R.src=n.getImgPath(S);var w,x=n.RetrieveElement("checkboxOption_"+a);x.src=n.getImgPath(E),n.RetrieveElement("keyInput_"+a).disabled=C,n.RetrieveElement("checkboxOption_"+a).parentNode.className=C?"disabled":"enabled","BlackMarkImg"!=(w=x.parentNode.lastChild).className&&"RedMarkImg"!=w.className||n.RemoveElement(w.id),b&&n.RetrieveElement("checkboxOption_"+a).parentNode.lastChild.appendChild(b),n.RetrieveElement("imageAskQuestionmark_KeyIn_"+a)&&n.addEvent("click",n.RetrieveElement("imageAskQuestionmark_KeyIn_"+a),function(){n.askQuestionMarkReasonToSolver(this,"KeyIn_"+a)}),n.RetrieveElement("RedQuestionMark_KeyIn_"+a)&&n.addEvent("click",n.RetrieveElement("RedQuestionMark_KeyIn_"+a),this.CreateConflictTooltip),""==I&&(n.RetrieveElement("keyInput_"+a).value=I)}this.updateSearchResult(n.RetrieveElement("SearchOptions"),"tableOptionsAttr","ResultSearchOptions")},setFeatures:function(){var i,l,o,a=new t,s=a.getDictionary().features,d=n.RetrieveElement("content"),c="",u="",p="",g="",f=a.getApplicationState(),m="",v=[];if("no"!=a.getAppFunc().features){var h="";if(this.hasListPrice()||(h="style = 'display : none;'"),s.length>0){var b=[];for(i=0;i<s.length;i++)for(s[i].attributes&&(v=n.getJsonKeys(s[i].attributes)),-1==b.indexOf("List Price")&&(g+="<td class='titleFeatureDefaultAttr' id='featureAttrTitleId_List Price' "+h+" ><a id='FeatureAttrLabel_List Price' class='unselected'>"+e.i18n("List Price")+"</a></td>",b.push("List Price")),F=0;F<f.featuresVisibleAttributes.length;F++)-1!=v.indexOf(f.featuresVisibleAttributes[F])&&-1==b.indexOf(f.featuresVisibleAttributes[F])&&(u+="<td class='titleFeatureAttr' id='featureAttrTitleId_"+f.featuresVisibleAttributes[F]+"'><a id='FeatureAttrLabel_"+f.featuresVisibleAttributes[F]+"' class='unselected'>"+f.featuresVisibleAttributes[F]+"</a><img id='columnFeature_",u+=f.featuresVisibleAttributes[F]+"' style='vertical-align:top; visibility:hidden;' float:right src='"+r.getWebappsAssetUrl("ConfiguratorWebView","icons/close.png")+"'/></td>",b.push(f.featuresVisibleAttributes[F]))}for(F=0;F<s.length;F++){p="",s[F].attributes&&(v=n.getJsonKeys(s[F].attributes));var I=s[F].listPrice,R="";I.length>"List Price".length&&(R+="title='"+I+"' "),0!=I.length?p+="<td class='featureDefaultAttr' id='featureAttrId_List Price' "+h+" ><p "+R+"style='text-align:center; overflow:hidden;text-overflow: ellipsis'>"+I+"</p></td>":p+="<td class='featureDefaultAttr' id='featureAttrId_List Price' "+h+" ><p style='text-align:center'>-</p></td>";var y="";for(n.onWinEnv()||(y="style='display: inline-block'"),l=0;l<f.featuresVisibleAttributes.length;l++)for(i=0;i<v.length;i++)if(-1!=v.indexOf(f.featuresVisibleAttributes[l])){var S=s[F].attributes[f.featuresVisibleAttributes[l]];R="";S.length>f.featuresVisibleAttributes[l].length&&(R+="title='"+S+"' "),0!=S.length?p+="<td class='featureAttr' id='featureAttrId_"+f.featuresVisibleAttributes[l]+"' "+y+"><p "+R+"style='text-align:center; overflow:hidden;text-overflow: ellipsis'>"+S+"</p></td>":p+="<td class='featureAttr' id='featureAttrId_"+f.featuresVisibleAttributes[l]+"' "+y+"><p style='text-align:center'>-</p></td>";break}s[F].selectionCriteria&&"MUST"==s[F].selectionCriteria.toUpperCase()||"requiredFeature"==a.getStateWithId(s[F].ruleId)?o="mustSelectFeature":s[F].selectionCriteria&&"MAY"==s[F].selectionCriteria.toUpperCase()&&(o="maySelectFeature"),"selectionMode_Refine"==a.getConfigurationMode()?("true"==a.getRulesActivation()?m=e.i18n("All compatibles"):"false"==a.getRulesActivation()&&(m=e.i18n("All")),this.AddIncludedStateOnRefineMode()):"selectionMode_Build"==a.getConfigurationMode()&&(m=e.i18n("None")),c+="<tr class='elementInList' id='LineFeature_"+s[F].ruleId+"'><td id='feature'><table><tr><td><img id='iconFeature"+s[F].ruleId+"' name='"+F+"' src="+n.getImgPath(o)+" style='height: 30px; width: 30px; vertical-align:middle;'></td><td><div id='divImageFeature"+s[F].ruleId+"' style='height:60px; width:60px; border:2px solid transparent; border-radius:6px; overflow:hidden;'><img id='imageFeature"+s[F].ruleId+"' style='height: 60px; width: 60px; vertical-align:middle; background-color:#ffffff;'></div></td><td style='vertical-align: top;'><li style='padding-left:15px;'>"+n.htmlEncode(s[F].displayName)+"</li><li><textarea cols='40' rows='1' id='input"+s[F].ruleId+"' placeholder='"+m+"' readonly='true' class='featureInput' name='"+F+"' onfocus='blur();' style='background-color:rgba(255,255,255,0.8); border:1px solid grey; padding-left:15px;'></textarea></li></td></tr></table>"+p+"</tr>"}this.updateCompletenessIcon();var E=a.getDictionary().basePrice;E=E&&"NaN"!=parseFloat(E)?parseFloat(E).toFixed(1):"0";var C="";this.hasListPrice()&&(C="<tr><td><div id='priceInfoPanel'><span id='basePriceLabel' class='priceLabel'>"+e.i18n("Base Price")+": </span> <span id='basePriceValue' class='priceValue'>"+E+" </span><div id ='totalPricePanel' ><span id='totalPriceLabel' class='priceLabel'>"+e.i18n("Total Price")+": </span><span id='totalPriceValue' class='priceValue'>"+E+"</span></div></div></td></tr>");var w="",x="style='height:100%; width:20px;'";n.onWinEnv()||(w="style='display:inline-block'",x="style='display: none'"),d.innerHTML="<table style='width:100%; height:100%;'><tr><td style='height:100%; width:95%;'><div style='display:inline-block; height:100%; overflow: auto; width:100%'><table><tr><td><input id='SearchFeature' class='EmptyInput' type='text' placeholder='"+e.i18n("Search for a Configuration Feature")+"'/></td><td><table id='tableFixAttrTitle' style='vertical-align: middle; display: inline-block; height:20px;' ><tr>"+g+"</table><table id='tableAttrTitle' "+w+"><tr>"+u+"<td class='titleFeatureAttr' id='featureAttrTitleId_AddAttr'><img id='addAttrColumnFeatures' style='vertical-align:top;' float:right src='"+r.getWebappsAssetUrl("ConfiguratorWebView","icons/AddColumn.png")+"'/></td></tr></table></td></tr></table><div id='div_features_table'><table id='tableAttr'>"+c+"</table><table id='ResultSearchFeature'></table></div></div></td><td "+x+"><button id='myAccordeonButton'><img id='ArrowAttrImg' src='"+r.getWebappsAssetUrl("ConfiguratorWebView","icons/RightArrow.png")+"'/></button></td></tr>"+C+"</table>",n.RetrieveElement("ArrowAttrImg").onload=function(){if(n.RetrieveElement("content").offsetWidth>30)if(n.onWinEnv())for(var e=n.RetrieveElement("content").scrollWidth+"px",t=n.RetrieveElementByClassName("accordionHeader"),i=0;i<t.length;i++)t[i].style.width="",t[i].style.width=e;else for(t=n.RetrieveElementByClassName("accordionHeader"),i=0;i<t.length;i++)t[i].style.width="",t[i].style.width="100%";null!=n.RetrieveElement("prodStatesContainer")&&(n.RetrieveElement("prodStatePanel").style.width=n.RetrieveElement("content").offsetWidth+"px",n.RetrieveElement("prodStatePanel").parentNode.style.width=n.RetrieveElement("content").offsetWidth+"px",n.RetrieveElement("content").style.height=n.getPageSize().y-(n.RetrieveElement("prodStatesContainer").offsetHeight+115)+"px")},n.RetrieveElement("div_features_table").style.height=n.RetrieveElement("content").style.height.replace("px","")-60+"px",n.addEvent("wheel",n.RetrieveElement("div_features_table"),function(){n.RemovePanels()});var W=this;if(n.addEvent("click",n.RetrieveElement("myAccordeonButton"),W.AttrButtonCallback),n.addEvent("click",n.RetrieveElement("addAttrColumnFeatures"),function(){require(["DS/ConfiguratorWebView/PanelController"],function(e){e.AddColumn(n.RetrieveElement("addAttrColumnFeatures"),s)})}),null!=n.RetrieveElement("prodStatePanel")&&n.RetrieveElement("content").offsetWidth>30&&(n.RetrieveElement("prodStatePanel").style.width=n.RetrieveElement("content").offsetWidth+"px",n.RetrieveElement("prodStatePanel").parentNode.style.width=n.RetrieveElement("content").offsetWidth+"px"),n.RetrieveElement("content").offsetWidth>30)if(n.onWinEnv())for(var A=n.RetrieveElement("content").scrollWidth+"px",O=n.RetrieveElementByClassName("accordionHeader"),F=0;F<O.length;F++)O[F].style.width="",O[F].style.width=A;else for(O=n.RetrieveElementByClassName("accordionHeader"),F=0;F<O.length;F++)O[F].style.width="",O[F].style.width="100%";for(n.addEvent("keyup",n.RetrieveElement("SearchFeature"),function(){W.updateSearchResult(this,"tableAttr","ResultSearchFeature")}),n.addEvent("click",n.RetrieveElement("SearchFeature"),function(e){var t=e.pageX-this.getBoundingClientRect().left,i=this.offsetWidth-34,n=this.offsetWidth-18;"NonEmptyInput"==this.className&&t>i&&t<n&&(this.value="",W.updateSearchResult(this,"tableAttr","ResultSearchFeature"))}),F=0;F<f.featuresVisibleAttributes.length;F++)n.RetrieveElement("featureAttrTitleId_"+f.featuresVisibleAttributes[F])&&(n.addEvent("mouseover",n.RetrieveElement("featureAttrTitleId_"+f.featuresVisibleAttributes[F]),function(){this.childNodes[1].style.visibility="visible"}),n.addEvent("mouseout",n.RetrieveElement("featureAttrTitleId_"+f.featuresVisibleAttributes[F]),function(){this.childNodes[1].style.visibility="hidden"}),n.addEvent("click",n.RetrieveElement("FeatureAttrLabel_"+f.featuresVisibleAttributes[F]),function(){"unselected"==this.className?this.className="selected":"selected"==this.className&&(this.className="unselected")}),n.addEvent("click",n.RetrieveElement("columnFeature_"+f.featuresVisibleAttributes[F]),function(){W.DeleteColumn(this,"feature")}));n.RetrieveElement("featureAttrTitleId_List Price")&&n.addEvent("click",n.RetrieveElement("FeatureAttrLabel_List Price"),function(){"unselected"==this.className?this.className="selected":"selected"==this.className&&(this.className="unselected")});W=this;for(F=0;F<s.length;F++)n.addEvent("click",n.RetrieveElement("input"+s[F].ruleId),function(){W.createOptionsPanel(s[this.name].ruleId)});n.onWinEnv()||n.SetSizeOfAttributsCellsTable(n.RetrieveElement("tableAttr"),n.RetrieveElement("tableAttrTitle"),n.RetrieveElement("div_features_table")),this.updateFeatures(!0),n.onWinEnv()&&n.updateWebViewerWidthInNativeEnv(!0)}},updateFeatures:function(l){var r=new t,o=r.getDictionary().features,a=n.RetrieveElement("SearchFeature").offsetWidth;for(i=0;i<o.length;i++)n.RetrieveElement("tableAttr").rows[i].cells[0].style.width=a-8+"px",n.RetrieveElement("input"+o[i].ruleId).value="",n.RetrieveElement("input"+o[i].ruleId).rows=1,"selectionMode_Refine"==r.getConfigurationMode()?("true"==r.getRulesActivation()?n.RetrieveElement("input"+o[i].ruleId).placeholder=e.i18n("All compatibles"):"false"==r.getRulesActivation()&&(n.RetrieveElement("input"+o[i].ruleId).placeholder=e.i18n("All")),this.AddIncludedStateOnRefineMode()):"selectionMode_Build"==r.getConfigurationMode()&&(n.RetrieveElement("input"+o[i].ruleId).placeholder=e.i18n("None")),this.updateFeatureState(o[i].ruleId);this.updateMustSelectFeatureNumber(),this.updateConflictingFeatures(),this.updateSearchResult(n.RetrieveElement("SearchFeature"),"tableAttr","ResultSearchFeature"),n.sendXMLtoNativeEnv(),n.onWinEnv()||1!=l||n.resizeWindow(!1)},checkInvalidKeyInFeatures:function(){for(var i=[],n=new t,l=n.getDictionary().features,r=0;r<l.length;r++){var o=n.getStateWithId("KeyIn_"+l[r].ruleId);if("chosen"==o||"chosenInConflict"==o){var a,s=l[r].keyInType,d=n.getKeyInValueById("KeyIn_"+l[r].ruleId);"Integer"==s?a=this.inputNumberCheck(d,0,1):"Real"==s?a=this.inputNumberCheck(d,2,1):"Input"==s||"Text Area"==s?a=this.checkForBadChars(d,!1):"Date"==s&&(a=this.inputDateCheck(d,"M dd, yy")),a&&!a.isValid&&i.push(l[r].displayName)}}var c=!0;if(i&&i.length>0){c=!1;var u="";for(r=0;r<i.length;r++)u.length>0&&(u+=", "),u+=i[r];var p=e.i18n("KeyIn Type has been changed for #FEATURES#");p=p.replace("#FEATURES#",u),alert(p)}return c},SetMultiSelOnSolver:function(e,i){new t;var l="false";1==e&&(l="true");var r={_from:"configurator",_to:"solverConfiguration",_request:"setMultiSelection",_data:l};returnFromWebService=n.sendTextToSolver(JSON.stringify(r),i),null!=returnFromWebService&&require(["DS/ConfiguratorWebView/ConfigurationServices"],function(e){e.ApplyAnswer(returnFromWebService)})},SetOptionsAvailableForSingleTypeFeature:function(e){for(var i=new t,l=i.getDictionary().features,r=0;r<l.length;r++)if(l[r].name==e){if("Single"==l[r].selectionType){for(var o=0;o<l[r].options.length;o++)i.setStateWithId(l[r].options[o].ruleId,"available");!n.onWinEnv()&&l[r].keyInType&&"Blank"!=l[r].keyInType&&i.setKeyInValueById("KeyIn_"+l[r].ruleId,"")}break}},AddIncludedStateOnRefineMode:function(){var e=new t,i=e.getConfigurationMode(),n=e.getDictionary().features,l=[];if("selectionMode_Refine"==i)for(var r=0;r<n.length;r++){l=[];for(var o=0;o<n[r].options.length;o++)-1==l.indexOf(e.getStateWithId(n[r].options[o].ruleId))&&l.push(e.getStateWithId(n[r].options[o].ruleId));if(-1==l.indexOf("chosen")&&-1==l.indexOf("chosenInConflict")&&-1==l.indexOf("default")&&-1==l.indexOf("defaultInConflict")&&-1==l.indexOf("required")&&-1==l.indexOf("recommanded"))for(o=0;o<n[r].options.length;o++)"available"!=e.getStateWithId(n[r].options[o].ruleId)&&null!=e.getStateWithId(n[r].options[o].ruleId)||e.setStateWithId(n[r].options[o].ruleId,"included")}},RemoveIncludedStateOnBuildMode:function(){var e=new t,i=e.getConfigurationMode(),n=e.getDictionary().features;if("selectionMode_Build"==i)for(var l=0;l<n.length;l++)for(var r=0;r<n[l].options.length;r++)"included"==e.getStateWithId(n[l].options[r].ruleId)&&e.setStateWithId(n[l].options[r].ruleId,"available")},prodStatesExists:function(e){var t=null;return null!=e&&null!=e.productEvolutions&&e.productEvolutions.rev&&(t=e),null!=t&&null!=t.productEvolutions&&t},showTree:function(e){var i=new PSTree("prodStatesContainer");i.config.iRootOrientation=PSTree.RO_LEFT,i.config.selectionMode=PSTree.SM_SINGLE,i.config.useTarget=!1;var n=e.productEvolutions;this.drawNode(i,n,-1,!0),i.createTree(),(new t).setProductStateTreeObj(i)},drawNode:function(e,t,i,n){var l="",r="",o="",a="",s="",d="",c="";if(null!=t&&null!=t){if(r=t.id,o=t.name,a=t.rev,s=t.state,d=t.revision,c=t.derivations,e.add(r,i,o,n,o+" "+a,s,a),c.length>0)if(c instanceof Array)for(var u=0;u<c.length;u++)l=c[u],this.drawNode(e,l,r,!1);else e.add(r,i,o,n,o+" "+a,s,a);0!=Object.keys(d).length&&this.drawNode(e,d,r,!0)}},addEventOnProdStateSelection:function(e,i,l,r){var o=new t;o._dictionaryInJson.name=i,o._dictionaryInJson.revision=l;var a=o.getEvolutionCriteria();if(r&&o.EmptyCacheIdWithState(),null==a.productState){var s={id:e,name:i,revision:l};o.setEvolutionCriteria({productState:s})}else a.productState.id=e,a.productState.name=i,a.productState.revision=l;var d=o.getAccordConfigurationFeature();null!=d&&null!=d&&n.RetrieveElementByClassName("configFeatures")[0].offsetHeight<30&&d.toggleItem("configFeatures");var c="";o.getSolverId()&&(c+=o.getNodeSolverName()),""!=c&&(c+="::"),r&&n.send_notif("ProductStateSelected:"+c+i+l),n.RemovePanels()},selectProductState:function(e,i){for(var n=new t,l=(n.getDictionary().productEvolutions,n.getProductStateTreeObj()),r=null,o="",a="",s="",d=0;d<l.nDatabaseNodes.length;d++)o=(r=l.nDatabaseNodes[d]).dsc,a=r.rev,o==e&&a==i&&(s=r.id);null!=l&&""!=s&&l.selectNodeSingle(s,!1)},addEventOnProdStateUnselection:function(){var e=(new t).getAccordConfigurationFeature();null!=e&&null!=e&&n.RetrieveElementByClassName("configFeatures")[0].offsetHeight>30&&e.toggleItem("configFeatures"),n.RemovePanels()},createQuestionMarkTooltip:function(i,l,r){var o,a=new t;n.RetrieveElement("questionMarkTooltip")&&(n.RemoveElement("questionMarkTooltip"),n.onWinEnv()&&n.updateWebViewerWidthInNativeEnv(!0));var s=n.CreateElement("div"),d=n.CreateElement("div");if(d.id="TextQuestionMarkTooltip",s.id="questionMarkTooltip",0==l.length)"ERROR"!==r&&("incompatible"==a.getStateWithId(i)?d.innerHTML=e.i18n("Option")+" "+n.getOptionDisplayNameWithId(i)+" "+e.i18n("is never valid"):"required"==a.getStateWithId(i)&&(d.innerHTML=e.i18n("Option")+" "+n.getOptionDisplayNameWithId(i)+" "+e.i18n("is always required")));else{var c=e.i18n("Option #OPTION# is #STATUS# because")+":";c=(c=c.replace("#OPTION#",n.getOptionDisplayNameWithId(i))).replace("#STATUS#",e.i18n(a.getStateWithId(i))),d.innerHTML=c;for(var u=0;u<l.length;u++){u>0&&(d.innerHTML+="<br>"+e.i18n("and because")+":");for(var p=0;p<l[u].length;p++){"chosenInConflict"==(o=a.getStateWithId(l[u][p]))?o="chosen":"defaultInConflict"==o?o="default":"dismissedInConflict"==o&&(o="dismissed");var g=e.i18n("#OPTION# is #STATUS#");g=(g=g.replace("#OPTION#",n.getFeatureDisplayNameWithId(l[u][p])+"["+n.getOptionDisplayNameWithId(l[u][p])+"]")).replace("#STATUS#",e.i18n(o)),d.innerHTML+="<br><blocquote style='padding-left:20px;'>"+g+"</blocquote>"}}"ERROR"===r&&(d.innerHTML+="<br>")}"ERROR"===r&&(d.innerHTML+=e.i18n("InfoComputationAborted")),s.appendChild(d);var f=n.CreateElement("img");f.id="CloseQuestionMarkTooltip",f.src=n.getImgPath("close"),s.appendChild(f),s.style.left="ERROR"===r?n.RetrieveElement("myfeatureOptions").style.left:a.getCoordForTooltipIncompatibilities().x,s.style.top=a.getCoordForTooltipIncompatibilities().y,e.extendElement(s).inject(a.getWidget().body),parseInt(s.style.top.split("px")[0])+s.offsetHeight>n.RetrieveElement("topPanel").offsetHeight&&(s.style.top=parseInt(s.style.top.split("px")[0])-s.offsetHeight+"px"),n.addEvent("click",n.RetrieveElement("CloseQuestionMarkTooltip"),function(){n.RemoveElement("questionMarkTooltip"),n.onWinEnv()&&n.updateWebViewerWidthInNativeEnv(!0)}),n.RetrieveElement("questionMarkTooltip").offsetHeight>115&&(n.RetrieveElement("questionMarkTooltip").style.height="115px"),n.addEvent("mouseleave",n.RetrieveElement("questionMarkTooltip"),function(){require(["DS/ConfiguratorWebView/Utilities"],function(e){e.RetrieveElement("questionMarkTooltip").style.opacity=0})}),n.addEvent("mouseenter",n.RetrieveElement("questionMarkTooltip"),function(){require(["DS/ConfiguratorWebView/Utilities"],function(e){e.RetrieveElement("questionMarkTooltip").style.opacity=1})}),n.addEvent("mousedown",n.RetrieveElement("myfeatureOptions"),function(){require(["DS/ConfiguratorWebView/Utilities"],function(e){e.RetrieveElement("questionMarkTooltip")&&(e.RemoveElement("questionMarkTooltip"),e.onWinEnv()&&e.updateWebViewerWidthInNativeEnv(!0))})});a.setCoordForTooltipIncompatibilities({x:"",y:""}),n.onWinEnv()&&n.updateWebViewerWidthInNativeEnv(!0)},CreateConflictTooltip:function(i){i.stopPropagation&&i.stopPropagation();var l,r=i.currentTarget?i.currentTarget:i.srcElement,o=new t,a=r.parentElement.childNodes[1].id.split("_")[1];n.onWinEnv()||(o=new t).isAFeature(a)&&(a="KeyIn_"+a);n.RetrieveElement("redQuestionMarkTooltip")&&(n.RemoveElement("redQuestionMarkTooltip"),n.onWinEnv()&&n.updateWebViewerWidthInNativeEnv(!0));var s=o.getListOfListOfImpliedRules(),d=o.getListOfListOfConflictingIds(),c=n.CreateElement("div"),u=n.CreateElement("div");c.id="TextConflictTooltip",u.id="redQuestionMarkTooltip",c.innerHTML=e.i18n("Option")+" "+n.getOptionDisplayNameWithId(a)+" "+e.i18n("is conflicting with")+":";for(var p=0;p<d.length;p++){if(-1!=d[p].indexOf(a)){l&&(c.innerHTML+=e.i18n("and also conflicting with")+":");for(var g=0;g<d[p].length;g++)a!=d[p][g]&&(c.innerHTML+="<br><blocquote style='padding-left:20px;'>"+n.getFeatureDisplayNameWithId(d[p][g])+"["+n.getOptionDisplayNameWithId(d[p][g])+"] </blocquote>",l=!0);if(s.length>0)for(g=0;g<s[p].length;g++)0==g&&(c.innerHTML+="<br><blocquote style='padding-left:20px;'> "+e.i18n("Implied Rules")+":</blocquote>"),c.innerHTML+="<br><blocquote style='padding-left:40px;'>"+s[p][g]+"</blocquote>";c.innerHTML+="<br>"}o.getErrorOnConflictPanel()&&(c.innerHTML+=e.i18n("InfoComputationAborted"))}u.appendChild(c);var f=n.CreateElement("img");f.id="CloseConflictTooltip",f.src=n.getImgPath("close"),u.appendChild(f),o.getErrorOnConflictPanel()?u.style.left=n.RetrieveElement("myfeatureOptions").style.left:u.style.left=r.getBoundingClientRect().left+"px",u.style.top=r.getBoundingClientRect().top+"px",e.extendElement(u).inject(o.getWidget().body),parseInt(u.style.top.split("px")[0])+u.offsetHeight>n.RetrieveElement("topPanel").offsetHeight&&(u.style.top=parseInt(u.style.top.split("px")[0])-u.offsetHeight+"px"),n.addEvent("click",n.RetrieveElement("CloseConflictTooltip"),function(){n.RemoveElement("redQuestionMarkTooltip"),n.onWinEnv()&&n.updateWebViewerWidthInNativeEnv(!0)}),n.RetrieveElement("redQuestionMarkTooltip").offsetHeight>115&&(n.RetrieveElement("redQuestionMarkTooltip").style.height="115px"),n.addEvent("mouseleave",n.RetrieveElement("redQuestionMarkTooltip"),function(){require(["DS/ConfiguratorWebView/Utilities"],function(e){e.RetrieveElement("redQuestionMarkTooltip").style.opacity=0})}),n.addEvent("mouseenter",n.RetrieveElement("redQuestionMarkTooltip"),function(){require(["DS/ConfiguratorWebView/Utilities"],function(e){e.RetrieveElement("redQuestionMarkTooltip").style.opacity=1})}),n.addEvent("mousedown",n.RetrieveElement("myfeatureOptions"),function(){require(["DS/ConfiguratorWebView/Utilities"],function(e){e.RetrieveElement("redQuestionMarkTooltip")&&(e.RemoveElement("redQuestionMarkTooltip"),e.onWinEnv()&&e.updateWebViewerWidthInNativeEnv(!0))})}),n.onWinEnv()&&n.updateWebViewerWidthInNativeEnv(!0)},debugClickDown:function(e){var t=document.getElementById("popupDebug");n.addEvent("mousemove",t,n.moveDebugPopup),t.style.left=e.clientX-200+"px",t.style.top=e.clientY-10+"px"},debugClickUp:function(e){var t=document.getElementById("popupDebug");n.removeEvent("mousemove",t,n.moveDebugPopup)},debugStartBtnCbk:function(){console.log("Debug tool Started");var e=document.getElementById("debugCheckbox"),i=document.getElementById("debugInputPath"),l="messages";e.disabled="disabled",i.disabled="disabled",e.checked&&(l="messagesAndSolver");new t;var r={_from:"configurator",_to:"solver",_request:"tracesActivation",_data:{activation:"yes",path:i.value,level:l}};returnFromWebService=n.sendTextToSolver(JSON.stringify(r)),null!=returnFromWebService&&require(["DS/ConfiguratorWebView/ConfigurationServices"],function(e){e.ApplyAnswer(returnFromWebService)})},debugStopBtnCbk:function(){console.log("Debug tool Stopped");new t;returnFromWebService=n.sendTextToSolver(JSON.stringify({_from:"configurator",_to:"solver",_request:"tracesActivation",_data:{activation:"no"}})),null!=returnFromWebService&&require(["DS/ConfiguratorWebView/ConfigurationServices"],function(e){e.ApplyAnswer(returnFromWebService)});var e=document.getElementById("debugCheckbox"),i=document.getElementById("debugInputPath");e.disabled="",i.disabled=""}};return e.namespace("DS/ConfiguratorWebView/PanelController",a)}),define("DS/ConfiguratorWebView/FilterXMLServices",["UWA/Core"],function(e){return e.namespace("DS/ConfiguratorWebView/FilterXMLServices",function(e){var t=new Object,i=(new Object,new Object),n=new Object,l=new Object,r=new Object,o=new Object,a=new Object,s={selectionMode:"SelectionMode",selectionMode_Build:"Strict",selectionMode_Refine:"150%"},d=["selectionMode"],c={ConfigurationCriteria:"configurationCriteria",ApplicationState:"applicationState",AppRulesParam:"app_RulesParam",AppFunc:"app_Func",Dictionary:"dictionary",Rules:"rules",EvolutionCriteria:"evolutionCriteria"},u={Schema:"xmlns:xs",Namespace:"xmlns",SchemaLocation:"xs:schemaLocation"},p={ROOT:"CfgFilterExpression",TAG1:"FilterSelection",Schema:"http://www.w3.org/2001/XMLSchema-instance",Namespace:"urn:com:dassault_systemes:config",SchemaLocation:"urn:com:dassault_systemes:config CfgFilterExpression.xsd"};function g(e){return"</"+e+">"}function f(e){return"string"==typeof e?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"):e}function m(e){var t="NoSelection",l=i.features;for(var r in l){var o=l[r].options,a=!1;if(o instanceof Object){for(var s in o)if(null!=(d=o[s].ruleId)&&d.toString().trim()==e){a=!0;break}if(a){for(var s in o){var d;if(null!=(d=o[s].ruleId))for(var c in n)if(n[c]instanceof Object){var u=n[c].Id,p=n[c].State;u==d&&("chosen"==p||"chosenInConflict"==p?"NoSelection"==t||"ruleSelection"==t?t="userSelection":"userReject"==t||"userRejectAndRuleSelection"==t?t="userSelectionAndUserReject":"ruleReject"!=t&&"ruleSelectionAndRuleReject"!=t||(t="userSelectionAndRuleReject"):"required"==p||"default"==p||"defaultInConflict"==p||"recommanded"==p?"NoSelection"==t?t="ruleSelection":"userReject"==t?t="userRejectAndRuleSelection":"ruleReject"==t&&(t="ruleSelectionAndRuleReject"):"dismissed"==p||"dismissedInConflict"==p?"NoSelection"==t||"ruleReject"==t?t="userReject":"userSelection"==t||"userSelectionAndRuleReject"==t?t="userSelectionAndUserReject":"ruleSelection"!=t&&"ruleSelectionAndRuleReject"!=t||(t="userRejectAndRuleSelection"):"incompatible"==p&&("NoSelection"==t?t="ruleReject":"userSelection"==t?t="userSelectionAndRuleReject":"ruleSelection"==t&&(t="ruleSelectionAndRuleReject")))}}break}}}return t}function v(){var e="";e+=function(){var e='<?xml version="1.0" encoding="UTF-8"?>',t=[];for(var i in u)t.push(i);if(e+="<"+l.ROOT,null!=t)for(var n=0;n<t.length;n++){var r=t[n];e+=" "+u[r]+"='"+p[r]+"'"}return e+=">"}(),e+=function(e,t,i,n){var l="<"+t;if(null!=i)for(var r=0;r<i.length;r++){var o=i[r];if(null!=s[o]){var a=s[o];attrVal=s[e[o]],attrVal=f(attrVal),l+=" "+a+"='"+attrVal+"'"}else attrVal=e[o],attrVal=f(attrVal),l+=" "+o+"='"+attrVal+"'"}return l+=n?"/>":">"}(t,l.TAG1,d,!1);var c=function(){var e=0;for(var t in n)n[t]instanceof Object&&("chosen"!=n[t].State&&"required"!=n[t].State&&"default"!=n[t].State&&"chosenInConflict"!=n[t].State&&"recommanded"!=n[t].State&&"dismissedInConflict"!=n[t].State&&"dismissed"!=n[t].State&&"incompatible"!=n[t].State&&"defaultInConflict"!=n[t].State||e++);return e}();null!=r&&(e+=function(){var e="";if(r.productState){var t=r.productState.name,n=r.productState.revision,l=i.model.label;e+='<TreeSeries Type="ProductState" Name="'+l+'">',e+='<Single Name="'+t+'" Revision="'+n+'" />',e+="</TreeSeries>"}return e}());var v=!1;if("selectionMode_Build"===t.selectionMode&&(v=!0),c>0)for(var h in n)if(n[h]instanceof Object){var R=n[h].Id,y=n[h].State,S=m(R);"chosen"==y||"required"==y||"default"==y||"chosenInConflict"==y||"defaultInConflict"==y||"recommanded"==n[h].State?"userSelection"!=S&&"userSelectionAndUserReject"!=S&&"userSelectionAndRuleReject"!=S&&"ruleSelection"!=S&&"ruleSelectionAndRuleReject"!=S||(e+=b(R,!1,y)):v||"dismissed"!=y&&"incompatible"!=y&&"dismissedInConflict"!=y||"userReject"!=S&&"ruleReject"!=S&&"userRejectAndRuleSelection"!=S||(e+=b(R,!0,y))}var E=!0;for(var C in o)o.hasOwnProperty(C)&&(E=!1);return E||(e+=function(){var e="";for(var t in o){var n=i.features;for(var l in n){var r=n[l].ruleId;if(null!=r&&r.toString().trim()==t){var s=n[l].name;e+="<NOT>",e+=I(s,!1);for(var d=0;d<o[t].length;d++)coName=o[t][d],optionState=a[t][d],e+=I(coName,!0,0,optionState);e+=g("Feature"),e+=g("NOT");break}}}return e}()),e+=g(l.TAG1),e+=g(l.ROOT)}function h(e,t,i){null==o[e]&&(o[e]=[]),null==a[e]&&(a[e]=[]),o[e].push(t),a[e].push(i)}function b(e,t,n){var l="",r=i.features;for(var o in r){var a=r[o],s=a.name,d=a.options;if(d instanceof Object)for(var c in d){var u=d[c].name;if(null!=u&&null!=u){var p=d[c].ruleId;if(null!=p&&p.toString().trim()==e)if(t){if("Multiple"!=a.selectionType)return h(a.ruleId,u,n),l;l+="<NOT>",l+=I(s,!1),l+=I(u,!0),l+=g("Feature"),l+=g("NOT")}else l+=I(s,!1),l+=I(u,!0),l+=g("Feature")}}}return l}function I(e,t,i,n){var l="";return l+='<Feature Type="ConfigFeature" Name="'+e+'"',l+=t?"/>":">"}"FilterExpression"==e&&(l=p),this.json2xml_str=function(e){var l;return t=(l=e)[c.AppRulesParam],l[c.AppFunc],i=l[c.Dictionary],n=l[c.ConfigurationCriteria],r=l[c.EvolutionCriteria],t.selectionMode,v()},this.parseXml=function(e){var t=null;if(window.DOMParser)try{t=(new DOMParser).parseFromString(e,"text/xml")}catch(e){t=null}else if(window.ActiveXObject)try{(t=new ActiveXObject("Microsoft.XMLDOM")).async=!1,t.loadXML(e)||window.alert(t.parseError.reason+t.parseError.srcText)}catch(e){t=null}else alert("cannot parse xml string!");return t},this.xmlToJson=function(e){var t={};if(1==e.nodeType){if(e.attributes.length>0){t.attributes={};for(var i=0;i<e.attributes.length;i++){var n=e.attributes.item(i);t.attributes[n.nodeName]=n.value}}}else 3==e.nodeType&&(t=e.nodeValue);if(e.hasChildNodes())for(var l=0;l<e.childNodes.length;l++){var r=e.childNodes.item(l),o=r.nodeName;if(void 0===t[o])t[o]=R(r);else{if(void 0===t[o].push){var a=t[o];t[o]=[],t[o].push(a)}t[o].push(R(r))}}return t};var R=function(e){var t={};if(1==e.nodeType){if(e.attributes.length>0){t.attributes={};for(var i=0;i<e.attributes.length;i++){var n=e.attributes.item(i);t.attributes[n.nodeName]=n.value}}}else 3==e.nodeType&&(t=e.nodeValue);if(e.hasChildNodes())for(var l=0;l<e.childNodes.length;l++){var r=e.childNodes.item(l),o=r.nodeName;if(void 0===t[o])t[o]=R(r);else{if(void 0===t[o].push){var a=t[o];t[o]=[],t[o].push(a)}t[o].push(R(r))}}return t}})}),define("DS/ConfiguratorWebView/Utilities",["UWA/Core","DS/ConfiguratorWebModel/ConfiguratorModel","DS/ConfiguratorWebView/FilterXMLServices","DS/WebappsUtils/WebappsUtils","css!DS/ConfiguratorWebView/ConfiguratorWebView"],function(e,t,i,n,l){var r={RetrieveElement:function(e){return document.getElementById(e)},RetrieveElementByTags:function(e){return document.getElementsByTagName(e)},RetrieveElementByClassName:function(e){return document.getElementsByClassName(e)},CreateElement:function(e){return document.createElement(e)},getBody:function(){return document.body},getPageSize:function(){return{x:this.getBody().clientWidth,y:this.getBody().clientHeight}},RemoveElement:function(e){var t=this.RetrieveElement(e);t&&t.parentNode.removeChild(t)},addEvent:function(e,t,i){t.addEventListener?t.addEventListener(e,i,!1):t.attachEvent?"wheel"==e?t.attachEvent("onmouse"+e,i):t.attachEvent("on"+e,i):t[e]=i},removeEvent:function(e,t,i){t.removeEventListener?t.removeEventListener(e,i,!1):t.detachEvent?t.detachEvent("on"+e,i):t[e]=i},getImgPath:function(e){var i;("rightArrow"==e&&(i=n.getWebappsAssetUrl("ConfiguratorWebView","icons/RightArrow.png")),"leftArrow"==e&&(i=n.getWebappsAssetUrl("ConfiguratorWebView","icons/LeftArrow.png")),"multiSelection"==e&&(i=n.getWebappsAssetUrl("ConfiguratorWebView","icons/CmdUnsel_MultiSelection.png")),"multiSelectionSelected"==e&&(i=n.getWebappsAssetUrl("ConfiguratorWebView","icons/CmdSel_MultiSelection.png")),"optim"==e&&(i=n.getWebappsAssetUrl("ConfiguratorWebView","icons/CmdUnsel_ProposeOptimized.png")),"optimSelected"==e&&(i=n.getWebappsAssetUrl("ConfiguratorWebView","icons/CmdSel_ProposeOptimized.png")),"dependencies"==e&&(i=n.getWebappsAssetUrl("ConfiguratorWebView","icons/CmdUnsel_EnforceRequired.png")),"dependenciesSelected"==e&&(i=n.getWebappsAssetUrl("ConfiguratorWebView","icons/CmdSel_EnforceRequired.png")),"incompatibilities"==e&&(i=n.getWebappsAssetUrl("ConfiguratorWebView","icons/CmdUnsel_DisableIncompatible.png")),"incompatibilitiesSelected"==e&&(i=n.getWebappsAssetUrl("ConfiguratorWebView","icons/CmdSel_DisableIncompatible.png")),"completeConfMode"==e&&(i=n.getWebappsAssetUrl("ConfiguratorWebView","icons/CmdUnsel_SelectComplete.png")),"completeConfModeSelected"==e&&(i=n.getWebappsAssetUrl("ConfiguratorWebView","icons/CmdSel_SelectComplete.png")),"levelUnselected"==e&&(i=n.getWebappsAssetUrl("ConfiguratorWebView","icons/LevelUnselected.png")),"levelSelected"==e&&(i=n.getWebappsAssetUrl("ConfiguratorWebView","icons/LevelSelected.png")),"levelPlus"==e&&(i=n.getWebappsAssetUrl("ConfiguratorWebView","icons/LevelPlus.png")),"levelMinus"==e&&(i=n.getWebappsAssetUrl("ConfiguratorWebView","icons/LevelMinus.png")),"levelNoIndicator"==e&&(i=n.getWebappsAssetUrl("ConfiguratorWebView","icons/LevelNoIndicator.png")),"levelIndicator"==e&&(i=n.getWebappsAssetUrl("ConfiguratorWebView","icons/LevelIndicator.png")),"selectLevel"==e&&(i=n.getWebappsAssetUrl("ConfiguratorWebView","icons/SelectLevel.png")),"refine"==e&&(i=n.getWebappsAssetUrl("ConfiguratorWebView","icons/Refine.png")),"refineSelected"==e&&(i=n.getWebappsAssetUrl("ConfiguratorWebView","icons/RefineSelected.png")),"build"==e&&(i=n.getWebappsAssetUrl("ConfiguratorWebView","icons/Build.png")),"buildSelected"==e&&(i=n.getWebappsAssetUrl("ConfiguratorWebView","icons/BuildSelected.png")),"noStateIcon"!=e&&"maySelectFeature"!=e&&"levelEmpty"!=e||(i=n.getWebappsAssetUrl("ConfiguratorWebView","icons/NoState.png")),"exclamationMark"!=e&&"mustSelectFeature"!=e||(i=n.getWebappsAssetUrl("ConfiguratorWebView","icons/ExclamationMark.png")),"chosen"==e&&(i=n.getWebappsAssetUrl("ConfiguratorWebView","icons/ChosenByUser.png")),"dismissedFeature"==e&&(i=n.getWebappsAssetUrl("ConfiguratorWebView","icons/DismissedByUser.png")),"default"==e&&(i=n.getWebappsAssetUrl("ConfiguratorWebView","icons/Default.png")),"requiredByRules"==e&&(i=n.getWebappsAssetUrl("ConfiguratorWebView","icons/RequiredByRules.png")),"recommanded"==e)&&(i="RulesMode_SelectCompleteConfiguration"===(new t).getRulesMode()?n.getWebappsAssetUrl("ConfiguratorWebView","icons/NoState.png"):n.getWebappsAssetUrl("ConfiguratorWebView","icons/RecommendedByOptim.png"));return"chosenInConflict"==e&&(i=n.getWebappsAssetUrl("ConfiguratorWebView","icons/ChosenByUserRed.png")),"dismissedInConflict"==e&&(i=n.getWebappsAssetUrl("ConfiguratorWebView","icons/DismissedByUserRed.png")),"defaultInConflict"==e&&(i=n.getWebappsAssetUrl("ConfiguratorWebView","icons/DefaultRed.png")),"keyIn"==e&&(i=n.getWebappsAssetUrl("ConfiguratorWebView","icons/KeyInByUser.png")),"defaultFeatureImage"==e&&(i=n.getWebappsAssetUrl("ConfiguratorWebView","icons/DefaultImage.png")),"Input"!=e&&"Text Area"!=e||(i=n.getWebappsAssetUrl("ConfiguratorWebView","icons/TextType.png")),"Integer"==e&&(i=n.getWebappsAssetUrl("ConfiguratorWebView","icons/IntegerType.png")),"Real"==e&&(i=n.getWebappsAssetUrl("ConfiguratorWebView","icons/RealType.png")),"Date"==e&&(i=n.getWebappsAssetUrl("ConfiguratorWebView","icons/DateType.png")),"checkIcon"==e&&(i=n.getWebappsAssetUrl("ConfiguratorWebView","icons/CmdUnsel_SelectMode.png")),"checkIconSelected"==e&&(i=n.getWebappsAssetUrl("ConfiguratorWebView","icons/CmdSel_SelectMode.png")),"rejectIcon"==e&&(i=n.getWebappsAssetUrl("ConfiguratorWebView","icons/CmdUnsel_RejectMode.png")),"rejectIconSelected"==e&&(i=n.getWebappsAssetUrl("ConfiguratorWebView","icons/CmdSel_RejectMode.png")),"questionMark"==e&&(i=n.getWebappsAssetUrl("ConfiguratorWebView","icons/QuestionMark.png")),"redQuestionMark"==e&&(i=n.getWebappsAssetUrl("ConfiguratorWebView","icons/QuestionMarkRed.png")),"check"==e&&(i=n.getWebappsAssetUrl("ConfiguratorWebView","icons/CheckboxSelected.png")),"dismissed"==e&&(i=n.getWebappsAssetUrl("ConfiguratorWebView","icons/CheckboxDismissed.png")),"included"==e&&(i=n.getWebappsAssetUrl("ConfiguratorWebView","icons/CheckboxIncluded.png")),"incompatible"==e&&(i=n.getWebappsAssetUrl("ConfiguratorWebView","icons/CheckboxIncompatible.png")),"required"==e&&(i=n.getWebappsAssetUrl("ConfiguratorWebView","icons/CheckboxRequired.png")),"available"==e&&(i=n.getWebappsAssetUrl("ConfiguratorWebView","icons/CheckboxAvailable.png")),"check_radio"==e&&(i=n.getWebappsAssetUrl("ConfiguratorWebView","icons/RadioSelected.png")),"dismissed_radio"==e&&(i=n.getWebappsAssetUrl("ConfiguratorWebView","icons/RadioDismissed.png")),"included_radio"==e&&(i=n.getWebappsAssetUrl("ConfiguratorWebView","icons/RadioIncluded.png")),"incompatible_radio"==e&&(i=n.getWebappsAssetUrl("ConfiguratorWebView","icons/RadioIncompatible.png")),"required_radio"==e&&(i=n.getWebappsAssetUrl("ConfiguratorWebView","icons/RadioRequired.png")),"available_radio"==e&&(i=n.getWebappsAssetUrl("ConfiguratorWebView","icons/RadioAvailable.png")),"completeProduct"==e&&(i=n.getWebappsAssetUrl("ConfiguratorWebView","icons/Complete_Product.png")),"hybridProduct"==e&&(i=n.getWebappsAssetUrl("ConfiguratorWebView","icons/Hybrid_Product.png")),"partialProduct"==e&&(i=n.getWebappsAssetUrl("ConfiguratorWebView","icons/Partial_Product.png")),"defaultFeatureImage"==e&&(i=n.getWebappsAssetUrl("ConfiguratorWebView","icons/DefaultImage.png")),"close"==e&&(i=n.getWebappsAssetUrl("ConfiguratorWebView","icons/close.png")),"warning"==e&&(i=n.getWebappsAssetUrl("ConfiguratorWebView","icons/Warning.png")),"info"==e&&(i=n.getWebappsAssetUrl("ConfiguratorWebView","icons/Info.png")),i},isDefault:function(e){var i=new t,n=i.getDictionary().features;if("true"===i.getRulesActivation()){if(-1!==i.getDefaultOptionsList().indexOf(e))return!0}else for(var l=0;l<n.length;l++)for(var r=0;r<n[l].options.length;r++)if(n[l].options[r].ruleId===e)return"Yes"===n[l].options[r].defaultSelection;return!1},isRefineModeEnabled:function(e){var i=new t;if("Evaluation"==i.getPCPurpose()&&"true"==i.getRefineSelMode())return!0},getFeatureNameWithId:function(e){for(var i=(new t).getDictionary().features,n=0;n<i.length;n++){if(i[n].ruleId==e)return i[n].name;for(var l=0;l<i[n].options.length;l++)if(i[n].options[l].ruleId==e)return i[n].name}},getFeatureDisplayNameWithId:function(e){var i=(new t).getDictionary().features;0==e.indexOf("KeyIn")&&(e=e.split("_")[1]);for(var n=0;n<i.length;n++){if(i[n].ruleId==e)return i[n].displayName;for(var l=0;l<i[n].options.length;l++)if(i[n].options[l].ruleId==e)return i[n].displayName}},getOptionDisplayNameWithId:function(e){var i=(new t).getDictionary().features;if(0==e.indexOf("KeyIn"))return"Key In";for(var n=0;n<i.length;n++)for(var l=0;l<i[n].options.length;l++)if(i[n].options[l].ruleId==e)return i[n].options[l].displayName},loadJSON:function(e,t,i){var n=new XMLHttpRequest;n.onreadystatechange=function(){4===n.readyState&&(200===n.status||0===n.status?t&&t(JSON.parse(n.responseText)):i&&i(n))},n.open("GET",e,!0),n.send()},send_notif:function(e){this.onWinEnv()&&!window.__karma__&&dscef.sendString("notifText="+e)},RemovePanels:function(){this.RetrieveElement("filterPanel")&&this.RemoveElement("filterPanel"),this.RetrieveElement("myfeatureOptions")&&(this.RemoveElement("myfeatureOptions"),r.onWinEnv()&&r.updateWebViewerWidthInNativeEnv(!0)),this.RetrieveElement("addAttrColumnPanel")&&this.RemoveElement("addAttrColumnPanel"),this.RetrieveElement("questionMarkTooltip")&&(this.RemoveElement("questionMarkTooltip"),r.onWinEnv()&&r.updateWebViewerWidthInNativeEnv(!0)),this.RetrieveElement("redQuestionMarkTooltip")&&(this.RemoveElement("redQuestionMarkTooltip"),r.onWinEnv()&&r.updateWebViewerWidthInNativeEnv(!0))},getElipsisValue:function(e){var t="";return e&&(t=(e=e.split("\n").join(" ")).substr(0,30),e.length>30&&(t+="...")),t},replaceAll:function(e,t,i){for(;-1!=e.indexOf(t);)e=e.replace(t,i);return e},SetSizeOfAttributsCellsTable:function(e,t,i){var n,l;for(n=0;n<e.rows.length;n++)if("keyInOption"!=e.rows[n].cells[0].id){var r,o=0;if("tableAttrTitle"==t.id?(o=this.RetrieveElement("tableFixAttrTitle").rows[0].cells.length,r=this.RetrieveElement("tableFixAttrTitle")):"tableOptionsAttrTitle"==t.id&&(o=this.RetrieveElement("tableOptionsFixAttrTitle").rows[0].cells.length),r)for(l=1;l<=r.rows[0].cells.length;l++)e.rows[n].cells[l].style.width=r.rows[0].cells[l-1].offsetWidth+"px";for(l=o+1;l<=t.rows[0].cells.length+o-1;l++)e.rows[n].cells[l].style.width=t.rows[0].cells[l-o-1].offsetWidth+"px"}"divFeatureOptions"==i.id&&(i.style.width=this.RetrieveElement("SearchOptions").offsetWidth+this.RetrieveElement("tableOptionsFixAttrTitle").offsetWidth+this.RetrieveElement("tableOptionsAttrTitle").offsetWidth+"px")},removeAttrListPanel:function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0,this.RetrieveElement("addAttrColumnPanel")&&this.RemoveElement("addAttrColumnPanel"),this.RetrieveElement("myfeatureOptions")&&this.removeEvent("mousedown",this.RetrieveElement("myfeatureOptions"),this.removeAttrListPanel)},CallSolveMethodOnSolver:function(){var e=new t;if("true"==e.getRulesActivation()){var i={_from:"configurator",_to:"solverConfiguration",_request:"solveAndDiagnoseAll",_data:{configurationCriteria:e.getAdaptedConfigurationCriteria()}},n=this.sendTextToSolver(JSON.stringify(i));null!=n&&require(["DS/ConfiguratorWebView/ConfigurationServices"],function(e){e.ApplyAnswer(n)}),this.RetrieveElement("content")&&this.createLoader(),e.setConfigurationCriteria(e.getConfigurationCriteria())}},createLoader:function(){this.RetrieveElement("divLoader")&&this.RemoveElement("divLoader");var i,l,r=new t,o=r.getWidget().createElement("div");o.style.left="0px",o.style.top="0px",o.style.width="100%",o.style.height="100%",o.style.position="absolute",o.id="divLoader",o.style.backgroundImage="url("+n.getWebappsAssetUrl("ConfiguratorWebView","icons/transparentImageForLoader.png")+")",i=this.RetrieveElement("configPanel").offsetWidth/2-31,l=this.getPageSize().y/2-38,o.addEventListener("click",function(e){e.currentTarget?e.currentTarget:e.srcElement;e.stopPropagation?e.stopPropagation():e.cancelBubble=!0},!1),o.innerHTML='<div id="floatingBarsG" style="left:'+i+"px; top:"+l+'px;"><div class="blockG" id="rotateG_01"></div><div class="blockG" id="rotateG_02"></div><div class="blockG" id="rotateG_03"></div><div class="blockG" id="rotateG_04"></div><div class="blockG" id="rotateG_05"></div><div class="blockG" id="rotateG_06"></div><div class="blockG" id="rotateG_07"></div><div class="blockG" id="rotateG_08"></div></div>',e.extendElement(o).inject(r.getWidget().body)},setSelectionModeOnSolver:function(e,i){new t;var n={_from:"configurator",_to:"solverConfiguration",_request:"setSelectionMode",_data:e};returnFromWebService=this.sendTextToSolver(JSON.stringify(n),i),null!=returnFromWebService&&require(["DS/ConfiguratorWebView/ConfigurationServices"],function(e){e.ApplyAnswer(returnFromWebService)})},setOptimizationFunctionOnSolver:function(){var e=new t,i=[],n=e.cacheIdWithPrice;for(id in n)e.isAnOption(id)&&"0.0"!=n[id]&&i.push({id:id,coefficient:n[id]});var l={_from:"configurator",_to:"solverConfiguration",_request:"setOptimizationFunction",_data:{optimizationMode:"min",optimizationCoefficients:i}};returnFromWebService=this.sendTextToSolver(JSON.stringify(l)),null!=returnFromWebService&&require(["DS/ConfiguratorWebView/ConfigurationServices"],function(e){e.ApplyAnswer(returnFromWebService)})},getJsonKeys:function(e){var t,i=[];for(t in e)i.push(t);return i},sendXMLtoNativeEnv:function(){if(this.onWinEnv()){var e=new t,n=new i("FilterExpression"),l={configurationCriteria:e.getConfigurationCriteria(),dictionary:e.getDictionary(),app_RulesParam:e.getAppRulesParam(),app_Func:e.getAppFunc(),evolutionCriteria:e.getEvolutionCriteria()},r=n.json2xml_str(l);r&&0!==e.get3DCounter()&&(this.send_notif("XMLFor3DRendering:"+r),e.set3DCounter(0))}},RemoveAllSpecifiedStateOccurrenceInFeature:function(e,i){for(var n=new t,l=n.getDictionary().features,r="",o=0;o<l.length;o++)if(l[o].ruleId==e){for(var a=0;a<l[o].options.length;a++)n.getStateWithId(l[o].options[a].ruleId)==i&&(n.setStateWithId(l[o].options[a].ruleId,"available"),isInInput=this.RetrieveElement("input"+e).value.indexOf(l[o].options[a].name),"dismissed"==i&&(r="Except "),this.RetrieveElement("input"+e).value=this.RetrieveElement("input"+e).value.replace(r+l[o].options[a].name+"\n",""),""!=this.RetrieveElement("input"+e).value&&-1!=isInInput&&(this.RetrieveElement("input"+e).rows--,this.RetrieveElement("myfeatureOptions")&&(this.RetrieveElement("myfeatureOptions").style.left=this.RetrieveElement("input"+e).getBoundingClientRect().left-this.RetrieveElement("configPanel").getBoundingClientRect().left+"px",this.RetrieveElement("myfeatureOptions").style.top=this.RetrieveElement("input"+e).getBoundingClientRect().bottom-this.RetrieveElement("configPanel").getBoundingClientRect().top+"px")));if(!this.onWinEnv()&&l[o].keyInType&&"Blank"!=l[o].keyInType&&n.getStateWithId("KeyIn_"+e)==i){n.setStateWithId("KeyIn_"+e,"available");var s=n.getKeyInValueById("KeyIn_"+e);s=this.getElipsisValue(s),isInInput=this.RetrieveElement("input"+e).value.indexOf(s),""!=this.RetrieveElement("input"+e).value&&-1!=isInInput&&(this.RetrieveElement("input"+e).rows--,this.RetrieveElement("myfeatureOptions")&&(this.RetrieveElement("myfeatureOptions").style.left=this.RetrieveElement("input"+e).getBoundingClientRect().left-this.RetrieveElement("configPanel").getBoundingClientRect().left+"px",this.RetrieveElement("myfeatureOptions").style.top=this.RetrieveElement("input"+e).getBoundingClientRect().bottom-this.RetrieveElement("configPanel").getBoundingClientRect().top+"px"))}break}},DetectMultiSelOnSingleFeatures:function(){for(var e=new t,i=e.getDictionary().features,n=0,l=!1,r=0;r<i.length;r++){if(n=0,"Single"==i[r].selectionType){for(var o=0;o<i[r].options.length;o++)"chosen"!=e.getStateWithId(i[r].options[o].ruleId)&&"chosenInConflict"!=e.getStateWithId(i[r].options[o].ruleId)&&"default"!=e.getStateWithId(i[r].options[o].ruleId)&&"defaultInConflict"!=e.getStateWithId(i[r].options[o].ruleId)||n++;if(!this.onWinEnv()&&i[r].keyInType&&"Blank"!=i[r].keyInType){var a=e.getStateWithId("KeyIn_"+i[r].ruleId);"chosen"!=a&&"chosenInConflict"!=a&&"default"!=a&&"defaultInConflict"!=a||n++}if(n>1){l=!0;break}}if(l)break}return l},ResetMultiSelOnSingleFeatures:function(){for(var e=new t,i=e.getDictionary().features,n=[],l=0;l<i.length;l++)if("Single"==i[l].selectionType){for(var r=0,o=0;o<i[l].options.length;o++)"chosen"!=e.getStateWithId(i[l].options[o].ruleId)&&"chosenInConflict"!=e.getStateWithId(i[l].options[o].ruleId)||r++;if(!this.onWinEnv()&&i[l].keyInType&&"Blank"!=i[l].keyInType)"chosen"!=(a=e.getStateWithId("KeyIn_"+i[l].ruleId))&&"chosenInConflict"!=a||r++;if(r>1){for(o=0;o<i[l].options.length;o++)"chosen"!=e.getStateWithId(i[l].options[o].ruleId)&&"chosenInConflict"!=e.getStateWithId(i[l].options[o].ruleId)||(e.setStateWithId(i[l].options[o].ruleId,"available"),-1==n.indexOf(i[l].ruleId)&&n.push(i[l].ruleId));var a;if(!this.onWinEnv()&&i[l].keyInType&&"Blank"!=i[l].keyInType)"chosen"!=(a=e.getStateWithId("KeyIn_"+i[l].ruleId))&&"chosenInConflict"!=a||(e.setKeyInValueById("KeyIn_"+i[l].ruleId,""),-1==n.indexOf(i[l].ruleId)&&n.push(i[l].ruleId))}}return n},DetectMultiSelOnFeature:function(e){for(var i,n=new t,l=n.getDictionary().features,r=0,o=!1,a=0;a<l.length;a++)if(l[a].name==e){for(var s=0;s<l[a].options.length;s++)"chosen"!=(i=n.getStateWithId(l[a].options[s].ruleId))&&"chosenInConflict"!=i&&"default"!=i&&"defaultInConflict"!=i&&"required"!=i||r++;if(!this.onWinEnv()&&l[a].keyInType&&"Blank"!=l[a].keyInType){var d=n.getStateWithId("KeyIn_"+l[a].ruleId);"chosen"!=d&&"chosenInConflict"!=d||r++}r>1&&(o=!0);break}return o},askQuestionMarkReasonToSolver:function(e,i){var n=new t,l={x:e.getBoundingClientRect().left+"px",y:e.getBoundingClientRect().top-5+"px"};n.setCoordForTooltipIncompatibilities(l);var r={_from:"configurator",_to:"solverConfiguration",_request:"getResultingStatusOriginators",_data:i};returnFromWebService=this.sendTextToSolver(JSON.stringify(r)),null!=returnFromWebService&&require(["DS/ConfiguratorWebView/ConfigurationServices"],function(e){e.ApplyAnswer(returnFromWebService)}),this.createLoader()},onWinEnv:function(){return(new t).getOnWinEnv()},checkEnvWithUrl:function(){for(var e=new t,i=window.location.search.substring(1).split("&"),n=0;n<i.length;n++){var l=i[n].split("=");"onWinEnv"==l[0]&&("true"==l[1]?e.setOnWinEnv(!0):e.setOnWinEnv(!1))}},getIdWithFeatureAndOptionNames:function(e,i){for(var n=(new t).getDictionary().features,l=0;l<n.length;l++)if(n[l].name==e)for(var r=0;r<n[l].options.length;r++)if(n[l].options[r].name==i)return n[l].options[r].ruleId},sendTextToSolver:function(i,n){var l=new t;if(this.onWinEnv())l.getNodeSolver()&&l.getNodeSolver().sendText(l.getSolverId(),i);else if(parent.onWidgetLoad){var r=this.getHostURL()+"/resources/cfg/configurator/solver/computeAnswer",o=l.getSolverId();return e.Data.request(r,{method:"POST",type:"text/html",async:!0,timeout:864e5,onComplete:function(e){require(["DS/ConfiguratorWebView/ConfigurationServices"],function(t){t.ApplyAnswer(e,n)})},onFailure:function(e){console.log("@@@@@ computeAnswer error : "+JSON.parse(arguments[0]).message),alert("Application failed while computing Rules. Please contact your administrator.")},data:{solverId:o,selectedCriteria:i}}),void console.log("retResult"+void 0)}},getHostURL:function(){var e=location.pathname.substring(0,location.pathname.indexOf("/",1));return window.location.origin?location.origin.concat(e):(window.location.origin=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:""),window.location.origin.concat(e))},resizeWindow:function(e){var t=2*this.RetrieveElement("content").offsetLeft+(window.outerWidth-window.innerWidth),i=this.RetrieveElement("content").offsetWidth;window.parent.getTopWindow&&window.parent.getTopWindow().resizeTo(i+t,window.outerHeight),this.enableScrollInOptionPanel()},enableScrollInOptionPanel:function(){var e=this.RetrieveElement("myfeatureOptions");if(null!=e){var t=e.offsetleft,i=window.innerWidth-t-8;e.style.maxWidth=i+"px"}},getRealPath:function(t,i){var n;return n=i.getUrl(),e.Utils.buildUrl(this.removeParameterOfUrl(n),t)},removeParameterOfUrl:function(e){var t=e.split("?");if(t.length>0)return t[0]},setLanguageFile:function(i){new t;var l=n.getWebappsAssetUrl("ConfiguratorWebView","nls/langWW_"+i+".json"),r=!0;e.Data.request(l,{type:"json",method:"GET",async:!1,onComplete:function(t){r=!1,e.i18n(t)},onFailure:function(t,i){r=!1,e.i18n(i)},onCancel:function(){},onTimeout:function(e){}}),1==r&&"en"!=i&&this.setLanguageFile("en")},GetOptionsListForSpecifiedFeature:function(e){var i=[],n=(new t).getCacheOptionsIdWithFeatureId();for(options in n)n[options]==e&&options!=e&&i.push(options);return i},setDefaultOptions:function(){for(var e=new t,i=e.getDictionary().features,n=0;n<i.length;n++)for(var l=0;l<i[n].options.length;l++)this.isDefault(i[n].options[l].ruleId)&&e.setStateWithId(i[n].options[l].ruleId,"default")},CheckRulesConsistency:function(){returnFromWebService=this.sendTextToSolver(JSON.stringify({_from:"configurator",_to:"solverConfiguration",_request:"checkModelConsistency",_data:""})),this.RetrieveElement("content")&&this.createLoader(),null!=returnFromWebService&&require(["DS/ConfiguratorWebView/ConfigurationServices"],function(e){e.ApplyAnswer(returnFromWebService)})},setAlwaysDiagnosed:function(){for(var e=[],i=(new t).getDictionary().features,n=0;n<i.length;n++)e.push(i[n].ruleId);var l={_from:"configurator",_to:"solverConfiguration",_request:"setAlwaysDiagnosed",_data:{alwaysDiagnosedIds:e}};returnFromWebService=r.sendTextToSolver(JSON.stringify(l)),null!=returnFromWebService&&require(["DS/ConfiguratorWebView/ConfigurationServices"],function(e){e.ApplyAnswer(returnFromWebService)})},showInfoBox:function(e,t){var i=this.RetrieveElement("InfoBox"),n=this.RetrieveElement("TextInfoBox"),l=this.RetrieveElement("IconInfoBox");if(i&&"InfoBoxHidden"==i.value&&n)n.innerHTML=e,l.value=t,l.src=this.getImgPath(t),i.style.top="-"+i.offsetHeight+"px",i.value="InfoBoxVisible";else if(i&&"InfoBoxVisible"==i.value&&n)this.deleteInfoBox(),this.showInfoBox(e,t);else if(!i){var r=this.CreateElement("div");r.id="InfoBox",(l=this.CreateElement("img")).id="IconInfoBox",l.value=t,l.src=this.getImgPath(t);var o=this.CreateElement("div");o.id="TextInfoBox";var a=this.CreateElement("img");a.id="CloseInfoBox",a.src=this.getImgPath("close"),a.onclick=this.hideInfoBox(),r.appendChild(l),r.appendChild(o),r.appendChild(a),this.RetrieveElement("content").appendChild(r);var s=this.RetrieveElement("InfoBox");this.RetrieveElement("TextInfoBox").innerHTML=e,s.style.top="-"+s.offsetHeight+"px",s.value="InfoBoxVisible";var d=this;this.addEvent("click",this.RetrieveElement("CloseInfoBox"),function(){d.hideInfoBox()})}},hideInfoBox:function(){var i=new t,n=this.RetrieveElement("InfoBox");n&&(n.style.top="10px",n.value="InfoBoxHidden",this.RetrieveElement("TextInfoBox").innerHTML==e.i18n("InfoMultiSelAndRules")&&(i._showWarningInfoBox=!1))},deleteInfoBox:function(){this.RetrieveElement("InfoBox")&&this.RemoveElement("InfoBox")},setConfCriteriaFromXMLVar:function(e){var n,l,r,o,a=new t,s=new i("FilterExpression"),d=s.xmlToJson(s.parseXml(e));if(a.EmptyCacheIdWithState(),(o=d.CfgFilterExpression.FilterSelection.Context?d.CfgFilterExpression.FilterSelection.Context:d.CfgFilterExpression.FilterSelection).Feature){var c=o.Feature.length;if(null==c){featureName=o.Feature.attributes.Name,null==(r=o.Feature.Feature.length)&&(optionName=o.Feature.Feature.attributes.Name,o.Feature.Feature.attributes.SelectedBy?"User"==(l=o.Feature.Feature.attributes.SelectedBy)?n="chosen":"Rule"==l?n="required":"Default"==l&&(n="default"):n="chosen",a.setStateWithId(this.getIdWithFeatureAndOptionNames(featureName,optionName),n));for(var u=0;u<r;u++)optionName=o.Feature.Feature[u].attributes.Name,o.Feature.Feature[u].attributes.SelectedBy?"User"==(l=o.Feature.Feature[u].attributes.SelectedBy)?n="chosen":"Rule"==l?n="required":"Default"==l&&(n="default"):n="chosen",a.setStateWithId(this.getIdWithFeatureAndOptionNames(featureName,optionName),n)}for(var p=0;p<c;p++){featureName=o.Feature[p].attributes.Name,null==(r=o.Feature[p].Feature.length)&&(optionName=o.Feature[p].Feature.attributes.Name,o.Feature[p].Feature.attributes.SelectedBy?"User"==(l=o.Feature[p].Feature.attributes.SelectedBy)?n="chosen":"Rule"==l?n="required":"Default"==l&&(n="default"):n="chosen",a.setStateWithId(this.getIdWithFeatureAndOptionNames(featureName,optionName),n));for(u=0;u<r;u++)optionName=o.Feature[p].Feature[u].attributes.Name,o.Feature[p].Feature[u].attributes.SelectedBy?"User"==(l=o.Feature[p].Feature[u].attributes.SelectedBy)?n="chosen":"Rule"==l?n="required":"Default"==l&&(n="default"):n="chosen",a.setStateWithId(this.getIdWithFeatureAndOptionNames(featureName,optionName),n)}}if(o.NOT){var g=o.NOT.length;if(null==g)if(featureName=o.NOT.Feature.attributes.Name,null==o.NOT.Feature.Feature.length)optionName=o.NOT.Feature.Feature.attributes.Name,o.NOT.Feature.Feature.attributes.SelectedBy?"User"==(l=o.NOT.Feature.Feature.attributes.SelectedBy)?n="dismissed":"Rule"==l&&(n="incompatible"):n="dismissed",a.setStateWithId(this.getIdWithFeatureAndOptionNames(featureName,optionName),n);else for(var f=0;f<o.NOT.Feature.Feature.length;f++)optionName=o.NOT.Feature.Feature[f].attributes.Name,o.NOT.Feature.Feature[f].attributes.SelectedBy?"User"==(l=o.NOT.Feature.Feature[f].attributes.SelectedBy)?n="dismissed":"Rule"==l&&(n="incompatible"):n="dismissed",a.setStateWithId(this.getIdWithFeatureAndOptionNames(featureName,optionName),n);for(p=0;p<g;p++)if(featureName=o.NOT[p].Feature.attributes.Name,null==o.NOT[p].Feature.Feature.length)optionName=o.NOT[p].Feature.Feature.attributes.Name,o.NOT[p].Feature.Feature.attributes.SelectedBy?"User"==(l=o.NOT[p].Feature.Feature.attributes.SelectedBy)?n="dismissed":"Rule"==l&&(n="incompatible"):n="dismissed",a.setStateWithId(this.getIdWithFeatureAndOptionNames(featureName,optionName),n);else for(f=0;f<o.NOT[p].Feature.Feature.length;f++)optionName=o.NOT[p].Feature.Feature[f].attributes.Name,o.NOT[p].Feature.Feature[f].attributes.SelectedBy?"User"==(l=o.NOT[p].Feature.Feature[f].attributes.SelectedBy)?n="dismissed":"Rule"==l&&(n="incompatible"):n="dismissed",a.setStateWithId(this.getIdWithFeatureAndOptionNames(featureName,optionName),n)}},CheckIfDismissedIsPossible:function(e){for(var i,n=new t,l=n.getDictionary().features,r=n.getFeatureIdWithOptionId(e),o=!1,a=0;a<l.length;a++)if(l[a].ruleId===r){if("May"===l[a].selectionCriteria)return o=!0;for(var s=0;s<l[a].options.length;s++)if(l[a].options[s].ruleId!==e&&"dismissed"!==(i=n.getStateWithId(l[a].options[s].ruleId))&&"incompatible"!==i)return o=!0;break}return o},isIncompatibleWithUserSelection:function(e){for(var i,n=new t,l=n.getDictionary().features,r=0;r<l.length;r++)if(l[r].ruleId===e){for(var o=0;o<l[r].options.length;o++)if("dismissed"===(i=n.getStateWithId(l[r].options[o].ruleId))||"dismissedInConflict"===i)return!0;break}return!1},setWidget:function(e){(new t).setWidget(e)},orderOptionsPanel:function(){for(var e=new t,i=document.getElementById("tableOptionsAttr"),n=i.getElementsByTagName("tr"),l=0,r=n.length;l<r;l++){var o=n[l].children[0].children[1].children[0].id.split("_")[1];if("incompatible"==e.getStateWithId(o)){var a=n[l].parentNode.removeChild(n[l]);i.appendChild(a)}}},updateWebViewerWidthInNativeEnv:function(e){if(e)this.send_notif("SetFullScreenOnWebViewer");else if(!e){var t=this;setTimeout(function(){var e,i=0,n=0,l=0,o=0,a=0;r.RetrieveElement("configPanel").offsetWidth>30&&(i=r.RetrieveElement("configPanel").offsetWidth+10),t.RetrieveElement("myfeatureOptions")&&(n=t.RetrieveElement("myfeatureOptions").getBoundingClientRect().right+10),r.RetrieveElement("redQuestionMarkTooltip")&&(o=t.RetrieveElement("redQuestionMarkTooltip").getBoundingClientRect().right+10),r.RetrieveElement("questionMarkTooltip")&&(l=t.RetrieveElement("questionMarkTooltip").getBoundingClientRect().right+10),r.RetrieveElement("popupDebug")&&(a=t.RetrieveElement("popupDebug").getBoundingClientRect().right+10),e=Math.max(i,n,o,l,a),t.send_notif("UpdateWebViewerWidth:"+e)},200)}},htmlDecode:function(e){var t=e.toString();return t=(t=(t=(t=(t=t.replace(/&amp;/g,"&")).replace(/&lt;/g,"<")).replace(/&gt;/g,">")).replace(/&quot;/g,'"')).replace(/&#39;/g,"'")},htmlEncode:function(e){var t=e.toString();return t=(t=(t=(t=(t=t.replace(/&/g,"&amp;")).replace(/>/g,"&gt;")).replace(/</g,"&lt;")).replace(/\"/g,"&quot;")).replace(/\'/g,"&#39;")},moveDebugPopup:function(e){var t=document.getElementById("popupDebug");t.style.left=e.clientX-200+"px",t.style.top=e.clientY-10+"px"}};return e.namespace("DS/ConfiguratorWebView/Utilities",r)});