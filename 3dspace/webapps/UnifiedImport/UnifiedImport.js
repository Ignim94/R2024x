define("DS/UnifiedImport/views/FilesView",["DS/DataGridView/DataGridView"],e=>{return{dgv:void 0,datagrid:function(){let t=new e({sortModel:[{dataIndex:"statusValue",sort:"desc"}],columns:[{dataIndex:"fileName",typeRepresentation:"detailedInfo",getCellValue:function(e){if(e.nodeModel)return{icon:{iconName:"doc",iconStyle:1},label:e.nodeModel.getName(),subLabel:e.nodeModel.getFormattedSize()}}},{dataIndex:"status",typeRepresentation:"string",tooltip:"",width:"100px",getCellSemantics:function(e){switch(e.nodeModel.options.grid.statusValue){case 0:return{icon:"ignore wux-ui-3ds",emphasize:"error"};case 1:return{icon:"status-ok wux-ui-3ds",emphasize:"success"};default:return{icon:"status-ok-ongoing wux-ui-3ds",emphasize:"primary"}}}},{dataIndex:"statusValue",typeRepresentation:"number",visibleFlag:!1}],getCellTooltip:function(e){if(e&&1==e.columnID&&e.cellModel)return{shortHelp:e.nodeModel.tooltipValue}}});return t.layout.cellHeight=40,t.rowSelection="multiple",t.columnSelection="none",t.cellSelection="none",t.layout.columnsHeader=!1,t.layout.rowsHeader=!1,t.showRowIndexFlag=!1,t.showSelectionCheckBoxesFlag=!0,t.layout.collectionView.showRowBorderFlag=!0,t.getContent().style.position="relative",this.dgv=t,t}}}),define("DS/UnifiedImport/utils/Essentials",["UWA/Class","DS/Utilities/UUID","DS/WAFData/WAFData","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","DS/Notifications/NotificationsManagerUXMessages","DS/Notifications/NotificationsManagerViewOnScreen","DS/Utilities/WebUXColorEnums","text!DS/UnifiedImport/assets/config/UnifiedImport.json","i18n!DS/UnifiedImport/assets/nls/UnifiedImportNLS"],(e,t,i,n,o,r,s,a,l)=>{UWA.i18n(l);let d=require.toUrl("");return d=d.substr(0,d.lastIndexOf("?")),e.singleton({isInitialized:!1,x3dPlatformId:"undefined"!=typeof widget&&widget.environment?widget.environment.getAllData().x3dPlatformId:void 0,DEPLOYMENT:"/webapps",APP_TITLE_MAIN:"Engineering Import",APP_TITLE_CONTENT_IMPORTED:"Imported Content",SERVICE_DFS:"distributedfilestore",SERVICE_3DSPACE:"3DSpace",URL_BASE:d,URL_SECURITY_CONTEXT:"/resources/pno/person/getsecuritycontext",URL_FCS:"/fcs/servlet/fcs/checkin",SERVER:{VERB:{GET:"GET",POST:"POST",PATCH:"PATCH",DELETE:"DELETE"},DEFAULT_HEADERS:{Accept:"application/json","Accept-Language":window.widget?window.widget.lang:"en","Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"}},LANG:window.widget?window.widget.lang:"en",EVENT_CONTENT:"content",EVENT_CONTENT_SELECTED:"contentselected",EVENT_CONTENT_SCAN_START:"contentscanstart",EVENT_CONTENT_SCAN_END:"contentscanend",EVENT_CONTENT_ANALYZED:"contentanalyzed",EVENT_LOAD_METHOD_SUCCEEDED:"loadmethodsucceeded",EVENT_METHOD_SELECTED:"methodselected",EVENT_METHOD_FOUND:"methodfound",EVENT_METHODS_FOUND:"methodsfound",EVENT_METHODS_LISTED:"methodslisted",EVENT_NO_METHOD_FOUND:"nomethodfound",EVENT_LOAD_METHOD_SUCCESS:"loadmethodsuccess",EVENT_LOAD_METHOD_FAILED:"loadmethodfailed",EVENT_NEW_IMPORT:"newimport",EVENT_CONTENT_APPROVED:"contentapproved",EVENT_CONTENT_PARTIALLY_APPROVED:"contentpartiallyapproved",EVENT_CONTENT_DISAPPROVED:"contentdisapproved",EVENT_CHECKIN_URL_FOUND:"checkinurlfound",EVENT_START_CHECKIN:"startcheckin",EVENT_CHECKIN_SUCCEEDED:"checkinsucceeded",EVENT_CHECKIN_FAILED:"checkinfailed",EVENT_CHECKIN_TIMEOUT:"checkintimedout",EVENT_CONTENT_UPLOADED:"contentuploaded",EVENT_START_EXCHANGE:"startexchange",EVENT_EXCHANGE_REQUEST_SUCCEEDED:"exchangerequestsucceeded",EVENT_EXCHANGE_REQUEST_FAILED:"exchangerequestfailed",EVENT_EXCHANGE_NETWORK_ERROR:"networkerror",EVENT_EXCHANGE_CANCEL:"exchangecancel",EVENT_ERROR_OCCURRED:"erroroccurred",STATUS_CODES:{PRIVATE:{emphasize:"highlight",backgroundColor:s.COLORS_STATUS.COLOR_PURPLE_FOR_WHITE_LABEL,nlsKey:"importresults.grid.column.status.private"},IN_WORK:{emphasize:"primary",nlsKey:"importresults.grid.column.status.inwork"},FROZEN:{emphasize:"success",nlsKey:"importresults.grid.column.status.frozen"},RELEASED:{emphasize:"",nlsKey:"importresults.grid.column.status.released"},OBSOLETE:{emphasize:"highlight",backgroundColor:s.COLORS_STATUS.COLOR_SECTION_GRAY,nlsKey:"importresults.grid.column.status.obsolete"}},MAX_FILE_SIZE_GB:1,MAX_CONTENT_SIZE_BYTES:1073741824,setup:function(){let e=this;return new UWA.Promise.all([e.getPlatformServices().then(e.getSecurityContexts.bind(null,e)).then(e.getGrantedRoles.bind(null,e)).then(e.methods.bind(null,e))])},getPlatformServices:function(){let e=this;return new UWA.Promise(function(t,i){n.getPlatformServices({onComplete:e.postGetPlatformServices.bind(null,e,t)})})},postGetPlatformServices:function(e,t,i){let n=i.find(function(t){return t.platformId==e.x3dPlatformId});n||(n=i[0]),e.PLATFORM_SERVICES=n,t(e.PLATFORM_SERVICES)},getSecurityContexts:function(e){return new UWA.Promise(function(t,n){i.authenticatedRequest(e.PLATFORM_SERVICES["3DSpace"]+e.URL_SECURITY_CONTEXT+"?tenant="+e.x3DPLATFORMID,{method:"GET",type:"json",proxy:"passport",onComplete:e.postGetSecurityContext.bind(null,e,t)})})},postGetSecurityContext:function(e,t,i){e.SECURITY_CONTEXT=i.SecurityContext,t()},getGrantedRoles:function(e){return new UWA.Promise(function(t,i){n.getGrantedRoles(e.postGetGrantedRoles.bind(null,e,t))})},postGetGrantedRoles:function(e,t,i){e.GRANTED_ROLES=i,t()},methods:function(e){e.METHODS=JSON.parse(a),e.METHODS_PREDICTABLE=[],e.METHODS_UNPREDICTABLE=[],e.METHODS.forEach(t=>{if(e.GRANTED_ROLES.some(function(e){return t.roles.indexOf(e.id)>-1}))if(t.import.validate){var i=t.import.validate["limited-availability"];if(i&&!e.hasParam(i))return;t.import.validate.methodIdentifier?e.METHODS_PREDICTABLE.push(t):e.METHODS_UNPREDICTABLE.push(t)}else e.METHODS_UNPREDICTABLE.push(t)})},extension:function(e){return e.substring(e.lastIndexOf(".")+1,e.length).toLowerCase()},server:function(e){var t={url:e.url,method:e.method||this.SERVER.VERB.GET,data:e.data,dataType:e.dataType||"json",timeout:e.timeout||5e5,cache:e.cache||3600,proxy:e.proxy||void 0,onComplete:e.onComplete,onFailure:e.onFailure,headers:e.headers&&UWA.merge(e.headers,this.SERVER.DEFAULT_HEADERS)||this.SERVER.DEFAULT_HEADERS};return i.authenticatedRequest(t.url,t)},unique:function(){return t.v4().substring(0,10).replaceAll("-","")},noop:function(){},formatBytes:function(e,t=2){if(!+e)return"0 Bytes";const i=t<0?0:t,n=Math.floor(Math.log(e)/Math.log(1024));return`${parseFloat((e/Math.pow(1024,n)).toFixed(i))} ${["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][n]}`},hasParam:function(e){var t=window.location.search,i=new URLSearchParams(t);return!(!i||!i.has("widgetDomain"))&&(i=i.get("widgetDomain"),(i=new URL(i)).searchParams.has(e))},setContext:function(e){this._contextData=Object.assign({},e)}})}),define("DS/UnifiedImport/utils/NotificationUtils",["UWA/Class","DS/Notifications/NotificationsManagerUXMessages","DS/Notifications/NotificationsManagerViewOnScreen"],(e,t,i)=>e.singleton({Content:{NO_METHOD:{title:"unifiedImport.notification.error.noMethod",subtitle:"unifiedImport.notification.error.noMethod.subtitle",message:"",level:"error"},INVALID_METHOD:{title:"unifiedImport.notification.error.invalidMethod",subtitle:"unifiedImport.notification.error.invalidMethod.subtitle",message:"",level:"error"},CONTENT_DISAPPROVED:{title:"unifiedImport.notification.error.contentDisapproved",subtitle:"unifiedImport.notification.error.contentDisapproved.subtitle",message:"",level:"error"},CONTENT_UPLOADED:{title:"",subtitle:"",message:"unifiedImport.notification.info.contentUploaded",level:"info"},PROCESS_SUCCEEDED:{title:"",subtitle:"",message:"unifiedImport.notification.success.processSucceeded",level:"success"},PROCESS_FAILED:{title:"",subtitle:"",message:"unifiedImport.notification.error.processFailed",level:"error"},CHECKIN_TIMEOUT:{title:"unifiedImport.notification.error.timeout",subtitle:"unifiedImport.notification.error.timeout.subtitle",message:"unifiedImport.notification.error.timeout.message",level:"error"},CHECKIN_FAILED:{title:"",subtitle:"",message:"unifiedImport.notification.error.checkinFailed",level:"error"},CHECKIN_NETWORK_ERROR:{title:"unifiedImport.notification.error.networkError",subtitle:"unifiedImport.notification.error.networkError.subtitle",message:"",level:"error"},CHECKIN_MAX_FILE_SIZE_REACHED:{title:"unifiedImport.notification.error.maxFileSize",subtitle:"unifiedImport.notification.error.maxFileSize.subtitle",message:"",level:"error"},DRIVE_IMPORT_ERROR:{title:"",subtitle:"",message:"unifiedImport.notification.error.driveImportError",level:"error"},CHECKIN_FAILED_AT_IMPORTER:{fromImporter:!0,title:"",subtitle:"",message:"",level:"error"},CHECKIN_MAX_NO_OF_FILES_REACHED:{fromImporter:!0,title:"",subtitle:"",message:"",level:"error"}},init:function(arguments){this._parent(arguments),i.setNotificationManager(t),i.setFadeOutPolicy(2),i.setStackingPolicy(5)},formatAlertOpts:(e,t)=>(e.title&&(t&&t.payLoad&&t.payLoad.title&&t.payLoad.title.length?e.title=UWA.String.format(UWA.i18n(e.title),...t.payLoad.title):e.title=UWA.i18n(e.title)),e.subtitle&&(t&&t.payLoad&&t.payLoad.subtitle&&t.payLoad.subtitle.length?e.subtitle=UWA.String.format(UWA.i18n(e.subtitle),...t.payLoad.subtitle):e.subtitle=UWA.i18n(e.subtitle)),e.message&&(t&&t.payLoad&&t.payLoad.message&&t.payLoad.message.length?e.message=UWA.String.format(UWA.i18n(e.message),...t.payLoad.message):e.message=UWA.i18n(e.message)),e),alert:function(e,i){return e.fromImporter?(e={...e,title:"Failure from import method",message:[...i.payLoad.message].join(" ")},i=void 0):e=this.formatAlertOpts(e,i),t.addNotif(e)}})),define("DS/UnifiedImport/views/Preview",["UWA/Class/View","DS/Controls/Button","DS/Windows/Dialog","DS/Windows/ImmersiveFrame"],(e,t,i,n)=>e.extend({__private__:{}},{tagName:"div",className:"exchange-results-view-preview",setup:function(){var e=this;require(["DS/UnifiedImportResults/views/CommonResults"],function(o){e.options.defaultColumns=!1;var r=new o(e.options),s=new n;s.inject(widget.body);var a=new i({title:UWA.i18n("unifiedImport.content.preview"),content:r,immersiveFrame:s,modalFlag:!0,usePaddingFlag:!0,resizableFlag:!0});if(a.addEventListener("close",function(){r.destroy(),a.destroy(),s.destroy(),e.container.empty(),e.destroy()}),r.isEditable()){var l=new t({label:UWA.i18n("unifiedImport.footer.action.save"),disabled:!0,onClick:function(){a.close(),r.options.treeDocument.acceptChanges()}}),d=new t({label:UWA.i18n("unifiedImport.footer.action.reset"),onClick:function(){r.options.treeDocument.cancelChanges()}}),c=new t({label:UWA.i18n("unifiedImport.footer.action.cancel"),onClick:function(){a.close()}});a.buttons={Ok:l,Save:d,Cancel:c},r.options.treeDocument.onNodeModelUpdate(function(e){l.disabled=!1})}else{l=new t({label:"Ok",onClick:function(){a.close()}});a.buttons={Ok:l}}})}})),define("DS/UnifiedImport/views/options/BookmarkPicker",["DS/Controls/Abstract","DS/Controls/Button","DS/Controls/LineEditor","DS/Windows/ImmersiveFrame","DS/Windows/Dialog","DS/FolderActive/FolderActive","DS/UnifiedImport/utils/Essentials"],(e,t,i,n,o,r,s)=>e.inherit({name:"bookmarkpicker",publishedProperties:{value:{defaultValue:void 0,type:"string"}},buildView:function(){this.setupPicker()},setupPicker:function(){var e=this,n=UWA.createElement("div",{styles:{display:"flex",gap:1}}).inject(e.elements.container);this.elements.inputField=new i({fireOnlyFromUIInteractionFlag:!0,disabled:!0,placeholder:UWA.i18n("unifiedImport.options.bookmark.placeholder")}).inject(n),this.elements.inputField.addEventListener("click",e.setupActiveBookmark.bind(null,e)),this.elements.inputField.getContent().style.width="100%",this.elements.inputField.getContent().getChildren()[0].style.borderTopRightRadius="0px",this.elements.inputField.getContent().getChildren()[0].style.borderBottomRightRadius="0px",this.elements.button=new t({label:UWA.i18n("unifiedImport.options.bookmark.browse")}).inject(n),this.elements.button.getContent().style.borderTopLeftRadius="0px",this.elements.button.getContent().style.borderBottomLeftRadius="0px",this.elements.button.addEventListener("buttonclick",e.setupActiveBookmark.bind(null,e))},setupActiveBookmark:function(e){let t;const i=new n({}),s=new r({multiSelectionComponent:{withClassify:!1,inputObjects:{authoring:!0,dialogButtons:!0,favoriteButton:!0,selectionMode:"DefaultSingle"}.objects},selectionMode:"DefaultSingle",authoring:!0,dialogButtons:!0,favoriteButton:!0});s.nestedMenuInContext.addEvent("onClassifyMultiple",function(t){e.elements.inputField.value=s.nestedMenuInContext._selectBookmarkLabel,e.value=t.chosenClasses[0],e.fire("change"),i.remove()}),s.nestedMenuInContext.addEvent("onSelectorCancel",function(e){i.remove()}),(t=new o({immersiveFrame:i,title:UWA.i18n("unifiedImport.options.bookmark.browse.title"),content:s.nestedMenuInContext.getMultiSelectorContainer(),activeFlag:!1,height:300,usePaddingFlag:!1,touchMode:!1})).addEventListener("close",()=>{t.destroy(),i.destroy()}),i.inject(widget.body)}})),define("DS/UnifiedImport/views/StatusBar",["UWA/Class/View","DS/Tweakers/GeneratedToolbar","DS/UnifiedImport/utils/Essentials"],(e,t,i)=>e.extend({className:"unifiedimport-statusbar",setup:function(e){this.treeDocument=e.treeDocument,this.setupStatusBar(),this.setupEvents()},setupStatusBar:function(){var e=t.prototype.createTreeDocument({entries:[{id:"uploadedNodes",dataElements:{typeRepresentation:"string",readOnly:!0,visibleFlag:!1,icon:{iconName:"check",iconStyle:1},emphasize:"success",position:"far"}},{id:"excludedNodes",dataElements:{typeRepresentation:"string",readOnly:!0,visibleFlag:!1,emphasize:"error",icon:{iconName:"ignore",iconStyle:1},position:"far"}}]});this.generatedToolbar=new t({overflowManagement:"dropdown",direction:"horizontal",items:e}),this.generatedToolbar.inject(this.container)},setupEvents:function(){var e=this;e.treeDocument._modelEvents.subscribe({event:i.EVENT_CONTENT_ANALYZED},e.updateStatus.bind(null,e)),e.treeDocument._modelEvents.subscribe({event:i.EVENT_CHECKIN_SUCCEEDED},e.updateProgressAndCheckInNodes.bind(null,e)),e.treeDocument._modelEvents.subscribe({event:i.EVENT_CHECKIN_FAILED},e.hideToolbar.bind(null,e)),e.treeDocument._modelEvents.subscribe({event:i.EVENT_CHECKIN_TIMEOUT},e.hideToolbar.bind(null,e)),e.treeDocument._modelEvents.subscribe({event:i.EVENT_ERROR_OCCURRED},e.hideToolbar.bind(null,e))},updateStatus:function(e,t){e.show();var i=t.invalidNodes.length;i&&e.generatedToolbar.updateNodeModel("excludedNodes",{visibleFlag:!0,grid:{visibleFlag:!0,data:`${i} ${UWA.i18n("unifiedImport.content.grid.tooltip.excluded")}`}})},updateProgressAndCheckInNodes:function(e,t){e.generatedToolbar.updateNodeModel("uploadedNodes",{visibleFlag:!0,grid:{data:`${t.totalCheckedInNodes} ${UWA.i18n("unifiedImport.content.grid.tooltip.uploaded")}`},icon:"wux-ui-3ds wux-ui-3ds-status-ok",emphasize:"success"})},hideToolbar:function(e){e.generatedToolbar.hide()}})),define("DS/UnifiedImport/utils/Validator",["UWA/Class","UWA/Class/Options","DS/UnifiedImport/utils/Essentials"],(e,t,i)=>e.extend(t,{init:function(e){e=e||{},this.setOptions(e)},getMaxNbOfFiles:function(){return this.options["max-nb-of-files"]},getMaxFileSize:function(){return this.options["max-file-size"]},getMaxFileNameSize:function(){return this.options["max-file-name-length"]},getValidExtensions:function(){return this.options.extensions},validateByMaxNbOfFiles:function(e){const t=this.getMaxNbOfFiles();if(t&&e.length>t)return UWA.String.format(UWA.i18n("unifiedImport.notification.error.maxNoOfFiles"),this.options["max-nb-of-files"])},validateConfig:function(e,t){const n=this.getMaxFileSize(),o=this.getMaxFileNameSize(),r=this.getValidExtensions(),s=e.getNameNoExt(),a=r&&"*"==r[0]||t;return!r||a||r.includes(e.getExtension())?n&&e.getSize()>n?UWA.String.format(UWA.i18n("unifiedImport.content.grid.tooltip.maxFileSize"),i.formatBytes(n)):o&&s.length>o?UWA.String.format(UWA.i18n("unifiedImport.content.grid.tooltip.maxFileNameLength"),o):void 0:UWA.i18n("unifiedImport.content.grid.tooltip.invalidExtension")}})),define("DS/UnifiedImport/views/Header",["UWA/Class/View","DS/Controls/ProgressBar","DS/UnifiedImport/utils/Essentials"],(e,t,i)=>e.extend({tagName:"div",className:"unifiedimport-header",setup:function(e){this.treeDocument=e.treeDocument,this.setupProgress(),this.setupEvents()},setupProgress:function(){this.progressbar=new t({displayStyle:"lite"}),this.progressbar.inject(this.container)},setupEvents:function(){var e=this;e.treeDocument._modelEvents.subscribe({event:i.EVENT_CHECKIN_SUCCEEDED},e.checkinSucceeded.bind(null,e)),e.treeDocument._modelEvents.subscribe({event:i.EVENT_CHECKIN_FAILED},e.hideView.bind(null,e)),e.treeDocument._modelEvents.subscribe({event:i.EVENT_ERROR_OCCURRED},e.hideView.bind(null,e)),e.treeDocument._modelEvents.subscribe({event:i.EVENT_START_EXCHANGE},e.startExchange.bind(null,e)),e.treeDocument._modelEvents.subscribe({event:i.EVENT_EXCHANGE_REQUEST_SUCCEEDED},e.hideView.bind(null,e)),e.treeDocument._modelEvents.subscribe({event:i.EVENT_EXCHANGE_REQUEST_FAILED},e.hideView.bind(null,e))},checkinSucceeded:function(e,t){e.show();var i=t.totalCheckedInNodes/t.totalNodes*100;e.progressbar.value=i},hideView:function(e){e.hide()},startExchange:function(e,t){e.progressbar.infiniteFlag=!0}})),define("DS/UnifiedImport/views/PotentialMethods",["UWA/Class/View","DS/Controls/Label","DS/Controls/ComboBox","DS/UnifiedExportCommand/Views/ParametersViewFactory","DS/UnifiedImport/utils/Essentials"],(e,t,i,n,o)=>{var r,s;return e.extend({__private__:{}},{className:"unifiedimport-potential-methods",setup:function(e){r=s=void 0,this.treeDocument=e.treeDocument,(r=UWA.createElement("div",{})).hide(),r.inject(this.container),this.setupEvents()},setupEvents:function(){var e=this;e.treeDocument._modelEvents.subscribe({event:o.EVENT_METHODS_FOUND},e.methodsFound.bind(null,e)),e.treeDocument._modelEvents.subscribe({event:o.EVENT_METHOD_FOUND},e.methodFound.bind(null,e))},methodsFound:function(e,t){e.potentialmethodscombo(t)},methodFound:function(e,t){(t=UWA.clone(t)).selected=!0,e.potentialmethodscombo([t]).disabled=!0},potentialmethodscombo:function(e){var n=this;if(!s){n.__private__.methods=e,r.show();var o=new t({value:UWA.i18n("unifiedImport.header.title.importmethod")}).inject(r);o.getContent().style.background="transparent",o.getContent().style.fontWeight="bold",(s=new i({placeholder:UWA.i18n("unifiedImport.content.potentialmethods.placeholder"),elementsList:n.__private__.methods})).addEventListener("change",n.methodSelected.bind(null,n)),s.value=1==n.__private__.methods.length&&n.__private__.methods[0].value,s.inject(r),s.getContent().style.width="100%"}return s},methodSelected:function(e,t){t.target.dsModel.disabled=!0;var i=t.target.dsModel.selectedIndex;e.treeDocument._modelEvents.publish({event:o.EVENT_METHOD_SELECTED,data:e.__private__.methods[i]})}})}),define("DS/UnifiedImport/views/DragZone",["UWA/Class/View","DS/Controls/Toolbar","DS/Controls/Button","DS/UnifiedImport/utils/Essentials"],(e,t,i,n)=>{var o,r,s;return e.extend({__private__:{}},{className:"unifiedimport-dragzone",setup:function(e){this.treeDocument=e.treeDocument,this.setupDragText(),this.setupToolbar(),this.setupEvents()},setupToolbar:function(){var e=this;e.__private__.toolbar=new t({}),e.__private__.toolbar.inject(o),e.__private__.browseFile=UWA.createElement("input",{class:"unifiedimport-dragzone-input-file",type:"file",multiple:!0}),e.__private__.btnBrowseFiles=new i({emphasize:"primary",label:UWA.i18n("unifiedImport.action.filesOnDisk")}),e.__private__.browseFolder=UWA.createElement("input",{class:"unifiedimport-dragzone-input-folder",type:"file",webkitdirectory:!0}),e.__private__.btnBrowseFolder=new i({label:UWA.i18n("unifiedImport.action.folderOnDisk")}),e.__private__.toolbar.add("element",{element:e.__private__.btnBrowseFiles.getContent(),position:"center"}),e.__private__.toolbar.add("element",{element:e.__private__.btnBrowseFolder.getContent(),position:"center"})},setupDragText:function(){o=UWA.createElement("div",{class:"unifiedimport-dragzone-gridcontent"}).inject(this.container),r=UWA.createElement("h3",{class:"wux-ui-3ds wux-ui-3ds-drag-drop unifiedimport-dragzone-dragehereicon"}).inject(o),s=UWA.createElement("p",{class:"unifiedimport-dragzone-drageheretext lead",text:UWA.i18n("unifiedImport.action.info.browseContent")}).inject(o)},setupEvents:function(){var e=this;[{key:"dragevent",fn:e.activateZone.bind(null,e)},{key:"dragover",fn:e.activateZone.bind(null,e)},{key:"dragleave",fn:e.deActivateZone.bind(null,e)},{key:"drop",fn:e.drop.bind(null,e)}].forEach(t=>{e.container.addEventListener(t.key,t.fn)}),e.__private__.btnBrowseFiles.addEventListener("click",function(){e.__private__.browseFile.click()}),e.__private__.browseFile.addEventListener("change",e.change.bind(null,e)),e.__private__.btnBrowseFolder.addEventListener("click",function(){e.__private__.browseFolder.click()}),e.__private__.browseFolder.addEventListener("change",e.change.bind(null,e))},activateZone:function(e,t){e.container.classList.add("unifiedimport-dragzone-activated"),o.classList.add("unifiedimport-dragzone-gridcontent-activated"),r.classList.add("unifiedimport-dragzone-dragehereicon-activated"),s.classList.add("unifiedimport-dragzone-drageheretext-activated"),t.preventDefault()},deActivateZone:function(e){e.container.classList.remove("unifiedimport-dragzone-activated"),o.classList.remove("unifiedimport-dragzone-gridcontent-activated"),r.classList.remove("unifiedimport-dragzone-dragehereicon-activated"),s.classList.remove("unifiedimport-dragzone-drageheretext-activated")},drop:function(e,t){e.deActivateZone(e),e.change(e,t)},change:function(e,t){var i,o;t.preventDefault();var r=t&&t.dataTransfer&&t.dataTransfer.items;if(r&&r.length){if(t.dataTransfer.getData("text/plain"))(o=JSON.parse(t.dataTransfer.getData("text/plain"))).data.items.length&&e.treeDocument._modelEvents.publish({event:n.EVENT_CONTENT_SELECTED,data:o});else if(r.length){var s=r.length;i=[],e.maxdepth=0;for(var a=0;a<s;a++){var l=r[a],d=l.webkitGetAsEntry(),c=[];if(d.isDirectory)c.push(new UWA.Promise(t=>{e.extractFiles(d).then(i=>{t(i.flat(e.maxdepth))})}));else{let e=l.getAsFile();e.fullPath=d.fullPath,i.push(e)}}UWA.Promise.all(c).then(function(t){t=t.flat(),i=i.concat(t),e.treeDocument._modelEvents.publish({event:n.EVENT_CONTENT_SELECTED,data:i})})}}else if(i=t&&t.currentTarget&&t.currentTarget.files){for(let e=0;e<i.length;e++)i[e].fullPath=i[e].webkitRelativePath;e.treeDocument._modelEvents.publish({event:n.EVENT_CONTENT_SELECTED,data:i})}},extractFiles:function(e){var t=this;const i=e.createReader();return new Promise((e,n)=>{const o=[];!function r(){i.readEntries(i=>{i.length?(o.push(Promise.all(i.map(e=>{var i=e.fullPath,n=i.split("/").length+1;return t.maxdepth<n&&(t.maxdepth=n),e.isFile?new Promise((t,n)=>e.file(function(e){e.fullPath=i,t(e)},n)):t.extractFiles(e)}))),r()):Promise.all(o).then(function(i){e(i.flat(t.maxdepth))})},e=>n(e))}()})}})}),define("DS/UnifiedImport/models/FileNodeModel",["UWA/Class","DS/TreeModel/TreeNodeModel","DS/Utilities/UUID","DS/UnifiedImport/utils/Essentials"],(e,t,i,n)=>(t=t.extendNode({setup:function(e){this.__private__={},this.__private__.file=e,this.__private__.name=e.name,this.__private__.extension=e.name.substring(e.name.lastIndexOf(".")+1,e.name.length).toLowerCase(),this.__private__.nameNoExt=e.name.slice(0,e.name.lastIndexOf("."))},getNameNoExt:function(){return this.__private__.nameNoExt},getName:function(){return this.__private__.name},getFormattedSize:function(){return n.formatBytes(this.__private__.file.size)},getSize:function(){return this.__private__.file.size},getFile:function(){return this.__private__.file},getExtension:function(){return this.__private__.extension},isIterated:function(){return this.iterated},setAsValidated:function(){this.iterated=!0},setTooltipValue:function(e){this.tooltipValue=e}}),e.singleton({create:function(e){var i=new t;return i.setup(e),i}}))),define("DS/UnifiedImport/views/ImportOptions",["UWA/Class/View","DS/UnifiedExportCommand/Views/ParametersViewFactory","DS/UnifiedImport/utils/Essentials"],(e,t,i)=>e.extend({className:"unifiedimport-options",setup:function(){this.__private__={},this.setupEvents()},setupEvents:function(){this.options.treeDocument._modelEvents.subscribe({event:i.EVENT_CONTENT_APPROVED},this.setupOptions.bind(null,this))},setupOptions:function(e){var t=e.options.treeDocument.fields;"array"==UWA.typeOf(t)?e.buildOptions(t):"function"==UWA.typeOf(t)&&t({platformServices:i.PLATFORM_SERVICES,securityContext:i.SECURITY_CONTEXT}).then(t=>{e.buildOptions(t)})},buildOptions:function(e){var i=this;e=i.refineOptions(e),optionsView=t.build(e),optionsView.listenTo(optionsView.model,"onChange",function(e){i.options.treeDocument.__private__.payload.options=e._attributes}),optionsView.inject(i.container)},refineOptions:function(e){return e.map(e=>("bookmark"==e.key&&(e={key:"bookmark",label:UWA.i18n("unifiedImport.options.bookmark.label"),help:UWA.i18n("unifiedImport.options.bookmark.help"),type:"DS/UnifiedImport/views/options/BookmarkPicker"}),e))}})),define("DS/UnifiedImport/models/FileTreeDocument",["DS/WAFData/WAFData","DS/TreeModel/TreeDocument","DS/UnifiedExchangeAnalytics/Tracker","DS/UnifiedImport/models/FileNodeModel","DS/UnifiedImport/utils/Validator","DS/UnifiedImport/utils/Essentials","DS/UnifiedImport/utils/NotificationUtils"],(e,t,i,n,o,r,s)=>t.extend({toNodes:function(e,t){e.setupSubscription(),e.__private__={validate:{"max-content-size":0},payload:{title:"",rootFile:"",rootFiles:[],fileIds:[],receipts:[],options:{}}},e.validNodes=[],e.invalidNodes=[],e.checkInObjectList=[],e.checkInTicketObjectList=[],e.totalCheckedInNodes=0,e.protocol=t.protocol,t=t.data&&t.data.items||t;var i=new Set,o=t.length;if(o){var a,l,d=performance.now();if(e.prepareUpdate(),e.protocol)return void e._modelEvents.publish({event:r.EVENT_ERROR_OCCURRED,data:{errorType:s.Content.DRIVE_IMPORT_ERROR}});for(let d=0;d<o;d++){if(a=t[d],e.__private__.validate["max-content-size"]+=a.size,e.__private__.validate["max-content-size"]>=r.MAX_CONTENT_SIZE_BYTES)return e._modelEvents.publish({event:r.EVENT_ERROR_OCCURRED,data:{errorType:s.Content.CHECKIN_MAX_FILE_SIZE_REACHED}}),void e.cancel(e);l=a.name,"";var c=r.extension(l);i.add(c);var u=n.create(a);e.addRoot(u)}e.pushUpdate();var p=performance.now();console.log("Build Tree Document - "+(p-d)),e.defaultMethod(Array.from(i)),e._modelEvents.publish({event:r.EVENT_CONTENT_SCAN_END})}},setupSubscription:function(){var e=this;e._modelEvents.subscribe({event:r.EVENT_METHOD_SELECTED},e.methodSelected.bind(null,e)),e._modelEvents.subscribe({event:r.EVENT_CONTENT_APPROVED},e.contentApproved.bind(null,e)),e._modelEvents.subscribe({event:r.EVENT_CHECKIN_SUCCEEDED},e.checkinSucceeded.bind(null,e)),e._modelEvents.subscribe({event:r.EVENT_CHECKIN_FAILED},e.checkinFailed.bind(null,e)),e._modelEvents.subscribe({event:r.EVENT_CHECKIN_TIMEOUT},e.checkinFailed.bind(null,e))},getMethod:function(e,t){return e.length?e:t.length?t:void 0},defaultMethod:function(e){var t=this,i=r.METHODS_PREDICTABLE.filter(t=>e.some(e=>{if(t.import.validate)return t.import.validate.methodIdentifier.some(t=>t.primary&&t.primary.toLowerCase()===e.toLowerCase())}));(i=t.getMethod(i,r.METHODS_UNPREDICTABLE))?(t._modelEvents.publish({event:r.EVENT_NEW_IMPORT}),"array"==UWA.typeOf(i)?t._modelEvents.publish({event:r.EVENT_METHODS_FOUND,data:i}):t._modelEvents.publish({event:r.EVENT_METHOD_FOUND,data:i})):t._modelEvents.publish({event:r.EVENT_NO_METHOD_FOUND})},methodSelected:function(e,t){e.__private__.method=t,e.switchBaseUrl(t),require([["DS",t.import["import-ui"]["module-directory"],t.import["import-ui"]["module-name"]].join("")],t=>{e.validate=t.validate?t.validate:null,e.upload=t.upload?t.upload:null,e.fields=t.fields?t.fields:void 0,e.transform=t.transform?t.transform:null,e.parse=t.parse?t.parse:null,e.validateByImporter()},t=>{e._modelEvents.publish({event:r.EVENT_LOAD_METHOD_FAILED})})},isExtensionSelected:function(e,t){return!0===t[e]},matchingFileAny:function(e){let t,i=this,n=i.validate,r=new o(n);const s=e.node.getNameNoExt();let a=e.nodes.find(t=>{let i=r.validateConfig(t);if(i){const e=i||UWA.i18n("unifiedImport.content.grid.tooltip.groupByGeneralErrorMessage");node.setAsValidated(),node.setTooltipValue(e)}else{const i=t.getExtension(),n=t.getNameNoExt();if(e.method.secondary.includes(i)&&n==s)return t}});return a&&(a.setAsValidated(),i.validNodes.push(e.node,a),t=e.maxNbOfPriors?e.maxNbOfPriors-1:0),e.node.setAsValidated(),t},matchingFileAll:function(e){let t,i=this,n=i.validate,r=new o(n),s=e.method.secondary.reduce((e,t)=>(e[t]=!1,e),{});const a=e.node.getNameNoExt();let l=e.nodes.filter(t=>{let i=r.validateConfig(t);if(i){const e=i||UWA.i18n("unifiedImport.content.grid.tooltip.groupByGeneralErrorMessage");node.setAsValidated(),node.setTooltipValue(e)}else{const i=t.getExtension(),n=t.getNameNoExt();if(e.method.secondary.includes(i)&&!1===s[i]&&n==a)return s[i]=!0,t}});return e.method.secondary.every(e=>i.isExtensionSelected(e,s))&&(l.forEach(e=>{e.setAsValidated()}),t=e.maxNbOfPriors?e.maxNbOfPriors-1:0,i.validNodes.push(e.node,...l)),e.node.setAsValidated(),t},WithoutMatchingFileFlag:function(e,t,i){let n=this,r=n.validate,s=new o(r),a="*"===i[0];t.forEach(t=>{let o=s.validateConfig(t);if(o){const e=o||UWA.i18n("unifiedImport.content.grid.tooltip.excluded");t.setAsValidated(),t.setTooltipValue(e)}else{const o=t.getExtension();(a||i.includes(o))&&o!==e&&(n.validNodes.push(t),t.setAsValidated())}})},validateNodeWithoutMaxPrior:function(e,t){let i=this,n=i.validate,r=new o(n),s=n&&n.extensions,a="*"===s[0];e.forEach(e=>{const n=e.getExtension(),o=t.includes(n);let l=r.validateConfig(e,o);if(l){const t=l||UWA.i18n("unifiedImport.content.grid.tooltip.excluded");e.setAsValidated(),e.setTooltipValue(t)}else{(a||s.includes(e.getExtension())||o)&&(i.validNodes.push(e),e.setAsValidated())}})},validateByImporter:function(){let e=this,t=e.validate;var i=new o(t);const n=t&&t.extensions;let a=e.__private__.method.import.validate&&e.__private__.method.import.validate.methodIdentifier;var l=e.__private__.method.import.validate&&e.__private__.method.import.validate["max-nb-of-priors"];let d=e.getRoots();var c=i.validateByMaxNbOfFiles(d);if(c)e._modelEvents.publish({event:r.EVENT_ERROR_OCCURRED,data:{errorType:s.Content.CHECKIN_MAX_NO_OF_FILES_REACHED,payLoad:{message:[c]}}});else{if(n||a){var u=performance.now();if(e.prepareUpdate(),a){const t=a.reduce((e,t)=>(e.push(t.primary),e),[]);if(void 0===l)e.validateNodeWithoutMaxPrior(d,t);else for(const i of d){const o=i.getExtension();if(l&&!i.isIterated()&&t.includes(o)){let r=a[t.indexOf(o)];if("any"===r["matching-file"])l=e.matchingFileAny({method:r,node:i,nodes:d,maxNbOfPriors:l});else if("all"===r["matching-file"])l=e.matchingFileAll({method:r,node:i,nodes:d,maxNbOfPriors:l});else if(!UWA.is(r["matching-file"])){const t=n&&n.length;r.primary==o&&(e.validNodes.push(i),this.__private__.priorNode=this.__private__.priorNode||i,i.setAsValidated(),0==(l=l?l-1:0)&&t&&e.WithoutMatchingFileFlag(o,d,n))}}}}else d.forEach(t=>{let n=i.validateConfig(t);if(n){const e=n||UWA.i18n("unifiedImport.content.grid.tooltip.excluded");t.setAsValidated(),t.setTooltipValue(e),t.updateOptions({status:UWA.i18n("unifiedImport.content.grid.tooltip.excluded"),statusValue:0})}else e.validNodes.push(t)});e.invalidNodes.push(...d.filter((t,i)=>{if(!e.validNodes.includes(t))return t.tooltipValue||t.setTooltipValue(UWA.i18n("unifiedImport.content.grid.tooltip.WithoutGroupByErrorMessage")),t.setAsValidated(),t.updateOptions({grid:{status:UWA.i18n("unifiedImport.content.grid.tooltip.excluded"),statusValue:0}}),t})),e.pushUpdate(),e.validNodes.forEach(t=>{e.__private__.payload.rootFiles.push(t.getName())}),e.__private__.payload.rootFile=e.__private__.priorNode&&e.__private__.priorNode.getName();var p=e.__private__.priorNode&&e.__private__.priorNode.getName()||e.validNodes.length&&e.validNodes[0].getName();p=p?p.slice(0,p.lastIndexOf(".")):"",e.validNodes.length>1&&(p=p+" "+UWA.i18n("unifiedImport.footer.action.importTitle1")+" "+(e.validNodes.length-1)+" "+UWA.i18n("unifiedImport.footer.action.importTitle2")),e.__private__.payload.title=p;var _=performance.now()}else e.validNodes=d;e._modelEvents.publish({event:r.EVENT_CONTENT_ANALYZED,data:{validNodes:e.validNodes,invalidNodes:e.invalidNodes}});var E=e.validNodes.length,m=e.invalidNodes.length;E&&m||E?e._modelEvents.publish({event:r.EVENT_CONTENT_APPROVED}):m&&e._modelEvents.publish({event:r.EVENT_CONTENT_DISAPPROVED,data:e.invalidNodes});_=performance.now();console.log("ValidateByImporter - "+(_-u))}},contentApproved:function(e){e.prepareUpdate(),e.validNodes.forEach(e=>{e.updateOptions({grid:{status:""}})}),e.pushUpdate();var t=e.validNodes.length,i=[],n=r.PLATFORM_SERVICES[e.__private__.method.service];for(let s=0;s<t;s++){var o=e.validNodes[s],a=void 0;"string"==UWA.typeOf(e.upload.checkinticket)?a=e.checkinticket(n+e.upload.checkinticket+"?maxNumberOfFiles=1"):"function"==UWA.typeOf(e.upload.checkinticket)&&(a=e.upload.checkinticket({fileNode:o,platformServices:r.PLATFORM_SERVICES,securityContext:r.SECURITY_CONTEXT})),i.push(new UWA.Promise(function(t,i){a.then(e.postcheckinticket.bind(null,e)).then(e.checkin.bind(null,e,[o])).then(e.postcheckin.bind(null,e,[o])).then(t).fail(i)}))}UWA.Promise.all(i).then(function(){e._modelEvents.publish({event:r.EVENT_CONTENT_UPLOADED})}).fail(function(t){switch(!0){case t.message.includes("timedout"):e._modelEvents.publish({event:r.EVENT_ERROR_OCCURRED,data:{errorType:s.Content.CHECKIN_TIMEOUT}}),e.checkinFailed(e);break;case t.message.includes("NetworkError"):e._modelEvents.publish({event:r.EVENT_ERROR_OCCURRED,data:{errorType:s.Content.CHECKIN_NETWORK_ERROR}}),e.checkinFailed(e);break;case t.hasOwnProperty("id"):e._modelEvents.publish({event:r.EVENT_ERROR_OCCURRED,data:{errorType:s.Content.CHECKIN_FAILED_AT_IMPORTER,payLoad:{message:[t.message]}}}),e.checkinFailed(e);break;default:e._modelEvents.publish({event:r.EVENT_CHECKIN_FAILED})}}).finally(()=>{e.checkInObjectList=[],e.checkInTicketObjectList=[]})},checkinticket:function(t){var i=this;return new UWA.Promise(function(n,o){let r=e.authenticatedRequest(t,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json","Accept-Language":window.widget?window.widget.lang:"en","X-Requested-With":"XMLHttpRequest"},onComplete:n,onFailure:o});i.checkInTicketObjectList.push(r)})},postcheckinticket:function(e,t){return t&&JSON.parse(t)||{}},checkin:function(t,i,n){return new UWA.Promise(function(o,r){var s=n.uploadCorrelation[0].fileId,a=n.url,l=i[0].getFile(),d=(i[0],new FormData);d.set("__fcs__jobTicket",n.ticket),d.set("__fcs__corelation_0",s),d.set("file_0",l),d.set("file-name",l.name),d.set("file-title",l.name),d.set("file-description",l.name);let c=e.authenticatedRequest(a,{method:"POST",data:d,timeout:18e5,cache:3600,onComplete:function(e){o([e,s])},onFailure:r,onUploadProgress:function(e){if(i[0]){let t=Math.ceil(100*e.loaded/e.total);i[0].updateOptions({grid:{status:`${t} %`}})}}});t.checkInObjectList.push(c)})},postcheckin:function(e,t,i){e.__private__.payload.fileIds.push(i[1]),e.__private__.payload.receipts.push(i[0].trim()),e.totalCheckedInNodes+=1,e._modelEvents.publish({event:r.EVENT_CHECKIN_SUCCEEDED,data:{checkedInNodes:t,totalNodes:e.validNodes.length,totalCheckedInNodes:e.totalCheckedInNodes}})},checkinSucceeded:function(e,t){var i=t.checkedInNodes;e.prepareUpdate(),i.forEach(e=>{e.setTooltipValue(UWA.i18n("unifiedImport.content.grid.tooltip.uploaded")),e.updateOptions({grid:{status:UWA.i18n("unifiedImport.content.grid.tooltip.uploaded"),statusValue:1}})}),e.pushUpdate()},checkinFailed:function(e){e.empty()},switchBaseUrl:function(e){let t=this;try{let i=r.PLATFORM_SERVICES[t.__private__.method.service];const n=e.import["import-ui"]["module-deployment-directory"],o=e.import["import-ui"]["module-directory"];if(i){const e={[`DS${o}`]:`${`${i}${n}`}${o}`};require.config({paths:e})}}catch(e){console.log(e)}},save:function(t){t.__private__.importStartTime=(new Date).getTime(),t._modelEvents.publish({event:r.EVENT_START_EXCHANGE});var i=r.PLATFORM_SERVICES[t.__private__.method.service]+t.__private__.method.import.importurl;let n=t.getpayload(),o={Accept:"application/json","Content-Type":"application/json","Accept-Language":r.LANG,"X-Requested-With":"XMLHttpRequest",SecurityContext:r.SECURITY_CONTEXT},s={data:JSON.stringify(n),method:"POST",headers:o,onComplete:t.exchangerequestsucceeded.bind(null,t),onFailure:t.exchangerequestfailed.bind(null,t)};e.authenticatedRequest(i,s)},getpayload:function(){let e=this;if(e.transform)try{return e.transform.call(e.__private__.payload,{platformServices:r.PLATFORM_SERVICES,securityContext:r.SECURITY_CONTEXT})}catch(e){console.log("Issue is payload generation")}return e.__private__.payload},exchangerequestsucceeded:function(e){e.track(),e._modelEvents.publish({event:r.EVENT_EXCHANGE_REQUEST_SUCCEEDED,data:{payLoad:{message:[e.__private__.payload.title]}}})},exchangerequestfailed:function(e){e._modelEvents.publish({event:r.EVENT_EXCHANGE_REQUEST_FAILED,data:{payLoad:{message:[e.__private__.payload.title]}}})},track:function(){var e=this;i.setAppId("ENXUIMP_AP"),i.setTenant(r.x3dPlatformId),i.setSelectionSize(e.validNodes&&e.validNodes.length),i.setUrl(i.VIEW.URL.VALUES.IMPORT),i.setTitle(i.VIEW.TITLE.VALUES.IMPORT),i.setLanguage(r.SERVER.DEFAULT_HEADERS["Accept-Language"]);var t=0;e.validNodes.forEach(e=>{t+=e.getSize()}),i.setContentSize(t),i.setTime(((new Date).getTime()-e.__private__.importStartTime||0)/1e3),i.setOperation(i.EVENT.CATEGORY.VALUES.IMPORT),i.setService(e.__private__.method.service);var n=e.__private__.method.value;e.__private__.priorNode&&(n=e.__private__.priorNode.getExtension()&&e.__private__.priorNode.getExtension().toUpperCase()||e.__private__.method.value),i.setFormat(n),i.sendEvent()},cancel:function(e){e.prepareUpdate(),e.removeRoots(),e.pushUpdate(),e._modelEvents.publish({event:r.EVENT_EXCHANGE_CANCEL}),e.cancelAllCheckinTicketRequests(e),e.cancelAllCheckinRequests(e),i.clear()},cancelAllCheckinTicketRequests(e){e.upload&&e.upload.checkinticketcancel&&e.upload.checkinticketcancel()||e.checkInTicketObjectList&&e.checkInTicketObjectList.forEach(e=>{e.cancel()})},cancelAllCheckinRequests(e){e.checkInObjectList&&e.checkInObjectList.forEach(e=>{e.cancel()})}})),define("DS/UnifiedImport/views/Content",["UWA/Class/View","DS/Controls/Expander","DS/Controls/Loader","DS/UnifiedImport/views/PotentialMethods","DS/UnifiedImport/views/DragZone","DS/UnifiedImport/views/FilesView","DS/UnifiedImport/views/ImportOptions","DS/UnifiedImport/views/StatusBar","DS/UnifiedImport/utils/Essentials"],(e,t,i,n,o,r,s,a,l)=>{var d;return e.extend({__private__:{}},{className:"unifiedimport-content",setup:function(e){var t=this;t.treeDocument=e.treeDocument,t.setupImporters(),t.setupZone(),t.setupFiles(),t.setupEvents()},setupImporters:function(){var e=this,t=new n({treeDocument:e.treeDocument});e.__private__.optionView=new s({treeDocument:e.treeDocument}),t.inject(e.container),e.__private__.optionView.inject(e.container),e.__private__.optionView.hide()},setupZone:function(){(d=new o({treeDocument:this.treeDocument})).inject(this.container)},setupFiles:function(){},setupEvents:function(){var e=this;e.treeDocument._modelEvents.subscribe({event:l.EVENT_CONTENT_UPLOADED},e.applySortOnProcessEnd.bind(null,e)),e.treeDocument._modelEvents.subscribe({event:l.EVENT_NEW_IMPORT},function(){d.hide(),e.__private__.optionView.show(),e.__private__.myExpander=new t({header:UWA.i18n("unifiedImport.content.accordion.title"),stretchableContentFlag:!0,customHeader:new a({treeDocument:e.treeDocument}),expandedFlag:!0,customHeaderPosition:"near"}).inject(e.container),e.__private__.loaderContainer=UWA.createElement("div",{class:"unifiedimport-loader-viewer"}).inject(e.container),e.__private__.wuxLoader=(new i).inject(e.__private__.loaderContainer),e.__private__.wuxLoader.on(UWA.i18n("unifiedImport.content.grid.loader.analyzingFiles")),e.__private__.myExpander.header=`${UWA.i18n("unifiedImport.content.accordion.title")} (${e.treeDocument.getRoots().length})`;var n=r.datagrid();n.onReady(function(){e.__private__.loaderContainer.hide()}),e.__private__.gridContainer=UWA.createElement("div").inject(e.container),n.treeDocument=e.treeDocument,n.maxVisibleRowCount=e.treeDocument.getRoots().length,e.__private__.myExpander.body=n.getContent()})},applySortOnProcessEnd:function(){r.dgv.reapplySortModel()}})}),define("DS/UnifiedImport/views/Footer",["UWA/Class/View","DS/Controls/Toolbar","DS/Controls/Button","DS/UnifiedImport/views/Preview","DS/UnifiedImport/utils/Essentials"],(e,t,i,n,o)=>e.extend({__private__:{}},{tagName:"div",className:"unifiedimport-footer",setup:function(e){var i=this;i.treeDocument=e.treeDocument,i.__private__.toolbar=new t({}),i.__private__.toolbar.inject(i.container),i.setupRightBarActions(),i.setupEvents()},setupRightBarActions:function(){var e=this;e.__private__.btnPreview=new i({touchMode:!1,label:UWA.i18n("unifiedImport.footer.action.preview"),emphasize:"primary"}),e.__private__.btnPreview.hide(),e.__private__.btnCancel=new i({touchMode:!1,label:UWA.i18n("unifiedImport.footer.action.cancel")}),e.__private__.btnImport=new i({touchMode:!1,label:UWA.i18n("unifiedImport.footer.action.import"),emphasize:"primary",disabled:!0}),e.__private__.toolbar.add("element",{element:e.__private__.btnPreview.getContent(),position:"far"}),e.__private__.toolbar.add("element",{element:e.__private__.btnImport.getContent(),position:"far"}),e.__private__.toolbar.add("element",{element:e.__private__.btnCancel.getContent(),position:"far"})},setupEvents:function(){var e=this;e.__private__.btnImport.addEventListener("buttonclick",e.startImport.bind(null,e)),e.__private__.btnCancel.addEventListener("buttonclick",e.treeDocument.cancel.bind(null,e.treeDocument)),e.treeDocument._modelEvents.subscribe({event:o.EVENT_LOAD_METHOD_FAILED},e.invalidMethod.bind(null,e)),e.treeDocument._modelEvents.subscribe({event:o.EVENT_NEW_IMPORT},e.toggleFooter.bind(null,e)),e.treeDocument._modelEvents.subscribe({event:o.EVENT_CONTENT_DISAPPROVED},e.contentDisapproved.bind(null,e)),e.treeDocument._modelEvents.subscribe({event:o.EVENT_CONTENT_UPLOADED},function(){e.toggleImport(e),UWA.is(e.options.treeDocument.parse)&&o.hasParam("importPreview")&&e.previewAllowed()}),e.treeDocument._modelEvents.subscribe({event:o.EVENT_EXCHANGE_REQUEST_SUCCEEDED},e.exchangeRequestSucceeded.bind(null,e)),e.treeDocument._modelEvents.subscribe({event:o.EVENT_EXCHANGE_REQUEST_FAILED},e.exchangeRequestFailed.bind(null,e))},toggleFooter:function(e){e.getContent().toggle()},toggleImport:function(e){e.__private__.btnImport.disabled=!e.__private__.btnImport.disabled},startImport:function(e){e.toggleImport(e),e.__private__.btnImport.label=UWA.i18n("unifiedImport.footer.action.importing"),e.treeDocument.save(e.treeDocument)},invalidMethod:function(e){e.__private__.btnImport.hide()},contentDisapproved:function(e){e.__private__.btnImport.hide()},exchangeRequestSucceeded:function(e){e.__private__.btnImport.hide(),e.__private__.btnCancel.label=UWA.i18n("unifiedImport.footer.action.done")},exchangeRequestFailed:function(e){e.__private__.btnImport.hide()},previewAllowed:function(){var e=this;e.__private__.btnPreview&&(e.__private__.btnPreview.label=UWA.i18n("unifiedImport.footer.action.preview.wait"),e.__private__.btnPreview.displayStyle="lite",e.__private__.btnPreview.disabled=!0,e.__private__.btnPreview.show(),e.options.treeDocument.parse(e.getParseOpts()).then(e.postParse.bind(null,e)).fail(function(){e.__private__.btnPreview.label=UWA.i18n("unifiedImport.footer.action.preview.unavailable"),e.__private__.btnPreview.disabled=!0,setTimeout(function(){e.__private__.btnPreview.visibleFlag=!1},2e3)}))},getParseOpts:function(){return{fileIds:this.options.treeDocument.__private__.payload.fileIds,receipts:this.options.treeDocument.__private__.payload.receipts,rootFile:this.options.treeDocument.__private__.payload.rootFile,rootFiles:this.options.treeDocument.__private__.payload.rootFiles}},postParse:function(e,t){t.defaultColumns=!1,e.__private__.btnPreview.addEventListener("buttonclick",function(){new n(t)}),e.__private__.btnPreview.displayStyle="primary",e.__private__.btnPreview.label=UWA.i18n("unifiedImport.footer.action.preview"),e.__private__.btnPreview.disabled=!1}})),define("DS/UnifiedImport/views/UnifiedImportProcess",["UWA/Class/View","DS/UnifiedImport/views/Header","DS/UnifiedImport/views/Content","DS/UnifiedImport/views/StatusBar","DS/UnifiedImport/views/Footer","DS/UnifiedImport/utils/Essentials","DS/UnifiedImport/utils/NotificationUtils"],(e,t,i,n,o,r,s)=>e.extend({tagName:"div",className:"unifiedimport-process",setup:function(e){var t=this;t.treeDocument=e.treeDocument,t.setupHeader(),t.setupContent(),t.setupFooter(),t.setupEvents()},setupHeader:function(){this.header=new t({treeDocument:this.treeDocument}),this.header.inject(this.container)},setupContent:function(){this.content=new i({treeDocument:this.treeDocument}),this.content.inject(this.container)},setupFooter:function(){this.footer=new o({treeDocument:this.treeDocument}),this.footer.inject(this.container)},setupEvents:function(){var e=this;e.treeDocument._modelEvents.subscribe({event:r.EVENT_NO_METHOD_FOUND},function(e){s.alert({...s.Content.NO_METHOD},e)}),e.treeDocument._modelEvents.subscribe({event:r.EVENT_LOAD_METHOD_FAILED},function(e){s.alert({...s.Content.INVALID_METHOD},e)}),e.treeDocument._modelEvents.subscribe({event:r.EVENT_CONTENT_DISAPPROVED},function(e){s.alert({...s.Content.CONTENT_DISAPPROVED},e)}),e.treeDocument._modelEvents.subscribe({event:r.EVENT_EXCHANGE_REQUEST_SUCCEEDED},function(e){s.alert({...s.Content.PROCESS_SUCCEEDED},e)}),e.treeDocument._modelEvents.subscribe({event:r.EVENT_EXCHANGE_REQUEST_FAILED},function(e){s.alert({...s.Content.PROCESS_FAILED},e)}),e.treeDocument._modelEvents.subscribe({event:r.EVENT_CHECKIN_FAILED},function(e){s.alert({...s.Content.CHECKIN_FAILED},e)}),e.treeDocument._modelEvents.subscribe({event:r.EVENT_ERROR_OCCURRED},function(e){s.alert({...e.errorType},e)}),e.treeDocument._modelEvents.subscribe({event:r.EVENT_CONTENT_UPLOADED},function(e){s.alert({...s.Content.CONTENT_UPLOADED},e)})}})),define("DS/UnifiedImport/UnifiedImport",["DS/UnifiedImport/models/FileTreeDocument","DS/UnifiedImport/views/UnifiedImportProcess","DS/Utilities/TouchUtils","DS/UnifiedImport/utils/Essentials","DS/UnifiedImport/utils/NotificationUtils","css!DS/UIKIT/UIKIT.css","css!DS/UnifiedImport/UnifiedImport"],(e,t,i,n,o)=>{var r={gotoHome:function(){var i=new e;widget.body.empty(),new t({treeDocument:i}).inject(widget.body);let o=UWA.createElement("div",{class:"unifiedimport-hide-process"});UWA.createElement("span",{text:UWA.i18n("unifiedImport.content.hideProcess"),class:"unifiedimport-hide-process-text"}).inject(o),o.inject(widget.body),i._modelEvents.subscribe({event:n.EVENT_CONTENT_SELECTED},i.toNodes.bind(null,i)),i._modelEvents.subscribe({event:n.EVENT_EXCHANGE_CANCEL},r.gotoHome)},gotoResults:function(e){widget.body.empty(),widget.setTitle("Results"),require(["DS/UnifiedImportResults/models/JobNodeModel","DS/UnifiedImportResults/views/ImportResults"],(e,t)=>{new t({treeNodeModel:new e(n._contextData)}).inject(widget.body)})},onLoad:function(){return new UWA.Promise((e,t)=>{n.setup().then(()=>{n.isInitialized=!0;let t=widget.data.X3DContentId?JSON.parse(widget.data.X3DContentId):null;if(t&&t.data&&t.data.items&&t.data.items[0]&&t.data.items[0].jobId&&t.data.items[0].exchangetype){let e=t.data.items[0],i="transfer"===t.data.items[0].exchangetype.toLowerCase();n.setContext({type:e.exchangetype,jobId:e.jobId,status:e.status,importerId:i?"3DEXPERIENCE":void 0,serviceName:e.service}),r.gotoResults(e)}else widget.setTitle(""),widget.addEvent("onRefresh",n.noop),r.gotoHome();e("view Initialized")}).catch(e=>{t(e)})})}};return r});