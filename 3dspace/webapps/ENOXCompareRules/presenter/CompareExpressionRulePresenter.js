define("DS/ENOXCompareRules/presenter/CompareExpressionRulePresenter",["DS/PlatformAPI/PlatformAPI","DS/xPortfolioQueryServices/js/xEnterpriseDictionary","UWA/Core","DS/CfgDictionary/CfgDictionaryMapperUtils","DS/CfgRuleMatrixComponent/Model/MatrixRuleModel","DS/CoreEvents/ModelEvents","DS/CfgRuleMatrixComponent/Runtime/RunTimePresenter","DS/UIKIT/Badge","DS/ENOXCompareRules/presenter/CompareDefaultPresenter","DS/HTMLDiffModule/HtmlDiffLib"],function(e,t,r,l,a,i,n,s,o,p){"use strict";var c=function(){};return c.prototype.init=function(e){this.options=e.data?e.data:{},this.compareDefaultPresenter=new o,this.createExpressionView()},c.prototype.destroy=function(){this.options.container&&this.options.container.setHTML("")},c.prototype.mapIds=function(e){switch(e){case"and_id":return"andid";case"or_id":return"orid";case"imply_id":return"implyid";case"eval_id":return"evalid";case"greater_id":return"greaterid";case"lower_id":return"lowerid";case"equal_id":return"equalid";case"open_id":return"openid";case"close_id":return"closeid";case"greater_equal_id":return"greaterequalid";case"lower_equal_id":return"lowerequalid";case"eqvlt_id":return"eqvltid";default:return e}},c.prototype.createExpressionView=function(){var e=this.options.leftRuleDef.configurationRule.attributes["Layout Data"],t=this.options.rightRuleDef.configurationRule.attributes["Layout Data"];if(e=""!==e?JSON.parse(e):"",t=""!==t?JSON.parse(t):"",""==e&&""==t)return void this.compareDefaultPresenter.createEmptyView(this.options.container,this.options.toolbar);var l=e.hasOwnProperty("items")?e.items:[],a=t.hasOwnProperty("items")?t.items:[];if(0==l.length&&0==a.length)return void this.compareDefaultPresenter.createEmptyView(this.options.container,this.options.toolbar);var i="",n="";let o="";for(let e=0;e<l.length;e++){if("number"==l[e].type&&(l[e].id=l[e].id.replace("-","")),"number"==l[e].type&&("number"==l[e-1].type||"parameter"==l[e-1].type)){let t=l[e].label;t.startsWith("+")&&(l[e].label="+ "+t.replaceAll("+",""),l[e].value="+ "+t.replaceAll("+","")),t.startsWith("-")&&(l[e].label="- "+t.replaceAll("-",""),l[e].value="- "+t.replaceAll("-",""))}"number"==l[e].type&&"+1"==l[e].label&&"parameter"==l[e+1].type||(o=this.mapIds(l[e].id),i=""==i?o:i+" "+o)}o="";for(let e=0;e<a.length;e++){if("number"==a[e].type&&(a[e].id=a[e].id.replace("-","")),"number"==a[e].type&&("number"==a[e-1].type||"parameter"==a[e-1].type)){let t=a[e].label;t.startsWith("+")&&(a[e].label="+ "+t.replaceAll("+",""),a[e].value="+ "+t.replaceAll("+","")),t.startsWith("-")&&(a[e].label="- "+t.replaceAll("-",""),a[e].value="- "+t.replaceAll("-",""))}"number"==a[e].type&&"+1"==a[e].label&&"parameter"==a[e+1].type||(o=this.mapIds(a[e].id),n=""==n?o:n+" "+o)}var c=r.createElement("p",{html:i}),u=r.createElement("p",{html:n});var d=p.default(c.innerHTML,u.innerHTML,{ignoreWhiteSpaceDifferences:!1,matchGranularity:100,combineWords:!0});o="";var f=!1;var m=(new DOMParser).parseFromString(d,"text/html").querySelector("body").childNodes,h=[];for(let e=0;e<m.length;e++){var y=m[e],b=y.nodeName,g=y.textContent;if((S=[])[0]=b,""!=g&&" "!=g){var v="",D=g.split(" ");for(let e=0;e<D.length;e++)""!=D[e]&&" "!=D[e]&&"  "!=D[e]&&(v=""==v?D[e]:v+" "+D[e],S[1]=v)}S.length>=2&&h.push(S)}for(let e=0;e<l.length;e++){f=!1,"number"==l[e].type&&(f=!0),o=this.mapIds(l[e].id);for(let t=0;t<h.length;t++){let r=h[t];if(r[1].contains(o))if(f)if(l[e].label.contains(" "))r[1]=r[1].replaceAll(o,l[e].label);else{let t=l[e].label;t.startsWith("+")&&(t=t.replace("+","")),t.startsWith("-")&&(t=t.replace("-","")),r[1]=r[1].replaceAll(o,t)}else r[1]=r[1].replaceAll(o,l[e].label)}}o="";for(let e=0;e<a.length;e++){f=!1,"number"==a[e].type&&(f=!0),o=this.mapIds(a[e].id);for(let t=0;t<h.length;t++){let r=h[t];if(r[1].contains(o))if(f)if(a[e].label.contains(" "))r[1]=r[1].replaceAll(o,a[e].label);else{let t=a[e].label;t.startsWith("+")&&(t=t.replace("+","")),t.startsWith("-")&&(t=t.replace("-","")),r[1]=r[1].replaceAll(o,t)}else r[1]=r[1].replaceAll(o,a[e].label)}}var A=r.createElement("div",{class:"CompareBadges"});for(let e=0;e<h.length;e++){var S;b=(S=h[e])[0];if(""!=(g=S[1])&&" "!=g){D=g.split(" ");for(let e=0;e<D.length;e++){var w;if(""!=D[e]&&" "!=D[e]&&"  "!=D[e])"DEL"==b&&(w="warning"),"INS"==b&&(w="info"),"#text"==b&&(w="default"),new s({content:D[e],className:w}).inject(A)}}}A.inject(this.options.container)},c});