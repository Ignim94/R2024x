define("DS/WidgetServicesUI/tweakers/TweakerWUXButton",["DS/Controls/Button"],function(e){"use strict";return function(t){var{emphasize:n,label:i}=t;if(t.icon)var a=t.icon;var s=new e({emphasize:n,label:i,icon:a});if(t.className&&s.getContent().addClassName(t.className),t.id?s.domId=t.id:s.domId=`ENOPROP_BTN_${i}`,t.setAttribute)for(var l in t.setAttribute)s.getContent().setAttribute(l,t.setAttribute[l]);return t.clickCallback&&s.getContent().addEventListener("buttonclick",t.clickCallback),s}}),define("DS/WidgetServicesUI/helpers/Constants",[],function(){return{TYPES:{BOOLEAN:"boolean",STRING:"string",HTML:"html",DATE:"date",DATETIME:"datetime",PERSON:"person",NUMBER:"number",INTEGER:"integer",ENUM:"enum",DROPDOWN:"dropdown",OUTPUT:"ouputText",BUTTONWEB:"buttonweb",IMAGE:"image",MULTIPLE:"multiple",REPLACEMENT:"replacement",RELATION:"relation",BOOLEAN_WUX:"boolean_wux",STRING_WUX:"string_wux",NUMBER_WUX:"number_wux",INTEGER_WUX:"integer_wux",DATE_WUX:"date_wux",DATETIME_WUX:"datetime_wux",PERSON_WUX:"person_wux",ENUM_WUX:"enum_wux",MULTIPLE_WUX:"multiple_wux",REPLACEMENT_WUX:"replacement_wux",UNIT:"unit",USAGE_DIM:"UsageDimension",REFERENCEQTY:"ReferenceBatchQty",DUMMY_BOOKMARK:"DummyBookmark"},SPE_TYPES:{MVA:"mva",ENUM:"spe_enum",MULTISEL:"multisel",MVA_WUX:"mva_wux"}}}),define("DS/WidgetServicesUI/infra/TweakerBase",["UWA/Controls/Abstract","DS/UIKIT/Tooltip","DS/UIKIT/Spinner","css!DS/WidgetServicesUI/WidgetServicesUI","i18n!DS/WidgetServicesUI/assets/nls/i18nWidgetService"],function(e,t,n,i,a){"use strict";return e.extend({type:null,value:null,multiple:null,underEdition:null,_tooltip:null,defaultOptions:{postBuild:!0},init:function(e){this._parent(e),this.value=null,this.underEdition=null,this._tooltip=null,this.data={},this.UIelements={},this.UIelements.lTooltip=[],this.type=this.type?this.type:e.tw_type,this._setValue(e.value),this.elements.container=UWA.createElement("div",{class:"tw_container "+this._getClassName(e)}),this.elements.elementsContainer=UWA.createElement("div",{class:"tw_elementsContainer"}).inject(this.elements.container),this._fillMapWithAuthValues(),this._postInit(),this.__switchMode(!0===e.editable)},showSpinner:function(){this.elements.spinner||(this.elements.spinner=new n,this.elements.spinner.inject(this.elements.container)),this.elements.elementsContainer.hide(),this.elements.spinner.show()},hideSpinner:function(){this.elements.spinner&&this.elements.spinner.hide(),this.elements.elementsContainer.show()},setValue:function(e,t){var n=this._getValueOrDefault(e);this.areEquals(n,this.getValue())||(this._setValue(n),this.getElement()&&this._changeRW(n,t)),this.getROElement()&&this._changeRO(n)},setTooltip:function(e){this._tooltip=e,this._updateTooltip()},getROElement:function(){return this.elements.elementROUI},getContainerElement:function(){var e=this.getElement();return e.tw_parent&&(e=e.tw_parent),e},getElement:function(){return this.elements.elementUI},getHTMLElement:function(){var e=this.getElement();return(e=e||this.getROElement())&&e.elements&&(e=e.elements.container),e},switchMode:function(e){this.__switchMode(e)},focus:function(){var e=this.getHTMLElement();e&&e.focus&&e.focus()},getValue:function(){return this.data.value},getDisplayValues:function(e,t){var n=this,i=[],a=!1,s=void 0!==e?e:this.data.value;void 0!==s&&((a=Array.isArray(s))?s:[s]).forEach(function(e){i.push(n._computeValueForRO(e,t))});return a||(i=i.length>0?i[0]:""),i},getType:function(){return this.type},getDisplayValue:function(e,t){return this.__computeValueForRO(void 0!==e?e:this.data.value,t)},areEquals:function(e,t){return e===t},checkValue:function(e){return null},destroy:function(){this.UIelements.lTooltip.forEach(function(e){e.destroy()}),this.UIelements.lTooltip=[],this._parent()},_dispatchChange:function(e,t){this.setValue(e,t),this.__dispatchEvent("change",e),this.__dispatchAChange(e),!0===t&&this._dispatchValidation(e)},_dispatchLiveChange:function(e,t){this._setValue(e),this.__dispatchEvent("liveChange",e),this.__dispatchAChange(e),t&&13===t.keyCode&&this._dispatchValidation(e)},_dispatchValidation:function(e){this._setValue(e),this.__dispatchEvent("valid",e)},_dispatchNotification:function(e,t){this._dispatchNotificationObj({eventID:e,message:t})},_dispatchNotificationObj:function(e){this.dispatchEvent("notification",e)},_getMinValue:function(){var e=this.options.stepValue;e=e||0;var t=null;return this.options.minValue&&(t=this.options.minValue,!1===this.options.minValueIncluded&&(t+=e)),t},_getMaxValue:function(){var e=null;if(this.options.maxValue){var t=this.options.stepValue;if(t=t||0,e=this.options.maxValue,t){var n=this.__getNumberOfDecimal(t),i=Math.pow(10,n),a=this._getMinValue(),s=parseInt((e-a)*i)%parseInt(t*i);e=(parseInt(e*i)-s)/i}!1===this.options.maxValueIncluded&&(e-=t)}return e},_setError:function(e){console.log("error: "+e.message)},_postInit:function(){},_getValueOrDefault:function(e){return null==e?"":e},_changeRO:function(e){var t=this.elements.elementROUI.getElement(".tw_ROValue_content");if(t){if(this.options&&this.options.forClickable)var n=this.__computeValueForRO(e,{forClickable:!0});else n=this.__computeValueForRO(e);t.setHTML(n)}},_setElement:function(e){this.elements.elementUI=e},_setElementRO:function(e){this.elements.elementROUI=e},_computeValueForRO:function(e,t){return"string"==typeof e&&(t&&!1===t.escapeChar||(e=e.escapeHTML())),e},_buildRO:function(e,t){var n=e.value,i=this.__computeValueForRO(n,e),a=this._createROContainer(i);t.call(this,a)},_createROContainer:function(e){var t=new UWA.createElement("div",{class:"tw_ROValue"}),n={class:"tw_ROValue_content"},i="function"==typeof e.inject;i||(n.html=e);var a=new UWA.createElement("span",n);return i&&e.inject(a),this.options.icon&&UWA.createElement("img",{class:"editProp_iconAttribute",src:this.options.icon}).inject(t),a.inject(t),t},_changeRW:function(e,t){},_build:function(e,t){this.__switchMode(!1),t.call(this,null)},_setValue:function(e){e=this._getValueOrDefault(e);this.data.value=e,this._updateTooltip()},_updateTooltip:function(){var e=this;e.UIelements.lTooltip.forEach(function(t){var n=e.__getTooltip();e._setValueForTooltip(t,n)})},_setValueForTooltip:function(e,t){var n=e.getContent();""===t.textContent?n.addClassName("tw_hideTooltip"):n.removeClassName("tw_hideTooltip"),e.setBody(this.__getTooltip())},__computeValueForRO:function(e,t){var n=this;void 0===e&&(e=this.data.value);var i=Array.isArray(e)?e:null!=e&&""!==e?[e]:[],a=this.options.units;a=a||"";var s="",l="";return i.forEach(function(e){e=n._computeValueForRO(e,t),s+=l+n._addDimensionToValue(e,a),l=", "}),this.options.readOnly&&""===s&&!0===this.options.parameter&&(s="",null!=this.options.minValue&&(s+=this.options.minValue+a,s+=this.options.minValueIncluded?" ≤ ":" < "),s+="…",null!=this.options.maxValue&&(s+=this.options.maxValueIncluded?" ≤ ":" < ",s+=this.options.maxValue+a)),s},__getTooltip:function(e){var t=!1,n=this.options.units;n=n||"";var i=new UWA.createElement("span");if(!e){var s=this._tooltip?this._tooltip:this.__computeValueForRO();new UWA.createElement("span",{html:s}).inject(i)}var l=this._getMinValue();l&&(new UWA.createElement("br").inject(i),new UWA.createElement("span",{text:a.get("minval")+" : "+l+n}).inject(i),t=!0);var r=this._getMaxValue();r&&(new UWA.createElement("br").inject(i),new UWA.createElement("span",{text:a.get("maxval")+" : "+r+n}).inject(i),t=!0);return t||!e?i:null},postBuildUI:function(){this.elements.elementUI&&this._postBuildUI(this.elements.elementUI),this.elements.elementROUI&&this._postBuildUI(this.elements.elementROUI),this.options.postBuild=!0},_postBuildUI:function(e){if(!0!==this.options.nested){var n=this.__getTooltip();if(n){for(var i=e;"function"==typeof i.getContent;)i=i.getContent();var a=new t({position:"top left",delay:{show:400},target:i,trigger:"hover",body:""});this._setValueForTooltip(a,n),this.UIelements.lTooltip.push(a)}}},__getNumberOfDecimal:function(e){var t=e+"",n=0,i=t.indexOf(".");return i<0&&(i=t.indexOf(",")),i>=0&&(n=t.length-i-1),n},__switchMode:function(e){var t=this,n=e&&!t.options.readOnly;n!==this.underEdition&&(this.underEdition=n,this.elements.elementsContainer.empty(),this.options.value=this.getValue(),!0===n?this.getElement()?this.getContainerElement().inject(this.elements.elementsContainer):this._build(t.options,function(e){e&&t.elements.elementsContainer&&(t.getElement()||(!0===t.options.postBuild&&t._postBuildUI(e),t._setElement(e)),t.underEdition&&t.getContainerElement().inject(t.elements.elementsContainer))}):this.getROElement()?this.getROElement().inject(this.elements.elementsContainer):this._buildRO(t.options,function(e){e&&t.elements.elementsContainer&&(t.getROElement()||(!0===t.options.postBuild&&t._postBuildUI(e),t._setElementRO(e)),t.underEdition||t.getROElement().inject(t.elements.elementsContainer))}))},_addDimensionToValue:function(e,t){var n=e||!1===e?e+"":"";return t&&("function"==typeof e.endsWith&&e.endsWith(t)||(n=n+=" "+t)),n},__dispatchAChange:function(e){this.__dispatchEvent("changes",e)},__dispatchEvent:function(e,t){this.dispatchEvent(e,[t])},_getClassName:function(e){return e.className?e.className:""},_fillMapWithAuthValues:function(){}})}),define("DS/WidgetServicesUI/infra/TweakerBaseWebUX",["UWA/Controls/Abstract","DS/UIKIT/Tooltip","DS/UIKIT/Spinner","DS/Controls/TooltipModel","DS/Controls/Label","css!DS/WidgetServicesUI/WidgetServicesUI","i18n!DS/WidgetServicesUI/assets/nls/i18nWidgetService"],function(e,t,n,i,a,s,l){"use strict";return e.extend({type:null,value:null,multiple:null,underEdition:null,_tooltip:null,defaultOptions:{postBuild:!0},init:function(e){this._parent(e),this.value=null,this.underEdition=null,this._tooltip=null,this.data={},this.UIelements={},this.UIelements.lTooltip=[],this.type=this.type?this.type:e.tw_type,this._setValue(e.value),this.elements.container=UWA.createElement("div",{class:"tw_container "+this._getClassName(e)}),this.elements.elementsContainer=UWA.createElement("div",{class:"tw_elementsContainer"}).inject(this.elements.container),this._fillMapWithAuthValues(),this._postInit(),this.__switchMode(!0===e.editable)},showSpinner:function(){this.elements.spinner||(this.elements.spinner=new n,this.elements.spinner.inject(this.elements.container)),this.elements.elementsContainer.hide(),this.elements.spinner.show()},hideSpinner:function(){this.elements.spinner&&this.elements.spinner.hide(),this.elements.elementsContainer.show()},setValue:function(e,t){var n=this._getValueOrDefault(e);this.areEquals(n,this.getValue())||(this._setValue(n),this.getElement()&&this._changeRW(n,t)),!0===this._updateUIAfterCommitOfModels&&(this.getElement()&&this._changeRW(n,t),delete this._updateUIAfterCommitOfModels),!0===this._updateMenuInMultiSelUI&&(this.getElement()&&this._changeRW(n,!0),delete this._updateMenuInMultiSelUI),this.getROElement()&&this._changeRO(n)},setTooltip:function(e){this._tooltip=e,this._updateTooltip()},getROElement:function(){return this.elements.elementROUI},getContainerElement:function(){var e=this.getElement();return e.tw_parent&&(e=e.tw_parent),e},getElement:function(){return this.elements.elementUI},getHTMLElement:function(){var e=this.getElement();return(e=e||this.getROElement())&&e.elements&&(e=e.elements.container),e},switchMode:function(e){this.__switchMode(e)},focus:function(){var e=this.getHTMLElement();e&&e.focus&&e.focus()},getValue:function(){return this.data.value},getDisplayValues:function(e,t){var n=this,i=[],a=!1,s=void 0!==e?e:this.data.value;void 0!==s&&((a=Array.isArray(s))?s:[s]).forEach(function(e){i.push(n._computeValueForRO(e,t))});return a||(i=i.length>0?i[0]:""),i},getType:function(){return this.type},getDisplayValue:function(e,t){return this.__computeValueForRO(void 0!==e?e:this.data.value,t)},areEquals:function(e,t){return e===t},checkValue:function(e){return null},destroy:function(){this.UIelements.lTooltip.forEach(function(e){e.destroy()}),this.UIelements.lTooltip=[],this._parent()},_dispatchChange:function(e,t){this.setValue(e,t),this.__dispatchEvent("change",e),this.__dispatchAChange(e),!0===t&&this._dispatchValidation(e)},_dispatchLiveChange:function(e,t){this._setValue(e),this.__dispatchEvent("liveChange",e),this.__dispatchAChange(e),t&&13===t.keyCode&&this._dispatchValidation(e)},_dispatchValidation:function(e){this._setValue(e),this.__dispatchEvent("valid",e)},_dispatchNotification:function(e,t){this._dispatchNotificationObj({eventID:e,message:t})},_dispatchNotificationObj:function(e){this.dispatchEvent("notification",e)},_dispatchReset:function(){this.__dispatchEvent("resetattribute")},_getMinValue:function(){var e=this.options.stepValue;e=e||0;var t=null;return this.options.minValue&&(t=this.options.minValue,!1===this.options.minValueIncluded&&(t+=e)),t},_getMaxValue:function(){var e=null;if(this.options.maxValue){var t=this.options.stepValue;if(t=t||0,e=this.options.maxValue,t){var n=this.__getNumberOfDecimal(t),i=Math.pow(10,n),a=this._getMinValue(),s=parseInt((e-a)*i)%parseInt(t*i);e=(parseInt(e*i)-s)/i}!1===this.options.maxValueIncluded&&(e-=t)}return e},_setError:function(e){console.log("error: "+e.message)},_postInit:function(){},_getValueOrDefault:function(e){return null==e?"":e},_changeRO:function(e){var t=this.elements.elementROUI.getElement(".tw_ROValue_content");if(t){if(this.options&&this.options.forClickable)var n=this.__computeValueForRO(e,{forClickable:!0});else n=this.__computeValueForRO(e);t.setHTML(n)}},_setElement:function(e){this.elements.elementUI=e},_setElementRO:function(e){this.elements.elementROUI=e},_computeValueForRO:function(e,t){return"string"==typeof e&&(t&&!1===t.escapeChar||(e=e.escapeHTML())),e},_buildRO:function(e,t){var n=e.value,i=this.__computeValueForRO(n,e),a=this._createROContainer(i);t.call(this,a)},_createROContainer:function(e){var t=new UWA.createElement("div",{class:"tw_ROValue"}),n={class:"tw_ROValue_content"},i="function"==typeof e.inject;i||(n.html=e);var a=new UWA.createElement("span",n);return i&&e.inject(a),this.options.icon&&UWA.createElement("img",{class:"editProp_iconAttribute",src:this.options.icon}).inject(t),a.inject(t),t},_changeRW:function(e,t){},_build:function(e,t){this.__switchMode(!1),t.call(this,null)},_setValue:function(e){e=this._getValueOrDefault(e);this.data.value=e,this._updateTooltip()},_updateTooltip:function(){var e=this;e.UIelements.lTooltip.forEach(function(t){var n=e.__getTooltip();e._setValueForTooltip(t,n)})},_setValueForTooltip:function(e,t){t.textContent.length>0?e.tooltipInfos.shortHelp=t:e.tooltipInfos.shortHelp=""},__computeValueForRO:function(e,t,n){var i=this;void 0===e&&(e=this.data.value);var a=Array.isArray(e)?e:null!=e&&""!==e?[e]:[],s=this.options.units;if("object"==typeof s){let e=Object.keys(s);e.length>0&&(s=s[e[0]])}s=s||"";var l="",r="";return a.forEach(function(e){e=i._computeValueForRO(e,t),i.options.hasDimension?l+=r+e:l+=r+i._addDimensionToValue(e,s),r=" , "}),this.options.readOnly&&""===l&&!0===this.options.parameter&&(l="",null!=this.options.minValue&&(l+=this.options.minValue+s,l+=this.options.minValueIncluded?" ≤ ":" < "),l+="…",null!=this.options.maxValue&&(l+=this.options.maxValueIncluded?" ≤ ":" < ",l+=this.options.maxValue+s)),l},__getTooltip:function(e){var t=!1,n=this.options.units;if("object"==typeof n){let e=Object.keys(n);e.length>0&&(n=n[e[0]])}n=n||"";var i=new UWA.createElement("span");if(!e){this._buildTooltip=!0;var a=this._tooltip?this._tooltip:this.__computeValueForRO();this._buildTooltip=!1,new UWA.createElement("span",{html:a}).inject(i)}var s=this._getMinValue();s&&!this.options.hasDimension&&(new UWA.createElement("br").inject(i),new UWA.createElement("span",{text:l.get("minval")+" : "+s+n}).inject(i),t=!0);var r=this._getMaxValue();r&&!this.options.hasDimension&&(new UWA.createElement("br").inject(i),new UWA.createElement("span",{text:l.get("maxval")+" : "+r+n}).inject(i),t=!0);return t||!e?i:null},postBuildUI:function(){this.elements.elementUI&&this._postBuildUI(this.elements.elementUI),this.elements.elementROUI&&this._postBuildUI(this.elements.elementROUI),this.options.postBuild=!0},_postBuildUI:function(e){if(!0!==this.options.nested){var t=this.__getTooltip();if(t){var n=e.container?e.container:e;"person_wux"===this.options.tw_type&&e.container&&e.container.searchInput&&(n=e.container.searchInput),n.tooltipInfos=new i({allowUnsafeHTMLShortHelp:!0,shortHelp:"",mouseRelativePosition:!0}),this._setValueForTooltip(n,t),this.UIelements.lTooltip.push(n)}}},__getNumberOfDecimal:function(e){var t=e+"",n=0,i=t.indexOf(".");return i<0&&(i=t.indexOf(",")),i>=0&&(n=t.length-i-1),n},__switchMode:function(e,t){var n=this,i=e&&!n.options.readOnly;(i!==this.underEdition||t)&&(this.underEdition=i,this.elements.elementsContainer.empty(),this.options.value=this.getValue(),!0===i?!this.getElement()||t?this._build(n.options,function(e){e&&n.elements.elementsContainer&&(n.getElement()&&!t||(!0===n.options.postBuild&&n._postBuildUI(e),n._setElement(e)),n.underEdition&&n.getContainerElement().inject(n.elements.elementsContainer))}):this.getContainerElement().inject(this.elements.elementsContainer):this.getROElement()?this.getROElement().inject(this.elements.elementsContainer):this._buildRO(n.options,function(e){e&&n.elements.elementsContainer&&(n.getROElement()||(!0===n.options.postBuild&&n._postBuildUI(e),n._setElementRO(e)),n.underEdition||n.getROElement().inject(n.elements.elementsContainer))}))},_addDimensionToValue:function(e,t){var n=e||!1===e?e+"":"";return t&&("function"==typeof e.endsWith&&e.endsWith(t)||(n=n+=" "+t)),n},__dispatchAChange:function(e){this.__dispatchEvent("changes",e)},__dispatchEvent:function(e,t){this.dispatchEvent(e,[t])},_getClassName:function(e){return e.className?e.className:""},setClassNameForWebUXComponent:function(e,t){e.getContent().addClassName(t)},setIdForWebUXComponent:function(e,t){e.domId=t},setStyleForWuxComponent:function(e,t,n){UWA.is(e.getContent,"function")?e.getContent().setStyle(t,n):e.setStyle(t,n)},_fillMapWithAuthValues:function(){}})}),define("DS/WidgetServicesUI/tweakers/TweakerHTML",["DS/WidgetServicesUI/infra/TweakerBase"],function(e,t){"use strict";return e.extend({init:function(e){this._parent(e)},_buildRO:function(e,t){var n=e.value;n=n||"";var i=this._createROContainer(n);t.call(this,i)},_computeValueForRO:function(e){return"object"==typeof e?e.textContent:e}})}),define("DS/WidgetServicesUI/tweakers/TweakerInfoWebUX",["DS/WidgetServices/WidgetServices","DS/WidgetServicesUI/helpers/Constants","DS/WidgetServicesUI/infra/TweakerBaseWebUX","DS/Controls/Label","DS/Controls/TooltipModel","i18n!DS/WidgetServicesUI/assets/nls/i18nWidgetService","css!DS/WidgetServicesUI/WidgetServicesUI"],function(e,t,n,i,a,s){"use strict";return n.extend({init:function(e){this._parent(e)},_build:function(e,t){let n=new i({value:"",icon:"info"});this._element=n,this.setStyleForWuxComponent(n,"background","none"),this.setStyleForWuxComponent(n,"color","#77797C"),t.call(this,n)},_injectData:function(e,t){if(this._element){let t=new UWA.createElement("span");if(e&&Array.isArray(e)){new UWA.createElement("span",{html:e[0]}).inject(t);for(let n=1;n<e.length;n++)new UWA.createElement("br").inject(t),new UWA.createElement("span",{html:e[n]}).inject(t)}this._element.tooltipInfos=new a({title:s["Suggested Units"],shortHelp:t,allowUnsafeHTMLShortHelp:!0,mouseRelativePosition:!0})}}})}),define("DS/WidgetServicesUI/tweakers/TweakerRelation",["DS/WidgetServicesUI/infra/TweakerBase","DS/UIKIT/Autocomplete","DS/WidgetServices/WidgetServices","DS/WAFData/WAFData","DS/DataDragAndDrop/DataDragAndDrop","i18n!DS/WidgetServicesUI/assets/nls/i18nWidgetService"],function(e,t,n,i,a,s){"use strict";var l=function(e,t,n){!0!==e.firstToggle?e._dispatchChange(t?n:null,t):e.firstToggle=!1},r=function(e,t){var n=[];if(e&&e.results){var i={};t.predicates&&t.predicates.forEach(function(e){i[e]=e}),i.resourceid="id",i["ds6w:label"]="label";var a=Object.keys(i).length;e.results.forEach(function(e){var t={},s=a;e.attributes&&e.attributes.every(function(e){var n=i[e.name];return n&&(s--,t[n]=e.value),0!==s}),0===s&&n.push({value:t,id:t.id,label:t.label})})}t.onComplete(n)},o=function(e){var t=this,a=e;this.handler={handle:null};var l={dataParser:function(e,t){return t},onError:function(e){a._onFailure.apply(a,[e.error])},remoteSearchEngine:function(e,o){t.handler.handle&&t.handler.handle.cancel(),t.handler.handle=n._getCancelObject();var u=o,c=a.options.data;if(c&&c.rules){u+=" ";var h=!1;for(var p in c.rules){h&&(u+=" AND "),u+="(";var d=c.rules[p],v=!1;d.forEach(function(e){v&&(u+=" OR "),u+=p+':"'+e+'"',v=!0}),u+=")",h=!0}}return new Promise(function(a,o){var c,h,p;c=u,h={handleRequest:t.handler,onComplete:function(t){var n={};n.dataset=e,n.matchingItems=l.dataParser(e,t),a(n)},onFailure:function(t){var n={type:"error"};n.error=t,n.dataset=e,o(n)}},p=n.getTenantID(),h.handleRequest.handle=n.get3DSearchUrlAsync({platformId:p,onComplete:function(e){var t=e+"/search?tenant="+p,a=n.getLanguage();h.predicates=["ds6w:label"];var l="PropertiesPanel-"+(window.top.dsUserLogin?window.top.dsUserLogin:"unknown")+"-"+(new Date).getTime(),o={with_indexing_date:!1,with_synthesis:!1,with_synthesis_attribute:!1,with_nls:!1,nresults:10,locale:a,query:c,tenant:p,start:0,sources:["3dspace"],label:l,select_predicate:h.predicates},u={Accept:"application/json","content-type":"application/json","Accept-Language":n.getLanguage()},d={type:"json",method:"POST",timeout:24e4,data:UWA.Json.encode(o),proxy:"passport",headers:u,cache:-1,onComplete:function(e){r(e,h)},onFailure:function(){h.onFailure(s.searchFromIndexFailure)},onTimeout:function(){h.onFailure(s.timeout)}};n.getWidgetValue("isStandalone")||(d.authentication="passport"),h.handleRequest.handle=i.handleRequest(t,d)}})})}};this.getConfig=function(){return l}};return e.extend({init:function(e){this.handlerLoad={handle:null},this.components={},this._parent(e)},destroy:function(){this._parent.apply(this,arguments);var e=this;setTimeout(function(){for(var t in e.components)try{e.components[t].destroy()}catch(e){}})},setValue:function(e,t){var n=this._parent,i=this;this.completeData([e],function(){n.apply(i,[e,t])})},completeData:function(e,t){if(e.length>0&&(!e[0]||e[0].label))t();else{var a=[],l={};e.forEach(function(e){a.push(e.id),l[e.id]=e,e.label=s["Not indexed"]}),this.handlerLoad.handle=n._getCancelObject(),function(e,t){if(0!=e.length){var a=n.getTenantID();t.handleRequest.handle=n.get3DSpaceUrlAsync({platformId:a,onComplete:function(l){var o=l+"/cvservlet/fetch/v2?tenant="+a,u=n.getLanguage();t.predicates=["ds6w:label"];var c="TweakerRelation-"+(window.top.dsUserLogin?window.top.dsUserLogin:"unknown")+"-"+(new Date).getTime(),h={locale:u,tenant:a,label:c,physicalid:e,select_predicate:t.predicates},p={Accept:"application/json","content-type":"application/json","Accept-Language":n.getLanguage()},d={type:"json",method:"POST",timeout:24e4,data:UWA.Json.encode(h),proxy:"passport",headers:p,cache:-1,onComplete:function(e){r(e,t)},onFailure:function(){t.onFailure(s.dataFromIndexFailure),t.onComplete([])},onTimeout:function(){t.onFailure(s.timeout),t.onComplete([])}};n.getWidgetValue("isStandalone")||(d.authentication="passport"),t.handleRequest.handle=i.handleRequest(o,d)}})}else t.onComplete([])}(a,{handleRequest:this.handlerLoad,onComplete:function(e){e.forEach(function(e){var t=l[e.id];t&&(t.label=e.label)}),t()},onFailure:this._onFailure.bind(this)})}},_onFailure:function(e){this._dispatchNotification("error",e)},_buildRO:function(e,t){var n=this,i=this._parent;n.showSpinner(),this.completeData([e.value],function(){i.apply(n,[e,t]),n.hideSpinner()})},_build:function(e,t){var n=this;n.showSpinner(),this.completeData([e.value],function(){n.__build(e,t),n.hideSpinner()})},_manageDrop:function(e){if(e){var t=this,n=JSON.parse(e);if(n.data&&n.data.items){var i=null;n.data.items.forEach(function(e){e.objectId&&e.displayName?!t.options.data||!t.options.data.rules||!t.options.data.rules.type||t.options.data.rules.type.indexOf(e.objectType)>=0?t.setValue({id:e.objectId,label:e.displayName}):i="mismatchType":i="wrongFormat",i&&t._dispatchNotification("warning",s[i])})}}},__build:function(e,n){this.components.autocompleteWithRemoteData=new t({showSuggestsOnFocus:!0}),this.components.autocompleteWithRemoteData.addEvents({onSelect:l.bind(this.components.autocompleteWithRemoteData,this,!0),onUnselect:l.bind(this.components.autocompleteWithRemoteData,this,!1)});var i=e.value?[e.value]:[],r=new o(this);this.components.autocompleteWithRemoteData.addDataset({name:s.ObjectsList,displayName:!0,items:i},r.getConfig()),e.value&&(this.firstToggle=!0,this.components.autocompleteWithRemoteData.toggleSelect(e.value));var u=this.components.autocompleteWithRemoteData;a.droppable(this.components.autocompleteWithRemoteData.elements.container,{drop:this._manageDrop.bind(this)}),n.call(this,u)},_computeValueForRO:function(e,t){return e?e.label:""},_changeRW:function(e,t){if(e){var n={id:e.id,label:e.label,selected:!0},i=this.components.autocompleteWithRemoteData.selectedItems;0!=i.length&&i[0].id===n.id||this.components.autocompleteWithRemoteData.toggleSelect(n,null,!0)}else this.components.autocompleteWithRemoteData.resetInput()},areEquals:function(e,t){return e===t||!!e&&!!t&&e.id===t.id},_getValueOrDefault:function(e){return e&&e.id?e:null}})}),define("DS/WidgetServicesUI/tweakers/TweakerMVA",["DS/WidgetServicesUI/helpers/Constants","DS/WidgetServicesUI/infra/TweakerBase"],function(e,t){"use strict";return t.extend({tweakerInput:null,init:function(t){this.type=e.SPE_TYPES.MVA,this.tweakerInput=t.tweaker,this._parent(t);var n=this;this.tweakerInput.addEvent("notification",function(e){n._dispatchNotificationObj(e)})},setValue:function(e,t){var n=this._parent,i=this;this.completeData(e,function(){n.apply(i,[e,t])})},focus:function(){var e=this;setTimeout(function(){e.elements.elementUI&&e.elements.elementUI.textInput.getElement().focus()},0)},_setValue:function(e){this._parent(e)},completeData:function(e,t){this.tweakerInput.completeData?this.tweakerInput.completeData(e,t):t()},_buildRO:function(e,t){var n=this,i=this._parent;n.showSpinner(),this.completeData(e.value,function(){i.apply(n,[e,t]),n.hideSpinner()})},_build:function(e,t){var n=this;n.showSpinner(),this.completeData(e.value,function(){n.__build(e,t),n.hideSpinner()})},__build:function(t,n){var i=this;this.tweakerInput.__switchMode(!0),require(["DS/WidgetServicesUI/infra/TweakerMVABase"],function(a){var s=!1,l=!0;i.tweakerInput.getType()===e.TYPES.RELATION&&(s=!0,l=!1);var r=new a(i.tweakerInput,{value:t.value,uniqueValue:s,reorder:l,events:{onChange:function(){var e=this.getValue(),t=[];e.forEach(function(e){t.push(e.value)}),i._dispatchChange(t)},onError:function(e){i._dispatchNotification("error",e.message)}}});n.call(this,r)})},areEquals:function(e,t){var n=e===t||e&&t&&e.length===t.length;if(e&&n)for(var i=e.length,a=0;a<i&&(n=this.tweakerInput.areEquals(e[a],t[a]));a++);return n},_computeValueForRO:function(e,t){return t&&t.forClickable?this.tweakerInput.getDisplayValue(e,{forClickable:t.forClickable}):this.tweakerInput.getDisplayValue(e)},_getValueOrDefault:function(e){return e},_changeRW:function(e){this.getElement().setValue(e)}})}),define("DS/WidgetServicesUI/tweakers/TweakerButtonWeb",["DS/WidgetServices/WidgetServices","DS/WidgetServicesUI/helpers/Constants","DS/WidgetServicesUI/infra/TweakerBase","DS/UIKIT/Input/Button","i18n!DS/WidgetServicesUI/assets/nls/i18nWidgetService"],function(e,t,n,i,a){"use strict";return n.extend({WidgetServices:null,SecurityContextServices:null,init:function(e){e.value=e.value?e.value:{},this.handleRequest={},this._parent(e)},_securityContextDispatcher:function(e,t,n){var i=this;if(n.SecurityContext)i.__callWebService.call(this,e,t,n);else{var a=this.SecurityContextServices.getInstance({tenant:n.tenant}).getSecurityContext({onSuccess:function(a){n.SecurityContext=a.SecurityContext,i.__callWebService.call(i,e,t,n)},onFailure:function(e){i._onFailure(null,{error:e},null,n)}});this._setCancelHandler(a)}},_setCancelHandler:function(e){e&&(this.handleRequest.handler=e)},__callWebService:function(t,n,i){var a=this,s=this.options.data,l=s&&s.headers?s.headers:{};l.Accept=l.Accept?l.Accept:"application/json",l["content-type"]=l["content-type"]?l["content-type"]:"application/json",l["Accept-Language"]=l["Accept-Language"]?l["Accept-Language"]:e.getLanguage(),l.SecurityContext=i.SecurityContext?encodeURIComponent(i.SecurityContext):null;var r={type:"json",method:s&&s.method?s.method:"GET",timeout:36e5,proxy:"passport",headers:l,onComplete:function(e){a._onComplete(e)},onFailure:function(e,t,n){a._onFailure(e,t,n)},onTimeout:function(e){a._onTimeout()}};this.getValue().data&&(r.data=UWA.Json.encode(this.getValue().data));var o=this.getValue().parameters,u=(o=o||{}).tenant?o.tenant:i.tenant;if(u&&(o.tenant=u),o){var c=n.indexOf("?"),h=c>0&&c<n.length-1?"&":"";for(var p in c<0&&(n+="?"),o){var d=o[p];Array.isArray(d)?d.forEach(function(e){n+=h+p+"="+e,h="&"}):n+=h+p+"="+d,h="&"}}try{var v=t.handleRequest(n,r);this._setCancelHandler(v)}catch(e){this._onFailure(null,e,null)}},_callWebService:function(e,t){var n=this.options.data,i={};n.headers&&(i.SecurityContext=n.headers.SecurityContext),i.tenant=n.tenant?n.tenant:this.WidgetServices.getTenantID(),this._securityContextDispatcher(e,t,i)},_launch:function(){var e=this;e.handleRequest||(e.handleRequest={}),this._setCancelHandler({toCancel:!1,cancel:function(){this.toCancel=!0}}),require(["DS/WidgetServices/WidgetServices","DS/WidgetServices/securityContextServices/SecurityContextServices","DS/WAFData/WAFData"],function(t,n,i){if(e.WidgetServices=t,e.SecurityContextServices=n,e.handleRequest.handler&&!1===e.handleRequest.handler.toCancel){var a=e.options.data.url;if(a)if(a.startsWith("http"))e._callWebService(i,a);else{var s=t.get3DSpaceUrlAsync({onComplete:function(t){e._callWebService(i,t+e.options.data.url)}});e._setCancelHandler(s)}}})},_onComplete:function(e){if(e&&!1===e.success)this._onFailure(null,e);else{this._clearHandle(),this._changeStatus("completed","success");var t=this.getValue();t.value=e,this._dispatchChange(t,!0)}},_onFailure:function(e,t,n,i){if(null!=t&&t.hasOwnProperty("error")){var a=t.error;"object"==typeof a&&(a=a.message),this._dispatchNotification("error",a)}this._clearHandle(),this._changeStatus("failed","error")},_onTimeout:function(){this._clearHandle(),this._changeStatus("timeout","warning")},_changeStatus:function(e,t){this.getElement().setClassName("twButton_"+e+(t?" "+t:"")),this.getElement().setValue(a["tw_status_"+e])},_getDefaultLabel:function(){return this.options.data.label?this.options.data.label:a.tw_launch},_build:function(e,t){var n=this,a=(e.value,new i({value:this._getDefaultLabel(),className:"primary",events:{onClick:function(){n._requestIsActive()?(n._changeStatus("cancelled","warning"),n._clearHandle()):(n._changeStatus("loading","info"),n._launch())}}}));t.call(this,a)},_requestIsActive:function(){return!!this.handleRequest.handler},_computeValueForRO:function(e){return this._getDefaultLabel()},_clearHandle:function(){this.handleRequest.handler&&(this.handleRequest.handler.cancel(),this.handleRequest.handler=null)}})}),define("DS/WidgetServicesUI/tweakers/TweakerDummyBookmark",["DS/WidgetServicesUI/infra/TweakerBase"],function(e){"use strict";return e.extend({init:function(e){this._parent(e)},_build:function(e,t){var n=this;require(["DS/IPClassifyActive/InputFieldAbstract"],function(e){var i=new e({panelRequire:"DS/FolderActive/FolderActive"});i.addEvent("change",function(){var e=this.getValues();if(e){var t=[];for(var i in e)t.push(e[i].id),""+e[i].label;n._dispatchChange(t,!0),n._tooltip=e[0].label}}),t.call(this,i)})}})}),define("DS/WidgetServicesUI/tweakers/TweakerImage",["DS/WidgetServicesUI/infra/TweakerBase","i18n!DS/WidgetServicesUI/assets/nls/i18nWidgetService","DS/WidgetServices/WidgetServices","DS/WidgetServices/securityContextServices/SecurityContextServices","css!DS/WidgetServicesUI/WidgetServicesUI"],function(e,t,n,i){"use strict";return e.extend({_initComponents:function(){var e=this;this.addIcon=UWA.createElement("i",{class:"fonticon fonticon-plus",id:"add_image_icon"}),this.removeIcon=UWA.createElement("i",{class:"fonticon fonticon-wrong",id:"remove_image_icon",events:{click:function(t){e.preview.src=e.input.value=this.style.display=e.addIcon.style.display=e.label.style.display=e.previewDiv.style.display=e.labelContainer.style.padding=""}}}),this.label=UWA.createElement("label",{id:"label-dropper",for:"dropper",text:t["Drop an image here"]}),this.container=UWA.createElement("div",{id:"image_tweaker_container"}),this.labelContainer=UWA.createElement("div",{id:"image_tweaker_label_container"}),this.previewDiv=UWA.createElement("div",{id:"image_tweaker_div_preview"}),this.preview=UWA.createElement("img",{id:"image_tweaker_preview"}),this.input=UWA.createElement("input",{id:"dropper",type:"file",events:{dragenter:function(){e.container.style.backgroundColor="#e4f0f5",e.container.style.border="dashed #005686 1px"},dragleave:function(){e.container.style.backgroundColor="",e.container.style.border=""},change:function(t){e._onChange(t)}}})},init:function(e){this._parent(e),this._initComponents()},_checkImageType:function(e){if(e)return"image"===new RegExp(/^[A-z]*/).exec(e.type)[0];this._dispatchNotification("error",t["Unexpected file error"])},_onChange:function(e){var a=this;this.container=document.getElementById("image_tweaker_container"),this.container.style.backgroundColor="",this.container.style.border="";var s=e.target.files[0];if(this._checkImageType(s)){var l=new FileReader;s&&l.readAsDataURL(s),l.addEventListener("load",function(){a.previewDiv.style.display="block",a.preview.src=l.result,a.labelContainer.style.padding="10px",a.label.style.display="none",a.addIcon.style.display="none",a.removeIcon.style.display="block";n.get3DSpaceUrlAsync({onComplete:function(e){var t={onComplete:function(t){a.documentUrl=e+t}};t.onFailure;t.onFailure=function(e,t){console.error("failure")};i.getInstance().getSecurityContext({alwaysUpdate:!0,onFailure:function(e){console.error("no security error"),a._dispatchNotification("error","no security context")},onSuccess:function(e){t.securityContext=e.securityContext}})}})},!1)}else this.input.value="",this._dispatchNotification("error",t["Drop an image here"])},_build:function(e,t){this.that=this,this.preview.inject(this.previewDiv),this.removeIcon.inject(this.previewDiv),this.addIcon.inject(this.labelContainer),this.label.inject(this.labelContainer),this.previewDiv.inject(this.labelContainer),this.input.inject(this.container),this.labelContainer.inject(this.container),t.call(this,this.container)}})}),define("DS/WidgetServicesUI/infra/TweakerMVABase",["DS/MVAInput/MVAInput","DS/WidgetServices/WidgetServices","DS/WidgetServicesUI/helpers/Constants"],function(e,t,n){"use strict";return e.extend({internalOption:{useDropDown:!1},defaultOptions:{options:[]},init:function(e,i){var a=this;i.options||(i.options=[]);var s=!1;e.getType()!==n.TYPES.STRING&&e.getType()!==n.TYPES.NUMBER&&e.getType()!==n.TYPES.BOOLEAN&&e.getType()!==n.TYPES.INTEGER||(s=!0),this.internalOption.useDropDown=s;t.isReplayedODT(),e.addEvent("valid",function(){a._onValidValue()}),e.addEvent("multivaluedBooleanChange",function(){a._onValidValue()}),s&&e.addEvent("liveChange",function(){a._updateDropDown()}),this.textInput=e,this._parent(i)},_checkValue:function(e){this.textInput.getType()!==n.TYPES.DATE&&this.textInput.getType()!==n.TYPES.DATETIME||e.value instanceof Date||(e.value=new Date(e.value));var t=this.textInput.checkValue(e.value);return t||this._parent(e)},_actionOnValid:function(){this.textInput.setValue(null)},_isEqual:function(e,t){return this._parent(e,t)||this.textInput.areEquals(e,t)},_formatItem:function(e){return this.textInput.getDisplayValue(e.value)},_getTooltipForItem:function(e){return this.textInput.getDisplayValue(e.value,{detailed:!0})},_getValueOfInput:function(){return this.textInput.getValue()},_getDisplayInputValue:function(){return this.textInput.getDisplayValue()},_focus:function(){var e=this.textInput.getElement();e&&"function"==typeof e&&e.focus()},_getItemOfInput:function(){var e=this._getValueOfInput(),t=this.textInput.getDisplayValue();return""===e?e:{value:e,displayValue:t}}})}),define("DS/WidgetServicesUI/tweakers/TweakerString",["DS/WidgetServicesUI/infra/TweakerBase","DS/UIKIT/Input/Text","i18n!DS/WidgetServicesUI/assets/nls/i18nWidgetService"],function(e,t,n){"use strict";return e.extend({init:function(e){this._parent(e)},_build:function(e,i){var a=this,s=this._transformString(e.value),l=e.multiline,r=null;e.placeholder?r=e.placeholder:(r=n["Enter a value"],l&&(r=n["Enter a text"]));var o=!1,u={value:s,className:"input-text-label",multiline:l,placeholder:r,fixIframedIosScroll:!0,events:{onChange:function(){if(!o){var e=this.getValue().replace(/\s+$/,"");a._dispatchChange(e,!0)}},onKeyDown:function(e){if(13===e.keyCode){o=!0;var t=this;setTimeout(function(){o=!1;var n=t.getValue().replace(/\s+$/,"");a._dispatchLiveChange(n,e),t.options&&!t.options.multiline&&a.__dispatchEvent("enterKeyDown",t)})}}}};e.placeholder&&(u.placeholder=e.placeholder);var c=new t(u);l&&c.elements.container.setStyle("min-height","38px");var h={input:function(){setTimeout(function(){if(c.elements.input){var e=c.getValue().replace(/\s+$/,"");a._dispatchLiveChange(e)}})}};c.elements.input.addEvents(h),i.call(this,c)},_transformString:function(e){return e},_computeValueForRO:function(e,t){t&&!1!==t.forHTML&&t.maxCharacters&&e.length>t.maxCharacters&&(e=e.substring(0,t.maxCharacters)+"...");var n,i=!1;if(t&&t.forClickable&&(i=!0),i){var a=(n=(new Date).getTime(),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=(n+16*Math.random())%16|0;return n=Math.floor(n/16),("x"==e?t:3&t|8).toString(16)}));e=e.replace(/:\/\//g,a),arguments[0]=e}if(e=this._parent.apply(this,arguments),i){var s=new RegExp(a,"g");e=(e=e.replace(s,"://")).makeClickable()}return e},_changeRW:function(e,t){null!==e&&""!==e||this.getElement().setValue(""),(t||document.activeElement!==this.getElement().elements.input)&&this.getElement().setValue(this._transformString(e))},focus:function(){var e=this.getHTMLElement();e&&e.select()}})}),define("DS/WidgetServicesUI/tweakers/TweakerReplacement",["DS/WidgetServicesUI/helpers/Constants","DS/WidgetServicesUI/infra/TweakerBase","DS/WidgetServicesUI/tweakers/TweakerString","i18n!DS/WidgetServicesUI/assets/nls/i18nWidgetService"],function(e,t,n,i){"use strict";return t.extend({_initValues:{},_currentValue:null,init:function(e){this._initValues={},this._currentValue=null,this._parent(e)},_postInit:function(){this._copyValueToInit()},_copyValueToInit:function(){var e=this.getValue();if(e!==this._currentValue&&(this._currentValue=e,this._initValues={},e))for(var t in e)this._initValues[t]=e[t]},_build:function(e,t){var a=this,s=UWA.createElement("div",{class:"tw_replaceContainer"});this.elements.inputRegex=new n({placeholder:i["Enter a regex"],className:"tw_regexField",editable:!0,nested:!0,events:{change:function(e){a._applyResult()}}}),this.elements.inputResult=new n({placeholder:i["Enter a replace expression"],className:"tw_replaceField",editable:!0,nested:!0,events:{change:function(e){a._applyResult()}}}),this.elements.inputRegex.inject(s),this.elements.inputResult.inject(s),t.call(this,s)},_applyResult:function(){var e=!1,t=this.elements.inputRegex.getValue();if(""!==t&&null!==t){var n=this.elements.inputResult.getValue();if(""!==n&&null!==n)try{var a=new RegExp(t,"g"),s=this._initValues,l={};for(var r in s)l[r]=s[r].replace(a,n);this._currentValue=l,this._dispatchChange(l),e=!0}catch(e){var o=e.message?e.message:i["Wrong regexp"];this._dispatchNotification("warning",o)}}e||this.areEquals(this._initValues,this._currentValue)||this._dispatchChange(UWA.clone(this._initValues))},areEquals:function(e,t){var n=Object.keys(e),i=Object.keys(t),a=e===t||e&&t&&n.length===i.length;if(e&&a)for(var s in e){if(!(a=e[s]===t[s]))break}return a},_computeValueForRO:function(e){if("object"==typeof e){var t="";for(var n in e){""!==t&&(t+=", "),t+=e[n]}return t}},_setValue:function(e){this._parent(e),this._copyValueToInit()},_changeRW:function(e){e!==this._currentValue&&this._applyResult()}})}),define("DS/WidgetServicesUI/tweakers/TweakerStringWebUX",["DS/WidgetServicesUI/infra/TweakerBaseWebUX","DS/UIKIT/Input/Text","DS/Controls/LineEditor","DS/Controls/Editor","i18n!DS/WidgetServicesUI/assets/nls/i18nWidgetService","css!DS/WidgetServicesUI/WidgetServicesUI"],function(e,t,n,i,a){"use strict";return e.extend({init:function(e){this._parent(e)},_build:function(e,t){var s=this,l=this._transformString(e.value),r=e.multiline,o=null;e.placeholder?o=e.placeholder:(o=a["Enter a value"],r&&(o=a["Enter a text"]));var u=!1,c={value:l,placeholder:o};if(e.placeholder&&(c.placeholder=e.placeholder),r){c.nbRows=3;h=new i(c);s.setStyleForWuxComponent(h._myInput,"width","100%")}else{var h=new n(c);s.setStyleForWuxComponent(h,"width","100%")}s.twElement=h,h.addEventListener("change",function(){if(!u){var e=h.value.replace(/\s+$/,"");s._dispatchChange(e,!0)}}),h.addEventListener("keydown",function(e){if(13===e.keyCode){u=!0;var t=s;setTimeout(function(){u=!1;var n=h.value.replace(/\s+$/,"");s._dispatchLiveChange(n,e),t.options&&!t.options.multiline&&s.__dispatchEvent("enterKeyDown",t)})}});var p="input-text-label ";s.options.multivalued&&(p+="multivaluedAttribute"),s.setClassNameForWebUXComponent(h,p);var d={input:function(e){setTimeout(function(){if(h.elements.inputField||r&&h.elements.container){var t=e.target.value.replace(/\s+$/,"");s._dispatchLiveChange(t)}})}};h._myInput.addEvents(d),t.call(this,h)},_transformString:function(e){return e},_computeValueForRO:function(e,t){t&&!1!==t.forHTML&&t.maxCharacters&&e.length>t.maxCharacters&&(e=e.substring(0,t.maxCharacters)+"...");var n,i=!1;if(t&&t.forClickable&&(i=!0),i){var a=(n=(new Date).getTime(),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=(n+16*Math.random())%16|0;return n=Math.floor(n/16),("x"==e?t:3&t|8).toString(16)}));e&&"string"==typeof e&&(e=e.replace(/:\/\//g,a)),arguments[0]=e}if(e=this._parent.apply(this,arguments),i){var s=new RegExp(a,"g");e&&"string"==typeof e&&(e=(e=e.replace(s,"://")).makeClickable())}return e},_changeRW:function(e,t){null!==e&&""!==e||(this.getElement().value=""),(t||document.activeElement!==this.getElement().elements.input)&&(this.getElement().value=this._transformString(e))},focus:function(){var e=this.getHTMLElement();e&&(e.getElement("input").focus(),e.getElement("input").select())},_validate:function(e){return e.replace(/\s+$/,"")},resetTweaker:function(){this.twElement.value=""}})}),define("DS/WidgetServicesUI/tweakers/TweakerReplacementWebUX",["DS/WidgetServicesUI/helpers/Constants","DS/WidgetServicesUI/infra/TweakerBaseWebUX","DS/WidgetServicesUI/tweakers/TweakerStringWebUX","i18n!DS/WidgetServicesUI/assets/nls/i18nWidgetService"],function(e,t,n,i){"use strict";return t.extend({_initValues:{},_currentValue:null,init:function(e){this._initValues={},this._currentValue=null,this._parent(e)},_postInit:function(){this._copyValueToInit()},_copyValueToInit:function(){var e=this.getValue();if(e!==this._currentValue&&(this._currentValue=e,this._initValues={},e))for(var t in e)this._initValues[t]=e[t]},_build:function(e,t){var a=this,s=UWA.createElement("div",{class:"tw_replaceContainer"});let l={placeholder:i.Find,className:"tw_regexField",editable:!0,nested:!0,events:{change:function(e){a._applyResult()}}},r={placeholder:i["Replace with"],className:"tw_replaceField",editable:!0,nested:!0,events:{change:function(e){a._applyResult()}}};this.elements.inputRegex=new n(l),this.elements.inputResult=new n(r),this.elements.inputRegex.inject(s),this.elements.inputResult.inject(s),t.call(this,s)},_applyResult:function(){var e=!1,t=this.elements.inputRegex.getValue();if(""!==t&&null!==t){var n=this.elements.inputResult.getValue();if(""!==n&&null!==n)try{var a=new RegExp(t,"g"),s=this._initValues,l={};for(var r in s)l[r]=s[r].replace(a,n);this._currentValue=l,this._dispatchChange(l),e=!0}catch(e){var o=e.message?e.message:i["Wrong regexp"];this._dispatchNotification("warning",o)}}e||this.areEquals(this._initValues,this._currentValue)||this._dispatchChange(UWA.clone(this._initValues))},areEquals:function(e,t){var n=Object.keys(e),i=Object.keys(t),a=e===t||e&&t&&n.length===i.length;if(e&&a)for(var s in e){if(!(a=e[s]===t[s]))break}return a},_computeValueForRO:function(e){if("object"==typeof e){var t="";for(var n in e){""!==t&&(t+=", "),t+=e[n]}return t}},_setValue:function(e){this._parent(e),this._copyValueToInit()},_changeRW:function(e){e!==this._currentValue&&this._applyResult()},resetTweaker:function(){let e=this;e.elements&&(e.elements.inputRegex&&e.elements.inputRegex.twElement&&(e.elements.inputRegex.twElement.value=""),e.elements.inputResult&&e.elements.inputResult.twElement&&(e.elements.inputResult.twElement.value=""))}})}),define("DS/WidgetServicesUI/infra/TweakerEnumBase",["DS/WidgetServicesUI/helpers/Constants","DS/WidgetServicesUI/infra/TweakerBase","DS/WidgetServices/WidgetServices","i18n!DS/WidgetServicesUI/assets/nls/i18nWidgetService"],function(e,t,n,i){"use strict";return t.extend({_withEmptyValue:!1,init:function(e){this._withEmptyValue=!1,this.tweakerInput=e.tweaker,this.mapOptions={},this._mapForStoringOptionLists={},this._mapValueAndConstants={},this._parent(e)},_postInit:function(){var e=this,t=this.options.data.list;this._translateOptions(t);var n=0;t.forEach(function(t){null!==t.value&&""!==t.value&&void 0!==t.value||(e._withEmptyValue=!0,t.value="_DS_ENUM_NULL_",t.label=i.get("tw_enum_null"));var a="string"==typeof t.value?t.value:n+"_No_change";"_DS_ENUM_NULL_"===t.value&&(e.mapOptions[a]=t.value),t.valueObj=t.value,t.value=a,n++})},_translateOptions:function(e){var t=this;this.tweakerInput&&e.forEach(function(e){null===e.label&&(e.label=t.getDisplayValue(e.value,{forHTML:!1,escapeChar:!1}),e.html=t.getDisplayValue(e.value,{forHTML:!1}),e.htmlClickable=t.getDisplayValue(e.value,{forHTML:!1,forClickable:!0})),e.html||(e.html=e.label)})},_computeValueForRO:function(e,t){var n="";if(null!=e){var i=!1;if("object"!=typeof e){if(this._getEnumValue(e)){i=!0;var a=this._getOptions(e);n=t&&t.forClickable?a.htmlClickable?a.htmlClickable:a.label:a.html?a.html:a.label}}else{var s=this._getContantValue(JSON.stringify(e));if(s){a=this._getOptions(s);var l=this._getEnumValue(a.value);i=void 0!==l&&this.areEquals(l,e),n=t&&t.forClickable?a.htmlClickable?a.htmlClickable:a.label:a.html?a.html:a.label}}!i&&this.tweakerInput&&(n=this.tweakerInput.getDisplayValue(e,t))}return n||e},areEquals:function(e,t){return this._parent(e,t)||this.tweakerInput&&this.tweakerInput.areEquals(e,t)},_getEnumValue:function(e){return this.mapOptions[e]},_getIdFromValue:function(e){return this.__getIdFromValue(e)},__getIdFromValue:function(e){var t=null;if(null!=e)for(var n in!1!==this.options.multivalued&&void 0!==this.options.multivalued||""!==e||!this.mapOptions._DS_ENUM_NULL_||(e="_DS_ENUM_NULL_"),this.mapOptions)if(this.areEquals(e,this.mapOptions[n])){t=n;break}return t},_fillMapWithAuthValues:function(){var e=0,t=this;this.options.data.list.forEach(function(n){var i="string"==typeof n.value?n.value:e+"_No_change";t.mapOptions[i]=n.value,t._mapForStoringOptionLists[i]=n,"object"==typeof n.value&&(t._mapValueAndConstants[JSON.stringify(n.value)]=i),e++})},_getOptions:function(e){return this._mapForStoringOptionLists[e]},_getContantValue:function(e){return this._mapValueAndConstants[e]}})}),define("DS/WidgetServicesUI/tweakers/TweakerDropdown",["DS/WidgetServicesUI/helpers/Constants","DS/WidgetServicesUI/infra/TweakerEnumBase","DS/UIKIT/Dropdown","DS/UIKIT/Input/Button","DS/WidgetServices/WidgetServices","i18n!DS/WidgetServicesUI/assets/nls/i18nWidgetService"],function(e,t,n,i,a,s){"use strict";var l=function(e){return"tw_key_"+e.replace(/\W/g,"_")};return t.extend({_build:function(t,a){var s=this,r=this.tweakerInput;r.__switchMode(!0);var o=!1;r.getType()!==e.TYPES.STRING&&r.getType()!==e.TYPES.NUMBER&&r.getType()!==e.TYPES.INTEGER||(o=!0);var u=[],c=this.elements.bodyDD=UWA.createElement("div",{class:"tw_dropdown_content"});t.data.list.forEach(function(e){var t=UWA.createElement("div",{class:"tw_dropdown_element "+l(e.value),text:e.label,events:{click:function(){var t=e.valueObj;s._dispatchChange(t,!0),s._removeAllSelection(),this.addClassName("tw_dd_selected")}}}).inject(c);UWA.createElement("span",{class:"tw_dropdown_select"}).inject(t),u.push({value:e,UI:t})}),this.elements.dropDown=new n({className:"tw_dropdown",body:c,target:r.elements.container}),r.addEvent("changes",function(e){s._dispatchChange(e,!0),s._selectFromValue(e)});var h=UWA.createElement("div");r.inject(h),o||(this.elements.dropButton=new i({icon:"expand-down",className:"default"}).inject(h)),this._selectFromValue(this.getValue()),a.call(this,h)},_removeAllSelection:function(){if(this.elements.bodyDD){var e=this.elements.bodyDD.getElements(".tw_dd_selected");e&&e.forEach(function(e){e.removeClassName("tw_dd_selected")})}},_selectFromValue:function(e){if(this.elements.bodyDD){var t=this._getIdFromValue(e);if(this._removeAllSelection(),t){var n="."+l(t),i=this.elements.bodyDD.getElement(n);i&&i.addClassName("tw_dd_selected")}}},_changeRW:function(e){this.tweakerInput.setValue(e)}})}),define("DS/WidgetServicesUI/tweakers/TweakerEnum",["DS/WidgetServicesUI/helpers/Constants","DS/WidgetServicesUI/infra/TweakerEnumBase","DS/UIKIT/Input/Select","DS/UIKIT/Autocomplete","DS/WidgetServices/WidgetServices","DS/Controls/ComboBox","i18n!DS/WidgetServicesUI/assets/nls/i18nWidgetService"],function(e,t,n,i,a,s,l){"use strict";return t.extend({_build:function(e,t){var r,o=this,u=this.__getIdFromValue(e.value),c=e.data.list,h=!0===e.data.placeholder?l.SelectOption:!!e.data.placeholder&&e.data.placeholder,p=this.options.multisel;if(void 0===p&&(p=this.options.data.list[0].valueObj._ismultisel),"_DS_ENUM_NULL_"!=c[0].value&&!1===p)for(var d=0;d<c.length;d++){if("_DS_ENUM_NULL_"===c[d].value){r=d;break}}if("_DS_ENUM_NULL_"!=c[0].value&&null!=r&&!1===p){for(var v=c[r],_=r;_>0;_--)c[_]=c[_-1];c[0]=v}var g=!0===e.customSelect,m=!0===e.sortedOptions,f=!0===e.autocomplete;if(m){var S="en";widget&&widget.lang&&(S=widget.lang),c.sort(function(e,t){return e.label.localeCompare(t.label,S,{numeric:!0})})}if(g&&c.forEach(function(e){var t=e.icon;if(t){var n="background-image: url("+t+");background-repeat: no-repeat;background-position-y: center;white-space: pre;background-size: 20px;background-origin: content-box;";e.attributes={style:n},e.label="        "+e.label}}),f){var w=[];c.forEach(function(e){var t={label:e.label,value:e.value};e.value===u&&(t.selected=!0),w.push(t)});var E=function(){var e=this.getValue();if(U||e.length>0&&e[0]!==u){var t=o._getEnumValue(e);"_DS_ENUM_NULL_"!==t&&void 0!==t||(t=""),o._dispatchChange(t,!0)}U=!0},I={className:"input-AuthorizedValuesboolean-label",datasets:{name:"itemsSearch",items:w,displayName:!1},value:u,placeholder:l["Enter a value"],showSuggestsOnFocus:!0,events:{onSelect:E,onUnselect:E}},T=new i(I);t.call(this,T)}else{e.isMultiSel&&"_DS_ENUM_NULL_"===u&&(u=null),null===u&&(this.data.value=c.length>0?this._getEnumValue(c[0].value):null);var U=!1;if(e.prop){var D={value:u,elementsList:e.applySort?o.sortDropdownOptions(c,e.isMultiSel,e.type):c,enableSearchFlag:!0,placeholder:h,className:"input-AuthorizedValuesboolean-label"};e.nested&&0===e.defaultValue&&(D.selectedIndex=e.defaultValue),a.isReplayedODT()&&(g=!0),D.custom=g,e.placeholder&&(h=D.placeholder=e.placeholder),!0===e.customSelect&&(D.renderTo=document.body),(y=new s(D)).touchMode=!0,y.elements.container.setStyle("width","100%"),y.addEventListener("change",function(){var e=y.value;if(U||e!==u){var t=o._getEnumValue(e);"_DS_ENUM_NULL_"!==t&&void 0!==t||(t=""),o._dispatchChange(t,!0)}U=!0}),t.call(this,y)}else{U=!1,D={value:u,options:c,nativeSelect:g,placeholder:h,className:"input-AuthorizedValuesboolean-label",events:{onChange:function(){var e=this.getValue();(U||e.length>0&&e[0]!==u)&&e.forEach(function(e){var t=o._getEnumValue(e);"_DS_ENUM_NULL_"!==t&&void 0!==t||(t=""),o._dispatchChange(t,!0)}),U=!0}}};a.isReplayedODT()&&(g=!0),D.custom=g,e.placeholder&&(h=D.placeholder=e.placeholder),!0===e.customSelect&&(D.renderTo=document.body);var y=new n(D);t.call(this,y)}var k=this.getValue();!0===e.nested||h||u||null==k||o._dispatchChange(k,!0)}},getValue:function(){return"_DS_ENUM_NULL_"===this.data.value||void 0===this.data.value?"":this.data.value},_changeRW:function(e){var t=this._getIdFromValue(e),n=this.getElement();UWA.is(n.setValue,"function")&&n.setValue(t)},focus:function(){var e=this.getElement();setTimeout(function(){e&&e.focus()},0)},sortDropdownOptions:function(e,t,n){var i=!1,a=[],s=null,l=null;return e.forEach(function(e){"_DS_ENUM_NULL_"===e.value?(s=e,i=!0):"0_No_change"===e.value?l=e:a.push(e)}),"string"===n||"boolean"===n?a=this._sortOptionsForWebUXComboBox(a,!1):"integer"===n||"real"===n?a=this._sortOptionsForWebUXComboBox(a,!0):"timestamp"!==n&&"date"!==n||(a=this._sortOptionsForWebUXComboBoxTypeDate(a)),e=[],t&&e.push(l),i&&e.push(s),a.forEach(function(t){e.push(t)}),e},_sortOptionsForWebUXComboBox:function(e,t){return e.sort((e,n)=>e.label.localeCompare(n.label,widget&&widget.lang||"en",{caseFirst:"lower",numeric:t,sensitivity:"case"}))},_sortOptionsForWebUXComboBoxTypeDate:function(e){return e.sort(function(e,t){return new Date(e.label)-new Date(t.label)})}})}),define("DS/WidgetServicesUI/tweakers/TweakerUnitWebUX",["DS/WidgetServices/WidgetServices","DS/WidgetServicesUI/helpers/Constants","DS/WidgetServicesUI/infra/TweakerBaseWebUX","DS/Controls/LineEditor","i18n!DS/WidgetServicesUI/assets/nls/i18nWidgetService","css!DS/WidgetServicesUI/WidgetServicesUI"],function(e,t,n,i,a){"use strict";return n.extend({init:function(e){this._parent(e),this.lastRegisteredEvent=null},_build:function(t,n){var s=this;s.unitEnteredByUser=void 0;var l=t.value;let r=e.getLanguage(),o=.1.toLocaleString(r)[1];if("object"==typeof t.value&&!isNaN(parseFloat(t.value.valueDB))&&t.value.dimension?(t.value.valueDB=parseFloat(t.value.valueDB).toString(),t.value.valueDB=t.value.valueDB.replace(".",o),l=t.value.valueDB+" "+s.getDisplayUnit(t.value.dimension)):l="","object"==typeof s.options.units){let e=Object.keys(s.options.units);s.originalDimension=s.getDisplayUnit(s.options.units[e[0]])}else s.originalDimension=s.getDisplayUnit(s.options.units);var u=null;u=t.placeholder?t.placeholder:a["Enter a value"];var c=new i(t={value:l,placeholder:u});c.addEventListener("keydown",function(e){13===e.keyCode&&setTimeout(function(){var t=c.value;if(void 0===t||!0===s.options.multivalued&&""===t)return;let n=s.validateInputValues(t.trim());n.hasOwnProperty("dimension")&&0===n.dimension.length&&(n.dimension=s.originalDimension),n.dimension&&n.dimension.length>0?s.unitEnteredByUser=!0:s.unitEnteredByUser=!1,s._changeRW(n),s.lastRegisteredEvent="enterkeydown",s._dispatchLiveChange(n,e)})});let h=c._myInput;h.addEventListener("blur",function(e){var t=c.value;if(void 0===t||(!0===s.options.multivalued||!0===s.options.multisel)&&""===t)return;let n=s.validateInputValues(t.trim());n.hasOwnProperty("dimension")&&0===n.dimension.length&&(n.dimension=s.originalDimension),n.dimension&&n.dimension.length>0?s.unitEnteredByUser=!0:s.unitEnteredByUser=!1,s._changeRW(n),s.lastRegisteredEvent="blur",s._dispatchChange(n,!0)}),c.addEventListener("uncommittedChange",function(e){var t=e.dsModel.valueToCommit;if(void 0===t)return;let n=s.validateInputValues(t.trim());n.dimension&&n.dimension.length>0?s.unitEnteredByUser=!0:s.unitEnteredByUser=!1,s.lastRegisteredEvent="uncommittedChange",s._dispatchLiveChange(n)}),s.setStyleForWuxComponent(c,"width","100%");var p=e.getLanguage();h.setAttribute("lang",p),s.twElement=c,n.call(this,c)},_computeValueForRO:function(t,n){let i=this,a=Math.pow(10,6),s=Math.pow(10,-5),l=t.valueDB,r=t.dimension;if(""===l&&""===r)return"";let o=parseFloat(l);if(isNaN(o))return"";let u=Math.abs(o);u>0&&(u>=a||u<s)&&(l=o.toExponential()),l=i._removeTrailingZeros(l);let c=e.getLanguage(),h=.1.toLocaleString(c)[1];l=l.replace(".",h);let p=null;return p=""===r||!1===i.unitEnteredByUser?l:l+" "+i.getDisplayUnit(r,!0)},_removeTrailingZeros:function(e){return e.replace(/((\.[0-9]*[1-9])|\.)0*(([eE])|[^eE]?.?\d*$)/,"$2$4")},checkValue:function(t){let n=this,i=null;if(t&&t.valueDB&&t.valueDB.length>0&&t.dimension&&t.dimension.length>0&&null===(i=isNaN(t.valueDB)?a["Please enter a correct value"]:null)){let s=e.getValue("DimensionsDictionary"),l=n.options.dimensionType?n.options.dimensionType:null;if(l&&s){l=l.startsWith("DSDim_")&&l.substring(6,l.length);let e=s.get(l),n=!1;if(e&&e.Units&&Array.isArray(e.Units)){let i=e.Units.filter(e=>e.label===t.dimension||e.Name===t.dimension||e.NLSName===t.dimension);Array.isArray(i)&&i.length>0&&(n=!0)}i=n?null:a["Please enter a correct value"]}}var s=null;return i&&(s={message:i}),s},_changeRW:function(e,t){if(null===e||""===e)this.getElement().value=void 0;else if(t||document.activeElement!==this.getElement().elements.input){let t=e.dimension,n=e.valueDB;null!=n&&""!==n&&(n=parseFloat(n).toString()),""===n&&""===t?this.getElement().value="":""===t||!1===this.unitEnteredByUser?this.getElement().value=n:this.getElement().value=""===n?"":n+" "+this.getDisplayUnit(t)}},focus:function(){var e=this.getHTMLElement();e&&e.select()},validateInputValues:function(t){let n={valueDB:"",dimension:""},i=this.splitInputValueToTweaker(t),a=e.getLanguage(),s=.1.toLocaleString(a)[1];if(i&&i.length>0){let e=i[0];e=e.replace(s,".");let t=i[1];n.valueDB=e.toString(),n.dimension=t}return n},splitInputValueToTweaker:function(e){let t=e.length,n=[];for(let i=0;i<t;i++)if(" "===e[i])return n.push(e.substring(0,i)),n.push(e.substring(i+1,t)),n;return 0!==n.length||isNaN(e)||(n.push(e),n.push("")),n},areEquals:function(e,t){e=Array.isArray(e)&&1===e.length?e[0]:e,t=Array.isArray(t)&&1===t.length?t[0]:t;let n=e&&t&&Object.keys(e).length===Object.keys(t).length;return n&&(n=!!(e.hasOwnProperty("dimension")&&e.hasOwnProperty("valueDB")&&t.hasOwnProperty("dimension")&&t.hasOwnProperty("valueDB"))&&((parseFloat(e.valueDB)===parseFloat(t.valueDB)||e.valueDB===t.valueDB)&&e.dimension===t.dimension)),!!n},getDisplayUnit:function(t,n){if(!t)return"";let i=t,a=e.getValue("DimensionsDictionary"),s=this.options.dimensionType?this.options.dimensionType:null;if(s&&a&&t){s=s.startsWith("DSDim_")&&s.substring(6,s.length);let e=a.get(s);if(e&&e.Units&&Array.isArray(e.Units)){let a=e.Units.filter(e=>e.label?e.label===t||e.NLSName===t:e.Name===t||e.NLSName===t);Array.isArray(a)&&a.length>0&&(n?i=a[0].NLSName:a[0].label?i=a[0].label:a[0].Name&&(i=a[0].Name))}}return n&&0===i.length&&(i=t),i},_validate:function(e){let t=this,n=t.validateInputValues(e.trim());return n.hasOwnProperty("dimension")&&0===n.dimension.length&&(n.dimension=t.originalDimension),n.dimension&&n.dimension.length>0?t.unitEnteredByUser=!0:t.unitEnteredByUser=!1,n},resetTweaker:function(){this.twElement.value=""}})}),define("DS/WidgetServicesUI/tweakers/TweakerPerson",["DS/WidgetServicesUI/infra/TweakerBase"],function(e){"use strict";return e.extend({init:function(e){this._parent(e)},_build:function(e,t){var n=this;require(["DS/SearchWidget/SearchWidget","DS/SearchWidget/SearchWidgetConstant"],function(i,a){var s=e.value,l=a.TYPE_PERSON,r=i.getSearchWidget(i.FULL,{className:"EPP_searchPeople",MaxNumber:"3",MaxSize:"300",showEmptyCategory:!1,setBorderColor:!0,acceptEmpty:!n.options.mandatory,type:l,events:{onValid:function(){var e=r.getNewOwner();if(e.person.personFullName){var t=e.person.personFullName,i=e.person.personID;t={fullName:t,personID:i=i?i.replace(/_PRJ$/,""):i};n._dispatchChange(t,!0)}},onUnvalid:function(){var e={fullName:e=r.getDisplayedResult(),personID:null};n._dispatchChange(e)},onError:function(e){n._setError(e)}}}),o=[];e.data&&e.data.objectIDs&&e.data.objectIDs.forEach(function(e){o.push({objectID:e})}),r.setSelectedItemList(o),s&&r.setValue(s.fullName),t.call(this,r)})},actionOnScroll:function(){this.getElement()&&this.getElement().actionOnScroll()},_computeValueForRO:function(e){return e?e.fullName:""},areEquals:function(e,t){return e.personID===t.personID},_changeRW:function(e){this.getElement().setValue(e?e.fullName:"")},_getValueOrDefault:function(e){return e||{personID:"",fullName:""}}})}),define("DS/WidgetServicesUI/tweakers/TweakerBooleanWebUX",["DS/WidgetServicesUI/infra/TweakerBaseWebUX","DS/Controls/Toggle","i18n!DS/WidgetServicesUI/assets/nls/i18nWidgetService"],function(e,t,n){"use strict";return e.extend({init:function(e){this.options=e,this.convertTovalidValuesForBoolean={},this.convertTovalidValuesForBoolean.true=!0,this.convertTovalidValuesForBoolean.false=!1,this.convertTovalidValuesForBoolean.TRUE=!0,this.convertTovalidValuesForBoolean.FALSE=!1,this.convertTovalidValuesForBoolean[n.true]=!0,this.convertTovalidValuesForBoolean[n.false]=!1,this.getConvertedDisplayValue={},this.getConvertedDisplayValue[!0]=n.true,this.getConvertedDisplayValue[!1]=n.false,this._parent(e)},_build:function(e,n){var i=this,a=e.value,s=new t({type:"switch",checkFlag:!0===a});i.setClassNameForWebUXComponent(s,"input-boolean-label"),s.addEventListener("change",function(e){var t=e.dsModel.checkFlag;i._dispatchChange(t,!0),!i.options.multivalued||!0!==t&&!1!==t||i.__dispatchEvent("multivaluedBooleanChange")}),n.call(this,s)},_computeValueForRO:function(e){return this.options.multivalued?e:!0===e?n.true:n.false},_changeRW:function(e){this.options.multivalued||(this.getElement().checkFlag=!0===e)},focus:function(){var e=this.getElement();setTimeout(function(){e.elements.input&&e.elements.input.focus()},0)}})}),define("DS/WidgetServicesUI/tweakers/TweakerNumberWebUX",["DS/WidgetServices/WidgetServices","DS/WidgetServicesUI/helpers/Constants","DS/WidgetServicesUI/infra/TweakerBaseWebUX","DS/UIKIT/Input/Text","DS/Controls/SpinBox","i18n!DS/WidgetServicesUI/assets/nls/i18nWidgetService","css!DS/WidgetServicesUI/WidgetServicesUI"],function(e,t,n,i,a,s){"use strict";return n.extend({init:function(e){this._parent(e)},_postInit:function(){this.getType()===t.TYPES.INTEGER_WUX&&(this.options.stepValue=this.options.stepValue?parseInt(this.options.stepValue):1)},_build:function(n,i){var l=this,r=""===n.value?n.value:parseFloat(n.value),o=null;if(n.placeholder)o=n.placeholder;else switch(o=s["Enter a value"],this.getType()){case t.TYPES.INTEGER_WUX:o=s["Enter an integer"];break;case t.TYPES.NUMBER_WUX:o=s["Enter a number"]}var u={value:r||0===r&&""!==r?r:void 0,units:n.units?n.units:"",minValue:l.options.minValue?l._getMinValue():void 0,maxValue:l.options.maxValue?l._getMaxValue():void 0,stepValue:l.options.stepValue?l.options.stepValue:1,placeholder:o,allowUndefinedFlag:!0,decimals:null,useScientificNotationFlag:!1,highExponentProperty:void 0,lowExponentProperty:void 0};"integer"===this.options.type&&(u.typingFilter=!0);var c=new a(u);l.twElement=c;var h=c._myInput;h.addEventListener("blur",function(e){var t=c.value;if(!0!==l.options.multivalued&&!0!==l.options.multisel||""!==t&&void 0!==t){t=l._checkAndAdaptValue(t);n.multivalued&&(t=t.toString()),l._dispatchChange(t,!0)}}),c.addEventListener("keydown",function(e){13===e.keyCode&&setTimeout(function(){var t=c.value;t=l._checkAndAdaptValue(t),n.multivalued&&(t=t.toString()),l._dispatchLiveChange(t,e)})}),c.addEventListener("change",function(e){var t=e.dsModel.value;t=l._checkAndAdaptValue(t);l._dispatchLiveChange(t.toString())});var p="input-number-label ";l.options.multivalued&&(p+="multivaluedAttribute MVANumber"),l.setClassNameForWebUXComponent(c,p),l.setStyleForWuxComponent(c,"width","100%");var d=e.getLanguage();h.setAttribute("lang",d);var v={input:function(t){setTimeout(function(){var t=c.valueToCommit,n=e.getLanguage(),i=.1.toLocaleString(n)[1];t=t.replace(i,"."),l._dispatchLiveChange(t)})}};c.elements.inputField.addEvents(v),i.call(this,c)},_computeValueForRO:function(t,n){var i=null,a=Math.pow(10,6),s=Math.pow(10,-5);if(isNaN(t)||""===t)i=this._parent(t);else{var l=parseFloat(t),r=!n||!0!==n.detailed;i=l;var o=Math.abs(l);o>0&&(o>=a||o<s)?i=l.toExponential():r&&(i=l.toString()),i=this._removeTrailingZeros(i+"");var u=e.getLanguage(),c=.1.toLocaleString(u)[1];i=i.replace(".",c)}return i},_removeTrailingZeros:function(e){return e.replace(/((\.[0-9]*[1-9])|\.)0*(([eE])|[^eE]?.?\d*$)/,"$2$4")},_checkAndAdaptValue:function(e){if(""===e||void 0===e)return"";var t=parseFloat(e),n=1;if(this.options.stepValue){var i=this.options.minValue?this.options.minValue:0,a=(n=this.options.stepValue)+"",s=0,l=a.indexOf(".");l<0&&(l=a.indexOf(",")),l>=0&&(s=a.length-l-1);var r=Math.pow(10,s),o=parseInt(n*r),u=parseInt((t-i)*r);t=(u-u%o+i*r)/r}if(this.options.minValue){var c=this._getMinValue();t=Math.max(t,c)}if(this.options.maxValue){var h=this._getMaxValue();t=Math.min(t,h)}return t},areEquals:function(e,t){return this._parent(e,t)||parseFloat(e)===parseFloat(t)},checkValue:function(e){var t=isNaN(e)?s["Please enter a correct value"]:null,n=null;return t&&(n={message:t}),n},_changeRW:function(e,t){null===e||""===e?this.getElement().value=void 0:(t||document.activeElement!==this.getElement().elements.input)&&(this.getElement().value=parseFloat(e))},focus:function(){var e=this.getHTMLElement();e&&e.select()},_validate:function(t){var n=e.getLanguage(),i=.1.toLocaleString(n)[1];t=t.replace(i,"."),t=this._checkAndAdaptValue(t);let a=this.checkValue(t);return a?(a.type="error",a):t},resetTweaker:function(){this.twElement.value=void 0}})}),define("DS/WidgetServicesUI/tweakers/TweakerNumber",["DS/WidgetServices/WidgetServices","DS/WidgetServicesUI/helpers/Constants","DS/WidgetServicesUI/infra/TweakerBase","DS/UIKIT/Input/Text","i18n!DS/WidgetServicesUI/assets/nls/i18nWidgetService"],function(e,t,n,i,a){"use strict";return n.extend({init:function(e){this._parent(e)},_postInit:function(){this.getType()===t.TYPES.INTEGER&&(this.options.stepValue=this.options.stepValue?parseInt(this.options.stepValue):1)},_build:function(n,s){var l=this,r=""===n.value?n.value:parseFloat(n.value),o=null;if(n.placeholder)o=n.placeholder;else switch(o=a["Enter a value"],this.getType()){case t.TYPES.INTEGER:o=a["Enter an integer"];break;case t.TYPES.NUMBER:o=a["Enter a number"]}var u=new i({value:r,className:"input-number-label",placeholder:o,events:{onKeyDown:function(e){if(13===e.keyCode){var t=this;setTimeout(function(){var i=t.getValue();i=l._checkAndAdaptValue(i),n.multivalued&&(i=i.toString()),l._dispatchLiveChange(i,e)})}}}});u.elements.input.addEventListener("blur",function(){var e=u.getValue();e=l._checkAndAdaptValue(e);n.multivalued&&(e=e.toString()),l._dispatchChange(e,!0)});var c={input:function(){setTimeout(function(){var e=u.getValue();n.multivalued&&(e=e.toString()),l._dispatchLiveChange(e)})}};u.elements.input.addEvents(c);var h=n.units;if(h){var p=UWA.createElement("div",{class:"input-group"});UWA.createElement("span",{class:"input-group-addon",text:h}).inject(p),u.inject(p),u.tw_parent=p}var d=u.elements.container,v=e.getLanguage();if(d.setAttribute("type","number"),d.setAttribute("step",this.options.stepValue?this.options.stepValue:"any"),d.setAttribute("lang",v),this.options.minValue){var _=this._getMinValue();d.setAttribute("min",_)}if(this.options.maxValue){var g=this._getMaxValue();d.setAttribute("max",g)}s.call(this,u)},_computeValueForRO:function(t,n){var i=null,a=Math.pow(10,6),s=Math.pow(10,-5);if(isNaN(t)||""===t)i=this._parent(t);else{var l=parseFloat(t),r=!n||!0!==n.detailed;i=l;var o=Math.abs(l);o>0&&(o>=a||o<s)?i=l.toExponential():r&&(i=l.toString()),i=this._removeTrailingZeros(i+"");var u=e.getLanguage(),c=.1.toLocaleString(u)[1];i=i.replace(".",c)}return i},_removeTrailingZeros:function(e){return e.replace(/((\.[0-9]*[1-9])|\.)0*(([eE])|[^eE]?.?\d*$)/,"$2$4")},_checkAndAdaptValue:function(e){if(""===e)return e;var t=parseFloat(e),n=1;if(this.options.stepValue){var i=this.options.minValue?this.options.minValue:0,a=(n=this.options.stepValue)+"",s=0,l=a.indexOf(".");l<0&&(l=a.indexOf(",")),l>=0&&(s=a.length-l-1);var r=Math.pow(10,s),o=parseInt(n*r),u=parseInt((t-i)*r);t=(u-u%o+i*r)/r}if(this.options.minValue){var c=this._getMinValue();t=Math.max(t,c)}if(this.options.maxValue){var h=this._getMaxValue();t=Math.min(t,h)}return t},areEquals:function(e,t){return this._parent(e,t)||parseFloat(e)===parseFloat(t)},checkValue:function(e){var t=isNaN(e)?a["Please enter a correct value"]:null,n=null;return t&&(n={message:t}),n},_changeRW:function(e,t){null===e||""===e?this.getElement().setValue(""):(t||document.activeElement!==this.getElement().elements.input)&&this.getElement().setValue(parseFloat(e))},focus:function(){var e=this.getHTMLElement();e&&e.select()}})}),define("DS/WidgetServicesUI/tweakers/TweakerBoolean",["DS/WidgetServicesUI/infra/TweakerBase","DS/UIKIT/Input/Toggle","i18n!DS/WidgetServicesUI/assets/nls/i18nWidgetService"],function(e,t,n){"use strict";return e.extend({init:function(e){this._parent(e)},_build:function(e,n){var i=this,a=e.value,s=new t({type:"switch",checked:!0===a,value:"",className:"input-boolean-label",events:{onChange:function(){var e=this.isChecked();i._dispatchChange(e)}}});n.call(this,s)},_computeValueForRO:function(e){return!0===e?n.true:n.false},_changeRW:function(e){this.getElement().setCheck(!0===e)},focus:function(){var e=this.getElement();setTimeout(function(){e.elements.input&&e.elements.input.focus()},0)}})}),define("DS/WidgetServicesUI/tweakers/TweakerDate",["DS/WidgetServices/WidgetServices","DS/WidgetServicesUI/helpers/Constants","DS/WidgetServicesUI/infra/TweakerBase","DS/UIKIT/Input/Date","i18n!DS/WidgetServicesUI/assets/nls/i18nWidgetService"],function(e,t,n,i,a){"use strict";return n.extend({init:function(e){this._parent(e)},_build:function(e,n){var s=this,l=e.value,r=!0!==e.mandatory;if(this.type===t.TYPES.DATE){var o=new i({value:l,showClearIcon:r,className:"input-date-label",placeholder:a.selectADate,events:{onChange:function(){if(this.elements.picker){var e=this.getDate();e?(e.setHours(12),e.setUTCHours(12)):e="",s._dispatchChange(e,!0)}}}});n.call(this,o)}else require(["DS/Controls/DatePicker"],function(e){var t=new e({value:l,timePickerFlag:!0,timePickerPrecision:"sec"});t.addEventListener("change",function(e){var t=e.dsModel.value;s._dispatchChange(t,!0)}),t.addEventListener("livechange",function(e){e.dsModel.value}),n.call(s,t)})},areEquals:function(e,t){var n=this._methodForDisplay();return e&&t?e[n]()===t[n]():e===t},_methodForDisplay:function(){return this.type===t.TYPES.DATE?"toLocaleDateString":"toLocaleString"},_computeValueForRO:function(t){var n=this._methodForDisplay();return t?t[n](e.getLanguage()):""},_changeRW:function(e){this.getElement()instanceof i?e?this.getElement().setDate(e):this.getElement().setValue(""):this.getElement().value=e}})}),define("DS/WidgetServicesUI/tweakers/TweakerOutput",["DS/WidgetServicesUI/infra/TweakerBase"],function(e,t){"use strict";return e.extend({init:function(e){this._parent(e)}})}),define("DS/WidgetServicesUI/infra/TweakerEnumBaseWebUX",["DS/WidgetServicesUI/helpers/Constants","DS/WidgetServicesUI/infra/TweakerBaseWebUX","DS/WidgetServices/WidgetServices","i18n!DS/WidgetServicesUI/assets/nls/i18nWidgetService"],function(e,t,n,i){"use strict";return t.extend({_withEmptyValue:!1,init:function(e){this._withEmptyValue=!1,this.tweakerInput=e.tweaker,this.mapOptions={},this._mapForStoringOptionLists={},this._mapValueAndConstants={},this._parent(e)},_postInit:function(){var e=this,t=this.options.data.list;this._translateOptions(t),"boolean"===e.options.type&&(e.getConvertedDisplayValue={},e.getConvertedDisplayValue[!0]=i.true,e.getConvertedDisplayValue[!1]=i.false,e.convertTovalidValuesForBoolean={},e.convertTovalidValuesForBoolean.true=!0,e.convertTovalidValuesForBoolean.false=!1,e.convertTovalidValuesForBoolean.TRUE=!0,e.convertTovalidValuesForBoolean.FALSE=!1,e.convertTovalidValuesForBoolean[i.true]=!0,e.convertTovalidValuesForBoolean[i.false]=!1);var n=0;t.forEach(function(t){null!==t.value&&""!==t.value&&void 0!==t.value||(e._withEmptyValue=!0,t.value="_DS_ENUM_NULL_",t.label=i.get("tw_enum_null"));var a="string"==typeof t.value?t.value:n+"_No_change";e.mapOptions[a]=t.value,t.valueObj=t.value,t.value=a,n++})},_translateOptions:function(e){var t=this;this.tweakerInput&&e.forEach(function(e){null===e.label&&(e.label=t.getDisplayValue(e.value,{forHTML:!1,escapeChar:!1}),e.html=t.getDisplayValue(e.value,{forHTML:!1}),e.htmlClickable=t.getDisplayValue(e.value,{forHTML:!1,forClickable:!0})),e.html||(e.html=e.label)})},_computeValueForRO:function(e,t){var n="";if(null!=e){var i,a=e;"object"==typeof e&&(a=this._getContantValue(JSON.stringify(e)));var s=this._getOptions(a),l=s?this._getEnumValue(s.value):void 0;(i=void 0!==l&&this.areEquals(l,e))&&(n=t&&t.forClickable?s.htmlClickable?s.htmlClickable:s.label:s.html?s.html:s.label),!i&&this.tweakerInput&&(n=this.tweakerInput.getDisplayValue(e,t))}return n||e},areEquals:function(e,t){return this._parent(e,t)||this.tweakerInput&&this.tweakerInput.areEquals(e,t)},_getEnumValue:function(e){return this.mapOptions[e]},_getIdFromValue:function(e){return this.__getIdFromValue(e)},__getIdFromValue:function(e){var t=null;if(null!=e)for(var n in!1!==this.options.multivalued&&void 0!==this.options.multivalued||""!==e||!this.mapOptions._DS_ENUM_NULL_||(e="_DS_ENUM_NULL_"),this.mapOptions)if(this.areEquals(e,this.mapOptions[n])){t=n;break}return t},_fillMapWithAuthValues:function(){var e=0,t=this;this.options.data.list.forEach(function(n){var i="string"==typeof n.value?n.value:e+"_No_change";t._mapForStoringOptionLists[i]=n,"object"==typeof n.value&&(t._mapValueAndConstants[JSON.stringify(n.value)]=i),e++})},_getOptions:function(e){return this._mapForStoringOptionLists[e]},_getContantValue:function(e){return this._mapValueAndConstants[e]}})}),define("DS/WidgetServicesUI/tweakers/TweakerMVAWebUX",["DS/WidgetServicesUI/helpers/Constants","DS/WidgetServicesUI/infra/TweakerBaseWebUX","DS/WidgetServices/WidgetServices","i18n!DS/WidgetServicesUI/assets/nls/i18nWidgetService"],function(e,t,n,i){"use strict";return t.extend({tweakerInput:null,init:function(t){this.type=e.SPE_TYPES.MVA_WUX,this.tweakerInput=t.tweaker,this._parent(t);var n=this;this.tweakerInput.addEvent("notification",function(e){n._dispatchNotificationObj(e)})},setValue:function(e,t){var n=this._parent,i=this;this.completeData(e,function(){n.apply(i,[e,t])})},focus:function(){var e=this;setTimeout(function(){e.elements.elementUI&&e.elements.elementUI.textInput.getElement().focus()},0)},_setValue:function(e){this._parent(e)},completeData:function(e,t){this.tweakerInput.completeData?this.tweakerInput.completeData(e,t):t()},_buildRO:function(e,t){var n=this,i=this._parent;n.showSpinner(),this.completeData(e.value,function(){i.apply(n,[e,t]),n.hideSpinner()})},_build:function(e,t){var n=this;n.showSpinner(),this.completeData(e.value,function(){n.__build(e,t),n.hideSpinner()})},__build:function(e,t){this.tweakerInput.__switchMode(!0),this._buildWUXMVATweaker(e,t)},areEquals:function(e,t){var n=e===t||e&&t&&e.length===t.length;if(e&&n)for(var i=e.length,a=0;a<i&&(n=this.tweakerInput.areEquals(e[a],t[a]));a++);return n},_computeValueForRO:function(e,t){if("boolean"===this.options.type){"String"!=typeof e&&(e=e.toString());let t=e.toLowerCase();if("true"===t||"false"===t){return this.tweakerInput.getConvertedDisplayValue[t]}{let n=this.tweakerInput.convertTovalidValuesForBoolean[t];return n||e}}return t&&t.forClickable?this.tweakerInput.getDisplayValue(e,{forClickable:t.forClickable}):this.tweakerInput.getDisplayValue(e)},_getValueOrDefault:function(e){return e},_changeRW:function(e){let t=this;if("boolean"===this.options.type){let n=[];if(null!=e){if(e.forEach(function(e){"String"!=typeof e&&(e=e.toString());let i=e.toLowerCase();if("true"===i||"false"===i){let e=t.tweakerInput.getConvertedDisplayValue;n.push(e[i])}else{let a=t.tweakerInput.convertTovalidValuesForBoolean[i];a?n.push(a):n.push(e)}}),this._areValuesSame(n))return;this.setValueToTweaker(n)}}else{if(null!==e&&this._areValuesSame(e))return;this.setValueToTweaker(e)}"person_wux"===this.tweakerInput.type&&this.tweakerInput.getElement().searchWidgetUI&&this.tweakerInput.getElement().searchWidgetUI.searchInput&&(this.tweakerInput.getElement().searchWidgetUI.searchInput.value=void 0,this.tweakerInput.getElement().searchWidgetUI.searchInput._editor._myInput.hasClassName("error-field")&&this.tweakerInput.getElement().searchWidgetUI.searchInput._editor._myInput.removeClassName("error-field"))},_buildWUXMVATweaker:function(t,n){let a=this;t.data&&t.data.list&&Array.isArray(t.data.list)&&t.data.list.length>0&&"boolean"!==t.type?require(["DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/WUXAutoComplete/AutoComplete"],function(e,s,l){let r={allowFreeInputFlag:!1};r.elementsTree=a.tweakerInput.enumFinalOptionsList,r.elementsTree||"boolean"!==t.type||(a.booleanWithoutAuthRange=!0,r.elementsTree=a._generateOptionsForAutoComplete([!0,!1]));let o=[];t.value&&Array.isArray(t.value)&&t.value.forEach(e=>{e=a.tweakerInput._getEnumValue(e),a.booleanWithoutAuthRange&&(e=a.tweakerInput.__getBoolIdFromValue(e)),o.push(e)}),r.value=o,r.placeholder=t.placeholder?t.placeholder:i.get("Select a value"),!0===t.showPlaceHolder&&(r.value=[]);let u=new l(r);a.element=u,u.addEventListener("change",function(e){let t=e.dsModel.value,n=[];t.forEach(function(e){let t=a.tweakerInput._getEnumValue(e);"_DS_ENUM_NULL_"!==t&&void 0!==t||(t=""),n.push(t)}),a.changesFiredByAutocomplete=!0,a._dispatchChange(n,!0)}),n.call(a,u)}):require(["DS/Controls/SelectionChipsEditor","DS/Controls/DatePicker"],function(i,s){let l={value:[],customValidator:function(t){if(a.tweakerInput.type!==e.TYPES.NUMBER_WUX&&a.tweakerInput.type!==e.TYPES.INTEGER_WUX||!isNaN(t))return t},placeholder:t.placeholder?t.placeholder:a.getPlaceholder(t.type)},r={placeholder:t.placeholder?t.placeholder:a.getPlaceholder(t.type),value:[],allowMultipleValuesFlag:!0,timePickerFlag:!0,timePickerPrecision:"sec"},o=null;a.tweakerInput.type===e.TYPES.DATE_WUX||a.tweakerInput.type===e.TYPES.DATETIME_WUX?(t.value&&Array.isArray(t.value)&&t.value.forEach(e=>{r.value.push(a.tweakerInput._computeValueForRO(e,t))}),!0===t.showPlaceHolder&&(r.value=[]),o=new s(r)):(t.value&&Array.isArray(t.value)&&t.value.forEach(e=>{"boolean"===a.options.type?("String"!=typeof e&&(e=e.toString()),e=e.toLowerCase(),l.value.push(a.tweakerInput.getConvertedDisplayValue[e])):l.value.push(a.tweakerInput._computeValueForRO(e,t))}),!0===t.showPlaceHolder&&(l.value=[]),o=new i(l)),a.element=o,o.addEventListener("change",function(n){let i=n.dsModel.value,s=[];i.forEach(function(n){if("function"==typeof a.tweakerInput._validate){let e=a.tweakerInput._validate(n);"object"==typeof e&&e.hasOwnProperty("type")&&e.hasOwnProperty("message")&&"error"===e.type?a._dispatchNotification("error",e.message):(e="number"==typeof e?e+"":e,s.push(e))}else{if((a.tweakerInput.type===e.TYPES.BOOLEAN_WUX||"boolean"===t.type)&&a.tweakerInput.convertTovalidValuesForBoolean){let e=a.tweakerInput.convertTovalidValuesForBoolean[n];!0!==e&&!1!==e||(n=e)}s.push(n)}}),a._dispatchChange(s)}),n.call(a,o)})},setValueToTweaker:function(e){let t=this,n=t.element.value,i=[];Array.isArray(e)&&e.length>0&&Array.isArray(e[0])&&(e=e[0]),e.forEach(e=>{"boolean"!==t.options.type?i.push(t.tweakerInput._computeValueForRO(e,t.options)):i.push(e)}),n&&!t.areEquals(i,n)&&(t._parent.apply(t,[e]),t.element.value=[],"function"==typeof t.element.addValues?t.element.addValues(i):t.element.value=i)},resetTweaker:function(){this.element.value=[]},_areValuesSame:function(e){let t=this,n=t.getElement().value;for(let i=0;i<e.length;i++){let a=e[i];if(t.changesFiredByAutocomplete?("function"==typeof t.tweakerInput.__getIdFromValue&&(a=t.tweakerInput.__getIdFromValue(e[i])),t.booleanWithoutAuthRange&&"function"==typeof t.tweakerInput.__getBoolIdFromValue&&(a=t.tweakerInput.__getBoolIdFromValue(e[i]))):a=t.tweakerInput._computeValueForRO(e[i]),n.indexOf(a)<0)return!1}return delete t.changesFiredByAutocomplete,!0},getPlaceholder:function(e){return"string"===e||"boolean"===e?i.get("Enter a value"):"integer"===e?i.get("Enter an integer"):"real"===e?i.get("Enter a number"):"date"===e?i.get("Enter or select a date"):i.get("Select a value")},_generateOptionsForAutoComplete:function(e){var t=this,n=[];return t.mapToStoreAutoCompleteOpts={},t.mapToStoreAutoCompleteOptsVal={},e.forEach(function(e){var i=t.tweakerInput.getDisplayValue(e,{escapeChar:!1,forHTML:!1});let a=e;"boolean"==typeof e&&(a=e.toString(),t.mapToStoreAutoCompleteOpts[e]=a,t.mapToStoreAutoCompleteOptsVal[a]=e),n.push({value:a,label:i})}),void 0===t.tweakerInput._getEnumValue&&(t.tweakerInput._getEnumValue=function(e){return t.mapToStoreAutoCompleteOptsVal[e]}),void 0===t.tweakerInput.__getBoolIdFromValue&&(t.tweakerInput.__getBoolIdFromValue=function(e){return t.mapToStoreAutoCompleteOpts[e]}),n}})}),define("DS/WidgetServicesUI/tweakers/TweakerDateWebUX",["DS/WidgetServices/WidgetServices","DS/WidgetServicesUI/helpers/Constants","DS/WidgetServicesUI/infra/TweakerBaseWebUX","DS/Controls/DatePicker","i18n!DS/WidgetServicesUI/assets/nls/i18nWidgetService"],function(e,t,n,i,a){"use strict";return n.extend({init:function(e){this._parent(e)},_build:function(e,t){var n=this,s=e.value,l=(e.mandatory,new i({value:s||void 0,timePickerFlag:!0,timePickerPrecision:"sec",placeholder:a.selectADate,allowUndefinedFlag:!0}));n.twElement=l,n.setClassNameForWebUXComponent(l,"input-date-label"),n.setIdForWebUXComponent(l,`tweakerDateWUX_attribute__${n.options.label}`),n.setStyleForWuxComponent(l,"width","100%"),l.addEventListener("change",function(t){var i=t.dsModel.value;n._dispatchChange(i,!0),e.multivalued&&(l.value=void 0)}),l.addEventListener("livechange",function(e){var t=e.dsModel.value;n._dispatchChange(t,!0)}),t.call(n,l)},areEquals:function(e,t){var n=this._methodForDisplay();return e&&t?e[n]()===t[n]():e===t},_methodForDisplay:function(){return this.type===t.TYPES.DATE?"toLocaleDateString":"toLocaleString"},_computeValueForRO:function(t){var n=this._methodForDisplay();return t?t[n](e.getLanguage()):""},_changeRW:function(e){var t=this.getElement();this.getElement().value=t instanceof i?e||"":e},resetTweaker:function(){this.twElement.value=void 0}})}),define("DS/WidgetServicesUI/tweakers/TweakerEnumWebUX",["DS/WidgetServicesUI/helpers/Constants","DS/WidgetServicesUI/infra/TweakerEnumBaseWebUX","DS/UIKIT/Input/Select","DS/UIKIT/Autocomplete","DS/WidgetServices/WidgetServices","DS/Controls/ComboBox","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/WUXAutoComplete/AutoComplete","i18n!DS/WidgetServicesUI/assets/nls/i18nWidgetService"],function(e,t,n,i,a,s,l,r,o,u){"use strict";return t.extend({_build:function(e,t){var n=this,i="";(""!==e.value||""==e.value&&this.mapOptions._DS_ENUM_NULL_)&&(i=this.__getIdFromValue(e.value));var r,c=e.data.list,h=!0===e.data.placeholder?u.SelectOption:!!e.data.placeholder&&e.data.placeholder,p=this.options.multisel;if(void 0===p&&(p=this.options.data.list[0].valueObj._ismultisel),"_DS_ENUM_NULL_"!=c[0].value&&!1===p)for(var d=0;d<c.length;d++){if("_DS_ENUM_NULL_"===c[d].value){r=d;break}}if("_DS_ENUM_NULL_"!=c[0].value&&null!=r&&!1===p){for(var v=c[r],_=r;_>0;_--)c[_]=c[_-1];c[0]=v}var g=!0===e.customSelect,m=!0===e.sortedOptions,f=!0===e.autocomplete;if(m){var S="en";widget&&widget.lang&&(S=widget.lang),c.sort(function(e,t){return e.label.localeCompare(t.label,S,{numeric:!0})})}if(f){var w=[];for(_=0;_<c.length;_++){var E=c[_].label,I=c[_].value;w.push({label:E,value:I})}var T={elementsTree:w,multiSearchMode:!1,placeholder:u["Enter a value"],value:i},U=new o(T);U.addEventListener("change",function(e){var t=e.dsModel.value;if(D||t&&t.length>0&&t!==i){var a=n._getEnumValue(t);"_DS_ENUM_NULL_"!==a&&void 0!==a||(a=""),n._dispatchChange(a,!0)}D=!0,t||n._dispatchChange(void 0,!0)}),t.call(this,U)}else{e.isMultiSel&&null===i&&(i=e.value),null===i&&(this.data.value=c.length>0?this._getEnumValue(c[0].value):null);var D=!1;c=e.applySort?n.sortDropdownOptions(c,e.isMultiSel,e.type):c,n.enumFinalOptionsList=c;for(var y=!1,k=0;k<c.length;k++)if(c[k].hasOwnProperty("group")&&c[k].group){y=!0;break}var V={};if(y){for(k=0;k<c.length;k++){var b=c[k].label,W=c[k].value,C=c[k].group,A={label:b,value:W,icon:{iconPath:c[k].icon,iconSize:{width:"16px",height:"16px"}}};V[C]=C in V?[...V[C],A]:[A]}var O=new l({shouldBeSelected:function(e){return"group"!==e.options.sectionName}});for(var k in O.prepareUpdate(),V){var R=n.createTreeNodeModel(k,void 0,void 0,"group");O.addRoot(R);for(_=0;_<V[k].length;_++){var x=V[k][_].label,N=V[k][_].value,M=V[k][_].icon,F=n.createTreeNodeModel(x,N,M,"subGroup");R.addChild(F)}}O.pushUpdate(),O.expandAll(),c=O}var L={value:i,enableSearchFlag:"click"!==e.dropdownMode,placeholder:h,generateRegexpString:function(e){return e.escapeRegExp()},autocompleteFlag:!1};y?(L.enableSearchFlag=!1,L.elementsTree=c,L.selectedIndex=1):L.elementsList=c,e.nested&&0===e.defaultValue&&(L.selectedIndex=e.defaultValue),a.isReplayedODT()&&(g=!0),L.custom=g,e.placeholder&&(h=L.placeholder=e.placeholder),!0===e.customSelect&&(L.renderTo=document.body),!0===e.showPlaceHolder&&(L.value=void 0);var P=new s(L);n.options.multivalued&&(P.displayStyle="lite"),n.setClassNameForWebUXComponent(P,"input-AuthorizedValuesboolean-label"),n.setStyleForWuxComponent(P,"width","100%");var B="change";e.multivalued&&(B="click"),P.addEventListener(B,function(t){var a=P.value;if(D||a!==i){var s=n._getEnumValue(a);"_DS_ENUM_NULL_"!==s&&void 0!==s||(s=""),n._dispatchChange(s,!0)}D=!0,e.multivalued&&(P.value=void 0)}),n.twElement=P,t.call(this,P);var j=this.getValue();if(!0!==e.nested&&!h&&null!=i&&null!=j&&i!==j){var X=n._getOptions(i);UWA.is(X)&&n.areEquals(j,X.valueObj)||n._dispatchChange(j,!0)}}},getValue:function(){return"_DS_ENUM_NULL_"===this.data.value||void 0===this.data.value?"":this.data.value},_changeRW:function(e){var t=this._getIdFromValue(e),n=this.getElement();UWA.is(n.setValue,"function")?n.setValue(t):n.value=t},focus:function(){var e=this.getElement();setTimeout(function(){e&&e.focus()},0)},sortDropdownOptions:function(e,t,n){var i=!1,a=[],s=null,l=null;return e.forEach(function(e){"_DS_ENUM_NULL_"===e.value?(s=e,i=!0):"0_No_change"===e.value?l=e:a.push(e)}),"string"===n||"boolean"===n||"text"===n?a=this._sortOptionsForWebUXComboBox(a,!1):"integer"===n||"real"===n?a=this._sortOptionsForWebUXComboBox(a,!0):"timestamp"!==n&&"date"!==n||(a=this._sortOptionsForWebUXComboBoxTypeDate(a)),e=[],t&&e.push(l),i&&e.push(s),a.forEach(function(t){e.push(t)}),e},_sortOptionsForWebUXComboBox:function(e,t){return e.sort((e,n)=>e.label.localeCompare(n.label,widget&&widget.lang||"en",{caseFirst:"lower",numeric:t,sensitivity:"case"}))},_sortOptionsForWebUXComboBoxTypeDate:function(e){return e.sort(function(e,t){return new Date(e.label)-new Date(t.label)})},createTreeNodeModel:function(e,t,n,i){var a={};return e&&(a.label=e),t&&(a.grid={valueItem:t}),n&&(a.icons=[n]),i&&(a.sectionName=i),new r(a)},resetTweaker:function(){this.twElement.value=void 0}})}),define("DS/WidgetServicesUI/tweakers/TweakerPersonWebUX",["DS/WidgetServicesUI/infra/TweakerBaseWebUX"],function(e){"use strict";return e.extend({init:function(e){this._parent(e)},_build:function(e,t){var n=this;require(["DS/SearchWidget/SearchWidget","DS/SearchWidget/SearchWidgetConstant"],function(i,a){var s=e.value,l=a.TYPE_PERSON,r=i.getSearchWidget(i.FULL,{className:"EPP_searchPeople",MaxNumber:"3",MaxSize:"300",showEmptyCategory:!1,setBorderColor:!0,acceptEmpty:!n.options.mandatory,type:l,tw_type:n.options.tw_type,source:n.options.source,events:{onValid:function(){var e=r.getNewOwner();if(e&&e.person&&e.person.personFullName){var t=e.person.personFullName,i=e.person.personID;t={fullName:t,personID:i=i?i.replace(/_PRJ$/,""):i};n._dispatchChange(t,!0)}},onUnvalid:function(){var e={fullName:e=r.getDisplayedResult(),personID:null};n._dispatchChange(e)},onError:function(e){n._setError(e)}}}),o=[];e.data&&e.data.objectIDs&&e.data.objectIDs.forEach(function(e){o.push({objectID:e})}),r.setSelectedItemList(o),s&&r.setValue(s.fullName),t.call(this,r)})},actionOnScroll:function(){this.getElement()&&this.getElement().actionOnScroll()},_computeValueForRO:function(e){return e?e.fullName:""},areEquals:function(e,t){return e.personID===t.personID},_changeRW:function(e){},_getValueOrDefault:function(e){return e||{personID:"",fullName:""}}})}),define("DS/WidgetServicesUI/helpers/Helpers",["DS/WidgetServices/MultipleAsynchronousRequests","DS/WidgetServicesUI/helpers/Constants","DS/WidgetServicesUI/tweakers/TweakerPerson","DS/WidgetServicesUI/tweakers/TweakerString","DS/WidgetServicesUI/tweakers/TweakerNumber","DS/WidgetServicesUI/tweakers/TweakerDate","DS/WidgetServicesUI/tweakers/TweakerBoolean","DS/WidgetServicesUI/tweakers/TweakerOutput","DS/WidgetServicesUI/tweakers/TweakerNumberWebUX","DS/WidgetServicesUI/tweakers/TweakerStringWebUX","DS/WidgetServicesUI/tweakers/TweakerDateWebUX","DS/WidgetServicesUI/tweakers/TweakerBooleanWebUX","DS/WidgetServicesUI/tweakers/TweakerPersonWebUX","DS/WidgetServicesUI/tweakers/TweakerEnumWebUX","DS/WidgetServicesUI/tweakers/TweakerMVAWebUX","DS/WidgetServicesUI/tweakers/TweakerUnitWebUX"],function(e,t,n,i,a,s,l,r,o,u,c,h,p,d,v,_){var g={},m={};m[t.TYPES.BOOLEAN]={req:"DS/WidgetServicesUI/tweakers/TweakerBoolean"},m[t.TYPES.STRING]={req:"DS/WidgetServicesUI/tweakers/TweakerString"},m[t.TYPES.NUMBER]={req:"DS/WidgetServicesUI/tweakers/TweakerNumber"},m[t.TYPES.INTEGER]={req:"DS/WidgetServicesUI/tweakers/TweakerNumber"},m[t.TYPES.ENUM]={req:"DS/WidgetServicesUI/tweakers/TweakerEnum"},m[t.TYPES.PERSON]={req:"DS/WidgetServicesUI/tweakers/TweakerPerson"},m[t.TYPES.DATE]={req:"DS/WidgetServicesUI/tweakers/TweakerDate"},m[t.TYPES.DATETIME]={req:"DS/WidgetServicesUI/tweakers/TweakerDate"},m[t.TYPES.HTML]={req:"DS/WidgetServicesUI/tweakers/TweakerHTML"},m[t.TYPES.OUTPUT]={req:"DS/WidgetServicesUI/tweakers/TweakerOutput"},m[t.TYPES.BUTTONWEB]={req:"DS/WidgetServicesUI/tweakers/TweakerButtonWeb"},m[t.TYPES.DROPDOWN]={req:"DS/WidgetServicesUI/tweakers/TweakerDropdown"},m[t.TYPES.REPLACEMENT]={req:"DS/WidgetServicesUI/tweakers/TweakerReplacement"},m[t.SPE_TYPES.MVA]={req:"DS/WidgetServicesUI/tweakers/TweakerMVA"},m[t.TYPES.IMAGE]={req:"DS/WidgetServicesUI/tweakers/TweakerImage"},m[t.TYPES.MULTIPLE]={req:"DS/WidgetServicesUI/tweakers/TweakerMultiple"},m[t.TYPES.RELATION]={req:"DS/WidgetServicesUI/tweakers/TweakerRelation"},m[t.TYPES.BOOLEAN_WUX]={req:"DS/WidgetServicesUI/tweakers/TweakerBooleanWebUX"},m[t.TYPES.NUMBER_WUX]={req:"DS/WidgetServicesUI/tweakers/TweakerNumberWebUX"},m[t.TYPES.INTEGER_WUX]={req:"DS/WidgetServicesUI/tweakers/TweakerNumberWebUX"},m[t.TYPES.STRING_WUX]={req:"DS/WidgetServicesUI/tweakers/TweakerStringWebUX"},m[t.TYPES.DATE_WUX]={req:"DS/WidgetServicesUI/tweakers/TweakerDateWebUX"},m[t.TYPES.DATETIME_WUX]={req:"DS/WidgetServicesUI/tweakers/TweakerDateWebUX"},m[t.TYPES.PERSON_WUX]={req:"DS/WidgetServicesUI/tweakers/TweakerPersonWebUX"},m[t.TYPES.ENUM_WUX]={req:"DS/WidgetServicesUI/tweakers/TweakerEnumWebUX"},m[t.SPE_TYPES.MVA_WUX]={req:"DS/WidgetServicesUI/tweakers/TweakerMVAWebUX"},m[t.TYPES.MULTIPLE_WUX]={req:"DS/WidgetServicesUI/tweakers/TweakerMultipleWebUX"},m[t.TYPES.REPLACEMENT_WUX]={req:"DS/WidgetServicesUI/tweakers/TweakerReplacementWebUX"},m[t.TYPES.DUMMY_BOOKMARK]={req:"DS/WidgetServicesUI/tweakers/TweakerDummyBookmark"},m[t.TYPES.UNIT]={req:"DS/WidgetServicesUI/tweakers/TweakerUnitWebUX"},m[t.TYPES.USAGE_DIM]={req:"DS/SpecRawMaterial/tweakers/UsageDimensionTweaker"},m[t.TYPES.REFERENCEQTY]={req:"DS/CreateSpecification/tweakers/ReferenceBatchQtyTweaker"};var f=function(e,t,n){g[e]={element:n,requireStr:t}},S=function(e,t,n){var i=g[e];if(i&&i.requireStr===t)n.call(null,i.element);else require([t],function(i){f(e,t,i),n.call(null,i)})};return f(t.TYPES.STRING,m[t.TYPES.STRING].req,i),f(t.TYPES.PERSON,m[t.TYPES.PERSON].req,n),f(t.TYPES.NUMBER,m[t.TYPES.NUMBER].req,a),f(t.TYPES.INTEGER,m[t.TYPES.INTEGER].req,a),f(t.TYPES.DATETIME,m[t.TYPES.DATETIME].req,s),f(t.TYPES.DATE,m[t.TYPES.DATE].req,s),f(t.TYPES.OUTPUT,m[t.TYPES.OUTPUT].req,r),f(t.TYPES.STRING_WUX,m[t.TYPES.STRING_WUX].req,u),f(t.TYPES.NUMBER_WUX,m[t.TYPES.NUMBER_WUX].req,o),f(t.TYPES.INTEGER_WUX,m[t.TYPES.INTEGER_WUX].req,o),f(t.TYPES.DATETIME_WUX,m[t.TYPES.DATETIME_WUX].req,c),f(t.TYPES.DATE_WUX,m[t.TYPES.DATE_WUX].req,c),f(t.TYPES.PERSON_WUX,m[t.TYPES.PERSON_WUX].req,p),f(t.TYPES.UNIT,m[t.TYPES.UNIT].req,_),{getTweaker:function(n,i,a){var s,l=this,r=!0===i.multivalued,o=n!==t.TYPES.ENUM&&n!==t.TYPES.ENUM_WUX&&i.data&&void 0!==i.data.list,u=o&&i.data&&!1!==i.data.range_required,c=!0===i.multisel,h=["A"];r&&h.push("B"),o&&h.push("C"),c&&h.push("D");var p=new e(h,function(){var e=this.getAnswer("A"),s=this.getAnswer("B"),r=this.getAnswer("C"),o=this.getAnswer("D");s&&(r||n===t.TYPES.ENUM)&&(i.data=i.data?i.data:{},i.data.placeholder=!i.data.placeholder||i.data.placeholder);var u=UWA.clone(i);u.tw_type=n,s||o?(u.value=null,u.nested=null!=s||null!=o,u.events={}):r||(u.value=i.value);var c=new e(u);if(r){var h=null!=s||null!=o,p=s?UWA.clone(u):UWA.clone(i);p.tweaker=c,p.nested=null!=s||null!=o,p.value=h?null:i.value,c=new r(p)}if(s){h=null!=o;var d=UWA.clone(i);d.tweaker=c,d.nested=null!=o,d.value=h?[]:i.value,d.events=h?{}:d.events,c=new s(d)}if(o){var v=UWA.clone(i);v.tweaker=c,v.value=i.value,c=new o(v)}a.call(l,c)});if(r&&!l.isTwTypeIsWUX(n)?S(t.SPE_TYPES.MVA,"DS/WidgetServicesUI/tweakers/TweakerMVA",function(e){p.setAnswer("B",e)}):r&&l.isTwTypeIsWUX(n)&&S(t.SPE_TYPES.MVA_WUX,m[t.SPE_TYPES.MVA_WUX].req,function(e){p.setAnswer("B",e)}),o&&!l.isTwTypeIsWUX(n)){var d=u?t.TYPES.ENUM:t.TYPES.DROPDOWN;S(t.SPE_TYPES.ENUM,m[d].req,function(e){p.setAnswer("C",e)})}else if(o&&l.isTwTypeIsWUX(n)){d=u?t.TYPES.ENUM_WUX:t.TYPES.DROPDOWN;S(t.SPE_TYPES.ENUM,m[d].req,function(e){p.setAnswer("C",e)})}c&&!l.isTwTypeIsWUX(n)?S(t.TYPES.MULTIPLE,m[t.TYPES.MULTIPLE].req,function(e){p.setAnswer("D",e)}):c&&l.isTwTypeIsWUX(n)&&S(t.TYPES.MULTIPLE_WUX,m[t.TYPES.MULTIPLE_WUX].req,function(e){p.setAnswer("D",e)});var v=m[n];v||(v=!0===i.readOnly?m[t.TYPES.OUTPUT]:m[t.TYPES.STRING]),s=v.req,!0===window.top.isDebug&&console.log("Load Tweaker "+n+" : "+window.top.performance.now()),S(n,s,function(e){!0===window.top.isDebug&&console.log("Tweaker Loaded "+n+" : "+window.top.performance.now()),p.setAnswer("A",e)})},getAdvTweaker:function(e,n,i){var a=this,s=null;switch(n.touchMode=!0,e){case t.TYPES.BOOLEAN:s="DS/Tweakers/TweakerBoolean";break;case t.TYPES.NUMBER:s="DS/Tweakers/TweakerNumber";break;default:s=null}null!==s?S(e,s,function(e){var t=new e(n);if(n.events)for(var s in n.events)t.addEventListener(s,n.events[s]);i.call(a,t)}):this.getTweaker(e,n.value,n,i)},isTwTypeIsWUX:function(e){return e===t.TYPES.BOOLEAN_WUX||e===t.TYPES.STRING_WUX||e===t.TYPES.NUMBER_WUX||e===t.TYPES.INTEGER_WUX||e===t.TYPES.DATE_WUX||e===t.TYPES.DATETIME_WUX||e===t.TYPES.PERSON_WUX||e===t.TYPES.ENUM_WUX||e===t.TYPES.UNIT}}}),define("DS/WidgetServicesUI/tweakers/TweakerMultipleWebUX",["DS/WidgetServicesUI/helpers/Constants","DS/WidgetServicesUI/infra/TweakerBaseWebUX","DS/WidgetServicesUI/helpers/Helpers","DS/UIKIT/Input/Select","DS/UIKIT/Input/Button","DS/Controls/TooltipModel","DS/WidgetServices/WidgetServices","DS/WidgetServicesUI/tweakers/TweakerStringWebUX","DS/WidgetServicesUI/tweakers/TweakerWUXButton","UWA/Core","DS/Tweakers/TweakerString","i18n!DS/WidgetServicesUI/assets/nls/i18nWidgetService","css!DS/WidgetServicesUI/WidgetServicesUI"],function(e,t,n,i,a,s,l,r,o,u,c,h){"use strict";return t.extend({_tweakerInput:null,_tweakerBuilt:!1,_editorStatus:"single",_multipleChoices:!1,_nbSelectCreated:0,_selectValueList:null,init:function(t){this._tweakerBuilt=!1,this._multipleChoices=!1,this._editorStatus="replace",this._nbSelectCreated=0,this.type=e.SPE_TYPES.MULTISEL,this._tweakerInput=t.tweaker,this.userAction=null,this.multipleValues=[],this.resetUIOnly=!1,this.menuInjectedInUI=!1,this.options=t,this._parent(t)},getDisplayValues:function(e,t){if(t&&!0===t.singleLine)return this._parent(e,t);var n={},i=this.getValue();for(var a in i)n[a]=this._tweakerInput.getDisplayValues(i[a],{forHTML:!1});return n},_generateValueForSelectTweaker:function(e,t,n){var i=this,a=[];t.length>1&&(!this.elements.replacementContainer||this.elements.replacementContainer.getValue()!==n)&&(u.clone(n)._ismultisel=!0,e.forEach(function(e){var t=i._tweakerInput.getDisplayValue(e,{escapeChar:!1,forHTML:!1});a.push({value:e,label:t})}));return a},_build:function(e,t){this.elements.twMulticontainer=u.createElement("div",{class:"tweaker_multiSelContainer"}),this.elements.inputContainer=u.createElement("div",{class:"tweaker_inputContainer"}),this.elements.multiselectionMenuContainer=u.createElement("div",{class:"multiselectionMenuContainer"}),this.elements.multiselectionMenuContainer.inject(this.elements.twMulticontainer),this._tweakerInput.inject(this.elements.inputContainer),this.elements.inputContainer.inject(this.elements.twMulticontainer),this._buildMultiSelMenu(e),"boolean_wux"===this._tweakerInput.options.tw_type&&!1===this.options.multivalued?this._buildBooleanTweaker():this._buildTweaker(),t.call(this,this.elements.twMulticontainer)},_setValueOnData:function(e){let t=this;null!==e&&e._ismultisel;var n=u.clone(this.getValue());let i=this.options.value;for(var a in n)"object"==typeof e&&null!==e[a]&&void 0!==e[a]&&e[a].toString().length>=0?n[a]=this.setValueAsPerUserAction(n[a],e[a],i[a]):n[a]=this.setValueAsPerUserAction(n[a],e,i[a]);if(this._toggleResetMenu(e),this._isTweakerEmpty(e)&&void 0!==t.resetUIOnly&&null!==t.resetUIOnly&&!1===t.resetUIOnly&&this.menuInjectedInUI){if(t._checkValuesEquality(n,i))return t.prevUserActionTemp&&(t.userAction=t.prevUserAction,t.prevUserAction=t.prevUserActionTemp),this.changedValue=n,n;t.prevUserActionTemp=t.prevUserAction,t.prevUserAction=t.userAction,t.userAction="reset_value",n=t._setValueOnData(e),t.userAction=t.prevUserAction}return this.changedValue=n,n},_computeValueForRO:function(e,t){if("object"==typeof e){var n=[];for(var i in e){var a=e[i];if(t&&t.forClickable)var s=this._tweakerInput.getDisplayValue(a,{forClickable:!0});else s=this._tweakerInput.getDisplayValue(a);n.indexOf(s)<0&&n.push(s)}let l="",r=this._areSame(e);if(this.multipleValues=n,n.length>1){if(r||(l=h.get("tw_mulitsel_multiple_prefix")),this._buildTooltip)return l.length>0?l+=": "+n.join(", "):l=n.join(", "),l;r&&(l=n.join(", "))}else l=n[0];return l}return t&&t.forClickable?this._tweakerInput.getDisplayValue(e,{forClickable:!0}):this._tweakerInput.getDisplayValue(e)},_buildReplacement:function(t){var i=this;if(this.elements.replacementContainer)i.elements.inputContainer&&i.elements.inputContainer.empty(),i.elements.replacementContainer.inject(i.elements.inputContainer),i.__dispatchValueFromTweaker(i.elements.replacementContainer);else{var a={value:u.clone(t),readOnly:!1,editable:!0,nested:!0,events:{change:function(e){i.__dispatchValueFromTweaker(this,e)},notification:this._dispatchNotificationObj.bind(this)},isMultiSel:!0};i.options.type&&(a.type=i.options.type),n.getTweaker(e.TYPES.REPLACEMENT_WUX,a,function(e){i.elements.replacementContainer||(i.elements.replacementContainer=e),i.elements.inputContainer&&i.elements.inputContainer.empty(),i.elements.replacementContainer.inject(i.elements.inputContainer),i.__dispatchValueFromTweaker(i.elements.replacementContainer)})}},_buildSelect:function(t){var i=this;this._multipleChoices=!0,this.elements.select&&(this.elements.select.destroy(),delete this.elements.select);var a={data:{list:t},readOnly:!1,editable:!0,nested:!0,events:{change:function(e){i.__dispatchValueFromTweaker(this,e)}},isMultiSel:!0};t&&Array.isArray(t)&&t.length>0&&t[0]&&t[0].value&&"object"==typeof t[0].value&&(a.value=t[0].value),a.data.placeholder=h.get("tw_mulitsel_multiple_prefix");let s=this.getValue();if(i._areSame(s)){let e=i._getSingleValues(s);a.value=e[0]}else a.showPlaceHolder=!0;i.options.prop&&(a.prop=!0),i.options.applySort&&(a.applySort=i.options.applySort),i.options.type&&(a.type=i.options.type),this._nbSelectCreated++;var l=this._nbSelectCreated;n.getTweaker(e.TYPES.ENUM_WUX,a,function(e){l===i._nbSelectCreated&&(i.elements.inputContainer&&i.elements.inputContainer.empty(),"boolean_wux"===i._tweakerInput.options.tw_type?(i._tweakerInput=e,i._tweakerInput.inject(i.elements.inputContainer)):(i.elements.select=e,i.elements.select.inject(i.elements.inputContainer)))})},__dispatchValueFromTweaker:function(e,t,n){null==t&&(t=e.getValue());var i;i=this._setValueOnData(t),"reset_value"!==this.userAction&&(!0===n?this._dispatchLiveChange(i):this._dispatchChange(i))},_buildTweaker:function(e){var t=this;this._tweakerBuilt=!0,t.elements.inputContainer&&(t.elements.inputContainer.empty(),this._tweakerInput.inject(t.elements.inputContainer));let n=this.getValue();if(t._areSame(n)){let e=t._getSingleValues(n);e=Array.isArray(e)&&e.length>0&&Array.isArray(e[0])?e[0]:e,t.options.multivalued?this._tweakerInput.data.value=e:this._tweakerInput.data.value=e[0]}else this._tweakerInput.options.data&&!t.options.multivalued?this._tweakerInput.options.data.placeholder=h.get("tw_mulitsel_multiple_prefix"):this._tweakerInput.options.placeholder=h.get("tw_mulitsel_multiple_prefix"),this._tweakerInput.options.showPlaceHolder=!0;this._tweakerInput.__switchMode(!0,e),this._tweakerInput.addEvent("change",function(){var e=this.getValue();t.__dispatchValueFromTweaker(this,e)}),this._tweakerInput.addEvent("liveChange",function(){var e=this.getValue();t.__dispatchValueFromTweaker(this,e,!0)})},areEquals:function(e,t){var n=Object.keys(e),i=Object.keys(t),a=e===t||e&&t&&n.length===i.length;if(e&&a)for(var s in e){var l=e[s],r=t[s];if(!(a=l instanceof Date&&r instanceof Date?l.toLocaleString()===r.toLocaleString():this._tweakerInput.areEquals(l,r)))break}return a},_getSingleValues:function(e){var t=this,n=[];for(var i in e){var a=e[i];l.arrayContains2(n,a,function(e,n){return t._tweakerInput.areEquals(e,n)})<0&&n.push(a)}return n},_limitValForRange:function(e){if(this.options&&this.options.data&&this.options.data.range_required&&this.options.data.list){var t=[],n=[],i=new Map;for(var a in this.options.data.list)t.push(this.options.data.list[a].value),n.push(this.options.data.list[a].label),i.set(this.options.data.list[a].label,this.options.data.list[a].value);var s=[];e.forEach(function(e){Array.isArray(e)?e.forEach(function(e){s.push(e)}):s.push(e)});var l=s.filter(function(e,n,i){return t.indexOf(e)>-1});if(this.options.multivalued&&this.options.trueEnum&&!l.length){l=s.filter(function(e,t,i){return n.indexOf(e)>-1});for(a=0;a<l.length;a++)l[a]&&i.has(l[a])&&(l[a]=i.get(l[a]))}return l}return e},_getValueOrDefault:function(e){return e},_changeRW:function(t,n){if(n&&this._areSame(t)&&this.elements.multiselectionMenuContainer&&(this.menuInjectedInUI=!1,this.elements.multiselectionMenuContainer.empty()),"reset_value"!==this.userAction){if(!this.changedValue||!this._checkValuesEquality(this.changedValue,t)){var i=this._getSingleValues(t);if(i=Array.isArray(i)&&i.length>0&&Array.isArray(i[0])&&i[0].length>0?i[0]:i,this._tweakerInput.type===e.TYPES.PERSON_WUX&&i&&i.personID&&null!=i.personID)this._tweakerInput.setValue(i);else if(Array.isArray(i))if(this._tweakerInput.options.multivalued)this._tweakerInput.setValue(i);else for(let e of i)this._tweakerInput.setValue(e);else this._tweakerInput.setValue(i)}}else this.userAction=this.prevUserAction},getCallback:function(e){let t=this,n={};return n.MVA_replace_with_a_new_value=t._buildTweaker,n.MVA_add_to_existing_values=t._buildTweaker,n.sva_replace_with_a_new_value=t._buildTweaker,n.reset_value=function(){t._tweakerInput.resetTweaker&&t._tweakerInput.resetTweaker(),t.elements.select&&t.elements.select.resetTweaker&&t.elements.select.resetTweaker(),t.elements.replacementContainer&&t.elements.replacementContainer.resetTweaker&&t.elements.replacementContainer.resetTweaker(),t._dispatchReset()},n.sva_replace_with_an_existing_value=function(){var e=this._getSingleValues(t.getValue());this._selectValueList=u.clone(e);var n=this._generateValueForSelectTweaker(e,e,this.getValue());t._buildSelect(n)},n.sva_find_and_replace_value=function(){t._buildReplacement(this.getValue())},n[e]},setValueAsPerUserAction:function(e,t,n){let i=this,a=i.userAction;return null==a||"MVA_replace_with_a_new_value"===a||"sva_replace_with_an_existing_value"===a||"sva_replace_with_a_new_value"===a||"sva_find_and_replace_value"===a?t:"MVA_add_to_existing_values"===a?i.areEquals(n,t)?t:Array.isArray(n)&&n.length>0?[...n,...t]:t:"reset_value"===a?n:void 0},getOptionsForMenu:function(t){let n=[{icon:{iconName:"refresh wux-ui-3ds",fontIconFamily:1},label:h.get("Replace with a new value"),value:"MVA_replace_with_a_new_value"},{icon:{iconName:"refresh wux-ui-3ds",fontIconFamily:1},label:h.get("Replace with existing value"),value:"sva_replace_with_an_existing_value"},{icon:{iconName:"plus wux-ui-3ds",fontIconFamily:1},label:h.get("Add to existing values"),value:"MVA_add_to_existing_values"},{icon:{iconName:"reset wux-ui-3ds",fontIconFamily:1},label:h.get("Reset value"),value:"reset_value",disabled:!0}],i=[{icon:{iconName:"refresh wux-ui-3ds",fontIconFamily:1},label:h.get("Replace with a new value"),value:"sva_replace_with_a_new_value"},{icon:{iconName:"refresh wux-ui-3ds",fontIconFamily:1},label:h.get("Replace with existing value"),value:"sva_replace_with_an_existing_value"},{icon:{iconName:"search wux-ui-3ds",fontIconFamily:1},label:h.get("Find and Replace value"),value:"sva_find_and_replace_value"},{icon:{iconName:"reset wux-ui-3ds",fontIconFamily:1},label:h.get("Reset value"),value:"reset_value",disabled:!0}];if(this.optionsNls={MVA_replace_with_a_new_value:h.get("Replace with a new value"),sva_replace_with_a_new_value:h.get("Replace with a new value"),MVA_add_to_existing_values:h.get("Add to existing values"),reset_value:h.get("Reset value"),sva_replace_with_an_existing_value:h.get("Replace with existing value"),sva_find_and_replace_value:h.get("Find and Replace value")},this.optionsForSelect=this._getSingleValues(this.options.value),this.optionsForSelect.length<=1||"boolean"===t.type)for(let e=0;e<i.length;e++)"sva_replace_with_an_existing_value"===i[e].value&&i.splice(e,1);if(t.tweaker.type!==e.TYPES.STRING_WUX)for(let e=0;e<i.length;e++)"sva_find_and_replace_value"===i[e].value&&i.splice(e,1);if(t.tweaker.type===e.TYPES.PERSON_WUX)for(let e=0;e<i.length;e++)"reset_value"===i[e].value&&i.splice(e,1);return!0===t.multivalued?n:i},_buildMultiSelMenu:function(e){let t=this;if(t._areSame(e.value))return;let n=t.getOptionsForMenu(e),i=new c({displayStyle:"icon",possibleValues:n,value:n[0].value});t.twStrElement=i,t.userAction=n[0].value,t.prevUserAction=t.userAction,i.tooltipInfos=new s({shortHelp:n[0].label,mouseRelativePosition:!0});let a=!0;i.addEventListener("change",function(e){if(!a)return void(a=!0);let n=i.value;i.tooltipInfos.shortHelp=t.optionsNls[n],t.prevUserAction=t.userAction,t.userAction=n;let s=t.getCallback(n);"function"==typeof s&&s.call(t,!0),t._checkValuesEquality(t.getValue(),t.options.value)||t.__dispatchValueFromTweaker(t,t.getValue()),"reset_value"===n&&(a=!1,i.value=t.prevUserAction,i.tooltipInfos.shortHelp=t.optionsNls[t.prevUserAction],t._toggleResetMenu(""))}),t.elements.multiselectionMenuContainer&&(t.elements.multiselectionMenuContainer.empty(),t.menuInjectedInUI=!0,i.inject(t.elements.multiselectionMenuContainer))},_toggleResetMenu:function(e){let t=this;if(t.twStrElement){let n=t.twStrElement.possibleValues.length;t._isTweakerEmpty(e)?t.twStrElement.possibleValues[n-1].disabled=!0:t.twStrElement.possibleValues[n-1].disabled=!1}},_isTweakerEmpty:function(e){const t=function(e){return e&&void 0!==e.getDate?e&&e.toLocaleString().length>0:"boolean"==typeof e?e.toString().length>0:e&&e.toString().length>0};let n=!1;if("object"!=typeof e||Array.isArray(e)||void 0!==e.getDate)if(Array.isArray(e)&&void 0===e.getDate)for(let n of e){if(t(n))return!1}else n=t(e);else for(let n in e){if(t(e[n]))return!1}return!n},_buildBooleanTweaker:function(){var e=this._getSingleValues(this.options.value);this._selectValueList=u.clone(e);let t=[!0,!1];var n=this._generateValueForSelectTweaker(t,t,this.getValue());this._buildSelect(n)},_areSame:function(e){let t=!0,n=Object.keys(e);for(let i=1;i<n.length;i++){let a=e[n[i-1]],s=e[n[i]];if(null===a||null===s||void 0===a||void 0===s)return!1;if(Array.isArray(a)&&Array.isArray(s)){if(a.length!==s.length)return!1;for(let e=0;e<a.length;e++)if("object"==typeof a[e]&&"object"==typeof s[e])if(a[e]instanceof Date&&s[e]instanceof Date){if(a[e].toLocaleString()!==s[e].toLocaleString())return!1}else{if(Object.keys(a[e]).length!==Object.keys(s[e]).length)return!1;for(let t in a[e])if(a[e][t]!=s[e][t])return!1}else if(Array.isArray(a)){let e=new Map;for(let t=0;t<a.length;t++)e.set(a[t],(e.get(a[t])||0)+1);for(let t=0;t<s.length;t++)e.set(s[t],(e.get(s[t])||0)-1);for(let[n,i]of e)if(0!=i&&(t=t&&!1),!1===t)return!1}else if(a[e]!==s[e])return!1}else if("object"==typeof a&&"object"==typeof s)if(a instanceof Date&&s instanceof Date){if(a.toLocaleString()!==s.toLocaleString())return!1}else{if(Object.keys(a).length!==Object.keys(s).length)return!1;for(let e in a)if(a[e]!=s[e])return!1}else if(a!==s)return!1}return t},_checkValuesEquality:function(e,t){let n=Object.keys(e),i=Object.keys(t);if(n.length!=i.length)return!1;let a=!0;for(let s=0;s<n.length;s++){let l=e[n[s]],r=t[i[s]];if(null===l||null===r||void 0===l||void 0===r)return!1;if("object"!=typeof l||Array.isArray(l))if(Array.isArray(l)){let e=new Map;for(let t=0;t<l.length;t++)e.set(l[t],(e.get(l[t])||0)+1);for(let t=0;t<r.length;t++)e.set(l[t],(e.get(l[t])||0)-1);for(let[t,n]of e)0!=n&&(a=a&&!1)}else a=a&&l===r;else a=l instanceof Date?a&&l.toLocaleString()===r.toLocaleString():a&&this.areEquals(l,r)}return a},resetUI:function(){let e=this;e.twStrElement&&(e.prevUserAction=e.userAction,e.userAction="reset_value",e.resetUIOnly=!0,e._tweakerInput.resetTweaker&&e._tweakerInput.resetTweaker(),e.elements.select&&e.elements.select.resetTweaker&&e.elements.select.resetTweaker(),e.elements.replacementContainer&&e.elements.replacementContainer.resetTweaker&&e.elements.replacementContainer.resetTweaker(),e.userAction=e.prevUserAction,e.prevUserAction=null,e._toggleResetMenu(""),e.resetUIOnly=!1)}})}),define("DS/WidgetServicesUI/tweakers/TweakerMultiple",["DS/WidgetServicesUI/helpers/Constants","DS/WidgetServicesUI/infra/TweakerBase","DS/WidgetServicesUI/helpers/Helpers","DS/UIKIT/Input/Select","DS/UIKIT/Input/Button","DS/UIKIT/Tooltip","DS/WidgetServices/WidgetServices","DS/WidgetServicesUI/tweakers/TweakerString","UWA/Core","i18n!DS/WidgetServicesUI/assets/nls/i18nWidgetService","css!DS/WidgetServicesUI/WidgetServicesUI"],function(e,t,n,i,a,s,l,r,o,u){"use strict";return t.extend({_tweakerInput:null,_tweakerBuilt:!1,_editorStatus:"single",_multipleChoices:!1,_nbSelectCreated:0,_selectValueList:null,init:function(t){this._tweakerBuilt=!1,this._multipleChoices=!1,this._editorStatus="replace",this._nbSelectCreated=0,this.type=e.SPE_TYPES.MULTISEL,this._tweakerInput=t.tweaker,this._parent(t)},getDisplayValues:function(e,t){if(t&&!0===t.singleLine)return this._parent(e,t);var n={},i=this.getValue();for(var a in i)n[a]=this._tweakerInput.getDisplayValues(i[a],{forHTML:!1});return n},_generateValueForSelectTweaker:function(e,t,n){var i=this,a=null;if(t.length>1&&(!this.elements.replacementContainer||this.elements.replacementContainer.getValue()!==n)){var s=o.clone(n);s._ismultisel=!0;a=[{value:s,label:o.i18n("tw_multiple_noChange")}];e.forEach(function(e){var t=i._tweakerInput.getDisplayValue(e,{escapeChar:!1,forHTML:!1});a.push({value:e,label:t})})}return a},_build:function(e,t){this.elements.twMulticontainer=o.createElement("div",{class:"tweaker_multiSelContainer"}),this.elements.inputContainer=o.createElement("div",{class:"tweaker_inputContainer"});var n=this._getSingleValues(this.getValue()),i=this._limitValForRange(n);this._selectValueList=o.clone(i);var a=this._generateValueForSelectTweaker(i,n,this.getValue());a&&a.length>1?this._buildSelect(a):i.length>0&&(i.length>1?this._tweakerInput.setValue(i):this._tweakerInput.setValue(i[0])),this._switchToTweaker(),this.elements.inputContainer.inject(this.elements.twMulticontainer),t.call(this,this.elements.twMulticontainer)},_setValueOnData:function(e){var t=null!==e&&void 0!==e._ismultisel,n=o.clone(this.getValue());for(var i in n)n[i]=t?e[i]:e;return n},_computeValueForRO:function(e,t){if("object"==typeof e){var n=[];for(var i in e){var a=e[i];if(t&&t.forClickable)var s=this._tweakerInput.getDisplayValue(a,{forClickable:!0});else s=this._tweakerInput.getDisplayValue(a);n.indexOf(s)<0&&n.push(s)}var l=n.length>1?"("+u.get("tw_multiple_prefix")+") ":"";return l+=n.join(", ")}return t&&t.forClickable?this._tweakerInput.getDisplayValue(e,{forClickable:!0}):this._tweakerInput.getDisplayValue(e)},_buildButton:function(){var e=this;this.elements.addButton||(this.elements.addButton=new a({className:"tw_multiple_switch",icon:"plus",events:{onClick:function(){e._switchToTweaker()}}}),this.elements.tooltipButton=new s({target:this.elements.addButton.getContent(),body:u.get("Define for all")}),this.elements.addButton.inject(this.elements.twMulticontainer))},_buildReplacement:function(t){var i=this;if(!this.elements.replacementContainer){var a={value:o.clone(t),readOnly:!1,editable:!0,nested:!0,events:{change:function(e){i.__dispatchValueFromTweaker(this,e)},notification:this._dispatchNotificationObj.bind(this)},isMultiSel:!0};i.options.prop&&(a.prop=!0,a.defaultValue=0),i.options.applySort&&(a.applySort=i.options.applySort),i.options.type&&(a.type=i.options.type),n.getTweaker(e.TYPES.REPLACEMENT,a,function(e){i.elements.replacementContainer||(i.elements.replacementContainer=e),"replace"===i._editorStatus&&(i.elements.replacementContainer.inject(i.elements.inputContainer),i.__dispatchValueFromTweaker(i.elements.replacementContainer))})}},_buildSelect:function(t){var i=this;this._buildButton(),this._tweakerInput instanceof r&&this._buildReplacement(this.getValue()),this._multipleChoices=!0,this.elements.select&&(this.elements.select.destroy(),delete this.elements.select);var a={data:{list:t},readOnly:!1,editable:!0,nested:!0,events:{change:function(e){i.__dispatchValueFromTweaker(this,e)}},isMultiSel:!0};i.options.prop&&(a.prop=!0,a.defaultValue=0),i.options.applySort&&(a.applySort=i.options.applySort),i.options.type&&(a.type=i.options.type),this._nbSelectCreated++;var s=this._nbSelectCreated;n.getTweaker(e.TYPES.ENUM,a,function(e){s===i._nbSelectCreated&&(i.elements.select=e,"multiple"===i._editorStatus&&(i.elements.select.inject(i.elements.inputContainer),i.__dispatchValueFromTweaker(i.elements.select)))})},_switchToTweaker:function(){var e=this._tweakerInput instanceof r;"multiple"!==this._editorStatus&&this._multipleChoices?"single"===this._editorStatus&&e?this._editorStatus="replace":this._editorStatus="multiple":this._editorStatus="single";var t=null;this.elements.inputContainer.empty();var n=null;"single"===this._editorStatus?(this._tweakerBuilt||this._buildTweaker(),t=e?"replace":"close",this.elements.addButton&&this.elements.addButton.setIcon(t),n=this._tweakerInput):"multiple"===this._editorStatus?(t="plus",this.elements.addButton.setIcon(t),n=this.elements.select):"replace"===this._editorStatus&&(t="close",this.elements.addButton.setIcon(t),n=this.elements.replacementContainer),this.elements.tooltipButton&&("plus"===t&&this.elements.tooltipButton.setBody(u.get("Define for all")),"close"===t&&this.elements.tooltipButton.setBody(u.get("Set existing")),"replace"===t&&this.elements.tooltipButton.setBody(u.get("Replace with RegExp"))),null!=n&&(n.inject(this.elements.inputContainer),this.__dispatchValueFromTweaker(n))},__dispatchValueFromTweaker:function(e,t,n){null==t&&(t=e.getValue());var i=t;"replace"!==this._editorStatus&&(i=this._setValueOnData(t)),!0===n?this._dispatchLiveChange(i):this._dispatchChange(i)},_buildTweaker:function(){var e=this;this._tweakerBuilt=!0,this._tweakerInput.__switchMode(!0),this._tweakerInput.addEvent("change",function(){var t=this.getValue();e.__dispatchValueFromTweaker(this,t)}),this._tweakerInput.addEvent("liveChange",function(){var t=this.getValue();e.__dispatchValueFromTweaker(this,t,!0)})},areEquals:function(e,t){var n=Object.keys(e),i=Object.keys(t),a=e===t||e&&t&&n.length===i.length;if(e&&a)for(var s in e){var l=e[s],r=t[s];if(!(a=this._tweakerInput.areEquals(l,r)))break}return a},_getSingleValues:function(e){var t=this,n=[];for(var i in e){var a=e[i];l.arrayContains2(n,a,function(e,n){return t._tweakerInput.areEquals(e,n)})<0&&n.push(a)}return n},_limitValForRange:function(e){if(this.options&&this.options.data&&this.options.data.range_required&&this.options.data.list){var t=[],n=[],i=new Map;for(var a in this.options.data.list)t.push(this.options.data.list[a].value),n.push(this.options.data.list[a].label),i.set(this.options.data.list[a].label,this.options.data.list[a].value);var s=[];e.forEach(function(e){Array.isArray(e)?e.forEach(function(e){s.push(e)}):s.push(e)});var l=s.filter(function(e,n,i){return t.indexOf(e)>-1});if(this.options.multivalued&&this.options.trueEnum&&!l.length){l=s.filter(function(e,t,i){return n.indexOf(e)>-1});for(a=0;a<l.length;a++)l[a]&&i.has(l[a])&&(l[a]=i.get(l[a]))}return l}return e},_getValueOrDefault:function(e){return e},_changeRW:function(e){var t=this._getSingleValues(e),n=this._limitValForRange(t),i=this._generateValueForSelectTweaker(n,t,e),a=n&&1==n.length?n[0]:null;1==this.options.multivalued&&n&&1==n.length&&(a=n),null!=a&&this._tweakerInput.setValue(a),i&&i.length>1&&!this.areEquals(this._selectValueList,e)&&(this._selectValueList=o.clone(e),this._buildSelect(i))}})});