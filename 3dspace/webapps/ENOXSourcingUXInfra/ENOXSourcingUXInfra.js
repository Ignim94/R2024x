define("DS/ENOXSourcingUXInfra/ObjectHistory/models/Entry",["UWA/Class/Model"],function(e){"use strict";var t=0;return e.extend({name:"DS/ENOXSourcingUXInfra/ObjectHistory/models/Entry",defaults:{id:"",physicalId:"",date:"",title:"",action:"",state:"",author:{user:"",fullName:""},content:"",timestamp:0,subEntries:null,icon:"fonticon-info",className:"primary"},setup:function(){this.set("id",t+=1),this.set({timestamp:new Date(this.get("date")).getTime()});var e=require("DS/ENOXSourcingUXInfra/ObjectHistory/collections/Entries");this.get("subEntries")&&Array.isArray(this.get("subEntries"))&&this.get("subEntries").length>0?this.set("subEntries",new e(this.get("subEntries"))):this.set("subEntries",null)}})}),define("DS/ENOXSourcingUXInfra/extensions/ENOXSourcingi18nProvider",["UWA/Class/Debug"],function(e){"use strict";return UWA.Class.singleton(e,{init:function(e){this._parent(e)},initialize:function(e){let t,n;return this.app=e,n=function(e,n,i){return new UWA.Promise(function(o,a){e.then(function(){require(["i18n!"+n.path],function(e){t=0===i?e:UWA.merge(UWA.clone(t),UWA.clone(e)),o(t)},function(e){o(e)})}).catch(function(e){a(e)})})},e.configurator.nlsSources.reduce(n,UWA.Promise.resolve([]))}})}),define("DS/ENOXSourcingUXInfra/components/Charts/HalfDonutChartView",["UWA/Class/View","DS/VEN3DLeanHighcharts/highstock.6.0.4/highstock.src"],function(e,t){"use strict";return e.extend({name:"xsrc-half-donut-chart",tagName:"div",className:function(){return this.getClassNames("-container")},setup:function(e={},t,n){let{data:i}=e;Object.assign(this,{dataPromise:i,label:t,chartClickCallBack:n})},render:function(){let e=this.dataPromise,n=this,i=n.label;return this.chart=t.chart({responsive:{rules:[{condition:{maxWidth:500},chartOptions:{legend:{layout:"horizontal",align:"center",verticalAlign:"bottom"}}}]},chart:{width:450,height:230,renderTo:n.container,plotBackgroundColor:null,backgroundColor:"transparent",plotBorderWidth:0,plotShadow:!1,events:{load:function(){const t=this;t.showLoading(i.loading_text),e&&e instanceof Promise?e.then(e=>{t.hideLoading();let n=e?e.reduce((e,t)=>t instanceof Array?e+=t[1]:e+=t.y,0):0;t.options&&t.setTitle({text:`${n}`}),t.series&&t.series[0].setData(e)}):t.hideLoading()}}},credits:{enabled:!1},title:{text:"0",align:"center",verticalAlign:"middle",y:40,style:{fontFamily:"Arial",fontWeight:"bold",fontSize:"30px"}},tooltip:{pointFormat:"<b>{point.y}</b>"},accessibility:{point:{valueSuffix:"%"}},plotOptions:{pie:{dataLabels:{enabled:!1,distance:-50,format:"<b>{point.name}</b>: {y}",style:{fontWeight:"Arial",color:"black"}},point:{events:{click:function(e){n.chartClickCallBack(e.point.name)}}},showInLegend:!0,startAngle:-90,endAngle:90,center:["50%","110%"],size:"150%"}},series:[{type:"pie",name:"",innerSize:"50%",data:[]}]}),this}})}),define("DS/ENOXSourcingUXInfra/extensions/ENOXSourcingControllerProvider",function(){"use strict";function e(e,t){return"object"==typeof t?(t.name=e+t.name,t):e+t}return UWA.Class.singleton({init:function(e){this._parent(e)},initialize:function(t){this.app=t;let n=[],i=this.app.configurator._controllersRoot,o=this.app.configurator._controllersList;[].forEach(t=>n.push(e("DS/ENOXSourcingUXInfra/controllers/",t))),o.forEach(t=>n.push(e(i,t)));let a=this.logger=t.logger;this.logger.info("initializing xSourcing Data Controllers"),this.app.dataControllers=this;var r=n.reduce(function(e,n){return new UWA.Promise(function(i,o){e.then(function(){let e;"object"==typeof n&&(e=n.label,n=n.name),a.info("Initializing controller: "+n),function(e,t,n){return new UWA.Promise(function(i,o){if("string"!=typeof e)throw new Error("Services must be passed as a string");require([e],function(e){if("function"==typeof e.init)return void i(e.init({dataControllers:t}));if(n)return t[n]=new e({app:t.app}),void i();throw new Error("Controller defined incorrectly")},function(n){t.logger.error("Error loading ext "+e+": "+n),o(n)})})}(n,t.dataControllers,e).then(function(){i()}).catch(function(e){o(e)})}).catch(function(e){o(e)})})},UWA.Promise.resolve([]));t.mandatoryStartupPromises.push(r)}})}),define("DS/ENOXSourcingUXInfra/extensions/ENOXSourcingViewControllerProvider",[],function(){"use strict";function e(e,t){return"object"==typeof t?(t.name=e+t.name,t):e+t}return UWA.Class.singleton({init:function(e){this._parent(e)},initialize:function(t){this.app=t;let n=[],i=this.app.configurator._serviceViewControllersList||[],o=this.app.configurator._viewControllersRoot||"",a=this.app.configurator._viewControllersList||[];i.forEach(t=>n.push(e("DS/ENOXSourcingUXInfra/",t))),a.forEach(t=>n.push(e(o,t)));let r=this.logger=t.logger;this.logger.info("initializing xSourcing View Controllers"),this.app.viewControllers=this;var s=n.reduce(function(e,n){return new UWA.Promise(function(i,o){e.then(function(){let e,a,s=n;var l,c;"object"==typeof n&&(e=n.label,s=n.name,a=n.initializeController),r.info("Initializing view controller: "+n),(l=s,c=t,new UWA.Promise(function(e,t){if("string"!=typeof l)throw new Error("Services must be passed as a string");require([l],function(t){e(t)},function(e){c.logger.error("Error loading ext "+l+": "+e),t(e)})})).then(function(n){if("function"!=typeof n.init){if(e)return t.viewControllers[e]=a?new n({app:t}):n,void i();throw new Error("Controller defined incorrectly")}i(n.init({viewControllers:t.viewControllers}))}).catch(function(e){o(e)})}).catch(function(e){o(e)})})},UWA.Promise.resolve([]));t.mandatoryStartupPromises.push(s)}})}),define("DS/ENOXSourcingUXInfra/components/IDCardInfo/IDCardInfo",["DS/CoreEvents/ModelEvents","DS/ENOXIDCard/js/IDCard","UWA/Class/View","UWA/Class/Model","DS/Handlebars/Handlebars","text!DS/ENOXSourcingUXInfra/components/IDCardInfo/html/InfoSection.html","text!DS/ENOXSourcingUXInfra/components/IDCardInfo/html/AttributesPartial.html","css!DS/ENOXSourcingUXInfra/components/IDCardInfo/css/IDCardInfo.css"],function(e,t,n,i,o,a,r){"use strict";return n.extend({className:"id-card-info",setup:function(e){this.template=o.compile(a),o.registerPartial("ExtraAttributes",r),this.attributes=e.infoAttributes},render:function(){var e=this.template({attributes:this.attributes});return this.container.setHTML(e),this.container}})}),define("DS/ENOXSourcingUXInfra/components/ModalWindowWrapper/ModalWindowWrapper",["DS/UIKIT/Modal","DS/UIKIT/SuperModal","i18n!DS/ENOXSourcingUXInfra/assets/nls/ENOXSourcingUXInfra","css!DS/ENOXSourcingUXInfra/components/ModalWindowWrapper/ModalWindowWrapper.css"],function(e,t,n){"use strict";var i,o,a=0,r=0,s=0,l=0;function c(e){(e=e||window.event).preventDefault(),"touchstart"===e.type?(s=e.touches[0].clientX,l=e.touches[0].clientY):(s=e.clientX,l=e.clientY),o.addEventListener("mouseup",u,!1),o.addEventListener("touchend",u,!1),o.addEventListener("mousemove",d,!1),o.addEventListener("touchmove",d,!1)}function d(e){(e=e||window.event).preventDefault(),"touchmove"===e.type?(a=s-e.touches[0].clientX,r=l-e.touches[0].clientY,s=e.touches[0].clientX,l=e.touches[0].clientY):(a=s-e.clientX,r=l-e.clientY,s=e.clientX,l=e.clientY),i.style.top=i.offsetTop-r+"px",i.style.left=i.offsetLeft-a+"px"}function u(){o.removeEventListener("mouseup",u),o.removeEventListener("touchend",u),o.removeEventListener("mousemove",d),o.removeEventListener("touchmove",d)}var p=function(t){var n=this;this.options=t,this.app=t.app,this.controller=t.controller;let i="x-sourcing-modal wizard";t.classNames&&(i+=" "+t.classNames),this.modalComponent=new e({className:i,escapeToClose:t.escapeToClose,header:"",body:"",animate:!0,events:{onHide:function(){t.draggable&&n.makeModalUndraggable(),t.onHideCB&&t.onHideCB()},onShow:function(){t.draggable&&n.makeModalDraggable(t.contentWidth),t.resizable&&n.makeModalResizable()}}}).inject(n.app.widget.body)};return p.prototype.getModal=function(){return this.modalComponent},p.prototype.makeModalDraggable=function(e){a=0,r=0,s=0,l=0,i=this.modalComponent.elements.content,(o=this.modalComponent.elements.header).style.cursor="move",i.style.position="absolute",i.style.width=e||"90%",o.addEventListener("mousedown",c,!1),o.addEventListener("touchstart",c,!1)},p.prototype.makeModalUndraggable=function(){a=0,r=0,s=0,l=0,o.removeEventListener("mousedown",c),o.removeEventListener("touchstart",c)},p.prototype.makeModalResizable=function(){let e=this.modalComponent.elements.content;e.style.resize="both",e.style.width=this.options.width?this.options.width:"90%",e.style["min-height"]=this.options.minimumHeight?this.options.minimumHeight:"425px",e.style["max-height"]="800px",e.style["min-width"]="320px",window.matchMedia("(max-height: 400px)").matches?(e.style.height=this.options.height?this.options.height:"100vh",this.modalComponent.elements.body.style["min-height"]="150px"):(e.style.overflow="hidden",e.style.height=this.options.height?this.options.height:"calc(100vh - 10px)"),e.style.display="flex",e.style["flex-direction"]="column",this.modalComponent.elements.body.style.height="100%"},p.prototype.showPreventCloseDialog=function(e){var i=this;new t({renderTo:e.renderTo||i.app.widget.body,className:"wizard-dialog"}).dialog({body:e.body,title:e.title,buttons:[{className:"default",value:e.actionBtnLabel,action:function(t){t.hide(),e.action(),i.app._applicationChannel.publish({event:"preventCloseDialog-wizard",data:{button:"actionButton"}})}},{className:"primary",value:n.CLOSE_BUTTON,action:function(e){e.hide(),i.modalComponent.hide(),i.app._applicationChannel.publish({event:"preventCloseDialog-wizard",data:{button:"closeButton"}})}},{className:"default",value:n.CANCEL_BUTTON,action:function(e){e.hide(),i.app._applicationChannel.publish({event:"preventCloseDialog-wizard",data:{button:"cancelButton"}})}}]})},p}),define("DS/ENOXSourcingUXInfra/PropertiesView/PropertiesAccordeonView/AccordeonContent",["UWA/Class/View"],function(e){"use strict";return e.extend({name:"sourcing-accordeon-content-view",tagName:"div",className:"sourcing-accordeon-content",setup:function(e){this.container.set("id","sourcing-accordeon-content-"+e.headerValue)},render:function(){},addField:function(e){e.inject(this.container)}})}),define("DS/ENOXSourcingUXInfra/ENOXSourcingLogger",["DS/Logger/Logger"],function(e){"use strict";let t=function(n){this.master_logger=e.getLogger(n.logname);let i="off";return widget.addPreference({name:"debug",type:"hidden",label:n.i18NProvider.enable_debugging,defaultValue:!1}),i=widget.getValue("debug")?t.LEVEL.DEBUG:t.LEVEL.ERROR,this.master_logger.setLevel(i),this.master_logger};return t.LEVEL={},t.LEVEL.DEBUG="debug",t.LEVEL.ERROR="error",t.LEVEL.OFF="off",t}),define("DS/ENOXSourcingUXInfra/ENOXSourcingSCMgnt/ENOXSourcingSCMgnt",["DS/WAFData/WAFData"],function(e){"use strict";var t=" ● ";return function(n){var i,o,a=n.url,r=n.platforminstance,s=[],l=[];function c(e){var n,a,r,c=!1,d=e.preferredcredentials;if(d.collabspace&&d.role&&d.organization){var u=d.collabspace,p=d.role,m=d.organization;n=u.name,a=p.name,r=m.name,i=a+"."+r+"."+n}var h=e.collabspaces;if(h&&h.length>0){for(var f=!1,g=void 0,v=0;v<h.length;v++){for(var S=(C=h[v]).couples||[],w=0;w<S.length;w++){var E=S[w];if(void 0===g&&(g=E.organization.name),g!==E.organization.name){f=!0;break}}if(f)break}for(v=0;v<h.length;v++){var C,y=(C=h[v]).name,b=C.title;for(S=C.couples,w=0;w<S.length;w++){var _=S[w],I=_.organization,D=_.role,T=I.name,O=D.name,N=D.nls,U=I.title,P=O+"."+T+"."+y,A=f?b+t+U+t+N:b+t+N;s.push(P),l.push(A),i?r===T&&a===O&&n===y&&(c=!0):c=!0}}}o(c)}return{RetrieveSCListAndPrefered:function(t){if(t&&t.callback){var n=a+"/resources/modeler/pno/person?current=true";n+="&select=preferredcredentials&select=collabspaces",n+="&tenant="+r,o=t.callback,e.authenticatedRequest(n,{method:"GET",type:"json",onComplete:c,onFailure:function(){o(!1)}})}},getSCPreference:function(e,t){for(var n={name:"SC",type:"list",label:e,options:[]},i=0;i<s.length;i++)n.options.push({value:s[i],label:l[i]});return t&&t.sortArrayAlphabeticallyBasedOnProperty(n.options,"label"),n},getSCPreferred:function(e){return i||(function(e){for(var t=!1,n=0;!t&&n<s.length;)e===s[n]&&(t=!0),n++;return t}(e)?e:null)}}}}),define("DS/ENOXSourcingUXInfra/DetailsView/IDCardUtilities",[],function(){"use strict";var e=function(){};return e.prototype.idcardHomeButtonHandler=function(){this.options.applicationChannel?this.options.applicationChannel.publish({event:"welcome-panel-expand"}):widget.app._applicationChannel.publish({event:"welcome-panel-expand"}),this.options.applicationChannel?this.options.applicationChannel.publish({event:"information-panel-close",data:""}):widget.app._applicationChannel.publish({event:"information-panel-close",data:""});let e=widget.getValue("defaultRoute");widget.setRefreshViewParams("xpflLastVisitedRoute",JSON.stringify({name:e})),widget.app.router.navigate(e,{},{reload:!0})},e.prototype.idcardBackButtonHandler=function(e){e.applicationChannel?e.applicationChannel.publish({event:"welcome-panel-expand"}):widget.app._applicationChannel.publish({event:"welcome-panel-expand"}),this.options.applicationChannel?this.options.applicationChannel.publish({event:"information-panel-close",data:""}):widget.app._applicationChannel.publish({event:"information-panel-close",data:""});var t=widget.getValue("lastVisitedRouteName"),n=JSON.parse(widget.getRefreshViewParams(t)).previousRoutes.length;if(n>=0){var i=JSON.parse(widget.getRefreshViewParams(t)).previousRoutes[n-1];void 0!==i.params&&(i.params.fromBackButton=!0),widget.app.router.navigate(i.name,i.params,{reload:!0})}else widget.app.router.navigate(e.defaultRoute,{},{reload:!0})},e.prototype.idcardInfoButtonHandler=function(){var e=this.mIDCardContainer._idCardContainer.querySelector(".information-icon");null!==e&&(e.className.contains("active")?(e.classList.remove("active"),this.options.applicationChannel?this.options.applicationChannel.publish({event:"information-panel-close",data:""}):widget.app._applicationChannel.publish({event:"information-panel-close",data:""})):(e.classList.add("active"),this.options.applicationChannel?this.options.applicationChannel.publish({event:"information-panel-open",data:"right"}):widget.app._applicationChannel.publish({event:"information-panel-open",data:"right"})))},e}),define("DS/ENOXSourcingUXInfra/router.utils",["DS/Router5/js/Router5","DS/Router5/js/Router5BrowserPlugin","DS/Router5/js/Router5ListenersPlugin","DS/Router5/js/Router5Helpers"],function(e,t,n,i){"use strict";return{createRouter:function(t,i,o,a){var r=e.createRouter(t,i);return o&&r.usePlugin(n()),r},listenToRouterStateChanges:function(e){e.addListener(function(t,n){var o=i.transitionPath(t,n);o.toDeactivate.forEach(function(i){if(void 0!==e.routerMethods[i]){var o=e.routerMethods[i].deactivate;e.previousRoute=n.name,e.previousRoutePath=n.path,void 0!==o&&o.call(e.routerMethods[i],t,n)}}),o.toActivate.forEach(function(i){if((i!==t.name||!t.params.noactivate)&&void 0!==e.routerMethods[i]){var o=e.routerMethods[i].activate;void 0!==o&&o.call(e.routerMethods[i],t,n)}})})}}}),define("DS/ENOXSourcingUXInfra/components/SingleTileSelector/SingleTileSelector",["UWA/Class/View","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/DataGridView/DataGridView","DS/DataGridView/DataGridViewLayout","DS/Controls/Toggle","css!DS/ENOXSourcingUXInfra/components/SingleTileSelector/SingleTileSelector.css"],function(e,t,n,i,o,a){"use strict";return e.extend({name:"SingleTileSelector",tagName:"div",className:"single-tile-selector",domEvents:{},toggle:!1,setup:function(e){this.app=e.app,this.clickCallback=e.clickCallback,this.controller=e.controller,this.controller&&(this.currentStep=this.controller.wizardComponent.currentStep),this.dgvModel=new t,e.model.tiles.forEach(function(e){let t=new n(e);e.grid.icon&&t.setIcons([e.grid.icon]),this.dgvModel.addRoot(t)},this),this.placeholder=e.model.placeholder,this.toggleModel=e.model.toggle},renderButtons:function(){let e=UWA.createElement("span",{id:"modalButtons",class:"modal-buttons"});this.model.buttons.forEach(t=>{UWA.createElement("button",t).inject(e)}),this.currentStep.delegateButtons?(this.currentStep.footer="",this.currentStep.footer=e):e.inject(this.container)},render:function(){var e=this;let t={treeDocument:this.dgvModel,columns:[{dataIndex:"tree",getCellClassName:function(){return"csr-custom-cell"},typeRepresentation:"string",width:"100%"}],layout:new o({cellHeight:60,rowSpacing:15,columnsHeader:!1,rowsHeader:!1}),height:400,showAlternateBackgroundFlag:!1};this.placeholder&&(t.placeholder=this.placeholder);var n=new i(t).inject(this.container);if(this.toggleModel){var r=UWA.createElement("div",{class:"toggleContainer"}).inject(this.container);this.toggle=new a({type:"switch",label:this.toggleModel.label,value:1,checkFlag:!1}).inject(r),this.toggle.addEventListener("change",function(){e.app._applicationChannel.publish({event:"toggle-active-step",data:{step:e.toggleModel.toggleStep,value:!e.toggle.checkFlag}})})}return e.clickCallback?n.addEventListener("click",e.clickCallback):n.addEventListener("click",function(t,n){n&&e.app._applicationChannel.publish({event:"next-step-action",data:n.nodeModel.options.grid})}),this.model.buttons&&this.renderButtons(),this.container}})}),define("DS/ENOXSourcingUXInfra/extensions/ENOXSourcingDataProvider",function(){"use strict";var e="";return UWA.Class.singleton({init:function(e){this._parent(e)},initialize:function(t){e="DS/ENOXSourcingUXInfra/modelers/";var n=this;this._modelers=[],this._serviceModelers=["Lifecycle"],this.app=t,this._appModelersRoot=this.app.configurator._modelersRoot,this._appModelers=this.app.configurator._modelersList,this._serviceModelers.forEach(t=>this._modelers.push(e+t)),this._appModelers.forEach(e=>this._modelers.push(n._appModelersRoot+e)),this.logger=t.logger,this.logger.info("initializing xSourcing Data provider"),this.app.dataProvider=this;var i=this._modelers.reduce(function(e,i){return new UWA.Promise(function(o,a){e.then(function(){var e,r;n.logger.info("Initializing modeler: "+i),(e=i,r=t.dataProvider,new UWA.Promise(function(t,n){if("string"!=typeof e)throw new Error("Services must be passed as a string");require([e],function(e){t(e.init({dataProvider:r}))},function(t){r.logger.error("Error loading ext "+e+": "+t),n(t)})})).then(function(){o()}).catch(function(e){a(e)})}).catch(function(e){a(e)})})},UWA.Promise.resolve([]));t.mandatoryStartupPromises.push(i)}})}),define("DS/ENOXSourcingUXInfra/controllers/DetailsViewRouteController",[],function(){"use strict";var e=function(e){if(!e||!e.app||!e.parentController)throw new Error("app and parentController are mandatory");this.parentController=e.parentController,this.app=e.app,this.NLS=this.app.i18NProvider,this.options=e};return e.prototype.activate=function(e){this.app._triptychWrapper.getMainPanelContainer().innerHTML="",this.app._utility.processRoute(e,widget.getPreference("defaultRoute").value),this.app.deactivateWP(),this.app.storage=e.params;let t={app:this.app,data:e.params,route:this.options.routeDetails.name,routeDetails:this.options.routeDetails};if(this.app.dataControllers[this.options.routeDetails.dataController].showDetails(t),this.app._applicationChannel.publish({event:"topbar-hide-title",data:null}),this.app.dataControllers[this.options.routeDetails.dataController].hyperlinkHelper){let e={contextObjId:t.data.id,callControllerMethod:this.app.dataControllers[this.options.routeDetails.dataController]};widget.app._applicationChannel.publish({event:"xsourcing-collectionview-selected-object-id",data:{selectedObject:!0,openDetails:this.app.dataControllers[this.options.routeDetails.dataController].hyperlinkHelper.getObjectDetailsInInfoPanel(e)}})}},e.prototype.deactivate=function(){"home"===arguments[0].name&&this.app.reactivateWP(),this.app._applicationChannel.publish({event:"xsrc-destroy-drop-token",data:null}),this.app.dataControllers[this.options.routeDetails.dataController].destroyDetailsView&&this.app.dataControllers[this.options.routeDetails.dataController].destroyDetailsView()},e}),define("DS/ENOXSourcingUXInfra/controllers/AdminPanelController",["DS/UIKIT/Mask"],function(e){"use strict";let t,n,i,o,a,r=function(e){if(!e||!e.app||!e.parentController)throw new Error("app and parentController are mandatory");this.parentController=e.parentController,t=this.app=e.app,n=this.app.i18NProvider,(i=this).mainContainer=t,o=t.dataControllers.meiController,a=this.helper=o.helper};return r.prototype.activate=function(){let n=t._triptychWrapper.getMainPanelContainer();n.innerHTML="";e.mask(n),require(["DS/ENOXComponentQualification/views/Admin/AdminPanel"],function(o){i.view=new o(i),i.view.render().inject(n),e.unmask(n),e.mask(i.view.migrationView.container),t.dataProvider.mei.listNonMigrated({postData:{}}).then(function(t){i.view.updateModel(a.processXInfraData(t)),e.unmask(i.view.migrationView.container)}).catch(function(n){t.logger.error(n),e.unmask(i.view.migrationView.container),widget.notificationUtil.showError(n.message?n.message:n)})}),t._applicationChannel.publish({event:"show-welcomepanel-icon"}),t._applicationChannel.publish({event:"topbar-hide-title",data:null})},r.prototype.deactivate=function(){i.view.destroy(),"home"===arguments[0].name&&t.reactivateWP()},r.prototype.migrateManufacturers=function(e,n){return new Promise(function(o,a){try{t.dataProvider.mei.migrateManufacturer({postData:i.buildMigrationPayload(e,n)}).then(function(e){o(e)}).catch(function(e){t.logger.error(e),a(e)}).finally(function(){})}catch(e){a(e)}})},r.prototype.buildMigrationPayload=function(e,t){if(!t)throw new Error(n.error_selecting_suppliers);if(t.length<1)throw new Error(n.error_no_supplier);if(t.length>1)throw new Error(n.error_multiple_suppliers);if(!e)throw new Error(n.error_selecting_mei);if(e instanceof Array&&e.length<1)throw new Error(n.error_no_mei);e instanceof Array||(e=[e]);let o=t.values().next().value;return e.reduce((e,t)=>(e.push({source:i.getMEISource(t),type:t.options.grid.type,identifier:t.options.id,relativePath:"resources/v1/modeler/dseng/dseng:EngItem/"+t.options.id,manufacturer:o.options.grid.name}),e),[])},r.prototype.getMEISource=function(e){let{source:t}=e.options.grid;return"3dnetwork"===t?"3dspace":"3dnetwork"},r}),define("DS/ENOXSourcingUXInfra/ENOXSourcingSCMgnt/ENOXSourcingSCChooser",["DS/UIKIT/Input/Select","DS/Windows/ImmersiveFrame","DS/Windows/Dialog","i18n!DS/ENOXSourcingUXInfra/assets/nls/ENOXSourcingUXInfra","DS/Controls/Button"],function(e,t,n,i,o){"use strict";function a(e){this.SCManager=e.SCManager,this.resolve=e.resolve,this.reject=e.reject,this.buildView()}return a.prototype._buildModal=function(){var e=this,a=new t;return a.inject(widget.body),a.addEventListener("removeWindow",function(){a.destroy()}),this.myContent=UWA.createElement("div",{styles:{width:"100%",height:"100%",position:"relative",background:"white",overflow:"visible",padding:"32px"}}),this.dialog=new n({title:i.chooser_your_credentials,content:this.myContent,buttons:{Ok:new o({id:"selectok",disabled:!0,label:i.ok,onClick:function(){var t=e.selector.getValue()[0];widget.setValue("SC",t),e.resolve&&e.resolve(t),a.destroy()}})},width:600,height:200,immersiveFrame:a,resizableFlag:!0,modalFlag:!0,touchMode:!0,closeButtonFlag:!1}),this.myContent},a.prototype._getModalContent=function(){var t=this.SCManager.getSCPreference(),n=t&&Array.isArray(t.options)?t.options:[];return this.selector=new e({placeholder:i.list_of_securitycontext,options:n,events:{onChange:this.onChange.bind(this)}}),this.selector},a.prototype.onChange=function(){0===this.selector.getValue()[0].trim().length?this.disableValidateBtn():this.enableValidateBtn()},a.prototype.disableValidateBtn=function(){this.dialog.buttons.Ok.disabled=!0},a.prototype.enableValidateBtn=function(){this.dialog.buttons.Ok.disabled=!1},a.prototype.buildView=function(){this._getModalContent().inject(this._buildModal())},a}),define("DS/ENOXSourcingUXInfra/DragAndDrop/DnDInvite/DnDInvite",["i18n!DS/ENOXSourcingUXInfra/assets/nls/ENOXSourcingUXInfra","DS/Core/Core","UWA/Controls/Abstract","UWA/Class/Options","UWA/Class/Events","UWA/Utils/Client","DS/UIKIT/Spinner","css!DS/ENOXSourcingUXInfra/DragAndDrop/DnDInvite/DnDInvite.css","css!DS/UIKIT/UIKIT.css"],function(e,t,n,i,o,a,r){"use strict";return n.extend(i,o,{name:"dnd_invite",defaultOptions:{mode:"dynamic",invites:{drop:{nls:"drop",icon:"drag-drop"},insert:{icon:"plus",nls:"insert"}},active_invite:"drop",isTouchActivated:!1},init:function(e){this._parent(e),this.options.isTouchActivated=a.Features.touchEvents&&!a.Features.pointerEvents,this.options.isTouchActivated&&(this.options.invites.drop={nls:"drop",icon:"touch"}),this._createDynamicInvite()},_createDynamicInvite:function(){if(this.elements.container=UWA.createElement("div",{class:this.getClassNames("_container")}),this.options.isTouchActivated){this.elements.container.className+=" touch_look",this.elements.container.style.pointerEvents="auto",this.elements.container.addEventListener("touchend",function(e){})}for(var t=Object.getOwnPropertyNames(this.options.invites),n=0;n<t.length;n++){var i=t[n];this.elements.container[i]=UWA.createElement("div",{class:this.getClassNames("_display "+i),draggable:!1}),"add_in_context"===i?(new r({className:"large"}).inject(this.elements.container[i]).show(),UWA.createElement("h5",{class:this.getClassNames("_txt font-3dsregular "+i),text:e["DropInvit_"+this.options.invites[i].nls]}).inject(this.elements.container[i])):(UWA.createElement("i",{class:this.getClassNames("_img wux-ui-3ds wux-ui-3ds-5x wux-ui-3ds-"+this.options.invites[i].icon)}).inject(this.elements.container[i]),UWA.createElement("h5",{class:this.getClassNames("_txt font-3dsregular "+i),text:e["DropInvit_"+this.options.invites[i].nls]}).inject(this.elements.container[i])),this.elements.container[i].inject(this.elements.container),this.options.active_invite!==i&&this.elements.container[i].hide()}this.getOption("renderTo")&&this.elements.container.inject(this.getOption("renderTo"))},removeBorder:function(){this.elements.container.addClassName("no-border")},addBorder:function(){this.elements.container.removeClassName("no-border")},show:function(e){this.options.active_invite!==e&&(UWA.is(e,"string")?(this.options.active_invite!==e&&""!==this.options.active_invite&&this.elements.container[this.options.active_invite].hide(),this.options.active_invite=e):this.options.active_invite="drop",this.elements.container[this.options.active_invite].show(),this.elements.container.show(),this.dispatchEvent("toggleInvite",!0))},hide:function(e){UWA.is(e,"string")?""!==this.options.active_invite&&this.options.active_invite===e&&(this.elements.container[this.options.active_invite].hide(),this.elements.container.hide()):""!==this.options.active_invite&&(this.elements.container[this.options.active_invite].hide(),this.elements.container.hide()),this.options.active_invite="",this.dispatchEvent("toggleInvite",!1)}})}),define("DS/ENOXSourcingUXInfra/Constants/ENOXSourcingConstants",["UWA/Class/Debug","i18n!DS/ENOXSourcingUXInfra/assets/nls/ENOXSourcingUXInfra"],function(e,t){"use strict";return UWA.Class.singleton(e,{MY_REQUEST_MANAGEMENT:"Component Request Management",REQUEST_MANAGEMENT_ADMINISTRATION:"Component Request Administration",SUPPLIER_ITEM_QUALIFICATION:"Supplier Item Qualification",QUALIFICATION_MANAGEMENT:"Qualification Management",EXCLUDE_MEI:'NOT([ds6w:kind]:"ManufacturerEquivalentItemExtension")',EXCLUDE_OBSOLETE:"NOT current:Obsolete",EXCLUDE_COMPLETE:"NOT current:Complete",EXCLUDE_ARCHIVE:"NOT current:Archive",EXCLUDE_INACTIVE:"NOT current:Inactive",EXCLUDE_QUALIFICATION_OBSOLETE:'NOT([ds6w:status]:"SRC Qualification.Obsolete")',QUERY_PERSON_OR_GROUP:"(([ds6w:type]:Person AND current:Active) OR [ds6w:type]:Group)",QUERY_PERSON_OR_GROUP_CLOUD:'(([ds6w:type]:Person AND current:Active) OR [ds6w:type]:"foaf:Group")',MEI_EXTENSION:"ManufacturerEquivalentItemExtension",ENTERPRISE_EXTENSION:"EnterpriseExtension",AND:" AND ",OR:" OR ",NOT:" NOT ",TRUE:"TRUE",FALSE:"FALSE",lazy_load_chunk_size:100,LENGTHY_CHAR_LIMIT:256,SESSSION_EXPIRED:401,UNAUTHORISED_REQUEST:403,CLASS:"Class",LIBRARY:"Library",TYPE_PART_SUPPLY_FILE:"PartSupply File",TYPE_COMPANY:"Company",TYPE_DS6W_PART:"ds6w:Part",TYPE_FOAF_GROUP:"foaf:Group",TYPE_GENERAL_LIBRARY:"General Library",VPMREFERENCE:"VPMReference",DELFMIFUNCTIONREFERENCE:"DELFMIFUNCTIONREFERENCE",DELFMIFUNCTIONREFERENCE_QUERY:'"types/CreateAssembly" OR "types/CreateKit" OR "types/CreateMaterial" OR "types/Provide" OR "types/ElementaryEndItem" OR "types/Fasten" OR "types/Installation" OR "types/ProcessContinuousCreateMaterial" OR "types/ProcessContinuousProvide"',DELFMIFUNCTIONREFERENCE_TYPES:["CreateAssembly","CreateKit","CreateMaterial","Provide","ElementaryEndItem","Fasten","Installation","ProcessContinuousCreateMaterial","ProcessContinuousProvide"],DELFMIFUNCTIONREFERENCE_TYPE_ICONS:{CreateAssembly:"I_InsertCreateAssemblyProcess",CreateKit:"I_InsertCreateKitProcess",CreateMaterial:"I_InsertCreateMaterialProcess",Provide:"I_InsertProvideProcess",ElementaryEndItem:"I_InsertElementaryEndItemProcess",Fasten:"I_InsertFastenProcess",Installation:"I_InsertInstallProcess",ProcessContinuousCreateMaterial:"I_InsertCreateMaterialProcessContinuous",ProcessContinuousProvide:"I_InsertProvideProcessContinuous"},DELFMIFUNCTIONREFERENCE_PROVIDE_TYPES:["Provide","ProcessContinuousProvide"],DELFmiFunctionIdentifiedInstance:"DELFmiFunctionIdentifiedInstance",TYPE_SRC_ATTRIBUTEGROUP:"type_SRC_AttributeGroup",ATTRIBUTE_QUALIFICATION_PREFERRED:"attribute_SRCQUALIFICATION.Preferred",ATTRIBUTE_QUALIFICATION_APPROVED:"attribute_SRCQUALIFICATION.Approved",ATTRIBUTE_QUALIFICATION_COMMENTS:"attribute_SRCQUALIFICATION.Comments",ATTRIBUTE_CONTEXT_RESTRICTIONS:"attribute_SRCQUALIFICATION.Context_Restrictions",MEI_PROXY:"SRC Manufacturer Equivalent Item Proxy Item",MANUFACTURING_ITEM_PROXY:"SRC Manufacturing Item Proxy Item",MEI:"Manufacturer Equivalent Item",ENG_ITEM:"Engineering Item",ENG_ITEM_PROXY:"SRC Engineering Item Proxy Item",DOCUMENT:"Document",DOCUMENT_PROXY:"Document Proxy Item",TYPE_COMPONENT_REQUEST:"SRCComponentRequest",COMPONENT_REQUEST:"Component Request",QUALIFICATION_PROOF_PROXY:"Qualification Proof Proxy Item",TYPE_REQUEST_TEMPLATE:"SRCRequestTemplate",TYPE_COMPONENT_REQUEST_TEMPLATE:"SRCComponentRequestTemplate",TYPE_QUALIFICATION:"SRCQUALIFICATION",QUALIFICATION:"Qualification",TYPE_SRC_GENERAL_QUALIFICATION:"SRC General Qualification",TYPE_SUPPLIERLINEITEM:"Supplier Line Item",TYPE_SRC_SUPPLIER_LINE_ITEM:"Supplier Line Item",TYPE_RFX:"RFx Header",TYPE_SOURCE:"Source",TYPE_SRC_RFX:"RFx Header",TYPE_LINEITEM:"Line Item",TYPE_SRC_LINE_ITEM:"Line Item",TYPE_QUOTATION:"RFx Response Header",TYPE_SRC_QUOTATION:"RFx Response Header",TYPE_QUALIFICATION_LIST:["SRC General Qualification","SRC Engineering Equivalent Qualification","SRC Usage Qualification","SRC Manufacturing Equivalent Qualification"],TYPE_PROJECT_SPACE:"Project Space",TYPE_PROJECT_SPACE_ITEM_PROXY:"Project Proxy Item",TYPE_PLANT_ITEM_PROXY:"Plant Proxy Item",TYPE_PLANT:"Plant",TYPE_PERSON:"Person",TYPE_GROUP:"Group",TYPE_GROUP_PROXY:"Group Proxy",TYPE_MODEL:"Model",TYPE_MODEL_VERSION:"Products",TYPE_MODEL_PROXY:"Model Proxy Item",TYPE_MODEL_VERSION_PROXY:"Model Version Proxy Item",TYPE_QUALIFIED_ITEM_PROXY:"Qualified Item Proxy Item",TYPE_ROUTE_TEMPLATE:"Route Template",TYPE_ROUTE_APPROVAL:"Approval",TYPE_TEST_SPECIFICATION:"VV_Test_Specification",TYPE_VENDOR_ITEM:"SRC_VendorItem",SYMBOLIC_TYPE_SRC_EQUIVALENT_QUALIFICATION:"type_SRCEquivalentQualification",SYMBOLIC_TYPE_SRC_MANUFACTURING_EQUIVALENT_QUALIFICATION:"type_SRCManufacturingEquivalentQualification",SYMBOLIC_TYPE_SRC_Usage_QUALIFICATION:"type_SRCUsageQualification",STATE_IN_DRAFT:"In Draft",STATE_IN_WORK:"In Work",STATE_SUBMITTED:"Submitted",STATE_EVALUATION:"Evaluation",STATE_EVALUATION_REVIEW:"Evaluation Review",STATE_IMPLEMENTATION_REVIEW:"Implementation Review",STATE_IMPLEMENTATION:"Implementation",STATE_NEED_FOR_CLARIFICATION:"Needs Clarification",STATE_COMPLETED:"Completed",STATE_INWORK:"In Work",STATE_ACTIVE:"Active",STATE_COMPONENTIDENTIFICATION:"Component Identification",STATE_COMPONENTCONFIRMATION:"Component Confirmation",STATE_COMPONENTQUALIFICATION:"Component Qualification",STATE_IMPACTIDENTIFICATION:"Impact Identification",STATE_IMPACTMITIGATIONPROPOSAL:"Impact Mitigation Proposal",STATE_FINALREVIEW:"Final Review",STATE_IMPACTREVIEW:"Impact Review",STATE_CLOSED:"Closed",PRIVATE_ASSIGNMENT:"<<"+t.private_assignment+">>",ONPREMISE:"OnPremise",SOURCE_SOURCING:"sourcing",SOURCE_3DSPACE:"3dspace",SOURCE_USERGROUPS:"usersgroup",SOURCE_3DPLAN:"3dplan",DSPLAN_PROJECT:"dsplan:Project",SERVICE_3DSPACE:"3DSpace",SERVICE_3DNETWORK:"3dnetwork",SERVICE_3DDASHBOARD:"3DDashboard",SERVICE_PART_SUPPLY:"partsupply",DELETE_LIMIT:"100",AG_ATTRIBUTES_ADD_LIMIT:"50",ALPHA_NUM_UNDSCR_SPACE:/^[a-zA-Z0-9_\s]+$/,ALPHA_NUM_UNDSCR_SPACE_HYPHEN:/^[a-zA-Z0-9-_\s]+$/i,NUM_DECIMAL:/^([0-9]+[.])*[0-9]+$/,SOURCING_APPLICATIONS_IDs:["ENXSPIC_AP","ENXCRMC_AP","ENXNCRQ_AP"],IMPLICIT_TAG_PREFIX:"_tag_implicit_",EXPLICIT_TAG_PREFIX:"_tag__",CONTEXT_RESTRICTION_TAG:"_tag_implicit_ds6w:what/ds6w:qualificationRestriction",CONTEXT_RESTRICTION_TYPE_TAG:"_tag_implicit_ds6w:what/ds6w:qualificationRestrictionType",CONTEXT_RESTRICTION_REVISION_TAG:"_tag_implicit_ds6w:what/ds6w:qualificationRestrictionRevision",TARGET_REVISION_TAG:"_tag_implicit_ds6w:what/ds6w:qualificationTargetRevision",TYPE_TAG:"_tag_implicit_ds6w:what/ds6w:type",CONTEXT_REVISION_TAG:"_tag_implicit_ds6w:what/ds6w:qualificationContextRevision",TAGGER_MEI:[{dataKey:"state",displayName:t.maturity_state,ds6wClass:"what"},{dataKey:"organization",displayName:t.manufacturer,ds6wClass:"who"},{dataKey:"owner",displayName:t.owner,ds6wClass:"who"},{dataKey:"collabspace",displayName:t.collabspace,ds6wClass:"where"},{dataKey:"created",displayName:t.created,isDate:!0,ds6wClass:"when"},{dataKey:"modified",displayName:t.modified,isDate:!0,ds6wClass:"when"},{dataKey:"isLastVersion",displayName:t.isLast,ds6wClass:"when"}],TAGGER_COMPONENT_REQUEST:[{dataKey:"maturityStateDisplay",displayName:t.maturity_state,ds6wClass:"what"},{dataKey:"requestCategory",displayName:t.request_category,ds6wClass:"what"},{dataKey:"componentCategory",displayName:t.category_classification,ds6wClass:"what"},{dataKey:"requestTemplate",displayName:t.request_template,ds6wClass:"what"},{dataKey:"requestAssignee",displayName:t.request_assignee,ds6wClass:"who"},{dataKey:"dueDateDisplay",displayName:t.due_date,isDate:!0,ds6wClass:"when"},{dataKey:"created",displayName:t.originated,isDate:!0,ds6wClass:"when"},{dataKey:"modified",displayName:t.modified,isDate:!0,ds6wClass:"when"},{dataKey:"islast",displayName:t.isLast,ds6wClass:"when"}],TAGGER_COMPONENT_REQUEST_TEMPLATE:[{dataKey:"stateDisplay",displayName:t.maturity_state,ds6wClass:"what"},{dataKey:"classification",displayName:t.category_classification,ds6wClass:"what"},{dataKey:"requestCategory",displayName:t.request_category,ds6wClass:"what"},{dataKey:"created",displayName:t.originated,isDate:!0,ds6wClass:"when"},{dataKey:"modified",displayName:t.modified,isDate:!0,ds6wClass:"when"},{dataKey:"islast",displayName:t.isLast,ds6wClass:"when"},{dataKey:"owner",displayName:t.owner,ds6wClass:"who"},{dataKey:"assigneeFullName",displayName:t.request_assignee,ds6wClass:"who"}],TAGGER_QUALIFICATION:[{dataKey:"qualificationMaturityDisplay",displayName:t.maturity_state,ds6wClass:"what"},{dataKey:"manufacturer",displayName:t.manufacturer,ds6wClass:"who"},{dataKey:"preferredDisplay",displayName:t.preferred,ds6wClass:"what"},{dataKey:"created",displayName:t.originated,isDate:!0,ds6wClass:"when"},{dataKey:"modified",displayName:t.modified,isDate:!0,ds6wClass:"when"}],TEMPLATE_REQUEST_CATEGORY_6W:"[ds6w:templateRequestCategory]",ISLASTREVISION:"[ds6w:isLastRevision]",TEMPLATE_COMPONENT_CATEGORY_6W:"[ds6w:templateComponentCategory]",REQUEST_CATEGORY:"bo.srcRequestTemplate.RequestCategory",CURRENT:"current",CONTEXT_ITEM:"bo.srcQualification.ENGINEERING_ITEM",MEI_ITEM:"bo.srcQualification.MEI",PREREQ_ITEM:"bo.srcQualification.PREREQ",USAGE_QUALIFICATION_CONTEXT:"bo.srcQualification.USAGE_CONTEXT_ID",UTILITY_PREDICATE_SELECTORS:["ds6w:label","physicalid","name","ds6w:description","ds6w:identifier","ds6w:created","ds6w:modified","ds6w:responsible","ds6w:responsibleUid","ds6w:project","ds6w:dataSource","ds6w:community","ds6wg:EnterpriseExtension.V_PartNumber","bo.ManufacturerEquivalentItemExtension.ManufacturerName","ds6wg:ManufacturerEquivalentItemExtension.ManufacturerPartNumber","ds6wg:ManufacturerEquivalentItemExtension.ManufacturerName","ds6wg:revision","ds6w:what/ds6w:status","ds6w:status","partnumber","ds6w:type","organization","bo.srcQualification.MEI","bo.srcQualification.ENGINEERING_ITEM","bo.srcQualification.PREREQ","bo.srcQualification.Preferred","bo.srcQualification.Approved","bo.srcQualification.Comments","bo.srcQualification.IsOrderable","bo.srcQualification.USAGE_CONTEXT_ID","owner"],UTILITY_FILE_SELECTORS:["icon","thumbnail_2d"],NAVIGATE_QUERY_PAYLOAD:{label:"Navigate query",input_physical_ids:[],fileAttributes:[],version:3,primitives:[{navigate_to_sr:{id:1,filter:{role:["52"],category:["7"]},mode:"path"},navigate_from_sr:{id:2,mode:"ends",filter:{role:["52"],category:["7"]}}},{navigate_to_sr:{id:3,filter:{role:["51"],category:["5"]},mode:"path"},navigate_from_sr:{id:4,mode:"ends",filter:{role:["51"],category:["5"]}}},{navigate_to_sr:{id:5,filter:{role:["150"],category:["7"]},mode:"path"},navigate_from_sr:{id:6,mode:"ends",filter:{role:["150"],category:["7"]}}},{navigate_to_sr:{id:7,filter:{role:["149"],category:["5"]},mode:"path"},navigate_from_sr:{id:8,mode:"ends",filter:{role:["149"],category:["5"]}}},{navigate_to_sr:{id:9,filter:{role:["447"],category:["9"]},mode:"path"},navigate_from_sr:{id:10,mode:"ends",filter:{role:["447"],category:["9"]}}},{navigate_to_sr:{id:11,filter:{role:["448"],category:["5"]},mode:"path"},navigate_from_sr:{id:12,mode:"ends",filter:{role:["448"],category:["5"]}}}],patterns:{scope_pathSR:[{id:2},{id:3}],scopeInverse_pathSR:[{id:4},{id:1}],resulting_pathSR:[{id:6},{id:7}],resultingInverse_pathSR:[{id:8},{id:5}]},patternTypeFilters:{scope_pathSR:{typesToNotReturn:["PLMCoreInstance"],filterLinksOn:"elements"},scopeInverse_pathSR:{typesToNotReturn:["PLMCoreInstance"],filterLinksOn:"elements"},resulting_pathSR:{typesToNotReturn:["PLMCoreInstance"],filterLinksOn:"elements"},resultingInverse_pathSR:{typesToNotReturn:["PLMCoreInstance"],filterLinksOn:"elements"}},attributes:["ds6w:label","current","ds6w:what/ds6w:type","name","bo.PLMEntity.V_discipline","bo.PLMEntity.V_description","revision","owner","physicalid","type","ro.plminstance.plm_externalid","from.physicalid","to.physicalid","ro.plminstance.v_treeorder","pathsr"]},CVSERVLET_FETCH_QUERY:{select_file:["icon","thumbnail_2d"],fcs_url_mode:"REDIRECT",label:"fetch",physicalid:[],locale:"en",tenant:"",select_predicate:["physicalid"]},CVSERVLET_EXPAND_QUERY:{batch:{expands:[{label:"Expand Query",root:{physical_id:""},filter:{all:1},graph:{descending_condition_relation:{uql:'NOT (flattenedtaxonomies:"reltypes/XCADBaseDependency") AND ((flattenedtaxonomies:"reltypes/PLMInstance") OR (flattenedtaxonomies:"reltypes/SpecificationDocument"))'},descending_condition_object:{uql:'ds6w_58_globaltype:"ds6w:Document" OR ds6w_58_globaltype:"ds6w:Part" OR (flattenedtaxonomies:"types/Document")'}}}]},outputs:{select_object:["physicalid","type","name","ds6w:label","current","revision","ds6w:type","ds6w:kind","ds6w:created","ds6w:modified","ds6w:responsible","ds6w:globalType"],select_relation:["physicalid"],format:"entity_relation_occurrence",hits:{predefined_computation:["icons","urlstream|thumbnail_2d|2dthb"]}}},MEITAGS:["ds6w:when/ds6w:created","ds6w:when/ds6w:modified","ds6w:who/ds6w:responsible","ds6w:where/ds6w:context/ds6w:project","ds6w:who/ds6w:responsible/ds6w:manufacturer","ds6w:what/ds6w:status"],SN_CATEGORY_LIBRARY:"categorylibrary",DND_PLATFORM_VALIDATION_EXCLUSIONS:["X3DPSLY_AP"],COMPONENT_REQUEST_DETAILS_ROUTE:"home.ComponentRequestDetails",REQUEST_TEMPLATE_DETAILS_ROUTE:"home.RequestTemplateDetails",ENG_ITEM_DETAILS_PAGE_ROUTE:"home.OpenEngineeringItem",MFG_ITEM_DETAILS_PAGE_ROUTE:"home.OpenManufacturingItem",QUALIFICATION_DETAILS_PAGE_ROUTE:"home.OpenQualification",MEI_DETAILS_PAGE_ROUTE:"home.MEIDetails",SRC_SPECIFICATIOn_DOCMENT:"SRC Specification Document",REFERENCE_DOCUMENT:"Reference Document",PART_SUPPLY:"Part Supply",SRC_SOURCETYPE:"SRC_SourceType",COMMENTS:"comments",SRC_COMMENTS:"SRCREQUEST.Comments",REJECTED:"Rejected",CANCELLED:"Cancelled",RELEASED:"Released",OBSOLETE:"Obsolete",OBSOLETE_EMXSTR:"VPLM_SMB_Definition_MajorRev.OBSOLETE",INACTIVE:"Inactive",REJECT:"reject",CANCEL:"cancel",APPROVE:"approve",CLOSE:"close",SUBMIT_CLARIFICATION:"submitClarification",MATURITY_STATE:"maturity_state",SUBMIT:"submit",CLASSIFICATION:"Classification",NOTIFY:"Notify",SOURCING_FORM_MAX_LIMIT:5,SOURCE_INFORMATION:"SRCComponentRequest.Source Information",CONTEXT_PROJECT:"SRCREQUEST.Context Project",CONTEXT_PROJECT_ID:"SRCREQUEST.Context Project_ID",CONTEXT_PRODUCT:"contextProduct",CONTEXT_PRODUCT_ID:"contextProduct_ID",CONTEXT_PLANT:"contextPlant",CONTEXT_PLANT_ID:"contextPlant_ID",COMPONENT_INTRODUCTION_REQUEST:"SRC Component Introduction Request",COMPONENT_INTRODUCTION_REQUEST_V1:"SRC Component Introduction Request V1",SOURCE_CHANGE_NOTIFICATION:"SRC Source Change Notification",SOURCE_CHANGE_NOTIFICATION_V1:"SRC Source Change Notification V1",NRESULTS_999:999,POLICY_DOCUMENT_RELEASE:"Document Release",POLICY_SRC_DOCUMENT:"SRC_Document",SRC_CLOSURE_COMMENTS:"SRCREQUEST.Closure Comments",SRC_COMPLETION_PREVIOUS_STATE:"SRCREQUEST.CompletionPreviousState",CONSTANT_ROUTE:"Route",SOURCE_EDITABLE_CR_STATES:["In Draft","Submitted","Evaluation","Implementation","Needs Clarification","Impact Identification","Impact Mitigation Proposal","Component Identification","Component Qualification"],TYPE_SRCCOMPONENTREQUEST:"type_SRCComponentRequest",SRC_MANUFACTURER:"SRC Manufacturer",SRC_SUPPLIER_NAME:"SRC Supplier Name",SRC_PART_NUMBER:"SRC Part Number",SRC_MANUFACTURER_PART_NUMBER:"SRC Manufacturer Part Number",SRC_PART_SOURCE:"SRC Part Source",SRC_PART_SOURCE_URL:"SRC Part Source URL",Source_Index_Name_ReqTemp:"bo.srcRequestTemplate.Source",VALIDATION_LEVEL_SUB_STRING:"QM_Custo_Validation_Level",VALIDATION_LEVEL_COLUMN_NAME:"Validation_Level",TARGET:"target",CONTEXT:"context",PREREQ:"prereq",QUALIFICATION_CONTEXT_ALLOWED_TYPES:"Qualification_Context_Allowed_Types",QUALIFICATION_TARGET_ALLOWED_TYPES:"Qualification_Target_Allowed_Types",QUALIFICATION_CONTEXT_DETAILS_VIEW:"home.QualificationContextsDetailsView",QUALIFICATION_TARGET_DETAILS_VIEW:"home.QualificationTargetsDetailsView",PROXY_TYPE_TO_ACTUAL_MAPPER:{"SRC Manufacturer Equivalent Item Proxy Item":"VPMReference","SRC Engineering Item Proxy Item":"VPMReference","Project Proxy Item":"Project Space","Model Proxy Item":"Model"},QUALIFICATION_EXTENSION_ENDPOINTS:{ListApplicableExtensions:"/resources/v1/modeler/dssourcing/qualifications/interfaces?$type=${OBJECTTYPE}",GetAttachedExtensions:"/resources/v1/modeler/dssourcing/qualifications/${OBJECTID}",ApplyExtension:"/resources/v1/modeler/dssourcing/extensions/${OBJECTID}"},COMPONENTREQUEST_EXTENSION_ENDPOINTS:{ListApplicableExtensions:"/resources/v1/modeler/dssourcing/requestCategory?$include=category_attributes&exclude=request_category&type=${OBJECTTYPE}",GetAttachedExtensions:"/resources/v1/modeler/dssourcing/sourcingrequests/${OBJECTID}?$include=interface-details&exclude=request_category",ApplyExtension:"/resources/v1/modeler/dssourcing/extensions/${OBJECTID}"},MEI_EXTENSION_ENDPOINTS:{GetAttachedExtensions:"/resources/dictionary/object/interfaces?customerOnly=true&isRoleChecked=true",RemoveExtension:"/resources/dictionary/object/removeInterfaces"},CVSERVLET_ENDPOINTS:{navigate:"/cvservlet/navigate?SecurityContext=${SECURITY_CONTEXT}",expand:"/cvservlet/progressiveexpand/v2?output_format=cvjson",fetch:"/cvservlet/fetch/v2"},REQUEST_CATEGORIES_ACTUAL:["SRC Component Introduction Request V1","SRC Component Modification Request","SRC Source Change Notification V1"],FLATTENEDTAXONOMIES:"flattenedtaxonomies:",TYPEMODEL:"types/Model",TYPEMODELVERSION:"types/Products",GMTTIME:"@06:30:00:GMT",PROCUREMENT_INTENT_BUY:"buy",PROCUREMENT_INTENT_MAKE:"make",PROCUREMENT_INTENT_NONE:"none",PROCUREMENT_INTENT_MULTIPLE:"multiple",RT_6W_XML_SERVICE_NAME:"dssourcing.requestTemplateFields",ATTR_RT_REQUEST_CATEGORY:"SRCRequestTemplate.RequestCategory",ATTR_RT_IS_IMPACTED_ITEMS_REQUIRED:"SRCRequestTemplate.IsImpactedItemsRequired",ATTR_RT_HAS_ANSWER_ITEMS:"SRCRequestTemplate.SupportedAnswerItemTypes",ATTR_RT_SOURCE:"SRCRequestTemplate.Source",REQ_6W_XML_SERVICE_NAME:"dssourcing:requestFields",REQUEST_ADMIN_APPS_TYPES_CONFIG_PATHS:["DS/ENOXComponentRequestManagement/config"],REQUEST_ADMIN_APPS_i18Ns:[{path:"DS/ENOXComponentRequestManagement/assets/nls/ENOXComponentRequestManagement",appName:"ENOXComponentRequestManagement"}],FACETS:{current:"ds6w:how/ds6w:completeness",assignee:"ds6w:who/ds6w:assignee",requestCategory:"ds6w:what/ds6w:requestCategory",componentCategory:"ds6w:why/ds6w:fulfills/ds6w:fulfillsCategory/ds6w:templateComponentCategory",requestSubmitDate:"ds6w:when/ds6w:requestSubmitDate",requestCloseDate:"ds6w:when/ds6w:requestCloseDate"},PUBLISH_TO_PROPERTY:"DS/PADUtils/PADCommandProxy/select",QUALIFICATION_CONTEXT:"_tag_implicit_ds6w:what/ds6w:qualificationContext",QUALIFICATION_TARGET:"_tag_implicit_ds6w:what/ds6w:qualificationTarget",QUALIFICATION_CONTEXT_TYPE:"_tag_implicit_ds6w:what/ds6w:qualificationContextType",QUALIFICATION_TARGET_TYPE:"_tag_implicit_ds6w:what/ds6w:qualificationTargetType",SCOPETAB_ALLOWED_STATES:["In Draft","In Work"],SCR_REQUEST_COMPLETED:"SRC Request.Completed",SCR_NEW_MODIFICATION_REQUEST_CLOSED:"SRCNewOrModificationComponentRequest.Closed",SCR_SOURCE_CHANGE_NOTIFICATION_CLOSED:"SRCSourceChangeNotificationComponentRequest.Closed",HOME_MANUFACTUREREQUIVALENTITEMS:"home.ManufacturerEquivalentItems",CONTEXT_RESTRICTION_SEARCH_QUERY:'(flattenedtaxonomies:"types/VPMReference" AND NOT([ds6w:kind]:"ManufacturerEquivalentItemExtension") AND NOT current:Obsolete) OR (flattenedtaxonomies:"types/Project Space" OR [dsplan:type]:"dsplan:Project" AND NOT current:Complete AND NOT current:Archive) OR (flattenedtaxonomies:"types/Plant" AND NOT current:Inactive) OR ((flattenedtaxonomies:"types/Model" OR flattenedtaxonomies:"types/Products") AND NOT current:Inactive AND NOT current:Obsolete)',DOCUMENTS:"DOCUMENTS",IP_CLASSIFICATION__SEARCH_QUERY:'flattenedtaxonomies:"types/General Class"  AND current:active',CONTEXT_PRODUCT_SEARCH_QUERY:'(flattenedtaxonomies:"types/VPMReference" OR "types/Model") AND NOT([ds6w:kind]:"ManufacturerEquivalentItemExtension") AND NOT current:Inactive AND NOT current:Obsolete',CONTEXT_PLANT_SEARCH_QUERY:'flattenedtaxonomies:"types/Plant" AND NOT current:Inactive',CONTEXT_PROJECT_OC_SEARCH_QUERY:'("Project Space" OR [dsplan:type]:"dsplan:Project") AND NOT current:Complete AND NOT current:Archive',CONTEXT_PROJECT_OP_SEARCH_QUERY:'flattenedtaxonomies:"types/Project Space" OR flattenedtaxonomies:"types/dsplan:Project" OR flattenedtaxonomies:"types/NOT current:Complete" OR flattenedtaxonomies:"types/NOT current:Archive"',ROUTE_MANAGEMENT:"ENXROUT_AP",CONTEXT_RESTRICTION_ALLOWED_TYPES:["VPMReference","Products","Model","Plant","Project Space","dsplan:Project"],RANGE_ATTRIBUTES:"Unit of Measure,Currency,Country",MIN:-9999999999,MAX:9999999999,QUALIFICATION_CONTEXT_DETAILS_PAGE:"QualificationContextsDetailsPage",MANUFACTURER_PART_NUMBER_TAG:"ds6wg:ManufacturerEquivalentItemExtension.ManufacturerPartNumber",MANUFACTURER_NAME_TAG:"ds6wg:ManufacturerEquivalentItemExtension.ManufacturerName",MANUFACTURER_TITLE_TAG:"ds6wg:ManufacturerEquivalentItemExtension.ManufacturerTitle",MANUFACTURER_TAG:"ds6w:manufacturer",QFM_COLUMNS_TO_SEARCH:["name","modified","owner","state","comments","preferred","restriction","prereq","approvedDisplay","targetTitle","targetType","contextTitle","contextType","extensionValue","title"],XSP_COLUMNS_TO_SEARCH:["name","qualtitle","revision","contextRestrictonsLength","qualificationComments","preferredDisplay","approvedDisplay","maturityState","created","modified","displayType","contextType","enterpriseItem"],ENG_COLUMNS_TO_SEARCH:["title","revision","partNumber","manufacturer","maturityStatusDisplay","eqTitle","eqName","eqMaturityStatusDisplay","eqPreferredDisplay","eqApproved","eqContextRestrictions","eqComments","gqTitle","gqName","gqMaturityStatusDisplay","gqApproved","gqContextRestrictions","procurementIntentDisplay"]})}),define("DS/ENOXSourcingUXInfra/UpdateWidgetTitle/UpdateWidgetTitle",[],function(){"use strict";var e=function(){};return e.prototype.init=function(){widget.setTitle(" ")},e.prototype.updateTitle=function(e){const t=`${e||" "}`;widget.setTitle(t)},e}),define("DS/ENOXSourcingUXInfra/extensions/ENOXSourcingi18nProviderV2",[],function(){"use strict";return UWA.Class.singleton({init:function(e){this._parent(e)},initialize:function(e){e.logger.info("initializing i18N providers"),e.i18NGrouped={};let t=e.configurator.nlsSources.reduce(function(t,n){return new UWA.Promise(function(i,o){t.then(function(){var t,a,r;(t=n.path,a=e,r=n.appName,new UWA.Promise(function(e){"string"==typeof t&&require([t],function(t){a.i18NGrouped[r]=t,e()},function(n){a.logger.error("Error loading ext "+t+": "+n),e()})})).then(function(){i()}).catch(function(e){o(e)})}).catch(function(e){o(e)})})},UWA.Promise.resolve([]));e.mandatoryStartupPromises.push(t)}})}),define("DS/ENOXSourcingUXInfra/components/WelcomePanel/CustomWelcomePanel",["DS/ENOXWelcomePanel/js/ENOXWelcomePanel","text!DS/ENOXSourcingUXInfra/assets/html/UserAssitance.html","text!DS/ENOXSourcingUXInfra/assets/html/ENOXWelcomePanelCustom.html","DS/Handlebars/Handlebars4","DS/UIKIT/Tooltip","DS/WebUAUtils/WebUAUtils","i18n!DS/ENOXSourcingUXInfra/assets/nls/ENOXSourcingUXInfra","css!DS/ENOXSourcingUXInfra/assets/styles/WelcomePanelWrapper"],function(e,t,n,i,o,a,r){"use strict";var s=function(){};return s.prototype.injectCustomHTML=function(a){this.welcomePanelContainer=UWA.createElement("div",{class:"welcomePanelSection"});var s=UWA.createElement("div",{id:"welcomePanelFirstDiv",class:"welcomePanelFirstDiv"}).inject(this.welcomePanelContainer),l=i.compile(n);this.welcomePanelContainer.inject(a.parentContainer),s.setHTML(l(a)),this.welcomePanelSection=s.getElement(".welcome-panel-section");var c=widget.getElement(".custom-activity-section");a.activities[0].actions.map(e=>{e.tooltip=e.text});var d={collapsed:!1,title:a.title,notifications:[],activities:a.activities,parentContainer:c||a.parentContainer,description:a.description,modelEvents:widget.app._applicationChannel};this.applicationChannel=widget.app._applicationChannel,this._wp=new e(d),this._wp.render();var u=i.compile(t),p=widget.getElement(".custom-footer-section");if(null!=p){p.setHTML(u({USER_ASSISTANCE:r.user_assistance,CONTENT_KNOWLEDGE:r.content_knowledge,TRAINING:r.training}));var m=p.getElements(".user-assistance .link-item")[0];this._trainingTooltip=new o({target:m,body:r.user_assistance,position:"right"}),p.getElement(".user-assistance .link-anchor").addEvent("click",this._launchUserAssistanceWindow.bind(this,a))}this._subscribeToEvents()},s.prototype._subscribeToEvents=function(){let e=this;this.applicationChannel.subscribe({event:"welcome-panel-collapse"},function(){e.welcomePanelSection.addClassName("collapsed"),e.welcomePanelSection.removeClassName("expanded")}),this.applicationChannel.subscribe({event:"welcome-panel-expand"},function(){e.welcomePanelSection.addClassName("expanded"),e.welcomePanelSection.removeClassName("collapsed")})},s.prototype.getWelcomePanel=function(){return this._wp},s.prototype._launchUserAssistanceWindow=function(e){var t=this._getHelpRootPath(e);window.open(t,"_blank")},s.prototype._launchTrainingWindow=function(e){var t=e.trainingLink,n="https://dsua.dsone.3ds.com/".concat(t);window.open(n,"_blank")},s.prototype._getHelpRootPath=function(e){var t,n=e.userAssistnceLink,i=widget.lang||"English";return t=i.match("fr")?"French":i.match("de")?"German":i.match("ja")?"Japanese":i.match("zh")?"Simplified_Chinese":i.match("it")?"Italian":i.match("es")?"Spanish":i.match("ru")?"Russian":"English",a.getHelpFullPath(n,t)},s}),define("DS/ENOXSourcingUXInfra/components/TabbedWizard/TabbedWizard",["UWA/Class/View","DS/Controls/Tab","DS/Controls/Button","DS/Controls/TooltipModel","DS/Controls/ButtonGroup","DS/Utilities/Dom","css!DS/ENOXSourcingUXInfra/components/TabbedWizard/TabbedWizard.css"],function(e,t,n,i,o,a){"use strict";return e.extend({name:"tabbed-wizard",tagName:"div",className:"tabbed-wizard",template:function(){return'<div class="'+this.getClassNames("-subcontainer")+'"></div>'},domEvents:{},tabBar:void 0,tab:void 0,steps:[],models:[],eventTokens:[],currentStep:void 0,setup:function(e){let n=this;if(!e.app)throw new Error("Controller must provide application handler");if(!e.steps)throw new Error("Controller must provide steps configuration");n.app=e.app,n.controller=e.controller,n.steps=e.steps,n.tabBar=new o,n.tabBar.elements.container.style.position="relative",n.tab=new t({displayStyle:"strip"});let i=UWA.createElement("div",{id:"tabBar"}).inject(this.container),r=UWA.createElement("div",{id:"tab"}).inject(this.container);n.tab.inject(r),n.tab.tabBar.visibleFlag=!1,n.stepLine=UWA.createElement("div",{id:"stepLine"}).inject(i),n.stepLineFilled=UWA.createElement("div",{id:"stepLineFilled"}).inject(i),n.tabBar.inject(i),n.tabBar.addEventListener("change",function(e){n.controller.container.setFooter(n.steps[e.dsModel.value[0]].footer),n.app.router.navigate(n.steps[e.dsModel.value[0]].route,{data:{alreadyVisitedTab:!0}});for(let e=0;e<n.tabBar.getButtonCount();e++){let t=n.tabBar.getButtonFromValue(e);t&&(t.disabled=e>n.steps.indexOf(n.currentStep)||!n.steps[e].active,t.elements.button.classList[t.disabled?"remove":"add"]("tabButtonPrev"))}n.update()}),a.addResizeListener(i,function(){n.update()},0),n.subscribeToEvents(),n.loadSteps(n.steps);let s=n.controller.container.elements.content;function l(){document.querySelector(".tabbed-wizard > #tab").style.height=document.querySelector(".tabbed-wizard").getBoundingClientRect().height-document.querySelector("#tabBar").getBoundingClientRect().height+"px"}s.addEventListener("mousemove",l,!1),s.addEventListener("touchmove",l,!1)},loadSteps:function(){let e=this;e.steps.forEach(function(t,o){let a={iconName:t.icon,fontIconFamily:WUXManagedFontIcons.Font3DS},r=new n({type:"radio",label:t.title,displayStyle:"lite-borders",clickMode:1,icon:a});r.tooltipInfos=new i({shortHelp:t.title,mouseRelativePosition:!1,position:"bottom",allowUnsafeHTMLTitle:!1}),r.elements.button.classList.add("tabButton"),e.tabBar.addChild(r),e.tab.add({index:o,content:UWA.createElement("div")})})},render:function(){return this.container},destroy:function(){this.unsubscribeFromEvents(),this._parent()},update:function(){document.querySelector(".tabbed-wizard > #tab").style.height=document.querySelector(".tabbed-wizard").getBoundingClientRect().height-document.querySelector("#tabBar").getBoundingClientRect().height+"px";var e=this.tabBar.elements.container.scrollWidth;this.stepLine.style.width=e+"px";let t=this.tabBar.getButtonFromValue(this.tab.value[0]);return t&&(this.stepLineFilled.style.width=t.elements.iconPlaceholder.offsetLeft+"px"),this},createContent:function(e){return new UWA.Element("div",{class:"content",html:e+" Content "})},renderTab:function(e){e.alreadyVisitedTab||this.tab.setPageContentFromIndex(e.index,e.content),this.tab.value=[this.steps.indexOf(this.currentStep)],this.tabBar.value=[this.steps.indexOf(this.currentStep)]},subscribeToEvents:function(){let e=this;this.eventTokens.push(this.app._applicationChannel.subscribe({event:"next-step-action"},function(t){if(t&&t.action&&"back"===t.action)e.app._applicationChannel.publish({event:"previous-tab-action",data:t});else if(t&&t.action&&"save-as-draft"===t.action)e.app._applicationChannel.publish({event:"submit-action",data:t});else{let n=e.steps.slice(e.steps.indexOf(e.currentStep)+1).find(e=>!0===e.active);n?(n.input&&!1===n.prevStepDataDependency&&(t=t?{...t,alreadyVisitedTab:!0}:{alreadyVisitedTab:!0}),e.app.router.navigate(n.route,{data:t})):e.app._applicationChannel.publish({event:"submit-action",data:t})}})),this.eventTokens.push(this.app._applicationChannel.subscribe({event:"toggle-active-step"},function(t){e.steps.find(e=>e.route===t.step).active=t.value})),this.eventTokens.push(this.app._applicationChannel.subscribe({event:"previous-tab-action"},function(){let t=e.steps[e.steps.indexOf(e.currentStep)-1];e.app.router.navigate(t.route,{data:{alreadyVisitedTab:!0}})})),this.eventTokens.push(this.app._applicationChannel.subscribe({event:"route-changed"},function(){}))},unsubscribeFromEvents:function(){let e=this;this.eventTokens.forEach(t=>e.app._applicationChannel.unsubscribe(t))}})}),define("DS/ENOXSourcingUXInfra/controllers/xSourcingBootstrapController",[],function(){"use strict";function e(e){this.app=e}return e.prototype.initialize=function(){if("function"==typeof this.app.router.getRouterConfig){var e=this;this.app.router.getRouterConfig().routes.forEach(t=>{t.routeController&&e.addRouteManager(t.name,new e.app.routeControllers[t.routeController]({app:e.app,parentController:e,routeDetails:t}))})}this.app.viewControllers&&this.app.viewControllers.modalWindowController&&this.addRouteManager("modal",new this.app.viewControllers.modalWindowController({app:this.app,parentController:this})),this.app.router.getRouter().buildPath("home.admin")&&this.addRouteManager("home.admin",new this.app.viewControllers.adminPanelController({app:this.app,parentController:this}))},e.prototype.addRouteManager=function(e,t){if(this.app.router.getRouter().routerMethods&&this.app.router.getRouter().routerMethods[e])throw new Error("route manager already defined");if(e.indexOf(" ")>=0)throw new Error("route name should not contain spaces");if(!t)throw new Error("route manager is mandatory");if(!("activate"in t&&"deactivate"in t)||"function"!=typeof t.activate||"function"!=typeof t.deactivate)throw new Error("all mandatory methods are not defined on this route: "+e);this.app.router.addRouteMethods(e,t)},e}),define("DS/ENOXSourcingUXInfra/NotificationsUtil/NotificationsUtil",["DS/UIKIT/Mask","UWA/Class","DS/Notifications/NotificationsManagerUXMessages","DS/Notifications/NotificationsManagerViewOnScreen"],function(e,t,n,i){"use strict";var o=t.singleton({_notificationsMgr:{},_defaultLevel:"info",_msgLevels:{INFO:"info",WARNING:"warning",ERROR:"error",SUCCESS:"success"},init:function(){this._notificationsMgr=n,i.setNotificationManager(this._notificationsMgr)},showMessage:function(e){if(e&&e.subtitle)return this._notificationsMgr.addNotif({category:e.category,level:e.level?e.level:this._defaultLevel,subtitle:e.subtitle,sticky:!!e.isSticky&&e.isSticky,allowUnsafeHTML:!!e.allowUnsafeHTML&&e.allowUnsafeHTML})},showError:function(t){if(t&&""!==t)return widget.app&&widget.app.logger&&widget.app.logger.error(t),this.showMessage({level:this._msgLevels.ERROR,subtitle:t});e.unmask(widget.body)},showInfo:function(e){e&&""!==e&&this.showMessage({level:this._msgLevels.INFO,subtitle:e})},showSuccess:function(e){e&&""!==e&&this.showMessage({level:this._msgLevels.SUCCESS,subtitle:e})},showWarning:function(e){e&&""!==e&&this.showMessage({level:this._msgLevels.WARNING,subtitle:e})},removeNotificationFromCategory:function(e){i.removeNotifications(e,null)},removeNotificationById:function(e){i.removeNotification(e)}});return o.init(),o}),define("DS/ENOXSourcingUXInfra/Utilities/Menu",["DS/Menu/Menu"],function(e){"use strict";return e}),define("DS/ENOXSourcingUXInfra/AttributeRange/AttributeRange",["UWA/Class/Debug"],function(e){"use strict";return UWA.Class.singleton(e,{getAttributeRange:function(e,t){return new Promise(function(n){if(void 0===e||!(e instanceof Array&&0!==e.length))return void n({});let i={};e.forEach(function(e){i[e]={},i[e].nls={},i[e].rangeMap=[],i[e].defaultValue={}}),require(["DS/ENOXSourcingUXInfra/service/ENOXSourcingService"],function(o){let a,r={};r.source="sourcing",r.postData={attributes:e},r.endpoint="/resources/dssourcing/getAttributeRange",(a=t?o.performPostPromiseSupplierPortal(r):o.performPostPromise(r)).then(function(e){if(e)for(let t in e)e.hasOwnProperty(t)&&(i[t].defaultValue=e[t].default,e[t].rangeMap.forEach(e=>{i[t].rangeMap.push({value:e.key,label:e.value}),i[t].nls[e.key]=e.value}));n(i)},function(){n(i)}).catch(function(){n(i)})})})}})}),define("DS/ENOXSourcingUXInfra/Utilities/HyperLinkHelper",[],function(){"use strict";var e=function(){};return e.prototype.getObjectDetailsInInfoPanel=function(e){return function(){var t={};t.data={params:{id:e.contextObjId,tabToOpen:e.tabToOpen}},t.detailsContainer=widget.app._triptychWrapper.getRightPanelContainer(),t.detailsContainer.empty&&t.detailsContainer.empty(),t._mediator=widget.app._mediator,t._triptychWrapper=widget.app._triptychWrapper,t.router=widget.app.router,t.applicationChannel=widget.app._applicationChannel,t.platformServices=widget.app.platformServices,t.forInfo=!0,t.updateQualificationTable=e.updateTable,e.detailsFunction&&"function"==typeof e.detailsFunction?e.detailsFunction.call(e.callControllerMethod,t):e.callControllerMethod.openInInformationPanel(t)}},e}),define("DS/ENOXSourcingUXInfra/extensions/ENOXSourcingRouteControllerProvider",[],function(){"use strict";function e(e,t){return"object"==typeof t?(t.name=e+t.name,t):e+t}return UWA.Class.singleton({init:function(e){this._parent(e)},initialize:function(t){this.app=t;let n=[],i=this.app.configurator.serviceRouteControllersList||[],o=this.app.configurator.routeControllersRoot||"",a=this.app.configurator.routeControllersList||[];i.forEach(t=>n.push(e("DS/ENOXSourcingUXInfra/",t))),a.forEach(t=>n.push(e(o,t)));let r=this.logger=t.logger;this.logger.info("initializing xSourcing Route Controllers"),this.app.routeControllers=this;var s=n.reduce(function(e,n){return new UWA.Promise(function(i,o){e.then(function(){let e,a,s=n;var l,c;"object"==typeof n&&(e=n.label,s=n.name,a=n.initializeController),r.info("Initializing Route controller: "+n),(l=s,c=t,new UWA.Promise(function(e,t){if("string"!=typeof l)throw new Error("Services must be passed as a string");require([l],function(t){e(t)},function(e){c.logger.error("Error loading ext "+l+": "+e),t(e)})})).then(function(n){if("function"!=typeof n.init){if(e)return t.routeControllers[e]=a?new n({app:t}):n,void i();throw new Error("Controller defined incorrectly")}i(n.init({routeControllers:t.routeControllers}))}).catch(function(e){o(e)})}).catch(function(e){o(e)})})},UWA.Promise.resolve([]));t.mandatoryStartupPromises.push(s)}})}),define("DS/ENOXSourcingUXInfra/DateUtil/DateUtil",[],()=>{"use strict";return class{static isPast(e,t){if(t||(t=new Date),!(e instanceof Date&&t instanceof Date))throw new TypeError("All arguments need to be of type Date");return t>e}static isWithinDays(e,t,n){if(n||(n=new Date),!(e instanceof Date&&n instanceof Date))throw new TypeError("All arguments need to be of type Date");return n>e.getTime()-1e3*t*60*60*24&&n<e.getTime()}}}),define("DS/ENOXSourcingUXInfra/ENOXSourcingExtensionManager",[],function(){"use strict";var e="";function t(t,n){this._extensions=[],this.app=t,this.logger=t.logger,this.initStarted=!1,this.initStatus=UWA.Promise.deferred(),e=n&&"string"==typeof n&&n.startsWith("DS")?n:""}return t.prototype.add=function(e){if(this.initStarted)throw new Error("Init extensions already called");if(function(e,t){if(!t)throw new Error("refExt is a mandatory parameter to add extension");for(var n=0;n<e.length;n++)if(e[n].ref===t)return!0;return!1}(this._extensions,e.ref)){var t=e.ref.toString()+" is already registered.";throw new Error(t+="\nExtensions can only be added once.")}return this._extensions.push(e),this},t.prototype.init=function(){if(this.initStarted)throw new Error("Init extensions already called");this.initStarted=!0;var e=this._extensions.slice(0);return this.serialInit(e)},t.prototype.serialInit=function(t){return t.reduce(function(t,n){return new UWA.Promise(function(i,o){t.then(function(){
/*!
    * Actual extension loading.
    *
    * The sequence is:
    *
    * * resolves the extension reference
    * * register and requires its dependencies if any
    * * init the extension
    *
    * This method also returns a promise that allows
    * to keep track of the app's loading sequence.
    *
    * If the extension provides a `afterAppStart` method,
    * the promise will resolve to that function that
    * will be called at the end of the app loading sequence.
    *
    * @param {String|Object|Function} extDef the reference and context of the extension
    */
var t;
/*!
    * Extension resolution before actual loading.
    * If `ext` is a String, it is considered as a reference
    * to an AMD module that has to be loaded.
    *
    * This method returns a promise that resolves to the actual extension,
    * With all its dependencies already required' too.
    *
    * @param {String|Object|Function} ext the reference of the extension
    * @param {Object} context the thing this extension is supposed to extend
    */(t=n,new UWA.Promise(function(n,i){var o=t.ref,a=t.context,r=function(t,n){return new UWA.Promise(function(i,o){var a=function(e){t=function(e){return"function"==typeof e?new e(Array.prototype.slice.call(arguments,1)):e}(e,n),i(t)};"string"==typeof t?require([e+t],a,function(e){n.logger.error("Error loading ext "+t+": "+e),o(e)}):a(t)})}(o,a);r.catch(i),r.then(function(e){if(!e)return n();var t=UWA.Promise.cast(e.initialize(a));t.finally(function(){return n(!0)})})})).then(function(){i()}).catch(function(e){o(e)})}).catch(function(e){o(e)})})},UWA.Promise.resolve([]))},t}),define("DS/ENOXSourcingUXInfra/JSCacheBust/JSCacheBust",[],function(){"use strict";return{onLoad:function(e,t){var n=e.target&&e.target.responseText?e.target.responseText.trim():null,i=n&&n.match(/COMMIT_ID=(?<commitid>.*)/m);if(i){var o=i&&i.groups&&i.groups.commitid;if(o.length>0&&null!==o.match(/^[a-z0-9]+$/i)){var a=require.toUrl(""),r=a.lastIndexOf("?"),s="";-1!==r&&(s=a.substring(r+1)+"&"),require.config({urlArgs:s+"v="+o})}}t()}}}),define("DS/ENOXSourcingUXInfra/components/Charts/BarChartView",["UWA/Class/View","DS/VEN3DLeanHighcharts/highstock.6.0.4/highstock.src"],function(e,t){"use strict";return e.extend({name:"xsrc-bar-chart",tagName:"div",className:function(){return this.getClassNames("-container")},setup:function(e={},t,n){let{data:i}=e;Object.assign(this,{dataPromise:i,label:t,chartClickCallBack:n})},render:function(){let e=this.dataPromise,n=this,i=n.label;return this.chart=t.chart({responsive:{rules:[{condition:{maxWidth:500},chartOptions:{legend:{enabled:!1}}}]},chart:{height:230,type:"bar",renderTo:n.container,plotBackgroundColor:null,plotBorderWidth:0,plotShadow:!1,backgroundColor:"transparent",events:{load:function(){const t=this;t.showLoading(i.loading_text),e?e.then(e=>{t.hideLoading(),t.series&&t.series[0].setData(e)}):t.hideLoading()}}},credits:{enabled:!1},title:{text:""},xAxis:{type:"category"},yAxis:{min:0,title:{text:i.name,align:"high",enabled:!1},labels:{overflow:"justify"},allowDecimals:!1},tooltip:{valueSuffix:` ${i.unit}`},plotOptions:{bar:{dataLabels:{enabled:!0},events:{legendItemClick:function(){return!1},click:function(e){n.chartClickCallBack(e.point.name)}}}},series:[{name:i.name,data:[]}]}),this}})}),define("DS/ENOXSourcingUXInfra/Mediator",["DS/CoreEvents/ModelEvents"],function(e){"use strict";var t=null,n=function(){t=new e};return n.prototype.publish=function(e,n){t.publish({event:e,data:n})},n.prototype.subscribe=function(e,n){return t.subscribe({event:e},n)},n.prototype.unsubscribe=function(e){t.unsubscribe(e)},n.prototype.createNewChannel=function(){return new e},n.prototype.getApplicationBroker=function(){return t},n.prototype.destroy=function(){t.destroy()},n}),define("DS/ENOXSourcingUXInfra/TNProxyImpl/SourcingTNProxy",["UWA/Core","DS/TagNavigatorProxy/TagNavigatorProxy","DS/ENOXSourcingUXInfra/Constants/ENOXSourcingConstants"],function(e,t,n){"use strict";var i=function(){this.taggerProxy=null,this.nodeEvents=null,this.tagger6WProxy=null};return i.prototype.initTaggerProxy=function(e,i,o){this.data=e,this.d6wtags=i,this.nodeEvents=o,null!==this.taggerProxy&&this.taggerProxy.deactivate();var a={widgetId:widget.id,filteringMode:"WithFilteringServices",tenant:widget.getValue("x3dPlatformId")?widget.getValue("x3dPlatformId"):n.ONPREMISE,events:{addCloseTaggerListener:this.onCloseTagger.bind(this)}};this.taggerProxy=t.createProxy(a),this.taggerProxy.activate(),this.taggerProxy.addFilterSubjectsListener(this.onFilterChange,this),this.taggerProxy.unsetTags(),this.taggerProxy.setSubjectsTags(this.d6wtags)},i.prototype.onFilterChange=function(e){var t=[],n=e.filteredSubjectList;if(this.nodeEvents._xsourcingCollectionViewUI._dataGridView.dataSource){let e=[];var i=this.nodeEvents._xsourcingCollectionViewUI._dataGridView,o=this.nodeEvents._data;i.prepareUpdateView(),e=o.filter(e=>n.includes(e.id)),this.nodeEvents._xsourcingCollectionViewUI._dataGridView.dataSource.getModel().referenceArray=e,this.nodeEvents._xsourcingCollectionViewUI.options.dataSource.availableProperties=[],this.nodeEvents._xsourcingCollectionViewUI._dataGridView._updateModel(),i.pushUpdateView();let t=this.collectionView?this.collectionView:this.nodeEvents;var a=t?t._xsourcingCollectionViewUI._dataGridView.dataSource.referenceArray.length:0;return void t._xsourcingCollectionViewUI._toolbarChannel.publish({event:"enox-collection-toolbar-items-count-update",data:a})}this.nodeEvents.options.filterCallback&&this.nodeEvents.options.filterCallback(n);var r=this.nodeEvents._gridModel;r.prepareUpdate();var s=[];"EngContextTable"===this.nodeEvents._xsourcingCollectionViewUI.uniqueIdentifier?(r.getRoots()[0].getChildren().length>1?s.push(this.nodeEvents.nodeModels):s.push(r.getRoots()[0].getChildren()[0].__children),this.filterForMfg(s,n)):(s=r.getRoots(),"relatedQualifications"===this.nodeEvents._xsourcingCollectionViewUI.uniqueIdentifier?this.filterForMEI(s,n):s.forEach(e=>{let i=e.options.grid.qual_id?e.options.grid.qual_id:e.options.id;t.push(e.options),n.includes(i)?e.show():e.hide()})),r.pushUpdate();let l=this.collectionView?this.collectionView:this.nodeEvents;var c=l?l._xsourcingCollectionViewUI._tilecollectionView.model.length:0;l._xsourcingCollectionViewUI._toolbarChannel.publish({event:"enox-collection-toolbar-items-count-update",data:c})},i.prototype.filterForMEI=function(e,t){e.forEach(e=>{e.options.children.forEach(e=>{let n=e._options.grid.qualId?e._options.grid.qualId:e._options.id;t.includes(n)?e.show():e.hide()})})},i.prototype.filterForMfg=function(e,t){e[0].forEach(e=>{t.includes(e._options.grid.eqId)||t.includes(e._options.grid.gqId)?e.show():e.hide()})},i.prototype.serverFilteringProxy=function(){return null!==this.tagger6WProxy&&this.tagger6WProxy.deactivate(),this.tagger6WProxy=t.createProxy({widgetId:widget.id,filteringMode:"FilteringOnServer",tenant:widget.getValue("x3dPlatformId")?widget.getValue("x3dPlatformId"):n.ONPREMISE,events:{addCloseTaggerListener:this.closeFacetTagger.bind(this)}}),this.tagger6WProxy},i.prototype.closeFacetTagger=function(){this.tagger6WProxy&&this.tagger6WProxy.deactivate()},i.prototype.onCloseTagger=function(){if(this.taggerProxy){var e=this.nodeEvents._gridModel,t=e.getRoots();e.prepareUpdate(),t.forEach(e=>{e.show()}),e.pushUpdate();var n=this.nodeEvents._xsourcingCollectionViewUI._tilecollectionView.model.length;this.nodeEvents._xsourcingCollectionViewUI._toolbarChannel.publish({event:"enox-collection-toolbar-items-count-update",data:n}),this.taggerProxy.deactivate()}},i.prototype.setTaggerProxyOpts=function(e,t,n){var i=this;i.collectionView=t;for(var o={},a=e,r=0;r<a.length;r++){var s=a[r].id;o[s]=[],n.forEach(function(e){var t=e.isDate?i._ConvertToTagDate(a[r].grid[e.dataKey]):a[r].grid[e.dataKey],n="attribute";if(e.isDate&&(n="date"),t){var l={sixw:"ds6w:"+e.ds6wClass+"/"+e.displayName,object:t,type:n,dispValue:t};o[s].push(l)}})}i.initTaggerProxy(e,o,t)},i.prototype._ConvertToTagDate=function(e){var t=new Date,n="";return e&&("string"==typeof e&&(e=(e=(e=e.replace(/&#x2f;/g,"/")).replace(/&#x3a;/g,":")).replace(/\u200E/g,"")),n=(t=new Date(e)).getFullYear()+"/"+(t.getMonth()+1)+"/"+t.getDate()),n},i.prototype.focusOnSubjects=function(e){this.taggerProxy.focusOnSubjects(e)},i.prototype.unfocus=function(){this.taggerProxy.unfocus()},i}),define("DS/ENOXSourcingUXInfra/xSourcingRouter/xSourcingRouter",["UWA/Class","DS/ENOXSourcingUXInfra/router.utils"],function(e,t){"use strict";return e.singleton({initialize:function(e){this._routerConfig=e,this._routes=e.routes,this._router=t.createRouter(e.routes,e.options,!0,!0),t.listenToRouterStateChanges(this._router)},addRoute:function(e){this._router.add(e)},getRouterConfig:function(){return this._routerConfig},getTitle:function(){var e=this;return this._routes.filter(t=>t.name===e._router.getState().name)[0].titleNLS},addRouteMethods:function(e,t){this._router.routerMethods||(this._router.routerMethods={}),UWA.is(t,"object")&&(this._router.routerMethods[e]=t)},start:function(e){this._router.start(e)},navigate:function(){this._router.navigate.apply(this._router,arguments)},getRouter:function(){return this._router},getState:function(){return this._router.getState()},setDependency:function(e,t){this._router.setDependency(e,t)},getDependency:function(e){return this._router.getDependencies()[e]},isActive:function(e){return this._router.isActive(e)},addRouteListener:function(e,t){return this._router.addRouteListener(e,t)}})}),define("DS/ENOXSourcingUXInfra/components/WelcomePanel/WelcomePanelWrapper",["DS/ENOXSourcingUXInfra/components/WelcomePanel/CustomWelcomePanel"],function(e){"use strict";var t=function(){this.eventTokens=[]};return t.prototype.init=function(t){this.eventBroker=t.eventBroker,this.router=t.router,this.container=t.container,this.i18NProvider=t.app.i18NProvider,this.activities=this.handleNLSForActions(t.activities);var n={title:t.title,description:t.description,parentContainer:this.container,activities:this.activities,applicationChannel:this.eventBroker,userAssistnceLink:t.userAssistnceLink,trainingLink:t.trainingLink};let i=new e;i.injectCustomHTML(n),this.wp=i.getWelcomePanel(),0===this.eventTokens.length&&this._subscribeToEvents()},t.prototype._subscribeToEvents=function(){var e=this;let t=this.eventBroker.subscribe({event:"welcome-panel-action-selected"},function(t){let n=e.getActionById(t.id),i={};i.router=e.router,i.applicationChannel=e.eventBroker,i.applicationChannel?i.applicationChannel.publish({event:"information-panel-add-content",data:{selectedObject:null}}):widget.app._applicationChannel.publish({event:"information-panel-add-content",data:{selectedObject:null}}),i.divClassName=n.className,n.callback?n.callback(i):e._navigateToId(t.id)});this.eventTokens.push(t)},t.prototype._navigateToId=function(e){let t=!0,n="";e.contains("modal")||(n+="home.",t=!1),this.router.navigate(n+e.replace(/-/g,"."),{},{reload:t})},t.prototype.getActionById=function(e){return this.activities.find(t=>t.actions&&t.actions.find(t=>t.id===e)).actions.find(t=>t.id===e)},t.prototype.createNewActivitySection=function(e,t){this.wp.createNewActivitySection(e,t)},t.prototype.createNewAction=function(e,t,n){this.wp.createNewAction(e,t,n)},t.prototype.removeActivitySection=function(e){this.wp.removeActivitySection(e)},t.prototype.removeAction=function(e){this.wp.removeAction(e)},t.prototype.handleNLSForActions=function(e){let t=this;return e[0].actions.forEach(function(e){e.text=t.i18NProvider[e.nlsKey]}),e},t}),define("DS/ENOXSourcingUXInfra/controllers/ListViewRouteController",["DS/ENOXSourcingUXInfra/UpdateWidgetTitle/UpdateWidgetTitle"],function(e){"use strict";let t=new e;var n=function(e){if(!e||!e.app||!e.parentController)throw new Error("app and parentController are mandatory");this.parentController=e.parentController,this.app=e.app,this.NLS=this.app.i18NProvider,this.options=e};return n.prototype.activate=function(e){this.app._applicationChannel.publish({event:"show-welcomepanel-icon"}),this.app._utility.processRoute(e,widget.getPreference("defaultRoute").value),this.app._applicationChannel.publish({event:"welcome-panel-expand"}),this.app._applicationChannel.publish({event:"welcome-panel-select-action",data:{id:e.name.split(".")[1]}}),this.app._triptychWrapper.getMainPanelContainer().innerHTML="",this.app.deactivateWP(),this.options.routeDetails.showTitle?this.app._applicationChannel.publish({event:"topbar-show-title",data:this.NLS[this.app.router.getTitle()]}):(t.updateTitle(),this.app._applicationChannel.publish({event:"topbar-hide-title",data:null}));var n={app:this.app,routeDetails:this.options.routeDetails};this.app.dataControllers[this.options.routeDetails.dataController].list(n)},n.prototype.deactivate=function(){"home"===arguments[0].name&&this.app.reactivateWP(),this.app._applicationChannel.publish({event:"xsrc-destroy-drop-token",data:null})},n}),define("DS/ENOXSourcingUXInfra/service/ENOXSourcingPlatformServices",["DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","DS/WidgetServices/securityContextServices/SecurityContextServices","DS/WAFData/WAFData","UWA/Class","UWA/Class/Debug","DS/ENOXSourcingUXInfra/ENOXSourcingSCMgnt/ENOXSourcingSCMgnt","i18n!DS/ENOXSourcingUXInfra/assets/nls/ENOXSourcingUXInfra","DS/UIKIT/Mask","DS/ENOXSourcingUXInfra/ENOXSourcingSCMgnt/ENOXSourcingSCChooser","DS/ENOXSourcingUXInfra/Constants/ENOXSourcingConstants"],function(e,t,n,i,o,a,r,s,l,c){"use strict";return UWA.Class.singleton(o,{_platforms:[],csrfTokenMap:{},init:function(){this._platforms=[]},getServiceURL:function(e){return this._platforms[e]?this._platforms[e]:null},getPlatformId:function(){if(this._platformId)return this._platformId;try{return widget&&(this._platformId=widget.getValue("x3dPlatformId")?widget.getValue("x3dPlatformId"):"OnPremise"),this._platformId}catch(e){return"OnPremise"}},getPlatformServices:function(t){var n=this;return new Promise(function(i,o){var a={platformId:n.getPlatformId(),onComplete:function(e){t.logger.info("Platform Services successfully retrieved");var o=e.hasOwnProperty("length")?e[0]:e;n._platforms=o,"OnPremise"===n.getPlatformId()&&(n._platforms.sourcing=n._platforms["3DSpace"],o.sourcing=n._platforms["3DSpace"]),n.getSCPreferences="",n.getSCPreferences=n.populateSecurityContextWidgetPreferences(n._platforms["3DSpace"],t),n.getPassiveSC=n.getSecurityContext(t),"OnPremise"!==n.getPlatformId()&&n.getPassiveSC.then(function(e){t.logger.info("Passive Security Context Set -- "+e)},function(){t.logger.info("Failed to get Passive Security Context -- ")}),n.setCookiesCall=n.setCookies(n._platforms.sourcing),n.setCookiesCall.then(function(){n.getSCPreferences.then(function(){t.logger.info("Security Context Populated Successfully"),n.setCredentialPreference(),i(o)}).catch(function(){t.logger.error("unable to retrieve SecurityContext"),n.displayAlert("error","sc_error")})}).catch(function(){n.getSCPreferences.then(function(){t.logger.info("Security Context Populated Successfully"),n.setCredentialPreference(),i(o)}).catch(function(){t.logger.error("unable to retrieve SecurityContext"),n.displayAlert("error","sc_error")})})},onFailure:function(e){t.logger.error("Failed to get platform Services"),t.logger.error("Reason: "+e),n.displayAlert("error","appLoadMessage"),o(e)}};e.getPlatformServices(a)})},setCredentialPreference:function(){"OnPremise"===this.getPlatformId()&&widget.setValue("xPref_CREDENTIAL",widget.getValue("SC"))},setCommonWidgetPreferences:function(){this.getPlatformId()!==c.ONPREMISE&&widget.addPreference({name:"tenantName",type:"text",label:r.tenant_name,defaultValue:this._platforms.displayName,disabled:!0})},getSecurityContext:function(){var e=this;return new Promise(function(t){e.passiveSC="ctx::VPLMProjectLeader.Company Name.SOURCING",t()})},getCSRFToken:function(e,t){var i=this,o=t||"3DSpace";return new Promise(function(t,a){if(i.csrfTokenMap&&i.csrfTokenMap[o])t(i.csrfTokenMap[o]);else{var r={},s=e+"/resources/v1/application/CSRF?tenant="+i.getPlatformId();r.method="GET",r.proxy="passport",r.onComplete=function(e){i.app&&i.app.logger.info("CSRF Token retrieved successfully"),i.csrfTokenMap[o]=e.csrf.value,t(e.csrf.value)},r.onFailure=function(e){i.app&&i.app.logger.error("Error while getting CSRF token"),a(e)},r.type="json",n.authenticatedRequest(s,r)}})},populateSecurityContextWidgetPreferences:function(e,t){var n=this;n.app||(n.app=t);var i={url:e,platforminstance:n.getPlatformId()};return this.scChooserHelper=new a(i),new Promise(function(e,i){n.scChooserHelper.RetrieveSCListAndPrefered({callback:function(o){if(o){var a=n.scChooserHelper.getSCPreference("select_credentials",t._utility);widget.addPreference(a),n.setCommonWidgetPreferences();var r=n.setSecurityContextOnWidget(a.options,widget.getValue("SC"));if(r)e(!0);else{//!_PreviousSC
var s=n.scChooserHelper.getSCPreferred(r);if(s)s&&widget.setValue("SC",s),e(!0);else new l({SCManager:n.scChooserHelper,resolve:e,reject:i})}}else i()}})})},setSecurityContextOnWidget:function(e,t){if(t)for(let n in e)if(e[n].value===t)return widget.setValue("SC",t)},setCookies:function(e){var t=this;return new Promise(function(i,o){var a={},r=e+"/resources/dssourcing/GlobalToLocalObj/initializesourcingapp?tenant="+t.getPlatformId().toUpperCase();a.method="GET",a.proxy="passport",a.onComplete=function(e){i(e)},a.onFailure=function(e){o(e)},a.type="json",n.authenticatedRequest(r,a)})},displayAlert:function(e,t){widget.notificationUtil.showMessage({level:e,subtitle:r[t]}),s.mask(widget.body,r.loading)}})}),define("DS/ENOXSourcingUXInfra/PropertiesView/3DComments/CommentsView",["UWA/Class/View","DS/SocialToolbar/SocialToolbar","DS/UIKIT/Scroller","DS/Utilities/Dom","DS/ENOXSourcingUXInfra/Constants/ENOXSourcingConstants","DS/ENOXSourcingUXInfra/service/ENOXSourcingPlatformServices","css!DS/ENOXSourcingUXInfra/PropertiesView/3DComments/CommentsView.css"],function(e,t,n,i,o,a){"use strict";return e.extend({name:"xsrc-3d-comments-view",tagName:"div",template:function(){return'<div class="'+this.getClassNames("-subcontainer")+'"></div>'},init:function(e){this.data=e.data,["container","template","tagName","domEvents"].forEach(function(t){delete e[t]}),this._parent(this,e)},render:function(){let e=this;e.container.empty();let r=UWA.createElement("div",{class:"3dcommentsDiv",styles:{height:"100%"}});const s={protocol:"3DXContent",version:"",source:widget.data.appId,widgetId:widget.id,data:{items:[{envId:a.getPlatformId(),serviceId:o.ONPREMISE===a.getPlatformId()?o.SOURCE_3DSPACE:o.SOURCE_SOURCING,objectId:e.data.id,objectType:e.data.type}]}};return new t({className:"xsrc-3dcomments",commentProxyToken:{header:"X-DS-CSRFTOKEN"},"3DSwymUrl":a.getServiceURL("3DSwym"),subjectURI:"pid:"+e.data.id,tenantId:a.getPlatformId(),serviceURL:a.getServiceURL(o.SOURCE_SOURCING)+"/resources",enableShare:!1,enableCommentLike:!0,appForcedLinkUri:"/#app:"+e.data.appID+"/content:X3DContentId="+encodeURIComponent(JSON.stringify(s))}).inject(r),r.inject(e.container),new n({element:r}).inject(e.container),i.addResizeListener(r.parentElement,function(){e.update(r)},0),e.update(r),e.container},update:function(e){let t=e.parentElement.parentElement&&e.parentElement.parentElement.parentElement?e.parentElement.parentElement.parentElement.getBoundingClientRect():e.parentElement.getBoundingClientRect();e.style.height=t.height+"px"}})}),define("DS/ENOXSourcingUXInfra/CommonUtils/CommonUtils",["UWA/Core","DS/UIKIT/Tooltip","DS/ENOXSourcingUXInfra/service/ENOXSourcingPlatformServices"],function(e,t,n){"use strict";return{escapeHtml:function(e){return e?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"):e},getUserImage:function(e){var t=n.getServiceURL("3DSwym");return require.toUrl(t+"/api/user/getpicture/login/"+e+"/format/normal")},getUserImageElement:function(i){var o,a="";this.tooltip=[];try{var r="OnPremise"===n.getPlatformId(),s=i.fullName?"user agent"===i.fullName.toLowerCase():"User Agent"===i.user;try{let e=this.getUserImage(i.user);a=e||""}catch(e){a="",this.imageRetrieveError=e}var l=""!==a&&!r&&!s,c=l?"":"user-image-avatar";if(l)o=e.createElement("img",{class:c,src:a});else{var d=void 0!==i.fullName?i.fullName:i,u=this.getAvatarDetails(d);o=e.createElement("span",{class:c,styles:{background:u.avatarColor},html:u.avatarStr})}}catch(t){o=e.createElement("span",{class:"user-image-avatar",styles:{background:"rgb(170, 75, 178)"},html:""})}if(o){let e=new t({position:"top",target:o,body:this.escapeHtml(i.fullName?i.fullName:i.user),trigger:"touch"});this.tooltip.push(e)}return o},getAvatarDetails:function(e){var t={},n=[[7,139,250],[249,87,83],[111,188,75],[158,132,106],[170,75,178],[26,153,123],[245,100,163],[255,138,46]],i=e.match(/\b\w/g),o=i[0].toUpperCase(),a=i[i.length-1].toUpperCase(),r=o+a,s=Math.ceil((o.charCodeAt(0)+a.charCodeAt(0))%n.length),l="rgb("+n[s][0]+","+n[s][1]+","+n[s][2]+")";return t.name=e,t.avatarStr=r,t.avatarColor=l,t},getSupplierProxyName:function(e){let t;return t=e.substring("<uuid:".length,e.length-1)},createTootip:function(e,n){return new t({position:"top",target:e,body:n,trigger:"touch"})},checkSomeParenthasAClassName:function(e,t){return!!(e.className&&e.className.split(" ").indexOf(t)>=0)||!(e.classname&&e.className.split(" ").indexOf("xRFQ-application")>=0)&&(e&&e.parentNode&&this.checkSomeParenthasAClassName(e.parentNode,t))},getDateStringForDisplay:function(e,t={}){if(!e)return e;try{var n=e;e instanceof Date||(n=new Date(e));if(!((i=n)instanceof Date)||isNaN(i))throw new Error("Invalid Date");let o={...t.weekdayShort&&{weekday:"short"},year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"numeric"};return t.removeTime&&(delete o.hour,delete o.minute),n.toLocaleString(widget.lang,o)}catch(t){return this.errForDate=t,e}var i},isGroupedNodePresent:function(e){let t=!1;return e?(e.forEach(function(e){e.getAttributeValue("grouped")&&(t=!0)}),t):t},getFileFromURL:function(e,t){return new Promise(function(n){var i=null,o=new XMLHttpRequest;o.open("GET",e),o.responseType="blob",o.onload=function(){i=o.response;let e=new File([i],t);n(e)},o.send()})},isEventInElement:function(e,t){var n=t.getBoundingClientRect(),i=e.clientX;if(i<n.left||i>=n.right)return!1;var o=e.clientY;return!(o<n.top||o>=n.bottom)}}}),define("DS/ENOXSourcingUXInfra/components/Charts/LineChartView",["UWA/Class/View","DS/VEN3DLeanHighcharts/highstock.6.0.4/highstock.src","DS/ENOXSourcingUXInfra/CommonUtils/CommonUtils"],function(e,t,n){"use strict";let i=(new Date).getTime(),o=i-7776e6;return e.extend({name:"xsrc-line-chart",tagName:"div",className:function(){return this.getClassNames("-container")},setup:function(e,t,n){let{data:i}=e;Object.assign(this,{dataPromise:i,label:t,chartClickCallBack:n})},render:function(){let e=this.dataPromise,a=this,r=a.label;return this.chart=t.chart({responsive:{rules:[{condition:{maxWidth:500},chartOptions:{legend:{enabled:!1}}}]},chart:{height:230,renderTo:a.container,backgroundColor:"transparent",events:{load:function(){const t=this;t.showLoading(r.loading_text),e&&e instanceof Promise?e.then(e=>{e=e&&Object.keys(e.actual).map(t=>{const n=parseInt(t);if(!isNaN(n)&&n>=o&&n<=i)return{x:n,y:e.actual[t]}}).filter(e=>void 0!==e),t.series&&t.series[0].setData(e),t.hideLoading()}):t.hideLoading()}}},credits:!1,title:{text:""},subtitle:{text:""},yAxis:{title:{text:r.name},min:0,allowDecimals:!1},xAxis:{type:"datetime",gridLineWidth:1,min:o,max:i,labels:{formatter:function(){return new Intl.DateTimeFormat(widget.lang,{day:"numeric",month:"short"}).format(new Date(this.value))}},plotLines:[{color:"#FF0000",width:1,value:(new Date).getTime(),zIndex:3}],tickInterval:6048e5},tooltip:{formatter:function(){return"<b>"+`${n.getDateStringForDisplay(new Date(this.x)).split(",")[0]}: ${this.y} ${r.unit}`+"</b>"}},plotOptions:{series:{line:{dataLabels:{enabled:!0},enableMouseTracking:!1,pointPlacement:"on"},events:{legendItemClick:function(){return!1},click:function(e){a.chartClickCallBack(e.point.x)}}}},series:[{name:r.line_chart_label}]}),this}})}),define("DS/ENOXSourcingUXInfra/ObjectHistory/utils/Parser",["UWA/Class/Promise","UWA/Core","DS/WAFData/WAFData","DS/ENOXSourcingUXInfra/CommonUtils/CommonUtils","i18n!DS/ENOXSourcingUXInfra/assets/nls/ENOXSourcingUXInfra"],function(e,t,n,i,o){"use strict";var a={ACTIONS:{CREATE:"create",CONNECT:"connect",DISCONNECT:"disconnect",PROMOTE:"promote",DEMOTE:"demote",MODIFY:"modify",MODIFY_STATE:"modifystate"}},r={parse:function(t,n){var i=this;return new e(function(e){i.objectTitle=n.objectTitle,i.activityMappingObject=n.activityMappingObject;for(var o=[],r=[],s=t.length-1;s>-1;s--){var l=t[s];if(i.validEntryByAttribute(l)){var c=new Date(l.date),d={};d.date=i.getDay(c),d.action=l.action,d.description=l.description,d.state=l.state,d.author={user:l.author.user,fullName:l.author.fullName},d.content=l.description,d.title="",d.subEntries=[];let e=i.checkForEvents(s,l,d,r,o,t);if(s=e.i,l=e.entry,d=e.line,r=e.tempSubEntries,o=e.parsed,t=e.data,0===s&&![a.ACTIONS.CREATE,a.ACTIONS.PROMOTE,a.ACTIONS.DEMOTE].includes(l.action)){var u={isDummyRow:!0};u.subEntries=r,o.unshift(u)}}}e(o)})},checkForEvents:function(e,t,n,o,r,s){switch(t.action){case a.ACTIONS.CREATE:case a.ACTIONS.PROMOTE:case a.ACTIONS.DEMOTE:case a.ACTIONS.MODIFY_STATE:n.content=this[t.action](t),n.subEntries=o,o=[],r.unshift(n);break;case a.ACTIONS.MODIFY:var l=this[t.action](s,e);e=l[1],n.content=l[0],n.content&&n.content.length&&n.content.length>0&&o.push(n);break;case a.ACTIONS.CONNECT:case a.ACTIONS.DISCONNECT:e=(l=this[t.action](s,e))[1],n.content=l[0],n.content&&n.content.length&&n.content.length>0&&o.push(n);break;default:n.content=i.escapeHtml(t.description),o.push(n)}},create:function(){let e=o.history_created?o.history_created:"is created",n=t.createElement("div",{});return n.innerText=this.objectTitle+" "+e,n},modifystate:function(e){let n=t.createElement("div",{});return n.innerText=e.description,n},promote:function(e){var n="";o.history_promoted&&(n=this.objectTitle+" "+o.replace(o.history_promoted,{state:e.state.bold()}));var i=e.description?e.description:n;let a=t.createElement("div",{});return a.innerText=i,a},demote:function(e){var n=this.objectTitle+" "+o.replace(o.history_demoted,{state:e.state.bold()}),i=e.description?e.description:n;let a=t.createElement("div",{});return a.innerText=i,a},connect:function(e,t,n){for(var i=n,o=[],r=new Date(t[i].date),s=r.getTime(),l=s,c=t[i].author.user,d=[];l>s-6e4&&c===t[n].author.user&&i>-1&&(t[i].action===a.ACTIONS.CONNECT||t[i].action===a.ACTIONS.DISCONNECT);)t[i].description&&d.push("<li class= mod-li>"+this.getConnectContentMessage(t[i].additionalParameters,t[i].description,t[i].action)+"</li>"),--i>-1&&(l=new Date(t[i].date).getTime(),c=t[i].author.user);if(d.length>0){var u="",p=d.length>1?"timeline-description-list-style":"";d.forEach(function(e){u+=e});var m='<span class="timeline-modified-operations '+p+'">'+u+"</span>";o.push(m)}return[o,i+1]},getConnectContentMessage:function(e,t,n){var a,r="",s="",l=e;a=l.relName?l.relName:"";try{"function"==typeof(s=this.activityMappingObject[n][a])&&(r=s(l)),r||(r=""),(r=(r=r.replace("{title}",l.title)).replace("{contextTitle}",this.objectTitle))&&""!==r||(r=t)}catch(e){this.err=e,r&&""!==r||(r=t)}finally{r||(r=o.history_datamissing)}return i.escapeHtml(r)},disconnect:function(e,t,n){return this.connect(e,t,n)},modify:function(e,t,n){for(var r=n,s=[],l=new Date(t[r].date),c=l.getTime(),d=c,u=t[r].author.user,p=[];d>c-6e4&&u===t[n].author.user&&r>-1&&t[r].action===a.ACTIONS.MODIFY;){if(t[r].description){var m=this._getModify(t[r].description);m&&p.push(i.escapeHtml("<li class= mod-li>"+m.join("")+"</li>"))}--r>-1&&(d=new Date(t[r].date).getTime(),u=t[r].author.user)}if(p.length>0){let e=o.history_is?o.history_is:"is",t=o.history_updated?o.history_updated:"updated";var h=i.escapeHtml(this.objectTitle)+" "+e+'<span class="timeline-modified-operations timeline-operations-tooltip" data-list="'+p.join("")+'">'+t+"</span>";s.push(h)}return[s,r+1]},_getModify:function(e){var t,n=e.indexOf(":"),a=e.indexOf("was:"),r=e.indexOf(":GMT"),s=["Field"," "];switch(t=e.slice(0,n).trim(),a>-1&&(r>-1?(s[0]="<b>"+i.escapeHtml(t)+"</b>",s[1]=i.escapeHtml(e.slice(n,r-9).trim())+"</br>"):(s[0]="<b>"+i.escapeHtml(t)+"</b>",s[1]=i.escapeHtml(e.slice(n,a).trim())+"</br>")),"description"===t&&(s[0]="<b>"+o.history_description+"</b>",s[1]=i.escapeHtml(e.slice(n,e.length).trim())+"</br>"),s[0]){case"<b>SRCQUALIFICATION.Restriction</b>":s[0]="<b>"+o.restriction+"</b>";break;case"<b>SRCQUALIFICATION.SRCEffectivityStartDate</b>":s[0]="<b>"+o.effective_date_from+"</b>";break;case"<b>SRCQUALIFICATION.SRCEffectivityEndDate</b>":s[0]="<b>"+o.effective_date_to+"</b>";break;case"<b>SRC General Qualification.Last Time Buy</b>":s[0]="<b>"+o.lastTimeBuy+"</b>"}return s},validEntryByAttribute:function(e){return!!e&&(!(!e.hasOwnProperty("date")||t.is(e.date,null)||!t.is(e.date,"string"))&&(!!e.hasOwnProperty("description")&&(!(!e.hasOwnProperty("action")||t.is(e.action,null)||!t.is(e.action,"string"))&&(!(!e.hasOwnProperty("state")||t.is(e.state,null)||!t.is(e.state,"string"))&&(!(!e.hasOwnProperty("author")||t.is(e.state,null)||!t.is(e.author,"object"))&&(!(!e.author.hasOwnProperty("user")||t.is(e.author.user,null)||!t.is(e.author.user,"string"))&&!(!e.author.hasOwnProperty("fullName")||t.is(e.author.fullName,null)||!t.is(e.author.fullName,"string"))))))))},getDay:function(e){return i.getDateStringForDisplay(e)}};return r._CONSTANTS=a,r}),define("DS/ENOXSourcingUXInfra/DragAndDrop/ENOXSourcingDataDragAndDrop",["i18n!DS/ENOXSourcingUXInfra/assets/nls/ENOXSourcingUXInfra","DS/DataDragAndDrop/DataDragAndDrop","DS/ENOXSourcingUXInfra/DragAndDrop/DnDInvite/DnDInvite","DS/ENOXSourcingUXInfra/service/ENOXSourcingPlatformServices","DS/ENOXSourcingUXInfra/NotificationsUtil/NotificationsUtil","DS/ENOXSourcingUXInfra/Constants/ENOXSourcingConstants","css!DS/ENOXSourcingUXInfra/DragAndDrop/ENOXSourcingDataDragAndDrop.css"],function(e,t,n,i,o,a){"use strict";var r=function(){};return r.prototype.makeAreaDroppable=function(e){var n=this;n.options=e,n._applicationChannel=widget.app._applicationChannel,n._dropArea=n.options.dropArea,n._inviteHandler=e.inviteHandler?e.inviteHandler:n.initDnDView(n._dropArea),n.isEmptyView=!!n.options.fromEmptyView;var i={enter:function(e,t){n.dragEnteredCallback(e,t)},leave:function(e,t){n.dragLeaveCallback(e,t)},over:function(e,t){n.dragOverCallback(e,t)},drop:function(e,t,i){n.itemDroppedCallback(e,t,i)}};t.droppable(n._dropArea,i),n._destroyToken=n._applicationChannel&&n._applicationChannel.subscribe({event:"xsrc-destroy-drop-token"},n.cleanDroppable.bind(n))},r.prototype.itemDroppedCallback=function(t){if(this.isEmptyView||"disable"===this._inviteHandler||this._inviteHandler.hide(),this._dropArea.classList.remove("dragging"),event.dataTransfer&&event.dataTransfer.files&&event.dataTransfer.files.length>0)a.ONPREMISE===i.getPlatformId()?this.options.onDropCallback(event.dataTransfer.files):widget.notificationUtil.showError(e.invalid_object_dropped);else{var n=null,o=void 0;try{n=JSON.parse(t)}catch(t){return void widget.notificationUtil.showError(e.parse_drop_data_failed)}var r=n.data.items;if("OPEN"===this.options.dropStrategy||"CREATE"===this.options.dropStrategy){if(this.options.multiObjs)o=r;else{if(n.data.DataGridView_Column_Options)return;r||widget.notificationUtil.showError(e.invalid_object_dropped),r.length>1&&widget.notificationUtil.showWarning(e.drop_one_object),o=r[0]}this.validatePlatformAndDropObject(n,o)}}},r.prototype.dragEnteredCallback=function(){this.isEmptyView||"disable"===this._inviteHandler||(this._inviteHandler.addBorder(),this._inviteHandler.show(this.getOnDropLabel())),this._dropArea.classList.contains("dragging")||this._dropArea.classList.add("dragging")},r.prototype.dragLeaveCallback=function(){var e=this;setTimeout(function(){e.isEmptyView||"disable"===e._inviteHandler||e._inviteHandler.hide(),e._dropArea.classList.contains("dragging")&&e._dropArea.classList.remove("dragging")},200)},r.prototype.dragOverCallback=function(){this.isEmptyView||"disable"===this._inviteHandler||this._inviteHandler.show(this.getOnDropLabel()),this._dropArea.classList.contains("dragging")||this._dropArea.classList.add("dragging")},r.prototype.cleanDroppable=function(){t.clean(this._dropArea),this._applicationChannel.unsubscribe(this._destroyToken)},r.prototype.makeDraggable=function(e,n){t.draggable(e,n)},r.prototype.initDnDView=function(e){var t=new n({renderTo:e});return t.hide(),t},r.prototype.getOnDropLabel=function(){switch(this.options.dropStrategy){case"OPEN":return"drop";case"CREATE":default:return"insert"}},r.prototype.validatePlatformAndDropObject=function(t,n){widget.notificationUtil=o;var r=i.getPlatformId(),s=t.data.items[0].envId;a.DND_PLATFORM_VALIDATION_EXCLUSIONS.includes(t.source)||r===s?this.options.onDropCallback(n):widget.notificationUtil.showError(e.invalidPlatform+r)},r}),define("DS/ENOXSourcingUXInfra/EmptyContent/ENOXSourcingEmptyContent",["DS/ENOXEmptyContent/js/ENOXEmptyContent","DS/Controls/Button","DS/ENOXSourcingUXInfra/DragAndDrop/ENOXSourcingDataDragAndDrop","css!DS/ENOXSourcingUXInfra/EmptyContent/ENOXSourcingEmptyContent.css"],function(e,t,n){"use strict";var i=function(){};return i.prototype.init=function(e){(this.options=e,this._tokens=[],this._applicationChannel=widget.app._applicationChannel,this._router=e.router,this._emptyContentArea=e.emptyContentArea,this.initEmptyContent(this),e.fromEmptyView=!0,void 0===e.disableDroppableArea||!1===e.disableDroppableArea)&&(new n).makeAreaDroppable(e)},i.prototype.initEmptyContent=function(){var n=this,i={sentences:[{type:"dom",DOMelement:new t({label:n.options.emptyDataButtonLabel,emphasize:"primary",icon:{iconName:n.options.emptyDataButtonIcon}}).getContent(),events:{onclick:function(){n.options.emptyDataButtonCallback()}}}],fontSize:"16px",orderedListType:"none",modelEvents:n._applicationChannel};if(void 0===n.options.disableDroppableArea||!1===n.options.disableDroppableArea){var o={type:"drop",text:n.options.dropIconLabel};i.sentences.push(o)}new e(i).inject(n._emptyContentArea)},i}),define("DS/ENOXSourcingUXInfra/service/ENONetworkServices",["UWA/Class","DS/WAFData/WAFData","DS/ENOXSourcingUXInfra/service/ENOXSourcingPlatformServices"],function(e,t,n){"use strict";return e.singleton({initialize:function(){},getDataPromise:function(e){return new Promise(function(i,o){var a=n._platforms[e.source]+e.endpoint;t.authenticatedRequest(a,{method:"GET",type:"json",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},onComplete:function(e){i(e)},onFailure:function(e,t){o(t||(e.message?e.message:e))}})})},postDataPromise:function(e){return new Promise(function(i,o){var a=n._platforms[e.source]+e.endpoint+"?&tenant="+n.getPlatformId();t.authenticatedRequest(a,{method:"POST",type:"json",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},data:UWA.Json.encode(e.postData),onComplete:function(e){i(e)},onFailure:function(e,t){o(t)},onTimeout:function(){}})})}})}),define("DS/ENOXSourcingUXInfra/service/ENOXSourcingService",["UWA/Class","DS/WAFData/WAFData","DS/ENOXSourcingUXInfra/service/ENOXSourcingPlatformServices","DS/WidgetServices/WidgetServices","i18n!DS/ENOXSourcingUXInfra/assets/nls/ENOXSourcingUXInfra","DS/ENOXSourcingUXInfra/service/ENONetworkServices","DS/ENOXSourcingUXInfra/Constants/ENOXSourcingConstants"],function(e,t,n,i,o,a,r){"use strict";return e.singleton({initialize:function(){},isSessionExpired:function(e){let t=e.status||e.statusCode,n=!1;return!t||t!==r.SESSSION_EXPIRED&&t!==r.UNAUTHORISED_REQUEST||(widget.notificationUtil.showError(o.session_expired),n=!0),n},getServiceURL:function(e){var t=n.getServiceURL(e.source?e.source:"3DSpace")+e.endpoint;return t.includes("?")?t+"&tenant="+n.getPlatformId():t+"?tenant="+n.getPlatformId()},getSecurityContext:function(e){var t=e||r.SERVICE_3DSPACE;return n.getPlatformId()!==r.ONPREMISE&&t===r.SOURCE_SOURCING?n.passiveSC:"ctx::"+widget.getValue("SC")},getService:function(e){var a=this;e.onComplete,n.getCSRFToken(n.getServiceURL(e.source?e.source:"3DSpace"),e.source).then(function(n){var o=a.getServiceURL(e),r={"Content-Type":"application/json",ENO_CSRF_TOKEN:n};r.SecurityContext=a.getSecurityContext(e.source),r["Accept-Language"]=i.getLanguage(),t.authenticatedRequest(o,{method:"GET",type:"json",headers:r,onComplete:function(t){e.onComplete(t)},onFailure:function(t,n){n&&a.isSessionExpired(n)||(e.onFailure?e.onFailure(n||{error:t.message}):widget.notificationUtil.showError(n.error))}})},function(){widget.notificationUtil.showError(o.csrf_error+e.source)})},deleteService:function(e){var a=this;e.onComplete,n.getCSRFToken(n.getServiceURL(e.source?e.source:"3DSpace"),e.source).then(function(n){var o=a.getServiceURL(e);e.deleteData&&(e.deleteData.csrf={name:"ENO_CSRF_TOKEN",value:n}),t.authenticatedRequest(o,{method:"DELETE",type:"json",headers:{"Content-Type":"application/json",ENO_CSRF_TOKEN:n,SecurityContext:a.getSecurityContext(e.source),"Accept-Language":i.getLanguage()},data:UWA.Json.encode(e.deleteData?e.deleteData:{}),onComplete:function(t){e.onComplete(t)},onFailure:function(t,n){n&&a.isSessionExpired(n)||(e.onFailure?e.onFailure(n||{error:t.message}):widget.notificationUtil.showError(n.error))}})},function(){widget.notificationUtil.showError(o.csrf_error+e.source)})},deleteServicePromise:function(e){var a=this;return n.getCSRFToken(n.getServiceURL(e.source?e.source:"3DSpace"),e.source).then(function(n){return new Promise(function(o,r){var s=a.getServiceURL(e);e.deleteData&&(e.deleteData.csrf={name:"ENO_CSRF_TOKEN",value:n}),t.authenticatedRequest(s,{method:"DELETE",type:"json",headers:{"Content-Type":"application/json",ENO_CSRF_TOKEN:n,SecurityContext:a.getSecurityContext(e.source),"Accept-Language":i.getLanguage()},data:UWA.Json.encode(e.deleteData?e.deleteData:{}),onComplete:function(e){o(e)},onFailure:function(e,t){t&&a.isSessionExpired(t)||r(t||(e.message?e.message:e))}})})},function(){widget.notificationUtil.showError(o.csrf_error+e.source)})},createService:function(e){var a=this;e.onComplete,n.getCSRFToken(n.getServiceURL(e.source?e.source:"3DSpace"),e.source).then(function(n){var o=a.getServiceURL(e);e.addData.csrf={name:"ENO_CSRF_TOKEN",value:n},t.authenticatedRequest(o,{method:"POST",type:"json",headers:{"Content-Type":"application/json",ENO_CSRF_TOKEN:n,SecurityContext:a.getSecurityContext(e.source),"Accept-Language":i.getLanguage()},data:UWA.Json.encode(e.addData),onComplete:function(t){e.onComplete(t)},onFailure:function(t,n){n&&a.isSessionExpired(n)||(e.onFailure?e.onFailure(n||{error:t.message}):widget.notificationUtil.showError(n.error))}})},function(){widget.notificationUtil.showError(o.csrf_error+e.source)})},createServicePromise:function(e){var a=this;return n.getCSRFToken(n.getServiceURL(e.source?e.source:"3DSpace"),e.source).then(function(n){return new Promise(function(o,r){var s=a.getServiceURL(e);e.addData.csrf={name:"ENO_CSRF_TOKEN",value:n},t.authenticatedRequest(s,{method:"POST",type:"json",headers:{"Content-Type":"application/json",ENO_CSRF_TOKEN:n,SecurityContext:a.getSecurityContext(e.source),"Accept-Language":i.getLanguage()},data:UWA.Json.encode(e.addData),onComplete:function(e){o(e)},onFailure:function(e,t){t&&a.isSessionExpired(t)||r(t||(e.message?e.message:e))}})})},function(){widget.notificationUtil.showError(o.csrf_error+e.source)})},createServiceXInfra:function(e){var a=this;e.onComplete,n.getCSRFToken(n.getServiceURL(e.source?e.source:"3DSpace"),e.source).then(function(n){var o=a.getServiceURL(e);e.addData.csrf={name:"ENO_CSRF_TOKEN",value:n},t.authenticatedRequest(o,{method:"POST",type:"json",headers:{"Content-Type":"application/json",SecurityContext:a.getSecurityContext(e.source),ENO_CSRF_TOKEN:n,"Accept-Language":i.getLanguage()},data:UWA.Json.encode(e.addData),onComplete:function(t){e.onComplete(t)},onFailure:function(t,n){n&&a.isSessionExpired(n)||(e.onFailure?e.onFailure(n||{error:t.message}):widget.notificationUtil.showError(n.error))}})},function(){widget.notificationUtil.showError(o.csrf_error+e.source)})},deleteServiceXInfra:function(e){var a=this;e.onComplete,n.getCSRFToken(n.getServiceURL(e.source?e.source:"3DSpace"),e.source).then(function(n){var o=a.getServiceURL(e);e.data.csrf={name:"ENO_CSRF_TOKEN",value:n},t.authenticatedRequest(o,{method:"POST",type:"json",headers:{"Content-Type":"application/json",SecurityContext:a.getSecurityContext(e.source),ENO_CSRF_TOKEN:n,"Accept-Language":i.getLanguage()},data:UWA.Json.encode(e.data),onComplete:function(t){e.onComplete(t)},onFailure:function(t,n){n&&a.isSessionExpired(n)||(e.onFailure?e.onFailure(n||{error:t.message}):widget.notificationUtil.showError(n.error))}})},function(){widget.notificationUtil.showError(o.csrf_error+e.source)})},updateService:function(e){var a=this;e.onComplete,n.getCSRFToken(n.getServiceURL(e.source?e.source:"3DSpace"),e.source).then(function(n){var o=a.getServiceURL(e);e.addData.csrf={name:"ENO_CSRF_TOKEN",value:n},t.authenticatedRequest(o,{method:"PATCH",type:"json",headers:{"Content-Type":"application/json",ENO_CSRF_TOKEN:n,SecurityContext:a.getSecurityContext(e.source),"Accept-Language":i.getLanguage()},data:UWA.Json.encode(e.addData),onComplete:function(t){e.onComplete(t)},onFailure:function(t,n){n&&a.isSessionExpired(n)||(e.onFailure?e.onFailure(n||{error:t.message}):widget.notificationUtil.showError(n.error))}})},function(){widget.notificationUtil.showError(o.csrf_error+e.source)})},updateServicePromise:function(e){var a=this;return n.getCSRFToken(n.getServiceURL(e.source?e.source:"3DSpace"),e.source).then(function(n){return new Promise(function(o,r){var s=a.getServiceURL(e);e.addData.csrf={name:"ENO_CSRF_TOKEN",value:n},t.authenticatedRequest(s,{method:"PATCH",type:"json",headers:{"Content-Type":"application/json",ENO_CSRF_TOKEN:n,SecurityContext:a.getSecurityContext(e.source),"Accept-Language":i.getLanguage()},data:UWA.Json.encode(e.addData),onComplete:function(e){o(e)},onFailure:function(e,t){t&&a.isSessionExpired(t)||r(t||(e.message?e.message:e))}})})},function(){widget.notificationUtil.showError(o.csrf_error+e.source)})},updateServiceXInfra:function(e){var a=this;e.onComplete,n.getCSRFToken(n.getServiceURL(e.source?e.source:"3DSpace"),e.source).then(function(n){var o=a.getServiceURL(e);t.authenticatedRequest(o,{method:"PATCH",type:"json",headers:{"Content-Type":"application/json",SecurityContext:a.getSecurityContext(e.source),ENO_CSRF_TOKEN:n,"Accept-Language":i.getLanguage()},data:UWA.Json.encode(e.addData),onComplete:function(t){e.onComplete(t)},onFailure:function(t,n){n&&a.isSessionExpired(n)||(e.onFailure?e.onFailure(n||{error:t.message}):widget.notificationUtil.showError(n.error))}})},function(){widget.notificationUtil.showError(o.csrf_error+e.source)})},updateServiceXInfraPromise:function(e){var a=this;return n.getCSRFToken(n.getServiceURL(e.source?e.source:"3DSpace"),e.source).then(function(n){return new Promise(function(o,r){var s=a.getServiceURL(e);t.authenticatedRequest(s,{method:"PATCH",type:"json",headers:{"Content-Type":"application/json",SecurityContext:a.getSecurityContext(e.source),ENO_CSRF_TOKEN:n,"Accept-Language":i.getLanguage()},data:UWA.Json.encode(e.addData),onComplete:function(e){o(e)},onFailure:function(e,t){t&&a.isSessionExpired(t)||r(t||(e.message?e.message:e))}})})},function(){widget.notificationUtil.showError(o.csrf_error+e.source)})},getLifeCycleDataForAnObject:function(e){var a=this;return n.getCSRFToken(n.getServiceURL(e.source?e.source:"3DSpace"),e.source).then(function(n){return new Promise(function(o,r){var s=a.getServiceURL(e);t.authenticatedRequest(s,{method:"GET",type:"json",headers:{"Content-Type":"application/json",ENO_CSRF_TOKEN:n,SecurityContext:a.getSecurityContext(e.source),"Accept-Language":i.getLanguage()},onComplete:function(e){o(e)},onFailure:function(e,t){t&&a.isSessionExpired(t)||r(e)}})})},function(){widget.notificationUtil.showError(o.csrf_error+e.source)})},performLifeCycleAction:function(e){var a=this;return n.getCSRFToken(n.getServiceURL(e.source?e.source:"3DSpace"),e.source).then(function(n){return new Promise(function(o,r){var s=a.getServiceURL(e);e.lifeCycleData.csrf={name:"ENO_CSRF_TOKEN",value:n},t.authenticatedRequest(s,{method:"POST",type:"json",headers:{"Content-Type":"application/json",ENO_CSRF_TOKEN:n,SecurityContext:a.getSecurityContext(e.source),"Accept-Language":i.getLanguage()},data:UWA.Json.encode(e.lifeCycleData),onComplete:function(e){o(e)},onFailure:function(e,t){t&&a.isSessionExpired(t)||r(t)}})})},function(){widget.notificationUtil.showError(o.csrf_error+e.source)})},getDataPromise:function(e){var a=this;return n.getCSRFToken(n.getServiceURL(e.source?e.source:"3DSpace"),e.source).then(function(n){return new Promise(function(o,r){var s=a.getServiceURL(e),l={"Content-Type":"application/json",ENO_CSRF_TOKEN:n,SecurityContext:a.getSecurityContext(e.source),"Accept-Language":i.getLanguage()};t.authenticatedRequest(s,{method:"GET",type:"json",headers:l,onComplete:function(e){o(e)},onFailure:function(e,t){t&&a.isSessionExpired(t)||r(t||(e.message?e.message:e))}})})},function(){widget.notificationUtil.showError(o.csrf_error+e.source)})},getDataPromiseWithCSRF:function(e){var a=this;return n.getCSRFToken(n.getServiceURL(e.source?e.source:"3DSpace"),e.source).then(function(n){return new Promise(function(o,r){var s=a.getServiceURL(e);t.authenticatedRequest(s,{method:"GET",type:"json",headers:{"Content-Type":"application/json",ENO_CSRF_TOKEN:n,SecurityContext:a.getSecurityContext(e.source),"Accept-Language":i.getLanguage()},onComplete:function(e){o(e)},onFailure:function(e,t){t&&a.isSessionExpired(t)||r(e)}})})},function(){widget.notificationUtil.showError(o.csrf_error+e.source)})},performPatchPromise:function(e){var a=this;return n.getCSRFToken(n.getServiceURL(e.source?e.source:"3DSpace"),e.source).then(function(n){return new Promise(function(o,r){var s=a.getServiceURL(e);e.attachDocumentData.csrf={name:"ENO_CSRF_TOKEN",value:n},t.authenticatedRequest(s,{method:"PATCH",type:"json",headers:{"Content-Type":"application/json",ENO_CSRF_TOKEN:n,SecurityContext:a.getSecurityContext(e.source),"Accept-Language":i.getLanguage()},data:UWA.Json.encode(e.attachDocumentData),onComplete:function(e){o(e)},onFailure:function(e,t){t&&a.isSessionExpired(t)||r(t)}})})},function(){widget.notificationUtil.showError(o.csrf_error+e.source)})},performDeletePromise:function(e){var a=this;return n.getCSRFToken(n.getServiceURL(e.source?e.source:"3DSpace"),e.source).then(function(n){return new Promise(function(o,r){var s=a.getServiceURL(e);t.authenticatedRequest(s,{method:"DELETE",type:"json",headers:{"Content-Type":"application/json",ENO_CSRF_TOKEN:n,SecurityContext:a.getSecurityContext(e.source),"Accept-Language":i.getLanguage()},data:UWA.Json.encode(e.deleteData?e.deleteData:{}),onComplete:function(e){o(e)},onFailure:function(e,t){t&&a.isSessionExpired(t)||r(t)}})})},function(){widget.notificationUtil.showError(o.csrf_error+e.source)})},performPostPromise:function(e){var a=this;return n.getCSRFToken(n.getServiceURL(e.source?e.source:"3DSpace"),e.source).then(function(n){return new Promise(function(o,s){var l=a.getServiceURL(e);let c=e.postData;"object"==typeof e.postData&&(c=UWA.Json.encode(e.postData),e.postData.csrf={name:"ENO_CSRF_TOKEN",value:n},e.postData.SecurityContext3DSpace=a.getSecurityContext(r.SERVICE_3DSPACE)),t.authenticatedRequest(l,{method:"POST",type:"json",headers:{"Content-Type":e.contentType?e.contentType:"application/json",ENO_CSRF_TOKEN:n,SecurityContext:a.getSecurityContext(e.source),"Accept-Language":i.getLanguage()},data:c,onComplete:function(e){o(e)},onFailure:function(e,t){t&&a.isSessionExpired(t)||s(t)}})})},function(){widget.notificationUtil.showError(o.csrf_error+e.source)})},performPutPromise:function(e){var a=this;return n.getCSRFToken(n.getServiceURL(e.source?e.source:"3DSpace"),e.source).then(function(n){return new Promise(function(o,r){var s=a.getServiceURL(e);e.putData.csrf={name:"ENO_CSRF_TOKEN",value:n},t.authenticatedRequest(s,{method:"PUT",type:"json",headers:{"Content-Type":"application/json",ENO_CSRF_TOKEN:n,SecurityContext:a.getSecurityContext(e.source),"Accept-Language":i.getLanguage()},data:UWA.Json.encode(e.putData),onComplete:function(e){o(e)},onFailure:function(e,t){t&&a.isSessionExpired(t)||r(t)}})})},function(){widget.notificationUtil.showError(o.csrf_error+e.source)})},getFederatedSearchDataPromise:function(e){var a=this;return new Promise(function(s,l){if(!e.searchPayLoad.login){let t={};t[r.SOURCE_3DSPACE]={SecurityContext:a.getSecurityContext(r.SOURCE_3DSPACE)},e.searchPayLoad.login=t}t.authenticatedRequest(n.getServiceURL("3DSearch")+(e.recent?"/recent":"/search"),{method:"POST",type:"json",headers:{"Content-Type":"application/json",SecurityContext:a.getSecurityContext(e.source),"Accept-Language":i.getLanguage()},onComplete:function(e){s(e)},data:UWA.Json.encode(e.searchPayLoad),onFailure:function(e,t){t&&a.isSessionExpired(t)||(widget.notificationUtil.showError(o.error_search_index_get),l(e))},onTimeout:function(e){l(e)}})})},getNetworkService:function(){var e={};return e.platForms=n._platforms,a.initialize(e),a}})}),define("DS/ENOXSourcingUXInfra/modelers/Lifecycle",["DS/ENOXSourcingUXInfra/service/ENOXSourcingService","DS/ENOXSourcingUXInfra/service/ENOXSourcingPlatformServices"],function(e,t){"use strict";return UWA.Class.singleton({init:function(e){this.source="sourcing",e.dataProvider.lifecycle=this,this._parent(e)},promote:function(n){let{data:i}=n,o={endpoint:"/resources/lifecycle/maturity/promote"};return o.source=this.source,"OnPremise"===t.getPlatformId()?o.lifeCycleData={data:[{physicalid:i[0].physicalid,tostate:i[0].tostate,fromstate:i[0].fromstate}]}:o.lifeCycleData={data:[{id:i[0].physicalid,physicalid:i[0].physicalid,type:"SRCComponentRequest",identifier:i[0].physicalid,source:"Sourcing",relativePath:"/resources/v1/modeler/dssourcing/sourcingrequests",tostate:i[0].tostate,fromstate:i[0].fromstate}]},e.performLifeCycleAction(o)},encode:function(e){return{data:[{physicalid:e.physicalid,tostate:e.tostate,fromstate:e.fromstate}]}}})}),define("DS/ENOXSourcingUXInfra/PropertiesView/EditPropertiesWidgetWrapper",["DS/UIKIT/Mask","DS/EditPropWidget/EditPropWidget","DS/EditPropWidget/constants/EditPropConstants","DS/ENOXSourcingUXInfra/service/ENOXSourcingService","DS/ENOXSourcingUXInfra/service/ENOXSourcingPlatformServices","DS/ENOXSourcingUXInfra/Constants/ENOXSourcingConstants"],function(e,t,n,i,o,a){"use strict";var r,s=function(e){this.params=e,this.editPropConstants=n,r=this};return s.prototype.render=function(){let i=r.prepareViewOptions(),o=r.prepareDataOptions(),a=r.params.viewOptions.container;if(!a)throw new Error("Container must be passed!!!");a.empty&&a.empty(),e.mask(a);let s=new t(i);s.initData(o),r.params.viewOptions&&r.params.viewOptions.typeOfDisplay===n.ONLY_EDIT_PROPERTIES?this.tabContainer=s.elements.container:s.elements.container.inject(a),e.unmask(a)},s.prototype.prepareViewOptions=function(){let e=r.params.viewOptions,t=!0,o=!1;void 0!==e.readOnly&&(t=e.readOnly),void 0!==e.editMode&&(o=e.editMode);let a={typeOfDisplay:e.typeOfDisplay?e.typeOfDisplay:n.ALL,selectionType:e.selectionType?e.selectionType:n.NO_SELECTION,readOnly:t,extraNotif:!e.extraNotif||e.extraNotif,editMode:o,showIdCard:e.showIdCard,context:{getSecurityContext:function(){return i.getSecurityContext()}},events:{onNotification:function(e){"info"===e.eventID?widget.notificationUtil.showInfo(e.msg):"error"===e.eventID?widget.notificationUtil.showError(e.msg):"warning"===e.eventID?widget.notificationUtil.showWarning(e.msg):"success"===e.eventID?widget.notificationUtil.showSuccess(e.msg):widget.notificationUtil.showMessage(e.msg)}}};return e.facets&&e.facets.length>0&&(a.facets=[],e.facets.forEach(e=>{a.facets.push(n[e])})),a},s.prototype.prepareDataOptions=function(){let e=r.params.dataOptions;if(!e.objectId)throw new Error("Object ID must be passed!!!");return[{metatype:e.metatype?e.metatype:"businessobject",objectId:e.objectId,tenant:o.getPlatformId(),source:e.source?e.source:a.SERVICE_3DSPACE}]},s}),define("DS/ENOXSourcingUXInfra/modelers/ManufacturerEquivalentItem",["DS/ENOXSourcingUXInfra/service/ENOXSourcingService"],function(e){"use strict";return UWA.Class.singleton({init:function(e){e.dataProvider.mei=this,this._parent(e)},list:function(t){return t.on3DSpace=!0,t.endpoint="/resources/v1/modeler/dssrc/dssrc:ManufacturerEquivalentItem?$mask=dsmvsrc:ManufacturerEquivalentItem.Details",new Promise(function(n,i){e.getDataPromise(t).then(function(e){n(e)}).catch(function(e){i(e)})})},show:function(t){return t.on3DSpace=!0,t.endpoint="/resources/v1/modeler/dssrc/dssrc:ManufacturerEquivalentItem/"+t.id+"?$mask=dsmvsrc:ManufacturerEquivalentItem.Details",e.getDataPromise(t)},listNonMigrated:function(t){return t.source="3DSpace",t.endpoint="/resources/v1/modeler/dssrc/invoke/dssrc:getNonMigratedMEI?$mask=dsmvsrc:ManufacturerEquivalentItem.Details",t.postData?e.performPostPromise(t):Promise.reject(new Error("MEI Data provider invoked without payload parameter 'postData'"))},migrateManufacturer:function(t){return t.source="3DSpace",t.endpoint="/resources/v1/modeler/dssrc/invoke/dssrc:migrateMEI?$mask=dsmvsrc:ManufacturerEquivalentItem.Details",t.postData?e.performPostPromise(t):Promise.reject(new Error("MEI Data provider invoked without payload parameter 'postData'"))}})}),define("DS/ENOXSourcingUXInfra/modelers/RequestTemplate",["DS/ENOXSourcingUXInfra/service/ENOXSourcingService"],function(e){"use strict";return UWA.Class.singleton({init:function(e){this.source="sourcing",e.dataProvider.requestTemplate=this,this._parent(e)},list:function(t){return t.source=this.source,t.endpoint="/resources/v1/modeler/dssourcing/sourcingrequesttemplates?$fields=requestCategory,impactedItemsRequired,hasAnswerItems,supportedInProcessItemTypes&type="+t.typesConfigurator[t.requestType].templateType,e.getDataPromise(t)}})}),define("DS/ENOXSourcingUXInfra/Search/SearchUtility",["DS/ENOXSourcingUXInfra/service/ENOXSourcingService","DS/ENOXSourcingUXInfra/service/ENOXSourcingPlatformServices","DS/ENOXSourcingUXInfra/Constants/ENOXSourcingConstants","DS/PlatformAPI/PlatformAPI","DS/FedDictionaryAccess/FedDictionaryAccessAPI"],function(e,t,n,i,o){"use strict";var a=function(){};return a.prototype.getSearchPayload=function(e,i,o,a){let r="";i.map(function(e){r+=' flattenedtaxonomies:"types/'+e+'"'+n.OR}),r=r.substring(0,r.length-3),a&&a.completePreCond&&(r=a.completePreCond),a&&a.isPersonOrGroup&&(r=n.ONPREMISE===t.getPlatformId()?n.QUERY_PERSON_OR_GROUP:n.QUERY_PERSON_OR_GROUP_CLOUD),a&&a.excludeCondition&&(r+=n.AND+a.excludeCondition),o=o.map(e=>e.toLowerCase()),n.ONPREMISE===t.getPlatformId()&&(o=[n.SOURCE_3DSPACE]);let s=a?a.nresults:e.length>1e3?999:e.length,l=this.prepareSecurityContexts(o);return{nresults:s,order_field:a&&a.order_field?a.order_field:"ds6w:label",with_indexing_date:!0,with_synthesis:!0,order_by:a&&a.order_by?a.order_by:"asc",start:a?a.start:0,label:"test",login:l,locale:widget.lang,select_predicate:n.UTILITY_PREDICATE_SELECTORS,select_file:n.UTILITY_FILE_SELECTORS,query:r,source:o,tenant:t.getPlatformId(),resourceid_in:e,resourceid_not_in:a&&a.resourceid_not_in?a.resourceid_not_in:[],with_nls:!a||a.with_nls,specific_source_parameter:{}}},a.prototype.callFederatedSearch=function(t){return new Promise(n=>{t.nresults>0?e.getFederatedSearchDataPromise({searchPayLoad:t}).then(function(e){n(e)}):n([])})},a.prototype.callRecentFederatedSearch=function(t){return new Promise(n=>{t.nresults>0?e.getFederatedSearchDataPromise({searchPayLoad:t,recent:!0}).then(function(e){n(e)}):n([])})},a.prototype.processResults=function(e){var t=[];return e.results&&e.results.map(function(e){let n={};e.attributes.map(e=>{e.dispValue?(n[e.name+"_displayValue"]=e.dispValue,n[e.name]=e.value):n[e.name]=e.value}),t.push(n)}),t},a.prototype.prepareSecurityContexts=function(t){var i={};return t.map(function(){i[n.SOURCE_3DSPACE]={SecurityContext:e.getSecurityContext(n.SOURCE_3DSPACE)}}),i},a.prototype.getPlatfromAPIObj=function(){return i},a.prototype.getNlsOfPropertiesValues=function(e){return new Promise(function(n){o.getNlsOfPropertiesValues(JSON.stringify(e),{apiVersion:"R2019x",tenantId:t.getPlatformId(),lang:widget.lang,onComplete:function(e){n(e)},onFailure:function(){n()}})})},a.prototype.getNonIndexedObjectIds=async function(e){let t,i={},o={},r=[n.SOURCE_3DSPACE];i.completePreCond="",e.forEach(e=>{i.completePreCond=i.completePreCond+"physicalid="+e+n.OR}),i.completePreCond=i.completePreCond.substring(0,i.completePreCond.length-3),i.nresults=e.length;let s=a.prototype.getSearchPayload([],[],r,i);t=await a.prototype.callRecentFederatedSearch(s),o=await a.prototype.callFederatedSearch(s),t=a.prototype.processFedSearchData(t),o=a.prototype.processFedSearchData(o);let l=t.map(e=>e.resourceid),c=o.map(e=>e.resourceid),d=[];e.forEach(e=>{l.includes(e)&&d.push(e)});let u=!1;return d.length>0&&d.forEach(e=>{if(!c.includes(e))return u=!0,d}),u?d:[]},a.prototype.processFedSearchData=function(e){if(!e.results)return[];let t=[];return e.results.forEach(e=>{let n={};e.attributes.forEach(e=>{e.dispValue?(n[e.name]=e.dispValue,e.dispValue!==e.value&&(n[e.name+"_value"]=e.value)):n[e.name]=e.value}),t.push(n)}),t},a.prototype.getPredicateValue=function(t){let i=[];t.forEach(e=>{e[n.MANUFACTURER_NAME_TAG]&&i.push(e[n.MANUFACTURER_NAME_TAG])});let o={endpoint:"/resources/6WVocab/access/PredicateValue",postData:{[n.MANUFACTURER_TAG]:[...new Set(i)]}};return new Promise(i=>{e.performPostPromise(o).then(function(e){t.forEach(t=>{t[n.MANUFACTURER_NAME_TAG]&&(t[n.MANUFACTURER_TITLE_TAG]=e[n.MANUFACTURER_TAG][t[n.MANUFACTURER_NAME_TAG]])}),i(t)})})},a}),define("DS/ENOXSourcingUXInfra/BranchRevisioning/BranchRevisioning",["DS/LifecycleCmd/NewBranchCmd","DS/ENOXSourcingUXInfra/Search/SearchUtility"],function(e,t){"use strict";return{execute:function(n){new e({context:n.branchingOptions}).execute(n.branchingOptions),(new t).getPlatfromAPIObj().subscribe("Lifecycle.Modification",function(e){JSON.parse(e).Refresh.created.some(e=>"Branch"===e.operation)&&n.branchingCallBack&&n.branchingCallBack()})}}}),define("DS/ENOXSourcingUXInfra/Search/ENOXSourcingSearch",["DS/SNInfraUX/SearchCom","DS/ENOXSourcingUXInfra/service/ENOXSourcingPlatformServices","DS/ENOXSourcingUXInfra/service/ENOXSourcingService","DS/ENOXSourcingUXInfra/Constants/ENOXSourcingConstants","DS/Windows/Dialog","DS/Controls/Button","DS/Controls/LineEditor","i18n!DS/ENOXSourcingUXInfra/assets/nls/ENOXSourcingUXInfra","css!DS/ENOXSourcingUXInfra/Search/ENOXSourcingSearch.css"],function(e,t,n,i,o,a,r,s){"use strict";var l=function(){};return l.prototype.init=function(n){var o=this;this.options=n;var a=UWA.Utils.getUUID(),r=e.createSocket({socket_id:a}),s="";n.precond&&(s=n.precond),n.typeSearch?s='flattenedtaxonomies:"types/'+n.typeSearch+'"':n.types&&(n.types.map(function(e){s+=' flattenedtaxonomies:"types/'+e+'"'+i.OR}),s=s.substring(0,s.length-3).trim()),n.typeSearch&&n.state&&(s='flattenedtaxonomies:"types/'+n.typeSearch+'" AND current:"'+n.state+'" AND latestrevision:"TRUE"');let l=[i.SOURCE_3DSPACE],c=o.prepareSecurityContexts(l);var d={title:n.title,role:"",mode:"furtive",default_with_precond:!0,precond:s,login:c,show_precond:!1,multiSel:!!this.options.multiSel&&this.options.multiSel,idcard_activated:!1,select_result_max_idcard:!1,itemViewClickHandler:"",app_socket_id:a,widget_id:a,search_delegation:"3dsearch",default_search_criteria:"",columns:n.predicates?n.predicates:[],tenant:t.getPlatformId(),resourceid_not_in:n.resourceid_not_in?n.resourceid_not_in:[],resourceid_in:n.resourceid_in?n.resourceid_in:[]};if(n.objList&&(d.precond="(physicalid="+n.objList+")"),n.subType&&(d.precond='([ds6w:kind]:"'+n.subType+'")'),n.subType&&n.state&&(d.precond='([ds6w:kind]:"'+n.subType+'") AND current:"'+n.state+'"'),n.excludeCondition&&(d.precond+=" AND "+n.excludeCondition),n.completePreCond&&(d.precond=n.completePreCond),n.specific_source_parameter&&(d.specific_source_parameter=n.specific_source_parameter),!UWA.is(r))throw new Error("Socket not initialized");r.dispatchEvent("RegisterContext",d),r.addListener("Selected_Objects_search",function(e){o.options.callbackMethod(e)}),r.addListener("closeTransient",function(e){"in_app_cancel"===e.command_id&&o.options.cancelCallback&&o.options.cancelCallback(),o.options.cancelCallback&&(o.options.cancelCallback=void 0)}),n.isTypeAheadSearch?r.dispatchEvent("InContextSearch",d):this.preSearchDialog().then(function(e){d.default_search_criteria=e,d.precond="("+d.precond+")",d.default_with_precond=!0,d.mode="furtive";d.advanced_search={showByDefault:!1,searchOnInit:!1},r.dispatchEvent("InContextSearch",d)})},l.prototype.prepareSecurityContexts=function(e){var t={};return e.map(function(e){t[e]={SecurityContext:n.getSecurityContext(e)}}),t},l.prototype.preSearchDialog=function(){return new Promise(function(e){let t,n,i,l;l=UWA.createElement("div",{class:"src-search-editor-content-container"}),n=new r({placeholder:s.search,value:"",displayClearFieldButtonFlag:!0,sizeInCharNumber:30}),(i=new a({displayStyle:"lite",label:"proceed",icon:{iconName:"search",fontIconFamily:1},showLabelFlag:!1,onClick:function(){n.value.length<3?widget.notificationUtil.showError(s.search_query_is_short):(e("*"+n.value+"*"),t.close())}})).getContent().addClassName("src-search-icon-button"),n.inject(l),i.inject(l),t=new o({domId:"src-input-search-dialog",identifier:"src-search-dialog",title:s.search_criteria,showTitleFlag:!1,content:l,activeFlag:!0,modalFlag:!0,position:{my:"top",at:"top",offsetX:0,offsetY:140},buttons:{Ok:new a({onClick:function(){n.value.length<3?widget.notificationUtil.showError(s.search_query_is_short):(e("*"+n.value+"*"),t.close())}})}})})},l}),define("DS/ENOXSourcingUXInfra/Utilities/Utility",["DS/Utilities/Dom","DS/ENOXSourcingUXInfra/Constants/ENOXSourcingConstants","DS/ENOXSourcingUXInfra/service/ENOXSourcingService","DS/ENOXSourcingUXInfra/Search/SearchUtility","DS/LifecycleControls/EditPropDialog","DS/TransientWidget/TransientWidget"],function(e,t,n,i,o,a){"use strict";var r=function(){this.searchUtil=new i};return r.prototype.gettypeshierarchy=function(e){var i={};return i.source=t.SERVICE_3DSPACE,i.endpoint="/resources/enong/dico/gettypeshierarchy",i.postData={types:[e]},n.performPostPromise(i)},r.prototype.propertyWidget=function(e,t){var n={model:{objectId:e},options:{arguments:t}};new o({ID:"propFor"+e}).launchProperties(n)},r.prototype.showWidget=function(e,t,n={mode:"panel"}){a.showWidget(e,"",t,n)},r.prototype.sortArrayAlphabeticallyBasedOnProperty=function(e=[],t){0!==e.length&&""!==t&&void 0!==t&&e.sort(function(e,n){var i=e[t].toLowerCase(),o=n[t].toLowerCase();return i<o?-1:i>o?1:0})},r.prototype.getDynamicPropertyField=function(e){var t={type:e.type,label:e.nlsName?e.nlsName:e.name,value:e.value,name:e.name,disable:!0,default:e.default};if("boolean"===t.type&&t.default&&(t.default=t.default.toUpperCase()),e.hasOwnProperty("range")){t.type="select";var n=[],i=e.range;i=(i=i.substring(1,i.length-1)).split(",");var o=e.displayRanges;o&&(o=(o=(o=o.substring(1,o.length-1)).split(",")).map(e=>e.trim())),i.forEach(function(i,a){i=i.trim();var r={label:o&&o[a]?o[a]:i,value:i};void 0===t.value&&e.default===i&&(r.selected=!0),n.push(r)}),t.options=n}return t},r.prototype.getProcessedActualDocumentData=function(e){var n=[],i=this,o=[],a=e.data;return new Promise(e=>{if(a.forEach(function(e){o.push(i.getDocumentId(e))}),o.length>0){var r=i.searchUtil.getSearchPayload(o,[t.DOCUMENT],[t.SOURCE_3DSPACE]);i.searchUtil.callFederatedSearch(r).then(function(o){a.forEach(function(e){var a=i.getActualDataFromSearch(o,e.Proxy_Id?e.Proxy_Id:e.physicalid?e.physicalid:e.id),r={title:a["ds6w:label"]?a["ds6w:label"]:e.title||e.Title||e.Proxy_Title,tree:a["ds6w:label"]?a["ds6w:label"]:e.title||e.Title||e.Proxy_Title,name:a.name?a.name:e.Name||e.name,description:a["ds6w:description"]?a["ds6w:description"]:e.description,id:e.physicalid?e.physicalid:e.id,revision:a["ds6wg:revision"]?a["ds6wg:revision"]:e.revision,state:a["ds6w:what/ds6w:status"]?a["ds6w:what/ds6w:status"]:e.stateDisplay?e.stateDisplay:e.stateNLS,modified:a["ds6w:when/ds6w:modified"]?a["ds6w:when/ds6w:modified"]:e.modified,created:a["ds6w:when/ds6w:created"]?a["ds6w:when/ds6w:created"]:e.originated,owner:i.getDocumentOwnerName(a,e),type:a["ds6w:what/ds6w:type"]?a["ds6w:what/ds6w:type"]:e.type||e.type,modifyAccess:e.modifyAccess,deleteAccess:e.deleteAccess?e.deleteAccess:e.hasDeleteAccess,image:a.preview_url?a.preview_url:e.image?e.image:"ENOXSourcingUXInfra/assets/icons/32/I_CDM_Document108x144.png",isSpecification:e.isSpecification,source:e.Proxy_Service?e.Proxy_Service:e.type!==t.DOCUMENT_PROXY?t.SERVICE_3DSPACE:t.SOURCE_SOURCING,service:e.Proxy_Service?e.Proxy_Service===t.SOURCE_3DSPACE?t.SERVICE_3DSPACE:e.Proxy_Service:e.type!==t.DOCUMENT_PROXY?t.SERVICE_3DSPACE:t.SOURCE_SOURCING,actualId:a.physicalid?a.physicalid:e.id,proxyId:e.Proxy_Id?e.Proxy_Id:e.physicalid?e.physicalid:e.id,actualType:t.DOCUMENT};n.push(r)}),e(n)})}else e(n)})},r.prototype.getDocumentId=function(e){return e.Proxy_Id?e.Proxy_Id:e.physicalid?e.physicalid:e.id},r.prototype.getActualDataFromSearch=function(e,t){if(!e.results)return{};var n=e.results.filter(e=>{return e.attributes.filter(e=>"resourceid"===e.name&&e.value===t).length>0}),i={};return n.length>0&&n[0].attributes.forEach(e=>{e.dispValue?i[e.name]=e.dispValue:i[e.name]=e.value}),i},r.prototype.getDocumentOwnerName=function(e,t){var n={};return t.relateddata&&t.relateddata.ownerInfo&&t.relateddata.ownerInfo[0]&&(n=t.relateddata.ownerInfo[0]),e["ds6w:who/ds6w:responsible"]?e["ds6w:who/ds6w:responsible"]:n?n.firstname+" "+n.lastname:t.Owner||t.owner},r.prototype.setCustomView=function(e){let t=[];try{let n=e.getCustomViewsManager(),i=n.getCurrentCustomView();void 0!==i&&n.setCurrentCustomView(i.identifier)}catch(e){t.push(e)}},r.prototype.getTypeRepresentationKey=function(e){let t="";switch(e.type.toLowerCase()){case"integer":t="integer";break;case"real":t="float";break;case"timestamp":t="date";break;case"boolean":t="boolean";break;default:t="string"}return t},r.prototype.processLabelValue=function(e,t){let n=[];return e.forEach(function(e,i){n.push({label:""===(t&&t[i]?t[i]:e)?" ":t&&t[i]?t[i]:e,value:e})}),n},r.prototype.processRoute=function(e){let t=JSON.parse(widget.getRefreshViewParams("xpflLastVisitedRoute"));if(t.previousRoutes||(t.previousRoutes=[]),e.params&&!e.params.fromBackButton){if(!e.params.isRefresh){let e={name:t.name,id:t.id,params:t.params};t.previousRoutes.push(e)}}else t.previousRoutes.pop();t.name=e.name,t.id=e.params.id?e.params.id:e.params.pid?e.params.pid:"",e.params.respParams&&e.params.respParams.respParams&&(e.params.respParams.respParams={}),e.params&&e.params.params&&(e.params.params={}),t.params=e.params,widget.setRefreshViewParams("xpflLastVisitedRoute",JSON.stringify(t))},r.prototype.initializeGlobalMethods=function(){widget.setRefreshViewParams=function(e,t){e+=widget.id,window.localStorage.removeItem(e),window.localStorage.setItem(e,t)},widget.getRefreshViewParams=function(e){return e+=widget.id,window.localStorage.getItem(e)}},r.prototype.invokeContextualMenuOnClick=function(t){e.addEventOnElement(this,t,"click",function(e){let t=document.createEvent("HTMLEvents");t.initEvent("contextmenu",!0,!1),t.pageX=e.pageX,t.pageY=e.pageY,this.dispatchEvent(t)})},r.prototype.getTypeFromTypeHierarchy=function(e,t,n){let i="";return e.length<1||n.includes(t)?i=t:e.forEach(function(e){n.includes(e)&&(i=e)}),i},r.prototype.get6WTagsForIDs=function(e,t){var n="idList=";return e.length>0&&(n+=e.join(",")),new Promise(e=>{t.getTagsRead(n).then(function(t){e(t)},function(t){widget.notificationUtil.showError(t),e(t)})})},r.prototype.buildTagObjectData=function(e){var n={},i=Object.prototype.hasOwnProperty,o=t.IMPLICIT_TAG_PREFIX.length,a=t.EXPLICIT_TAG_PREFIX.length;return e.forEach(function(e){var r=[];try{for(var s in e)if("_tag_implicit_ds6w:what/ds6w:type"!==s&&i.call(e,s)&&"id"!==s){var l,c="";-1===s.indexOf(t.IMPLICIT_TAG_PREFIX)?l=a:(c="implicit",l=o);for(var d=e[s],u=s.substr(l),p=d.length,m=0;m<p;m++){var h={object:d[m],dispValue:d[m],sixw:u,field:c};r.push(h)}}}catch(e){console.error("WidgetTagNavInit: loadTagDataDone"+e)}n[e.id]=r}),n},r.prototype.disableOrEnableButton=function(e){let t=widget.getElement("#createBtn"),n=widget.getElement("#createanotherBtn"),i=widget.getElement("#closeModalBtn");t&&(t.disabled=e),n&&(n.disabled=e),i&&(i.disabled=e)},r}),define("DS/ENOXSourcingUXInfra/InfiniteScrolling/InfiniteScrollingImpl",["DS/TreeModel/TreeNodeModel","text!DS/ENOXSourcingUXInfra/assets/config/ENOXSourcingConfig.json","DS/UIKIT/Mask","DS/ENOXSourcingUXInfra/Constants/ENOXSourcingConstants","i18n!DS/ENOXSourcingUXInfra/assets/nls/ENOXSourcingUXInfra","DS/ENOXSourcingUXInfra/Utilities/Utility"],function(e,t,n,i,o,a){"use strict";var r=function(e){var t=this;t.options=e,t.utility=new a,t.activeRoute=widget.app.router._router.getState().name,t.options.controller.options.top=i.lazy_load_chunk_size,t.options.controller.options.skip=0,t.options.view.collectionView._xsourcingCollectionViewUI._tilecollectionView.onInfiniteScroll(function(){t.initTileandThumbnailLoader(),t.infiniteScrollAction(t.options)}),t.options.view.collectionView._xsourcingCollectionViewUI._thumbnailCollectionView.onInfiniteScroll(function(){t.initTileandThumbnailLoader(),t.infiniteScrollAction(t.options)}),t.options.view.collectionView._xsourcingCollectionViewUI._dataGridView.onInfiniteScroll(function(e){!1!==e.reachBottom?t.infiniteScrollAction(t.options):t.options.controller.view.collectionView._xsourcingCollectionViewUI._dataGridView.infiniteScrollProcessDone()})};return r.prototype.infiniteScrollAction=function(e){e.controller.options.skip+=e.controller.options.top,e.controller.options.isLazyLoading=!0,e.controller.list(e.controller.options)},r.prototype.processReloadData=function(t){if(this.activeRoute===widget.app.router._router.getState().name){this.lastFetchedCount=t.length;var i=this.options.controller.view.collectionView._xsourcingCollectionViewUI._noObjectAvailableDiv;t.length>0&&i&&i.destroy(),this.destroyLoader(),this.options.controller.view.collectionView._gridModel.prepareUpdate();for(var o=0;o<t.length;o++){t[o].contextualMenu=[""],t[o].tooltip&&(t[o].customTooltip=this._getCustomToolTip(t[o].tooltip));var a=new e(t[o]);this.options.controller.view.collectionView._gridModel.addRoot(a)}this.options.controller.view.collectionView._xsourcingCollectionViewUI._tilecollectionView.onPostUpdateView(function(){n.unmask(widget.body)}),this.options.controller.view.collectionView._xsourcingCollectionViewUI._thumbnailCollectionView.onPostUpdateView(function(){n.unmask(widget.body)}),this.options.controller.view.collectionView._xsourcingCollectionViewUI._dataGridView.onPostUpdateView(function(){n.unmask(widget.body)}),this.options.controller.view.collectionView._gridModel.pushUpdate();var r=this.options.controller.view.collectionView._xsourcingCollectionViewUI._tilecollectionView.model.length;this.options.controller.view.collectionView._xsourcingCollectionViewUI.toolbarOptions.lockItemCount||this.options.controller.view.collectionView._xsourcingCollectionViewUI._toolbarChannel.publish({event:"enox-collection-toolbar-items-count-update",data:r}),this.options.controller.view.collectionView._xsourcingCollectionViewUI._tilecollectionView.infiniteScrollProcessDone(),this.options.controller.view.collectionView._xsourcingCollectionViewUI._thumbnailCollectionView.infiniteScrollProcessDone(),this.options.controller.view.collectionView._xsourcingCollectionViewUI._dataGridView.infiniteScrollProcessDone(),0!==t.length&&this.utility.setCustomView(this.options.controller.view.collectionView._xsourcingCollectionViewUI._dataGridView)}},r.prototype._getCustomToolTip=function(e){var t="";return e.forEach(function(e){""!==e.data&&void 0!==e.data&&(""!==t&&(t+="\n"),t=t+e.label+": "+e.data)}),t},r.prototype.initResizePage=function(e){var t=this;t.options=e,t.options.view.collectionView._xsourcingCollectionViewUI._tilecollectionView.onEndResizeOrOnReadyModelRequest(function(e){var n={};n.controller=t.options.controller,n.context=e,t.resizePageAction(n)}),t.options.view.collectionView._xsourcingCollectionViewUI._tilecollectionView.onEndResizeOrOnReadyModelRequest(function(e){var n={};n.controller=t.options.controller,n.context=e,t.resizePageAction(n)}),t.options.view.collectionView._xsourcingCollectionViewUI._tilecollectionView.onEndResizeOrOnReadyModelRequest(function(e){var n={};n.controller=t.options.controller,n.context=e,t.resizePageAction(n)})},r.prototype.resizePageAction=function(e){var t=this;t.resizePage=function(e){var n=e.context.RowMaxNumber*e.context.ColumnsMaxNumber;if(n>e.controller.top){var i=n-e.controller.top;e.controller.top=i+e.controller.top,t.ViewportCompleteAction(e),e.controller.view.collectionView._xsourcingCollectionViewUI._tilecollectionView.EndResizeOrOnReadyModelRequestDone()}},t.ViewportCompleteAction=function(e){e.controller.options.skip=0,e.controller.options.top=e.controller.top,e.controller.options.isLazyActivated=!0,e.controller.list(e.controller.options)},t.resizePage(e)},r.prototype.initTileandThumbnailLoader=function(){this.loaderContainer&&this.loaderContainer.destroy(),this.loaderContainer=UWA.createElement("div",{class:"loader-container",id:"loaderContainer",styles:{margin:"auto",height:"30px"}});var e=this.options.view.collectionView._xsourcingCollectionViewUI.viewContainer.getElementsByClassName("wux-scroller wux-ui-is-rendered")[0];e&&e.appendChild(this.loaderContainer),this.loaderContainer&&n.mask(this.loaderContainer,o.loading)},r.prototype.destroyLoader=function(){this.loaderContainer&&this.loaderContainer.destroy()},r}),define("DS/ENOXSourcingUXInfra/openwithservice/ENOXSourcingOpenWithService",["UWA/Core","UWA/Class","DS/i3DXCompassPlatformServices/OpenWith","UWA/Class/Promise","DS/ENOXSourcingUXInfra/service/ENOXSourcingService","DS/ENOXSourcingUXInfra/service/ENOXSourcingPlatformServices","DS/ENOXSourcingUXInfra/Constants/ENOXSourcingConstants","DS/ENOXSourcingUXInfra/Utilities/Utility"],function(e,t,n,i,o,a,r,s){"use strict";return t.singleton({init:function(e){this.option=e,this.utility=new s},initialize:function(e){this.app=e},getOpenWithMenu:function(t){var o=this;return o.utility.gettypeshierarchy(o.getObjectActualType(t)).then(function(a){var r=o.getContentForCompassInteraction(t,a),s=new n;s.set3DXContent(r);var l=[];if(e.is(s.retrieveCompatibleApps,"function"))return new i(function(e,t){s.retrieveCompatibleApps(function(t){t.forEach(function(e){l.push(o.getSubmenuOptions(e,null))}),e(l)},function(){t(new Error("Error while getting Open with menus"))})})}).catch(function(e){widget.notificationUtil.showError(e)})},getSubmenuOptions:function(e,t){return{id:e.text,title:e.text,icon:e.icon?e.icon:e.fonticon,type:"PushItem",multisel:!1,action:{context:t,callback:e.handler}}},getContentForCompassInteraction:function(e,t){let n=e;var i=[],o={envId:widget.getValue("x3dPlatformId"),serviceId:this.getServiceId(n),contextId:"",objectId:this.getObjectId(n),objectType:this.getObjectActualType(n),displayName:this.getDisplayName(n),displayType:this.getObjectActualType(n),facetName:"realized",path:[{resourceid:this.getObjectId(n),type:this.getObjectActualType(n)}],objectTaxonomies:this.getObjectTaxonomies(n,t)};return i.push(o),{protocol:"3DXContent",version:"1.1",source:widget.data.appId,widgetId:widget.id,data:{items:i}}},getServiceId:function(){var e=r.SOURCE_3DSPACE;return r.ONPREMISE===a.getPlatformId()&&(e=r.SERVICE_3DSPACE),e},getObjectId:function(e){let t="";return t=e&&e.options.grid.id&&r.ONPREMISE===a.getPlatformId()?e.options.grid.id:e.options.grid.actualId?e.options.grid.actualId:e.options.grid.id},getObjectActualType:function(e){let t="";return e&&e.options.grid.id&&(t=e.options.grid.actualType?e.options.grid.actualType:e.options.grid.type),t},getObjectType:function(e){let t="";return e&&e.options.grid.id&&(t=e.options.grid.type),t},getDisplayName:function(e){let t="";return e&&e.options.grid.id&&(t=e.options.grid.title),t},getObjectTaxonomies:function(e,t){var n=[];return e.options.grid.actualType===r.VPMREFERENCE?e.options.grid.additionalDragData&&e.options.grid.additionalDragData.objectTaxonomies.includes(r.MEI_EXTENSION)?(n.push(r.VPMREFERENCE),n.push(r.MEI_EXTENSION)):n.push(r.VPMREFERENCE):e.options.grid.actualType===r.DOCUMENT?n.push(r.DOCUMENT):e.options.grid.actualType===r.TYPE_COMPONENT_REQUEST?n.push(r.TYPE_COMPONENT_REQUEST):e.options.grid.actualType===r.MANUFACTURING_ITEM_PROXY?n.push(r.DELFMIFUNCTIONREFERENCE):e.options.grid.actualType===r.MEI_PROXY?(n.push(r.VPMREFERENCE),n.push(r.MEI_EXTENSION)):e.options.grid.actualType===r.ENG_ITEM_PROXY?n.push(r.VPMREFERENCE):e.options.grid.actualType===r.TYPE_PROJECT_SPACE_ITEM_PROXY?n.push(r.TYPE_PROJECT_SPACE):e.options.grid.actualType===r.TYPE_MODEL_PROXY?n.push(r.TYPE_MODEL):e.options.grid.actualType?n.push(e.options.grid.actualType):n.push(r.TYPE_QUALIFICATION_LIST[0]),n=[...n,...t.types_hierarchies[0].hierarchy]}})}),define("DS/ENOXSourcingUXInfra/xsourcingformview/ENOXSourcingFormHelpers",["DS/ENOXSourcingUXInfra/DragAndDrop/ENOXSourcingDataDragAndDrop","DS/ENOXSourcingUXInfra/Mediator"],function(e,t){"use strict";var n={switchToGeneral:function(e,t){e.applicationChannel.publish({event:"qualification-type-switched",data:"general"}),n.hideElements.call(t.getFields(),["manufacturingContext","context","usage","preferred"],".form-group"),n.showElements.call(t.getFields(),["orderable","marketStatus","usageAuthorization","contextRestrictions"],".form-group"),t.options.submitFunction=n.createGeneralQualification},switchToUsage:function(e,t){n.showElements.call(t.getFields(),["context","usage"],".form-group"),n.hideElements.call(t.getFields(),["manufacturingContext","orderable","marketStatus","usageAuthorization","contextRestrictions"],".form-group"),t.options.submitFunction=n.createUsageQualification},switchToEquivalent:function(e,t){e.applicationChannel.publish({event:"qualification-type-switched",data:"equivalent"}),n.showElements.call(t.getFields(),["context","preferred","contextRestrictions"],".form-group"),n.hideElements.call(t.getFields(),["manufacturingContext","usage","orderable","marketStatus","usageAuthorization"],".form-group"),t.options.submitFunction=n.createEquivalentQualification},switchToManufacturingEquivalent:function(e,t){e.applicationChannel.publish({event:"qualification-type-switched",data:"manufacturingEquivalent"}),n.showElements.call(t.getFields(),["manufacturingContext","preferred","contextRestrictions"],".form-group"),n.hideElements.call(t.getFields(),["context","usage","orderable","marketStatus","usageAuthorization"],".form-group")},switchToManufacturingEquivalentMand:function(e,t){e.applicationChannel.publish({event:"qualification-type-switched",data:"manufacturingEquivalent"}),n.showElements.call(t.getFields(),["manufacturingContext","preferred","contextRestrictions"],".form-group"),n.hideElements.call(t.getFields(),["context","usage","orderable","marketStatus","usageAuthorization"],".form-group"),n.hideFormLabel(t,["switchToGeneral","switchToEquivalent"])},showElements:function(e,t){this.forEach(n=>{e.includes(n.name)&&(t&&(n=n.closest(t)),n.show())})},hideElements:function(e,t){this.forEach(n=>{e.includes(n.name)&&(t&&(n=n.closest(t)),n.hide())})},getRegexForDataType:function(e,t){var n="";return"Real"===e?n=t?"^([0-9]+[.]?"+t+"?)+$":"^(\\d+)?([.]?\\d{0,2})?$":"Integer"===e&&(n=t?"^([-+]?[0-9]+["+t+"])*[+-]?[0-9]+$":"^([-+]?[0-9])*$"),n},makeFieldDroppable:function(n){var i=(new t).createNewChannel();let o={dropArea:n.dropArea,multiObjs:!!n.multiSelect,onDropCallback:n.fieldController.onDropCallback.bind(n.fieldController),inviteHandler:"disable",applicationChannel:i,dropStrategy:"CREATE"};(new e).makeAreaDroppable(o)},hideFormLabel:function(e,t){e.buttons.forEach(e=>{t.includes(e.options.name)&&e.elements.container.hide()})}};return n}),define("DS/ENOXSourcingUXInfra/components/MemberInfoProvider/MemberInfoProvider",["DS/ENOXSourcingUXInfra/service/ENOXSourcingPlatformServices","DS/ENOXSourcingUXInfra/Constants/ENOXSourcingConstants","DS/ENOXSourcingUXInfra/CommonUtils/CommonUtils","css!DS/ENOXSourcingUXInfra/components/MemberInfoProvider/MemberInfoProvider.css"],function(e,t,n){"use strict";var i=function(){this.ownerClassName="owner-icon-text"};return i.prototype.getOwnerColumnValues=function(e,t,n,i){let o={icon:{iconPath:this.getProfilePicUrl(n),iconSize:{height:"20px",width:"20px"}},label:t};return i&&delete o.icon,o},i.prototype.getProfilePicUrl=function(e){return e===t.TYPE_PERSON?require.toUrl("ENOXSourcingUXInfra/assets/icons/I_ENOVIA_RscPerson108x144.png"):require.toUrl("ENOXSourcingUXInfra/assets/icons/T_dsaccess_Group.png")},i.prototype.getMemberImage=function(i,o,a){var r=e.getServiceURL("3DSwym")+"/api/user/getpicture/login/"+i+"/format/normal";return a===t.TYPE_PERSON?null!==e.getServiceURL("3DSwym")?UWA.createElement("img",{class:"member-user-image",src:r}):n.getUserImageElement({fullName:o,user:i}):UWA.createElement("img",{class:"member-user-image",src:require.toUrl("ENOXSourcingUXInfra/assets/icons/T_dsaccess_Group.png")})},i}),define("DS/ENOXSourcingUXInfra/xsourcingformview/ENOXSourcingFormValidations",["DS/ENOXSourcingUXInfra/xsourcingformview/ENOXSourcingFormHelpers","DS/UIKIT/Mask"],function(e,t){"use strict";var n=function(){};return n.prototype.charLimitValidate=function(e){var t=!0;return t=this.validateNumberField(e),e.forEach(function(e){if(void 0!==e.options.isLengthy){var n=e.options.isLengthy?256:100;(e.getValue?e.getValue().length>n:e.options.value.length>n)?(e.elements.input?e.elements.input.focus():e.elements.inputField.focus(),e.elements.container.getParent(".form-group")&&e.elements.container.getParent(".form-group").addClassName("has-error"),t=!1):e.elements.container.getParent(".form-group")&&e.elements.container.getParent(".form-group").removeClassName("has-error")}}),t},n.prototype.validateNumberField=function(e){var t=!0,n=["real","Real","Integer","integer","number","Number","customNumberField"];return e.forEach(function(e){if(e.options&&n.includes(e.options.type)){let n=parseFloat(e.elements.inputField.value);if(isNaN(n)||n>e.options.maxValue||n<e.options.minValue){t=!1;let n=e.elements.container.getElementsByClassName("form-control-error-text")[0];n?n.style.display="block":e.elements.container.getParent(".form-group")&&(e.elements.container.getParent(".form-group").getElementsByClassName("form-control-error-text")[0].style.display="inline-block")}else{let t=e.elements.container.getElementsByClassName("form-control-error-text")[0];t?t.style.display="none":e.elements.container.getParent(".form-group")&&(e.elements.container.getParent(".form-group").getElementsByClassName("form-control-error-text")[0].style.display="none")}}}),t},n.prototype.mandatoryFieldValidation=function(e){var t=!0;for(let n=0;n<e.length;n++){let i=e[n];if(i.options&&void 0!==i.options.required){if(i.options.required&&i.options.zeroNotAllowed&&("0"===i.getValue()||0===i.getValue())){i.elements.input?i.elements.input.focus():i.elements.inputField.focus(),i.elements.container.getParent(".form-group")&&i.elements.container.getParent(".form-group").addClassName("has-error"),t=!1;break}i.options.required&&""===i.getValue()?(i.elements.input?i.elements.input.focus():i.elements.inputField.focus(),i.elements.container.getParent(".form-group")&&i.elements.container.getParent(".form-group").addClassName("has-error"),t=!1):i.elements.container.getParent(".form-group")&&i.elements.container.getParent(".form-group").removeClassName("has-error")}}return t},n.prototype.autoCompleteValidation=function(e){var t=!0;return e.forEach(function(e){0===e.selectedItems.length?(e.elements.input.focus(),e.elements.container.getParent(".form-group")&&e.elements.container.getParent(".form-group").addClassName("has-error"),t=!1):e.elements.container.getParent(".form-group")&&e.elements.container.getParent(".form-group").removeClassName("has-error")}),t},n.prototype.wuxAutoCompleteValidation=function(e){var t=!0,n=!1;return e.forEach(function(e){e.selectedItems?e.elements.container.getParent(".form-group")&&e.elements.container.getParent(".form-group").removeClassName("has-error"):e.options.required?(n||(e._editor.elements.inputField.focus(),n=!0),e.elements.container.getParent(".form-group")&&e.elements.container.getParent(".form-group").addClassName("has-error"),t=!1):e._editor.elements.inputField.value=""}),t},n.prototype.wuxAutoCompleteMaskingValidation=function(e){var n=!0;return e.forEach(function(e){e.options.required&&t.isMasked(e.fieldController.getWrapperDiv())&&(n=!1)}),n},n.prototype.regexValidation=function(e,t){var n=!0;return e.forEach(function(e){void 0===e.options.noSpecialCharorHyphen&&void 0===e.options.noSpecialChar||(-1===e.getValue().search(t)?(e.focus(),e.elements.container.getParent(".form-group")&&e.elements.container.getParent(".form-group").addClassName("has-error"),n=!1):e.elements.container.getParent(".form-group")&&e.elements.container.getParent(".form-group").removeClassName("has-error"))}),n},n.prototype.propertiesRegexValidation=function(e,t){let n=!0;return-1===e.getValue().search(t)?(e.focus(),e.elements.container.getParent(".form-group")&&e.elements.container.getParent(".form-group").addClassName("has-error"),n=!1):e.elements.container.getParent(".form-group")&&e.elements.container.getParent(".form-group").removeClassName("has-error"),n},n.prototype.validateTypeOfData=function(t,n){var i=!0;return t.forEach(function(t){if(void 0!==t.options.validDataType){var o=e.getRegexForDataType(n,t.options.allowedSpecialChars);if(o&&t.getValue())new RegExp(o).test(t.getValue())?t.elements.container.getParent(".form-group")&&t.elements.container.getParent(".form-group").removeClassName("has-error"):(t.focus(),t.elements.container.getParent(".form-group")&&t.elements.container.getParent(".form-group").addClassName("has-error"),i=!1);else t.elements.container.getParent(".form-group")&&t.elements.container.getParent(".form-group").removeClassName("has-error")}}),i},n}),define("DS/ENOXSourcingUXInfra/ObjectHistory/utils/ComponentRequestParser",["DS/ENOXSourcingUXInfra/ObjectHistory/utils/Parser","DS/ENOXSourcingUXInfra/CommonUtils/CommonUtils","DS/ENOXSourcingUXInfra/Constants/ENOXSourcingConstants","i18n!DS/ENOXSourcingUXInfra/assets/nls/ENOXSourcingUXInfra"],function(e,t,n,i){"use strict";var o=e,a=o._CONSTANTS;return o.checkForEvents=function(e,n,i,o,r,s){var l={};switch(n.action){case a.ACTIONS.CREATE:case a.ACTIONS.PROMOTE:case a.ACTIONS.DEMOTE:l=this.commonExecutionforMainRows(n.action,s,e,i,o,n,r);break;case a.ACTIONS.MODIFY:case a.ACTIONS.CONNECT:case a.ACTIONS.DISCONNECT:l=this.commonExecutionforMainRows(n.action,s,e,i,o,n,r);break;case"task-updatecomments":l=this.commonExecutionforMainRows("taskupdatecomments",s,e,i,o,n,r);break;case"task-approval":l=this.commonExecutionforMainRows("taskapproval",s,e,i,o,n,r);break;case"task-create":l=this.commonExecutionforMainRows("taskcreate",s,e,i,o,n,r);break;case"cr-completed":l=this.commonExecutionforMainRows("crcompleted",s,e,i,o,n,r);break;default:i.content=t.escapeHtml(n.description),o.push(i),l={i:e,entry:n,line:i,tempSubEntries:o,parsed:r,data:s}}return l},o.commonExecutionforSubRows=function(e,t,n,i,o,a,r){var s=this[e](a,t,n);return n=s[1],i.content=s[0],i.content&&i.content.length&&i.content.length>0&&o.push(i),{i:n,entry:a,line:i,tempSubEntries:o,parsed:r,data:t}},o.commonExecutionforMainRows=function(e,t,n,i,o,a,r){return i.content=this[e](a,t,n),i.content[1]&&(n=i.content[1],i.content.splice(1,1)),i.subEntries=o,o=[],r.unshift(i),{i:n,entry:a,line:i,tempSubEntries:o,parsed:r,data:t}},o.taskcreate=function(e,n,i){for(var o=i,a=[],r=[],s=new Date(n[o].date),l=s.getTime(),c=l,d=n[o].author.user;c>l-6e4&&d===n[i].author.user&&o>-1&&"task-create"===n[o].action;){if(n[o].description){let e=t.escapeHtml(n[o].additionalParameters?n[o].additionalParameters.taskname:""),i=t.escapeHtml(n[o].description);i=i.replace(e,'<b>"'+e+'"</b>'),r.push("<li class= mod-li>"+i+"</li>")}--o>-1&&(c=new Date(n[o].date).getTime(),d=n[o].author.user)}if(r.length>0){var u="",p=r.length>1?"timeline-description-list-style":"";r.forEach(function(e){u+=e});var m='<span class="timeline-modified-operations '+p+'">'+u+"</span>";a.push(m)}return[a,o+1]},o.taskapproval=function(e,n,o){var a=o,r=[],s=new Date(n[a].date),l=s.getTime(),c=l,d=n[a].author.user;let u=n[a].additionalParameters?n[a].additionalParameters.taskname:"";for(var p=[];c>l-1e3&&d===n[o].author.user&&a>-1&&("task-approval"===n[a].action||"task-updatecomments"===n[a].action)&&(n[a].additionalParameters?n[a].additionalParameters.taskname:"")===u;){let e=t.escapeHtml(n[a].additionalParameters?n[a].additionalParameters.taskname:"");if(n[a].description&&"task-approval"===n[a].action){let i=t.escapeHtml(n[a].description);i=i.replace(e,'<b>"'+e+'"</b>'),p.push(i+"<br>")}else if("task-updatecomments"===n[a].action){let e=t.escapeHtml(n[a].additionalParameters?n[a].additionalParameters.comments:""),o=i.history_task_comments?i.history_task_comments:"Comments: {comment}";o=i.replace(o,{comment:e}),p.push(o)}--a>-1&&(c=new Date(n[a].date).getTime(),d=n[a].author.user)}if(p.length>0){var m="";p.forEach(function(e){m+=e});var h="<span>"+m+"</span>";r.push(h)}return[r,a+1]},o.taskupdatecomments=function(e,n,o){var a=o,r=[],s=t.escapeHtml(n[a].additionalParameters?n[a].additionalParameters.taskname:""),l=t.escapeHtml(n[a].additionalParameters?n[a].additionalParameters.comments:"");let c=i.history_task_updated?i.history_task_updated:"Task {taskname} is updated";var d=(c=i.replace(c,{taskname:s})).replace(s,'<b>"'+s+'"</b>');let u=i.history_task_comments?i.history_task_comments:"Comments: {comment}";var p="<span>"+(d=d+"<br>"+(u=i.replace(u,{comment:l})))+"</span>";return r.push(p),[r,o]},o.crcompleted=function(e,o,a){for(var r=a,s=[],l=new Date(o[r].date),c=l.getTime(),d=c,u=o[r].author.user,p="";d>c-5e3&&u===o[a].author.user&&r>-1&&["cr-completed","modify"].includes(o[r].action);){if("modify"===o[r].action){let e=t.escapeHtml(o[r].additionalParameters?o[r].additionalParameters.attributedisplayname:""),a=t.escapeHtml(o[r].additionalParameters?o[r].additionalParameters.attributename:""),s=t.escapeHtml(o[r].additionalParameters?o[r].additionalParameters.attributevalue:"");s=i[s]?i[s]:s,[n.SRC_COMPLETION_PREVIOUS_STATE].includes(a)||(p=p+e+": <i>"+s+"</i><br>")}--r>-1&&(d=new Date(o[r].date).getTime(),u=o[r].author.user)}var m="<span>"+p+"</span>";return s.push(m),[s,r+1]},o}),define("DS/ENOXSourcingUXInfra/Search/ENOXDashboardSearchUtility",["DS/ENOXSourcingUXInfra/service/ENOXSourcingService","DS/UIKIT/Mask","DS/ENOXSourcingUXInfra/service/ENOXSourcingPlatformServices","i18n!DS/ENOXSourcingUXInfra/assets/nls/ENOXSourcingUXInfra","DS/ENOXSourcingUXInfra/Constants/ENOXSourcingConstants","DS/ENOXSourcingUXInfra/Search/SearchUtility"],function(e,t,n,i,o,a){"use strict";return UWA.Class.singleton({init:function(e){this.source="sourcing",this._parent(e)},getConfigurationDataSet:function(t,i){return{name:"TypeAheadChooser",items:[{value:i,selected:!0}],configuration:{remoteSearchEngine:function(i,a){var r;return this.elements&&this.options&&this.options.allowFreeInput&&(this.elements.input.value=a,this.elements.value=a,this.elements.input.setAttribute("identifier",a),this.selectedItems=[{label:a,name:a,selected:!0,value:a}]),new Promise(function(s,l){var c={with_indexing_date:!0,with_synthesis:!0,with_nls:!1,label:"viewer",order_field:"ds6w:label",order_by:"asc",start:"0",with_synthesis_attribute:!0,iDoNotThrowError:!0,select_predicate:["physicalid","name","sourceid","ds6w:label","ds6w:type","ds6w:identifier","ds6w:kind"],select_file:["icon","thumbnail_2d"],query:t,specific_source_parameter:{},source:[o.SOURCE_3DPLAN,o.SOURCE_3DSPACE],tenant:n.getPlatformId()};"**"!==a&&(c.specific_source_parameter["3dspace"]={additional_query:"AND ([ds6w:label]:(*"+a+"*) OR [ds6w:identifier]:(*"+a+"*))"},o.ONPREMISE!==n.getPlatformId()&&(c.specific_source_parameter["3dplan"]={additional_query:"AND ([ds6w:label]:(*"+a+"*) OR [ds6w:identifier]:(*"+a+"*))"})),o.ONPREMISE===n.getPlatformId()&&(c.source=[o.SOURCE_3DSPACE]);var d={searchPayLoad:c};e.getFederatedSearchDataPromise(d).then(function(e){r={};var t=[];e.results&&e.results.forEach(function(e){var n,i,o,a,r,s,l;e.attributes.forEach(function(e){"ds6w:label"===e.name&&(n=e.value),"resourceid"===e.name&&(i=e.value),"ds6w:identifier"===e.name&&e.value,"ds6w:what/ds6w:type"===e.name&&(o=e.value),"sourceid"===e.name&&(a=e.value,s="",e.value.contains(":")&&(a=e.value.split(":")[0],s=e.value.split(":")[1])),"ds6w:what/ds6w:status"===e.name&&(r=e.value),"ds6w:what/ds6w:kind"!==e.name&&"ds6w:kind"!==e.name||(l=e.value)});var c={name:i,label:n,value:n,type:o,source:a,state:r,tenant:s,kindOf:l};t.push(c)}),i.items=t,r.dataset=i,r.matchingItems=t,s(r)},function(e){e.type="error",e.dataset=i,l(e)})})}}}},getProxyObjectEvents:function(e){var n=this;return{onSelect:function(o){var a=this;t.mask(a.elements.container,i.fetching_details);var r={data:[{id:o.name,type:e,dataelements:{"ProxyItem.Proxy_Title":o.label,"ProxyItem.Proxy_Service":o.source,"ProxyItem.Proxy_State":o.state,"ProxyItem.Proxy_Tenant":o.tenant}}]};n.getProxyObjectId({data:r}).then(function(e){e&&e[o.name]&&(a.onHideSuggests(),a.elements.input.setAttribute("identifier",e[o.name]))}).catch(function(){widget.notificationUtil.showError(i.error_actual_id)}).finally(function(){t.unmask(a.elements.container)})},onUnselect:function(){this.resetInput(),this.onHideSuggests()}}},getProxyObjectId:function(t){return t.endpoint="/resources/dssourcing/ProxyObject",t.source=this.source?this.source:"sourcing",t.postData=t.data,e.performPostPromise(t)},getchooserCallback:function(t,i){return new Promise(function(r,s){let l=(new a).getSearchPayload([],[...t],[o.SOURCE_3DPLAN,o.SOURCE_3DSPACE],{with_nls:!1});"**"!==i&&(l.specific_source_parameter["3dspace"]={additional_query:"AND ([ds6w:label]:(*"+i+"*) OR [ds6w:identifier]:(*"+i+"*))"},o.ONPREMISE!==n.getPlatformId()&&(l.specific_source_parameter["3dplan"]={additional_query:"AND ([ds6w:label]:(*"+i+"*) OR [ds6w:identifier]:(*"+i+"*))"}));var c={searchPayLoad:l};e.getFederatedSearchDataPromise(c).then(function(e){var t=[];e.results&&e.results.forEach(function(e){let n,i,o,a,r,s,l,c;e.attributes.forEach(function(e){"ds6w:label"===e.name&&(n=e.value),"resourceid"===e.name&&(o=e.value),"ds6w:identifier"===e.name&&(i=e.value),"ds6w:what/ds6w:type"===e.name&&(a=e.value),"sourceid"===e.name&&(r=e.value,l="",e.value.contains(":")&&(r=e.value.split(":")[0],l=e.value.split(":")[1])),"ds6w:what/ds6w:status"===e.name&&(s=e.value),"ds6w:what/ds6w:kind"!==e.name&&"ds6w:kind"!==e.name||(c=e.value)});var d={name:o,label:n,value:n,type:a,source:r,state:s,tenant:l,kindOf:c};t.push({dataelements:{title:d.label},id:d.name,type:d.type})}),r(t)})})}})}),define("DS/ENOXSourcingUXInfra/TypeAHead/ENOXTypeAHeadUtils",["DS/ENOXSourcingUXInfra/service/ENOXSourcingPlatformServices","DS/ENOXSourcingUXInfra/service/ENOXSourcingService","DS/UIKIT/Autocomplete","i18n!DS/ENOXSourcingUXInfra/assets/nls/ENOXSourcingUXInfra"],function(e,t,n,i){"use strict";return{getTypeHeadOptions:function(e){var n={label:e.label,type:"autocomplete",name:e.name,value:e.value?e.value:"",showSuggestsOnFocus:!1,floatingSuggestions:!1,multiSelect:!!e.multiSelect&&e.multiSelect,itemMultiSelect:!1,placeholder:e.placeholder,allowFreeInput:!1,noResultsMessage:i.noResults,closableItems:!0,required:e.required,errorText:e.errorText,completePreCond:e.completePreCond,disable:e.disable,nonEditable:e.nonEditable,additionalParams:e.additionalParams,datasets:{configuration:{remoteSearchEngine:function(n,i){var o,a=this;return e.text=i,new Promise(function(r,s){var l="";e.actualType&&(l="$type="+e.actualType),void 0!==e.indexSearch&&null!==e.indexSearch&&(l=l+"&$index="+e.indexSearch),l=e.completePreCond&&"Object"===e.searchType?l+"&$where="+i+"* "+a.options.completePreCond:l+"&$where="+i+"*",e.additionalParams&&(l=l+"&$"+a.options.additionalParams);var c={source:"sourcing",endpoint:"/resources/v1/modeler/dssourcing/search?"+l};t.getDataPromise(c).then(function(t){o={};var i=[];t.data&&t.data.forEach(function(t){var n,o,a;"PersonOrGroup"===e.searchType?(n=t.dataelements.lastName+" "+t.dataelements.firstName,o=t.dataelements.lastName+" "+t.dataelements.firstName):!0===e.showAllRevisions?(n=t.dataelements.title?t.dataelements.title:t.dataelements.name+" ("+t.dataelements.revision+")",o=t.dataelements.title?t.dataelements.title:t.dataelements.name):(n=t.dataelements.title?t.dataelements.title:t.dataelements.name,o=t.dataelements.title?t.dataelements.title:t.dataelements.name),"PersonOrGroup"===e.searchType&&(a=t.dataelements.name),"Object"===e.searchType&&(a=t.dataelements.identifier);var r={name:a,label:n,value:o};i.push(r)}),n.items=i,o.dataset=n,o.matchingItems=i,r(o)},function(e){e.type="error",e.dataset=n,s(e)})})}}},events:{onClickOutside:function(){0===this.selectedItems.length&&(this.resetInput(),this.onHideSuggests(),this.cleanDataset())},onSelect:function(t){this.onHideSuggests(),this.elements.input.setAttribute("identifier",t.name),e.onSelectCallback&&e.onSelectCallback(this)},onUnselect:function(){this.onHideSuggests(),e.onUnSelectCallback&&e.onUnSelectCallback(this)}}};return e.multiSelect&&(n.className="src-multi-select-autocomplete"),n},getTypeAHeadField:function(e){return new n(this.getTypeHeadOptions(e))}}}),define("DS/ENOXSourcingUXInfra/LifeCycleView/LifeCycleViewBis",["DS/Windows/ImmersiveFrame","DS/Windows/Dialog","DS/Controls/Button","DS/UIKIT/Mask","i18n!DS/ENOXSourcingUXInfra/assets/nls/ENOXSourcingUXInfra","DS/ENOXSourcingUXInfra/service/ENOXSourcingPlatformServices","DS/ENOXSourcingUXInfra/service/ENOXSourcingService","DS/LifecycleCmd/MaturityCmd","DS/ENOXSourcingUXInfra/Constants/ENOXSourcingConstants","DS/ENOXSourcingUXInfra/Search/SearchUtility","css!DS/ChangeMaturityWidget/ChangeMaturityWidget","css!DS/ENOXSourcingUXInfra/LifeCycleView/LifeCycleViewBis.css"],function(e,t,n,i,o,a,r,s,l,c){"use strict";let d=!0;var u=[{},{}];return UWA.Class.View.extend({name:"lifecycle-view",tagName:"div",template:function(){return'<div class="'+this.getClassNames("-subcontainer")+'"></div>'},domEvents:{},init:function(e){this.model=e.model,["container","template","tagName","domEvents"].forEach(function(t){delete e[t]}),this.model.get("subscribeLifeCycleModification")&&(this.searchUtil=new c,this.destroyCleanUpSubscribe=this.model.get("applicationChannel").subscribe({event:"cleanup-lifecycleModification-subscribe"},this.cleanUpSubscribe.bind(this)),this.setupSubscribers()),this._parent(this,e)},setup:function(){this.listenTo(this.model,"onChange",this.buildMaturityBadge),this.container.addClassName(this.getClassNames("-container"))},render:function(){if(d){d=!1;var e=this;if(this.container.empty(),"OnPremise"===a.getPlatformId()){var t={};t.context={getSecurityContext:function(){return{SecurityContext:r.getSecurityContext()}}},new s(t).executeAsync([{physicalid:e.model.get("id")}]).then(function(){e.model.get("callBackForExecuteCmd")&&(d=!0,e.model.get("callBackForExecuteCmd")())})}else{var n={securitycontext:r.getSecurityContext(l.SOURCE_SOURCING),context:{}};new s(n).executeAsync([{physicalid:e.model.get("id"),serviceurl:a.getServiceURL(l.SOURCE_SOURCING)+"/resources/lifecycle/maturity/"}]).then(function(){e.model.get("callBackForExecuteCmd")&&(d=!0,e.model.get("callBackForExecuteCmd")())})}return this.container}},onDestroy:function(){return this._parent.apply(this,arguments)},buildMaturityBadge:function(){var e,t,n;let i=this.model.get("source")?this.model.get("source"):l.SOURCE_SOURCING;var o=this.model.get("maturityContainer");let c=o?o._idCardModel.get("attributes").filter(e=>"maturityState"===e.id)[0]:void 0;if(c){c.displayWhenMinified?(t=o._container.querySelectorAll("#maturityState")[0],n=o._container.querySelectorAll("#maturityState")[1]):n=o._container.querySelectorAll("#maturityState")[0];let i=o._container.querySelector(".xapp-id-card-container");e=i&&i.hasClassName("minified")?t:n}if(e){let t=e.previousElementSibling.offsetWidth-55;if(t>0){let n=(e.parentElement.parentElement.offsetWidth?e.parentElement.parentElement.offsetWidth:275)+t+"px";e.parentElement.parentElement.style.width=n}e.innerHTML="";var d=new s;let n={SecurityContext:r.getSecurityContext(i),serviceurl:a.getServiceURL(i)+"/resources/lifecycle/maturity/"};d.executeCompactViewAsync(widget,e,n,this.model.get("id"))}},setupSubscribers:function(){var e=this;e.model.get("forInfoPanel")?(u[1].id&&(e.searchUtil.getPlatfromAPIObj().unsubscribe(u[1].token),u[1]={}),u[0].id&&u[0].id===e.model.get("id")||(u[1].id=e.model.get("id"),u[1].token=e.searchUtil.getPlatfromAPIObj().subscribe("Lifecycle.Modification",function(t){JSON.parse(t).Refresh.modified.length>0&&e.model.get("id")===JSON.parse(t).Refresh.modified[0].physicalid&&e.model.get("callBackForExecuteCmd")&&e.model.get("callBackForExecuteCmd")()}))):(u[0].id&&(e.searchUtil.getPlatfromAPIObj().unsubscribe(u[0].token),u[0]={}),u[1].id&&u[1].id===e.model.get("id")&&(e.searchUtil.getPlatfromAPIObj().unsubscribe(u[1].token),u[1]={}),u[0].id=e.model.get("id"),u[0].token=e.searchUtil.getPlatfromAPIObj().subscribe("Lifecycle.Modification",function(t){JSON.parse(t).Refresh.modified.length>0&&e.model.get("id")===JSON.parse(t).Refresh.modified[0].physicalid&&e.model.get("callBackForExecuteCmd")&&e.model.get("callBackForExecuteCmd")()}))},cleanUpSubscribe:function(){u[0].id&&(this.searchUtil.getPlatfromAPIObj().unsubscribe(u[0].token),u[0]={}),u[1].id&&(this.searchUtil.getPlatfromAPIObj().unsubscribe(u[1].token),u[1]={}),this.model.get("applicationChannel").unsubscribe(this.destroyCleanUpSubscribe)}})}),define("DS/ENOXSourcingUXInfra/DetailsView/DetailsView",["DS/Controls/Tab","DS/Menu/Menu","DS/ENOXIDCardContainer/js/ENOXIDCardContainer","DS/ENOXSourcingUXInfra/UpdateWidgetTitle/UpdateWidgetTitle","DS/Utilities/Utils","DS/ENOXSourcingUXInfra/DetailsView/IDCardUtilities","DS/ENOXSourcingUXInfra/LifeCycleView/LifeCycleViewBis","css!DS/ENOXSourcingUXInfra/LifeCycleView/LifeCycleViewBis.css"],function(e,t,n,i,o,a,r){"use strict";var s=function(){this.updateWidgetObject=new i};return s.prototype.init=function(t){var i=this;if(!t.forInfo){i.updateWidgetObject.init(t);let e=t.data.respParams.title?t.data.respParams.title:t.data.respParams.Title?t.data.respParams.Title:t.data.respParams.name;i.updateWidgetObject.updateTitle(e)}i.options=t;var s="";i.options.detailsContainer?(void 0!==i.options.emptyDetailsView&&!0!==i.options.emptyDetailsView||!i.options.detailsContainer.empty||i.options.detailsContainer.empty(),s=i.options.detailsContainer):(widget.app._triptychWrapper.getMainPanelContainer().empty&&(void 0!==i.options.emptyDetailsView&&!0!==i.options.emptyDetailsView||widget.app._triptychWrapper.getMainPanelContainer().empty()),s=widget.app._triptychWrapper.getMainPanelContainer());var l=!0,c=!0,d=widget.getValue("lastVisitedRouteName"),u=widget.getRefreshViewParams?JSON.parse(widget.getRefreshViewParams(d)).previousRoutes:[],p=!1;u.length>0&&u[u.length-1].name&&u[u.length-1].name!==widget.getValue("defaultRoute")&&(p=!0),t.forInfo?l=c=p=!1:i.options.app&&i.options.idCardConfigs&&(l=i.options.idCardConfigs.withHomeButton,c=i.options.idCardConfigs.withInformationButton,p=i.options.idCardConfigs.showBackButton);var m=widget.app._mediator.createNewChannel(),h=i.options.detailsViewOptions.idCardDetails;i.myIDCardModel=new UWA.Class.Model({name:h.name,version:h.version,configuration:h.name?h.name.configuration:"",thumbnail:h.thumbnail,withHomeButton:l,withExpandCollapseButton:!1,withActionsButton:!1!==h.withActionsButton||h.withActionsButton,withInformationButton:c,showBackButton:p,modelEvents:m,dropdown:h.dropdown,withToggleMinifiedButton:!0,freezones:h.additionalInfomation,attributes:h.attributes,customEvents:{homeIconClick:{event:"custom-show-landing-page-event"},expandCollapseIconClick:{event:"custom-welcome-panel-toggle-event"},informationIconClick:{event:"custom-information-icon-event"},configurationLabelClick:{event:"custom-show-configuration-event"},versionLabelClick:{event:"custom-show-version-explorer-event"},actionsMenuClick:{event:"custom-open-actions-menu-event"},backButtonClick:{event:"idcard-back"}}});i.mIDCardContainer=new n,i.mIDCardContainer.init({withtransition:!0},i.myIDCardModel),i.mIDCardContainer.inject(s),i.mIDCardContainer._idCardModel.get("attributes").filter(e=>"maturityState"===e.id)[0]&&(t.lifeCycleModel.set("maturityContainer",i.mIDCardContainer),t.lifeCycleModel.set("subscribeLifeCycleModification",!0),t.lifeCycleModel.set("applicationChannel",t.applicationChannel?t.applicationChannel:t.app?t.app._applicationChannel:{}),t.lifeCycleModel.set("forInfoPanel",t.forInfo),i.lifeCycleView=new r({model:t.lifeCycleModel}),i.lifeCycleView.buildMaturityBadge()),widget.app&&widget.app._initDroppable&&widget.app._initDroppable(i.mIDCardContainer._idCardContainer);var f=widget.getElement(".xapp-id-card-container .image-placeholder");f&&f.children.length>0&&"false"===f.children[0].attributes.src.value&&(f.style.display="none"),m.subscribe({event:"idcard-load-complete"},function(){}),i._idCardAttributeEditorHandler=function(){},m.subscribe({event:"idcard-attributes-clicked"},o.debounce(e=>{var t=h.attributes[e.index];t&&e.attributeName===t.name&&t.view?t.view.render():t&&e.attributeName===t.name&&t.openTab&&t.openTab()},300)),m.subscribe({event:"idcard-minify"},()=>{i.mIDCardContainer._idCardModel.get("attributes").filter(e=>"maturityState"===e.id)[0]&&i.lifeCycleView.buildMaturityBadge()}),m.subscribe({event:"custom-information-icon-event"},function(){}),m.subscribe({event:"idcard-back"},a.prototype.idcardBackButtonHandler.bind(i,t)),m.subscribe({event:"custom-show-landing-page-event"},a.prototype.idcardHomeButtonHandler.bind(i,t)),m.subscribe({event:"custom-information-icon-event"},a.prototype.idcardInfoButtonHandler.bind(i,t)),i.options.detailsViewOptions&&i.options.detailsViewOptions.showTabView&&i.options.detailsViewOptions.tabConfiguration&&(i.tabWindow=new e({multiSelFlag:!1,touchMode:!0,displayStyle:["strip"],autoCloseFlag:!0,newTabButtonFlag:!1}),i.tabWindow.getContent().style.height="100%",i.tabWindow.tabPanelContainer.style.height="calc(100% - 44px)",i.tabWindow.tabBar.centeredFlag=!1,i.tabWindow.inject(i.mIDCardContainer.getMainContent()),i.options.detailsViewOptions.tabConfiguration.forEach(function(e){i.tabWindow.add(e)}),i.tabWindow.addEventListener("tabButtonClick",function(){var e=this;i.options.detailsViewOptions.tabConfiguration.forEach(function(t){t.value===e.dsModel.value[0]&&t.reload&&t.view&&("function"==typeof t.view?t.view(!0):t.view.render(!0)),t.value===e.dsModel.value[0]&&t.events&&t.events.click&&t.events.click()})})),!i.options.detailsViewOptions.showTabView&&i.options.detailsViewOptions.contentView&&i.options.detailsViewOptions.contentView.inject(i.mIDCardContainer.getMainContent()),i.options.callback&&i.options.callback(),i.options.ODTCallBack&&i.options.ODTCallBack()},s}),define("DS/ENOXSourcingUXInfra/ObjectHistory/services/Services",["UWA/Class/Promise","UWA/Core","DS/WAFData/WAFData","DS/WidgetServices/WidgetServices","DS/ENOXSourcingUXInfra/service/ENOXSourcingService"],function(e,t,n,i,o){"use strict";var a="application/json",r="application/json";return{getHistory:function(s){var l={},c=o.getServiceURL({source:"sourcing",endpoint:"/resources/dssourcing/objecthistory/"+s.physicalId});return s.method="GET",l.headers={Accept:a,"Content-Type":r,SecurityContext:o.getSecurityContext("sourcing"),"Accept-Language":i.getLanguage()},new e(function(e,i){l.onComplete=function(n){t.is(n,"string")&&(n=JSON.parse(n)),e(n)},l.onFailure=function(e){t.is(e,"string")&&(e=JSON.parse(e)),i(e)},n.authenticatedRequest(c,l)})}}}),define("DS/ENOXSourcingUXInfra/SupplyNetworkSearchView/SupplyNetworkSearchModel",["DS/ENOXSourcingUXInfra/service/ENOXSourcingService","DS/ENOXSourcingUXInfra/service/ENONetworkServices"],function(e,t){"use strict";var n=function(){this.source="3dnetwork"};return n.prototype.getSupplierSearchCriteriaValues=function(e){return e.endpoint="/3drdfindex/dsvnc/resources/company/getGeneralInformation",e.source="3dnetwork",t.postDataPromise(e)},n.prototype.searchSuppliersByCriteria=function(e){return e.endpoint="/3drdfindex/dsvnc/resources/company/searchSupplierCompanies",e.source="3dnetwork",t.postDataPromise(e)},n}),define("DS/ENOXSourcingUXInfra/ObjectHistory/utils/QualificationParser",["DS/ENOXSourcingUXInfra/ObjectHistory/utils/Parser","DS/ENOXSourcingUXInfra/CommonUtils/CommonUtils","i18n!DS/ENOXSourcingUXInfra/assets/nls/ENOXSourcingUXInfra"],function(e,t,n){"use strict";var i=e;return i.promote=function(e){var t="";n.history_promoted&&(t=this.objectTitle+" "+n.replace(n.history_promoted,{state:e.state.bold()}));var i=e.description?e.description:t;let o=UWA.createElement("div",{});return o.innerHTML=i,o},i.demote=function(e){var t=this.objectTitle+" "+n.replace(n.history_demoted,{state:e.state.bold()}),i=e.description?e.description:t;let o=UWA.createElement("div",{});return o.innerHTML=i,o},i}),define("DS/ENOXSourcingUXInfra/controllers/WizardStepsController",["DS/UIKIT/Mask","DS/ENOXSourcingUXInfra/components/TabbedWizard/TabbedWizard"],function(e,t){"use strict";function n(n){if(!n||!n.app||!n.parentController)throw new Error("app and parentController are mandatory");var i=this;return this.isFirstRendering=!0,this.wizardComponent=void 0,this.container=void 0,this.lastNonModalState=!0,this.app=n.app,this.parentController=n.parentController,this.eventTokens=[],this.modeler=void 0,this.wizardViews={},{activate:function(n){if((n.params.type||i.requestType)&&(i.requestType=n.params.type||i.requestType),i.wizardComponent){var o=i.wizardComponent.steps,a=i.wizardComponent.currentStep=o.filter(e=>e.route===n.name)[0];const t=n.params.data;if(t&&t.alreadyVisitedTab)i.wizardComponent.renderTab({alreadyVisitedTab:!0});else{var r=i.app.dataProvider[a.dataProvider][a.dataMethod];if("function"!=typeof r)throw new Error("Step data must provide a valid data source");a.input=n.params.data?{data:n.params.data,steps:o}:{},n.params.requestTemplateData&&(a.input.requestTemplateData=n.params.requestTemplateData),i.requestType&&(a.input.requestType=i.requestType),e.mask(i.mainContainer),r(a.input).then(function(e){a.data=e;let t={app:i.app,model:e[a.viewModel],data:e,controller:i};var n=new i.wizardViews[a.view](t);i.wizardComponent.renderTab({index:o.indexOf(a),label:o[0].title,content:n.render()})}).catch(function(e){i.app.logger.error(e)}).finally(function(){e.unmask(i.mainContainer)})}}else{i.lastNonModalState=!0,i.modeler=i.app.configurator._wizardConfigurator._wizardDataprovider;var s=i.app.dataProvider[i.modeler].getSteps({requestType:i.requestType});if(n.name!==s[0].route)throw new Error("Something went wrong, this is not the first step of the wizard");i.isFirstRendering=!1,i.container=i.parentController.getContainerElement(),i.wizardComponent=new t({app:i.app,steps:s,controller:i}),i.container.setHeader(i.app.dataProvider[i.modeler].getHeader()),i.mainContainer=i.container.getBody(),i.wizardComponent.inject(i.mainContainer),i.subscribeToEvents()}},deactivate:function(e,t){var n=t.name.split(".");e.name.contains(n[0]+"."+n[1])||i.wizardComponent&&(i.isFirstRendering=!0,i.container=void 0,i.unsubscribeFromEvents(),i.wizardComponent.destroy(),i.wizardComponent=void 0)},initViews:function(e,t){i.requireViews(e,t)}}}return n.prototype.requireViews=function(e,t){var n=this;require([e],function(e){n.wizardViews[t]=e})},n.prototype.subscribeToEvents=function(){var e=this;this.eventTokens.push(this.app._applicationChannel.subscribe({event:"tabbed-wizard-item-selected"},function(){})),this.eventTokens.push(this.app._applicationChannel.subscribe({event:"close-modal-window"},function(t){var n=t.escapeClose&&!0===e.wizardComponent.currentStep.showCloseAlert;const i=e.wizardComponent.currentStep,o=i.data.model?i.data.model.gridData:"";"Attachments"===i.title&&o instanceof Set&&o.clear();var a={};if(n){var r=e.app.dataProvider[e.modeler].getCloseTexts();a={renderTo:e.app.widget.body,body:"<p>"+r.alertMsg+"</p>",title:r.dialogTitle,actionBtnLabel:r.actionBtnLbl,action:function(){e.app._applicationChannel.publish({event:"save-form-data",data:{}})}}}var s={showPreventCloseDialog:n,preventCloseDialogOptions:a};e.parentController.closeModalDialog(s)})),this.eventTokens.push(this.app._applicationChannel.subscribe({event:"modal-window-closed"},function(t){e.lastNonModalState&&t&&t.toState&&t.toState.params&&e.app.router.navigate(t.toState.name,t.toState.params)})),this.eventTokens.push(this.app._applicationChannel.subscribe({event:"tab-changed"},function(){})),this.eventTokens.push(this.app._applicationChannel.subscribe({event:"submit-action"},function(t){e.app.dataProvider[e.modeler].submitAction(t,e)})),"function"==typeof this.app.dataProvider[e.modeler].getEventToken&&this.app.dataProvider[e.modeler].getEventToken().forEach(t=>{e.eventTokens.push(e.app._applicationChannel.subscribe({event:t.eventName},t.callbackFn))})},n.prototype.unsubscribeFromEvents=function(){var e=this;this.eventTokens.forEach(t=>e.app._applicationChannel.unsubscribe(t))},n}),define("DS/ENOXSourcingUXInfra/controllers/ModalWindowController",["DS/ENOXSourcingUXInfra/controllers/WizardStepsController","DS/ENOXSourcingUXInfra/components/ModalWindowWrapper/ModalWindowWrapper"],function(e,t){"use strict";var n=void 0;function i(e){e.preventDefault(),"Escape"===e.key&&n._applicationChannel.publish({event:"close-modal-window",data:{escapeClose:!0}})}function o(o){if(!o||!o.app||!o.parentController)throw new Error("app and parentController are mandatory");var a=this;return this.modalComponent=null,this.isFirstRendering=!0,this.app=o.app,n=this.app,this.parentController=o.parentController,this.lastNonModalState=[],function(t,n){var i=new e({app:t,parentController:n}),o=t.configurator._wizardConfigurator._wizardViews;for(var a in o)a&&i.initViews(o[a].path,o[a].name);t.mainController.addRouteManager("modal.wizard",i),t.configurator._wizardConfigurator._wizardStepsList.forEach(e=>{t.mainController.addRouteManager("modal.wizard."+e,i)})}(this.app,this),{activate:function(e,o){a.lastNonModalState.push(o),a.isFirstRendering?(a.isFirstRendering=!1,a.modalWrapper=new t({app:a.app,controller:a,draggable:!0,resizable:!0,escapeToClose:!1}),a.modalComponent=a.modalWrapper.getModal(),a.modalComponent.show()):a.modalComponent.show(),a.modalComponent.addEvent("onShow",()=>{document.addEventListener("keyup",i);let e=a.modalComponent.elements.close,t=e.cloneNode(!0);e.parentNode&&e.parentNode.replaceChild(t,e),t.addEventListener("click",()=>{a.app._applicationChannel.publish({event:"close-modal-window",data:{escapeClose:!0}})}),t.addEventListener("touchstart",()=>{n._applicationChannel.publish({event:"close-modal-window",data:{escapeClose:!0}})})}),a.modalComponent.addEvent("onHide",()=>{})},deactivate:function(){"home"===arguments[0].name&&a.app.reactivateWP(),a.isFirstRendering=!0,document.removeEventListener("keyup",i),a.modalComponent.destroy(!0)}}}return o.prototype.getContainerElement=function(){return this.modalComponent},o.prototype.closeModalDialog=function(e){e.showPreventCloseDialog?(this.modalWrapper.showPreventCloseDialog(e.preventCloseDialogOptions),document.querySelector(".modal-content").getBoundingClientRect().width>0&&(document.querySelector(".wizard-dialog > .modal-wrap > .modal-content").style.width=document.querySelector(".modal-content").getBoundingClientRect().width+"px")):(this.modalComponent.hide(),this.app&&this.app.router&&this.app.router.navigate("home.dummyRoute"))},o}),define("DS/ENOXSourcingUXInfra/ObjectHistory/collections/Entries",["UWA/Class/Collection","DS/ENOXSourcingUXInfra/ObjectHistory/models/Entry","DS/ENOXSourcingUXInfra/ObjectHistory/services/Services","DS/ENOXSourcingUXInfra/ObjectHistory/utils/Parser","DS/ENOXSourcingUXInfra/ObjectHistory/utils/ComponentRequestParser","DS/ENOXSourcingUXInfra/Search/SearchUtility","DS/ENOXSourcingUXInfra/Constants/ENOXSourcingConstants","DS/ENOXSourcingUXInfra/ObjectHistory/utils/QualificationParser"],function(e,t,n,i,o,a,r,s){"use strict";return e.extend({name:"DS/ENOXSourcingUXInfra/ObjectHistory/collections/Entries",model:t,setup:function(e,t){return this.physicalId=t.physicalId,this.objectTitle=t.objectTitle,Array.isArray(e)&&e.length>0&&this.add(e),this},fetch:function(e){var t=this;return n.getHistory({physicalId:t.physicalId}).then(function(n){e.physicalId=t.physicalId,e.objectTitle=t.objectTitle,n.contextobjectinfo&&n.contextobjectinfo.title&&(e.objectTitle=n.contextobjectinfo.title),t.parse(n,e).then(function(e){t.reset(e)}),e&&"function"==typeof e.onComplete&&e.onComplete(history)},function(n){t.reset([]),e&&"function"==typeof e.onFailure&&e.onFailure(n)})},parse:function(e,t){var n=this,a=e.body,l=t.parser?t.parser:i;return new Promise(function(i,c){var d=n.getAllProxyIDs(a);n.fedSearchCallForProxyObjects(d).then(function(n){n.forEach(function(e){let t=d.proxyIndexesMapping[e.resourceid];t&&t.forEach(function(t){t&&t.description&&t.additionalParameters&&t.additionalParameters.title&&(t.description=t.description.replace(t.additionalParameters.title,e["ds6w:label"]),t.additionalParameters.title=e["ds6w:label"])})}),e.contextobjectinfo&&e.contextobjectinfo.type===r.TYPE_COMPONENT_REQUEST?l=o:e.contextobjectinfo&&e.contextobjectinfo.type&&r.TYPE_QUALIFICATION_LIST.includes(e.contextobjectinfo.type)&&(l=s),l.parse(a,t).then(function(e){i(e)},function(e){c(e)})})})},fedSearchCallForProxyObjects:function(e){return new Promise(function(t){var n="";e.proxyRDFIDs.forEach(function(e){n+='[ds6w:resourceUid]:"'+e+'" OR '}),e.proxyERIDs.forEach(function(e){n+='physicalid:"'+e+'" OR '}),""===n&&t([]),n=n.substring(0,n.length-3);var i=e.proxyRDFIDs.length+e.proxyERIDs.length,o={completePreCond:n,nresults:i,start:"0",with_nls:!1},s=new a;s.callFederatedSearch(s.getSearchPayload([],[],[r.SOURCE_USERGROUPS,r.SOURCE_3DSPACE],o)).then(function(e){let n=s.processResults(e);t(n)})})},getAllProxyIDs:function(e){var t=[],n=[],i={};return e.forEach(function(e){if(e.additionalParameters["ProxyItem.Proxy_Id"]){t.push(e.additionalParameters["ProxyItem.Proxy_Id"]);let n=i[e.additionalParameters["ProxyItem.Proxy_Id"]];n||(n=[]),n.push(e),i[e.additionalParameters["ProxyItem.Proxy_Id"]]=n}if(e.additionalParameters["ProxyItem.Proxy_uri"]){n.push(e.additionalParameters["ProxyItem.Proxy_uri"]),t.push(e.additionalParameters["ProxyItem.Proxy_uri"]);let o=i[e.additionalParameters["ProxyItem.Proxy_uri"]];o||(o=[]),o.push(e),i[e.additionalParameters["ProxyItem.Proxy_uri"]]=o}}),{proxyERIDs:t,proxyRDFIDs:n,proxyIndexesMapping:i}}})}),define("DS/ENOXSourcingUXInfra/PropertiesView/PropertiesAccordeonView/PropertiesAccordeonView",["UWA/Class/View","DS/Controls/Accordeon","DS/ENOXSourcingUXInfra/PropertiesView/PropertiesAccordeonView/AccordeonContent","css!DS/ENOXSourcingUXInfra/PropertiesView/PropertiesAccordeonView/PropertiesAccordeonView.css"],function(e,t,n){"use strict";return e.extend({name:"sourcing-properties-accordeon-view",tagName:"div",className:"sourcing-properties-accordeon",setup:function(){},init:function(e){var n=UWA.clone(e,!1);["id","className","tagName","attributes","domEvents"].forEach(function(e){delete n[e]}),this._parent(n),this.headerValueAndAccordeonContentMapping={},this.wuxAccordeon=new t({items:[],style:"simple",exclusive:!0})},render:function(){return this.wuxAccordeon.inject(this.container),this.container},addField:function(e,t){let i=e.accordeonHeader.value,o=e.accordeonHeader.label,a=this.headerValueAndAccordeonContentMapping[i];if(!a){a=new n({headerValue:i});let e=this.wuxAccordeon.addItem({header:o,content:a.container});this.expandAccordeonItem(this.wuxAccordeon,e),this.headerValueAndAccordeonContentMapping[i]=a}a.addField(t)},_reset:function(){this.container.empty(),this.headerValueAndAccordeonContentMapping={},this.wuxAccordeon=new t({items:[],style:"simple",exclusive:!1})},expandAccordeonItem:function(e,t){let n=e.getIndexFromId(t);e.expandItem(n)}})}),define("DS/ENOXSourcingUXInfra/xsourcingCollectionView/xsourcingCollectionViewUI",["DS/DataGridView/DataGridView","DS/CollectionView/ResponsiveTilesCollectionView","DS/CollectionView/ResponsiveLargeTilesCollectionView","DS/CollectionView/ResponsiveThumbnailsCollectionView","DS/ENOXCollectionToolBar/js/ENOXCollectionToolBarV2","DS/ENOXSourcingUXInfra/Mediator","css!DS/ENOXSourcingUXInfra/xsourcingCollectionView/xsourcingCollectionView.css","i18n!DS/ENOXSourcingUXInfra/assets/nls/ENOXSourcingUXInfra","DS/Controls/Expander","DS/Windows/ImmersiveFrame","UWA/Core","DS/ENOXSourcingUXInfra/Constants/ENOXSourcingConstants","DS/ENOXSourcingUXInfra/service/ENOXSourcingPlatformServices","DS/Utilities/Utils","DS/UIKIT/Iconbar","DS/ENOXSourcingUXInfra/Search/SearchUtility"],function(e,t,n,i,o,a,r,s,l,c,d,u,p,m,h,f){"use strict";function g(e){var t="";if(this.layout.getLeafColumns()[e.columnID]){let n=this.layout.getLeafColumns()[e.columnID].dataIndex;t=(t=e.nodeModel.getAttributeValue(n))?t.label?t.label:t:""}return t}function v(e){let t=this.getModelAt(e.cellID);return t?t.label?t.label:t:""}function S(e){let t=e.getProperty(),n=this.layout.getColumnOptionValue(t,"text"),i=(n?n+": ":"")+e.getIdentifier()+" ("+e.getOriginalChildrenInformation().notHiddenNotFilteredChildrenCount+")",o={grouped:!0},a=this.layout.getLeafColumns().filter(e=>"tree"===e.dataIndex&&e.property)[0]||this.layout.getLeafColumns()[0];return a&&(o[a.property||a.dataIndex]=i),o}function w(e,t){return-1!==e.indexOf(t)}function E(e){let{cellInfos:t}=e,{nodeModel:n}=t,{options:i}=n,o=i.statusbarActions,a=this;o&&o instanceof Array&&"function"==typeof o[e.clickedIconIndex]&&o[e.clickedIconIndex](e,a)}var C=function(){this.currentView="Tile View"};return C.prototype.init=function(r){var l=this;this.options=r,this.searchUtility=new f,this._allData=r.data,this._model=r.model,this._gridModel=r.gridModel,r.container||(r.container=widget.app._triptychWrapper.getMainPanelContainer()),r.container.empty&&r.container.empty();let u=widget.app.immersiveFrame||new c({reactToPointerEventsFlag:!1}).inject(r.container),p=d.createElement("div",{class:"xsourcingcollectionview-wrapper-container"}).inject(r.container),h=d.createElement("div",{class:"xsourcingcollectionview-toolbarwrapper-container"}).inject(p),C=d.createElement("div",{class:"xsourcingcollectionview-toolbar-mobileicon-container"}).inject(h),y=d.createElement("div",{class:"xsourcingcollectionview-iconbar-toolbar-container"}).inject(h),b=d.createElement("div",{class:"xsourcingcollectionview-content-container"}).inject(p);if(this._columnsConfiguration=r.columnsConfigurations,this.viewContainer=b,this.collectionViewEvents=r.collectionViewEvents,this._toolbarChannel=(new a).createNewChannel(),this._selectedItems=[],this.toolbarOptions={},this.toolbarOptions.actions=r.toolbarActions,l.toolbarOptions.lockItemCount=!!r.lockItemCount&&r.lockItemCount,this.toolbarOptions.modelEvents=l._toolbarChannel,this.toolbarOptions.showItemCount=void 0===r.showItemCount||r.showItemCount,this.uniqueIdentifier=r.uniqueIdentifier,this.disableNoDataMessage=r.disableNoDataMessage,r.hideTitle||(this.toolbarOptions.itemName=r.itemsName,this.toolbarOptions.itemsName=r.itemsName),r.withmultisel&&(this.toolbarOptions.withmultisel=!0),r.sort&&(this.toolbarOptions.sort=r.sort),this.toolbarOptions.views=[{id:"Tile View",text:s.TILE_VIEW,fonticon:"view-small-tile"},{id:"Thumbnail View",text:s.THUMBNAIL_VIEW,fonticon:"view-small-thb"},{id:"Grid View",text:s.GRID_VIEW,fonticon:"view-list"}],r.customView&&this.toolbarOptions.views.push(r.customView),r.views&&(r.views.includes("Grid")||this.toolbarOptions.views.splice(2,1),r.views.includes("Thumbnail")||this.toolbarOptions.views.splice(1,1),r.views.includes("Tile")||this.toolbarOptions.views.splice(0,1),r.views.includes("Large Tile")&&this.toolbarOptions.views.push({id:"Large Tile View",text:s.LARGE_TILE_VIEW,fonticon:"view-big-tile"})),this.toolbarOptions.currentView=r.currentView?r.currentView:this.toolbarOptions.views[0].id?this.toolbarOptions.views[0].id:"Tile View",r.uniqueIdentifier){var _=widget.getValue(r.uniqueIdentifier);_&&null!==_&&""!==_&&(this.toolbarOptions.currentView=_)}this.toolbarOptions.filter={enableCache:!0},r.disableSearchFilter&&delete this.toolbarOptions.filter,1===this.toolbarOptions.views.length&&(this.toolbarOptions.views.length=0),r.showToolbar&&(this.collectionToolbar=new o(this.toolbarOptions),this.collectionToolbar.inject(y),r.toolbarSearchActionOverride&&"function"==typeof r.toolbarSearchActionOverride&&(this.collectionToolbar._clickSearch=r.toolbarSearchActionOverride.bind(this.collectionToolbar,this.collectionToolbar._clickSearch)),r.showMobileWelcomePanelIcon&&l.addMobileIconContainer(r,C),!0===r.showToolbarInfoIcon&&(r.toolbarInfoIcon=[{id:"sourcinginfoicon",text:s.information,fonticon:"info",disabled:!0,handler:function(){var e=document.querySelector("#sourcinginfoicon").getChildren()[0];e.className.contains("enox-collection-toolbar-filter-activated")?(e.removeClassName("enox-collection-toolbar-filter-activated"),r.app._applicationChannel.publish({event:"information-panel-close",data:""})):(e.addClassName("enox-collection-toolbar-filter-activated"),r.app._applicationChannel.publish({event:"information-panel-open",data:"right"}))}}],this.collectionToolbar._actionsIconBar.addItem(r.toolbarInfoIcon[0])));let I={useDragAndDrop:!!r.enableDrag&&r.enableDrag,pageScrollValueTriggeringInfiniteScroll:.5,...void 0!==r.displayedOptionalCellProperties?{displayedOptionalCellProperties:r.displayedOptionalCellProperties}:{},...void 0!==r.shouldAllowUnsafeHTMLAt&&r.shouldAllowUnsafeHTMLAt instanceof Array?{shouldCellAllowUnsafeHTMLContentAt:function(e,t){return w(r.shouldAllowUnsafeHTMLAt,t)}}:{},onDragEnterBlankDefault:function(e){},onDragEnterBlank:function(e){},onDragStartCell:function(e,t){var n=this.getTreeDocument().getSelectedNodes(),i=l.formatDataForDnD(n);return e.dataTransfer.setData("text/plain",JSON.stringify(i)),!1}},D={...I},T={useDragAndDrop:!!r.enableDrag&&r.enableDrag,...void 0!==r.displayedOptionalCellProperties?{displayedOptionalCellProperties:r.displayedOptionalCellProperties}:{displayedOptionalCellProperties:["contextualMenu","statusbarIcons"]},pageScrollValueTriggeringInfiniteScroll:.5,...void 0!==r.descriptionLinesNumber?{descriptionLinesNumber:r.descriptionLinesNumber}:{},...void 0!==r.shouldAllowUnsafeHTMLAt&&r.shouldAllowUnsafeHTMLAt instanceof Array?{shouldCellAllowUnsafeHTMLContentAt:function(e,t){return w(r.shouldAllowUnsafeHTMLAt,t)}}:{},onDragEnterBlankDefault:function(e){},onDragEnterBlank:function(e){},onDragStartCell:function(e,t){var n=this.getTreeDocument().getSelectedNodes(),i=l.formatDataForDnD(n);return e.dataTransfer.setData("text/plain",JSON.stringify(i)),!1}};!1===r.canMultiSelect&&(I.selectionBehavior=D.selectionBehavior=T.selectionBehavior={canMultiSelect:!1}),this._tilecollectionView=new t(I),this._largeTilecollectionView=new n(D),this._thumbnailCollectionView=new i(T),r.getSubLabel&&(this._tilecollectionView.getSubLabel=r.getSubLabel,this._thumbnailCollectionView.getSubLabel=r.getSubLabel),r.getLabel&&(this._tilecollectionView.getLabel=r.getLabel,this._thumbnailCollectionView.getLabel=r.getLabel),r.getDescription&&(this._tilecollectionView.getDescription=r.getDescription,this._thumbnailCollectionView.getDescription=r.getDescription),r.getStatusbarIcons&&(this._tilecollectionView.getStatusbarIcons=r.getStatusbarIcons,this._thumbnailCollectionView.getStatusbarIcons=r.getStatusbarIcons),r.getStatusbarIconsTooltips&&(this._tilecollectionView.getStatusbarIconsTooltips=r.getStatusbarIconsTooltips,this._thumbnailCollectionView.getStatusbarIconsTooltips=r.getStatusbarIconsTooltips),r.getCustomTooltip&&(this._tilecollectionView.getCustomTooltip=r.getCustomTooltip,this._thumbnailCollectionView.getCustomTooltip=r.getCustomTooltip),r.getEmptyStatusbarVisibleFlag&&(this._largeTilecollectionView.getEmptyStatusbarVisibleFlag=this._tilecollectionView.getEmptyStatusbarVisibleFlag=r.getEmptyStatusbarVisibleFlag,this._thumbnailCollectionView.getEmptyStatusbarVisibleFlag=r.getEmptyStatusbarVisibleFlag),this._largeTilecollectionView.onStatusbarIconPointerDown=this._tilecollectionView.onStatusbarIconPointerDown=r.onStatusbarIconPointerDown||E,this._thumbnailCollectionView.onStatusbarIconPointerDown=r.onStatusbarIconPointerDown||E,r.onPostCellRequest&&(this._tilecollectionView.onPostCellRequest(r.onPostCellRequest),this._largeTilecollectionView.onPostCellRequest(r.onPostCellRequest),this._thumbnailCollectionView.onPostCellRequest(r.onPostCellRequest)),r.getLargeTileSubLabel&&(this._largeTilecollectionView.getSubLabel=r.getLargeTileSubLabel),r.getLargeTileDescription&&(this._largeTilecollectionView.getDescription=r.getLargeTileDescription),r.getLargeTileStatusbarIcons&&(this._largeTilecollectionView.getStatusbarIcons=r.getLargeTileStatusbarIcons),r.getLargeTileStatusbarIconsTooltips&&(this._largeTilecollectionView.getStatusbarIconsTooltips=r.getLargeTileStatusbarIconsTooltips),r.getLargeTileCustomTooltip&&(this._largeTilecollectionView.getCustomTooltip=r.getLargeTileCustomTooltip);let O={getGroupingNodeOptions:S},N={identifier:r.uniqueIdentifier?r.uniqueIdentifier:"",layoutOptions:{layoutDensity:r.activateComfortableView?"comfortable":"compact",...void 0!==r.showColumnsHeader?{columnsHeader:r.showColumnsHeader}:{},...void 0!==r.showRowsHeader?{rowsHeader:r.showRowsHeader}:{}},selectionBehavior:{...void 0!==r.toggleSelection?{toggle:r.toggleSelection}:{}},selectionMode:"row",columns:this._columnsConfiguration,showSelectionCheckBoxesFlag:"OnOver",cellSelection:"single",rowSelection:r.rowSelection?r.rowSelection:"multiple",defaultColumnDef:{editionPolicy:"EditionOnClick",getCellValueForExport:v,getCellGroupingKey:g},rowGroupingOptions:O,pageScrollValueTriggeringInfiniteScroll:.5,useWidgetPreferencesFlag:void 0===r.useWidgetPreferencesFlag||r.useWidgetPreferencesFlag,placeholder:r.dgvPlaceholder?r.dgvPlaceholder:s.data_unavailable_message,...void 0!==r.showAlternateBackgroundFlag?{showAlternateBackgroundFlag:r.showAlternateBackgroundFlag}:{},...void 0!==r.showRowBorderFlag?{showRowBorderFlag:r.showRowBorderFlag}:{},...void 0!==r.cellSelection?{cellSelection:r.cellSelection}:{},...void 0!==r.selectionStyle?{selectionStyle:r.selectionStyle}:{},...void 0!==r.useAsyncPreExpand?{useAsyncPreExpand:r.useAsyncPreExpand}:{},...r.dataSource?{dataSource:r.dataSource}:{},...r.virtuallyLoadAllModelItems?{virtuallyLoadAllModelItems:r.virtuallyLoadAllModelItems}:{}};r.enableCellDrag&&r.onDragStartCell&&(N.cellDragEnabledFlag=r.enableCellDrag,N.onDragStartCell=r.onDragStartCell),r.enableDrag&&r.onDragStartRowHeader?(N.rowDragEnabledFlag=r.enableDrag,N.onDragStartRowHeader=r.onDragStartRowHeader):(N.rowDragEnabledFlag=!!r.enableDrag&&r.enableDrag,N.onDragStartRowHeader=function(e,t){let n=this.getTreeDocument().getSelectedNodes(),i=l.formatDataForDnD(n);return e.dataTransfer.setData("text/plain",JSON.stringify(i)),!1}),this._dataGridView=new e(N),this._dataGridView.immersiveFrame=u,this._dataGridView.onReady(function(){let e=widget.getValue("wux-collectionView-dataGridView");if(e){let t=JSON.parse(e)[N.identifier];t&&this.getCustomViewsManager().setCustomViews(t.customViews,t.currentCustomViewId,!0)}r.groupingOptions&&(l.groupingOptionsforViewSwitch={...r.groupingOptions},l._dataGridView.prepareUpdateView(),l._dataGridView.groupRows(r.groupingOptions),l._dataGridView.pushUpdateView()),r.toHighlight&&l.selectNodeModel(r.toHighlight)}),this._dataGridView.addEventListener("click",m.debounce((e,t)=>{if(t&&t.nodeModel&&e.target.hasClassName){if(!(e.target.hasClassName("wux-tweakers-string-label")||e.target.hasClassName("wux-button-icon-placeholder")))return;var n=e.dsModel.layout.getDataIndexFromColumnIndex(t.columnID),i=e.dsModel.layout.getLeafColumns().find(e=>e.dataIndex===n);if(("url"===i.typeRepresentation&&"_self"===i.hyperlinkTarget||"functionIcon"===i.typeRepresentation)&&(e.target.hasClassName("wux-tweakers-string-label")||e.target.hasClassName("wux-button-icon-placeholder"))){var o=t;t.cellModel.hyperlinkClickCallback&&t.cellModel.hyperlinkClickCallback(o)}}},300)),this._dataGridView.addEventListener("mouseover",function(e,t){if(t&&t.nodeModel&&e.target.hasClassName){if(!(e.target.hasClassName("wux-tweakers-string-label")||e.target.hasClassName("wux-button-icon-placeholder")))return;var n=e.dsModel.layout.getDataIndexFromColumnIndex(t.columnID),i=e.dsModel.layout.columns.find(e=>e.dataIndex===n);i||e.dsModel.layout.columns.map(function(e){e.children&&e.children.length>0&&e.children.some(e=>e.dataIndex===n)&&(i=e.children.find(e=>e.dataIndex===n))}),(i&&"url"===i.typeRepresentation&&"_self"===i.hyperlinkTarget||"functionIcon"===i.typeRepresentation)&&(i.typesNAForHyperlink&&t.nodeModel.options.grid.actualType&&i.typesNAForHyperlink.includes(t.nodeModel.options.grid.actualType)||(e.target.hasClassName("wux-tweakers-string-label")||e.target.hasClassName("wux-button-icon-placeholder"))&&(e.target.setStyle("text-decoration","underline"),e.target.setStyle("cursor","pointer")))}}),this._dataGridView.addEventListener("mouseout",function(e,t){if(t&&t.nodeModel&&e.target.hasClassName){if(!(e.target.hasClassName("wux-tweakers-string-label")||e.target.hasClassName("wux-button-icon-placeholder")))return;var n=e.dsModel.layout.getDataIndexFromColumnIndex(t.columnID),i=e.dsModel.layout.columns.find(e=>e.dataIndex===n);i||e.dsModel.layout.columns.map(function(e){e.children&&e.children.length>0&&e.children.some(e=>e.dataIndex===n)&&(i=e.children.find(e=>e.dataIndex===n))}),(i&&"url"===i.typeRepresentation&&"_self"===i.hyperlinkTarget||"functionIcon"===i.typeRepresentation)&&(i.typesNAForHyperlink&&t.nodeModel.options.grid.actualType&&i.typesNAForHyperlink.includes(t.nodeModel.options.grid.actualType)||(e.target.hasClassName("wux-tweakers-string-label")||e.target.hasClassName("wux-button-icon-placeholder"))&&(e.target.setStyle("text-decoration","none"),e.target.setStyle("cursor","none")))}}),r.onPostAdd&&"function"==typeof r.onPostAdd&&this._dataGridView.getCellsXSO().onPostAdd(function(e){e.forEach(function(e){r.onPostAdd(e)})}),r.onContextualEventCallback&&(this._tilecollectionView.onContextualEvent={callback:r.onContextualEventCallback},this._largeTilecollectionView.onContextualEvent={callback:r.onContextualEventCallback},this._thumbnailCollectionView.onContextualEvent={callback:r.onContextualEventCallback},this._dataGridView.onContextualEvent=r.onContextualEventCallback,this._dataGridView.getContainingImmersiveFrame=function(){return l._dataGridView.immersiveFrame}),this._subscribeToEvents(r),l._toolbarChannel.publish({event:"enox-collection-toolbar-switch-view-activated",data:this.toolbarOptions.currentView}),r.expander&&this.addExpander(r)},C.prototype._subscribeToEvents=function(e){var t=this,n=t._tilecollectionView.getModel(),i=this._gridModel.getXSO(),o=this._dataGridView.getNodesXSO();t._toolbarChannel.subscribe({event:"enox-collection-toolbar-switch-view-activated"},function(e){t.switchView(e)}),t._thumbnailCollectionView.onCellDoubleClick(function(e){t.collectionViewEvents.publish({event:"xsourcing-collectionview-cell-dblclick",data:e.nodeModel.options.grid})}),t._largeTilecollectionView.onCellDoubleClick(function(e){t.collectionViewEvents.publish({event:"xsourcing-collectionview-cell-dblclick",data:e.nodeModel.options.grid})}),n.onCellDoubleClick(function(e){t.collectionViewEvents.publish({event:"xsourcing-collectionview-cell-dblclick",data:e.nodeModel.options.grid})}),this._toolbarChannel.subscribe({event:"enox-collection-toolbar-sort-activated"},function(e){var n={sortAttribute:e.sortAttribute,sortOrder:e.sortOrder},i="asc"===n.sortOrder.toLowerCase()?1:-1;t._dataGridView.treeDocument._trueRoot.sortChildren({isRecursive:!0,sortFunction:function(e,t){try{return i*e._options.grid[n.sortAttribute].localeCompare(t._options.grid[n.sortAttribute])}catch(e){}}})}),e.withmultisel&&(t._toolbarChannel.subscribe({event:"enox-collection-toolbar-all-selected"},function(){n.selectAll()}),t._toolbarChannel.subscribe({event:"enox-collection-toolbar-all-unselected"},function(){n.unselectAll()})),t._toolbarChannel.subscribe({event:"enox-collection-toolbar-filter-search-value"},function(e){t.collectionViewEvents.publish({event:"filter-on-search",data:e.searchValue[0]})}),i.onChange(function(){var e=t._gridModel.getSelectedNodes(),n=e.map(function(e){return e._options.grid.id});t._selectedItems=[],0!==e.length&&(t._allData.length>0?(t._allData=t._allData.map(e=>e.grid.id).map((e,t,n)=>n.indexOf(e)===t&&t).filter(e=>t._allData[e]).map(e=>t._allData[e]),t._selectedItems=t._allData.filter(function(e){return-1!==n.indexOf(e.grid.id)})):e.forEach(e=>{t._selectedItems.push(e.options)})),t.collectionViewEvents.publish({event:"xsourcing-collectionview-selection-updated",data:{selectedItems:t._selectedItems,selectedNodes:e}});let i=e.map(function(e){return[e._options.grid.id]});t.searchUtility.getPlatfromAPIObj().publish(u.PUBLISH_TO_PROPERTY,{data:{paths:i}})}),null!==o&&o.onChange(function(){var e=t._dataGridView.getTreeDocument().getSelectedNodes(),n=e.map(function(e){return e._options.grid.id});t._selectedItems=[],0!==e.length&&(t._allData.length>0?(t._allData=t._allData.map(e=>e.id).map((e,t,n)=>n.indexOf(e)===t&&t).filter(e=>t._allData[e]).map(e=>t._allData[e]),t._selectedItems=t._allData.filter(function(e){return-1!==n.indexOf(e.id)})):e.forEach(e=>{t._selectedItems.push(e.options)})),t.collectionViewEvents.publish({event:"xsourcing-collectionview-selection-updated",data:{selectedItems:t._selectedItems,selectedNodes:e}})}),t.collectionViewEvents.subscribe({event:"xsourcing-collectionview-disable-toolbar-button"},function(e){t._toolbarChannel.publish({event:"enox-collection-toolbar-disable-action",data:e})}),t.collectionViewEvents.subscribe({event:"xsourcing-collectionview-enable-toolbar-button"},function(e){t._toolbarChannel.publish({event:"enox-collection-toolbar-enable-action",data:e})}),t.collectionViewEvents.subscribe({event:"xsourcing-collectionview-toolbar-add-action-with-content"},function(e){t.collectionToolbar._actionsIconBar.addItem(e)}),t.collectionViewEvents.subscribe({event:"xsourcing-collectionview-update-count"},function(e){t.toolbarOptions.showItemCount&&!t.toolbarOptions.lockItemCount&&t._updateCount(e)}),t.collectionViewEvents.subscribe({event:"xsourcing-collectionview-load-full-model"},function(){t.options.groupingOptions&&t._dataGridView.groupRows({...t.options.groupingOptions})}),t.collectionViewEvents.subscribe({event:"xsourcing-collectionview-selection-updated"},function(n){n.selectedItems.length>0?e.showToolbarInfoIcon&&t.collectionViewEvents.publish({event:"xsourcing-collectionview-enable-toolbar-button",data:"sourcinginfoicon"}):e.showToolbarInfoIcon&&t.collectionViewEvents.publish({event:"xsourcing-collectionview-disable-toolbar-button",data:"sourcinginfoicon"})})},C.prototype.setModel=function(e){this._dataGridView.treeDocument=e,this._thumbnailCollectionView.model=e,this._tilecollectionView.model=e,this._largeTilecollectionView.model=e,this.toolbarOptions.showItemCount&&!this.toolbarOptions.lockItemCount&&this._updateCount()},C.prototype._updateCount=function(e){var t="";!1===this.options.showNodeCount?t="":(t=0,t=e||(this._tilecollectionView&&this._tilecollectionView.treeDocument?this._tilecollectionView.treeDocument.getNumberOfVisibleDescendants():this._largeTilecollectionView&&this._largeTilecollectionView.treeDocument?this._largeTilecollectionView.treeDocument.getNumberOfVisibleDescendants():this._thumbnailCollectionView&&this._thumbnailCollectionView.treeDocument?this._thumbnailCollectionView.treeDocument.getNumberOfVisibleDescendants():this._dataGridView.dataSource?this._dataGridView.getTreeDocument().getNumberOfVisibleDescendants():this._dataGridView.treeDocument?this._dataGridView.treeDocument.getNumberOfVisibleDescendants():0)),this._toolbarChannel.publish({event:"enox-collection-toolbar-items-count-update",data:t}),this.checkNoDataFoundMessage()},C.prototype.addExpander=function(e){var t=new d.Element("div",{styles:{height:"100%"}}),n=e.container.querySelector(".xsourcingcollectionview-wrapper-container");n.style.height=e.expander.height?e.expander.height:"250px",this._expander=new l({style:e.expander.style?e.expander.style:"simple",header:e.expander.expanderHeader?e.expander.expanderHeader:"",body:n,allowUnsafeHTMLHeader:!1,expandedFlag:!!e.expander.expandedFlag&&e.expander.expandedFlag}).inject(t),t.inject(e.container)},C.prototype.checkNoDataFoundMessage=function(){if(!this.disableNoDataMessage&&this._dataGridView.treeDocument){var e="no-object-found-"+(this.toolbarOptions.itemsName||this.uniqueIdentifier),t=widget.getElement('[id="'+e+'"]');0!==this._dataGridView.treeDocument.getAllDescendants().length?t&&t.remove():t&&t.parentNode===this.viewContainer||"Grid View"===this.currentView||(this.viewContainer.querySelector("#no-object-found-MembersView")&&this.viewContainer.querySelector("#no-object-found-MembersView").remove(),this._noObjectAvailableDiv=d.createElement("div",{id:e,class:"emptyContainerStyle",html:this.options.data_unavailable_message?this.options.data_unavailable_message:s.data_unavailable_message}),this.viewContainer.appendChild(this._noObjectAvailableDiv))}},C.prototype.checkIfExceedsDeleteLimit=function(e){if(e.length>u.DELETE_LIMIT){let e=s.delete_limit_exceeds;return e=e.replace("$1",s.delete_limit),widget.notificationUtil.showWarning(e),!0}return!1},C.prototype.formatDataForDnD=function(e){let t=[];return e.forEach(e=>{let n=e.options.grid;var i=n.actualType?n.actualType:n.type,o=n.displayType?n.displayType:n.type,a=n.actualId?n.actualId:n.id,r=n.service?n.service:u.SOURCE_SOURCING;u.ONPREMISE===p.getPlatformId()&&(r=u.SERVICE_3DSPACE),t.push({envId:p.getPlatformId(),serviceId:r,contextId:"",objectId:a,objectType:i,displayName:e.options.label,displayType:o,...n.additionalDragData})}),{protocol:"3DXContent",version:"1.1",source:widget.data.appId,widgetId:widget.id,data:{items:t}}},C.prototype.switchView=function(e){this.viewContainer.innerHTML="",this.options.uniqueIdentifier&&widget.setValue(this.options.uniqueIdentifier,e),this.groupingOptionsforViewSwitch&&(this._gridModel.prepareUpdate(),this._gridModel.ungroupRoots(),this._gridModel.pushUpdate()),"Thumbnail View"===e?(this._gridModel.prepareUpdate(),this._gridModel.ungroupRoots(),this._gridModel.pushUpdate(),this._thumbnailCollectionView.getContent().inject(this.viewContainer),this.currentView="Thumbnail View",this.checkNoDataFoundMessage()):"Tile View"===e?(this._gridModel.prepareUpdate(),this._gridModel.ungroupRoots(),this._gridModel.pushUpdate(),this._tilecollectionView.getContent().inject(this.viewContainer),this.currentView="Tile View",this.checkNoDataFoundMessage()):"Large Tile View"===e?(this._gridModel.prepareUpdate(),this._gridModel.ungroupRoots(),this._gridModel.pushUpdate(),this._largeTilecollectionView.getContent().inject(this.viewContainer),this.currentView="Large Tile View",this.checkNoDataFoundMessage()):"Grid View"===e?(this._dataGridView.getContent().inject(this.viewContainer),this.currentView="Grid View",this.groupingOptionsforViewSwitch?(this._dataGridView.prepareUpdateView(),this._dataGridView.groupRows({...this.groupingOptionsforViewSwitch}),this._dataGridView.pushUpdateView()):(this._dataGridView.prepareUpdateView(),this._dataGridView.groupRows({dataIndexesToGroup:[]}),this._dataGridView.pushUpdateView())):this.options.customView&&e===this.options.customView.id&&(this.currentView=this.options.customView.id,this.options.customViewLoader())},C.prototype.addMobileIconContainer=function(e,t){this._actionsInfoIconBar=new h({renderTo:t,events:{onClick:function(t,n){e.app._applicationChannel.publish({event:"welcome-panel-expand"})}}});this._actionsInfoIconBar.addItem({id:"menuIcon",fonticon:"menu",text:"Menu",disabled:!1})},C.prototype.selectNodeModel=function(e){this._dataGridView.selectNodeModel(this._dataGridView.model.filter(t=>t.getAttributeValue(e.key)===e.id)[0],!1,!1),this._dataGridView.ensureNodeModelVisible(this._dataGridView.model.filter(t=>t.getAttributeValue(e.key)===e.id)[0],!0,!1,0)},C.prototype.unSelectAll=function(){this._dataGridView.unselectAll()},C.prototype.exportDataToCSV=function(e,t){let n=this._dataGridView.getAsCSV(e),i=t;let o=new Blob(["\ufeff"+n],{type:"text/csv;charset=utf-8;"}),a=document.createElement("a"),r=URL.createObjectURL(o);a.setAttribute("href",r),a.setAttribute("download",i),a.style.visibility="hidden",document.body.appendChild(a),a.click(),document.body.removeChild(a)},C}),define("DS/ENOXSourcingUXInfra/xsourcingCollectionView/xsourcingCollectionView",["UWA/Class","DS/TreeModel/TreeNodeModel","DS/TreeModel/DataModelSet","DS/TreeModel/TreeDocument","DS/ENOXSourcingUXInfra/xsourcingCollectionView/xsourcingCollectionViewUI"],function(e,t,n,i,o){"use strict";var a=function(){this._xsourcingCollectionViewUI=new o};return a.prototype.init=function(e){this.options=e,this._data=this.options.data,this._dataModelSet=new n,this._model=new i({dataModelSet:this._dataModelSet}),this._gridModel=new i,e.gridModel=this._gridModel,e.model=this._model,this.collectionViewEvents=e.collectionViewEvents,this.collectionViewEvents||(this.collectionViewEvents=widget.app._mediator.createNewChannel()),e.collectionViewEvents=this.collectionViewEvents,this._xsourcingCollectionViewUI.init(e),this._setData(this.options.data),this.subscribeToEvents(e)},a.prototype.subscribeToEvents=function(e){var n=this;this.options.applicationChannelEvents&&this.options.applicationChannelEvents.forEach(function(e){n.options.applicationChannel.subscribe({event:e.eventName},function(e){e.contextualMenu=[""],e.tooltip&&(e.customTooltip=n._getCustomToolTip(e.tooltip));var i=new t(e);n._gridModel.addRoot(i,0),n._xsourcingCollectionViewUI.toolbarOptions.lockItemCount||n._xsourcingCollectionViewUI._updateCount()})}),this.options.collectionViewEvents.subscribe({event:"add-model"},function(e){e.contextualMenu=[""],e.tooltip&&(e.customTooltip=n._getCustomToolTip(e.tooltip));var i=new t(e);n._gridModel.addRoot(i,0),n._xsourcingCollectionViewUI.toolbarOptions.lockItemCount||n._xsourcingCollectionViewUI._updateCount()}),this.options.applicationChannel&&this.options.applicationChannel.subscribe({event:"search-in-current-dashboard"},function(e){n._handlefilterData(e)}),e.rowSelectCallback&&this._gridModel.addEventListener("select",function(t){e.rowSelectCallback(t.data.nodeModel.options.grid)}),e.rowUnSelectCallback&&this._gridModel.addEventListener("unselect",function(t){e.rowUnSelectCallback(t.data.nodeModel.options.grid)}),e.collectionViewEvents.subscribe({event:"filter-on-search"},function(e){n._handlefilterData(e)}),e.collectionViewEvents.subscribe({event:"d6w-tagger-filter-action"},function(e){n._handleTaggerFilter(e)})},a.prototype._setData=function(e){this._model.empty(),this._gridModel.empty(),this._model.prepareUpdate(),this._gridModel.prepareUpdate();for(var n=function(e,i){i&&i.children&&i.children.length>0&&i.children.forEach(function(i){let o=new t({label:i.title,grid:i,...void 0!==i.children?{children:[]}:{}});e.addChild(o),n(o,i)})},i=0;i<e.length;i++){var o=e[i];o.contextualMenu=!e[i].disableContextualMenu&&[""],o.tooltip&&(o.customTooltip=this._getCustomToolTip(o.tooltip));var a=t.createTreeNodeDataModel(this._dataModelSet,e[i]);this._model.addChild(a);var r=new t(e[i]);this._gridModel.addRoot(r),n(r,e[i].grid)}this.options.expandChildren?this._gridModel.expandAll():this.options.expandChildrenLevel&&this._gridModel.expandNLevels(this.options.expandChildrenLevel),this.options.onPreExpand&&"function"==typeof this.options.onPreExpand&&this._gridModel.onPreExpand(this.options.onPreExpand),this.options.onPreCollapse&&"function"==typeof this.options.onPreCollapse&&this._gridModel.onPreCollapse(this.options.onPreCollapse),this._gridModel.pushUpdate(),this._model.pushUpdate(),this._xsourcingCollectionViewUI.setModel(this._gridModel)},a.prototype._getCustomToolTip=function(e){var t="";return e.forEach(function(e){""!==e.data&&void 0!==e.data&&(""!==t&&(t+="\n"),t=t+e.label+": "+e.data)}),t},a.prototype._handleTaggerFilter=function(e){for(var n=new i,o=0;o<e.length;o++){var a=new t(e[o]);n.addRoot(a)}this._xsourcingCollectionViewUI.setModel(n)},a.prototype._handlefilterData=function(e){let t=this;var n=this.options.dataSource?this._xsourcingCollectionViewUI._dataGridView.getTreeDocument():this._gridModel,i=n.getRoots();n.prepareUpdate(),i.forEach(t=>{a.prototype._hideShowRow(e,t,this.options)}),t._xsourcingCollectionViewUI.toolbarOptions.lockItemCount||t._xsourcingCollectionViewUI._updateCount(),n.pushUpdate()},a.prototype._hideShowRow=function(e,t,n){if(e){var i=new RegExp(e.replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1"),"i"),o=!1;if(t.options.children&&0!==t.options.children.length){t.options.children.forEach(t=>{a.prototype._hideShowRow(e,t,n)})}else{if(n.columnToSearch)n.columnToSearch.forEach(e=>{o=o||i.test(t.options.grid[e])});else Object.keys(t.options.grid).forEach(e=>{o=o||i.test(t.options.grid[e])});o?t.show():t.hide(!0)}}else if(t.options.children&&0!==t.options.children.length){t.options.children.forEach(t=>{a.prototype._hideShowRow(e,t,n)})}else t.show()},a.prototype.switchView=function(e){return this._xsourcingCollectionViewUI.switchView(e)},a}),define("DS/ENOXSourcingUXInfra/ProofsView/ProofsView",["UWA/Core","UWA/Class/View","DS/UIKIT/Mask","DS/ENOXSourcingUXInfra/xsourcingCollectionView/xsourcingCollectionView","DS/DocumentManagement/DocumentManagement","i18n!DS/ENOXSourcingUXInfra/assets/nls/ENOXSourcingUXInfra","DS/Utilities/Dom","DS/UIKIT/SuperModal","DS/ENOXSourcingUXInfra/Constants/ENOXSourcingConstants","DS/ENOXSourcingUXInfra/Search/SearchUtility","DS/ENOXSourcingUXInfra/Search/ENOXSourcingSearch","DS/ENOXSourcingUXInfra/service/ENOXSourcingService","DS/ENOXSourcingUXInfra/service/ENOXSourcingPlatformServices","DS/ENOXSourcingUXInfra/openwithservice/ENOXSourcingOpenWithService","css!DS/UIKIT/UIKIT.css"],function(e,t,n,i,o,a,r,s,l,c,d,u,p,m){"use strict";return t.extend({name:"proof-view",tagName:"div",domEvents:{},init:function(e){this.model=e.model,this.searchUtil=new c,this.modelEvent=this.model.get("modelEvent"),["container","template","tagName","domEvents"].forEach(function(t){delete e[t]}),this._parent(this,e)},setup:function(){this.container.addClassName(this.getClassNames("-container"))},update:function(){var e=this.outerDiv.parentElement.parentElement?this.outerDiv.parentElement.parentElement.getBoundingClientRect():this.outerDiv.parentElement.getBoundingClientRect();this.outerDiv.style.height=e.height+"px"},render:function(){var t=this;this.container.empty(),this.outerDiv=e.createElement("div",{class:"outerDiv",styles:{height:"100%"}}).inject(this.container);var o={data:[]};return t.loadData(),o._mediator=t.model.get("mediator"),o.showToolbar=!0,o.uniqueIdentifier="ProofsView",o.toolbarActions=[{fonticon:"plus",text:a.add,id:"add",disabled:!t.isUpdateEnabled(),handler:function(){t.launchA3DSearch()}},{id:"download",text:a.downLoad,fonticon:"download",disabled:!0,handler:function(){let e=t.tableView._gridModel.getSelectedNodes();n.mask(widget.body,a.downloading_proof),t.downloadProof(e.map(e=>e.options.grid.id)).then(function(){n.unmask(widget.body)})}},{fonticon:"remove",text:a.remove,id:"remove",disabled:!0,handler:function(){var e=t.tableView._gridModel.getSelectedNodes(),n=new s({renderTo:widget.body,okButtonText:a.remove}),i=1===e.length?e[0].options.label:e.length+" "+a.proof_small;n.confirm(a.remove_confirmation,a.remove+" - "+i,function(n){n&&t.removeProof(e)})}}],o.columnsConfigurations=[],o.displayedOptionalCellProperties=["contextualMenu","subtitle"],o.views=["Tile"],o.enableDrag=!0,o.onContextualEventCallback=function(e){var n=[];if(e){var i=e.cellInfos&&e.cellInfos.nodeModel?e.cellInfos.nodeModel:null;if(-1===(e.cellInfos?e.cellInfos.rowID:null)||!i)return this._contextualMenuBuilder?this._contextualMenuBuilder.buildMenu(e,o):[];var r=e.cellInfos.nodeModel?e.cellInfos.nodeModel:e.cellInfos.cellModel;if(r)return m.getOpenWithMenu(r).then(function(e){return n.push({id:"OpenWith",type:"PushItem",title:a.open_with,icon:"open-menu-dot",submenu:e}),n.push({type:"SeparatorItem"}),t.isUpdateEnabled()&&n.push({id:"remove",type:"PushItem",title:a.remove,icon:"remove",action:{callback:function(){let e=r.options.grid;new s({renderTo:widget.body,okButtonText:a.remove}).confirm(a.remove_confirmation,a.remove+" - "+e.title,function(e){e&&t.removeProof([r])})}}}),n},function(){return t.isUpdateEnabled()&&n.push({id:"remove",type:"PushItem",title:a.remove,icon:"remove",action:{callback:function(){let e=r.options.grid;new s({renderTo:widget.body,okButtonText:a.remove}).confirm(a.remove_confirmation,a.remove+" - "+e.title,function(e){e&&t.removeProof([r])})}}}),n}).catch(function(){})}return n},t.tableView=new i,o.container=t.outerDiv,o.rowSelection="multiple",t.tableView.init(o),t.multidocdownloaderFrame=e.createElement("iframe",{name:"multidocdownloaderFrame",styles:{display:"none"}}),t.multidocdownloaderForm=e.createElement("form",{method:"POST",enctype:"application/x-www-form-urlencoded",target:"multidocdownloaderFrame",html:[{tag:"input",value:"true",name:"attachment"}],styles:{display:"none"}}),o.dropStrategy="CREATE",o.multiObjs=!0,o.onDropCallback=function(e){t.addDroppedObj(e)},o.dropArea=t.tableView._xsourcingCollectionViewUI.viewContainer,require(["DS/ENOXSourcingUXInfra/DragAndDrop/ENOXSourcingDataDragAndDrop"],function(e){(new e).makeAreaDroppable(o)}),t.tableView.collectionViewEvents.subscribe({event:"xsourcing-collectionview-selection-updated"},function(e){e.selectedItems.length>0?(t.isUpdateEnabled()&&t.tableView.collectionViewEvents.publish({event:"xsourcing-collectionview-enable-toolbar-button",data:"remove"}),t.tableView.collectionViewEvents.publish({event:"xsourcing-collectionview-enable-toolbar-button",data:"download"})):(t.tableView.collectionViewEvents.publish({event:"xsourcing-collectionview-disable-toolbar-button",data:"remove"}),t.tableView.collectionViewEvents.publish({event:"xsourcing-collectionview-disable-toolbar-button",data:"download"}))}),t.modelEvent.subscribe({event:"add-model"},function(){t.loadData(),n.unmask(widget.body)}),r.addResizeListener(this.outerDiv,function(){t.update()},0),this.container},getDownloader:function(){return this.multidocdownloaderFrame.isInjected()||this.multidocdownloaderFrame.inject(document.body),this.multidocdownloaderForm.isInjected()||this.multidocdownloaderForm.inject(document.body),this.multidocdownloaderForm.empty(),e.createElement("input",{name:"attachment",value:"true"}).inject(this.multidocdownloaderForm),this.multidocdownloaderForm},onDestroy:function(){return this._parent.apply(this,arguments)},isUpdateEnabled:function(){return"TRUE"===this.model.get("qualDetails").modifyAccess&&(this.model.get("qualDetails").state===l.STATE_IN_DRAFT||this.model.get("qualDetails").maturityState===l.STATE_IN_DRAFT||this.model.get("qualDetails").state===l.STATE_IN_WORK||this.model.get("qualDetails").maturityState===l.STATE_IN_WORK)},loadData:async function(){let e=this;e.container&&e.container.parentElement&&n.mask(e.container.parentElement,a.loading_proofs);let t=await e.model.get("controller").getProofsData(e.model.get("qualDetails").id);e.tableView._setData(t),e.tableView._xsourcingCollectionViewUI._allData=t,e.update(),e.model.get("controller").app._applicationChannel.publish({event:"update-proof-dgv",data:{proofData:t,qualId:e.model.get("qualDetails").id}}),e.container&&e.container.parentElement&&(n.unmask(e.container.parentElement),n.unmask(e.container))},launchA3DSearch:function(){let e=this;var t={types:[l.DOCUMENT,l.TYPE_TEST_SPECIFICATION],excludeCondition:l.EXCLUDE_OBSOLETE,multiSel:!0,callbackMethod:function(t){e.addProof(t)}};(new d).init(t)},addProof:function(e){let t=this;var i={sticky:!1,allowUnsafeHTML:!1,subtitle:""};let o={onFailure:function(e){i={level:"error",title:a.add_failed,subtitle:e.internalError?e.internalError:e.error?e.error:e},window.notifs.addNotif(i),n.unmask(widget.body)},onProgress:function(){n.mask(widget.body,a.adding_proof)},onComplete:function(e){e=e.data,t.model.get("modelEvent")&&(t.model.get("modelEvent").publish({event:"add-model",data:e}),i={level:"success",title:a.proof_added_successfully},window.notifs.addNotif(i),n.unmask(widget.body))}};if(o.id=t.model.get("qualDetails").id,o.addData={data:[]},p.getPlatformId()!==l.ONPREMISE){var r={data:[]};e.forEach(e=>{let t=e.sourceid?e.sourceid.split(":")[0]:"",n=e.sourceid?e.sourceid.split(":")[1]:"";r.data.push({id:e.id||e.resourceid,type:l.QUALIFICATION_PROOF_PROXY,dataelements:{"ProxyItem.Proxy_Title":e["ds6w:label"],"ProxyItem.Proxy_Service":t.toLowerCase(),"ProxyItem.Proxy_Tenant":n}})}),t.model.get("controller").model.getProxyObjectId({data:r}).then(function(e){Object.values(e).forEach(e=>{o.addData.data.push({dataelements:{proof_id:e,action:"connect"},children:[]})}),t.model.get("controller").model.updateProofs(o)})}else e.forEach(e=>{o.addData.data.push({dataelements:{proof_id:e.id,action:"connect"},children:[]})}),t.model.get("controller").model.updateProofs(o)},downloadProof:function(t){var i=this;return new Promise(function(r,s){var c=p.getServiceURL(l.SERVICE_3DSPACE),d=u.getSecurityContext(),m={sticky:!1,allowUnsafeHTML:!1,subtitle:""},h={asZip:!0,autoDownload:!0,additionalURLParams:"useDOCMParamSettings=true",tenant:p.getPlatformId(),securityContext:d,additionalHeaders:{},tenantUrl:c,onFailure:function(e){m={level:"error",title:a.download_failed},window.notifs.addNotif(m),n.unmask(widget.body),s(e)},onProgress:function(){n.mask(widget.body,a.downloading_proof)},onComplete:function(t){e.is(t,"array")?t.forEach(function(t){if(t.downloadUrl){var n=new URL(t.downloadUrl),o=i.getDownloader();for(var r of n.searchParams)e.createElement("input",{name:r[0],value:r[1]}).inject(o);n.search="",o.action=n.href,o.submit(),m={level:"info",title:a.download_has_started}}else m={level:"error",title:a.download_not_initiated};window.notifs.addNotif(m)}):(m={level:"info",title:a.download_initiated},window.notifs.addNotif(m)),n.unmask(widget.body),r(t)}};1===t.length?o.downloadDocument(t[0],void 0,!1,h):o.downloadDocuments(t,h)})},processErrorMessage:function(e){var t="Operation failed";return e.internalError?t=e.internalError:e.error?t=e.error:e.data&&e.data.length>0&&(t=e.data[0].updateMessage),t},removeProof:function(e){let t=this;var i={sticky:!1,allowUnsafeHTML:!1,subtitle:""};let o={onFailure:function(e){i={level:"error",title:a.remove_failed,subtitle:e.error?e.error:e.internalError?e.internalError:e},window.notifs.addNotif(i),n.unmask(widget.body)},onProgress:function(){n.mask(widget.body,a.removing_proof)},onComplete:function(e){e=e.data,t.model.get("modelEvent")&&(t.model.get("modelEvent").publish({event:"add-model",data:e}),i={level:"success",title:a.proof_removed_successfully},window.notifs.addNotif(i),n.unmask(widget.body))}};o.id=t.model.get("qualDetails").id,o.addData={data:[]},e.forEach(e=>{o.addData.data.push({dataelements:{proof_id:p.getPlatformId()!==l.ONPREMISE?e.options.proxy_id:e.options.id,action:"disconnect"},children:[]})}),t.model.get("controller").model.updateProofs(o)},addDroppedObj:function(e){let t=this,n=[];e.map(e=>{e.sourceid=`${e.serviceId}:${e.envId}`,e.id=e.objectId,e["ds6w:label"]=e.displayName,e.type=e.objectType});let i=[];e.forEach(e=>{const o=new Promise(i=>{t.model.get("controller").gettypeshierarchy([e.type]).then(function(o){let a=o.types_hierarchies[0].hierarchy,r=[l.DOCUMENT,l.TYPE_TEST_SPECIFICATION],s=t.model.get("controller").helper.getTypeFromTypeHierarchy(a,e.type,r);r.includes(s)&&n.push(e),i()}).catch(function(){let e={sticky:!1,allowUnsafeHTML:!1,subtitle:"",level:"error",title:a.internal_server_error};window.notifs.addNotif(e)})});i.push(o)}),Promise.all(i).then(function(){let i={sticky:!1,allowUnsafeHTML:!1,subtitle:"",level:"error",title:a.invalid_object_dropped};n.length>0&&t.addProof(n),n.length!==e.length&&window.notifs.addNotif(i)})}})}),define("DS/ENOXSourcingUXInfra/components/HierarchicalView/HierarchicalView",["DS/Utilities/Dom","DS/ENOXSourcingUXInfra/xsourcingCollectionView/xsourcingCollectionView","DS/UIKIT/Scroller"],function(e,t,n){"use strict";return UWA.Class.View.extend({setup:function(e){this.app=e.app,this.model=e.model,this.controller=e.controller,this.currentStep=this.controller.wizardComponent.currentStep},renderButtons:function(){let e=UWA.createElement("span",{id:"modalButtons",class:"modal-buttons"});this.model.buttons.forEach(t=>{UWA.createElement("button",t).inject(e)}),this.currentStep.delegateButtons?(this.currentStep.footer="",this.currentStep.footer=e):e.inject(this.container)},render:function(){var n=this;n.container.empty(),n.outerDiv=UWA.createElement("div",{class:"hierarchicalDataDiv",styles:{height:"100%"}}).inject(n.container);let i={};return i.applicationChannel=n.options.app._applicationChannel,i._triptychWrapper=n.options.app._triptychWrapper,i._mediator=n.options.app._mediator,i.views=["Grid"],i.currentView="Grid View",n.tableView=new t,i.container=n.outerDiv,i.showAlternateBackgroundFlag=!1,i.showColumnsHeader=!1,i.showRowsHeader=!1,i.showAlternateBackgroundFlag=!1,i.showRowBorderFlag=!0,i.activateComfortableView=!0,i.dgvPlaceholder=this.model.placeholder,i.selectionStyle="lightSelectionEdging",i.toggleSelection=!0,i.useAsyncPreExpand=!0,i.columnsConfigurations=this.model.columnConfigurations,i.data=this.model.tiles,i.onPreExpand=function(e){e.options=n.tableView,n.model.getHierarchicalData(e)},i.onPostAdd=this.model.onCellSelection,i.showItemCount=!1,i.showToolbar=!0,n.tableView.init(i),n.tableView._xsourcingCollectionViewUI._toolbarChannel._pubsub.publish(void 0,"/enox-collection-toolbar-sort-activated/",{sortAttribute:"name",sortOrder:"ASC"}),this.model.buttons&&this.renderButtons(),e.addResizeListener(this.outerDiv,function(){n.update()},0),n.update(),n.container},update:function(){this.getContent().style.height="100%"}})}),define("DS/ENOXSourcingUXInfra/PropertiesView/SRCRelatedObjectsView/RelatedObjectsView",["UWA/Class/View","DS/Utilities/Dom","DS/Controls/Accordeon","DS/UIKIT/Scroller","DS/ENOXSourcingUXInfra/xsourcingCollectionView/xsourcingCollectionView","DS/ENOXSourcingUXInfra/Mediator","i18n!DS/ENOXSourcingUXInfra/assets/nls/ENOXSourcingUXInfra","DS/ENOXSourcingUXInfra/CommonUtils/CommonUtils","DS/ENOXSourcingUXInfra/openwithservice/ENOXSourcingOpenWithService","css!DS/ENOXSourcingUXInfra/PropertiesView/SRCRelatedObjectsView/RelatedObjectsView.css"],function(e,t,n,i,o,a,r,s,l){"use strict";return e.extend({name:"related-objects-view",tagName:"div",template:function(){return'<div class="'+this.getClassNames("-subcontainer")+'"></div>'},init:function(e){this.model=e.model,["container","template","tagName","domEvents"].forEach(function(t){delete e[t]}),this._parent(this,e)},render:function(){let e=this;e.container.empty();let o=UWA.createElement("div",{class:"relatedObjectsDiv",styles:{height:"620px"}}),a=e.model.get("data");if(void 0===a||a&&0===a.length){let t=UWA.createElement("div",{class:"emptyContainerStyleRelatedObjects",html:r.data_unavailable_message});return e.container.appendChild(t),e.container}return a.forEach(t=>{t.isHeader&&t.contentItems&&t.contentItems.length>0&&new n({items:[{header:t.label+" ("+t.contentItems.length+")",content:e.getAccordeonContent(t)}],style:"simple",exclusive:!1}).inject(o)}),o.inject(e.container),new i({element:o}).inject(e.container),t.addResizeListener(o.parentElement,function(){e.update(o)},0),e.update(o),e.container},update:function(e){let t=e.parentElement.parentElement&&e.parentElement.parentElement.parentElement?e.parentElement.parentElement.parentElement.getBoundingClientRect():e.parentElement.getBoundingClientRect();t.height=0!==t.height?t.height:widget.body.getBoundingClientRect().height-154,e.style.height=t.height+"px"},getAccordeonContent:function(e){let t=this,n={};n.container=UWA.createElement("div",{class:"accordeonDiv",styles:{height:"100%"}}),n.data=e.contentItems,t.prepareTileData(n.data);let i=80*e.contentItems.length;return n.container.setStyle("height",i),n.views=["Large Tile"],n.enableDrag=!0,n._mediator=new a,n.displayedOptionalCellProperties=["contextualMenu","subtitle"],n.columnsConfigurations=[{text:r.name,dataIndex:"name",resizableFlag:!0,sortableFlag:!0,pinned:"left",width:"130px"}],n.getLargeTileSubLabel=t.getLargeTileDescription,n.onContextualEventCallback=function(e){let n=[];if(e){var i=e.cellInfos&&e.cellInfos.nodeModel?e.cellInfos.nodeModel:null;if(-1===(e.cellInfos?e.cellInfos.rowID:null)||!i)return this._contextualMenuBuilder?this._contextualMenuBuilder.buildMenu(e):[];var o=e.cellInfos.nodeModel?e.cellInfos.nodeModel:e.cellInfos.cellModel;if(o)return n.push({id:"OpenItem",type:"PushItem",title:r.properties,fonticon:{content:"wux-ui-3ds wux-ui-3ds-attributes"},action:{callback:function(){t.model.get("ctxCallback")(o)}}}),l.getOpenWithMenu(o).then(function(e){return n=[...n.slice(0,1),{id:"OpenWith",type:"PushItem",title:r.open_with,icon:"open-menu-dot",submenu:e},...n.slice(1)]},function(){return n})}return n},(new o).init(n),n.container},prepareTileData:function(e){e.forEach(e=>{let t=[{label:r.title,data:e.grid.title?e.grid.title:e.grid.name},{label:r.maturity_state,data:e.grid.maturityDisplay},{label:r.TYPE,data:e.grid.typeDisplay},{label:r.modified,data:s.getDateStringForDisplay(e.grid.modificationDate)},{label:r.owner,data:e.grid.owner}];e.label=e.grid.title?e.grid.title:e.grid.name,e.grid.id=e.id,e.grid.displayType=e.grid.typeDisplay,e.grid.revision&&(e.label+=" | "+e.grid.revision,t.splice(1,0,{label:r.revision,data:e.grid.revision})),e.grid.maturityDisplay&&(e.label+=" | "+e.grid.maturityDisplay),e.tooltip=t})},getLargeTileDescription:function(e){let{typeDisplay:t,modificationDate:n,owner:i}=e.options.grid,o={typeDisplay:t,formattedDate:s.getDateStringForDisplay(n),owner:i};return Object.values(o).filter(e=>e).join(" | ")}})}),define("DS/ENOXSourcingUXInfra/DocumentView/DocumentView",["UWA/Core","UWA/Class/View","DS/UIKIT/Mask","DS/ENOXSourcingUXInfra/xsourcingCollectionView/xsourcingCollectionView","WebappsUtils/WebappsUtils","DS/DocumentManagement/DocumentManagement","i18n!DS/ENOXSourcingUXInfra/assets/nls/ENOXSourcingUXInfra","DS/Utilities/Dom","DS/ENOXSourcingUXInfra/Search/ENOXSourcingSearch","DS/ENOXSourcingUXInfra/service/ENOXSourcingService","DS/ENOXSourcingUXInfra/service/ENOXSourcingPlatformServices","DS/UIKIT/SuperModal","DS/Controls/DatePicker","DS/ENOXSourcingUXInfra/Constants/ENOXSourcingConstants","DS/ENOXSourcingUXInfra/Search/SearchUtility","DS/ENOXSourcingUXInfra/openwithservice/ENOXSourcingOpenWithService","DS/ENOXSourcingUXInfra/components/ModalWindowWrapper/ModalWindowWrapper","DS/DocumentCommands/Jobs","DS/DocumentCommands/ProgressPane","css!DS/ENOXSourcingUXInfra/DocumentView/DocumentView.css","css!DS/UIKIT/UIKIT.css"],function(e,t,n,i,o,a,r,s,l,c,d,u,p,m,h,f,g,v,S){"use strict";var w={},E=!1;return t.extend({name:"document-view",tagName:"div",domEvents:{},init:function(e){this.model=e.model,this.searchUtil=new h,this.modelEvent=this.model.get("modelEvent"),["container","template","tagName","domEvents"].forEach(function(t){delete e[t]}),w=this,this._parent(this,e),w.app={},widget&&widget.app&&widget.app.jobs&&"doco-jobs"===widget.app.jobs.name&&widget.app.progressPane&&"doco-progress"===widget.app.progressPane.name?(w.app=widget.app,w.app.jobs.MAX_PARALLEL_JOBS=1):(void 0===this.app.jobs&&void 0===w.app.jobs&&(w.app.jobs=new v(w.app),w.app.jobs.MAX_PARALLEL_JOBS=1),void 0===w.app.progressPane&&void 0===w.app.progressPane&&(w.app.progressPane=new S(w.app),w.app.progressPane.inject(widget.body)))},setup:function(){this.container.addClassName(this.getClassNames("-container"))},update:function(){var e=this.outerDiv.parentElement.parentElement.getBoundingClientRect();this.outerDiv.style.height=e.height+"px"},isUpdateEnabled:function(){return!0===this.model.get("isUpdateAllowed")&&(this.model.get("state")===m.STATE_IN_DRAFT||this.model.get("state")===m.STATE_IN_WORK)},render:function(){var t=this;this.container.empty(),this.outerDiv=e.createElement("div",{class:"outerDiv",styles:{height:"100%"}}).inject(this.container),n.mask(this.container,r.loading_document);var o={data:[]};return t.model.get("contextObject")&&t.loadData(),o._mediator=t.model.get("mediator"),o.toolbarActions=[],o.showToolbar=!0,o.uniqueIdentifier="DocumentView",o.toolbarActions.push({fonticon:"plus",text:r.add,disabled:!t.isUpdateEnabled(),content:t.pupulateToolbarMenus(!1)}),o.toolbarActions.push({id:"downloadDocument",text:r.downLoad,fonticon:"download",disabled:!0,handler:function(){let e=t.tableView._gridModel.getSelectedNodes();n.mask(widget.body,r.downloading_document),t.downloadDocument(e.map(e=>e.options.grid.actualId)).then(function(){n.unmask(widget.body)})}}),o.toolbarActions.push({id:"deleteDocument",text:r.remove,disabled:!0,fonticon:"remove",handler:function(){var e=t.tableView._gridModel.getSelectedNodes(),n=new u({renderTo:widget.body,okButtonText:r.remove}),i=1===e.length?e[0].options.label:e.length+" "+r.documents_small;n.confirm(r.remove_confirmation,r.remove+" - "+i,function(n){n&&e.forEach(function(e){t.detachDocument(e.options.grid)})})}}),(t.model.get("enableDelete")||m.ONPREMISE===d.getPlatformId())&&o.toolbarActions.push({id:"deleteDocumentFromDB",text:r.delete,disabled:!0,fonticon:"trash",className:t.model.get("enableDelete")?"":"cloudDisable",handler:function(){var e=t.tableView._gridModel.getSelectedNodes(),i=new u({renderTo:widget.body,okButtonText:r.delete}),o=1===e.length?e[0].options.label:e.length+" "+r.documents_small;i.confirm(r.delete_confirmation,r.delete+" - "+o,function(i){i&&e.forEach(function(e){t.deleteDocument({id:e.options.grid.actualId,source:e.options.grid.source,service:e.options.grid.service}).then(function(){t.loadData(),n.unmask(widget.body)})})})}}),t.model.get("blockActions")&&delete o.toolbarActions,o.columnsConfigurations=[{text:r.title,dataIndex:"tree",resizableFlag:!0,sortableFlag:!0,pinned:"left",minWidth:150},{text:r.revision,dataIndex:"revision"},{text:r.maturity_state,dataIndex:"state",minWidth:125},{text:r.owner_document,dataIndex:"owner"},{text:r.description,dataIndex:"description"},{text:r.is_specification,dataIndex:"isSpecification",visibleFlag:t.model.get("isSpecification")&&t.model.get("isSpecification")},{text:r.name,dataIndex:"name"},{text:r.originated,dataIndex:"created",typeRepresentation:"datetime",minWidth:150},{text:r.modified,dataIndex:"modified",typeRepresentation:"datetime",minWidth:150}],o.displayedOptionalCellProperties=["contextualMenu","subtitle"],o.views=["Grid","Tile","Thumbnail"],o.enableDrag=!0,o.onContextualEventCallback=function(e){var n=[];if(e){var i=e.cellInfos&&e.cellInfos.nodeModel?e.cellInfos.nodeModel:null;if(-1===(e.cellInfos?e.cellInfos.rowID:null)||!i)return this._contextualMenuBuilder?this._contextualMenuBuilder.buildMenu(e,o):[];var a=e.cellInfos.nodeModel?e.cellInfos.nodeModel:e.cellInfos.cellModel;if(a)return f.getOpenWithMenu(a).then(function(e){return n.push({id:"OpenWith",type:"PushItem",title:r.open_with,icon:"open-menu-dot",submenu:e},{id:"preview",type:"PushItem",title:r.preview,icon:"eye",action:{callback:function(){t._selectedRow=a._options.grid,t.launchPreview()}}}),t.getDefaultContexualMenu(n,a),n},function(){return t.getDefaultContexualMenu(n,a),n}).catch(function(){})}else e.cellCtxMenuRequired;return n},t.tableView=new i,o.container=t.outerDiv,o.rowSelection="multiple",o.sort=[{id:"title",text:r.title,type:"string"}],t.tableView.init(o),o.dropStrategy="CREATE",o.multiObjs=!0,o.onDropCallback=function(e){e[0]instanceof File?t.externalFilesHanlder(e):t.addDroppedObj(e)},t.model.get("isDragDropAllowed")&&(o.dropArea=t.tableView._xsourcingCollectionViewUI.viewContainer,require(["DS/ENOXSourcingUXInfra/DragAndDrop/ENOXSourcingDataDragAndDrop"],function(e){(new e).makeAreaDroppable(o)})),t.multidocdownloaderFrame=e.createElement("iframe",{name:"multidocdownloaderFrame",styles:{display:"none"}}),t.multidocdownloaderForm=e.createElement("form",{method:"POST",enctype:"application/x-www-form-urlencoded",target:"multidocdownloaderFrame",html:[{tag:"input",value:"true",name:"attachment"}],styles:{display:"none"}}),t.tableView.collectionViewEvents.subscribe({event:"xsourcing-collectionview-selection-updated"},function(e){if(e.selectedItems.length>0){if(t.tableView.collectionViewEvents.publish({event:"xsourcing-collectionview-enable-toolbar-button",data:"downloadDocument"}),t.isUpdateEnabled()){!1!==t.model.get("hasDisconnectAccess")&&t.tableView.collectionViewEvents.publish({event:"xsourcing-collectionview-enable-toolbar-button",data:"deleteDocument"}),(t.model.get("enableDelete")||m.ONPREMISE===d.getPlatformId())&&t.tableView.collectionViewEvents.publish({event:"xsourcing-collectionview-enable-toolbar-button",data:"deleteDocumentFromDB"});var n=t.getDocumentInfoData(event&&event.dsModel&&event.dsModel.activeNode?event.dsModel.activeNode:{options:e.selectedItems[e.selectedItems.length-1]});n.triptychWrapper=t.model.get("triptychWrapper"),n.mediator=t.model.get("mediator"),t.model.get("applicationChannel").publish({event:"xsourcing-collectionview-selected-object-id",data:{selectedObject:n,fromInfoPanel:t.model.get("fromInfoPanel")}})}}else t.tableView.collectionViewEvents.publish({event:"xsourcing-collectionview-disable-toolbar-button",data:"deleteDocument"}),(t.model.get("enableDelete")||m.ONPREMISE===d.getPlatformId())&&t.tableView.collectionViewEvents.publish({event:"xsourcing-collectionview-disable-toolbar-button",data:"deleteDocumentFromDB"}),t.tableView.collectionViewEvents.publish({event:"xsourcing-collectionview-disable-toolbar-button",data:"downloadDocument"}),t.model.get("applicationChannel").publish({event:"xsourcing-collectionview-unselected-object-id",data:{selectedObject:null,isDocumentView:!0}})}),t.model.get("applicationChannel").subscribe({event:"destroy-document-view"},function(){t.onDestroy()}),t.modelEvent.subscribe({event:"add-model"},function(){t.loadData(),n.unmask(widget.body)}),s.addResizeListener(this.outerDiv,function(){t.update()},0),this.container},getDownloader:function(){return this.multidocdownloaderFrame.isInjected()||this.multidocdownloaderFrame.inject(document.body),this.multidocdownloaderForm.isInjected()||this.multidocdownloaderForm.inject(document.body),this.multidocdownloaderForm.empty(),e.createElement("input",{name:"attachment",value:"true"}).inject(this.multidocdownloaderForm),this.multidocdownloaderForm},onDestroy:function(){return this.canvas&&delete this.canvas,this._parent.apply(this,arguments)},launchFileChooser:function(e,t){var n=this.getFileInput(t);n.addEventListener("change",function(t){t.preventDefault(),t.stopImmediatePropagation();var i=t.target.files.length>0?t.target.files:t.dataTransfer.files;n.removeEvent("change"),n.destroy(),e&&e(i)}),n.click()},getFileInput:function(t){var n=e.extendElement(widget.body).getElement("#fileExplorer");return n||(n=new e.createElement("input",{id:"fileExplorer",multiple:t?void 0:"multiple",type:"file",styles:{display:"none"}}).inject(widget.body),this.isTouchDevice()&&(n.accept="image/*;capture=camera")),n.removeEvents(),n},isTouchDevice:function(){return"ontouchstart"in document.documentElement},createDocument:function(e){var t=this,n="",i=c.getSecurityContext();if(m.ONPREMISE!==d.getPlatformId()){let o=t.model.get("source")?t.model.get("source"):m.SOURCE_SOURCING;n=d.getServiceURL(o),i=c.getSecurityContext(o),e.policy=t.model.get("source")===m.SERVICE_3DSPACE?m.POLICY_DOCUMENT_RELEASE:m.POLICY_SRC_DOCUMENT}return new Promise(function(o,s){var l={sticky:!1,allowUnsafeHTML:!1,subtitle:""},c={tenant:d.getPlatformId(),securityContext:t.model.get("securityContext")?t.model.get("securityContext"):i,additionalHeaders:{},tenantUrl:n,onFailure:function(e){s(e),w.app.jobs.finishJob(p,"failed"),l={level:"error",title:r.upload_failed,subtitle:e.internalError?e.internalError:e.error?e.error:e},window.notifs.addNotif(l)},onProgress:function(e){p.update(e)},onComplete:function(e){w.app.jobs.finishJob(p),e=e.data,o(e)}},u=e.title;e.fileInfo&&(u=e.fileInfo.file.name);var p={title:u,ui:!!e.fileInfo,process:function(){p.xhr=a.createDocument(e,c)}};w.app.jobs.addJob(p)})},processForDocumentData:function(e){var t=[],n=this,i=[];return new Promise(o=>{if(e&&e.forEach(function(e){i.push(n.getDocumentId(e))}),i.length>0){var a={"ds6w:status":[]},r=n.searchUtil.getSearchPayload(i,[m.DOCUMENT],[m.SOURCE_3DSPACE]);n.searchUtil.callFederatedSearch(r).then(function(i){e.forEach(function(e){var o=n.model.get("helper").getActualDataFromSearch(i,e.dataelements.Proxy_Id?e.dataelements.Proxy_Id:e.dataelements.physicalid?e.dataelements.physicalid:e.id);"TRUE"===e.dataelements.isSpecification&&(n.specificationExists=!0);var r={title:o["ds6w:label"]?o["ds6w:label"]:e.dataelements.title||e.dataelements.Title,tree:o["ds6w:label"]?o["ds6w:label"]:e.dataelements.title||e.dataelements.Title,name:o.name?o.name:e.dataelements.Name||e.dataelements.name,description:o["ds6w:description"]?o["ds6w:description"]:e.dataelements.description,id:e.dataelements.physicalid?e.dataelements.physicalid:e.id,revision:o["ds6wg:revision"]?o["ds6wg:revision"]:e.dataelements.revision,state:o["ds6w:what/ds6w:status"]?o["ds6w:what/ds6w:status"]:e.dataelements.stateDisplay?e.dataelements.stateDisplay:e.dataelements.stateNLS,modified:o["ds6w:when/ds6w:modified"]?o["ds6w:when/ds6w:modified"]:e.dataelements.modified,created:o["ds6w:when/ds6w:created"]?o["ds6w:when/ds6w:created"]:e.dataelements.originated,owner:n.getOwnerName(o,e),ownerIdentifier:o.owner?o.owner:e.dataelements.Owner,type:o["ds6w:what/ds6w:type"]?o["ds6w:what/ds6w:type"]:e.dataelements.type||e.type,modifyAccess:e.dataelements.modifyAccess,deleteAccess:e.dataelements.deleteAccess?e.dataelements.deleteAccess:e.dataelements.hasDeleteAccess,image:o.preview_url?o.preview_url:e.dataelements.image?e.dataelements.image:"ENOXSourcingUXInfra/assets/icons/32/I_CDM_Document108x144.png",isSpecification:e.dataelements.isSpecification,source:e.dataelements.Proxy_Service?e.dataelements.Proxy_Service:e.type!==m.DOCUMENT_PROXY?m.SERVICE_3DSPACE:m.SOURCE_SOURCING,service:e.dataelements.Proxy_Service?e.dataelements.Proxy_Service===m.SOURCE_3DSPACE?m.SERVICE_3DSPACE:e.dataelements.Proxy_Service:e.type!==m.DOCUMENT_PROXY?m.SERVICE_3DSPACE:m.SOURCE_SOURCING,actualId:o.physicalid?o.physicalid:e.id,actualType:m.DOCUMENT};a["ds6w:status"].push(r.state);var s={grid:r,label:r.title,subLabel:r.state,thumbnail:require.toUrl(r.image),description:r.description,id:r.id};t.push(s)}),a["ds6w:status"]=[...new Set(a["ds6w:status"])],n.searchUtil.getNlsOfPropertiesValues(a).then(function(e){t.forEach(t=>{t.grid.state=e["ds6w:status"][t.grid.state]?e["ds6w:status"][t.grid.state]:t.grid.state})}).finally(function(){o(t)})})}else o(t)})},launchA3DSearch:function(e){var t={typeSearch:m.DOCUMENT,excludeCondition:m.EXCLUDE_OBSOLETE,multiSel:!0,callbackMethod:function(t){t.purpose=e,w.model.get("processForObject")?t.map(function(e){w.model.get("processForObject")([e])}):t.map(function(e){w.connectDocumentToParent(e.id)})}};(new l).init(t)},downloadDocument:function(t){var i=this;return new Promise(function(o,s){var l=d.getServiceURL(m.SERVICE_3DSPACE),u=c.getSecurityContext(),p={sticky:!1,allowUnsafeHTML:!1,subtitle:""};let h=`${i.model.get("parentOptions").data.respParams.title?i.model.get("parentOptions").data.respParams.title:i.model.get("parentOptions").data.respParams.qualtitle} (${i.model.get("parentOptions").data.respParams.revision}).zip`;var f={asZip:!0,autoDownload:!0,additionalURLParams:1===t.length?"useDOCMParamSettings=true":`useDOCMParamSettings=true&zipName=${h}`,tenant:d.getPlatformId(),securityContext:u,additionalHeaders:{},tenantUrl:l,onFailure:function(e){p={level:"error",title:r.download_failed,subtitle:i.processErrorMessage(e)},window.notifs.addNotif(p),n.unmask(widget.body),s(e)},onProgress:function(){n.mask(widget.body,r.downloading_document)},onComplete:function(t){e.is(t,"array")?t.forEach(function(t){if(t.downloadUrl){var n=new URL(t.downloadUrl),o=i.getDownloader();for(var a of n.searchParams)e.createElement("input",{name:a[0],value:a[1]}).inject(o);n.search="",o.action=n.href,o.submit(),p={level:"info",title:r.download_has_started}}else p={level:"error",title:r.download_not_initiated};window.notifs.addNotif(p)}):(p={level:"info",title:r.download_initiated},window.notifs.addNotif(p)),n.unmask(widget.body),o(t)}};1===t.length?a.downloadDocument(t[0],void 0,!1,f):a.downloadDocuments(t,f)})},processErrorMessage:function(e){var t="Operation failed";return e.internalError?t=e.internalError:e.error?t=e.error:e.data&&e.data.length>0&&(t=e.data[0].updateMessage),t},loadData:function(){var e=this,t=e.model.get("contextObject");e.container&&e.container.parentElement&&n.mask(e.container.parentElement,r.loading_document),t.getDocuments(e.model.get("parentOptions")).then(function(t){e.processForDocumentData(t.data).then(function(t){e.tableView._setData(t),e.tableView._xsourcingCollectionViewUI._allData=t,e.container&&e.container.parentElement&&(n.unmask(e.container.parentElement),n.unmask(e.container))})})},detachDocument:function(e){if(this.model.get("detachDocument"))this.model.get("detachDocument")(e);else{var t=(o=this).model.get("contextObject"),i={sticky:!1,allowUnsafeHTML:!1,subtitle:""};if(!t.detachDocument){var o=w,s="",l=c.getSecurityContext();if(m.ONPREMISE!==d.getPlatformId()){let e=o.model.get("source")?o.model.get("source"):m.SOURCE_SOURCING;s=d.getServiceURL(e),l=c.getSecurityContext(e)}return new Promise(function(c,u){var p={relInfo:{parentId:w.model.get("parentOptions").id,parentRelName:w.model.get("relationship"),parentDirection:"from"},tenant:d.getPlatformId(),securityContext:o.model.get("securityContext")?o.model.get("securityContext"):l,additionalHeaders:{},tenantUrl:s,onFailure:function(e){u(e),i={level:"error",title:r.remove_failed,subtitle:e.internalError?e.internalError:e.error?e.error:e},window.notifs.addNotif(i),n.unmask(widget.body)},onComplete:function(n){n=n.data,c(n);var a=o.model.get("parentOptions");a.data.params.documentId=e.id,t.getDocuments(a).then(function(){w.loadData()}),i={level:"success",title:r.document_removed_successfully},window.notifs.addNotif(i)}};a.disconnectDocumentFromParent(e.id,p)})}var u=o.model.get("parentOptions");u.data.params.documentId=e.id,t.detachDocument(u).then(function(){"TRUE"===e.isSpecification&&delete o.specificationExists,t.getDocuments(u).then(function(){o.loadData()}),i={level:"success",title:r.document_removed_successfully},window.notifs.addNotif(i),n.unmask(widget.body)},function(e){i={level:"error",title:r.remove_failed,subtitle:e.internalError?e.internalError:e.error?e.error:e},window.notifs.addNotif(i),n.unmask(widget.body)}),n.unmask(widget.body)}},pupulateToolbarMenus:function(){var e=this,t=[];return e.model.get("isSpecification")&&e.model.get("isSpecification")&&(t.push({text:r.document_as_specification,className:"header"}),t.push({id:"UploadSpecification",text:r.upload,icon:o.getWebappsAssetUrl("ENOXSourcingUXInfra","icons/32/AddDocument-22.png"),handler:function(t,n){e.toolbarCommandsCallback(t,n)}}),t.push({id:"AddExisitingSpecification",text:r.add_existing,icon:o.getWebappsAssetUrl("ENOXSourcingUXInfra","icons/32/I_CatalogAddPLMItemCBPRef.png"),handler:function(t,n){e.toolbarCommandsCallback(t,n)}})),t.push({text:r.document_as_reference,className:"header"},{id:"UploadReference",text:r.upload,icon:o.getWebappsAssetUrl("ENOXSourcingUXInfra","icons/32/AddDocument-22.png"),className:"OnPremise"===d.getPlatformId()||e.model.get("isReferencial")?"":"cloudDisable",handler:function(t,n){e.toolbarCommandsCallback(t,n)}},{id:"AddExisitingReference",text:r.add_existing,icon:o.getWebappsAssetUrl("ENOXSourcingUXInfra","icons/32/I_CatalogAddPLMItemCBPRef.png"),handler:function(t,n){e.toolbarCommandsCallback(t,n)}}),t},externalFilesHanlder:function(e,t){if(e)for(var n=0;n<e.length;n++){const o=e[n];if(this.validateUploadFile(o.name)){var i={title:o.name||"unNamed",fileInfo:{comments:"",file:o}};this.createDocument(i).then(function(e){e.purpose=t||"",w.model.get("processForObject")?w.model.get("processForObject")(e):w.connectDocumentToParent(e.id?e.id:e[0].id)})}}},toolbarCommandsCallback:function(e,t){var i=this,o="";E=!1;var a=!1,s={sticky:!1,allowUnsafeHTML:!1,subtitle:"",level:"info",title:r.specification_document_already_exists};if("UploadSpecification"===t.id){if(o="specification",E=!0,i.specificationExists)return window.notifs.addNotif(s),void n.unmask(widget.body)}else if("UploadReference"===t.id)o="reference",E=!0;else if("AddExisitingSpecification"===t.id){if(o="specification",a=!0,i.specificationExists)return window.notifs.addNotif(s),void n.unmask(widget.body)}else"AddExisitingReference"===t.id&&(o="reference",a=!0);E&&i.launchFileChooser(e=>i.externalFilesHanlder(e,o)),a&&i.launchA3DSearch(o)},validateUploadFile:function(e){if(!["php5","pht","phtml","shtml","asa","cer","asax","swf","xap"].includes(e.split(".")[1].toLowerCase()))return!0;let t={sticky:!1,allowUnsafeHTML:!1,subtitle:"",level:"error",title:e.split(".")[1]+" "+r.file_extension_invalid};return window.notifs.addNotif(t),n.unmask(widget.body),!1},getDocumentInfoData:function(e){var t=new p({timePickerFlag:!0,type:"datetime",value:new Date(e.options.grid.modified)}),n=new p({timePickerFlag:!0,type:"datetime",value:new Date(e.options.grid.created)});return{fields:[{disable:!0,label:r.TYPE,placeholder:r.TYPE,type:"labelValue",icon:require.toUrl("ENOXComponentQualification/assets/icons/22/Qualification-22.png"),value:r.document},{disable:!0,label:r.name,placeholder:r.name,type:"labelValue",value:e.options.grid.name},{disable:!0,label:r.description,placeholder:r.description,type:"labelValue",value:e.options.grid.description},{disable:!0,label:r.revision,placeholder:r.revision,type:"labelValue",value:e.options.grid.revision},{disable:!0,label:r.title,placeholder:r.title,type:"labelValue",value:e.options.grid.title},{disable:!0,label:r.owner_document,placeholder:r.owner_document,type:"labelValue",value:e.options.grid.owner},{disable:!0,label:r.originated,placeholder:r.originated,type:"labelValue",value:n.elements.inputField.value},{disable:!0,label:r.modified,placeholder:r.modified,type:"labelValue",value:t.elements.inputField.value}],objectData:{attributes:[{name:r.name,value:e.options.grid.title},{name:r.originated,value:n.elements.inputField.value},{name:r.owner_document,value:e.options.grid.owner}],image:e.options.grid.image,name:e.options.grid.title}}},deleteDocument:function(e){var t=this;return new Promise(function(i,o){var s=d.getServiceURL(m.SERVICE_3DSPACE),l=c.getSecurityContext();m.ONPREMISE!==d.getPlatformId()&&(s=d.getServiceURL(e.service),l=c.getSecurityContext(e.service));var u={sticky:!1,allowUnsafeHTML:!1,subtitle:""},p={tenant:d.getPlatformId(),securityContext:l,additionalHeaders:{},tenantUrl:s,onFailure:function(e){u={level:"error",title:r.deletion_failed,subtitle:t.processErrorMessage(e)},window.notifs.addNotif(u),n.unmask(widget.body),o(e)},onProgress:function(){n.mask(widget.body,r.deleting_document)},onComplete:function(e){u={level:"success",title:r.document_deleted_successfully},window.notifs.addNotif(u),e=e.data,i(e)}};a.deleteDocument(e.id,p)})},connectDocumentToParent:function(e){var t=w,i="",o=c.getSecurityContext();if(m.ONPREMISE!==d.getPlatformId()){let e=t.model.get("source")?t.model.get("source"):m.SOURCE_SOURCING;i=d.getServiceURL(e),o=c.getSecurityContext(e)}return new Promise(function(s,l){var c={sticky:!1,allowUnsafeHTML:!1,subtitle:""},u={relInfo:{parentId:w.model.get("parentOptions").id,parentRelName:w.model.get("relationship"),parentDirection:"from"},tenant:d.getPlatformId(),securityContext:t.model.get("securityContext")?t.model.get("securityContext"):o,additionalHeaders:{},tenantUrl:i,onFailure:function(e){l(e),c={level:"error",title:r.upload_failed,subtitle:e.error?e.error:e.internalError?e.internalError:e},window.notifs.addNotif(c),n.unmask(widget.body)},onProgress:function(){n.mask(widget.body,r.uploading_document)},onComplete:function(e){e=e.data,t.model.get("modelEvent")&&(t.model.get("modelEvent").publish({event:"add-model",data:e}),c=E?{level:"success",title:r.document_uploaded_successfully}:{level:"success",title:r.document_added_successfully},window.notifs.addNotif(c),n.unmask(widget.body)),s(e)}};a.connectDocumentToParent(e,u)})},addDroppedObj:function(e){let t=this,n=[];e.map(e=>{e.sourceid=`${e.serviceId}:${e.envId}`,e.id=e.objectId,e["ds6w:label"]=e.displayName,e.type=e.objectType});let i=[];e.forEach(e=>{const o=new Promise(i=>{t.model.get("controller").gettypeshierarchy([e.type]).then(function(o){let a=o.types_hierarchies[0].hierarchy,r=[m.DOCUMENT],s=t.model.get("controller").helper.getTypeFromTypeHierarchy(a,e.type,r);r.includes(s)&&n.push(e),i()}).catch(function(){let e={sticky:!1,allowUnsafeHTML:!1,subtitle:"",level:"error",title:r.internal_server_error};window.notifs.addNotif(e)})});i.push(o)}),Promise.all(i).then(function(){let t={sticky:!1,allowUnsafeHTML:!1,subtitle:"",level:"error",title:r.invalid_object_dropped};n.length>0&&n.map(function(e){w.model.get("processForObject")?w.model.get("processForObject")([e]):w.connectDocumentToParent(e.id)}),n.length!==e.length&&window.notifs.addNotif(t)})},getDocumentId:function(e){return e.dataelements.Proxy_Id?e.dataelements.Proxy_Id:e.dataelements.physicalid?e.dataelements.physicalid:e.id},getOwnerName:function(e,t){var n={};return t.relateddata&&t.relateddata.ownerInfo&&t.relateddata.ownerInfo[0]&&(n=t.relateddata.ownerInfo[0]),e["ds6w:who/ds6w:responsible"]?e["ds6w:who/ds6w:responsible"]:n&&n.dataelements?n.dataelements.firstname+" "+n.dataelements.lastname:t.dataelements.Owner||t.dataelements.owner},getDefaultContexualMenu:function(e,t){var i=this,o=t.options.grid;e.push({id:"download",type:"PushItem",title:r.downLoad,icon:"download",action:{callback:function(){var e=o;n.mask(widget.body,r.downloading_document),i.downloadDocument([e.actualId]).then(function(){n.unmask(widget.body)})}}}),!0!==i.model.get("blockActions")&&i.isUpdateEnabled()&&(e.push({type:"SeparatorItem"}),e.push({id:"remove",type:"PushItem",title:r.remove,icon:"remove",action:{callback:function(){let e=t.options.grid;new u({renderTo:widget.body,okButtonText:r.remove}).confirm(r.remove_confirmation,r.remove+" - "+e.title,function(t){t&&i.detachDocument(e)})}}})),"TRUE"===o.deleteAccess&&(i.model.get("enableDelete")||"OnPremise"===d.getPlatformId()&&i.isUpdateEnabled())&&e.push({id:"delete",type:"PushItem",title:r.delete,icon:"trash",action:{callback:function(){var e=o;window.odtData&&(window.odtData=t,window.odtRef=i),new u({renderTo:widget.body,okButtonText:r.delete}).confirm(r.delete_confirmation,r.delete+" - "+e.title,function(t){t&&i.deleteDocument({id:e.actualId,source:e.source,service:e.service}).then(function(){i.loadData(),n.unmask(widget.body)})})}}}),e.push({type:"SeparatorItem"})},launchPreview:function(){let t=new g({app:{widget:widget},width:"98%",draggable:!0,resizable:!0,escapeToClose:!0,onHideCB:()=>t.destroy(),classNames:"document-preview-modal"}).getModal();t.show();let n=this._selectedRow&&this._selectedRow.title?this._selectedRow.title:r.preview;t.setHeader(n),this.canvas=e.createElement("div",{class:"viewer-canvas"}),this.canvas.inject(t.getBody());let i={asset:{provider:"EV6",dtype:m.DOCUMENTS,serverurl:d.getServiceURL(m.SERVICE_3DSPACE),tenant:d.getPlatformId(),contextId:c.getSecurityContext()},physicalId:this._selectedRow?this._selectedRow.actualId:"",renderTo:this.canvas,docId:this._selectedRow?this._selectedRow.actualId:""};i.asset.physicalid=i.physicalId,i.renderTo.empty(),i.renderTo.setAttribute("fileName",i.fileName);let a={input:{asset:i.asset},options:{loading:"autoplay"}},s=e.createElement("iframe").inject(i.renderTo);s.style.position="absolute",s.style.width="100%",s.style.height="100%",s.style.border="0px",s.style.top="30px",s.style.left="0px",s.allowFullScreen=s.mozAllowFullScreen=s.webkitAllowFullScreen=!0,s.setAttribute("allowFullScreen",""),s.addEventListener("load",function(e){try{e.target.contentDocument.getElementById("canvas-div").style.backgroundColor="white"}catch(e){let t={sticky:!1,allowUnsafeHTML:!1,level:"error",title:e,subtitle:""};window.notifs.addNotif(t)}});let l=o.getProxifiedWebappsBaseUrl();l||(l=o.getWebappsBaseUrl()),s.src=l+"/3DPlayHelper/3DPlaySyndication.html?params="+encodeURI(JSON.stringify(a))}})}),define("DS/ENOXSourcingUXInfra/ObjectHistory/views/Row",["UWA/Class/Promise","UWA/Class/View","UWA/Core","DS/UIKIT/Tooltip","DS/ENOXSourcingUXInfra/CommonUtils/CommonUtils","css!DS/ENOXSourcingUXInfra/ObjectHistory/SourcingTimeline.css","css!DS/ENOXSourcingUXInfra/ObjectHistory/views/Row.css"],function(e,t,n,i,o){"use strict";return t.extend({name:"DS/ENOXSourcingUXInfra/ObjectHistory/views/Row",tagName:"div",className:"timeline-row",_logger:null,parent:null,isSubRow:!1,data:{},subRows:[],elements:{icon:null,expander:null,panel:null},isExpanded:!1,_isSubRowsRendered:!1,_tooltips:[],setup:function(e){return this.container.set("id","row_"+this.model.get("id")),this.parent=e.parent,this.isSubRow=!0===e.isSubRow,this.data={},this.subRows=[],this.elements={icon:null,expander:null,panel:null},this.isExpanded=!1,this._isSubRowsRendered=!1,this._tooltips=[],this},render:function(){var e,t,a,r=this,s=o.getUserImageElement(r.model.get("author"));r.elements.userImage=e=n.createElement("div",{class:"timeline-row-header-user-image",html:s}),r.elements.header=t=n.createElement("div",{class:"timeline-row-header",html:[n.createElement("span",{class:"timeline-row-header-user",html:[n.createElement("span",{class:"timeline-row-header-user-name",html:o.escapeHtml(r.model.get("author").fullName)})]}),n.createElement("span",{class:"timeline-row-header-date",html:r.model.get("date")})]});var l=r.model.get("isDummyRow")?[""]:[e,t,n.createElement("div",{class:"panel-body",html:r.model.get("content")}),""];return r.elements.panel=a=n.createElement("div",{class:"timeline-panel timeline-content",html:l}),r.container.setContent([{html:[a]}]),n.Element.getElements.call(r.container,".timeline-operations-tooltip").forEach(function(e){r._tooltips.push(new i({position:"top",target:e,body:'<ul class="mod-Panel" >'+e.dataset.list+"</ul>",trigger:"touch"}))}),r._fetchContentData(),r},_fetchContentData:function(){}})}),define("DS/ENOXSourcingUXInfra/TypeAHead/ENOXTypeaheadWithSearch",["UWA/Utils","DS/WUXAutoComplete/AutoComplete","DS/UIKIT/Input/Text","DS/UIKIT/Input/Button","DS/ENOXSourcingUXInfra/Search/ENOXSourcingSearch","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/ENOXSourcingUXInfra/Search/SearchUtility","DS/ENOXSourcingUXInfra/Constants/ENOXSourcingConstants","i18n!DS/ENOXSourcingUXInfra/assets/nls/ENOXSourcingUXInfra","DS/UIKIT/Mask","DS/ENOXSourcingUXInfra/xsourcingformview/ENOXSourcingFormValidations","DS/ENOXSourcingUXInfra/DocumentView/DocumentView","DS/ENOXSourcingUXInfra/components/MemberInfoProvider/MemberInfoProvider","DS/TreeModel/BaseFilter"],function(e,t,n,i,o,a,r,s,l,c,d,u,p,m,h){"use strict";var f=function(){};return f.prototype.createField=function(e){return this.searchUtil=new s,this.memberInfoProvider=new m,this.options=e,this.FormValidation=new u,this.initComponents(e)},f.prototype.initComponents=function(e){if(this.autocompleteField=new t(this.setAutocompleteOptions(e)),(Array.isArray(e.selectedItems)&&e.selectedItems.length>0||!Array.isArray(e.selectedItems)&&e.selectedItems)&&(this.autocompleteField.selectedItems=e.selectedItems?e.selectedItems:[],this.valueSelectionCallback(this)),this.searchButton=new i({icon:"search",name:"search_"+e.name}),e.multiSelect){let e="multiSelectAutocomplete";e+=this.isTouchView()?"_Touch":"_NonTouch",this.searchButton.elements.container.addClassName(e),this.autocompleteField.elements.container.querySelector("input").addClassName("input-sm")}return e.enableUpload&&(this.uploadButton=new i({icon:"upload",name:"upload_"+e.name})),this.handleEvents(),this.validateValue(),this.wrapComponents()},f.prototype.handleEvents=function(){this.handleChangeEvent(),this.handleKeyEvents(),this.handleLostFocusForEditor(),this.handleButtonClickEvent(),this.uploadButton&&this.handleUploadButtonClickEvent()},f.prototype.handleChangeEvent=function(){var e=this;e.autocompleteField.addEventListener("change",async()=>{e.valueSelectionCallback(e),e.FormValidation.wuxAutoCompleteValidation([e.autocompleteField])})},f.prototype.handleKeyEvents=function(){var e=this;e.getInputField().onkeyup=function(){e._enteredText=e.autocompleteField._editor.valueToCommit}},f.prototype.handleLostFocusForEditor=function(){var e=this;e.autocompleteField._editor.addEventListener("blur",function(){void 0===e.autocompleteField.selectedItems&&void 0!==e._enteredText?e.getInputField().value=e._enteredText:void 0===e.autocompleteField.selectedItems||Array.isArray(e.autocompleteField.selectedItems)||(e.getInputField().value=e.autocompleteField.selectedItems.getLabel())})},f.prototype.handleButtonClickEvent=function(){this.searchButton.addEvent("onClick",this.invokeSearch.bind(this)),this.searchButton.addEvent("touchstart",this.invokeSearch.bind(this))},f.prototype.handleUploadButtonClickEvent=function(){this.uploadButton.addEvent("onClick",this.launchFileChooser.bind(this)),this.uploadButton.addEvent("touchstart",this.launchFileChooser.bind(this))},f.prototype.invokeSearch=async function(){var t=this;if(t.options.chooserCallback&&t.options.allowChooserCallback&&t.options.allowChooserCallback()){var i=t.options.enableFreeText,a={id:"input-"+e.getUUID().substring(0,6),placeholder:!1,events:{onKeyDown:function(e){e.target.parentElement.nextElementSibling.firstElementChild.focus()}}};i&&(a.events={});var r=new n(UWA.merge(t.options,a)),s=UWA.createElement("div",{html:[r],styles:{position:"relative",width:"100%","pointer-events":"none"}});return i&&(s.style["pointer-events"]=""),void t.options.chooserCallback(t.options.form,r)}var c=t.getSuggestedObjectsPayloadForSearch(t.options.nresults);let d=t.options.multiSelect&&t.autocompleteField.selectedItems?t.autocompleteField.selectedItems.map(e=>e._options.resourceid?e._options.resourceid:e._options.id):[];d=0===d.length&&t.options.resourceid_not_in?t.options.resourceid_not_in:d,""===t.getInputField().value||"***"===t.getInputField().value||t.autocompleteField.selectedItems||(t.options.isPersonOrGroup?(c.specific_source_parameter[l.SOURCE_3DSPACE]={additional_query:l.AND+"([ds6w:label]:(*"+t.getInputField().value+"*)"+l.OR+"[ds6w:identifier]:(*"+t.getInputField().value+"*))"},c.tenant!==l.ONPREMISE&&(c.specific_source_parameter[l.SOURCE_USERGROUPS]={additional_query:l.AND+"[ds6w:label]:(*"+t.getInputField().value+"*)"})):c.tenant===l.ONPREMISE?c.specific_source_parameter[l.SOURCE_3DSPACE]=t.options.excludeSpecificSourceParameter?{}:{additional_query:l.AND+"([ds6w:label]:(*"+t.getInputField().value+"*)"+l.OR+"[ds6w:identifier]:(*"+t.getInputField().value+"*))"}:!t.options.excludeSpecificSourceParameter&&t.options.sources.map(e=>{c.specific_source_parameter[e]={additional_query:l.AND+"([ds6w:label]:(*"+t.getInputField().value+"*)"+l.OR+"[ds6w:identifier]:(*"+t.getInputField().value+"*))"}})),t.options.extraQuery&&await t.options.extraQuery.then(e=>{e.length>0?(c.specific_source_parameter[l.SOURCE_3DSPACE]||(c.specific_source_parameter[l.SOURCE_3DSPACE]={search_in_context:{}}),c.specific_source_parameter[l.SOURCE_3DSPACE].search_in_context={expand:{multi_root_physicalid:e,expand_iter:"-1",type_filter_rel:["Subclass","General Class"]}},c.specific_source_parameter[l.SOURCE_3DSPACE].option={with_Idx_Search:!0}):c.query='flattenedtaxonomies:"types/"'});var u={completePreCond:c.query,resourceid_in:c.resourceid_in,specific_source_parameter:c.specific_source_parameter,multiSel:!!t.options.multiSelect&&t.options.multiSelect,predicates:t.options.predicates?t.options.predicates:[],resourceid_not_in:d,callbackMethod:function(e){t.setSelectedValue(e)},isTypeAheadSearch:!0};(new o).init(u)},f.prototype.launchFileChooser=function(){var e=this,t=this.getDocumentViewInstance();t.launchFileChooser(function(n){n&&e.uploadDocument(n,t)},"single")},f.prototype.getDocumentViewInstance=function(){var e=new UWA.Class.Model({isSpecification:!1,isReferencial:!0,relationship:l.REFERENCE_DOCUMENT,source:l.SERVICE_3DSPACE});return new p({model:e})},f.prototype.uploadDocument=function(e){for(var t=this,n=this.getDocumentViewInstance(),i=0;i<e.length;i++){const a=e[i];if(n.validateUploadFile(a.name)){var o={title:a.name||"unNamed",fileInfo:{comments:"",file:a}};d.mask(t.getWrapperDiv(),c.uploading_document),n.createDocument(o).then(function(e){t.setUploadedValue(e),t.valueSelectionCallback(t),d.unmask(t.getWrapperDiv()),d.unmask(widget.body)}).catch(function(){d.unmask(widget.body),d.unmask(t.getWrapperDiv())})}}},f.prototype.setModelFilterCB=function(e){this.autocompleteField.filterCB=function(t){e.setFilterModel({value:{filterId:"customFilterID",filterModel:{condition1:{type:"contains",filter:t}}}})}},f.prototype.registerCustomModelFilter=function(e,t){var n=this,i=h.inherit({publishedProperties:{},isDataFiltered:function(e){var i=e.getAttributeValue("name")?e.getAttributeValue("name"):e.getAttributeValue("ds6w:identifier"),o=e.getAttributeValue("label"),a=[];if(t&&t.forEach(t=>{e.getAttributeValue(t)&&a.push(e.getAttributeValue(t).toLowerCase())}),i&&o&&this.filterModel&&this.filterModel.condition1&&this.filterModel.condition1.filter){var r=this.filterModel.condition1.filter.toLowerCase();return!("***"===r||(n.options.isPersonOrGroup?i.toLowerCase().indexOf(r)>-1||o.toLowerCase().indexOf(r)>-1:i.toLowerCase().includes(r.toLowerCase())||o.toLowerCase().includes(r.toLowerCase())||a.filter(e=>e.includes(r.toLowerCase())).length>0))}return!1},isEmpty:function(){return void 0===this.filterModel.condition1}});e.getFilterManager().registerFilter("customFilterID",i)},f.prototype.validateValue=function(){(this.options.uniqueIdentifier?this.options.uniqueIdentifier:this.options.identifier)&&this.options.valueValidator&&this.options.valueValidator(this,this.options)},f.prototype.setSelectedValue=function(e){var t=this,n=e[0];if(n)if(e.length>1){var i=[];e.forEach(function(e){let n=e["ds6w:label_value"]?e["ds6w:label_value"]:e["ds6w:label"]+(t.options.showRevisionWithLabel&&e["ds6wg:revision"]?" ("+e["ds6wg:revision"]+")":""),o=t.createNode({"ds6w:label":n,label:n,value:e.resourceid_value?e.resourceid_value:e.resourceid,resourceid:e.resourceid_value?e.resourceid_value:e.resourceid,...e});i.push(o)}),t.autocompleteField.selectedItems&&t.options.multiSelect?t.autocompleteField.selectedItems=[...t.autocompleteField.selectedItems,...i]:t.autocompleteField.selectedItems=i}else{let e=n.resourceid_value?n.resourceid_value:n.resourceid,i=n["ds6w:label_value"]?n["ds6w:label_value"]:n["ds6w:label"]+(t.options.showRevisionWithLabel&&n["ds6wg:revision"]?" ("+n["ds6wg:revision"]+")":""),o=t.createNode({"ds6w:label":i,label:i,value:e,resourceid:e,...n});t.autocompleteField.selectedItems&&t.options.multiSelect?t.autocompleteField.selectedItems=[...t.autocompleteField.selectedItems,o]:t.autocompleteField.selectedItems=o}},f.prototype.setUploadedValue=function(e){let t=this.createModel(e);this.autocompleteField.selectedItems=t.getRoots()},f.prototype.setDroppedValue=function(e){let t=this.createModel(e);this.autocompleteField.selectedItems&&this.options.multiSelect?this.autocompleteField.selectedItems.some(e=>e._options.resourceid===t.getRoots()[0]._options.resourceid)||(this.autocompleteField.selectedItems=[...this.autocompleteField.selectedItems,...t.getRoots()]):this.autocompleteField.selectedItems=t.getRoots()},f.prototype.wrapComponents=function(){let t=UWA.createElement("div",{html:[this.autocompleteField],styles:{position:"relative",width:"100%"}}),n=UWA.createElement("div",{html:[this.searchButton],styles:{position:"relative",float:"right"}}),i=UWA.createElement("div",{html:[this.uploadButton],styles:{position:"relative",float:"right"}});this.options.multiSelect||(n.setStyle("top","2.5px"),i.setStyle("top","2.5px")),this.setNameOnInputField(this.options.name);var o=[t];return this.options.searchButtonNotRequired||o.push(n),this.uploadButton&&o.push(i),UWA.createElement("div",{html:o,id:"input-"+e.getUUID().substring(0,6),styles:{position:"relative",width:"auto",display:"flex",direction:"row"}})},f.prototype.setNameOnInputField=function(e){this.autocompleteField.getContent().getElementsByTagName("input")[0].setAttribute("name",e)},f.prototype.getInputField=function(){return this.autocompleteField.getContent().getElementsByTagName("input")[0]},f.prototype.getWrapperDiv=function(){return this.autocompleteField.getContent().getParent()?this.autocompleteField.getContent().getParent().getParent():this.autocompleteField.getContent()},f.prototype.getSuggestedObjects=function(e,t,n){var i;if(this.options.elementsTree&&this.options.elementsTree.getRoots().length>0){var o=this.options.elementsTree;"***"!==e&&""!==e&&o.getRoots().map(function(t){t._options.label&&t._options.label.toLowerCase().contains(e.toLowerCase())||t._options.name&&t._options.name.toLowerCase().contains(e.toLowerCase())?t.show():t.hide()}),i=new UWA.Promise(function(e){e({elementsTree:o})})}else if(this.options.dataFetcherMethod)i=this.options.dataFetcherMethod(e,this);else{var a=this.getSuggestedObjectsPayloadForSearch(t);"***"===e||""===e||n&&a.tenant===l.ONPREMISE||(this.options.isPersonOrGroup?(a.specific_source_parameter[l.SOURCE_3DSPACE]={additional_query:l.AND+"([ds6w:label]:(*"+e+"*)"+l.OR+"[ds6w:identifier]:(*"+e+"*))"},a.tenant!==l.ONPREMISE&&(a.specific_source_parameter[l.SOURCE_USERGROUPS]={additional_query:l.AND+"([ds6w:label]:(*"+e+"*)"+l.OR+"[ds6w:identifier]:(*"+e+"*))"})):this.options.sources.map(t=>{let i="";n&&n.forEach(t=>{i+=l.OR+`[${t}]:(*${e}*)`}),a.specific_source_parameter[t]={additional_query:l.AND+"([ds6w:label]:(*"+e+"*)"+l.OR+"[ds6w:identifier]:(*"+e+"*)"+i+")"}})),i=this.searchUtil.callFederatedSearch(a)}return i},f.prototype.getSuggestedObjectsPayloadForSearch=function(e){var t={nresults:e||500,start:0,with_nls:!1,isPersonOrGroup:!!this.options.isPersonOrGroup&&this.options.isPersonOrGroup};this.options.excludeCondition&&(t.excludeCondition=this.options.excludeCondition),this.options.completePreCond&&(t.completePreCond=this.options.completePreCond),this.options.resourceid_not_in&&(t.resourceid_not_in=this.options.resourceid_not_in);let n=this.options.typeSearch?this.options.typeSearch:[],i=this.options.sources?this.options.sources:[],o=this.options.resourceid_in?this.options.resourceid_in:[];var a=this.searchUtil.getSearchPayload(o,n,i,t);return a.specific_source_parameter={},a},f.prototype.setAutocompleteOptions=function(e){var t=this;let n={placeholder:e.placeholder,name:e.name,minLengthBeforeSearch:3,multiSearchMode:!!e.multiSelect&&e.multiSelect,allowFreeInputFlag:!!e.freeTextAllowed&&e.freeTextAllowed,disabled:!!e.disable&&e.disable,touchMode:!e.disableTouchMode&&t.isTouchView(),typeDelayBeforeSearch:500,keepSearchResultsFlag:!1,elementsTree:async function(n){try{return await new Promise(async function(i){if(e.chooserCallback&&e.allowChooserCallback&&e.allowChooserCallback()){let o=await e.chooserCallback(t.options.form,{},n),a=o.elementsTree?o.elementsTree:t.createModel(o);t.registerCustomModelFilter(a),t.setModelFilterCB(a,e.filteringNotRequired),i(a)}else t.getSuggestedObjects(n,e.nresults,e.searchInfields,e.tenant).then(function(n){let o=t.searchUtil.processResults(n);if(e.tenant===l.ONPREMISE&&e.searchInfields)t.searchUtil.getPredicateValue(o).then(function(o){let a=n.elementsTree?n.elementsTree:t.createModel(o);t.registerCustomModelFilter(a,e.searchInfields),t.setModelFilterCB(a),i(a)});else{let a=n.elementsTree?n.elementsTree:t.createModel(o);t.registerCustomModelFilter(a,e.searchInfields),t.setModelFilterCB(a),i(a)}}).catch(function(){widget.notificationUtil.showError(c.error_getting_suggestions)})})}catch{widget.notificationUtil.showError(c.error_getting_suggestions)}}};return e.minLengthBeforeSearch&&"disable"===e.minLengthBeforeSearch&&delete n.minLengthBeforeSearch,e.typeDelayBeforeSearch&&"disable"===e.typeDelayBeforeSearch&&delete n.typeDelayBeforeSearch,e.keepSearchResultsFlag&&"disable"===e.keepSearchResultsFlag&&delete n.keepSearchResultsFlag,n},f.prototype.isTouchView=function(){return"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0},f.prototype.createModel=function(e){var t=this,n=t.preprocessForModelCreation(e),i=new a;return i.prepareUpdate(),n.map(function(e){let n=t.createNode(e);i.addRoot(n)}),i.pushUpdate(),i},f.prototype.createNode=function(e){e.grid=e;var t=new r(e);return this.options.isPersonOrGroup&&t.setIcons([this.memberInfoProvider.getProfilePicUrl(e["ds6w:what/ds6w:type"])]),t},f.prototype.preprocessForModelCreation=function(e){var t=this,n=[];return e.forEach(function(e){let i={};i=e.dataelements?t.extractDataFromUploadResponse(e):t.extractDataFromSearchResponse(e),n.push(i)}),n},f.prototype.getSelectedObjectAttrValue=function(e){let t=void 0;return this.autocompleteField.selectedItems&&!this.options.multiSelect&&(t=this.autocompleteField.selectedItems.options[e]),t},f.prototype.extractDataFromSearchResponse=function(e){var t=e["ds6w:what/ds6w:type"]?e["ds6w:what/ds6w:type"]:e["ds6w:type"];t&&t===l.TYPE_FOAF_GROUP&&(t=t.split(":")[1]);var n={identifier:e["ds6w:identifier"],label:e["ds6w:label"]+(this.options.showRevisionWithLabel&&e["ds6wg:revision"]?" ("+e["ds6wg:revision"]+")":""),value:e.resourceid_value?e.resourceid_value:e.resourceid,type:t};return UWA.merge(n,e),n},f.prototype.extractDataFromUploadResponse=function(e){var t=e.type,n={identifier:e.id,label:e.dataelements?e.dataelements.title:"",value:e.id,resourceid:e.id,type:t};return UWA.merge(n,e.dataelements),n},f.prototype.valueSelectionCallback=function(e){if(e.getSelectedObjectAttrValue("resourceid")){e.clearIdentifier(e);let t=e.getInputField();t.setAttribute("identifier",e.getSelectedObjectAttrValue("resourceid")),t.value=e.getSelectedObjectAttrValue("label")}e.options.callback&&e.options.callback(e),e.options.propertiesViewCB&&e.options.propertiesViewCB(e)},f.prototype.clearIdentifier=function(e){let t=e.getInputField();t.value="",t.setAttribute("identifier","")},f.prototype.getIdentifier=function(){let e=this.autocompleteField._editor._myInput.getAttribute("identifier");return e||""},f.prototype.onDropCallback=function(e){var t=this,n=Array.isArray(e)?e:[e];d.mask(t.getWrapperDiv(),c.fetching_details);let i=[...new Set(n.map(e=>e.serviceId))],o=[...new Set(n.map(e=>e.objectType))];var a=n.reduce(function(e,t){return e[t.objectType]=t.displayType,e},{});let r=n.map(e=>e.objectId);var s=t.searchUtil.getSearchPayload(r,o,i);t.searchUtil.callFederatedSearch(s).then(function(e){let n=t.searchUtil.processResults(e);n.length!==s.resourceid_in.length&&widget.notificationUtil.showError(c.not_found_not_indexed),n.map(function(e){var n=[];let i=a[e["ds6w:what/ds6w:type"]],o=(e["ds6w:what/ds6w:kind_value"]||e["ds6w:what/ds6w:kind"])===l.MEI_EXTENSION;var r=!0;(t.options.name===l.CONTEXT||t.options.name===l.TARGET)&&(r=!o),e&&t.options.typeSearch.includes(e["ds6w:what/ds6w:type"])&&r?e["ds6w:what/ds6w:status"]&&-1===e["ds6w:what/ds6w:status"].toLowerCase().indexOf(l.OBSOLETE.toLowerCase())||t.options.allowObsolete?(n.push(e),t.setDroppedValue(n)):widget.notificationUtil.showError(c.obsolete_not_supported_drop):e&&t.options.dropValidator&&r?t.options.dropValidator(e["ds6w:what/ds6w:type"]).then(function(o){o?(n.push(e),t.setDroppedValue(n)):widget.notificationUtil.showError('"'+i+'" '+c.unsupported_type)}):r?widget.notificationUtil.showError('"'+i+'" '+c.unsupported_type):widget.notificationUtil.showError(`"${i} ${c.unsupported_type_with_MEI}" ${c.unsupported_type}`)})}).finally(function(){d.unmask(t.getWrapperDiv())})},f}),define("DS/ENOXSourcingUXInfra/xsourcingformview/ENOXSourcingForm",["DS/UIKIT/Form","UWA/Utils","DS/UIKIT/Input/Text","DS/UIKIT/Input/Button","DS/UIKIT/Input/ButtonGroup","DS/UIKIT/Input/Number","DS/UIKIT/Input/Select","DS/UIKIT/Input/Toggle","DS/Controls/SpinBox","DS/ENOXSourcingUXInfra/xsourcingformview/ENOXSourcingFormHelpers","DS/Controls/DatePicker","DS/UIKIT/Input/File","DS/SNInfraUX/SearchCom","DS/Notifications/NotificationsManagerUXMessages","DS/Notifications/NotificationsManagerViewOnScreen","DS/ENOXSourcingUXInfra/xsourcingformview/ENOXSourcingFormValidations","i18n!DS/ENOXSourcingUXInfra/assets/nls/ENOXSourcingUXInfra","DS/ENOXSourcingUXInfra/TypeAHead/ENOXTypeaheadWithSearch","DS/ENOXSourcingUXInfra/service/ENOXSourcingService","DS/ENOXSourcingUXInfra/Constants/ENOXSourcingConstants","DS/Controls/Accordeon","css!DS/ENOXSourcingUXInfra/xsourcingformview/ENOXSourcingForm.css"],function(e,t,n,i,o,a,r,s,l,c,d,u,p,m,h,f,g,v,S,w,E){"use strict";var C;return e.extend({buttonGroups:null,defaultOptions:{className:"xSourcingForm form-vertical"},init:function(e){e&&(C=e.applicationChannel),this.notifs=m,window.notifs=this.notifs,h.setNotificationManager(this.notifs),this.FormValidations=new f,this.buttonGroups=[],this.wuxAutocompletes=[],this.getModelDiv=function(){let e;return e=this.elements.container.getParent()&&this.elements.container.getParent().getParent()&&this.elements.container.getParent().getParent().getParent()?this.elements.container.getParent().getParent().getParent().getParent():this.elements.container},this._parent(e),this.fields.subscribe()},fields:{text:function(e,i){var o,a,r=i,s={attributes:{autocorrect:"off",autocapitalize:"off"},id:"input-"+t.getUUID().substring(0,6)};return e.hasOwnProperty("autocomplete")?(e.attributes||(e.attributes={}),e.attributes.autocomplete=e.autocomplete):s.attributes.autocomplete="off",o=new n(UWA.extend(e,s,!0)),i.texts.push(o),o.addEvent("onChange",function(){r.dispatchEvent("onChange",[this.getName(),this.getValue(),e.onchange])}),UWA.is(e.label)&&(a=UWA.createElement("label",{for:o.getId(),text:UWA.i18n(e.label+r.options.labelSuffix)})),new Promise(function(e){e()}).then(function(){i.texts[0].focus(),document.querySelectorAll(".modal-body")[document.querySelectorAll(".modal-body").length-1]&&document.querySelectorAll(".modal-body")[document.querySelectorAll(".modal-body").length-1].querySelector(".form-group")&&document.querySelectorAll(".modal-body")[document.querySelectorAll(".modal-body").length-1].querySelector(".form-group").scrollIntoView()}),r.createField.call(r,o,a)},justLabel:function(e,n){var i,o=n,r={id:"input-"+t.getUUID().substring(0,6),placeholder:!1,hidden:!0},s=new a(UWA.merge(e,r)),l=UWA.createElement("div",{html:[s],class:"si_create_form_txt_wrapper_hide"}),c=UWA.createElement("div",{html:[l],id:"input-"+t.getUUID().substring(0,6),class:""});return s.addEvent("onChange",function(){o.dispatchEvent("onChange",[this.getName(),this.getValue(),e.onchange])}),UWA.is(e.label)&&(i=UWA.createElement("label",{class:"label-only",for:c.id,text:UWA.i18n(e.label+o.options.labelSuffix)})),o.createField.call(n,c,i)},searchWithChooser:function(e,o){var a,r=e.enableFreeText,s=o,l=e.hide||!1,c={id:"input-"+t.getUUID().substring(0,6),placeholder:!1,events:{onKeyDown:function(e){e.target.parentElement.nextElementSibling.firstElementChild.focus()}}};r&&(c.events={});var d=new n(UWA.merge(e,c)),u=UWA.createElement("div",{html:[d],styles:{position:"relative",width:"100%","pointer-events":"none"}});r&&(u.style["pointer-events"]="");var m={id:"input-"+t.getUUID().substring(0,6),placeholder:!1,multiple:!1,nativeSelect:!1},h=new i(UWA.merge({icon:"search",name:"search"},m)),f=UWA.createElement("div",{html:[h],styles:{position:"relative",float:"right",bottom:"-3px"}});h.addEvent("onClick",function(){if(e.chooserCallback&&e.allowChooserCallback&&e.allowChooserCallback())e.chooserCallback(s,d);else{var t,n=UWA.Utils.getUUID();if(s.is3DSearchActive=!0,!UWA.is(t)){t=p.createSocket({socket_id:n});var i="";e.typeSearch&&(i='flattenedtaxonomies:"types/'+e.typeSearch+'"'),e.typeSearch&&e.state&&(i='flattenedtaxonomies:"types/'+e.typeSearch+'" AND current:"'+e.state+'" AND latestrevision:"TRUE"');let s=[w.SOURCE_3DSPACE],l={};s.map(function(e){l[e]={SecurityContext:S.getSecurityContext(e)}});var o={title:e.label,role:"",mode:"furtive",default_with_precond:!0,precond:i,login:l,show_precond:!1,multiSel:!!e.multiSel&&e.multiSel,idcard_activated:!1,select_result_max_idcard:!1,itemViewClickHandler:"",app_socket_id:n,widget_id:n,search_delegation:"3dsearch",columns:e.predicates?e.predicates:[],default_search_criteria:"",tenant:widget.getValue("x3dPlatformId")?widget.getValue("x3dPlatformId"):"OnPremise"};e.objList&&(o.precond="physicalid=("+e.objList+")"),e.subType&&(o.precond='([ds6w:kind]:"'+e.subType+'")'),e.subType&&e.state&&(o.precond='([ds6w:kind]:"'+e.subType+'") AND current:"'+e.state+'"'),e.excludeCondition&&(o.precond+=" AND "+e.excludeCondition),e.completePreCond&&(o.precond=e.completePreCond),void 0!==widget.getPreference("collab-storage")&&(o.tenant=widget.getPreference("collab-storage").value);var a=[e.typeSearch];if(o.recent_search={types:a},o.app_socket_id=n,o.widget_id=n,!UWA.is(t))throw new Error("Socket not initialized");if(t.dispatchEvent("RegisterContext",o),t.addListener("Selected_Objects_search",function(t){if(!e.state||t[0]["ds6w:status_value"].split(".")[1].toLowerCase()===e.state){var n=widget.getElement('[name="'+e.name+'"]');n.value=t[0]["ds6w:label_value"],n.id=t[0].id,n.setAttribute("identifier",t[0]["ds6w:identifier"]);var i=document.createEvent("Event");i.page="searchRouteTemplate",i.initEvent("keydown",!0,!1),e.callback&&e.callback(t,n),n.dispatchEvent(i)}}),t.dispatchEvent("InContextSearch",o),window.odtSearch&&e.callback){var r=widget.getElement('[name="'+e.name+'"]');e.callback([{}],r)}}}});var g=UWA.createElement("div",{html:[u,f],id:"input-"+t.getUUID().substring(0,6),styles:{position:"relative",width:"auto",display:"flex",direction:"row"}});return o.numbers.push(d),o.lists.push(h),d.addEvent("onChange",function(){s.dispatchEvent("onChange",[this.getName(),this.getValue(),e.onchange])}),UWA.is(e.label)&&(a=UWA.createElement("label",{for:g.id,text:UWA.i18n(e.label+s.options.labelSuffix)})),s.createField.call(o,g,a,l)},buttonGroup:function(e,n){var i,a,r=n,s={id:"input-"+t.getUUID().substring(0,6)};return C&&(e.applicationChannel=C),e.events={onClick:function(e,t){t.isActive()||(this.getActive()[0].toggleActive(),t.toggleActive())}},(i=new o(UWA.merge(e,s))).buttons.forEach((t,i)=>{n.buttons.push(t);let o=function(){this.isActive()||n.dispatchEvent("onClick",[this.getName(),this.getValue(),c[e.buttons[i].action](e,n)])}.bind(t);t.events.container.click=o,t.handleEvents()}),n.buttonGroups.push(i),UWA.is(e.label)&&(a=UWA.createElement("label",{for:i.options.id,text:UWA.i18n(e.label+n.options.labelSuffix),styles:{paddingRight:"25px"}})),r.createField.call(n,i,a,!1)},toggleSwitch:function(e,n){var i=n,o={type:"switch",label:"",id:"input-"+t.getUUID().substring(0,6)},a=new s(o);a.addEvent("onChange",function(){i.dispatchEvent("onChange",[this.getName(),this.getValue(),e.onchange])}),e.checkFlag&&a.check();var r=UWA.createElement("div",{html:[a]}),l=UWA.createElement("div",{html:[r],id:"input-"+t.getUUID().substring(0,6),class:""});return i.createField.call(n,l,void 0)},buildTimeField:function(e,t){var n,i=t,o={};o.targetDatePicker=new d({label:"from",timePickerFlag:!0});var a=new Date,r=a.getMonth();a.setMonth(r+1),o.targetDatePicker.value=a;var s=UWA.createElement("div",{class:"xcity-label-input",id:"xSourcingTimeField-"+e.id,styles:{position:"relative",width:"auto","padding-bottom":"10px"},html:[o.targetDatePicker]});return UWA.is(e.label)&&(n=UWA.createElement("label",{class:"label-only",for:s.id,text:UWA.i18n(e.label+i.options.labelSuffix)})),i.createField.call(t,s,n)},buildFileField:function(e,n){var o,a,r,s=n,l={id:"input-"+t.getUUID().substring(0,6)};o=new u(UWA.extend(e,l,!0)),n.files.push(o),o.addEvent("onChange",function(){s.dispatchEvent("onChange",[this.getName(),this.getValue(),e.onchange])}),(UWA.is(e.label)||UWA.is(e.name))&&(a=UWA.createElement("label",{for:o.getId(),text:UWA.i18n((e.label||e.name)+s.options.labelSuffix)}));var c=new i(UWA.merge({value:"Clear",name:"Clear"},l)),d=UWA.createElement("div",{html:[c],styles:{position:"relative",float:"right",bottom:"0px"}});c.addEvent("onClick",function(){var e=arguments[0];e.target.getParent().previousSibling.firstChild.lastChild.value="",e.target.getParent().previousSibling.firstChild.id=""}),r=s.createField.call(n,o,a),o.elements.textfield.onfocus=function(){r.toggleClassName("focused",!0)},o.elements.textfield.onblur=function(){r.toggleClassName("focused",!1)};var p=UWA.createElement("div",{html:[o],styles:{position:"relative",width:"90%"}}),m=UWA.createElement("div",{html:[p,d],id:"input-"+t.getUUID().substring(0,6),styles:{position:"relative",width:"auto","padding-bottom":"10px",display:"flex",direction:"row"}});return s.createField.call(n,m,a)},concealableList:function(e,n){var i,o,a=n,s=e.hide||!1,l={id:"input-"+t.getUUID().substring(0,6),placeholder:!1,multiple:!1,nativeSelect:!1};return i=new r(UWA.merge(e,l)),n.lists.push(i),i.addEvent("onChange",function(){a.dispatchEvent("onChange",[this.getName(),this.getValue()[0],e.onchange])}),(UWA.is(e.label)||UWA.is(e.name))&&(o=UWA.createElement("label",{for:i.getId(),text:UWA.i18n((e.label||e.name)+a.options.labelSuffix)})),a.createField.call(n,i,o,s)},autocompleteWithSearch:function(e,t){var n,i=t;e.form=t;var o=!!e.hide&&e.hide,a=new v,r=a.createField(e),s=a.getInputField();if(s.addClassName("form-control form-control-root"),a.autocompleteField.addEventListener("change",function(){i.dispatchEvent("onChange"),e.events&&e.events.onChange&&e.events.onChange()}),e.id||e.identifier||e.values&&e.values.length>0){var l,d=[];e.values&&e.values.length>0?e.values.forEach(function(e){d.push({"ds6w:label":e.value,resourceid:e.id,id:e.id,type:e.type,sourceid:e.sourceid})}):d=[{"ds6w:label":e.value,resourceid:e.identifier?e.identifier:e.id}],(l=a.createModel(d)).getRoots()&&(a.autocompleteField.selectedItems=e.multiSelect?l.getRoots():l.getRoots()[0])}t.numbers.push(s),t.lists.push(a.searchButton),a.uploadButton&&t.lists.push(a.uploadButton),a.autocompleteField.setOptions(e),a.autocompleteField.fieldController=a,t.wuxAutocompletes.push(a.autocompleteField),UWA.is(e.label)&&(n=UWA.createElement("label",{for:r.id,text:UWA.i18n(e.label+i.options.labelSuffix)})),e.multiSelect&&UWA.createElement("span",{text:e.errorText,class:"form-control-error-text multiselect"}).inject(r.firstElementChild);let u=i.createField.call(t,r,n,o);return u.setAttribute("propertyid","toggleVisibility"),e.allowDrop&&c.makeFieldDroppable({...e,dropArea:u,fieldController:a,form:t}),u},customNumberField:function(e,n){var i,o,a=n,r=e.hide||!1,s=!!("ontouchstart"in window||navigator.maxTouchPoints);e.subtype&&"real"===e.subtype.toLowerCase()&&(o=e.decimals?e.decimals:3);var c=new l({placeholder:e.placeholder,name:e.name,required:e.required,value:parseFloat(e.value),disabled:!!e.disable&&e.disable,decimals:o,stepValue:e.stepValue?e.stepValue:1,useScientificNotationFlag:!1,highExponentProperty:20,lowExponentProperty:20,touchMode:!e.disableTouchMode&&s});e.minValue=e.minValue?parseFloat(e.minValue):e.negativeAllowed?-999999999998:0,e.maxValue=e.maxValue?parseFloat(e.maxValue):999999999998,c.elements.container.style.width="100%",e.enableRightSideButtons||c.getContent().addClassName("xsrc-hide-spinbox-buttons"),c.elements.inputField.name=e.name,c.setOptions(e),UWA.createElement("span",{text:g.VALUE_OUTOF_RANGE+" ("+e.minValue.toString()+" "+g.to+" "+e.maxValue.toString()+")",class:"form-control-error-text"}).inject(c.elements.container),UWA.createElement("span",{text:e.helperText?e.helperText:"",class:"form-control-helper-text",styles:{display:e.helperText?"block":"none"}}).inject(c.elements.container);var d,u=UWA.createElement("div",{html:[c],id:"input-"+t.getUUID().substring(0,6),styles:{position:"relative",width:"auto","padding-bottom":"10px"}});if(c.elements.inputField.addEventListener("input",function(){a.FormValidations.validateNumberField([c])}),c.addEventListener("change",function(){a.FormValidations.validateNumberField([c])}),e.events)for(let t in e.events)t&&c.elements.inputField.addEventListener(t,e.events[t]);return s&&(c.elements.inputField.style.paddingLeft="10px",c.elements.inputField.style.paddingRight="10px"),n.numbers.push(c),UWA.is(e.label)&&(i=UWA.createElement("label",{for:u.id,text:UWA.i18n(e.label+a.options.labelSuffix)})),d=a.createField.call(n,u,i,r),e.returnNumberField?{component:d,textField:c}:d},hyperlinkWithText:function(e,n){var i,o=n,a=this,r=this.createHyperlinkField(e,"toggleVisibility"),s=this.createTextField(e,"toggleVisibility");s.elements.container.setStyle("display","none");var l=UWA.createElement("div",{html:[r],styles:{position:"absolute",width:"100%","pointer-events":""}}),c=UWA.createElement("div",{html:[s],styles:{position:"absolute",width:"100%","pointer-events":""}}),d=UWA.createElement("div",{html:[l,c],id:"input-"+t.getUUID().substring(0,6),styles:{position:"relative",width:"auto",display:"flex",direction:"row"}});return n.hyperlink=[],n.hyperlink.push(r),n.texts.push(s),s.onChange=function(){a.updateHybridFieldTitleAndTooltip.call(this,r)},UWA.is(e.label)&&(i=UWA.createElement("label",{class:"text",for:r.id,text:UWA.i18n(e.label+o.options.labelSuffix)})),o.createField.call(n,d,i)},accordeonMerge:function(e){var t=UWA.createElement("div",{});let n=new E({items:[{header:e.label,content:e.content}],style:"simple",exclusive:!1});return n.expandItem(0),n.inject(t),t},createHyperlinkField:function(e,t){var n=UWA.createElement("div",{class:"hyperlink",name:e.name+"hyperlink",text:e.value,styles:{margin:"5px 0px",width:"100%",color:"#005685",cursor:"pointer",overflow:"hidden","text-overflow":"ellipsis",display:"block","white-space":"nowrap"},events:{click:function(){e.callBack&&e.callBack()}}});return t&&n.setAttribute("propertyid",t),n.title=n.getText(),n},createTextField:function(e,t){var i=new n({nonEditable:e.nonEditable,placeholder:e.placeholder,name:e.name,value:e.value,isLengthy:e.isLengthy,noSpecialCharorHyphen:e.noSpecialCharorHyphen,noSpecialChar:e.noSpecialChar,required:e.required});return t&&i.elements.container.setAttribute("propertyid",t),i.elements.input.title=i.elements.input.value,i.setOptions(e),i},updateHybridFieldTitleAndTooltip:function(e){this.getContent().setAttribute("title",this.getValue()),e.title=this.getValue(),e.setText(this.getValue())},subscribe:function(){this.boundHandleKey=this.handleKey.bind(this),window.addEventListener("keydown",this.boundHandleKey)},handleKey:function(e){var t=document.querySelectorAll(".modal-footer");9===e.keyCode&&t.length>0&&e.target===t[t.length-1].children[0].children[t[t.length-1].children[0].children.length-1]&&(this.highlightFirstInputField(),e.preventDefault())},highlightFirstInputField:function(){var e=document.querySelectorAll(".modal-body"),t=document.querySelector(".modal-body input"),n=document.querySelector(".modal-body .form-group .form-control-root");e.length>1&&e[e.length-1].querySelector(".form-group .form-control-root")?e[e.length-1].querySelector(".form-group .form-control-root").focus():n?(n.focus(),document.querySelector(".modal-body .form-group").scrollIntoView()):t&&t.focus()}}})}),define("DS/ENOXSourcingUXInfra/MembersView/MembersView",["UWA/Core","UWA/Class/View","DS/UIKIT/Mask","i18n!DS/ENOXSourcingUXInfra/assets/nls/ENOXSourcingUXInfra","DS/ENOXSourcingUXInfra/xsourcingCollectionView/xsourcingCollectionView","WebappsUtils/WebappsUtils","DS/Utilities/Dom","DS/Windows/ImmersiveFrame","DS/Windows/Dialog","DS/Controls/Button","DS/UIKIT/SuperModal","DS/ENOXSourcingUXInfra/xsourcingformview/ENOXSourcingForm","DS/ENOXSourcingUXInfra/service/ENOXSourcingService","DS/ENOXSourcingUXInfra/components/MemberInfoProvider/MemberInfoProvider","DS/ENOXSourcingUXInfra/Search/SearchUtility","DS/ENOXSourcingUXInfra/Constants/ENOXSourcingConstants","css!DS/ENOXSourcingUXInfra/MembersView/MembersView.css"],function(e,t,n,i,o,a,r,s,l,c,d,u,p,m,h,f){"use strict";return t.extend({name:"members-view",tagName:"div",source:"sourcing",memberAccessObj:{},accessKeyMap:{viewer:"Viewer",contributor:"Contributor",leader:"Leader"},template:function(){return'<div class="'+this.getClassNames("-subcontainer")+'"></div>'},domEvents:{},init:function(e){this.model=e.model,this.searchUtil=new h,this.modelEvent=this.model.get("modelEvent"),this.infoContainer=this.model.get("infoContainer"),["container","template","tagName","domEvents"].forEach(function(t){delete e[t]}),this._parent(this,e)},setup:function(){this.container.addClassName(this.getClassNames("-container"))},render:function(){var t=this;this.container.empty(),this.outerDiv=e.createElement("div",{class:"outerDiv",styles:{height:"100%"}}).inject(this.container),n.mask(this.container,i.Loading_Members),t.membersCollectionUIObj={},t.memberInfoProvider=new m;var a={data:[]};return t.loadData(),a._mediator=t.model.get("mediator"),a.showToolbar=!0,a.uniqueIdentifier="MembersView",t.membersCollectionUIObj=new o,a.toolbarActions=[],t.model.get("changeAccess")&&"true"===t.model.get("changeAccess").toLowerCase()&&(a.toolbarActions.push({fonticon:"plus",text:i.addMembers,handler:function(){t.launchWebUXPopup()}}),a.toolbarActions.push({id:"remove",text:i.removeMember,fonticon:"fonticon fonticon-user-delete",disabled:!0,handler:function(){var e=new d({renderTo:widget.body,okButtonText:i.remove}),n=t.membersCollectionUIObj._gridModel.getSelectedNodes(),o=[];if(n.forEach(function(e){o.push({type:e.options.grid.type,id:e.options.grid.id,dataelements:{name:e.options.grid.name,access:e.options.grid.member,fullName:e.options.grid.fullName}})}),t.model.get("disableContextualMenuFor")&&o.find(e=>t.model.get("disableContextualMenuFor").includes(e.id)))widget.notificationUtil.showError(i.member_removal_error);else{var a=1===n.length?n[0].options.label:n.length+" "+i.members;e.confirm(i.remove_confirmation,i.remove+" - "+a,function(e){e&&t.callAjaxForMemberDelete(o)})}}})),a.columnsConfigurations=[{text:i.name,dataIndex:"tree",resizableFlag:!0,sortableFlag:!0,pinned:"left",typeRepresentation:"url",getCellValue:function(e){return t.memberInfoProvider.getOwnerColumnValues(e.nodeModel.options.grid.name,e.nodeModel.options.label,e.nodeModel.options.grid.type,e.nodeModel.options.grid.grouped)},getCellClassName:function(){return t.memberInfoProvider.ownerClassName}},{text:i.TYPE,dataIndex:"typeDisplay"},{text:i.responsibility,dataIndex:"responsibilityDisplay",minWidth:200},{text:i.comment,dataIndex:"comment"}],a.views=["Tile","Grid"],a.displayedOptionalCellProperties=["contextualMenu","subtitle"],a.onContextualEventCallback=function(e){var n=[];if(t.model.get("changeAccess")&&"false"===t.model.get("changeAccess").toLowerCase())return widget.notificationUtil.showError(i.no_change_sov),!1;if(e){var o=e.cellInfos&&e.cellInfos.nodeModel?e.cellInfos.nodeModel:null;if(-1===(e.cellInfos?e.cellInfos.rowID:null)||!o)return this._contextualMenuBuilder?this._contextualMenuBuilder.buildMenu(e,a):[];var r=e.cellInfos.nodeModel?e.cellInfos.nodeModel:e.cellInfos.cellModel;if(r){var s=r.options.grid;if(!Object.values(t.accessKeyMap).includes(s.responsibility))return n;if(t.model.get("disableContextualMenuFor")&&t.model.get("disableContextualMenuFor").includes(s.id))return n;n.push({id:"viewer",type:"PushItem",title:i.viewer,state:"viewer"===s.member.toLowerCase()?"disabled":"enabled",fonticon:{content:"fonticon fonticon-eye"},action:{callback:function(){t.callAjaxForMemberUpdate([{type:s.type,id:s.id,dataelements:{name:s.name,access:t.accessKeyMap.viewer,fullName:s.tree}}],"update")}}}),n.push({id:"contributor",type:"PushItem",title:i.contributor,fonticon:{content:"fonticon fonticon-pencil"},state:"contributor"===s.member.toLowerCase()?"disabled":"enabled",action:{callback:function(){t.callAjaxForMemberUpdate([{type:s.type,id:s.id,dataelements:{name:s.name,access:t.accessKeyMap.contributor,fullName:s.tree}}],"update")}}}),n.push({id:"leader",type:"PushItem",title:i.leader,fonticon:{content:"fonticon fonticon-user-key"},state:"leader"===s.member.toLowerCase()?"disabled":"enabled",action:{callback:function(){t.callAjaxForMemberUpdate([{type:s.type,id:s.id,dataelements:{name:s.name,access:t.accessKeyMap.leader,fullName:s.tree}}],"update")}}}),n.push({id:"remove",type:"PushItem",title:i.removeMember,fonticon:{content:"fonticon fonticon-user-delete"},action:{callback:function(){new d({renderTo:widget.body,okButtonText:i.remove}).confirm(i.remove_confirmation,i.remove+" - "+s.fullName,function(e){e&&t.callAjaxForMemberDelete([{type:s.type,id:s.id,dataelements:{name:s.name,access:s.member,fullName:s.fullName}}])})}}})}}else e.cellCtxMenuRequired;return n},t.membersCollectionUIObj=new o,a.container=t.outerDiv,a.rowSelection="single",a.sort=[{id:"name",text:i.NAME,type:"string"}],a.shouldAllowUnsafeHTMLAt=["picture"],t.membersCollectionUIObj.init(a),t.modelEvent.subscribe({event:"add-model"},function(){n.unmask(widget.body)}),r.addResizeListener(this.outerDiv,function(){t.update()},0),t.membersCollectionUIObj.collectionViewEvents.subscribe({event:"xsourcing-collectionview-selection-updated"},function(e){e.selectedItems.length>0?1===e.selectedItems.length&&t.model._attributes.disableContextualMenuFor&&t.model._attributes.disableContextualMenuFor.includes(e.selectedItems[0].grid.id)?t.membersCollectionUIObj.collectionViewEvents.publish({event:"xsourcing-collectionview-disable-toolbar-button",data:"remove"}):t.membersCollectionUIObj.collectionViewEvents.publish({event:"xsourcing-collectionview-enable-toolbar-button",data:"remove"}):t.membersCollectionUIObj.collectionViewEvents.publish({event:"xsourcing-collectionview-disable-toolbar-button",data:"remove"})}),t.update(),this.container},loadData:function(){var e=this;n.mask(e.container),e.model.get("id")&&e.getMember(e.model.get("id")).then(function(t){e.membersData=e.processForMembers(t);let i=0,o="";if(e.membersData.forEach(function(e){e.grid.type===f.TYPE_GROUP_PROXY&&(o+='[ds6w:resourceUid]:"<uuid:'+e.grid.name+'>" OR ',i++)}),i>0){var a={completePreCond:o=o.substring(0,o.length-3),nresults:i,start:"0",with_nls:!1};e.searchUtil.callFederatedSearch(e.searchUtil.getSearchPayload([],[],[f.SOURCE_USERGROUPS],a)).then(function(t){let n=e.searchUtil.processResults(t);e.membersData.forEach(function(e){e.grid.type===f.TYPE_GROUP_PROXY&&(0!==t.infos.nmatches&&n.some(t=>t.resourceid==="<uuid:"+e.grid.name+">")?e.label=e.grid.tree=e.grid.fullName=n.filter(t=>t.resourceid==="<uuid:"+e.grid.name+">")[0]["ds6w:label"]:(e.label=f.PRIVATE_ASSIGNMENT,e.grid.tree=f.PRIVATE_ASSIGNMENT,e.grid.fullName=f.PRIVATE_ASSIGNMENT))}),e.membersCollectionUIObj._setData(e.membersData),e.membersCollectionUIObj._xsourcingCollectionViewUI._allData=e.membersData}).finally(function(){n.unmask(e.container)})}else e.membersCollectionUIObj._setData(e.membersData),e.membersCollectionUIObj._xsourcingCollectionViewUI._allData=e.membersData,n.unmask(e.container)}).catch(function(){n.unmask(e.container)})},onDestroy:function(){return this._parent.apply(this,arguments)},update:function(){var e=this.outerDiv.parentElement.parentElement?this.outerDiv.parentElement.parentElement.getBoundingClientRect():this.outerDiv.parentElement.getBoundingClientRect();this.outerDiv.style.height=e.height+"px"},getAutoSearchField:function(t){var n=this,o="(([ds6w:type]:Person AND current:Active) OR [ds6w:type]:Group)";return void 0!==n.model.get("excludeQuery")&&(o=o+" "+n.model.get("excludeQuery")),{label:t.label,type:"autocomplete",className:"src-multi-select-autocomplete",name:t.name,showSuggestsOnFocus:!1,floatingSuggestions:!1,multiSelect:!0,itemMultiSelect:!0,placeholder:"",allowFreeInput:!1,noResultsMessage:i.noResults,closableItems:!0,datasets:{configuration:{templateEngine:function(t,n,i){t.addClassName("default-template people-search-template");let o=e.createElement("div",{html:i.label,class:"item-label"}),a=e.createElement("div");i.picture.addClassName("people-search-img"),a.setHTML([i.picture,o]),t.setContent(a.innerHTML)},remoteSearchEngine:function(e,t){var i;return new Promise(function(a,r){var s={with_indexing_date:!0,with_synthesis:!0,with_nls:!1,label:"viewer",order_field:"ds6w:label",order_by:"asc",select_predicate:["ds6w:label","ds6w:type","ds6w:identifier","ds6w:status","ds6w:responsible","ds6w:responsibleUid","ds6w:project","ds6w:dataSource","ds6w:community"],select_file:["icon","thumbnail_2d"],query:o,specific_source_parameter:{},tenant:widget.getValue("x3dPlatformId")?widget.getValue("x3dPlatformId"):"OnPremise"};"**"!==t&&(s.specific_source_parameter["3dspace"]={additional_query:"AND ([ds6w:label]:(*"+t+"*) OR [ds6w:identifier]:(*"+t+"*))"}),"OnPremise"!==s.tenant&&(s.specific_source_parameter.usersgroup={additional_query:"AND [ds6w:label]:(*"+t+"*)"});var l={searchPayLoad:s};p.getFederatedSearchDataPromise(l).then(function(t){i={};var o=[];t.results&&t.results.forEach(function(e){var t,i,a,r;e.attributes.forEach(function(e){"ds6w:label"===e.name&&(t=e.value),"resourceid"===e.name&&(i=e.value),"ds6w:identifier"===e.name&&(a=e.value),"ds6w:what/ds6w:type"===e.name&&(r="foaf:Group"===e.value?e.value.split(":")[1]:e.value)});var s={name:a,label:t,value:i,picture:n.memberInfoProvider.getMemberImage(a,t,r),type:r};o.push(s)}),e.items=o,i.dataset=e,i.matchingItems=o,a(i)},function(t){t.type="error",t.dataset=e,r(t)})})}}},events:{onSelect:function(e){n.autoCompleteForm.autocompletes.forEach(function(t){if(t.getDataset().id!==e.datasetId){var n;t.selectedItems.forEach(function(t,i){t.value===e.value&&(n=i)}),t.onUnselect(e,n)}else{var i=0;t.selectedItems.forEach(function(n,o){n.value===e.value&&++i>1&&t.onUnselect(n,o)})}}),this.resetInput(),this.onHideSuggests(),n.memberAccessObj[e.value]={name:e.name,value:e.value,type:e.type,fullName:e.label},Object.keys(n.memberAccessObj).length>0?n.addButton.disabled=!1:n.addButton.disabled=!0},onUnselect:function(){this.resetInput(),this.onHideSuggests(),Object.keys(n.memberAccessObj).length>0?n.addButton.disabled=!1:n.addButton.disabled=!0}}}},getAutoCompleteForm:function(e){return this.autoCompleteForm=new u({grid:"4,8",fields:[this.getAutoSearchField({label:e?e.canView:i.viewer,name:"viewer"}),this.getAutoSearchField({label:i.contributor,name:"contributor"}),this.getAutoSearchField({label:i.leader,name:"leader"})]}),this.autoCompleteForm},launchWebUXPopup:function(e){var t=this,n=new s;n.inject(widget.body),this.addButton=new c({label:i.add,disabled:!0,onClick:function(){n.destroy(),t.processForAddMembers()}}),this.dialog=new l({title:e?e.shareName:i.addMembers,content:this.getAutoCompleteForm(e),immersiveFrame:n,modalFlag:!0,touchMode:!0,resizableFlag:!0,visibleFlag:!0,closeButtonFlag:!0,width:450,height:380,buttons:{Cancel:new c({label:i.cancel,onClick:function(){n.destroy()}}),Ok:this.addButton}}),this.dialog.elements._buttonsDiv.addClassName("xsrc-dialog-buttons"),this.dialog.elements._contentDiv.addClassName("xsrc-dialog-content")},processForAddMembers:function(){var e=this,t=[];if(Object.keys(e.memberAccessObj).length>0){var n=e.autoCompleteForm.getValues();Object.keys(n).forEach(function(i){n[i]&&n[i].split(";").forEach(function(n){var o=e.memberAccessObj[n];o&&t.push({type:o.type,id:o.value,dataelements:{memberId:o.value,fullName:o.fullName,access:e.accessKeyMap[i]}})})}),e.callAjaxForMemberUpdate(t)}},callAjaxForMemberUpdate:function(e,t){var o=this,a="",r="",s=[];"update"===t?(a=o.updateMember.bind(o),r=i.updating_member,n.mask(o.container,r),e.map(function(e){s.push(new Promise((t,n)=>{a({data:[e]}).then(function(n){var o=i[n.data[0].dataelements.access.toLowerCase()];widget.notificationUtil.showSuccess(e.dataelements.fullName+i.responsibilty_changed_successfully_to+" "+o),t()},function(e){widget.notificationUtil.showError(e?e.error:""),n(new Error(e?e.error:""))})}))}),Promise.all(s).then(()=>{n.unmask(o.container),o.render()})):(a=o.addMember.bind(o),r=i.adding_members,n.mask(o.container,r),e.map(function(e){s.push(new Promise((t,r)=>{o.getPeronOrGroupActualIds(e).then(function(n){e.id=n.ObjIds[0],e.dataelements.memberId=n.ObjIds[0],a({data:[e]}).then(function(n){var o=i[n.data[0].dataelements.access.toLowerCase()];widget.notificationUtil.showSuccess(e.dataelements.fullName+" "+i.added_successfully_as+" "+o),t()},function(e){widget.notificationUtil.showError(e?e.error:""),r(new Error(e?e.error:""))})}).catch(function(e){widget.notificationUtil.showError(e&&e.Result?e.Result:"Error while getting actual id from sourcing service")}).finally(function(){n.unmask(o.container)})}))}),Promise.all(s).then(()=>{n.unmask(o.container),o.render()}))},callAjaxForMemberDelete:function(e){var t=this;let o=[];e.map(function(e){o.push(new Promise((n,o)=>{t.deleteMember({data:[e]}).then(function(t){(t.data[0]?t.data[0]:e)&&widget.notificationUtil.showSuccess(e.dataelements.fullName+" "+i.removed_as_member),n()},function(e){widget.notificationUtil.showError(e.internalError),o(new Error(e?e.error:""))})}))}),Promise.all(o).then(()=>{n.unmask(t.container),t.render()})},processForMembers:function(e){if(!e.data)return[];var t=[];return e.data.forEach(function(e){var n={tree:e.dataelements.fullName,name:e.dataelements.name,fullName:e.dataelements.fullName,typeDisplay:i[e.type],type:e.type,id:e.id,Id:e.dataelements.access,member:e.dataelements.access,responsibility:e.dataelements.access,responsibilityDisplay:i[e.dataelements.access.toLowerCase()],comment:e.dataelements.comment},o=new m,a={grid:n,label:n.tree,subLabel:i[n.responsibility.toLowerCase()],thumbnail:o.getMemberImage(n.name,n.tree,n.type),description:i[n.type],id:n.id};t.push(a)}),t},addMember:function(e){var t={};return t.endpoint="/resources/v1/modeler/dssourcing/memberaccess/"+this.model.get("id")+"/members",t.postData=e,t.source=this.source,p.performPostPromise(t)},updateMember:function(e){var t={};return t.endpoint="/resources/v1/modeler/dssourcing/memberaccess/"+this.model.get("id")+"/members",t.putData=e,t.source=this.source,p.performPutPromise(t)},getMember:function(){var e={};return e.endpoint="/resources/v1/modeler/dssourcing/memberaccess/"+this.model.get("id")+"/members",e.source=this.source,p.getDataPromise(e)},deleteMember:function(e){var t={};return t.endpoint="/resources/v1/modeler/dssourcing/memberaccess/"+this.model.get("id")+"/members",t.source=this.source,t.deleteData=e,p.performDeletePromise(t)},getPeronOrGroupActualIds:function(e){var t={endpoint:"/resources/dssourcing/GlobalToLocalObj/phyIds"};return t.source=this.source,t.postData={phyIds:[e.id]},p.performPostPromise(t)}})}),define("DS/ENOXSourcingUXInfra/components/CreateRequestForm/CreateRequestForm",["DS/ENOXSourcingUXInfra/xsourcingformview/ENOXSourcingForm","DS/UIKIT/Scroller"],function(e,t){"use strict";return UWA.Class.View.extend({name:"create-request-form",tagName:"div",className:"create-request-form",domEvents:{},setup:function(t){let n=this;this.app=t.app;let i=t.model;this.controller=t.controller,this.currentStep=this.controller.wizardComponent.currentStep,this.currentStepIndex=this.controller.wizardComponent.steps.indexOf(this.currentStep),this.model={},this.model.fields=i.get("fields"),this.model.buttons=i.get("buttons"),this.model.preSelectedTemplate=i.get("preSelectedTemplate"),this.createRequestFormEventTokens=[],this.model.events={onSubmit:function(){var e=this;if(function(){if(e.texts.length>0&&!e.FormValidations.charLimitValidate(e.texts))return!1;let t=["autocompletes","booleans","dates","files","lists","numbers","passwords","ranges","texts","wuxAutocompletes"];for(let n=0;n<t.length;n++)if(!("wuxAutocompletes"===t[n]?e.FormValidations.wuxAutoCompleteValidation(e[t[n]]):e.FormValidations.mandatoryFieldValidation(e[t[n]])))return!1;return e.FormValidations.validateNumberField(e.numbers)}()){let e=n.createForm.getValues();n.model.fields.filter(e=>"searchWithChooser"===e.type||"accordeonMerge"===e.type||"autocomplete"===e.type||"date"===e.type||"autocompleteWithSearch"===e.type).forEach(function(t){if("autocomplete"===t.type&&n.createForm.getField(t.name).getAttribute("identifier"))e[t.name]={value:e[t.name],id:n.createForm.getField(t.name).getAttribute("identifier")};else if("autocompleteWithSearch"===t.type)if(t.multiSelect){let i=n.createForm.wuxAutocompletes.filter(e=>e.options.name===t.name);i[0]&&(e[t.name]={value:i[0].selectedItems})}else n.createForm.getField(t.name).getAttribute("identifier")&&(e[t.name]={value:e[t.name],id:n.createForm.getField(t.name).getAttribute("identifier")});else"date"===t.type&&e[t.name]?e[t.name]={value:e[t.name],actualValue:new Date(n.createForm.getDateInput(t.name).getDate().getTime()).toDateString(),id:n.createForm.getField(t.name).getAttribute("id")}:"accordeonMerge"===t.type?t.fields.forEach(t=>{["date","Date","timestamp"].includes(t.type)&&(e[t.name]={value:e[t.name],actualValue:n.createForm.getField(t.name).getAttribute("actualValue"),id:"extension"})}):e[t.name]={value:e[t.name],id:n.createForm.getField(t.name).getAttribute("id")}}),n.app._applicationChannel.publish({event:"next-step-action",data:e})}},onInvalid:function(){},onChange:function(){this.texts.length>0&&this.FormValidations.charLimitValidate(this.texts)}},this.createRequestFormEventTokens.push(this.app._applicationChannel.subscribe({event:"save-form-data"},function(e){var t=n.createForm;if(function(){if(t.texts.length>0&&!t.FormValidations.charLimitValidate(t.texts))return!1;let e=["texts","autocompletes","booleans","dates","files","numbers","passwords","ranges","wuxAutocompletes"];for(let n=0;n<e.length;n++)if(!("wuxAutocompletes"===e[n]?t.FormValidations.wuxAutoCompleteValidation(t[e[n]]):t.FormValidations.mandatoryFieldValidation(t[e[n]])))return!1;return t.FormValidations.validateNumberField(t.numbers)}()){let t=n.createForm.getValues();n.model.fields.filter(e=>"searchWithChooser"===e.type||"autocomplete"===e.type||"date"===e.type).forEach(function(e){"autocomplete"===e.type?t[e.name]={value:t[e.name],id:n.createForm.getField(e.name).getAttribute("identifier")}:"date"===e.type&&t[e.name]?t[e.name]={value:t[e.name],actualValue:new Date(n.createForm.getDateInput(e.name).getDate().getTime()).toDateString(),id:n.createForm.getField(e.name).getAttribute("id")}:t[e.name]={value:t[e.name],id:n.createForm.getField(e.name).getAttribute("id")}}),e.event?n.app._applicationChannel.publish({event:e.event,data:t}):n.app._applicationChannel.publish({event:"submit-action",data:t})}})),this.createForm=new e({grid:"4,8",fields:this.model.fields,events:this.model.events}),this.app._applicationChannel.publish({event:"createFormInstance",data:this.createForm}),this.createForm.elements.container.id="wizardForm"+this.currentStepIndex,this.app._applicationChannel.subscribe({event:"wizard-cleanup-events"},function(){n.createRequestFormEventTokens.forEach(e=>n.app._applicationChannel.unsubscribe(e))})},render:function(){var e=UWA.createElement("div",{class:"modalBodyDiv"});return this.createForm.inject(e),new t({element:e}).inject(this.container),this.model.buttons&&this.renderButtons(),this.app._applicationChannel.publish({event:"details-form-rendered",data:{createForm:this.createForm,preSelectedTemplate:this.model.preSelectedTemplate}}),this.container},renderButtons:function(){let e=UWA.createElement("span",{id:"modalButtons",class:"modal-buttons"});this.model.buttons.forEach(t=>{t.form&&(t.form=t.form+this.currentStepIndex),UWA.createElement("button",t).inject(e)}),this.currentStep.delegateButtons?this.currentStep.footer=e:e.inject(this.container)},destroy:function(){this._parent()}})}),define("DS/ENOXSourcingUXInfra/PropertiesView/PropertiesView",["UWA/Core","UWA/Class/View","DS/UIKIT/Scroller","UWA/Utils","DS/UIKIT/Input/Text","DS/UIKIT/Input/Button","DS/UIKIT/Input/Number","DS/UIKIT/Input/Date","DS/UIKIT/Input/Select","DS/UIKIT/Autocomplete","DS/Controls/SpinBox","DS/Utilities/Dom","DS/ENOXCollectionToolBar/js/ENOXCollectionToolBarV2","DS/ENOXSourcingUXInfra/Mediator","DS/ENOXSourcingUXInfra/xsourcingformview/ENOXSourcingForm","i18n!DS/ENOXSourcingUXInfra/assets/nls/ENOXSourcingUXInfra","DS/ENOXSourcingUXInfra/TypeAHead/ENOXTypeAHeadUtils","DS/ENOXSourcingUXInfra/Constants/ENOXSourcingConstants","DS/ENOXSourcingUXInfra/PropertiesView/PropertiesAccordeonView/PropertiesAccordeonView","css!DS/UIKIT/UIKIT.css","css!DS/ENOXSourcingUXInfra/PropertiesView/PropertiesView.css"],function(e,t,n,i,o,a,r,s,l,c,d,u,p,m,h,f,g,v,S){"use strict";return t.extend({name:"properties-view",tagName:"div",pageOptions:{},template:function(){return'<div class="'+this.getClassNames("-subcontainer")+'"></div>'},domEvents:{},init:function(e){this.model=e.model,this.modelEvent=(new m).createNewChannel(),this.pageOptions=e,this.fieldElements={},this.fieldElementsInternal=[],this.fieldLables=[],this.formObj=new h,this.propertiesAccordeonView=new S({}),["container","template","tagName","domEvents"].forEach(function(t){delete e[t]}),this._parent(this,e)},setup:function(){this.model.has("classes")&&this.container.addClassName(this.model.get("classes")),this.model.get("singleColumn")?this.colLgClass="col-lg-12":this.colLgClass="col-lg-6",this.model.get("singleColumn"),this.colMdClass="col-md-6",this.container.addClassName(this.getClassNames("-container container-fluid")),this.listenTo(this.model,"onChange",this.render)},getFormGroup:function(t){var n=this,i=e.createElement("div",{class:"form-group"}),o=void 0;if("justLabel"===t.type)o=e.createElement("label",{class:"just-label",html:t.label});else if("labelValue"===t.type){o=e.createElement("div",{class:"label-value-1",styles:{"padding-left":"7%"}}),e.createElement("div",{class:"label-value-2",html:t.label,styles:{color:"#77797c","font-size":"14px",width:t.value?"50%":"100%","font-weight":"700",background:"transparent","white-space":"initial",float:"left"}}).inject(o),e.createElement("div",{class:"label-value-3",html:t.value,styles:{width:t.icon?"45%":"50%","white-space":"initial",float:"left",color:"#3d3d3d"}}).inject(o)}else o=e.createElement("label",{class:this.colMdClass+" control-label",html:t.label,styles:{margin:"15px 0","word-wrap":"break-word",color:"#3D3D3D","font-size":"14px"}});t.label&&t.required&&e.createElement("span",{class:"label-field-required",text:" *",styles:{display:"none"}}).inject(o);o.inject(i);var a=e.createElement("div",{class:this.colMdClass}).inject(i),r="",s="";switch(t.nonEditable&&"justLabel"!==t.type&&"hyperlink"!==t.type&&"autocompleteWithSearch"!==t.type&&(t.type="simpleText"),t.type){case"text":case"string":r=n.createViewModeText(t),n.fieldElementsInternal.push(r),r.inject(a),(s=n.createTextField(t)).inject(a),n.injectHelpers(t,s.elements.content),s.elements.container.setStyle("display","none"),s.onChange=function(){n.updateHybridFieldTitleAndTooltip.call(this,r)};break;case"simpleText":(r=n.createViewModeText(t,!1)).inject(a);break;case"textarea":!t.displayValue&&t.value&&(t.displayValue=t.value.indexOf("\n")!==t.value.lastIndexOf("\n")?t.value.replaceAll("\n"," | "):t.value,0===t.value.indexOf("\n")&&(t.displayValue=t.displayValue.replace(" | ",""))),r=n.createViewModeText(t),n.fieldElementsInternal.push(r),r.inject(a),(s=n.createTextAreaField(t)).inject(a),n.injectHelpers(t,s.elements.content),s.elements.container.setStyle("display","none"),s.onChange=function(){n.updateHybridFieldTitleAndTooltip.call(this,r)};break;case"date":case"timestamp":(s=n.createDateField(t)).inject(a),n.injectHelpers(t,s.elements.content),s.elements.container.setStyle("display","none"),t.value=s.elements.input.value,r=n.createViewModeText(t),n.fieldElementsInternal.push(r),r.inject(a),s.onChange=function(){n.updateHybridFieldTitleAndTooltip.call(this,r)};break;case"select":{(s=n.createSelectField(t)).inject(a),n.injectHelpers(t,s.elements.content),s.elements.container.setStyle("display","none");let e=t.options.find(e=>e.value===t.value||!0===e.selected);t.displayValue=e?e.label:"",r=n.createViewModeText(t),n.fieldElementsInternal.push(r),r.inject(a),s.onChange=function(e){let n=t.options.find(e=>e.value===this.getValue()[0]).label;this.getContent().setAttribute("title",n),e.target.title=n,r.setText(n)};break}case"boolean":{t.options=[{label:f.TRUE,value:"TRUE"},{label:f.FALSE,value:"FALSE"}],(s=n.createSelectField(t)).inject(a),n.injectHelpers(t,s.elements.content),s.elements.container.setStyle("display","none");let e=t.options.find(e=>e.value===t.value);t.displayValue=e?e.label:"",r=n.createViewModeText(t),n.fieldElementsInternal.push(r),r.inject(a),s.onChange=function(){let e=t.options.find(e=>e.value===this.getValue()[0]).label;this.getContent().setAttribute("title",e),r.title=e,r.setText(e)};break}case"search":{r=n.createViewModeText(t),n.fieldElementsInternal.push(r),r.inject(a);let e=n.createSearchField(t);(s=e[0]).inject(a),e[1].elements.container.setStyle("display","none"),e[2].elements.container.setStyle("display","none"),e[1].onChange=function(){n.updateHybridFieldTitleAndTooltip.call(this,r)};break}case"autocomplete":t.dataSet&&(t.displayValue=t.dataSet.items.filter(e=>!0===e.selected).map(e=>e.label||e.value).toString().replaceAll(",",", ")),t.displayValue||(t.displayValue=" "),r=n.createViewModeText(t),n.fieldElementsInternal.push(r),r.inject(a),(s=n.createAutoCompleteField(t,r)).inject(a),s.elements.container.setStyle("display","none");break;case"hyperlinkWithAutoComplete":(r=n.createHyperlinkField(t)).inject(a),(s=n.createAutoCompleteField(t,r)).elements.container.setStyle("display","none"),s.inject(a),n.fieldElementsInternal.push(r);break;case"hyperlinkWithTextField":r=n.createHyperlinkField(t),n.fieldElementsInternal.push(r),r.inject(a),(s=n.createTextField(t)).inject(a),n.injectHelpers(t,s.elements.content),s.elements.container.setStyle("display","none"),s.onChange=function(){n.updateHybridFieldTitleAndTooltip.call(this,r)};break;case"hyperlink":(r=n.createHyperlinkField(t,!1)).inject(a);break;case"autocompleteWithSearch":{t.values&&(t.displayValue=t.values.map(e=>e.value).toString().replaceAll(",",", ")),t.displayValue||(t.displayValue=" "),r=n.createViewModeText(t),n.fieldElementsInternal.push(r),r.inject(a);let e=n.createAutoCompleteWithSearchField(t,r);(s=e[0]).inject(a),e[1].elements.container.setStyle("display","none"),e[2].elements.container.setStyle("display","none"),e[3]&&e[3].elements.container.setStyle("display","none");break}case"hyperlinkWithAutoCompleteWithSearchField":{t.dataSet&&(t.displayValue=t.dataSet.items.filter(e=>!0===e.selected).map(e=>e.label||e.value).toString().replaceAll(",",", ")),t.displayValue||(t.displayValue=" "),(r=n.createHyperlinkField(t)).inject(a),n.fieldElementsInternal.push(r);let e=n.createAutoCompleteWithSearchField(t,r);(s=e[0]).inject(a),e[1].elements.container.setStyle("display","none"),e[2].elements.container.setStyle("display","none"),e[3]&&e[3].elements.container.setStyle("display","none");break}case"number":case"integer":case"real":{r=n.createViewModeText(t),n.fieldElementsInternal.push(r),r.inject(a),s=n.createNumberField(t,a);let e=function(e){r.title=e.getInputText(),r.setText(e.getInputText())};s.elements.inputField.addEventListener("change",function(){e(s)}),s.elements.down.addEventListener("click",function(){e(s)}),s.elements.up.addEventListener("click",function(){e(s)}),s.inject(a),n.injectHelpers(t,s.elements.container),s.elements.container.setStyle("display","none");break}}if(r.getContent&&(r.getValue?r.getContent().setAttribute("title",r.getValue()):r.getInputText&&r.getContent().setAttribute("title",r.getInputText())),r.options&&"autocomplete"===r.options.type){let e="";r.selectedItems.map(function(t){e+=t.value+" ,"}),e=e.slice(0,-1),r.getContent().setAttribute("title",e)}return t.disable&&!0===t.disable&&r.disable&&r.disable(),r&&(r.addEvent("onChange",function(){this.getContent().setAttribute("title",this.getValue()),n.dispatchEvent("onChange",[this.getName(),this.getValue(),n])}),r.onChange=function(){if(n.trackAttributeUpdations(this.getName(),this.getValue(),n),t.helperText||t.errorText){if(!n.charLimitValidate(r,n))return;if(!n.alphanumericOrUnderscoreValidate(r,n))return;n.alphanumericUnderscoreSpaceHyphenValidation(r,n)}"date"!==t.type&&"timestamp"!==t.type||n.formatDate(this)}),i},trackAttributeUpdations:function(e,t){for(var n=widget.body.getElementsByTagName("input"),i=widget.body.getElementsByTagName("select"),o=0;o<n.length;++o)n[o].name===e&&(n[o].value=t);for(var a=0;a<i.length;++a)i[a].name===e&&(i[a].value=t)},formatDate:function(e){var t=e.elements.picker.getDate()?new Date(e.elements.picker.getDate().getTime()).toDateString():"";e.elements.input.setAttribute("actualvalue",t)},charLimitValidate:function(e){var t=[e];return this.formObj.FormValidations.charLimitValidate(t)},validateNumberField:function(e){var t=[e];return this.formObj.FormValidations.validateNumberField(t)},alphanumericOrUnderscoreValidate:function(e){var t=this;Array.isArray(e)||(e=[e]);var n=v.ALPHA_NUM_UNDSCR_SPACE,i=!0;return e.forEach(function(e){e.options&&void 0!==e.options.noSpecialCharorHyphen&&(i=t.formObj.FormValidations.propertiesRegexValidation(e,n))}),i},alphanumericUnderscoreSpaceHyphenValidation:function(e){var t=this;Array.isArray(e)||(e=[e]);var n=v.ALPHA_NUM_UNDSCR_SPACE_HYPHEN,i=!0;return e.forEach(function(e){e.options&&void 0!==e.options.noSpecialChar&&(i=t.formObj.FormValidations.propertiesRegexValidation(e,n))}),i},injectHelpers:function(t,n,i){var o,a=t.helperText?t.helperText:void 0===t.isLengthy?void 0:t.isLengthy?f.length_256_limit:f.length_100_limit,r=t.errorText?t.errorText:void 0!==t.isLengthy?f.max_char_limit_err_msg:t.isLengthy;a&&n&&(t.helperText=a,o=e.createElement("span",{text:a,class:"form-control-helper-text"}).inject(n,i||"after")),r&&n&&(t.errorText=r,e.createElement("span",{text:r,class:"form-control-error-text"}).inject("bottom"===i?o:n,"bottom"===i?"before":"after"))},render:function(){this.container.empty(),this.propertiesAccordeonView._reset();var t=this;if(t.fieldElements={},t.fieldElementsInternal=[],this.outerDiv=e.createElement("div",{class:"outerDiv"}),void 0===this.pageOptions.hideToolbar||!1===this.pageOptions.hideToolbar){this.outerDiv.set({styles:{height:"80%"}});var i=e.createElement("div",{class:""}).inject(this.container),o=[];if("TRUE"===t.model._attributes.modifyAccess&&t.model._attributes.stateAccess){var a=t.model.get("actionsARray");a&&a.length>0&&(o=e.clone(a)),o.push({id:"editMode",text:f.edit,fonticon:"pencil",handler:function(e){e&&e.target&&t.toggleEditIconTooltip(e),t.fieldElementsInternal.forEach(function(e){let n=e.elements?e.elements.container:e;n.getAttribute&&"toggleVisibility"===n.getAttribute("propertyid")&&t.toggleVisibilityField(e)})}},{id:"createNPRTemplate",text:f.save,fonticon:"floppy",handler:function(){var e=!0;t.fieldElements&&(e=(e=(e=t.formObj.FormValidations.charLimitValidate(Object.values(t.fieldElements)))&&t.alphanumericOrUnderscoreValidate(Object.values(t.fieldElements)))&&t.alphanumericUnderscoreSpaceHyphenValidation(Object.values(t.fieldElements))),t.model._attributes.save&&e&&t.model._attributes.save(t.fieldElements,t)}}),void 0!==(a=t.model._attributes.additionalActions?t.model._attributes.additionalActions:void 0)&&a.length>0&&a.forEach(function(e){o.push(e)})}else o=[];var r={actions:o};this.pageOptions.itemName&&(r.itemName=this.pageOptions.itemName,r.itemsName=this.pageOptions.itemName,r.showItemCount=!0,r.modelEvents=t.modelEvent),t.collectionToolbar=new p(r),t.collectionToolbar.inject(i),this.pageOptions.itemName&&t.modelEvent.publish({event:"enox-collection-toolbar-items-count-update",data:""})}else this.outerDiv.set({styles:{height:"100%"}});var s=e.createElement("div",{class:"row"}).inject(this.outerDiv);let l=!1;return this.model&&this.model._attributes.fields&&this.model._attributes.fields.forEach(function(n){let i=t.getFormGroup(n);var o=void 0;if("justLabel"===n.type?o=e.createElement("div",{}):"labelValue"===n.type?o=e.createElement("div",{value:n.value}):(o=void 0!==n.id?e.createElement("div",{class:"col-md-12",id:n.id}):e.createElement("div",{class:"col-md-12"})).addClassName(t.colLgClass),i.inject(o),n.accordeonHeader&&"object"==typeof n.accordeonHeader)return l=!0,void t.propertiesAccordeonView.addField(n,o);o.inject(s)}),l&&t.propertiesAccordeonView.render().inject(this.outerDiv),this.outerDiv.inject(this.container),new n({element:this.outerDiv}).inject(this.container),u.addResizeListener(this.outerDiv,function(){t.update()},0),t.update(),this.container},onDestroy:function(){return this._parent.apply(this,arguments)},update:function(){let e=this.outerDiv.parentElement.parentElement?this.outerDiv.parentElement.parentElement.getBoundingClientRect().width:this.outerDiv.parentElement.getBoundingClientRect().width;e<600?this.outerDiv.querySelectorAll(".col-lg-6").forEach(e=>{e.classList.add("very-less-space"),e.classList.remove("less-space")}):e<785?this.outerDiv.querySelectorAll(".col-lg-6").forEach(e=>{e.classList.add("less-space"),e.classList.remove("very-less-space")}):this.outerDiv.querySelectorAll(".col-lg-6").forEach(e=>{e.classList.remove("less-space"),e.classList.remove("very-less-space")})},toggleEditIconTooltip:function(e){var t,n;e.target.hasClassName("fonticon-pencil")||e.target.firstChild&&e.target.firstChild.hasClassName("fonticon-pencil")?(n="pencil-block",t=f.disable_edit):(n="pencil",t=f.edit),this.collectionToolbar._modelEvents.publish({event:"enox-collection-toolbar-change-icon-action",data:{id:"editMode",text:t,fonticon:n}})},toggleVisibilityField:function(e){let t=e.elements?e.elements.container:e;if(t){let e,n;(n=t.getParents(".form-group")).length>0&&n.forEach(t=>{e=t.getElementsByClassName("label-field-required")}),"none"===t.getStyle("display")?(t.setStyle("display",""),e&&e.length>0&&!t.classList.contains("simpleText")&&e[0].setStyle("display","")):(t.setStyle("display","none"),e&&e.length>0&&!t.classList.contains("simpleText")&&e[0].setStyle("display","none"))}},createAutoCompleteField:function(e,t){var n=new c({multiSelect:e.multiSelect,placeholder:e.placeholder,name:e.name,showSuggestsOnFocus:e.showSuggestsOnFocus,floatingSuggestions:e.floatingSuggestions,allowFreeInput:e.allowFreeInput,className:e.className,tokenSeparator:e.tokenSeparator,noResultsMessage:!1,events:{onSelect:function(){let e=this.selectedItems.map(e=>e.label||e.value).toString().replaceAll(",",", ");this.getContent().setAttribute("title",e),t&&(t.title=e,t.setText(e))},onUnselect:function(){let e=this.selectedItems.map(e=>e.value).toString().replaceAll(",",", ");this.getContent().setAttribute("title",e),t&&(t.title=e,t.setText(e))},onFocus:function(){e.events&&e.events.onFocus&&e.events.onFocus(this)}}});(n.elements.container.setAttribute("propertyid","toggleVisibility"),e.dataSet&&n.addDataset(e.dataSet),e.datasets)&&e.datasets.map(function(e){n.addDataset(e)});return n.setOptions(e),this.fieldElements[e.name]=n,this.fieldElementsInternal.push(n),n},createHyperlinkField:function(t,n){var i=e.createElement("div",{class:"hyperlink",name:t.name+"hyperlink",text:t.value,styles:{margin:"5px 0px",width:"100%",color:"#005685",cursor:"pointer",overflow:"hidden","text-overflow":"ellipsis",display:"block","white-space":"nowrap"},events:{click:function(){t.callBack&&t.callBack()}}});return n||i.setAttribute("propertyid","toggleVisibility"),i.title=i.getText(),i},createTextField:function(e){var t=new o({nonEditable:e.nonEditable,placeholder:e.placeholder,name:e.name,value:e.value,isLengthy:e.isLengthy,noSpecialCharorHyphen:e.noSpecialCharorHyphen,noSpecialChar:e.noSpecialChar,required:e.required});return t.elements.container.setAttribute("propertyid","toggleVisibility"),t.elements.input.title=t.elements.input.value,t.setOptions(e),this.fieldElements[e.name]=t,this.fieldElementsInternal.push(t),t},createAutoCompleteWithSearchField:function(e,t){let n=this,i=new h;var o=JSON.parse(JSON.stringify(e));e.callback&&(o.callback=e.callback),o.propertiesViewCB=function(e){if(t)if(e.options.multiSelect){let n=e.autocompleteField.selectedItems.map(e=>e._options.label).toString().replaceAll(",",", ");t.title=n||"",t.setText(n||"")}else{let n=e.getSelectedObjectAttrValue("label")?e.getSelectedObjectAttrValue("label"):"";t.title=n,t.setText(n)}},e.dataFetcherMethod&&(o.dataFetcherMethod=e.dataFetcherMethod),e.valueValidator&&(o.valueValidator=e.valueValidator),o.label=void 0,e.extraQuery&&(o.extraQuery=e.extraQuery);let a=i.fields.autocompleteWithSearch(o,i),r=i.wuxAutocompletes.filter(t=>t._editor._myInput.name===e.name)[0];r.setOptions(e),n.fieldElements[e.name]=r,n.fieldElementsInternal.push(r);let s=i.lists[0];n.fieldElementsInternal.push(s),r.elements.container.setAttribute("propertyid","toggleVisibility"),s.elements.container.setAttribute("propertyid","toggleVisibility");let l=[a,r,s];if(i.lists[1]){let e=i.lists[1];n.fieldElementsInternal.push(e),e.elements.container.setAttribute("propertyid","toggleVisibility"),l.push(e)}return!0===e.nonEditable&&(s.options.nonEditable=!0),l},createSearchField:function(e){let t=new h,n=JSON.parse(JSON.stringify(e));e.callback&&(n.callback=e.callback),e.chooserCallback&&(n.chooserCallback=e.chooserCallback),e.allowChooserCallback&&(n.allowChooserCallback=e.allowChooserCallback),n.label=void 0;let i=t.fields.searchWithChooser(n,t);e.id&&(t.numbers[0].elements.input.id=e.id),e.identifier&&t.numbers[0].elements.input.setAttribute("identifier",e.identifier),e.value&&(t.numbers[0].elements.input.value=e.value);let o=t.numbers[0],a=t.lists[0];return!0===e.nonEditable&&(a.options.nonEditable=!0),this.fieldElements[e.name]=o,this.fieldElementsInternal.push(o),this.fieldElementsInternal.push(a),o.elements.container.setAttribute("propertyid","toggleVisibility"),a.elements.container.setAttribute("propertyid","toggleVisibility"),[i,o,a]},createTextAreaField:function(e){var t=new o({nonEditable:e.nonEditable,multiline:!0,placeholder:e.placeholder,name:e.name,value:e.value,isLengthy:e.isLengthy,required:e.required});return t.elements.container.setAttribute("propertyid","toggleVisibility"),t.elements.input.title=t.elements.input.value,t.setOptions(e),this.fieldElements[e.name]=t,this.fieldElementsInternal.push(t),t},createNumberField:function(e){let t=this;var n;"real"===e.type&&(n=e.decimals?e.decimals:3);var i=new d({nonEditable:e.nonEditable,placeholder:e.placeholder,name:e.name,required:e.required,value:e.value?parseFloat(e.value):0,decimals:n,stepValue:e.stepValue?e.stepValue:1,useScientificNotationFlag:!1,highExponentProperty:20,lowExponentProperty:20});return e.minValue=e.minValue?parseFloat(e.minValue):e.negativeAllowed?-999999999998:0,e.maxValue=e.maxValue?parseFloat(e.maxValue):999999999998,e.errorText=f.VALUE_OUTOF_RANGE+" ("+e.minValue.toString()+" "+f.to+" "+e.maxValue.toString()+")",i.elements.input=i.elements.inputField,i.setOptions(e),i.touchMode=!!("ontouchstart"in window||navigator.maxTouchPoints),t.fieldElements[e.name]=i,i.elements.inputField.addEventListener("input",function(){t.validateNumberField(i)}),t.fieldElementsInternal.push(i),i.elements.container.setAttribute("propertyid","toggleVisibility"),i},createDateField:function(e){var t=this,n=new s({nonEditable:e.nonEditable,placeholder:e.placeholder,name:e.name,value:e.value,required:e.required});return e.value&&t.formatDate(n),n.addEvent("onChange",function(){this.getContent().setAttribute("title",this.getValue()),t.formatDate(this)}),n.elements.container.setAttribute("propertyid","toggleVisibility"),n.elements.input.title=n.elements.input.value,n.setOptions(e),t.fieldElements[e.name]=n,t.fieldElementsInternal.push(n),n},createViewModeText:function(t,n){let i=e.createElement("div",{class:"simpleText",name:t.name,text:t.displayValue?t.displayValue:t.value,forDisplay:t.forDisplay,styles:{margin:"5px 0px",width:"100%","overflow-wrap":"break-word"}});return n||i.setAttribute("propertyid","toggleVisibility"),i},createSelectField:function(e){var t=new l({nonEditable:e.nonEditable,custom:!1,placeholder:!!e.placeholder&&e.placeholder,name:e.name,options:e.options,value:e.value});if(t.elements.container.setAttribute("propertyid","toggleVisibility"),t.elements.input.title=t.elements.input.value,e.options&&e.options.length>0&&e.value){let n=e.options.filter(t=>e.value===t.value)[0];n&&(t.elements.input.title=n.label)}return t.setOptions(e),this.fieldElements[e.name]=t,this.fieldElementsInternal.push(t),t},updateHybridFieldTitleAndTooltip:function(e){this.getContent().setAttribute("title",this.getValue()),e.title=this.getValue(),e.setText(this.getValue())}})}),define("DS/ENOXSourcingUXInfra/InformationPanel/InformationPanelUI",["UWA/Core","DS/ENOXIDCardContainer/js/ENOXIDCardContainer","DS/ENOXSourcingUXInfra/PropertiesView/PropertiesView","DS/Controls/Tab","css!DS/ENOXSourcingUXInfra/InformationPanel/customIDCard.css"],function(e,t,n,i,o){"use strict";var a=function(e){this.triptychWrapper=e.triptychWrapper,this._mediator=e.mediator,this._myModelEvents=this._mediator.createNewChannel()};return a.prototype.init=function(e){this.loadUI(e)},a.prototype.loadUI=function(o){var a={};(a=o.objectData).withHomeButton=!1,a.withExpandCollapseButton=!1,a.withActionsButton=!1,a.withInformationButton=!1,a.withToggleMinifiedButton=!0,a.modelEvents=this._myModelEvents,this.myIDCardModel=new e.Class.Model(a);this.mIDCardContainer=new t,this.mIDCardContainer.init({withtransition:!0,withoverflowhidden:!1},this.myIDCardModel),this.mIDCardContainer.inject(this.triptychWrapper.getRightPanelContainer());var r=new e.Class.Model({modifyAccess:"FALSE",stateAccess:!1,fields:o.fields});this.propertiesModel=r;var s=new n({model:r});if(o.tabs&&o.tabs.length>0){this._tabsComponent=new i({multiSelFlag:!1,touchMode:!0,displayStyle:["strip"],autoCloseFlag:!0,newTabButtonFlag:!1}),this._tabsComponent.getContent().style.height="100%",this._tabsComponent.tabPanelContainer.style.height="calc(100% - 44px)",this._tabsComponent.tabBar.centeredFlag=!1,this._tabsComponent.inject(this.mIDCardContainer.getMainContent()),this.propertiesTab=new e.Element("div",{styles:{height:"100%"}});var l={label:"Properties",isSelected:!0,icon:{iconName:"wux-ui-3ds wux-ui-3ds-properties",fontIconFamily:1},content:s.render(),index:1,value:"Properties"};this._tabsComponent.add(l),o._tabsComponent=this._tabsComponent,this._addAdditionalTabs(o)}else s.render().inject(this.mIDCardContainer.getMainContent())},a.prototype._addAdditionalTabs=function(e){for(var t=0;t<e.tabs.length;t++)e._tabsComponent.add(e.tabs[t])},a}),define("DS/ENOXSourcingUXInfra/SupplyNetworkSearchView/SupplyNetworkSearchView",["DS/UIKIT/Mask","DS/Handlebars/Handlebars","DS/ENOXSourcingUXInfra/xsourcingformview/ENOXSourcingForm","DS/Controls/Button","DS/UIKIT/Modal","DS/UIKIT/Scroller","UWA/Core","DS/ENOXSourcingUXInfra/xsourcingCollectionView/xsourcingCollectionView","i18n!DS/ENOXSourcingUXInfra/assets/nls/ENOXSourcingUXInfra","text!DS/ENOXSourcingUXInfra/SupplyNetworkSearchView/SupplyNetworkSearchView_template.html","text!DS/ENOXSourcingUXInfra/assets/config/SupplierSearchData.json","DS/ENOXSourcingUXInfra/Mediator","css!DS/ENOXSourcingUXInfra/SupplyNetworkSearchView/SupplyNetworkSearchView.css"],function(e,t,n,i,o,a,r,s,l,c,d,u){"use strict";let p;var m=function(e){this.controller=e.controller,p=this.controller.app.i18nProvider,this.wizardoptions=e.wizardoptions,this.viewOptions=e.viewOptions,this._mediator=new u};return m.prototype.render=async function(e,n){if(n){return await this.searchSuppliersWithDefaultCriteria(e,n)}this.formOpened=!0,this.newsuppDiv=r.createElement("div",{id:"supply_network_search_mainModal",class:"supply_network_search_mainModal"}),this.newsuppDiv.innerHTML=t.compile(c)();var i=this.newsuppDiv.querySelector("#suppSearchContentContainer");this.formContainer=this.newsuppDiv.querySelector("#suppSearchFormContainer"),this.formContentContainerParent=this.newsuppDiv.querySelector("#suppSearchFormContentContainer"),this.formContentContainer=this.newsuppDiv.querySelector("#suppSearchFormContentContainer1"),this.formFooterContainer=this.newsuppDiv.querySelector("#suppSearchFormFooterContainer"),this.itemCountContainer=this.newsuppDiv.querySelector("#suppSearchItemCount"),this.closeIcon=this.newsuppDiv.querySelector(".close-icon"),this.expanderIcon=this.newsuppDiv.querySelector(".expand-icon"),this.processDropDownData(e),this.getPopupModal(e).appendChild(this.newsuppDiv),this.createCollectionView(e,i),this.buildForm(e),this.subscribeEvents()},m.prototype.searchSuppliersWithDefaultCriteria=async function(e,t){let n={namefield:t,preferences:["Medium","High"]};e.postData=this.getSearchPayload(n);let i=await this.controller.searchSuppliersByCriteria(e);return i.map(function(e){e.identifier=e.id,e.value=e.id,e.resourceid=e.id,e["ds6w:label"]=e.label}),i},m.prototype.buildForm=function(){return this.formValues={},this.createForm=new n({fields:this.getFormFields(),events:{onSubmit:function(){},onChange:function(){}}}).inject(this.formContentContainer),new a({element:this.formContentContainer}).inject(this.formContentContainerParent),this.createForm},m.prototype.getFormFields=function(){var e=this,t=[{type:"text",label:l.name,name:"namefield",isLengthy:!1,events:{onChange:function(){e.formValues.namefield=this.getValue()}}},{type:"select",label:l.industry,name:"industry",placeholder:l.select_your_option,id:"industryDropdown",multiple:!0,options:e.dropDownData.industry?e.dropDownData.industry:[],events:{onChange:function(){e.formValues.industry=this.getValue()}}},{type:"select",label:l.PRODUCT_CATEGORIES,name:"levels",placeholder:l.select_your_option,id:"Categories",multiple:!0,options:e.dropDownData.category?e.dropDownData.category:[],events:{onChange:function(){e.formValues.categories=this.getValue()}}},{type:"select",label:l.country,name:"country",placeholder:l.select_your_option,id:"country",multiple:!0,options:e.dropDownData.country,events:{onChange:function(){e.formValues.country=this.getValue()}}},{type:"select",label:l.level,name:"levels",placeholder:l.select_your_option,id:"levels",multiple:!0,options:e.dropDownData.levels,events:{onChange:function(){e.formValues.levels=this.getValue()}}},{type:"select",label:l.preference_status,name:"preferences",placeholder:l.select_your_option,id:"preferences",multiple:!0,options:e.dropDownData.preferences,events:{onChange:function(){e.formValues.preferences=this.getValue()}}}];return e.viewOptions&&e.viewOptions.disallowedSearchCriteria&&e.viewOptions.disallowedSearchCriteria.length>0&&(t=t.filter(function(t){return e.viewOptions.disallowedSearchCriteria.map(function(e){return e!==t.name})[0]})),t},m.prototype.getPopupModal=function(e){var t=this,n=r.createElement("span",{id:"modalButtons",class:"modal-buttons"});t.addButton=new i({label:t.formOpened?l.search:l.add,emphasize:"primary"}).inject(n),t.addButton.getContent().addEventListener("buttonclick",function(){if(t.formOpened)t.searchSuppliersByCriteria(e),t.hideSidePanel();else{var n=t.collectionView._gridModel.getSelectedNodes();if(t.wizardoptions)return t.wizardoptions.selectHandler(n),void a.destroy();e.selectCallback?e.selectCallback(n):t.controller.processNewSupplier(n),a.destroy()}}),new i({label:l.cancel,emphasize:"secondary"}).inject(n).getContent().addEventListener("buttonclick",function(){a.destroy()});var a=t.modal=new o({className:"suppSearchModal",closable:!0,header:t.formOpened?l.search_suppliers:l.select_suppliers,body:"",footer:n,animate:!0,events:{onHide:function(){}}}).inject(widget.body);return a.show(),a.elements.wrapper.classList.add("suppSearchModalWrapper"),a.getBody()},m.prototype.createCollectionView=function(e,t){var n=this,i=new s;n.collectionView=e.xsourcingCollectionView=i;var o={};o._mediator=n._mediator;var a=n._mediator.createNewChannel();e.applicationChannel=a,o._container=t,o.views=["Tile"],e.collectionViewEvents=o.collectionViewEvents=o._mediator.createNewChannel(),o.showToolbar=!1,o.canMultiSelect=!1,o.data=[],o.withmultisel=!e.multiselect||e.multiselect,o.columnsConfigurations=[{text:l.name,dataIndex:"name",resizableFlag:!0,sortableFlag:!0,pinned:"left",width:"130px"}],o.container=t,o.uniqueIdentifier="suppSearch3dNetwork",o.applicationChannel=a,o.data_unavailable_message=l.no_retults,o.applicationChannelEvents=[],o.applicationChannelEvents.push({eventName:"add-model"}),i.init(o),i.collectionViewEvents.subscribe({event:"xsourcing-collectionview-selection-updated"},function(e){e.selectedItems.length>0?n.addButton.disabled=!1:n.addButton.disabled=!0})},m.prototype.subscribeEvents=function(){var e=this;e.expanderIcon.addEventListener("click",function(){e.addButton.disabled=!1,e.addButton.label=l.search,e.modal.setHeader(l.search_suppliers),e.formOpened=!0,e.formContainer.style.display&&"none"!==e.formContainer.style.display?e.formContainer.style.display="none":e.formContainer.style.display="block"})},m.prototype.processDropDownData=function(e){this.dropDownData={};var t=JSON.parse(d);this.dropDownData.industry=[],this.dropDownData.category=[],this.dropDownData.levels=t.level.map(e=>({value:e,label:l[e]})),this.dropDownData.preferences=t.preferences.map(e=>({value:e,label:l[e]})),this.dropDownData.country=e.dropDownData.country&&e.dropDownData.country.map(e=>({value:e,label:l[e]?l[e]:e})),e.dropDownData&&(this.dropDownData.industry=e.dropDownData.industry,this.dropDownData.category=e.dropDownData.category)},m.prototype.searchSuppliersByCriteria=function(t){var n=this;e.mask(n.newsuppDiv),t.postData=n.getSearchPayload(n.formValues),n.controller.searchSuppliersByCriteria(t).then(function(i){e.unmask(n.newsuppDiv),n.itemCountContainer.innerText=i.length+" "+l.items,n.collectionView._gridModel.prepareUpdate(),n.collectionView._gridModel.removeRoots(),i.forEach(function(e){n.collectionView._gridModel.addRoot(e)}),n.collectionView._gridModel.pushUpdate(),t.collectionViewEvents.publish({event:"xsourcing-collectionview-update-count"})})},m.prototype.hideSidePanel=function(){this.formContainer.style.display="none",this.formOpened=!1,this.addButton.disabled=!0,this.addButton.label=this.viewOptions.actionLabel?p.migrate:l.add,this.modal.setHeader(l.select_suppliers)},m.prototype.getSearchPayload=function(e){var t={data:[]},n={};for(let t in e)if(e.hasOwnProperty(t)&&e[t]&&"namefield"!==t){let i=e[t];1===i.length&&""===i[0]||("industry"===t?n.industries=i.map(e=>({id:e})):n[t]=i.map(e=>({id:e})))}return t.data.push({type:"company",id:e.namefield,attributes:n}),t},m}),define("DS/ENOXSourcingUXInfra/ObjectHistory/views/Rows",["UWA/Class/Promise","UWA/Class/View","UWA/Core","DS/UIKIT/Mask","DS/UIKIT/Scroller","DS/ENOXSourcingUXInfra/ObjectHistory/collections/Entries","DS/ENOXSourcingUXInfra/ObjectHistory/views/Row","i18n!DS/ENOXSourcingUXInfra/assets/nls/ENOXSourcingUXInfra","css!DS/ENOXSourcingUXInfra/ObjectHistory/SourcingTimeline.css","css!DS/ENOXSourcingUXInfra/ObjectHistory/views/Rows.css"],function(e,t,n,i,o,a,r,s){"use strict";return t.extend({name:"DS/ENOXSourcingUXInfra/ObjectHistory/views/Rows",tagName:"div",className:"timeline-default flat animated",defaultOptions:{parser:"",flat:9999},parent:null,physicalId:"",_logger:null,_scroller:null,_position:0,_rows:[],setup:function(e){e=n.merge(e||{},this.defaultOptions),this._parent(e),this.parent=e.parent,this.physicalId=e.physicalId,this.objectTitle=e.objectTitle;var t=this.collection=new a([],{physicalId:this.physicalId,objectTitle:this.objectTitle});return this.listenTo(t,"onReset",this._onReset),this.listenTo(this,"onScroll",this._onScroll),t.fetch({reset:!0,parser:e.parser?e.parser:null,onComplete:function(){},activityMappingObject:e.activityMappingObject}),this._scroller=null,this._position=0,this._rows=[],this},render:function(){var e=this;e.container.setAttribute("id","timeline-top");var t=n.createElement("div",{class:"timeline-main"});e._scroller=new o({element:e.container}).inject(t);var a={scroll:function(){var t=e._position=e._scroller._infos.y.scrollPosition;e.dispatchEvent("onScroll",{height:e.container.offsetHeight,position:t})}.bind(this)};return e._scroller.elements.content.addEvents(a),i.mask(e.container),e},_onReset:function(e,t){var o=this,a=o._scroller.getInnerElement();if(e.length>0)o.container.addClassName("timeline"),e.forEach(function(e){var n=new r({model:e,parent:o,options:t}).render();o.addRow(n),a.insertBefore(n.container,a.firstChild)}),i.unmask(o.container),o.dispatchEvent("onScroll",{height:o.container.offsetHeight,position:0});else{o.container.removeClassName("timeline");var l=n.createElement("div",{class:"timeline-error",html:s.history_norecords});a.insertBefore(l,a.firstChild),i.unmask(o.container),o.dispatchEvent("onScroll",{height:o.container.offsetHeight,position:0})}},addRow:function(e){this._rows.push(e)},_onScroll:function(e){for(var t=e.height,n=this._rows,i=0;i<n.length;i++){var o=n[i].container;t>o.getBoundingClientRect().top-this.container.getBoundingClientRect().top+o.offsetHeight&&(o.hasClassName("active")||o.addClassName("active"))}}})}),define("DS/ENOXSourcingUXInfra/ObjectHistory/SourcingTimeline",["UWA/Class/View","UWA/Core","DS/UIKIT/Input/Toggle","DS/UIKIT/Tooltip","DS/ENOXSourcingUXInfra/Mediator","i18n!DS/ENOXSourcingUXInfra/assets/nls/ENOXSourcingUXInfra","DS/ENOXSourcingUXInfra/ObjectHistory/views/Rows","css!DS/ENOXSourcingUXInfra/ObjectHistory/SourcingTimeline.css"],function(e,t,n,i,o,a,r){"use strict";return e.extend({name:"DS/ENOXSourcingUXInfra/ObjectHistory/SourcingTimeline",tagName:"div",className:"timeline-component",defaultOptions:{parser:""},view:null,_subscriberTokens:[],setup:function(e){e=t.merge(e||{},this.defaultOptions),this._parent(e),this._subscribers()},render:function(){this.container.empty();var e=this.view=new r({physicalId:this.getOption("physicalId"),objectTitle:this.getOption("objectTitle"),activityMappingObject:this.getOption("activityMappingObject"),parser:this.getOption("parser"),parent:this});this.container.setContent(e.render().container);var t=this.getOption("historyContainer");return t&&this.container.inject(t),this},reset:function(){this.view.destroy()},_subscribers:function(){var e=this,t=(new o).createNewChannel();t.subscribe({event:"reload-history-content"},function(){e.render()}),e.historyApplicationChannel=t},initHistoryTab:function(e,n){var i=this,o="Activity"===e.selectedTab,r=t.createElement("div",{styles:{height:"100%",width:"100%"}}),s={label:a.activity,content:r,icon:{iconName:"navigation-history",fontIconFamily:1},isSelected:o,index:100,value:"Activity"};n.add(s);var l=function(e){e.empty(),i.render().inject(e)};n.addEventListener("tabButtonClick",function(){"Activity"===n.value[0]&&l(r)}),o&&l(r)}})}),define("DS/ENOXSourcingUXInfra/SupplyNetworkSearchView/SupplyNetworkSearchController",["DS/ENOXSourcingUXInfra/SupplyNetworkSearchView/SupplyNetworkSearchModel","DS/ENOXSourcingUXInfra/SupplyNetworkSearchView/SupplyNetworkSearchView","DS/UIKIT/Mask","DS/ENOXSourcingUXInfra/Search/SearchUtility"],function(e,t,n,i){"use strict";var o=function(t){this.app=t.app,this.eventBroker=this.app._applicationChannel,this.model=new e,this.searchUtil=new i};return o.prototype.processSupplierSearchCriteriaValues=function(e,t){var n={};if(e&&e.data.forEach(function(e){void 0===n[e.type]&&(n[e.type]=[]),"industry"===e.type?n[e.type].push({value:e.attributes.translation[0].value,label:e.attributes.translation[0].value}):"categorylibrary"===e.type&&n[e.type].push({value:e.id,label:e.id})}),n.country=[],t&&t.length>0){let e=t.SRC_CountryOfOrigin.range.replace("[","").replace("]","").split(",");e=e.map(e=>e.trim()),n.country=Array.isArray(e)?e:[]}return n},o.prototype.searchSuppliersByCriteria=function(e){var t=this;return new Promise(function(n){t.model.searchSuppliersByCriteria(e).then(function(e){n(t.processSupplierSearchData(e))},function(){n([])})})},o.prototype.processSupplierSearchData=function(e){return!e||0===Object.keys(e).length&&e.constructor===Object?[]:e.data.map(e=>{var t={name:e.id,id:e.attributes.uuid,country:e.attributes.country,industry:e.attributes.industry,image:"ENOXSourcingUXInfra/assets/icons/Supplier_icon.png"};return{grid:t,label:t.name,subLabel:t.industry,description:t.country,thumbnail:require.toUrl(t.image),id:t.id}})},o.prototype.getInfoPayload=function(){return{postData:{data:[{type:"industries",attributes:{language:widget.lang}},{type:"categorylibrary"}]}}},o.prototype.manageSupplyNetworkSearch=function(e,i){var o=this;let a=e.field,r=e.maskingDiv,s=new t({...e.viewOptions,controller:this}),l=this.getInfoPayload();var c={...l};r&&n.mask(r);c.selectCallback=e.selectCallback||function(e){e.forEach(function(e){a.elements.input.value=e.options.grid.name,a.elements.input.id=e.options.grid.id,a.elements.input.setAttribute("identifier",e.options.grid.id)}),r&&n.unmask(r)};var d=[];return d.push(o.model.getSupplierSearchCriteriaValues(l)),new Promise(e=>{Promise.all(d.map(e=>e.catch(()=>null))).then(async function(t){if(c.dropDownData=o.processSupplierSearchCriteriaValues(t[0],t[1]),c.dropDownData.categorylibrary){let t=o.searchUtil.getSearchPayload([],["General Class"],["3dspace"],{nresults:500,start:0,with_nls:!1,isPersonOrGroup:!1});t.specific_source_parameter["3dspace"]={search_in_context:{expand:[{multi_root_physicalid:[c.dropDownData.categorylibrary[0].value],expand_iter:"-1",type_filter_rel:["Subclass"]}]},option:{with_Idx_Search:!0}},o.searchUtil.callFederatedSearch(t).then(async function(t){let n=o.searchUtil.processResults(t);if(c.dropDownData.category=[],n.forEach(function(e){c.dropDownData.category.push({value:e.physicalid,label:e["ds6w:label"]})}),i){let t=await s.render(c,i);e(t)}else s.render(c)})}else if(i){let t=await s.render(c,i);e(t)}else s.render(c)},function(e){throw widget.notificationUtil.showError(o.app.i18NProvider.unresponsive_3dnetwork),new Error(e)}).finally(function(){r&&n.unmask(r),o.eventBroker.publish({event:"supplier-search-view-loaded",data:{}})})})},o}),define("DS/ENOXSourcingUXInfra/components/CreateRequestForm/SourcingInformationHelper",["DS/ENOXSourcingUXInfra/service/ENOXSourcingService","i18n!DS/ENOXSourcingUXInfra/assets/nls/ENOXSourcingUXInfra","DS/ENOXSourcingUXInfra/service/ENOXSourcingPlatformServices","DS/ENOXSourcingUXInfra/Constants/ENOXSourcingConstants","DS/UIKIT/Mask","DS/ENOXSourcingUXInfra/Utilities/Utility","DS/ENOXSourcingUXInfra/xsourcingformview/ENOXSourcingForm","DS/ENOXSourcingUXInfra/DragAndDrop/ENOXSourcingDataDragAndDrop","DS/ENOXSourcingUXInfra/SupplyNetworkSearchView/SupplyNetworkSearchController"],function(e,t,n,i,o,a,r,s,l){"use strict";return UWA.Class.extend({init:function(e){this.options=e,this.app=e.app?e.app:widget.app,this.sourceDelimiter="~^~^",this.supplyNetworkController=this.app&&this.app.viewControllers&&this.app.viewControllers.supplyNetworkSearchController?this.app.viewControllers.supplyNetworkSearchController:new l({app:this.app}),this.utility=new a},getSourceTypeAttributesModel:function(t){let n=t.sourceType,o=void 0!==t.filterType?t.filterType:"";return t.endpoint="/resources/v1/modeler/dssourcing/type_hierarchy?type="+n+"&filterType="+o,t.source=i.SOURCE_SOURCING,e.getDataPromise(t)},getProxyObjectId:function(t){return t.endpoint="/resources/dssourcing/ProxyObject",t.source=i.SOURCE_SOURCING,t.postData=t.data,e.performPostPromise(t)},getSourceTypeAttributes:function(e){var t=this;return new Promise(function(n,i){t.getSourceTypeAttributesModel(e).then(function(e){let i=t.processAttributesResponseData(e);n(i)},function(e){i(e)})})},processAttributesResponseData:function(e){let t={};var n=function(e){let t={};t.sourceType=e.type,t.sourceTypeDisplay=e.dataelements.nlsName,t.abstractType=e.dataelements.abstractType;let i=[];e.children.forEach(function(e){let t={};t.name=e.dataelements.name,t.displayName=e.dataelements.nlsName,t.type=e.dataelements.type,t.default=e.dataelements.default,t.range=e.dataelements.range,i.push(t)}),t.attributes=i,t.subtypes=[];let o=e.relateddata["child-types"];return 0!==o.length&&o.forEach(function(e){t.subtypes.push(n(e))}),t};return t=n(e.data[0])},getSourceAttributesFieldsForForm:function(e){var n=this;return new Promise(function(a,s){let l=e.sourceType,c=e.formCount;n.getSourceTypeAttributes(e).then(function(s){n.sourceTypeDropdownRanges=n.getSourceTypeDropdownRanges(s,l),n.sourceAttributesObject=s;var d=function(e,t){let i=[];return n.utility.sortArrayAlphabeticallyBasedOnProperty(e.attributes,"name"),e.attributes.forEach(function(e){let o,a=n.getPredefinedFormFields(e.name,t);o=a||n.getFieldObjectForForm(e),i.push(o)}),i.push(n.getPredefinedFormFields("attachment")),i},u=function(a,s,l){return{type:"select",name:i.SRC_SOURCETYPE,label:t.source_type,options:n.changeSelectedValue(n.sourceTypeDropdownRanges,a),formCount:s,container:l,events:{onChange:function(){e.sourceType=this.getValue()[0],this.setValue({label:e.sourceType,value:e.sourceType});let t=this.options.formCount,i=this.options.container;o.mask(i),n.getSourceTypeAttributes(e).then(function(a){let s=d(a,t);s.splice(0,0,u(e.sourceType,t,i)),i.innerHTML="";let l=new r({fields:s,events:{onSubmit:e.onSubmit?e.onSubmit:function(){}}});l.inject(i),o.unmask(i),n.app._applicationChannel.publish({event:"source-type-form-changed",data:{formCount:t,formInstance:l,formDiv:i}})})}}}};let p=d(s,c);p.splice(0,0,u(l,c,e.container)),a(p)},function(e){s(e)})})},changeSelectedValue:function(e,t){return e.forEach(function(e){delete e.selected}),e.forEach(function(e){e.value===t&&(e.selected=!0)}),e},getSourceTypeDropdownRanges:function(e,t){if(this.sourceTypeDropdownRanges)return this.sourceTypeDropdownRanges;let n=[];var i=function(e){"true"!==e.abstractType&&(e.sourceType===t?n.push({label:e.sourceTypeDisplay,value:e.sourceType,selected:!0}):n.push({label:e.sourceTypeDisplay,value:e.sourceType})),e.subtypes.forEach(function(e){i(e)})};return i(e),n},getSourceInfoForm:function(e){var t=this;return new Promise(function(n){var i;t.getSourceAttributesFieldsForForm(e).then(function(o){i=new r({fields:o,events:{onSubmit:e.onSubmit?e.onSubmit:function(){}}}),t.activateDragAndDrop(i),i.inject(e.container),n(i)})})},getPredefinedFormFields:function(e,a){var r=this;let s;switch(e){case i.SRC_MANUFACTURER:case i.SRC_SUPPLIER_NAME:s={type:"autocompleteWithSearch",name:void 0===a?e:e+r.sourceDelimiter+a,searchOptions:{type:"Company",title:t.manufacturer},label:t.manufacturer,placeholder:t.placeholder,completePreCond:"([ds6w:type]:"+i.TYPE_COMPANY+i.AND+"current:"+i.STATE_ACTIVE+")",sources:[i.SOURCE_3DSPACE],enableFreeText:!0,allowChooserCallback:function(){return i.ONPREMISE!==n.getPlatformId()&&"3DSpace"!==widget.getValue("xsrcManufacturerSource")},chooserCallback:async function(e,t,n){let i={disallowedSearchCriteria:["country"],nonEmphasizeInactiveSupplier:!0,collaborationPanelHide:!0},a=e.getModelDiv();r.formReference=e,a&&o.mask(a);if(n){return await r.supplyNetworkController.manageSupplyNetworkSearch({viewOptions:{wizardOptions:void 0,viewOptions:i},field:t,maskingDiv:a},n)}r.supplyNetworkController.manageSupplyNetworkSearch({viewOptions:{wizardOptions:void 0,viewOptions:i},field:t,maskingDiv:a,selectCallback:function(e){this.formReference.wuxAutocompletes[0].selectedItems=e}.bind(r)})}};break;case"attachment":s={type:"autocompleteWithSearch",name:"document_ID",label:t.attachments,errorText:t.max_char_limit_err_msg,placeholder:t.type_or_drop_item,typeSearch:[i.DOCUMENT],sources:[i.SOURCE_3DSPACE],enableUpload:"OnPremise"===n.getPlatformId(),callback:function(e){r.attachmentFieldCallBack(e)},dropValidator:function(e){return new Promise((t,n)=>{r.utility.gettypeshierarchy(e).then(function(e){t(e.types_hierarchies[0].hierarchy.includes(i.DOCUMENT))})})}}}return s},getFieldObjectForForm:function(e){let n={type:e.type,name:e.name,label:e.displayName,value:e.default};switch(e.type.toLowerCase()){case"string":n.type="text";break;case"timestamp":n.type="date";break;case"real":case"integer":n.type="customNumberField",n.subtype=e.type;break;case"boolean":n.type="select",n.value&&(n.value=n.value.toUpperCase()),n.options=[{label:t.TRUE,value:"TRUE"},{label:t.FALSE,value:"FALSE"}]}return n},attachmentFieldCallBack:function(e){if(e.options.identifier!==e.getSelectedObjectAttrValue("value")){o.mask(e.getWrapperDiv(),t.fetching_details);var a=e.getInputField();if(a.value="",a.id="",a.setAttribute("identifier",""),a.setAttribute("actualID",""),e.getSelectedObjectAttrValue("value")){var r=e.getSelectedObjectAttrValue("value"),s=e.getSelectedObjectAttrValue("label"),l=e.getSelectedObjectAttrValue("sourceid"),c=e.getSelectedObjectAttrValue("ds6w:what/ds6w:status")?e.getSelectedObjectAttrValue("ds6w:what/ds6w:status"):e.getSelectedObjectAttrValue("stateNLS");if(r&&s){let u=s||"",p=l?l.split(":")[0]:i.SOURCE_3DSPACE,m=l?l.split(":")[1]:n.getPlatformId(),h=i.DOCUMENT_PROXY;var d={data:[{id:r,type:h,dataelements:{"ProxyItem.Proxy_Title":u,"ProxyItem.Proxy_Service":p,"ProxyItem.Proxy_State":c,"ProxyItem.Proxy_Tenant":m}}]};this.getProxyObjectId({data:d}).then(function(e){e&&e[r]&&(a.setAttribute("identifier",e[r]),a.value=s,a.id=e[r],a.setAttribute("actualID",r))}).catch(function(){widget.notificationUtil.showError(t.error_actual_id)}).finally(function(){o.unmask(e.getWrapperDiv())})}else o.unmask(e.getWrapperDiv())}else o.unmask(e.getWrapperDiv())}},attachDataSheetsToComponentRequest:function(t){var n,o=[],a=[];if(t.sourcesData.forEach(e=>{e.document_ID&&!a.includes(e.document_ID)&&(a.push(e.document_ID),o.push({type:i.TYPE_SRCCOMPONENTREQUEST,document_ID:e.document_ID,purpose:"reference",source:e.ID}))}),n={data:o},0===o.length)return new Promise(function(e){e(!1)});var r={};return r.endpoint="/resources/v1/modeler/dssourcing/sourcingrequests/"+t.crID+"/documents",r.source="sourcing",r.attachDocumentData=n,e.performPatchPromise(r)},makeAttachmentFieldsDroppable:function(e,t){var n=this;let i={onDropCallback:function(e){n.documentDropCallback(e,n,t)},inviteHandler:"disable"};i.dropArea=e,i.toggleSection=e,n.makeAreaDroppable(i)},makeSourcingFieldsDroppable:function(e,n){var o=this;let a={onDropCallback:function(a){a&&a.objectType===i.TYPE_PART_SUPPLY_FILE?o.partSupplyDropCallback(a,e,n):widget.notificationUtil.showError(t.only_part_supply_drop_supported)}};a.dropArea=e,a.toggleSection=e,o.makeAreaDroppable(a)},makeAreaDroppable:function(e){this.options=e,e.dropStrategy="CREATE",e.multiObjs=!1,e.applicationChannel=this.app._mediator.createNewChannel();var t=this.getDragAndDropInstance();t.makeAreaDroppable(e),t.dragEnteredCallback=function(){e.toggleSection.getElementsByClassName("dragging")[0]||(this.isEmptyView||"disable"===this._inviteHandler||(this._inviteHandler.addBorder(),this._inviteHandler.show(this.getOnDropLabel())),this._dropArea.classList.contains("dragging")||this._dropArea.classList.add("dragging"))},t.dragOverCallback=function(){e.toggleSection.getElementsByClassName("dragging")[0]||(this.isEmptyView||"disable"===this._inviteHandler||this._inviteHandler.show(this.getOnDropLabel()),this._dropArea.classList.contains("dragging")||this._dropArea.classList.add("dragging"))}},getDragAndDropInstance:function(){return new s},partSupplyDropCallback:function(e,n,a){var r=this;o.mask(n,t.fetching_details),a.map(function(t){t.name===i.SRC_MANUFACTURER_PART_NUMBER?t.value=e.opApi.attributes.partNumber:t.name===i.SRC_MANUFACTURER||t.name.contains(i.SRC_MANUFACTURER+r.sourceDelimiter)?t.value=e.opApi.attributes.provider.name:t.name===i.SRC_PART_SOURCE?t.value=i.PART_SUPPLY:t.name===i.SRC_PART_SOURCE_URL&&(t.value=e.opApi.url)}),o.unmask(n)},documentDropCallback:function(e,t,o){e.envId?o.fieldController.onDropCallback(e):i.ONPREMISE===n.getPlatformId()&&o.fieldController.uploadDocument(e)},activateDragAndDrop:function(e){this.makeAttachmentFieldsDroppable(e.getField("document_ID").getParent(".form-group"),e.wuxAutocompletes.filter(e=>"document_ID"===e.options.name)[0]),this.makeSourcingFieldsDroppable(e.getContent(),e.getFields())},validateSourceObject:function(e){for(let t in e)if(e.hasOwnProperty(t)&&e[t]&&![i.SRC_SOURCETYPE,"document_ID","document_Name"].includes(t))return!0;return!1}})}),define("DS/ENOXSourcingUXInfra/components/CreateRequestForm/SourcingInformation",["DS/Utilities/Dom","DS/UIKIT/Accordion","DS/UIKIT/Input/Button","i18n!DS/ENOXSourcingUXInfra/assets/nls/ENOXSourcingUXInfra","DS/ENOXSourcingUXInfra/Constants/ENOXSourcingConstants","DS/UIKIT/Tooltip","DS/Controls/TooltipModel","DS/UIKIT/SuperModal","DS/ENOXSourcingUXInfra/components/CreateRequestForm/SourcingInformationHelper","DS/ENOXSourcingUXInfra/Utilities/Utility","css!DS/ENOXSourcingUXInfra/components/CreateRequestForm/SourcingInformation.css"],function(e,t,n,i,o,a,r,s,l,c){"use strict";return UWA.Class.View.extend({_subscriberTokens:[],setup:function(e){this.app=e.app?e.app:widget.app,this.sourceCount=0,this.formCount=0,this.createSourcingForm=[],this.sourcingFields={},this.disabled=!1,this.partSupplyDropInfoState=!1,this.fieldElementsInternal=[],this.supplyNetworkController=this.app&&this.app.viewControllers?this.app.viewControllers.supplyNetworkSearchController:void 0,this.sourcingInformationHelper=new l(e),this.utility=new c,this._subscribers()},render:function(){return this.createSourcingDiv=UWA.createElement("div",{class:"modalSourcingDiv"}),this.addSourceInfoDiv=UWA.createElement("div",{class:"addSourceInfoDiv"}),this.createSourcingDiv.inject(this.container),this.addSourceInfoDiv.inject(this.container),this.container},_subscribers:function(){var e=this,t=e.app._applicationChannel;e._subscriberTokens.push(t.subscribe({event:"source-type-form-changed"},function(t){let n=t.formCount,i=t.formInstance;e.createSourcingForm[n]=i}))},loadSourcingFieldsForSumarryTab:function(){var e=this;let t=e.processSourceInformationValues(),n=[],a=e.getNLSOfAttributes();return t.forEach(function(t,r){if(!e.sourcingInformationHelper.validateSourceObject(t))return;delete t.document_ID;let s={type:"justLabel",label:i.source+"-"+(r+1)};n.push(s);for(let e in t)if(t.hasOwnProperty(e)){let i={type:"simpleText",label:a[r][e],forDisplay:!0,name:e,value:[o.SRC_SOURCETYPE].includes(e)&&a[r][t[e]]?a[r][t[e]]:t[e]};n.push(i)}}),n},rendersourcingFields:function(e){this.parentSourceType=e.sourceType;let t=this.createSourcingDiv;this.addHelperButton(t),this.deleteSourcingFields(e),this.addSourcingFields(e)},addHelperButton:function(e){var t=this;let o=new n({className:"formToolbar",attributes:{title:i.part_supply_info_tooltip}});o.setIcon("help"),o.inject(e);let r={onHide:function(){let e=t.sourcingDropArea;e&&e.classList.contains("dragging")&&e.classList.remove("dragging"),t.tooltipTimer&&clearTimeout(t.tooltipTimer)}};t.tooltip=new a({trigger:"click touch",position:"top",animate:!0,autoHide:!1,target:o.getContent(),events:r}),o.addEvent("onClick",function(){if(!t.tooltip.isVisible){let e=t.sourcingDropArea=t.createSourcingForm[0]?t.createSourcingForm[0].getContent():void 0;e&&!e.classList.contains("dragging")&&e.classList.add("dragging"),t.tooltipTimer=setTimeout(function(){e&&e.classList.contains("dragging")&&(e.classList.remove("dragging"),t.tooltip.hide())},8e3)}})},addPlusIcon:function(e){var t=this;let o=this.addSourceInfoDiv,a=new n({value:i.add_another_source});a.inject(o),t.addButton=a,a.addEvent("onClick",function(){if(a.setValue(i.add_another_source),t.sourceCount<5){widget.getElement("[class='modalSourcingDiv']");t.deleteSourcingFields(e),widget.notificationUtil.showInfo(i.adding+" "+i.source+"-"+(t.sourceCount+1)),e.sourceType=t.parentSourceType,t.addSourcingFields(e)}else widget.notificationUtil.showInfo(i.warning_more_than_5_sources)})},addSourcingFields:function(e){var n=this;let o=this.createSourcingDiv;o||(o=widget.getElement("[class='modalSourcingDiv']"));let a=UWA.createElement("div");e.container=a,e.formCount=n.formCount,n.sourcingInformationHelper.getSourceInfoForm(e).then(function(e){n.createSourcingForm[n.formCount]=e,n.createSourcingForm[n.formCount].hyperlink&&n.createSourcingForm[n.formCount].hyperlink.map(function(e){n.fieldElementsInternal.push(e)});let r=UWA.createElement("div",{styles:{marginBottom:"10px"},text:i.atleast_one_field_to_be_filled_common}),s=UWA.createElement("div",{html:[r,a]}),l=new t({className:"divided "+n.sourceCount,items:[{title:i.source+"-"+(n.sourceCount+1),content:s}]}),c=[];try{l.getContent().getElementsByClassName("content")[0].setStyle("paddingTop","0px")}catch(e){c.push(e)}l.selectItem(l.items[0]),l.inject(o),l.elements.container.addEvent("mouseenter",function(){!n.partSupplyDropInfoState&&n.tooltip&&(n.tooltip.show(),n.partSupplyDropInfoState=!0)}),l.elements.container.addEvent("mouseleave",function(){n.tooltip&&n.tooltip.isVisible&&n.tooltip.hide()}),n.sourceCount=n.sourceCount+1,n.formCount=n.formCount+1,n.createSourcingDiv.getElement(".xSourcingForm")&&n.addInfoIcon()})},addInfoIcon:function(){e.generateIcon({iconName:"info wux-ui-3ds",className:"infoIcon",tooltipInfos:new r({shortHelp:i.manufacturer_info})}).inject(this.createSourcingDiv.getElement(".xSourcingForm").getChildren()[1].getChildren()[0])},deleteSourcingFields:function(e){var t=this;let o=t.createSourcingDiv,a=new n({className:"formToolbar"});a.setIcon("trash"),a.elements.content.id=t.sourceCount,a.elements.content.title=i.remove,a.inject(o),a.addEvent("onClick",function(){t.deleteFieldAction(this,t)})},deleteFieldAction:function(e,t){let n=e.elements.content.id,o=parseInt(n)+1;var a=new s({renderTo:widget.body,okButtonText:i.remove}),r=i.source+o;a.confirm(i.remove_confirmation,i.remove+" - "+r,function(a){if(a&&!t.disabled){let a=widget.getElement("[class='modalSourcingDiv']");widget.notificationUtil.showInfo(i.removing+" "+i.source+"-"+o);let r=document.getElementsByClassName("divided "+n)[0];a.removeChild(r),a.removeChild(e.elements.container),t.createSourcingForm[n]=void 0,t.sourceCount=t.sourceCount-1,t.updateFields(n),0===t.sourceCount&&t.addButton.setValue(i.add_source)}})},updateFields:function(e){for(var t=e;t<=o.SOURCING_FORM_MAX_LIMIT;t++){var n=parseInt(t),a=document.getElementsByClassName("divided "+(n+1))[0];if(a){a.classList.remove(n+1),a.classList.add(n);var r=a.getElementsByClassName("accordion-item ")[0].getElementsByClassName("accordion-title ")[0].innerHTML;r=r.replace(i.source+"-"+(n+2),i.source+"-"+(n+1)),a.getElementsByClassName("accordion-item ")[0].getElementsByClassName("accordion-title ")[0].innerHTML=r,a.previousElementSibling.id=t}}},processSourceInformationValues:function(){var e=this;let t=[];var n=[];return e.createSourcingForm.map(function(i){if(!i)return;let o=i.getValues();var a=i.getField("document_ID").getAttribute("identifier"),r=i.getField("document_ID").value;a&&a.length>0?(n=a.split(","),o.document_ID=n[0],o.document_Name=r):i.getField("document_ID").value="";for(let t in o)t.contains(e.sourcingInformationHelper.sourceDelimiter)&&(o[t.split(e.sourcingInformationHelper.sourceDelimiter)[0]]=o[t],delete o[t]);e.sourcingInformationHelper.validateSourceObject(o)&&t.push(o)}),t},getNLSOfAttributes:function(){var e=this;let t=[];return e.createSourcingForm.map(function(n){if(!n)return;let a={};n.options.fields.forEach(function(t){a[t.name.split(e.sourcingInformationHelper.sourceDelimiter)[0]]=t.label,t.name===o.SRC_SOURCETYPE&&t.options.forEach(function(e){a[e.value]=e.label})}),a.document_Name=i.document,t.push(a)}),t},destroy:function(){var e=this;e._subscriberTokens.forEach(t=>e.app._applicationChannel.unsubscribe(t)),e.createSourcingForm=[],e.sourceCount=0,e.formCount=0,e.container.innerHTML="",e._parent()}})}),define("DS/ENOXSourcingUXInfra/components/SummarizeAndSubmit/SummarizeAndSubmit",["DS/ENOXSourcingUXInfra/PropertiesView/PropertiesView","DS/UIKIT/Input/Button","DS/UIKIT/Scroller","DS/ENOXSourcingUXInfra/components/CreateRequestForm/SourcingInformation","DS/ENOXSourcingUXInfra/Constants/ENOXSourcingConstants"],function(e,t,n,i,o){"use strict";var a=UWA.Class.View.extend({name:"summarize-and-submit",tagName:"div",className:"summarize-and-submit",domEvents:{},setup:function(t){this.app=t.app,this.model=t.model;var n=new UWA.Class.Model({fields:this.model.get("fields")||{},singleColumn:this.model.get("singleColumn")||!1,sourcingSummaryInfo:this.model.get("sourcingInfo"),app:this.app});this.propertiesView=new e({model:n,hideToolbar:!0}),this.buttons=this.model.get("buttons"),this.controller=t.controller},render:function(){var e=this;this.container.empty();var i=UWA.createElement("div",{class:"summary-info row"});if(new n({element:i}).inject(this.container),this.propertiesView.render().inject(i),this.buttons){let n=UWA.createElement("span",{id:"summaryButtons",class:"summary-buttons"});this.buttons.forEach(i=>{let o=new t(i);o.addEvent("onClick",function(){e.clickCallback.call(this,e,event)}),o.inject(n)}),e.renderButtons(n)}return this.container},renderButtons:function(e){this.controller.wizardComponent.currentStep.delegateButtons?this.controller.wizardComponent.currentStep.footer=e:e.inject(this.container)},destroy:function(){this.propertiesView.destroy(),this.propertiesView=null,this.button.destroy(),this.button=null,this._parent()}});return a.prototype.clickCallback=function(e){let{action:t}=this.options,n=document.getElementsByClassName("btn-default")["save-as-draft"],i=document.getElementsByClassName("btn-primary").submit;n&&i&&(n.disabled=!0,i.disabled=!0);let o=e.model.get("fields").reduce((e,t)=>{let{type:n,name:i,value:o,id:a,forDisplay:r,actualValue:s}=t;return{...e,..."justLabel"===n||t.forDisplay?{}:{[i]:void 0!==s?s:o},...a&&o&&""!==o&&void 0===s?{[i+"_ID"]:a}:{}}},t?{action:t}:{});e.app._applicationChannel.publish({event:"next-step-action",data:o})},a}),define("DS/ENOXSourcingUXInfra/modelers/ComponentRequest",["UWA/Class/Model","DS/ENOXSourcingUXInfra/service/ENOXSourcingService","DS/UIKIT/Mask","WebappsUtils/WebappsUtils","DS/ENOXSourcingUXInfra/Search/ENOXSourcingSearch","DS/ENOXSourcingUXInfra/Constants/ENOXSourcingConstants","DS/ENOXSourcingUXInfra/DocumentView/DocumentView","DS/ENOXSourcingUXInfra/service/ENOXSourcingPlatformServices","DS/ENOXSourcingUXInfra/Search/ENOXDashboardSearchUtility","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/ENOXSourcingUXInfra/components/CreateRequestForm/SourcingInformation","DS/ENOXSourcingUXInfra/Search/SearchUtility","DS/ENOXSourcingUXInfra/Utilities/Utility","DS/UIKIT/Input/Text","DS/UIKIT/Input/Number","DS/UIKIT/Input/Date","DS/UIKIT/Input/Select","css!DS/ENOXSourcingUXInfra/modelers/ComponentRequest.css"],function(e,t,n,i,o,a,r,s,l,c,d,u,p,m,h,f,g,v){"use strict";var S=void 0,w=void 0;let E={documents:[],documentArr:[]},C=new Set,y=[],b="",_=[],I=[];return UWA.Class.singleton({init:function(e){S=e.dataProvider.app,this.source="sourcing",this.searchUtil=new p,this.utility=new m,w=S.i18NProvider,e.dataProvider.compRequest=this,this._parent(e)},getEventToken:function(){return[{eventName:"createFormInstance",callbackFn:function(e){S.dataProvider.compRequest.createForm=e}},{eventName:"details-form-rendered",callbackFn:function(e){S.dataProvider.compRequest.renderSourceFromTemplate(e)}}]},create:function(e){return e.source=this.source,e.endpoint="/resources/v1/modeler/dssourcing/sourcingrequests",t.createServicePromise(e)},createSource:function(e){return e.source=this.source,e.endpoint="/resources/v1/modeler/dssourcing/sourcingrequests/"+e.id+"/source-information",t.performPostPromise(e)},getExtensions:function(e){return e.source="sourcing",e.endpoint="/resources/v1/modeler/dssourcing/requestCategory?$include=category_attributes&exclude=request_category&type=SRCComponentRequest&automaticAddition=true",t.getDataPromise(e)},getCategories:function(e){return e.source=this.source,e.endpoint="/resources/v1/modeler/dssourcing/requestCategory"+(e.include_attributes?"?$include=category_attributes":""),e.endpoint+="&type="+e.type,t.getDataPromise(e)},getClasses:function(e){return e.endpoint="/resources/v1/modeler/dslib/dslib:Class/"+e.id+"?$mask=dslib:ExpandClassesDetailsMask&$depth=20",e.source="3DSpace",t.getDataPromise(e)},getProxyObjectId:function(e){return e.endpoint="/resources/dssourcing/ProxyObject",e.source=this.source,e.postData=e.data,t.performPostPromise(e)},attachDocument:function(e){var n={};return n.endpoint="/resources/v1/modeler/dssourcing/sourcingrequests/"+e.id+"/documents",n.source=this.source,n.attachDocumentData=e.attachDocumentData,t.performPatchPromise(n)},getMatchedRequestTemplates:function(e){return t.getDataPromise(e)},listTypes:function(e){return new UWA.Promise(function(t){S.dataProvider.compRequest.getCategories({include_attributes:!0,type:e.requestType}).then(function(n){let{data:i}=n;if(!i||i.length<=0)throw new Error("Request types not found or service unavailable");if(e.requestTemplateData){let t=[...new Set(e.requestTemplateData.filter(e=>e.state===a.RELEASED))],n=t&&t.map(e=>e.requestCategory);i=i.filter(e=>n.includes(e.name))}let o=i.map(e=>{let{name:t,displayName:n}=e;return{label:n,grid:{name:n,value:t}}});t({requestCategories:i,model:{tiles:o}})})})},encode:function(e,t){if(!e.title||!e.requestCategory)throw new Error("Must provide required attributes");return{data:[{type:t,...Object.entries(e).reduce((e,t)=>{let n=t[0],i=t[1];return"title"===n&&(n="Title"),"action"!==n&&(e[n]=i),e},{})}]}},getFormFields:function(e){var t=this;let n=S.typesConfigurator[e.requestType].templateType,i=S.typesConfigurator[n]["input-items"].actions.includes("Source"),o="",r=e.requestCategory.name;o=e.requestCategory.name===a.COMPONENT_INTRODUCTION_REQUEST_V1?"("+a.TEMPLATE_REQUEST_CATEGORY_6W+':"'+a.COMPONENT_INTRODUCTION_REQUEST_V1+'"'+a.OR+a.TEMPLATE_REQUEST_CATEGORY_6W+':"'+a.COMPONENT_INTRODUCTION_REQUEST+'")':e.requestCategory.name===a.SOURCE_CHANGE_NOTIFICATION_V1?"("+a.TEMPLATE_REQUEST_CATEGORY_6W+':"'+a.SOURCE_CHANGE_NOTIFICATION_V1+'"'+a.OR+a.TEMPLATE_REQUEST_CATEGORY_6W+':"'+a.SOURCE_CHANGE_NOTIFICATION+'")':a.TEMPLATE_REQUEST_CATEGORY_6W+':"'+r+'"',e.classificationFilters&&e.classificationFilters.length>0&&(o+=a.AND+"("+a.TEMPLATE_COMPONENT_CATEGORY_6W+':"',e.classificationFilters.forEach((t,n)=>{o+=t+'"',e.classificationFilters[n+1]&&(o+=a.OR+a.TEMPLATE_COMPONENT_CATEGORY_6W+':"')}),o+=")");var d='flattenedtaxonomies:"types/'+n+'"'+a.AND+a.CURRENT+':"'+a.RELEASED+'"'+a.AND+"("+a.ISLASTREVISION+':"'+a.TRUE+'")'+a.AND+o;let u=[{type:"text",label:w.title,placeholder:w.enter_title,name:"title",required:!0,errorText:w.please_enter_title,isLengthy:!1},{type:"text",label:w.request_category,name:"requestCategory",disabled:!0},{type:"autocompleteWithSearch",label:w.request_template,name:"requestTemplate",placeholder:w.placeholder,required:!0,minLengthBeforeSearch:"disable",typeDelayBeforeSearch:"disable",errorText:w.please_enter_request_template,completePreCond:d,elementsTree:new c,sources:[a.SOURCE_SOURCING],callback:function(e){S.dataProvider.compRequest.clearExistingSourceForms();let n=e.getSelectedObjectAttrValue("resourceid");if(n&&i){let i=function(){if(b&&S.dataProvider.compRequest.createForm){let e=S.dataProvider.compRequest.createForm.getContent().getParent();if(e){S.dataProvider.compRequest.getSourcingInformation(b,!0).container.inject(e)}}};(b=e.autocompleteField.selectedItems?e.autocompleteField.selectedItems.getAttributeValue("Source"):void 0)?i():t.getIndextedAttributesOfRequestTemplate(n).then(function(e){b=e.source,i()})}}},{type:"textarea",label:w.description,name:"description",placeholder:w.enter_description,errorText:w.max_char_limit_err_msg,isLengthy:!0,helperText:w.length_256_limit},{type:"autocompleteWithSearch",label:w.request_components,name:"impactedItem",placeholder:w.type_search_input_item,multiSelect:!0,typeSearch:S.typesConfigurator[n]["input-items"].types,searchInfields:[a.MANUFACTURER_PART_NUMBER_TAG,a.MANUFACTURER_TITLE_TAG],tenant:s.getPlatformId(),sources:[a.SOURCE_3DSPACE,a.SOURCE_SOURCING],resourceid_in:widget.app.answerItemData?widget.app.answerItemData.inputItems:[],allowDrop:!0,allowObsolete:!0},{type:"date",label:w.due_date,placeholder:w.due_date,name:"SRCREQUEST.DueDate"},...S.typesConfigurator[e.requestType].contexts.some(e=>"contextProject"===e.name)?[{type:"autocompleteWithSearch",label:w.contextProject,placeholder:w.type_search_input_item,name:a.CONTEXT_PROJECT,errorText:w.max_char_limit_err_msg,isLengthy:!1,multiSelect:!1,showSuggestsOnFocus:!0,floatingSuggestions:!1,allowFreeInput:!0,allowDrop:!1,searchButtonNotRequired:!1,completePreCond:a.CONTEXT_PROJECT_OP_SEARCH_QUERY,sources:[a.SOURCE_3DSPACE,a.SOURCE_3DPLAN],events:l.getProxyObjectEvents(a.TYPE_PROJECT_SPACE_ITEM_PROXY)}]:[],...S.typesConfigurator[e.requestType].contexts.some(e=>"contextProduct"===e.name)?[{type:"autocompleteWithSearch",label:w.contextProduct,placeholder:w.type_search_input_item,name:a.CONTEXT_PRODUCT,errorText:w.max_char_limit_err_msg,isLengthy:!1,multiSelect:!1,showSuggestsOnFocus:!0,floatingSuggestions:!1,allowFreeInput:!1,allowDrop:!1,completePreCond:a.CONTEXT_PRODUCT_SEARCH_QUERY,sources:[a.SOURCE_3DSPACE,a.SOURCE_3DPLAN],searchButtonNotRequired:!1,events:l.getProxyObjectEvents(a.TYPE_MODEL_PROXY)}]:[],...S.typesConfigurator[e.requestType].contexts.some(e=>"contextPlant"===e.name)?[{type:"autocompleteWithSearch",label:w.contextPlant,placeholder:w.type_search_input_item,name:a.CONTEXT_PLANT,isLengthy:!1,multiSelect:!1,itemMultiSelect:!1,allowFreeInput:!1,showSuggestsOnFocus:!0,floatingSuggestions:!0,allowDrop:!1,searchButtonNotRequired:!1,completePreCond:a.CONTEXT_PLANT_SEARCH_QUERY,sources:[a.SOURCE_3DSPACE,a.SOURCE_3DPLAN],events:l.getProxyObjectEvents(a.TYPE_PLANT_ITEM_PROXY)}]:[]];if(e.requestCategory){let n=t.getCategoryFields(e.requestCategory);u=u.concat(n)}if(e.extensions.items>0){let n=t.getExtensionFields(e.extensions.data);u=u.concat(n)}return new UWA.Promise(function(e){e({fields:u,buttons:[{type:"submit",name:"create",id:"createBtn",form:"wizardForm",class:"btn btn-primary",text:w.next,value:w.next,events:{click:function(){let e=S.dataProvider.compRequest.getSourcingInformation("",!1);y=e.processSourceInformationValues()}}}]})})},getCategoryFields:function(e){let t=[],n={type:"justLabel",label:w.additionalInfo};return t.push(n),e.category_attributes.forEach(e=>{let n=e,i={};switch(n.type){case"string":i.type="text";break;case"timestamp":i.type="date";break;default:i.type="text"}if(i.label=n.displayName?n.displayName:n.name,i.placeholder=n.displayName?n.displayName:n.name,i.name=n.name,void 0!==n.default&&(i.value=n.default),n.range){i.type="select";var o=n.range.substring(1,n.range.length-1).split(","),a=[],r=n.default;o.forEach(function(e,t){var o=e.trim(),s={label:n.displayRanges?n.displayRanges[t]:o,value:o};o===r&&(s.selected="true"),a.push(s),i.options=a})}t.push(i)}),t},getExtensionFields:function(e){let t=[];_=[],I=[];let n=[],i={type:"justLabel",label:w.deployable_extensions};return t.push(i),e.forEach(e=>{let i=[];if(n=[],e.category_attributes.length>0){_.push(e.displayName),e.category_attributes.forEach(e=>{I.push(e.name),e.range&&(e.type="select"),n.push(e);let t={type:e.type,label:e.displayName?e.displayName:e.name,placeholder:e.displayName?e.displayName:e.name,name:e.name};void 0!==e.default&&(t.value=e.default),i.push(t)});let o=UWA.createElement("div",{});n.forEach(e=>{this.createInputFieldsUI(e).inject(o)}),this.createInputFieldsUI(n).inject(o);let a={type:"accordeonMerge",label:e.displayName,content:o,fields:i};t.push(a)}}),_.length>0?t:[]},createInputFieldsUI:function(e){var t="xsrc-add-attributegroup-field",n=UWA.createElement("div",{}),i=e.displayName?e.displayName:e.name;UWA.createElement("label",{html:i,styles:{"padding-top":"10px"}}).inject(n);var o=UWA.createElement("div",{}).inject(n),r=[{label:w.TRUE,value:"True"},{label:w.FALSE,value:"False"}];switch(e.type){case"string":case"String":new h({placeholder:e.displayName?e.displayName:e.name,name:e.name,value:e.default?e.default:"",className:t,multiline:"true"===e.isMultiLine,disabled:"true"===e.readOnly}).inject(o);break;case"real":case"integer":case"Double":case"Integer":new f({placeholder:e.displayName?e.displayName:e.name,className:t,name:e.name,step:1,max:a.MAX,min:a.MIN,value:e.default?e.default:0,disabled:"true"===e.readOnly}).inject(o);break;case"date":case"timestamp":case"Date":var s=new g({placeholder:e.displayName?e.displayName:e.name,name:e.name,value:e.default?e.default:"",actualValue:e.default?e.default:"",disabled:"true"===e.readOnly,className:t});s.addEvent("onChange",function(){var e,t;t=(e=this).elements.picker.getDate()?new Date(e.elements.picker.getDate().getTime()).toDateString():"",e.elements.input.setAttribute("actualValue",t)}),s.inject(o);break;case"boolean":case"Boolean":new v({custom:!1,placeholder:!1,name:e.name,options:r,value:e.default?e.default:0,disabled:"true"===e.readOnly,className:t}).inject(o);break;case"select":var l=e.range,c=e.displayRange,d=l;l.constructor!==Array&&(d=(l=l.substring(1,l.length-1)).split(",")),c&&c.constructor!==Array&&(c=(c=c.substring(1,c.length-1)).split(","));var u=[],p=e.defaultValue;d.forEach(function(e,t){var n=e.trim();let i;c&&c.length>0&&(i=c[t]);var o={label:w[n]?w[n]:i||n,value:n};n===p&&(o.selected="true"),u.push(o)}),new v({custom:!1,placeholder:!1,name:e.name,options:u,value:e.default?e.default:0,disabled:"true"===e.readOnly,className:t}).inject(o)}return n},submitAction:function(e,t){var i=this;C.clear(),E.documents.length=0,E.documentArr.length=0,widget.getElement(".modal-content")?n.mask(widget.getElement(".modal-content")):n.mask(i.mainContainer),i.getProcessedData(e,t).then(e=>{i.createRequest(e.options,e.data,e.controller)}).catch(function(e){widget.notificationUtil.showError(e.internalError?e.internalError:e.error?e.error:e),widget.getElement(".modal-content")?n.unmask(widget.getElement(".modal-content")):n.unmask(i.mainContainer)})},getProcessedData:function(e,t){var n=this;return new Promise(i=>{let o={};o.options={addData:t.app.dataProvider[t.modeler].encode(e,t.requestType)},o.data=e,o.controller=t,e.impactedItem&&e.impactedItem_ID||e.componentcategory_ID?n.getProxyItemDetails(e,t).then(e=>{o.options=e,i(o)}):i(o)})},getProxyItemDetails:function(e,t){var n=this;return new Promise(i=>{let o={};o.options={addData:t.app.dataProvider[t.modeler].encode(e,t.requestType)};var a=[];e.impactedItem&&e.impactedItem_ID&&a.push(n.getInputItemDetails(e)),e.componentcategory_ID&&a.push(n.getClassificationDetails(e)),Promise.all(a).then(function(e){e.forEach(e=>{e.impactedItemProxyIds&&(o.options.addData.data[0].impactedItem_ID=e.impactedItemProxyIds),e.classificationProxyIds&&(o.options.addData.data[0].componentcategory_ID=e.classificationProxyIds)}),i(o.options)})})},getInputItemDetails:function(e){var t=this;return new Promise(n=>{let i=e.impactedItem_ID,o={impactedItemProxyIds:""},r=i.split(","),s=[];if(e.documents_ID&&(s=e.documents_ID.data.map(e=>e.document_ID)),r.length===s.length)o.impactedItemProxyIds=i,n(o);else{s.forEach(e=>{let t=r.indexOf(e);-1!==t&&r.splice(t,1)});let e=t.searchUtil.getSearchPayload(r,[a.VPMREFERENCE,a.TYPE_COMPONENT_REQUEST],[a.SOURCE_3DSPACE,a.SOURCE_SOURCING]);t.searchUtil.callFederatedSearch(e).then(function(e){t.processInputItemProxies(t.searchUtil.processResults(e),i).then(function(e){o.impactedItemProxyIds=e,n(o)})})}})},getClassificationDetails:function(e){var t=this;return new Promise(n=>{let i={classificationProxyIds:""};t.getProxyObject({id:e.componentcategory_ID,type:a.CLASSIFICATION,title:e.componentcategory,service:a.SOURCE_3DSPACE,state:a.STATE_ACTIVE,tenant:s.getPlatformId()}).then(t=>{t&&t[e.componentcategory_ID]&&(i.classificationProxyIds=t[e.componentcategory_ID]),n(i)})})},getProxyObject:function(e={}){let{id:t,type:i,title:o,service:a,state:r,tenant:s}=e;var l=this;return new Promise(e=>{let c={data:[{id:t,type:i,dataelements:{"ProxyItem.Proxy_Title":o,"ProxyItem.Proxy_Service":a,"ProxyItem.Proxy_State":r,"ProxyItem.Proxy_Tenant":s}}]};l.getProxyObjectId({data:c}).then(function(t){e(t)}).catch(function(){widget.notificationUtil.showError(w.error_actual_id),widget.getElement(".modal-content")?n.unmask(widget.getElement(".modal-content")):n.unmask(l.mainContainer)})})},processInputItemProxies:function(e,t){var n=this;return new Promise(i=>{let o=e.filter(e=>e["ds6w:what/ds6w:type"]!==a.TYPE_COMPONENT_REQUEST);if(o.length>0){var r=t.split(","),s=[];o.forEach(function(e){const t=new Promise(t=>{let i=e.resourceid,o=e["ds6w:label"],s=e.sourceid,l=e["ds6w:what/ds6w:kind"],c=e["ds6w:what/ds6w:status"],d=s?s.split(":")[0]:"",u=s?s.split(":")[1]:"",p=l&&l===a.MEI_EXTENSION?a.MEI_PROXY:a.ENG_ITEM_PROXY;n.getProxyObject({id:i,type:p,title:o,service:d,state:c,tenant:u}).then(e=>{e&&e[i]&&(r[r.indexOf(i)]=e[i]),t()})});s.push(t)}),Promise.all(s).then(function(){t=r.join(","),i(t)})}else i(t)})},createRequest:function(e,t,i){var o=i;let r,{action:s}=t,l=!1,c=!1;c="submit"===s;var d=widget.getElement(".modal-content");d?n.mask(d):n.mask(o.mainContainer),o.app.dataProvider[o.modeler].create(e).then(function(e){if(r=e.data[0],o.app.dataProvider.compRequest.specificationExists&&delete o.app.dataProvider.compRequest.specificationExists,Array.isArray(y)&&0!==y.length){let e=S.dataProvider.compRequest.getSourcingInformation("",!1),t={data:[]};y.forEach(function(n){e.sourcingInformationHelper.validateSourceObject(n)&&t.data.push({type:n[a.SRC_SOURCETYPE],...n})}),S.dataProvider.compRequest.createSource({id:r.id,postData:t}),e.sourcingInformationHelper.attachDataSheetsToComponentRequest({sourcesData:y,crID:r.id})}if(o.app.dataProvider.compRequest.attachresponseViewItem&&widget.app.answerItemData){var i="attach"+widget.app.answerItemData.view+"Item",s="inprocessView"===widget.app.answerItemData.view?w.added_in_process_item:w.added_answer_item;o.app.dataProvider.compRequest[i](r).then(()=>{widget.notificationUtil.showSuccess('"'+r.title+'" '+s)},function(e){widget.notificationUtil.showError(e.internalError)})}if(o.app.dataProvider.compRequest.attachDocument&&t.documents_ID&&t.documents_ID.data&&t.documents_ID.data.length>0&&o.app.dataProvider.compRequest.attachDocument({attachDocumentData:t.documents_ID,id:r.id}).then(function(){widget.notificationUtil.showSuccess(w.document_added_successfully),n.unmask(widget.body)},function(e){widget.notificationUtil.showError(e.internalError?e.internalError:e.error?e.error:e),n.unmask(widget.body)}),c){let e=o.app.dataProvider.lifecycle.encode({physicalid:r.id,fromstate:r.state,tostate:"Submitted"});o.app.dataProvider.lifecycle.promote(e).then(function(e){if("success"!==e.status)throw widget.notificationUtil.showError(e.internalError?e.internalError:e.report[0]?e.report[0].error:w.error_while_creating_component_request),o.app.logger.debug(e),new Error("issue with object promotion");o.app.logger.info("Successful Object Promotion")}).catch(function(e){o.app.logger.error(e),d?n.unmask(d):n.unmask(o.mainContainer)}).finally(function(){l&&(widget.app.answerItemData&&widget.app.answerItemData.evtObj.publish?(widget.app.answerItemData.evtObj.publish({event:"add-model",data:{view:widget.app.answerItemData.view}}),o.app.router.navigate("home.dummyRoute"),delete widget.app.answerItemData):o.app.router.navigate("home.ComponentRequestDetails",r))})}!0===e.success&&(l=!0,widget.notificationUtil.showSuccess(c?'"'+r.title+'" '+w.request_created_successfully:'"'+r.title+'" '+w.saved_as_draft))}).catch(function(e){let t=e.internalError?e.internalError:w.error_while_creating_component_request;-1!==t.indexOf("#1500745")&&-1!==t.indexOf("exceeds maximum length")&&(t=t.substring(t.lastIndexOf(": ")+2,t.length)),widget.notificationUtil.showError(t),o.app.logger.error(e),d?n.unmask(d):n.unmask(o.mainContainer);let i=document.getElementsByClassName("btn-default")["save-as-draft"],a=document.getElementsByClassName("btn-primary").submit;i&&a&&(i.disabled=!1,a.disabled=!1)}).finally(function(){l&&!c&&(widget.app.answerItemData&&widget.app.answerItemData.evtObj.publish?(widget.app.answerItemData.evtObj.publish({event:"add-model",data:{view:widget.app.answerItemData.view}}),o.app.router.navigate("home.dummyRoute"),delete widget.app.answerItemData):o.app.router.navigate("home.ComponentRequestDetails",r))})},getSummary:function(t){let n=[],i=[],o=[];E.documents.forEach(e=>{n.push(e.label),i.push(e.id),o.push({type:t.requestType,document_ID:e.id,purpose:e.isSpecification,source:"Input"})}),n=n.join(","),i=i.join(",");let a=t.data,{properties:r}=t.steps[2].data,s=r.get("fields"),l=[];s.forEach(e=>{if("accordeonMerge"===e.type){let t={type:"justLabel",label:e.label,name:e.label,nonEditable:!0,..."date"===e.type&&{actualValue:""}};l.push(t),e.fields.forEach(e=>{let t={type:"justLabel"===e.type?e.type:"simpleText",label:e.label,name:e.name,nonEditable:!0,..."date"===e.type&&{actualValue:""}};a[e.name].value&&(t.value=a[e.name].value),a[e.name].actualValue&&(t.actualValue=a[e.name].actualValue),l.push(t)})}else if(e.label!==w.deployable_extensions){let t={type:"justLabel"===e.type?e.type:"simpleText",label:e.label,name:e.name,nonEditable:!0,..."date"===e.type&&{actualValue:""}};l.push(t)}});let c={type:"simpleText",label:w.attachments,name:"documents",value:n,id:{data:o}};if(l.splice(9,0,c),t.steps[1].active){let e=t.steps[2].input.data.value?"":t.steps[2].input.data.name,n={type:"simpleText",label:S.dataProvider.compRequest.getAppNLSbyType(t.requestType).category_classification,name:"componentcategory",value:e,id:t.steps[2].input.data.proxyId};l.splice(2,0,n)}let d=[{value:w.save_as_draft,name:"save-as-draft",action:"save-as-draft"},{value:w.submit,name:"submit",className:"primary",action:"submit"}];l.forEach(e=>{if(a.hasOwnProperty(e.name)){if(e.value=a[e.name],"impactedItem"===e.name){let t="",o="";a[e.name].value&&a[e.name].value.length>0&&(t=e.value.value.map(e=>e._options.resourceid).join(","),o=e.value.value.map(e=>e.getLabel()).join(", ")),""!==i&&(o=o?o+", "+n:n,t=t?t+","+i:i),e.value=o,e.id=t}else a[e.name].id&&(e.value=a[e.name].value,e.id=a[e.name].id);e.value&&e.hasOwnProperty("actualValue")&&(e.actualValue=a[e.name].actualValue)}});let u=S.dataProvider.compRequest.getSourcingInformation("",!1).loadSourcingFieldsForSumarryTab();l=l.concat(u);let p=new e({fields:l,buttons:d,singleColumn:!0});return new UWA.Promise(function(e){e({summary:p})})},getFormModel:function(t){let n=t.data,i=t.steps,o=[];o=t.data.classificationFilters;let r={},s=2;if(i[1].active)if(n.value){let e=i[1].data.allReleasedTemplates.filter(e=>e.state===a.RELEASED&&e.islast===a.TRUE).filter(e=>-1!==i[1].input.data.value.indexOf(e.requestCategory));r.requestTemplate=S.dataProvider.compRequest.getRequestTemplateDetailsforTypeahead(e)}else{let e=i[1].data.templates.filter(e=>e.state===a.RELEASED&&e.islast===a.TRUE).filter(e=>-1!==i[1].input.data.value.indexOf(e.requestCategory)),t=[];for(var l=0;l<e.length;l++)for(var c=e[l],d=c["component-classification"],u=0;u<d.length;u++){var p=d[u];if(o.includes(p.Proxy_Title?p.Proxy_Title:p.name)){t.push(c);break}}r.requestTemplate=S.dataProvider.compRequest.getRequestTemplateDetailsforTypeahead(t),s=1}r.requestCategory={value:i[s].input.data.name,realValue:i[s].input.data.value};let m=i[0].data.requestCategories.find(e=>e.name===r.requestCategory.realValue);return new UWA.Promise(async function(a){S.dataProvider.compRequest.getFormFields({requestCategory:m,classificationFilters:i[1].active&&!n.value?o:void 0,componentCategory:i[1].active&&!n.value?n.name:void 0,requestType:t.requestType,extensions:await S.dataProvider.compRequest.getExtensions({})}).then(function(t){t.fields.forEach(function(e){r.hasOwnProperty(e.name)&&UWA.extend(e,r[e.name])});let n=new e({fields:t.fields,buttons:t.buttons,preSelectedTemplate:r.requestTemplate?r.requestTemplate.selectedItems[0]:void 0});a({properties:n})})})},getIdFilterPreConditionForFederatedSearch:function(e){return"physicalid=("+e.join(" OR ")+")"},getRequestTemplateDetailsforTypeahead:function(e){this.utility.sortArrayAlphabeticallyBasedOnProperty(e,"title");var t=S.dataProvider.compRequest.createModel(e);return{elementsTree:t,selectedItems:1===t.getRoots().length?[t.getRoots()[0]]:[]}},createModel:function(e){var t=S.dataProvider.compRequest.preprocessForModelCreation(e),n=new c;return n.prepareUpdate(),t.map(function(e){let t=S.dataProvider.compRequest.createNode(e);n.addRoot(t)}),n.pushUpdate(),n},preprocessForModelCreation:function(e){var t=[];return e.forEach(function(e){let n={resourceid:e.id,name:e.name,value:e.title,label:e.title+" ("+e.revision+")",Source:e.Source};t.push(n)}),t},createNode:function(e){return e.grid=e,new d(e)},getExistingClassificationsForRequestType:function(e){return new UWA.Promise(function(t,n){e.typesConfigurator=S.typesConfigurator,S.dataProvider.requestTemplate.list(e).then(function(n){var i=n.data.filter(t=>{let{"component-classification":n}=t||[],{requestCategory:i,state:o}=t,r=n.filter(e=>"General Class"===e.type||"Classification Proxy Item"===e.type).length>0,s=-1!==e.data.value.indexOf(i),l=o===a.RELEASED,c=t.islast===a.TRUE;return r&&s&&l&&c}),o=n.data.filter(t=>{let{requestCategory:n,state:i}=t,o=-1!==e.data.value.indexOf(n),r=i===a.RELEASED,s=t.islast===a.TRUE;return o&&r&&s}),r=i.reduce((e,t)=>{let{"component-classification":n}=t;return n&&n.filter(e=>"General Class"===e.type||"Classification Proxy Item"===e.type)?[...e,...n]:e},[]).map(e=>({label:e.Proxy_Title?e.Proxy_Title:e.name,grid:{name:e.Proxy_Title?e.Proxy_Title:e.name,id:e.id,proxyId:e.Proxy_Id?e.Proxy_Id:void 0},icons:["library-class"],children:[]})).filter((e,t,n)=>n.findIndex(t=>t.label===e.label)===t);t({model:{tiles:r,placeholder:w.empty_category_classification_set_message||"This is a NLS error",buttons:[{type:"submit",name:"create",id:"createBtn",class:"btn btn-primary",events:{click:function(){S._applicationChannel.publish({event:"next-step-action",data:e.data})}},text:w.skip,value:w.skip}],columnConfigurations:[{dataIndex:"tree",width:"100%"}],getHierarchicalData:function(e){var t=e.data.nodeModel,n=e.options._xsourcingCollectionViewUI._toolbarChannel._pubsub;t.hasChildren()?e.target.preExpandDone():S.dataProvider.compRequest.getClasses({id:t.getAttributeValue("proxyId")?t.getAttributeValue("proxyId"):t.getAttributeValue("id")}).then(function(t){t.member[0].ChildClasses.member.forEach(function(t){if(t.state!==a.OBSOLETE&&t.state!==a.INACTIVE){var n=""!==t.title?t.title:t.name,i=S.dataProvider.compRequest.createNodeForCompCategory({label:n,id:t.id,icon:"library-class",name:n});e.target.addChild(i);var o=function(e,n){e.ChildClasses&&e.ChildClasses.member&&e.ChildClasses.member.forEach(function(e){if(e.state!==a.OBSOLETE&&t.state!==a.INACTIVE){var i=""!==e.title?e.title:e.name,r=S.dataProvider.compRequest.createNodeForCompCategory({label:i,id:e.id,icon:"library-class",name:i});n.addChild(r),o(e,r)}})};o(t,i)}})}).finally(function(){e.target.preExpandDone(),n.publish(void 0,"/enox-collection-toolbar-sort-activated/",{sortAttribute:"name",sortOrder:"ASC"})})},onCellSelection:function(e){let t=[];e.nodeModel.getParents().forEach(function(e){t.push(e.getAttributeValue("name"))}),t.push(e.nodeModel.getAttributeValue("name"));let n=e.nodeModel.options.grid;n.proxyId=n.id,n.classificationFilters=t,S._applicationChannel.publish({event:"next-step-action",data:n})}},templates:i,allReleasedTemplates:o})}).catch(function(e){n(e)})})},createNodeForCompCategory:function(e={}){let{label:t,id:n,icon:i="",name:o}=e;return new d({label:t||"Label not available",icons:[i],grid:{name:o,id:n}})},getAppNLSbyType:function(e){let t=S.typesConfigurator.appName?S.typesConfigurator.appName:S.typesConfigurator[e].appName;return S.i18NGrouped[t]},getSteps:function(e){return[{title:w.request_category,icon:"doc-text",route:"modal.wizard.type",dataProvider:"compRequest",dataMethod:"listTypes",view:"SingleTileSelector",viewModel:"model",active:!0},{title:S.dataProvider.compRequest.getAppNLSbyType(e.requestType).category_classification,icon:"library-books",route:"modal.wizard.category",dataProvider:"compRequest",dataMethod:"getExistingClassificationsForRequestType",view:"HierarchicalView",viewModel:"model",active:!0,delegateButtons:!0},{title:w.request_details,icon:"attributes",route:"modal.wizard.details",dataProvider:"compRequest",dataMethod:"getFormModel",view:"CreateRequestForm",viewModel:"properties",active:!0,delegateButtons:!0},{title:w.attachments,icon:"attach",route:"modal.wizard.documents",dataProvider:"compRequest",dataMethod:"getDocumentsModel",view:"CreateCollectionView",viewModel:"model",delegateButtons:!0,active:!0},{title:w.summary,icon:"list-ok",route:"modal.wizard.summary",dataProvider:"compRequest",dataMethod:"getSummary",view:"RequestCreationSummary",viewModel:"summary",active:!0,delegateButtons:!0}]},getHeader:function(){return w.new_request},getDocumentsModel:function(e){return new UWA.Promise(function(t){S.dataProvider.compRequest.getDocumentsConfigurations(e).then(function(e){t({model:{tabName:"document",buttons:e.buttons,toolbarActions:e.toolbarActions,onContextualEventCallback:e.onContextualEventCallback,gridData:C,searchable:!1,placeholder:w.Documents_Empty_Message,removeCallback:e.removeCallback}})})})},getDocumentsConfigurations:function(e){var t=this;return delete t.specificationExists,new UWA.Promise(function(a){a({columns:[],buttons:[{type:"submit",name:"create",id:"createBtn",class:"btn btn-primary",events:{click:function(){0===e.steps[3].data.model.gridData.size&&(E.documents.length=0),S._applicationChannel.publish({event:"next-step-action",data:e.data})}},text:w.Review,value:w.Review}],toolbarActions:[{fonticon:"plus",text:w.add,content:[{text:w.document_as_specification,className:"header"},{id:"UploadSpecification",text:w.upload,icon:i.getWebappsAssetUrl("ENOXSourcingUXInfra","icons/32/AddDocument-22.png"),className:"OnPremise"===s.getPlatformId()?"":"cloudDisable",handler:function(){if(t.specificationExists)return widget.notificationUtil.showInfo(w.specification_document_already_exists),void n.unmask(widget.body);t.launchFileUpoad(!0,"mono")}},{id:"AddExisitingSpecification",text:w.add_existing,icon:i.getWebappsAssetUrl("ENOXSourcingUXInfra","icons/32/I_CatalogAddPLMItemCBPRef.png"),handler:function(){if(t.specificationExists)return widget.notificationUtil.showInfo(w.specification_document_already_exists),void n.unmask(widget.body);(new o).init(t.get3DSearchOptions({multiSel:!1,isSpecification:!0}))}},{id:"AddExisitingSpecificationFromParent",text:w.add_existing_from_parent,icon:i.getWebappsAssetUrl("ENOXSourcingUXInfra","icons/32/I_CatalogAddPLMItemCBPRef.png"),disabled:!widget.app.answerItemData,handler:function(){if(t.specificationExists)return widget.notificationUtil.showInfo(w.specification_document_already_exists),void n.unmask(widget.body);(new o).init(t.get3DSearchOptions({multiSel:!1,isSpecification:!0,fromParent:!0}))}},{text:w.document_as_reference,className:"header"},{id:"UploadReference",text:w.upload,icon:i.getWebappsAssetUrl("ENOXSourcingUXInfra","icons/32/AddDocument-22.png"),className:"OnPremise"===s.getPlatformId()?"":"cloudDisable",handler:function(){t.launchFileUpoad(!1)}},{id:"AddExisitingReference",text:w.add_existing,icon:i.getWebappsAssetUrl("ENOXSourcingUXInfra","icons/32/I_CatalogAddPLMItemCBPRef.png"),handler:function(){(new o).init(t.get3DSearchOptions({multiSel:!0,isSpecification:!1}))}},{id:"AddExisitingReferenceFromParent",text:w.add_existing_from_parent,icon:i.getWebappsAssetUrl("ENOXSourcingUXInfra","icons/32/I_CatalogAddPLMItemCBPRef.png"),disabled:!widget.app.answerItemData,handler:function(){(new o).init(t.get3DSearchOptions({multiSel:!0,isSpecification:!1,fromParent:!0}))}}]},{id:"delete",text:w.remove,fonticon:"remove",handler:function(){S._applicationChannel.publish({event:"delete-document-items",data:{}})}}],onContextualEventCallback:function(e){var t=[];if(e){var n=e.cellInfos&&e.cellInfos.nodeModel?e.cellInfos.nodeModel:null;if(-1===(e.cellInfos?e.cellInfos.rowID:null)||!n)return this._contextualMenuBuilder?this._contextualMenuBuilder.buildMenu(e):[];t.push({id:"Delete",type:"PushItem",title:w.remove,fonticon:{content:"wux-ui-3ds wux-ui-3ds-remove"},action:{callback:function(){S._applicationChannel.publish({event:"delete-document-items",data:{}})}}})}return t},removeCallback:function(e){let n=!1;e.forEach(function(e){let t=e.options.isSpecification;t&&(n=!0);let i=e.options.collectionId,o=E.documents.findIndex(e=>e.id===i&&e.isSpecificationBool===t);-1!==o&&E.documents.splice(o,1);let a=E.documentArr.findIndex(e=>e.id===i&&e.isSpecificationBool===t);-1!==a&&E.documentArr.splice(a,1),C.forEach(function(e){e.collectionId===i&&e.isSpecification===t&&C.delete(e)})}),n&&delete t.specificationExists}})})},get3DSearchOptions:function(e){var t=this;let i=e.fromParent&&widget.app.answerItemData?widget.app.answerItemData.documents:[];return{title:"Documents",typeSearch:a.DOCUMENT,multiSel:e.multiSel,excludeCondition:a.EXCLUDE_OBSOLETE,resourceid_in:i,resourceid_not_in:E.documentArr.map(e=>e.actualID),callbackMethod:function(i){var o=[];i.forEach(r=>{if(r&&r.sourceid&&!r.sourceid.toLocaleLowerCase().contains(a.SOURCE_SOURCING)&&a.ONPREMISE!==s.getPlatformId()){let a=r.sourceid?r.sourceid.split(":")[0]:"",s=r.sourceid?r.sourceid.split(":")[1]:"";o.push({id:r.id,type:"Document",dataelements:{"ProxyItem.Proxy_Title":r["ds6w:label"],"ProxyItem.Proxy_Service":a,"ProxyItem.Proxy_State":i[0]["ds6w:status_value"],"ProxyItem.Proxy_Tenant":s}});var l={data:o};n.mask(widget.body),t.getProxyObjectId({data:l}).then(function(i){t.populateDocumentDataInWizard([r],e.isSpecification,i),n.unmask(widget.body)})}else t.populateDocumentDataInWizard([r],e.isSpecification)})}}},populateDocumentDataInWizard:function(e,t,n){for(var i=0;i<e.length;i++){let a=e[i]["ds6w:label"]?e[i]["ds6w:label"]:e[i].dataelements.title,r=n&&n[e[i].id]?n[e[i].id]:e[i].id,s={label:a,subLabel:e[i]["ds6w:status"]?e[i]["ds6w:status"]:e[i].dataelements.stateNLS,icons:[],thumbnail:e[i].preview_url?e[i].preview_url:e[i].dataelements.image,description:(e[i]["ds6w:responsible"],e[i]["ds6w:responsible"]),statusbarIcons:[],statusbarIconsTooltips:[],emptyStatusbarVisibleFlag:!1,activeFlag:!1,contextualMenu:["Delete"],collectionId:r,isSpecification:t,forceAdd:!0};t&&(this.specificationExists=!0);let l=!0;for(var o=0;o<E.documentArr.length;o++)if(E.documentArr[o].id===r&&E.documents[o]&&t===E.documents[o].isSpecificationBool){l=!1,s.forceAdd=!1;break}l?(E.documentArr.push({id:r,actualID:e[i].id,isSpecificationBool:t}),E.documents.push({id:r,label:a,isSpecificationBool:t,isSpecification:t?"specification":"reference"}),e[i]["ds6w:label"]?widget.notificationUtil.showSuccess(w.one_document_added_successfully):widget.notificationUtil.showSuccess(w.document_uploaded_successfully)):widget.notificationUtil.showInfo(a+w.already_selected),S._applicationChannel.publish({event:"add-document-item",data:s})}},launchFileUpoad:function(e,t){var i=this,o=new UWA.Class.Model({isSpecification:!1}),a=new r({model:o});i.documentView=a,a.launchFileChooser(function(t){if(t)for(var o=0;o<t.length;o++){const l=t[o];if(a.validateUploadFile(l.name)){var r={title:l.name||"unNamed",fileInfo:{comments:"",file:l}},s=widget.getElement(".modal-content");s&&n.mask(s,w.uploading_document),a.createDocument(r).then(function(t){i.populateDocumentDataInWizard(t,e),n.unmask(s)}).catch(function(){n.unmask(s)})}}},t)},attachinprocessViewItem:function(e){var n={};return n.endpoint="/resources/v1/modeler/dssourcing/sourcingrequests/"+widget.app.answerItemData.parentObjectid+"/inprocess-items",n.source=this.source,n.attachDocumentData={data:[{inProcessItem_ID:e.id}]},t.performPatchPromise(n)},attachresponseViewItem:function(e){var n={};return n.endpoint="/resources/v1/modeler/dssourcing/sourcingrequests/"+widget.app.answerItemData.parentObjectid+"/answer-items",n.source=this.source,n.attachDocumentData={data:[{answerItem_ID:e.id}]},t.performPatchPromise(n)},getSourcingInformation:function(e,t,n){let i=this.sourcingInformation;if(i){if(!t)return i;i.destroy()}return this.sourcingInformation=i=this.getSourceInformationInstance(n),i.render(),i.rendersourcingFields({sourceType:e}),i.addPlusIcon({sourceType:e}),i},getSourceInformationInstance:function(e){return new u({app:S,model:e})},renderSourceFromTemplate:function(e){if(e.preSelectedTemplate){let t=e.preSelectedTemplate.getAttributeValue("Source");if(t){let n=e.createForm.getContent().getParent();S.dataProvider.compRequest.getSourcingInformation(t,!0).container.inject(n)}else S.dataProvider.compRequest.clearExistingSourceForms()}},clearExistingSourceForms:function(){let e=S.dataProvider.compRequest.getSourcingInformation("",!1);e&&e.destroy(),y=[]},getIndextedAttributesOfRequestTemplate:function(e){return new Promise(function(n){var i={label:"test",locale:"en",select_predicate:[a.Source_Index_Name_ReqTemp],query:'flattenedtaxonomies:"types/SRCComponentRequestTemplate"',source:function(){let e=["sourcing"];return"OnPremise"===s.getPlatformId()&&(e=["3dspace"]),e}(),tenant:s.getPlatformId(),resourceid_in:[e]};t.getFederatedSearchDataPromise({searchPayLoad:i}).then(function(e){let t={};e.results[0].attributes.forEach(function(e){a.Source_Index_Name_ReqTemp===e.name&&(t.source=e.value)}),n(t)})})}})}),define("DS/ENOXSourcingUXInfra/components/CreateCollectionView/CreateCollectionView",["UWA/Class/View","DS/CollectionView/ResponsiveTilesCollectionView","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/ENOXSourcingUXInfra/Mediator","WebappsUtils/WebappsUtils","DS/ENOXSourcingUXInfra/Search/ENOXSourcingSearch","DS/ENOXCollectionToolBar/js/ENOXCollectionToolBarV2","DS/UIKIT/Scroller","DS/UIKIT/SuperModal","DS/Utilities/Dom","i18n!DS/ENOXSourcingUXInfra/assets/nls/ENOXSourcingUXInfra","DS/ENOXSourcingUXInfra/modelers/ComponentRequest","DS/ENOXSourcingUXInfra/Constants/ENOXSourcingConstants","DS/ENOXSourcingUXInfra/DocumentView/DocumentView","DS/UIKIT/Mask"],function(e,t,n,i,o,a,r,s,l,c,d,u,p,m,h,f){"use strict";return e.extend({name:"CreateCollectionView",tagName:"div",className:"create-collection-view",domEvents:{},setup:function(e){this.flagHeaderBar=!0,this.toolbarOptions={};var t=this;this.app=e.app,this.controller=e.controller,this.currentStep=this.controller.wizardComponent.currentStep,this.model={...e.model},this.tabName=this.model.tabName||"collection",this.toolbarOptions.actions=this.model.toolbarActions,this.headerBarElems=this.model.headerBarElems,this.model.searchable&&(this.toolbarOptions.filter={enableCache:!0}),this.gridModel=new n;for(const e of this.model.gridData)this.gridModel.addRoot(new i(e));this.app._applicationChannel.subscribe({event:"add-"+t.tabName+"-headerBar"},function(e){t.flagHeaderBar&&(t.flagHeaderBar=!1,t.addHeaderBar(e))}),this.app._applicationChannel.subscribe({event:"remove-"+t.tabName+"-headerBar"},function(){t.flagHeaderBar=!0,t.render()}),this.app._applicationChannel.subscribe({event:"add-"+t.tabName+"-item"},function(e){t.addCollectionItem(e)}),this.app._applicationChannel.subscribe({event:"delete-"+t.tabName+"-items"},function(e){t.deleteCollectionItems(e)})},addCollectionItem:function(e){let t=!0;for(const n of this.model.gridData)if(n.collectionId===e.collectionId){t=!1;break}t&&(Array.isArray(this.model.gridData)?this.model.gridData.push(e):this.model.gridData.add(e),this.gridModel.addRoot(new i(e)),Array.isArray(this.model.gridData)&&this.render()),this.update()},deleteCollectionItems:function(){var e=[],t=this,n=t.gridModel.getSelectedNodes();if(n){var i=n.length;if(i>0){var o=u.remove+" - "+i+" items";1===i&&(o=u.remove+" - "+n[0]._options.label),new c({renderTo:t.app.widget.body,okButtonText:u.remove,className:"wizard-dialog"}).confirm(u.remove_confirmation,o,function(o){if(o){for(var a=0;a<i;a++){t.gridModel.prepareUpdate();for(var r=t.gridModel.getChildren(),s=r.length,l=0;l<s;l++){var c=r[l];if(c._id.toString()===n[a]._id.toString()){e.push(n[a]._options.collectionId),c.remove(),t.model.removeCallback&&t.model.removeCallback(n);break}}var d=[];if(Array.isArray(t.model.gridData)){for(var u=0;u<t.model.gridData.length;u++)t.model.gridData[u].collectionId!==n[a]._options.collectionId&&d.push(t.model.gridData[u]);t.model.gridData=d,d=[]}t.gridModel.pushUpdate()}e.length>0&&t.app._applicationChannel.publish({event:"update-collection-data",data:{tab:t.tabName,idArr:e}}),Array.isArray(t.model.gridData)&&t.render(),t.update()}}),document.querySelector(".modal-content").getBoundingClientRect().width>0&&(document.querySelector(".wizard-dialog > .modal-wrap > .modal-content").style.width=document.querySelector(".modal-content").getBoundingClientRect().width+"px")}}},addHeaderBar:function(e){e.forEach(e=>{e.inject(this.divHeaderBar)}),this.divHeaderBar.style.display="flex"},render:function(){this.container.empty();var e=this,n=UWA.createElement("div",{class:"wizard-collection-view "+e.tabName+"-wizard"});return this.divHeaderBar="",this.divHeaderBar=UWA.createElement("div",{class:"divHeaderBar",styles:{display:"none","flex-direction":"row","flex-wrap":"wrap","justify-content":"space-evenly",height:"auto"}}),this.divHeaderBar.inject(this.container),this.headerBarElems&&this.addHeaderBar(e.headerBarElems),this.toolbarOptions.actions&&this.renderToolbar(),this.model.placeholder&&0===this.model.gridData.length&&n.addContent({html:`<span class='wizard-emptycontentmessage'>${this.model.placeholder}</span>`,styles:{display:"flex","justify-content":"center"}}),this._tilecollectionView=new t({useDragAndDrop:!0}),this._tilecollectionView.model=this.gridModel,this.model.onContextualEventCallback&&(this._tilecollectionView.onContextualEvent={callback:this.model.onContextualEventCallback}),this.app.dataControllers&&(this.app.dataControllers.componentRequestController.options.dropStrategy="CREATE",this.app.dataControllers.componentRequestController.options.multiObjs=!0,this.app.dataControllers.componentRequestController.options.onDropCallback=function(t){e.addDroppedObj(t)},this.app.dataControllers.componentRequestController.options.dropArea=e.container,require(["DS/ENOXSourcingUXInfra/DragAndDrop/ENOXSourcingDataDragAndDrop"],function(t){(new t).makeAreaDroppable(e.app.dataControllers.componentRequestController.options)})),this._tilecollectionView.height="",this._tilecollectionView.postion="relative",this._tilecollectionView.inject(n),n.inject(this.container),this.model.buttons&&this.renderButtons(),d.addResizeListener(e.container,function(){e.update()},0),this.container},update:function(){this.toolbarOptions.actions?document.querySelector("."+this.tabName+"-wizard").style.height=document.querySelector("."+this.tabName+"-wizard").parentElement.getBoundingClientRect().height-document.querySelector("."+this.tabName+"-wizard").parentElement.querySelector(".enox-collection-toolbar-v2-container").getBoundingClientRect().height+"px":document.querySelector("."+this.tabName+"-wizard").style.height=document.querySelector("."+this.tabName+"-wizard").parentElement.getBoundingClientRect().height+"px"},renderButtons:function(){let e=UWA.createElement("span",{id:"modalButtons",class:"modal-buttons"});this.model.buttons.forEach(t=>{UWA.createElement("button",t).inject(e)}),this.currentStep.delegateButtons?(this.currentStep.footer="",this.currentStep.footer=e):e.inject(this.container)},renderToolbar:function(){var e=this;this._toolbarChannel=this._toolbarChannel?this._toolbarChannel:(new o).createNewChannel(),this.toolbarOptions.modelEvents=this._toolbarChannel,this.toolbarOptions.modelEvents.subscribe({event:"enox-collection-toolbar-click-filter-search"},function(){e.container.querySelector(".enox-basic-filter-autocomplete-wrapper").addClassName("modal-search-bar")}),this.toolbarOptions.showItemCount=!!this.model.showItemCount&&this.model.showItemCount;var t=this.collectionToolbar?this.collectionToolbar:new s(this.toolbarOptions);if(this.collectionToolbar=t,this.model.is3dSearch&&(t._clickSearch=function(){let t=e.model._3dSearchOptions;(new r).init(t)}),t.inject(this.container),void 0!==this.toolbarOptions.showItemCount&&!0===this.toolbarOptions.showItemCount){var n=0;this._tilecollectionView&&this._tilecollectionView.getTreeDocument()&&(n=this._tilecollectionView.getTreeDocument().getAllDescendants().length),e._toolbarChannel.publish({event:"enox-collection-toolbar-items-count-update",data:n})}},addDroppedObj:async function(e){let t=this,n=e;if(!Array.isArray(e))return n=[e],void t.uploadDocument(e);let i=[],o=n.map(e=>t.app.dataControllers.componentRequestController.commonUtility.gettypeshierarchy(e.objectType).then(n=>{let o=n.types_hierarchies[0].hierarchy,a=[m.DOCUMENT],r=t.app.dataControllers.componentRequestController.commonUtility.getTypeFromTypeHierarchy(o,e.objectType,a);if(!a.includes(r))return Promise.reject(new Error(u.invalid_object_dropped));i.push(e)}).catch(e=>{widget.notificationUtil.showError(e)}));o.push(...n.map(e=>t.getValueByName(e))),await Promise.all(o),p.get3DSearchOptions({multiSel:!0,isSpecification:!1}).callbackMethod(i)},getValueByName:async function(e){var t,n=this.app.dataControllers.componentRequestController.commonUtility.searchUtil.getSearchPayload(e.objectId,[m.DOCUMENT],[m.SOURCE_3DSPACE]),i=await this.app.dataControllers.componentRequestController.commonUtility.searchUtil.callFederatedSearch(n);t=i?i.results[0].attributes:"";for(let n=0;n<t.length;n++)"preview_url"===t[n].name&&(e[t[n].name]=t[n].value),"ds6w:who/ds6w:responsible"===t[n].name&&(e["ds6w:responsible"]=t[n].value),"ds6w:what/ds6w:status"===t[n].name&&(e["ds6w:status"]=t[n].dispValue);e.sourceid=`${e.serviceId}:${e.envId}`,e.id=e.objectId,e["ds6w:label"]=e.displayName,e.type=e.objectType},uploadDocument:function(e){var t=new UWA.Class.Model({isSpecification:!1}),n=new h({model:t});n.app={...this.options.app.dataProvider.compRequest.documentView.app};for(let t=0;t<e.length;t++){const o=e[t];if(n.validateUploadFile(o.name)){var i={title:o.name||"unNamed",fileInfo:{comments:"",file:o}};let e=widget.getElement(".modal-content");e&&f.mask(e,u.uploading_document),n.createDocument(i).then(function(t){p.populateDocumentDataInWizard(t,!1),f.unmask(e)}).catch(function(){f.unmask(e)})}}}})});