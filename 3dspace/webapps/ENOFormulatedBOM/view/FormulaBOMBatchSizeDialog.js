define("DS/ENOFormulatedBOM/view/FormulaBOMBatchSizeDialog",["UWA/Core","UWA/Class/View","DS/XSRCommonComponents/utils/TypeUtils","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/Controls/LineEditor","DS/WUXAutoComplete/AutoComplete","DS/Controls/Button","DS/Windows/Dialog","DS/Windows/ImmersiveFrame","DS/XSRCommonComponents/utils/RequestUtil"],function(e,t,n,i,o,a,l,s,r,d,c){"use strict";return t.extend({setup:function(e){this._parentView=e,this.options=e},render:function(){return this.elements.mContainer=new e.Element("div",{class:"batchSize-main-dialog-container"}),this._dialog=null,this.container=this.elements.mContainer,this.container.inject(this.options.renderTo),this._showDialog(this.options),this},closeDialog:function(){this.destroy()},destroyPrevDialog:function(){var e=document.getElementsByClassName("batchSize-main-dialog-container");e.length>0&&e[0].destroy()},_showDialog:function(t){let o=this,u=new e.Element("div",{class:"dialog-content-container"});c.getTouchMode()?(t.width=430,t.height=150):t.height=110;let m=new e.Element("span",{class:"dialog-quantity-container"}).inject(u),h=new e.Element("span",{class:"dialog-uom-container"}).inject(u);var g=new i;g.prepareUpdate();var v=n.getDimensions();Object.entries(v).forEach(([e,t])=>{let i=o.createNode(t,e);g.addRoot(i);var a=n.getUOMUnits(e),l=Object.fromEntries(Object.entries(a).sort(([,e],[,t])=>e.localeCompare(t)));Object.keys(l).forEach(function(t){var n=o.createNode(o.isNonNlsLabel(l[t])?t:l[t],t,{dimension:e});i.addChild(n)})}),g.expandAll(),g.pushUpdate();o.editor=new a({placeholder:"Quantity",value:t.refQuantity,pattern:"([0-9]*[.])?[0-9]+",selectAllOnFocus:!1}).inject(m),o.control=new l({placeholder:"UOM",value:t.refUnit,multiSearchMode:!1,elementsTree:g}).inject(h),o.control.addEventListener("change",function(){let e=o.control.value;"Area"!==e&&"Mass"!==e&&"Length"!==e&&"Volume"!==e||(o.control.value=null),void 0===e||""===o.editor.value?o._dialog.buttons.Ok.disabled=!0:o._dialog.buttons.Ok.disabled=!1}),o.editor.addEventListener("change",function(e){""===e.dsModel.value||void 0===o.control.value?o._dialog.buttons.Ok.disabled=!0:o._dialog.buttons.Ok.disabled=!1});var w=new e.Element("div",{class:"formula-dialog-immersiveframe"}).inject(this.container),b=new d;b.inject(w),this._dialog=new r({title:t.Title,immersiveFrame:b,position:t.position,resizableFlag:!0,domId:"formula-batchSize-dialog",modalFlag:!0,titleBarVisibleFlag:!0,closeButtonFlag:!0,width:t.width,height:t.height,content:u});var p=new s({allowUnsafeHTMLLabel:!1,touchMode:!1,label:t.label_Cancel,onClick:function(e){o.dispatchEvent("EVENT_CLICK_FORMULADIALOG_CANCEL"),o.closeDialog()}}),f=new s({label:t.OKLabel,disabled:!1,allowUnsafeHTMLLabel:!1,touchMode:!1,onClick:function(e){const{value:t,label:n,grid:i}=o.control.selectedItems.options;let a={quantity:o.editor.value,unit:t,dimension:i.dimension,displayUnit:n};o.dispatchEvent("EVENT_CLICK_FORMULADIALOG_OK",a),o.closeDialog()}});return this._dialog.buttons={Cancel:p,Ok:f},this._dialog.addEventListener("close",function(e){o.destroy()}),this._dialog},createNode:function(e,t,n){return new o({label:e,value:t,grid:n||{}})},isNonNlsLabel:function(e){return!!e.includes("emxFramework.")},maskOrUnMaskDialog:function(e){var t=document.getElementsByClassName("batchSize-main-dialog-container");if(t&&t.length>0){var n=t[0].getElementsByClassName("wux-windows-window-maincontent")[0];n&&Mask.isMasked(n)?Mask.unmaskLoader(n):n&&Mask.maskLoader(n,e)}}})});