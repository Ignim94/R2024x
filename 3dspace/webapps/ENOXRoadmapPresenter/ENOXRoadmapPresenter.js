define("DS/ENOXRoadmapPresenter/ENOXRoadmapSearchController",["DS/ENOXSearchUIController/ObjectOpenSearchUtil","i18n!DS/ENOXRoadmapPresenter/assets/nls/ENOXRoadmapPresenter"],function(e,t){"use strict";var i=function(e){this._eventChannel=e&&e.modelEvents?e.modelEvents:void 0,this.EVENT_ADD_SELECTIONS_FROM_SEARCH="roadmap-list-add-selected-items-from-search",this.EVENT_ADD_COMMUNITIES_FROM_SEARCH="roadmap-add-communities-from-search",this.viewId=e&&e.viewId?e.viewId:void 0};return i.prototype._handleAddObjectSearch=function(i){e.configureSearch(),e.launchSearch({title:t.SELECT_ITEM_TO_ADD,allowedTypes:i.allowedTypes,role:i.role,criteria:i.criteria,multiSel:i.multiSel,excludeList:i.excludeList,in_apps_callback:this._handleSearchResultToAdd.bind(this)})},i.prototype._handleSearchCommunities=function(i){e.configureSearch(),e.launchSearch({title:t.SELECT_ITEM_TO_ADD,allowedTypes:i.allowedTypes,role:i.role,criteria:i.criteria,multiSel:i.multiSel,excludeList:i.excludeList,default_with_precond:i.default_with_precond,in_apps_callback:this._handleSearchResultToAddCommunities.bind(this)})},i.prototype._handleSearchResultToAdd=function(e){var t=this._formatSearchItems(e);this._eventChannel.publish({event:this.EVENT_ADD_SELECTIONS_FROM_SEARCH,data:{items:t,viewId:this.viewId}})},i.prototype._handleSearchResultToAddCommunities=function(e){var t=this._formatSearchItems(e);this._eventChannel.publish({event:this.EVENT_ADD_COMMUNITIES_FROM_SEARCH,data:t})},i.prototype._formatSearchItems=function(e){var t=[];return e.forEach(function(e){var i={id:e.resourceid.replace("&lt;","<").replace("&gt;",">"),type:e["ds6w:type_value"],title:e["ds6w:label"],label:e["ds6w:label"],service:e.sourceid};t.push(i)}),t},i}),define("DS/ENOXRoadmapPresenter/ENOXRoadmapUtil",["UWA/Core","UWA/Utils","DS/PlatformAPI/PlatformAPI","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices"],function(e,t,i,n){"use strict";var o={},a=!1;return{getTenantId:function(){if(window.widget&&window.widget.data&&"OnPremise"===widget.data.x3dPlatformId)return widget.data.x3dPlatformId;var e=window.widget&&widget.data&&widget.data.x3dPlatformId?widget.data.x3dPlatformId.toUpperCase():"";if(""===e){var t=window.widget&&window.widget.uwaUrl?window.widget.uwaUrl.split("/")[2].toUpperCase():window.location.host.toUpperCase();e=t.indexOf("-")>0?t.substring(0,t.indexOf("-")):"OnPremise"}return e},get3DSwymURL:function(){return this.getURLForService("3DSwym")},getURLForService:function(e){var t=widget.getValue("x3dPlatformId");if(t&&o[t]&&o[t][e])return o[t][e];var i="";return new Promise(function(e){a?e():n.getPlatformServices({onComplete:function(t){t.forEach(function(e){e.platformId===widget.data.x3dPlatformId&&(o[e.platformId]=e)}),a=!0,e()}})}).then(function(){return t&&o[t]&&o[t][e]&&(i=o[t][e]),i})}}}),define("DS/ENOXRoadmapPresenter/ENOXRoadmapWidgetStorage",["UWA/Class"],function(e){"use strict";return e.singleton({initialize:function(){this.widgetStorageName="roadmapWidgetStorage";var e=widget.getValue(this.widgetStorageName);e?this.JSONRoadMapGlobalStorage=JSON.parse(e):this._addRoadmapWidgetStorage()},_addRoadmapWidgetStorage:function(){let e={roadMapCompactView:{backlogAccordeonState:"expand",commitedAccordeonState:"expand",sort:{sortAttribute:"",sortOrder:""}},roadMapFullView:{backlogPanelOpen:!0,expandedColumn:"",visibleColumns:void 0,sort:{sortAttribute:"",sortOrder:""}}};this.JSONRoadMapGlobalStorage=e,this._saveRoadmapWidgetStorage()},updateRoadmapWidgetStorage:function(e,t,i){e&&"compact"===e?this.JSONRoadMapGlobalStorage&&this.JSONRoadMapGlobalStorage.roadMapCompactView&&(this.JSONRoadMapGlobalStorage.roadMapCompactView[t]=i):e&&"full"===e&&this.JSONRoadMapGlobalStorage&&this.JSONRoadMapGlobalStorage.roadMapFullView&&(this.JSONRoadMapGlobalStorage.roadMapFullView[t]=i),this._saveRoadmapWidgetStorage()},_saveRoadmapWidgetStorage:function(){let e="{}";try{this.JSONRoadMapGlobalStorage&&(e=JSON.stringify(this.JSONRoadMapGlobalStorage))}catch(e){return!1}return widget.setValue(this.widgetStorageName,e),!0},createCommunityPreference:function(e){let t={},i=[];if(e.length>0)if(widget.getValue("communityPreference")){let n=JSON.parse(widget.getValue("communityPreference"));t.Mature_Ideas={id:"Mature_Ideas",label:"Mature Ideas",selected:this.isMaturedIdeaOnly()},e.forEach(function(e){i.push(e.label),void 0===n[e.label]?t[e.label]={id:e.id,label:e.label,selected:!0,exclude:e.exclude}:t[e.label]={id:n[e.label].id,label:n[e.label].label,selected:n[e.label].selected,exclude:n[e.label].exclude}})}else e.forEach(function(e){t[e.label]={id:e.id,label:e.label,selected:!0}});else widget.setValue("communityPreference",JSON.stringify(t));t&&widget.setValue("communityPreference",JSON.stringify(t))},updateCommunityPreference:function(e){if(widget.getValue("communityPreference")){let t=JSON.parse(widget.getValue("communityPreference"));"Mature_Ideas"!==e.id?t[e.label].selected=e.selected:t[e.id].selected=e.selected,t&&widget.setValue("communityPreference",JSON.stringify(t))}},isMaturedIdeaOnly:function(){let e=!1;if(widget.getValue("communityPreference")){let t=JSON.parse(widget.getValue("communityPreference"));e=!t.Mature_Ideas||t.Mature_Ideas.selected}return e},getFilteredCommunities:function(){let e=[];if(widget.getValue("communityPreference")){let t=JSON.parse(widget.getValue("communityPreference"));for(let i in t)"Mature_Ideas"!==i&&t[i].selected&&e.push(i)}return e},getFilteredNotExcludedCommunities:function(){let e=[];if(widget.getValue("communityPreference")){let t=JSON.parse(widget.getValue("communityPreference"));for(let i in t)"Mature_Ideas"!==i&&!0!==t[i].exclude&&e.push(t[i])}return e},getFilteredNotExcludedCommunityIds:function(){let e=[];if(widget.getValue("communityPreference")){let t=JSON.parse(widget.getValue("communityPreference"));for(let i in t)"Mature_Ideas"!==i&&!0!==t[i].exclude&&e.push(t[i].id)}return e},getFilteredExcludedCommunityIds:function(){let e=[];if(widget.getValue("communityPreference")){let t=JSON.parse(widget.getValue("communityPreference"));for(let i in t)"Mature_Ideas"!==i&&!0===t[i].exclude&&e.push(t[i].id)}return e}})}),define("DS/ENOXRoadmapPresenter/ENOXRoadmapSearchUtil",["UWA/Core","UWA/Utils/InterCom"],function(e,t){"use strict";return{initialize:function(){this.socketName="search_socket_"+(new Date).getTime(),this.socket=new t.Socket(this.socketName,{dispatchRetryInterval:5}),this.socket.subscribeServer("SearchComServer"),this.listener=this.objectsSelected.bind(this),this.socket.addListener("Selected_Objects_search",this.listener);var e=this;return this.socket.addListener("onCloseTransient",function(){e.socket.dispatchEvent("UnregisterContext",{widget_id:widget.id})}),this},options:function(t,i,n,o,a,s,l,r){var d={};return d.title=t,d.mode=l?"default":"furtive",d.app_socket_id=this.socketName,d.widget_id=widget.id,d.default_with_precond=!0,d.show_precond=!1,d.idcard_activated=r||!1,d.multiSel=!!e.is(a)&&a,d.role=n,d.tenant=widget.data.x3dPlatformId,d.default_search_criteria=o?"("+o+")":"",i?(d.precond="(",Array.isArray(i)||(i=i.split(",")),i.forEach(function(e,t){0!==t&&(d.precond+=" OR "),d.precond+='type:"'+e+'"'}),d.precond+=")",""!==s&&void 0!==s&&(d.precond+=s)):d.precond=s,d},destroy:function(){var e={};e.widget_id=widget.id,this.socket.dispatchEvent("unregisterSearchContext",e),this.socket.unsubscribeServer("SearchComServer"),this.socket.removeListener("Selected_Objects_search",this.listener),this.socket.disconnect(),delete this.socket},activate:function(e,t,i,n,o,a,s,l,r){var d=this.options(e,t,i,n,o,a,s,l);this.callback=r,this.socket.dispatchEvent("RegisterContext",d),this.socket.dispatchEvent("InContextSearch",d)},isAvailable:function(){return e.is(this.socket)},configureSearch:function(e){this.isAvailable()||this.initialize(e)},launchSearch:function(e){this.activate(e.title,e.allowedTypes,e.role||"",e.criteria,e.multiSel,e.excludeList,e.defaultMode,e.idcard_activated,function(t){e.in_apps_callback(t)})},objectsSelected:function(e){var t,i,n=[];if(this.callback){for(t=0,i=e.length;t<i;t++)n.push(e[t]);this.callback(n)}}}}),define("DS/ENOXRoadmapPresenter/ENOXRoadmapTaggerManager",["UWA/Core","UWA/Class","DS/TaggerOnIndexComponent/TaggerOnIndexComponent"],function(e,t,i){"use strict";return t.extend({_id:"roadmap-tagger",initialize:function(e){this._taggerId=e.taggerId?e.taggerId:Date.parse(new Date),this._modelEvents=e.modelEvents,this._eventTokens=[],this.options=e,this._friendTags=[],this.subscribeEvents(),this.listOfIds=[],this._filteredIds=[],this.noColsFiltered=0,this.noOfColsLoaded=this.noOfColsToManage=0,this._taggerComponent=i},subscribeEvents:function(){var t=this;this._eventTokens.push(this._modelEvents.subscribe({event:"xmodel-list-data-load-action"},function(e){if(e&&e.member){let i=e.member.map(e=>e.id);t.listOfIds=t.listOfIds.concat(i)}t.noOfColsLoaded++,t.noOfColsToManage===t.noOfColsLoaded&&t.listOfIds.length>0&&t._setupTagger(t.listOfIds)})),this._eventTokens.push(this._modelEvents.subscribe({event:"roadmap-fetch-items-call-is-done"},function(){t.noOfColsLoaded++,t.noOfColsToManage===t.noOfColsLoaded&&t.listOfIds.length>0&&t._setupTagger(t.listOfIds)})),this._eventTokens.push(this._modelEvents.subscribe({event:"xmodel-list-tagger-activate-action"},function(){t.activateTagger()})),this._eventTokens.push(this._modelEvents.subscribe({event:"xmodel-list-tagger-deactivate-action"},function(){t.deactivateTagger()})),this._eventTokens.push(this._modelEvents.subscribe({event:"xmodel-list-tagger-update-friend-tags-action"},function(i){e.is(i,"array")&&(t._friendTags=i)})),this._eventTokens.push(this._modelEvents.subscribe({event:"xmodel-list-data-on-search-complete"},function(e){t.noColsFiltered++,t._filteredIds=t._filteredIds.concat(e),t.noOfColsToManage===t.noColsFiltered&&(t._filterTagger(t._filteredIds),t.noColsFiltered=0,t._filteredIds=[])})),this._eventTokens.push(this._modelEvents.subscribe({event:"xmodel-list-tagger-update-filtered-item"},function(e){t.noColsFiltered++,t._filteredIds=t._filteredIds.concat(e),t.noOfColsToManage===t.noColsFiltered&&(t._filterTagger(t._filteredIds),t.noColsFiltered=0,t._filteredIds=[])})),this._eventTokens.push(this._modelEvents.subscribe({event:"xmodel-list-tagger-focus-action"},function(e){var i=[];e.forEach(function(e){i.push(e.options.grid.id)}),t._focusOnSubjects(i)})),this._eventTokens.push(this._modelEvents.subscribe({event:"xmodel-list-tagger-unfocus-action"},function(){t._unfocus()})),this._eventTokens.push(this._modelEvents.subscribe({event:"xmodel-list-tagger-init-action"},function(){t._modelEvents.publish({event:"xmodel-list-get-filtered-data",data:function(e){t._setupTagger(e?Object.keys(e):[])}})})),this._eventTokens.push(this._modelEvents.subscribe({event:"xmodel-list-tagger-set-filter-action"},function(e){t._taggerComponent.setLocalFilter(t._taggerId,e)})),this._eventTokens.push(this._modelEvents.subscribe({event:"xmodel-list-tagger-get-filter-action"},function(i){if(e.is(i,"function")){var n=t._taggerComponent.getTagProxy(t._taggerId);if(n)i(n.getCurrentFilter())}})),this._eventTokens.push(this._modelEvents.subscribe({event:"update-tagger-list-on-items-removal"},function(e){t._reSetupTagger(e,"REMOVE")})),this._eventTokens.push(this._modelEvents.subscribe({event:"update-tagger-list-on-items-addition"},function(e){t._reSetupTagger(e,"ADD")}))},_reSetupTagger:function(e,t){var i=this;t&&e&&e.length>0&&(e.forEach(e=>{let n=i.listOfIds.indexOf(e);"ADD"===t&&-1===n?i.listOfIds.push(e):"REMOVE"===t&&-1!==n&&i.listOfIds.splice(n,1)}),this._setupTagger(this.listOfIds))},updateCountOfViewsToManage:function(e){this.noOfColsToManage=e},_setupTagger:function(t){e.log("set up tagger");var i=this,n={MyFriends:i._friendTags,idDataIndex:i.options&&i.options.queryParam?i.options.queryParam:void 0,onSetTagProxy:function(){i._modelEvents.publish({event:"xmodel-list-tagger-on-setup"})},onTagFilterChange:function(e){var t=i._taggerComponent.getTagProxy(i._taggerId).getCurrentFilter(),n=e&&e.content&&e.content.ids?e.content.ids:[];if(n&&n.length>0){var o={id:"taggerFilter",content:{ids:n,idPrefix:"pid://"}};i._modelEvents.publish({event:"xmodel-list-data-filter-action",data:o}),i._modelEvents.publish({event:"xmodel-list-tagger-on-filter-change",data:t.allfilters})}},onTagColor:function(e){var t={};if(e.coloredSubjects)for(var n in e.coloredSubjects)e.coloredSubjects.hasOwnProperty(n)&&(t[n.slice(6)]=e.coloredSubjects[n]);i._modelEvents.publish({event:"roadmap-tagger-on-tag-color",data:t})},onTagUncolor:function(){i._modelEvents.publish({event:"roadmap-tagger-on-tag-de-color",data:{}})},colorize:!0,subjectPrefix:"pid://"},o=t||[];this._taggerComponent.killTagProxy(this._taggerId),this._taggerComponent.setTagProxy(this._taggerId,n,o)},_filterTagger:function(e){this._taggerComponent.getTagProxy(this._taggerId)&&this._taggerComponent.filterTags(this._taggerId,e)},_focusOnSubjects:function(e){this._taggerComponent.getTagProxy(this._taggerId)&&this._taggerComponent.focusOnSubjects(this._taggerId,e)},_unfocus:function(){this._taggerComponent.unfocus(this._taggerId)},activateTagger:function(e){this._taggerComponent.getTagProxy(this._taggerId)&&(e&&e.deactivateOthers?this._taggerComponent.activate(this._taggerId,e):this._taggerComponent.activate(this._taggerId))},deactivateTagger:function(){this._taggerComponent.deactivate(this._taggerId)},destroy:function(){let e=this;this._taggerComponent.killTagProxy(this._taggerId),this._eventTokens.forEach(t=>{e._modelEvents.unsubscribe(t)}),this._eventTokens=[]}})}),define("DS/ENOXRoadmapPresenter/ENOXRoadmapReqContentTabPresenter",["DS/UIKIT/Input/Button","DS/WebappsUtils/WebappsUtils","DS/CKEditor/CKEditor","DS/UIKIT/Input/Text","i18n!DS/ENOXRoadmapPresenter/assets/nls/ENOXRoadmapPresenter"],function(e,t,i,n,o){"use strict";var a=function(){};return a.prototype.init=function(e){this.channel=e.channel,this.handlers=e.handlers,this.contentTabInfo,UWA.is(this.handlers.getContentTabHandlers,"function")&&(this.contentTabInfo=this.handlers.getContentTabHandlers()),this.rdmpContentChanelToken=[],this.subscribeEvents()},a.prototype.subscribeEvents=function(){var e=this;this.rdmpContentChanelToken.push(e.channel.subscribe({event:"rdmp-content-load-requirement"},function(t){e.id=t.id,e.loadRequirementContent()}))},a.prototype.getUI=function(a){var s=this;this.id=a;var l=UWA.createElement("div",{class:"content-tab-container"});this._textContainer=UWA.createElement("div",{class:"rich-object-content"}),this._saveButton=new e({value:o.SAVE,className:"primary"}),this._cancelButton=new e({value:o.CANCEL}),this._actionDiv=UWA.createElement("div",{class:"content-actions-container",html:[this._saveButton,this._cancelButton]}),this._textEditor=new n({multiline:!0,rows:4,className:"ckeEditor-textarea"});var r=t.getWebappsBaseUrl()+"VENREQPlugins/External/ckeditor";for(var d in this._customConfig=r+"/config.js",this._toolbar="Rich",this._plugins||(this._plugins={sharedspace:r+"/plugins/sharedspace/",colorbutton:r+"/plugins/colorbutton/",panelbutton:r+"/plugins/panelbutton/",quicktable:r+"/plugins/quicktable/",base64image:r+"/plugins/base64image/",selectall:r+"/plugins/selectall/"}),this._extraPlugins="",this._plugins)this._extraPlugins+=d+",";return this._extraPlugins=this._extraPlugins.slice(0,-1),this.defaultEditorOptions={skin:"office2013,"+r+"/skins/office2013/",customConfig:s._customConfig,extraPlugins:s._extraPlugins,toolbar:s._toolbar,language:window.widget?window.widget.lang:"en",height:"100%",startupFocus:!0,resize_enabled:!1,on:{instanceReady:function(){console.log("ckEditor instance is ready"),s.loadRequirementContent()}}},this._saveButton.addEvent("onClick",function(){s.saveAction()}),this._cancelButton.addEvent("onClick",function(){s.cancelAction()}),this._textEditor.addEvent("onInjected",function(){s._ckEditor&&(s._textContainer.setContent(""),s._ckEditor=null),s._ckEditor=i.appendTo(s._textContainer,s.defaultEditorOptions)}),this._textEditor.inject(l),this._textContainer.inject(l),this._actionDiv.inject(l),l},a.prototype.saveAction=function(){var e,t,i=this,n=this._ckEditor;if(n){var a=n.getData().trim(),s={contentData:a.trim().replace(/\n/g,""),contentText:(e=a.trim(),(t=document.createElement("div")).innerHTML=e,t.textContent||t.innerText),contentType:"html"},l={items:[{physicalid:i.id,attributes:s}]};this.contentTabInfo.setRequirementContent(l).then(function(){i.channel.publish({event:"roadmap-show-notification",data:{notifDetails:{level:"success",title:o.SAVE_SUCCESSFUL,subtitle:o.REQ_CONTENT_UPDATE_OK}}})},function(){i.channel.publish({event:"roadmap-show-notification",data:{notifDetails:{level:"error",title:o.ERROR,subtitle:o.ERROR_MODIFY}}})})}},a.prototype.cancelAction=function(){this.loadRequirementContent()},a.prototype.loadRequirementContent=function(){var e=this;this.contentTabInfo.getRequirementContent(e.id).then(function(t){var i=t.member[0],n=e._ckEditor,o=i&&(i.contentData||i.ContentData)||"";n&&n.setData(o)},function(){UWA.log("LocalRequirementPresenter : getRequirementDetails service failed"),e.channel.publish({event:"roadmap-show-notification",data:{notifDetails:{level:"error",title:o.ERROR,subtitle:o.ERROR_LOAD}}})})},a.prototype.destroy=function(){var e=this;e._textContainer.setContent(""),e._ckEditor=null,this.rdmpContentChanelToken.forEach(function(t){e.channel.unsubscribe(t)})},a}),define("DS/ENOXRoadmapPresenter/TriptychWrapper",["DS/ENOXTriptych/js/ENOXTriptych","css!DS/ENOXRoadmapPresenter/assets/css/TriptychWrapper.css"],function(e){"use strict";var t=function(){};return t.prototype.init=function(t,i,n){this._left=document.createElement("div"),this._left.classList.add("roadmap-triptych-wrapper"),this._main=document.createElement("div"),this._main.classList.add("roadmap-triptych-wrapper"),this._right=document.createElement("div"),this._right.classList.add("roadmap-triptych-wrapper"),this._applicationChannel=t,this._triptych=new e;var o=widget.body.offsetWidth<550?"close":"open",a={left:{resizable:!0,originalSize:n&&n.left&&n.left.size?n.left.size:240,originalState:o,overMobile:!0},right:{resizable:!0,originalSize:n&&n.right&&n.right.size?n.right.size:400,originalState:"close",withClose:!0,overMobile:!0},borderRight:!0,borderLeft:!0,container:i,withtransition:!0,modelEvents:this._applicationChannel};this._triptych.init(a,this._left,this._main,this._right)},t.prototype.inject=function(e){this._triptych.inject(e)},t.prototype._getTriptych=function(){return this._triptych},t.prototype.getLeftPanelContainer=function(){return this._left},t.prototype.getRightPanelContainer=function(){return this._right},t.prototype.getMainPanelContainer=function(){return this._main},t}),define("DS/ENOXRoadmapPresenter/ObjectOpenWithMenuService",["UWA/Core","UWA/Class","UWA/Class/Promise","DS/i3DXCompassPlatformServices/OpenWith","i18n!DS/ENOXRoadmapPresenter/assets/nls/ENOXRoadmapPresenter"],function(e,t,i,n,o){"use strict";return t.singleton({init:function(){this._typeCompatibleAppsMenu=new Map,this._openWithInst=new n},intialize:function(e){this.options=e},getOpenWithMenuForObject:function(t){var n=this;return new i(i=>{if(!t||void 0===t.objectType)return e.Promise.reject();{let e;var a=[];e={id:"Open_With",type:"PushItem",title:o.OPEN_WITH,text:"a",fonticon:{content:"wux-ui-3ds wux-ui-3ds-open-menu-dot",family:"DSFontIcon"},submenu:a},n._openWithInst.set3DXContent({protocol:"3DXContent",version:"1.0",source:widget.data.appId,widgetId:widget.id,data:{items:[t]}}).retrieveCompatibleApps(function(o){o.forEach(function(e){a.push({name:e.text,type:"PushItem",title:e.text,icon:e.icon,action:{callback:function(t){e.handler.call(t)}}})}),a.length>0?(n._typeCompatibleAppsMenu.set(t.objectType,e),i(e)):i()})}})}})}),define("DS/ENOXRoadmapPresenter/SearchIndexService",["DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","DS/WAFData/WAFData","DS/FedDictionaryAccess/FedDictionaryAccessAPI"],function(e,t,i){"use strict";var n="",o="",a="";e.getPlatformServices({onComplete:function(e){a=widget.getValue("x3dPlatformId")?widget.getValue("x3dPlatformId"):"OnPremise";var t=e.filter(function(e){return a===e.platformId});1===t.length&&(n=t[0]["3DSearch"]+"/search",o=t[0]["3DSearch"]+"/recent")}});var s=function(){};return s.prototype.searchwithQuery=function(e){t.authenticatedRequest(n,{headers:{Accept:"application/json","Content-Type":"application/json","X-Requested-With":"XMLHttpRequest","Accept-Language":widget.lang},method:"POST",type:"json",proxy:"passport",data:JSON.stringify({query:e.query,specific_source_parameter:e.specific_source_parameter,refine:e.refine?e.refine:{},label:"my query Label",locale:void 0!==widget&&void 0!==widget.lang?widget.lang:"en",nresults:10,source:e.source?e.source:[],next_start:e.next_start?e.next_start:void 0,tenant:widget.getValue("x3dPlatformId")?widget.getValue("x3dPlatformId"):"OnPremise",with_synthesis:!1,select_predicate:e.predicate?e.predicate:[]}),onComplete:function(t){e.onComplete(t)},onFailure:e.onFailure})},s.prototype.search=function(e,i,o,a,s){var l=this,r=["type_icon_url","ds6w:what/ds6w:status","ds6w:what/ds6w:type"];r=r.concat(e);t.authenticatedRequest(n,{headers:{Accept:"application/json","Content-Type":"application/json","X-Requested-With":"XMLHttpRequest","Accept-Language":widget.lang},method:"POST",type:"json",proxy:"passport",data:JSON.stringify({query:"",label:"my label",locale:void 0!==widget&&void 0!==widget.lang?widget.lang:"en",nresults:s||40,start:0,tenant:"OnPremise",with_synthesis:!1,select_predicate:r}),onComplete:function(e){l._onSearchQueryResult(e,r,o)},onFailure:a})},s.prototype._onSearchQueryResult=function(e,t,i){var n=this,o=[];0!==e.infos.nresults?(e.results.forEach(function(e){var i={};t.forEach(function(t){i[t]="";var o=e.attributes.find(function(e){return e.name===t})||{value:""},a="date"===o.type?n._ConvertToTagDate(o.value):o.value;i[t]=a});var a=e.attributes.find(function(e){return"resourceid"===e.name});i["@id"]=a.value,o.push(i)}),i(o)):i(o)},s.prototype._ConvertToTagDate=function(e){var t=new Date,i="",n="";return e&&("string"==typeof e&&(e=(e=(e=e.replace(/&#x2f;/g,"/")).replace(/&#x3a;/g,":")).replace(/\u200E/g,"")),n=(t=new Date(e)).getTime(),n=t.toLocaleTimeString(n),i=t.toLocaleDateString()+" "+n),i},s.prototype.searchFullCriterias=async function(e,t,i,n,o,a){if(0!==e.length){var s=[];100;for(var l=Math.ceil(e.length/100),r=0;r<l;r++)s[r]=e.slice(100*r,100*(r+1));this._searchFullCriterias(s,{infos:{nresults:0},results:[]},0,100,o,t,i,e,a)}else this._onSearchQueryResultFullCriterias({infos:{nresults:0}},t)},s.prototype._searchFullCriterias=function(e,i,o,s,l,r,d,c,u){var p=this,h="",m="";e[o].forEach(function(e){h+=m,h+='"'+e.objectId+'"',m=" OR "});var g={query:h="[ds6w:resourceUid]:("+h+")",label:"my label",locale:void 0!==widget&&void 0!==widget.lang?widget.lang:"en",nresults:100,start:0,tenant:a,with_synthesis:!0,with_synthesis_attribute:!0,select_predicate:["ds6w:label","ds6w:type","ds6w:description","ds6w:identifier","ds6w:modified","ds6w:created","ds6wg:revision","ds6w:status","ds6w:responsible","owner","ds6w:responsibleUid","ds6wg:filesize","ds6w:project","ds6w:dataSource","ds6w:community","dcterms:title","dcterms:description","LASTREVISION","dscpfl:priceIndex","ds6w:containerUid"]};UWA.is(u,"array")&&u.length>0&&(g.select_predicate=g.select_predicate.concat(u)),l&&l.length>0&&(g.source=l),t.authenticatedRequest(n,{headers:{Accept:"application/json","Content-Type":"application/json","X-Requested-With":"XMLHttpRequest","Accept-Language":widget.lang},method:"POST",type:"json",proxy:"passport",data:JSON.stringify(g),onComplete:async function(t){if(i.infos.nresults+=t.infos.nresults,t.results&&(i.results=i.results.concat(t.results)),o===e.length-1){if(i.infos.nresults<c.length){let e=p._findMissingItems(c,i);if(e){let t=await p.queryRecentService(g,r,d,e);t&&t.infos.nresults>0&&(i.infos.nresults+=t.infos.nresults,i.results=i.results.concat(t.results))}}p._onSearchQueryResultFullCriterias(i,r)}else o++,p._searchFullCriterias(e,i,o,s,l,r,d,c)},onFailure:d})},s.prototype._findMissingItems=function(e,t){if(t&&0===t.infos.nresults)return e;e.map(e=>e.objectId);let i=t.results.map(e=>{let t=e.attributes.filter(e=>"resourceid"===e.name);if(t[0])return t[0].value;throw new Error("Something went very wrong. Search did not return resourceid attribute for the object:"+JSON.stringify(e))});return e.filter(e=>-1===i.indexOf(e.objectId))},s.prototype.queryRecentService=async function(e,i,n,s){return new Promise((e,i)=>{var n={label:"my label",locale:void 0!==widget&&void 0!==widget.lang?widget.lang:"en",nresults:100,start:0,tenant:a,with_synthesis:!0,with_synthesis_attribute:!0,select_predicate:["ds6w:label","ds6w:type","ds6w:description","ds6w:identifier","ds6w:modified","ds6w:created","ds6wg:revision","ds6w:status","ds6w:responsible","owner","ds6w:responsibleUid","ds6wg:filesize","ds6w:project","ds6w:dataSource","ds6w:community","dcterms:title","dcterms:description","LASTREVISION","dscpfl:priceIndex"]};t.authenticatedRequest(o,{headers:{Accept:"application/json","Content-Type":"application/json","X-Requested-With":"XMLHttpRequest","Accept-Language":widget.lang},method:"POST",type:"json",proxy:"passport",data:JSON.stringify(n),onComplete:function(t){if(s&&t.infos.nresults>0){let e=s.map(e=>e.objectId);t.results=t.results.filter(t=>{let i=t.attributes.filter(e=>"resourceid"===e.name);return!!i[0]&&-1!==e.indexOf(i[0].value)}),t.results.forEach(e=>{e.attributes.forEach(e=>{e.name="ds6w:type"===e.name?"ds6w:what/ds6w:type":e.name,e.name="ds6w:responsible"===e.name?"ds6w:who/ds6w:responsible":e.name,e.type="ds6w:modified"===e.name?"date":"",e.name="ds6w:modified"===e.name?"ds6w:when/ds6w:modified":e.name})}),t.infos.nhits=t.results.length,t.infos.nresults=t.results.length}e(t)},onFailure:function(e){i(e)}})})},s.prototype._onSearchQueryResultFullCriterias=function(e,t){var i=this,n=[],o={"ds6w:status":[],"ds6w:type":[]};if(0!==e.infos.nresults){e.results.forEach(function(e){var t={"@isArray":[]};e.attributes.forEach(function(e){"date"===e.type&&(e.value=i._ConvertToTagDate(e.value)),Array.isArray(e.value)?void 0===t[e.value[0]]?(t[e.value[0]]=e.value.slice(1)?e.value.slice(1).toString():"",t["@isArray"].push(e.value[0])):"ds6w:label"===e.name?t[e.value[0]]=t[e.value[0]].toString()+" "+(e.value.slice(1)?e.value.slice(1).toString():""):t[e.value[0]]=t[e.value[0]].toString()+";"+(e.value.slice(1)?e.value.slice(1).toString():""):void 0===t[e.name]?t[e.name]=e.value?e.value.toString():"":"ds6w:label"===e.name?t[e.name]=t[e.name].toString()+" "+(e.value?e.value.toString():""):t[e.name]=t[e.name].toString()+";"+(e.value?e.value.toString():"")}),t["@id"]=t.resourceid,t.physicalid=t.resourceid;for(const e in t)Object.prototype.hasOwnProperty.call(t,e)&&("ds6w:what/ds6w:status"===e&&-1===o["ds6w:status"].indexOf(t[e])&&o["ds6w:status"].push(t[e]),"ds6w:what/ds6w:type"===e&&-1===o["ds6w:type"].indexOf(t[e])&&o["ds6w:type"].push(t[e]));n.push(t)});var a=JSON.stringify(o);i.getDataNLS(a,function(e){n.forEach(function(t){t["ds6w:what/ds6w:type"]&&e["ds6w:type"]&&e["ds6w:type"].hasOwnProperty(t["ds6w:what/ds6w:type"])&&(t["ds6w:what/ds6w:typeValue"]=t["ds6w:what/ds6w:type"],t["ds6w:what/ds6w:type"]=e["ds6w:type"][t["ds6w:what/ds6w:type"]]),t["ds6w:what/ds6w:status"]&&e["ds6w:status"]&&e["ds6w:status"].hasOwnProperty(t["ds6w:what/ds6w:status"])&&(t["ds6w:what/ds6w:statusNLS"]=e["ds6w:status"][t["ds6w:what/ds6w:status"]]),t["ds6w:created"]&&t["ds6w:when/ds6w:created"]&&delete t["ds6w:created"],t["ds6w:modified"]&&t["ds6w:when/ds6w:modified"]&&delete t["ds6w:modified"],t["ds6w:responsible"]&&t["ds6w:who/ds6w:responsible"]&&delete t["ds6w:responsible"],t["ds6w:status"]&&t["ds6w:what/ds6w:status"]&&delete t["ds6w:status"]})},function(){}).then(()=>{t(n)})}else t(n)},s.prototype.getTagNLS=function(e,t,n){var o={tenantId:widget.getValue("x3dPlatformId")?widget.getValue("x3dPlatformId"):"OnPremise",lang:widget.getValue("lang"),apiVersion:"R2019x",onComplete:function(e){t(e)},onFailure:n};i.getResourcesInfo(e,o)},s.prototype.getDataNLS=function(e,t,n){return new Promise(o=>{var a={tenantId:widget.getValue("x3dPlatformId")?widget.getValue("x3dPlatformId"):"OnPremise",lang:widget.getValue("lang"),apiVersion:"R2019x",onComplete:function(e){t(e),o(e)},onFailure:n};i.getNlsOfPropertiesValues(e,a)})},s}),define("DS/ENOXRoadmapPresenter/ENOXRoadmapInformationPanel",["UWA/Core","DS/Controls/Tab","DS/UIKIT/Form","DS/EditPropWidget/EditPropWidget","DS/ENOXEmptyContent/js/ENOXEmptyContent","DS/UIKIT/Mask","DS/ENOXRoadmapPresenter/ENOXRoadmapReqContentTabPresenter","i18n!DS/ENOXRoadmapPresenter/assets/nls/ENOXRoadmapPresenter"],function(e,t,i,n,o,a,s,l){"use strict";var r=function(){this.EVENT_SHOW_TRIPTYCH_RIGHT_PANEL="triptych-show-panel",this.EVENT_UPDATE_CURR_SCORING_MODEL_INFO="update-current-scoring-model-info",this.EVENT_UPDATE_SELECTED_NODES_AND_INFO_PANEL="update-selected-nodes-and-info-panel",this.EVENT_UPDATE_INFO_PANEL="update-info-panel",this.EVENT_TRIPTYCH_RIGHT_HIDE="triptych-hide-panel",this.EVENT_TRIPTYCH_SET_CONTENT="triptych-set-content"};return r.prototype.init=function(t){this._isInfoPanelOpen=!1,this.isLoadingScoringTabForFirstTime=!0,this.withContentTab=!!t.withContentTab&&t.withContentTab,this.roadmapChannel=t.roadmapChannel,this.handlers=t.handlers?t.handlers:{},this.roadmapChannelTokens=[],this.recentlySelectedNodes=[],this.previousScoringValues={},this.updatedScoringValues={},this.isScoringModelSet=!1,this.isScoringTabPresent=!1,this.isIdCardBuilt=!1,this.isInfoPanelBuilt=!1,this.previousBacklogItemId="",this._tab="",this._container=widget.getElements(".triptych-right-content")[0],this._emptyContent=e.createElement("div",{class:"roadmap-informationPanel-empty"}),this._emptyContent.style.width="100%",this._emptyContent.style.height="100%",this._mainContainer=e.createElement("div",{class:"roadmap-informationPanel-container"}),this._mainContainer.style.height="100%",this._mainContainer.style.padding="10px",this._idcardPanel=e.createElement("div",{class:"roadmap-informationPanel-idCard"}),this._idcardPanel.style.width="100%",this._idcardPanel.inject(this._mainContainer),this._tabDiv=e.createElement("div",{class:"roadmap-informationPanel-facets"}),this._tabDiv.style.width="100%",this._tabDiv.style.height="calc(100% - 100px)",this._tabDiv.inject(this._mainContainer),this._propertiesPanel=e.createElement("div",{class:"propertiesTab"}),this._scoringPanel=e.createElement("div"),this.scoringModelForm=e.createElement("div",{class:"scoringmodel-form"}),this.withContentTab&&(this._contentPanel=e.createElement("div",{class:"contet-tab"})),e.is(this.handlers.getContentTabHandlers().getTypesToShowContentTab,"function")&&(this.allowedTypes=this.handlers.getContentTabHandlers().getTypesToShowContentTab()),this.subscribeEvents()},r.prototype.subscribeEvents=function(){var t=this;this.roadmapChannelTokens.push(this.roadmapChannel.subscribe({event:"toggle-info-panel"},function(i){t.roadmapChannel.publish({event:"triptych-toggle-panel",data:i.toggleSide}),t._isInfoPanelOpen=!t._isInfoPanelOpen,t.roadmapChannel.publish({event:"update-info-panel-status",data:t._isInfoPanelOpen}),t._isInfoPanelOpen?(t.isScoringModelSet=!!e.is(i.isScoringModelSet,"boolean")&&i.isScoringModelSet,t.scoringModelMapping=i.scoringModelMapping?i.scoringModelMapping:{},t.selectedScoringModelId=i.selectedScoringModelId?i.selectedScoringModelId:"",t.recentlySelectedNodes&&t.recentlySelectedNodes.length>0?1===t.recentlySelectedNodes.length?void 0===t.previousBacklogItemId?(t.currentBacklogItemId=t.recentlySelectedNodes[0].getAttributeValue("proxyId"),t.previousBacklogItemId=t.currentBacklogItemId,t.isLoadingScoringTabForFirstTime=!0,t.isInfoPanelBuilt?t._loadTab(t._tab.value[0]):t.buildInformationPanel(i)):t.previousBacklogItemId!==t.currentBacklogItemId&&(t.isLoadingScoringTabForFirstTime=!0,t.isInfoPanelBuilt?t._loadTab(t._tab.value[0]):t.buildInformationPanel(i),t.previousBacklogItemId=t.currentBacklogItemId,t.updateIDCard()):(t.showMessageOnInfoPanel(l.MULTI_SELECTION_NOT_SUPPORTED),t.isInfoPanelBuilt=!1):(t.showMessageOnInfoPanel(l.EMPTY_MESSAGE),t.isInfoPanelBuilt=!1)):t.previousBacklogItemId=t.currentBacklogItemId})),this.roadmapChannelTokens.push(this.roadmapChannel.subscribe({event:this.EVENT_TRIPTYCH_RIGHT_HIDE},function(e){"right"===e&&(t._isInfoPanelOpen=!1,t.roadmapChannel.publish({event:"update-info-panel-status",data:t._isInfoPanelOpen}))})),this.roadmapChannelTokens.push(this.roadmapChannel.subscribe({event:this.EVENT_UPDATE_SELECTED_NODES_AND_INFO_PANEL},function(e){t.recentlySelectedNodes=e.selectedNodes,t.viewId=e.viewId;let i=t.recentlySelectedNodes&&t.recentlySelectedNodes.length>0;if(t._isInfoPanelOpen)if(i)if(1===t.recentlySelectedNodes.length)if(t.currentBacklogItemId!==t.recentlySelectedNodes[0].getAttributeValue("proxyId")){let e=t.recentlySelectedNodes[0]._options.grid;var n=e.typeValue?e.typeValue:e.type?e.type:"";let i=!1;t.allowedTypes.length>0&&t.allowedTypes.forEach(function(e){e===n&&(i=!0)}),t.withContentTab&&!i?(t.isInfoPanelBuilt&&"contentTab"!==t._tab.value[0]?t._loadTab(t._tab.value[0]):t.buildInformationPanel({selectedTab:"propertiesTab"}),t._tab.tabBar.fire("removeTab",{tabName:"contentTab"})):t.isInfoPanelBuilt?t._loadTab(t._tab.value[0]):t.buildInformationPanel({selectedTab:"propertiesTab"}),t.currentBacklogItemId=t.recentlySelectedNodes[0].getAttributeValue("proxyId"),t.updateIDCard()}else t.isInfoPanelBuilt||t.buildInformationPanel({selectedTab:"propertiesTab"});else t.showMessageOnInfoPanel(l.MULTI_SELECTION_NOT_SUPPORTED),t.isInfoPanelBuilt=!1;else t.showMessageOnInfoPanel(l.EMPTY_MESSAGE),t.isInfoPanelBuilt=!1})),this.roadmapChannelTokens.push(this.roadmapChannel.subscribe({event:this.EVENT_UPDATE_CURR_SCORING_MODEL_INFO},function(e){t.isScoringModelSet=e.isScoringModelSet,t.selectedScoringModelId=e.selectedScoringModelId,t.scoringModelMapping=e.scoringModelMapping,t.isScoringTabPresent&&!t.isScoringModelSet&&t.isInfoPanelBuilt?(t._tab.tabBar.fire("removeTab",{tabName:"scoringTab"}),t.isScoringTabPresent=!1):!t.isScoringTabPresent&&t.isScoringModelSet&&t.isInfoPanelBuilt?(t._tab.tabBar.fire("addTab",{tabName:"scoringTab",label:l.SCORING,iconName:"legal",index:1,selected:!1,container:t._scoringPanel}),t.isScoringTabPresent=!0):t.isScoringTabPresent&&t.isScoringModelSet&&t._loadTab("scoringTab")}))},r.prototype.updateIDCard=function(){this._idcardPanel.empty();var t=[{metatype:"businessobject",tenant:widget.data.x3dPlatformId?widget.data.x3dPlatformId:""}];if(this.recentlySelectedNodes&&this.recentlySelectedNodes.length>0){let i=this.recentlySelectedNodes[0],n=i.getAttributeValue("id"),o=i.getAttributeValue("sourceid")?i.getAttributeValue("sourceid"):i.options.grid.sourceId;-1!==o.indexOf(":")&&(o=o.substr(0,o.indexOf(":"))),e.is(o)&&o.includes("3dspace")?(t[0].source="3DSpace",t[0].objectId=n):(t[0].source="fedsearch",t[0].sourceName=o,t[0].objectId='[ds6w:resourceUid]:"'+n+'"'),this.editPropWidget.initData(t),this.idCardUI=this.editPropWidget.getIdentityCardUI(),this.idCardUI.inject(this._idcardPanel)}},r.prototype.buildInformationPanel=function(e){var i=this;this._idcardPanel.empty(),this._tabDiv.empty(),this._tab=new t({multiSelFlag:!1,touchMode:!0,displayStyle:["strip"],autoCloseFlag:!0,newTabButtonFlag:!1,editableFlag:!1,closeButtonFlag:!1,centeredFlag:!0,allowUnsafeHTMLOnTabButton:!1}),this._tab.tabBar.addEventListener("tabButtonClick",e=>{let t=e.dsModel.value[0];this._loadTab(t)}),this._tab.tabBar.addEventListener("addTab",function(e){let t=e.options;i._tab.add({value:t.tabName,index:t.index,label:t.label,isSelected:t.selected,content:t.container,icon:{iconName:t.iconName,fontIconFamily:WUXManagedFontIcons.Font3DS}})}),this._tab.tabBar.addEventListener("removeTab",function(e){let t=e.options;i._tab.tabBar.removeTab(t.tabName),i._tab._tabContent.forEach((e,n)=>{e.value===t.tabName&&(i._tab._tabContent.splice(n,1),"scoringTab"===t.tabName&&(i.scoringModelForm.empty(),i._scoringPanel.empty()))})}),this.triptychRightHeight=document.querySelector(".triptych-right-content")?document.querySelector(".triptych-right-content").clientHeight-150:400,this._propertiesPanel.style.height=this.triptychRightHeight-50+"px",this._scoringPanel.style.height=this.triptychRightHeight-50+"px",this.withContentTab&&(this._contentPanel.style.height=this.triptychRightHeight-50+"px"),this.scoringModelForm.style.height=this.triptychRightHeight-50+"px",this.scoringModelForm.style.padding="10px",this.scoringModelForm.style["overflow-y"]="auto";var o={typeOfDisplay:"editProp_all",selectionType:"restrictSelection",facets:["properties"],readOnly:!0,extraNotif:!0,editMode:!1,multiSelection:!0,context:{getSecurityContext:function(){return widget.data.xPref_CREDENTIAL}}};if(this.editPropWidget=new n(o),!e.showPropertiesTab){let t="propertiesTab"===e.selectedTab||!e.selectedTab;this._tab.add({value:"propertiesTab",index:0,label:l.PROPERTIES,isSelected:t,content:this._propertiesPanel,icon:{iconName:"attributes",fontIconFamily:WUXManagedFontIcons.Font3DS}}),t&&this._loadTab("propertiesTab")}if(this.isScoringModelSet&&i.recentlySelectedNodes[0].getAttributeValue("proxyId")){let t="scoringTab"===e.selectedTab||!e.selectedTab;this._tab.add({value:"scoringTab",index:1,label:l.SCORING,isSelected:t,content:this._scoringPanel,icon:{iconName:"legal",fontIconFamily:WUXManagedFontIcons.Font3DS}}),i.isScoringTabPresent=!0,t&&this._loadTab("scoringTab")}let a=this.recentlySelectedNodes[0]._options.grid;var s=a.typeValue?a.typeValue:a.type?a.type:"";let r=!1;if(this.allowedTypes.length>0&&this.allowedTypes.forEach(function(e){e===s&&(r=!0)}),this.withContentTab&&r){let t="contentTab"===e.selectedTab||!e.selectedTab;this._tab.add({value:"contentTab",index:2,label:l.CONTENT,isSelected:t,content:this._contentPanel,icon:{iconName:"eye",fontIconFamily:WUXManagedFontIcons.Font3DS}}),t&&this._loadTab("contentTab")}this._tab.inject(this._tabDiv),this.roadmapChannel.publish({event:this.EVENT_TRIPTYCH_SET_CONTENT,data:{side:"right",content:this._mainContainer}}),this.isInfoPanelBuilt=!0},r.prototype._loadTab=function(t){var i,n=this,o=[];switch(t){case"propertiesTab":this._initPropertiesTab();break;case"scoringTab":if(this.scoringModelForm.empty(),this._scoringPanel.empty(),this.recentlySelectedNodes&&1===this.recentlySelectedNodes.length)if(this.currentItemData=this.recentlySelectedNodes[0]._options.grid,e.is(this.handlers.getCustomContainerForScoring,"function")){a.mask(document.getElementById("scoringTab"),l.LOADING);let e={backlogItemId:this.currentItemData.proxyId,versionId:this.viewId};this.handlers.getCustomContainerForScoring(e).then(e=>{e.inject(n._scoringPanel),a.unmask(document.getElementById("scoringTab"))}).catch(()=>{a.unmask(document.getElementById("scoringTab"))})}else{let t=[];o=[],e.is(n.scoringModelMapping.columnDefinition.columns)&&(t=n.scoringModelMapping.columnDefinition.columns),t.forEach(t=>{let i=e.is(n.handlers.getTypeRepresentationMapping,"function")?n.handlers.getTypeRepresentationMapping():{};o.push({type:i[t.typeRepresentation]?i[t.typeRepresentation]:t.typeRepresentation,label:t.text?t.text:"",placeholder:t.text?t.text:"",name:t.dataIndex?t.dataIndex:"",required:!0,min:e.is(t.min)?t.min:0,max:e.is(t.max)?t.max:Number.MAX_SAFE_INTEGER,attribute:t.dataIndex?t.dataIndex:"",options:t.possibleValues?t.possibleValues:[],disabled:!!t.readOnly&&t.readOnly,helperText:t.helperText?t.helperText:"",errorText:t.errorText?t.errorText:""})});var r=this.currentItemData.proxyId?this.currentItemData.proxyId:this.currentItemData.id;i={formFields:o,ids:[r]},n.getScoringModelForm(i)}break;case"contentTab":this.recentlySelectedNodes&&1===this.recentlySelectedNodes.length&&(a.mask(document.getElementById("contentTab"),l.LOADING),this.currentItemData=this.recentlySelectedNodes[0]._options.grid,this.contentDiv?this.roadmapChannel.publish({event:"rdmp-content-load-requirement",data:{id:this.currentItemData.id}}):(this._contentPanel.empty(),this.contentTabPresenter=new s,this.contentTabPresenter.init({channel:this.roadmapChannel,handlers:{getContentTabHandlers:this.handlers.getContentTabHandlers}}),this.contentDiv=this.contentTabPresenter.getUI(this.currentItemData.id),e.is(this.contentDiv.inject,"function")&&this.contentDiv.inject(n._contentPanel)),a.unmask(document.getElementById("contentTab")))}},r.prototype.getScoringModelForm=function(e){var t=this,i=e.formFields;let n;t.scoringValues={},a.mask(document.getElementById("scoringTab"),l.FETCHING_SCORING_VALUES),this.handlers.getScoringValues(e.ids).then(e=>{if(e){let o=t.currentItemData.proxyId;t.previousScoringValues=e.scoringValues[o],i.forEach(e=>{if(e.options&&e.options.length>0)for(let i=0;i<e.options.length;i++)e.options[i].value==t.previousScoringValues[e.attribute]?e.options[i].selected=!0:e.options[i].selected=!1;else e.value=t.previousScoringValues[e.attribute]}),(n=this.createForm(i)).inject(this.scoringModelForm),this.scoringModelForm.inject(this._scoringPanel)}a.unmask(document.getElementById("scoringTab"))}).catch(e=>{t.showNotification(e),(n=this.createForm(i)).reset(),n.inject(this.scoringModelForm),this.scoringModelForm.inject(this._scoringPanel),a.unmask(document.getElementById("scoringTab"))})},r.prototype.showNotification=function(t){if(e.is(t)&&e.is(t.notifDetails)){let e=t.notifDetails;window.notifs.addNotif({level:e.level?e.level:"info",title:e.title?e.title:"",subtitle:e.subtitle?e.subtitle:""})}},r.prototype.createForm=function(e){var t=this;return this.form=new i({className:"vertical",fields:e,buttons:[{type:"submit",value:l.SAVE},{type:"close",value:l.CANCEL,action:function(){if(Object.keys(t.previousScoringValues).length>0)for(let e in t.previousScoringValues)t.previousScoringValues[e]&&t.form.setValue(e,t.previousScoringValues[e]);else t.form.reset()}}],events:{onChange:function(e,i){t.updatedScoringValues[e]=i},onSubmit:function(){let e;t.isLoadingScoringTabForFirstTime?(e=t.form.getValues(),t.isLoadingScoringTabForFirstTime=!1):e=t.updatedScoringValues,a.mask(document.getElementById("scoringTab"),l.SAVING_SCORING_VALUES);let i={versionId:t.viewId,bItemsScores:{[t.currentItemData.proxyId]:e}};t.handlers.setScoringValues(i).then(e=>{let i=e.scoringValues[t.currentItemData.proxyId];for(let e in i)i[e]&&t.form.setValue(e,i[e]);t.previousScoringValues=i,t.showNotification(e),a.unmask(document.getElementById("scoringTab")),t.roadmapChannel.publish({event:"update-model-with-latest-scoring-values",data:{backlogItemId:t.currentItemData.proxyId,scoringValues:i,versionId:t.viewId}})}).catch(e=>{if(Object.keys(t.previousScoringValues).length>0)for(let e in t.previousScoringValues)t.previousScoringValues[e]&&t.form.setValue(e,t.previousScoringValues[e]);else t.form.reset();t.showNotification(e),a.unmask(document.getElementById("scoringTab"))})}}}),this.form},r.prototype._initPropertiesTab=function(){var e=this;this.recentlySelectedNodes&&1===this.recentlySelectedNodes.length?(this._idcardPanel.empty(),this._propertiesPanel.empty(),this._emptyContent.empty(),this.updateIDCard(),this.editPropWidget.getMainTable().inject(this._propertiesPanel),this.roadmapChannel.publish({event:this.EVENT_TRIPTYCH_SET_CONTENT,data:{side:"right",content:this._mainContainer}}),this._propertiesPanel.getElementsByClassName("facetContainer")[0].getElementsByClassName("EditProp_MainContain")[0]&&(this._propertiesPanel.getElementsByClassName("facetContainer")[0].getElementsByClassName("EditProp_MainContain")[0].style.height=this.triptychRightHeight-50+"px"),this.idCardUI.addEvent("resize",function(){e._mainContainer.offsetWidth<340||document.querySelector(".roadmap-informationPanel-idCard .idCardContainer .wux-ui-3ds-expand-down")?document.querySelector(".roadmap-informationPanel-idCard .idCardContainer")&&document.querySelector(".roadmap-informationPanel-idCard .idCardContainer").addClassName("noThumbnail"):(e._idcardPanel.setStyle("height",""),document.querySelector(".roadmap-informationPanel-idCard .idCardContainer")&&document.querySelector(".roadmap-informationPanel-idCard .idCardContainer").removeClassName("noThumbnail"))}),document.querySelector(".roadmap-informationPanel-idCard .idCardContainer .actions-section")&&document.querySelector(".roadmap-informationPanel-idCard .idCardContainer .actions-section").setStyle("padding-right","24px")):this.recentlySelectedNodes&&0===this.recentlySelectedNodes.length?(this.showMessageOnInfoPanel(l.EMPTY_MESSAGE),e.isInfoPanelBuilt=!1):(this.showMessageOnInfoPanel(l.MULTI_SELECTION_NOT_SUPPORTED),e.isInfoPanelBuilt=!1)},r.prototype.showMessageOnInfoPanel=function(e){var t=new o({sentences:[{type:"icon",sizeicon:"40px",text:e}]});this._emptyContent.empty(),t.inject(this._emptyContent),this.roadmapChannel.publish({event:this.EVENT_TRIPTYCH_SET_CONTENT,data:{side:"right",content:this._emptyContent}})},r.prototype.isInfoPanelOpen=function(){return this._isInfoPanelOpen},r.prototype.destroy=function(){if(this.roadmapChannelTokens&&this.roadmapChannelTokens.length>0)for(var t=0;t<this.roadmapChannelTokens.length;t++)this.roadmapChannel.unsubscribe(this.roadmapChannelTokens[t]);e.is(this.contentDiv)&&this.contentDiv.empty(),e.is(this._contentPanel)&&this._contentPanel.empty(),this.contentTabPresenter&&this.contentTabPresenter.destroy(),this.handlers={},this.updatedScoringValues={}},r}),define("DS/ENOXRoadmapPresenter/ENOXRoadmapListView",["UWA/Core","DS/Controls/Loader","DS/Controls/ModalContainer","DS/Controls/Button","DS/CoreEvents/ModelEvents","DS/Menu/ContextualMenu","DS/xPortfolioUXCommons/XModelListView/js/XModelListView","DS/xPortfolioUXCommons/XModelListView/js/XModelListViewDataExtension","DS/TreeModel/TreeDocument","DS/TreeModel/DataModelSet","DS/UIKIT/DropdownMenu","DS/UIKIT/Input/Button","DS/UIKIT/Mask","DS/ENOXDataDragAndDrop/js/ENOXDataDragAndDrop","DS/ENOXRoadmapPresenter/ObjectOpenWithMenuService","DS/ENOXRoadmapPresenter/ENOXRoadmapWidgetStorage","DS/ENOXRoadmapPresenter/ENOXRoadmapUtil","css!DS/ENOXRoadmapPresenter/assets/css/ENOXRoadmapPresenter.css","i18n!DS/ENOXRoadmapPresenter/assets/nls/ENOXRoadmapPresenter"],function(e,t,i,n,o,a,s,l,r,d,c,u,p,h,m,g,f,w,_){"use strict";const b={year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"numeric",timeZone:Intl.DateTimeFormat().resolvedOptions().timeZone},v="ds6w:what/ds6w:social/ds6w:endorsements",I="ds6w:what/ds6w:social/ds6w:comments",C="ds6w:dataSource.3DSwym";var E=function(){};return E.prototype.init=function(i){this._loader=new t,this.updateChannel=i.modelEvent,this.taggerChannel=i.taggerChannel?i.taggerChannel:void 0,this.taggerProxyId=i.taggerProxyId?i.taggerProxyId:void 0,this._localChannel=new o,this.container=i.container,this.predicates=i.predicates?i.predicates:[],this.withStatusBar=i.withStatusBar,this.viewId=i.viewId,this.objectId=i.objectId||void 0,this.isItBacklogsView=i.backlogsView||!1,this.customAttrbColumns=i.customAttrbColumns?i.customAttrbColumns:[],this.withReordering=i.withReordering,this.withReorderingFlagOrigValue=this.withReordering,this.withProxyManagement=i.withProxyManagement,this.withTaggerManagement=i.withTaggerManagement||!1,this.withInformationPanel=i.withInformationPanel,this.withCommunityPreference=!!i.withCommunityPreference&&i.withCommunityPreference,this.roadmapInfoPanel=i.roadmapInfoPanel?i.roadmapInfoPanel:{},this.compactView=i.compactView,this.orderAttribute=i.orderAttribute,this.withFullViewColumnSubHeader=i.withFullViewColumnSubHeader,this.isUserAllowedToModify=i.isUserAllowedToModify,this.allowedTypes=i.allowedTypes&&i.allowedTypes.length>0?i.allowedTypes:[],this.allowedTypes=this.allowedTypes.map(t=>{if(e.is(t)&&""!==t)return t.toLowerCase()}),this.withClassificationColumnVisible=!!i.withClassificationColumnVisible&&i.withClassificationColumnVisible,this.withLaneExpander=!!i.withLaneExpander&&i.withLaneExpander,this.scoringModelDetails=i.scoringModelDetails?i.scoringModelDetails:{},this.nlsKeyValueMap=i.nlsKeyValueMap,this.handlers=i.handlers?i.handlers:{},this.scoringModelDetails&&(this.isScoringModelSet=this.scoringModelDetails.isScoringModelSet,this.selectedScoringModelId=this.scoringModelDetails.selectedScoringModelId,this.scoringModelMapping=this.scoringModelDetails.scoringModelMapping,this.defaultColAttributes=["type","owner","created","modified"],this.withClassificationColumnVisible&&this.defaultColAttributes.push("classification"),this.withCommunityPreference&&(this.defaultColAttributes.push(v),this.defaultColAttributes.push(I),this.defaultColAttributes.push(C)),this.scoringModelAttributes=this.scoringModelMapping.attributes,this.editableAttributes=this.scoringModelMapping.editableAttributes,this.typeRepresentations=this.scoringModelDetails.typeRepresentations),this._tagActivated=!1,this.sortActivated=!1,this.inEditMode=!1,this.isCurrentViewExpanded=!1,this.areScoringValuesFetched=!1,this._contentIdsList=[],this.bItemIds=[],this.scoringValuesForBacklogItems={},this.scoringValuesToSave={},this._eventTokens=[],this._listViewChannelTokens=[],this._taggerChannelTokens=[],this._treeModelTokens=[],this.EVENT_UPDATE_CURR_SCORING_MODEL_INFO="update-current-scoring-model-info",this.EVENT_UPDATE_KANBAN_COLUMNS_VISIBILITY="update-kanban-columns-visibility",this.EVENT_COLLECTION_TOOLBAR_SWITCH_VIEW="enox-collection-toolbar-switch-view-activated",this.EVENT_UPDATE_COLUMN_DEFINITION="xmodel-list-view-update-column-definition",this.EVENT_UPDATE_MODEL_WITH_LATEST_SCORING_VALUES="update-model-with-latest-scoring-values",this.EVENT_CLOSE_BACKLOG_PANE="close-backlog-pane",this._prepareTilesView(i),this.subscribeDNDEvents(),this.subscribeEvents()},E.prototype._prepareTilesView=function(t){var i=this;if(this._creatListViewModel(),this._listView=new s(this._getViewOptions(t)),e.extend(this._listView._contentViews.LargeThumbnailView,{onDragOverCell:function(e,t){const i=t.cellView.getContent().getBoundingClientRect();return!i||!t.cellView||(e.clientY<i.top+i.height/10||e.clientY>=i.top+9*i.height/10)}}),t&&t.withHeader&&(this._listViewHeader=e.createElement("div",{class:"listViewHeader"}),this._listViewHeaderText=e.createElement("div",{class:"listViewHeaderText"}),t.withFullViewColumnSubHeader&&(this._listViewSubHeaderText=e.createElement("div",{class:"listViewHeaderText"})),this._listViewHeaderActions=e.createElement("div",{class:"listViewHeaderActions"}),!t.compactView&&t.backlogsView&&(this.closeButton=e.createElement("div",{class:"fonticon fonticon-wrong expandAction",title:_.CLOSE,events:{click:function(){i.updateChannel.publish({event:i.EVENT_CLOSE_BACKLOG_PANE,data:{viewId:i.viewId}})}}}),this.closeButton.inject(this._listViewHeaderActions),this._listViewHeaderActions.inject(this._listViewHeader)),!t.compactView&&this.withLaneExpander&&(this.expandBtn=e.createElement("div",{class:"fonticon fonticon-resize-full expandAction",title:_.EXPAND_AND_GOTO_GRIDVIEW,events:{click:function(){let e=i.isCurrentViewExpanded?"minimize":"maximize";if(i.isCurrentViewExpanded=!i.isCurrentViewExpanded,i.updateChannel.publish({event:i.EVENT_UPDATE_KANBAN_COLUMNS_VISIBILITY,data:{viewId:i.viewId,action:e}}),"maximize"===e?g.updateRoadmapWidgetStorage("full","expandedColumn",i.viewId):g.updateRoadmapWidgetStorage("full","expandedColumn",""),i.isCurrentViewExpanded){i.expandBtn.title=_.COLLAPSE_AND_GOTO_TILEVIEW,i.expandBtn.classList.remove("fonticon-resize-full"),i.expandBtn.classList.add("fonticon-resize-small"),i._floatCreateBtn&&(i._floatCreateBtn.style.display="none");let e=[];e.push(...i.defaultColAttributes),i.predicates.length>0&&(e=e.concat(i.predicates)),i.isScoringModelSet&&(i._model.getChildren().length>0&&(i.editBtn.style.display="inline-block",i.editBtn.style.float="right"),i.scoringModelAttributes&&i.scoringModelAttributes.length>0&&e.push(...i.scoringModelAttributes),0===i._model.getChildren().length?i.editBtn.style.display="none":i.editBtn.style.display="inline-block"),i._localChannel.publish({event:i.EVENT_COLLECTION_TOOLBAR_SWITCH_VIEW,data:"DataGridView"}),i.updateColumnDefinition(e,{visibleFlag:!0}),i.getScoringValues()}else{i.editBtn.style.display="none",i.expandBtn.title=_.EXPAND_AND_GOTO_GRIDVIEW,i.expandBtn.classList.remove("fonticon-resize-small"),i.expandBtn.classList.add("fonticon-resize-full"),i._floatCreateBtn&&(i._floatCreateBtn.style.display="block"),i.container.getElementsByClassName("xmodel-list-view")[0].style.height="calc(100% - 75px)",i._listViewFooter.style.display="none",i._localChannel.publish({event:i.EVENT_COLLECTION_TOOLBAR_SWITCH_VIEW,data:"LargeThumbnailView"});let e=[];e.push(...i.defaultColAttributes),i.isScoringModelSet&&i.scoringModelAttributes&&i.scoringModelAttributes.length>0&&e.push(...i.scoringModelAttributes),i.updateColumnDefinition(e,{visibleFlag:!1}),i.getScoringValues()}}}}),this.expandBtn.inject(this._listViewHeaderActions),this.editBtn=e.createElement("div",{class:"fonticon fonticon-pencil editAction",styles:{display:"none"},title:_.SWITCH_TO_EDIT_MODE,events:{click:function(){i.inEditMode=!i.inEditMode,i.inEditMode?(i.editBtn.title=_.SWITCH_TO_READONLY_MODE,i._floatCreateBtn&&(i._floatCreateBtn.style.display="none"),i._listViewFooter.style.display="block",i.container.getElementsByClassName("xmodel-list-view")[0].style.height="calc(100% - 120px)",i.updateColumnDefinition(i.editableAttributes,{editableFlag:!0})):(i.inEditMode=!1,i.editBtn.title=_.SWITCH_TO_EDIT_MODE,i._listViewFooter.style.display="none",i.container.getElementsByClassName("xmodel-list-view")[0].style.height="calc(100% - 75px)",i.updateColumnDefinition(i.editableAttributes,{editableFlag:!1}))}}}),this.editBtn.inject(this._listViewHeaderActions),this._listViewHeaderActions.inject(this._listViewHeader)),this._listViewHeaderText.inject(this._listViewHeader),t.withFullViewColumnSubHeader&&this._listViewSubHeaderText.inject(this._listViewHeader),this._headerTextPartial=void 0!==t.listHeader?t.listHeader:"TILE VIEW HEADER",this._subHeaderTextPartial=void 0!==t.listSubHeader?t.listSubHeader:"",this._updateHeaderText(),this._listViewHeader.inject(this.container)),t&&t.withCreateAction){this._floatCreateBtn=e.createElement("span",{class:"fonticon fonticon-plus listViewPlusAction",title:_.SEARCH_AND_ADD});let t=this.handlers.getCreateActionMenu();if(t.forEach(function(e){let t=e.handler;e.handler=function(){i.container.hasClassName("containerSelected")||i.container.addClassName("containerSelected"),t()}}),t&&t.length>1)new c({target:this._floatCreateBtn,items:t});else this._floatCreateBtn.onclick=function(t){e.Event.stop(t),i.updateChannel.publish({event:"roadmap-list-launch-search",data:{viewId:i.viewId}})};this._floatCreateBtn.inject(this.getListViewContainer()),this.isUserAllowedToModify||(this._floatCreateBtn.style.opacity="40%",this._floatCreateBtn.style.pointerEvents="none")}this._listView.inject(this.container),!t.compactView&&this.withLaneExpander&&(this._listViewFooter=e.createElement("div",{class:"listViewFooter"}),this._listViewFooterContent=e.createElement("div",{class:"listViewFooterContent"}),this._listViewFooterContent.inject(this._listViewFooter),this.saveBtn=new u({value:_.SAVE,className:"primary saveBtn",disabled:!0,events:{onClick:function(){if(Object.keys(i.scoringValuesToSave).length>0){let t={versionId:i.viewId,bItemsScores:i.scoringValuesToSave};p.mask(i.container,_.SAVING_SCORING_VALUES),i.handlers.setScoringValues(t).then(t=>{i.areValuesSaved=!0;let n=t.scoringValues;p.unmask(i.container);for(let t in n)e.is(n[t])&&(i.scoringValuesForBacklogItems[t]=n[t]);i._listViewFooter.style.display="none",i.container.getElementsByClassName("xmodel-list-view")[0].style.height="calc(100% - 75px)",i.updateColumnDefinition(i.scoringModelAttributes,{editableFlag:!1}),i.scoringValuesToSave={},i.areScoringValuesFetched=!1,i.saveBtn.isDisabled()||i.saveBtn.setDisabled(!0),i.showNotification(t)}).catch(e=>{p.unmask(i.container),i.updateModelsWithScoringValues(),i.updateColumnDefinition(i.scoringModelAttributes,{editableFlag:!1}),i.showNotification(e)})}}}}),this.cancelBtn=new u({value:_.CANCEL,className:"default cancelBtn",events:{onClick:function(){i.updateModelsWithScoringValues();let e=[];i.isScoringModelSet&&i.selectedScoringModelId&&"None"!==i.selectedScoringModelId&&i.scoringModelAttributes&&i.scoringModelAttributes.length>0&&i.scoringModelAttributes.forEach(t=>{e.push({dataIndex:t,properties:{editableFlag:!1}})}),i._localChannel.publish({event:i.EVENT_UPDATE_COLUMN_DEFINITION,data:e}),i.inEditMode=!i.inEditMode,i.saveBtn.isDisabled()||i.saveBtn.setDisabled(!0)}}}),this.saveBtn.inject(this._listViewFooterContent),this.cancelBtn.inject(this._listViewFooterContent),this._listViewFooter.inject(this.container));var n=this.container.getElementsByClassName("xmdllv-collectiontoolbar-container");!t.backlogsView&&n&&1===n.length?n[0].classList.add("hideIt"):!t.compactView&&t.backlogsView&&0===i._contentIdsList.length?n[0].classList.add("hideIt"):i.withCommunityPreference||n[0].classList.add("hideIt"),!t.compactView&&t.withRMBOnEmptyArea&&i._listView._container&&i._listView._container.querySelector(".mdllv-empty-container")&&i.isUserAllowedToModify&&(i._setEmptyViewContextualMenu(i._listView._container.querySelector(".mdllv-empty-container")),i._setEmptyViewContextualMenu(i._listView._container.querySelector(".xmdllv-list-container")))},E.prototype._setEmptyViewContextualMenu=function(e){var t=this;a.addEventListener(e,{callback:function(e){let i=!0;if((e.data.listener.getElementsByClassName("wux-layouts-gridengine-poolcontainer-rel")[0]||e.data.listener.getElementsByClassName("wux-layouts-right-poolcontainer")[0])&&("DataGridView"===t._listView._currentView?(e.data.listener.getElementsByClassName("wux-layouts-gridengine-poolcontainer-rel")[0].getElementsByClassName(e.data.target.className)[0]||e.data.listener.getElementsByClassName("wux-layouts-right-poolcontainer")[0].getElementsByClassName(e.data.target.className)[0])&&(i=!1):e.data.listener.getElementsByClassName("wux-layouts-gridengine-poolcontainer-rel")[0].getElementsByClassName(e.data.target.className)[0]&&(i=!1)),i){let e=t.handlers.getCreateActionMenu();return e.forEach(function(e){let i=e.handler;e.handler=function(){t.container.hasClassName("containerSelected")||t.container.addClassName("containerSelected"),i()},e.type="PushItem",e.title=e.text,e.fonticon={content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-"+e.fonticon},e.action={callback:e.handler}}),e}}})},E.prototype.showNotification=function(t){if(e.is(t)&&e.is(t.notifDetails)){let e=t.notifDetails;window.notifs.addNotif({level:e.level?e.level:"info",title:e.title?e.title:"",subtitle:e.subtitle?e.subtitle:""})}},E.prototype.updateModelsWithScoringValues=function(){for(let t in this.scoringValuesToSave)if(this.scoringValuesForBacklogItems[t]){let i=this.scoringValuesForBacklogItems[t],n=this._model.getChildren().find(e=>e.getAttributeValue("proxyId")===t);if(e.is(n)){n.prepareUpdate();let e={};e.grid=i,n.updateOptions(e),n.pushUpdate()}}this.areScoringValuesFetched=!1,this.scoringValuesToSave={},this._listViewFooter.style.display="none",this.container.getElementsByClassName("xmodel-list-view")[0].style.height="calc(100% - 75px)"},E.prototype.getScoringValues=function(t){var i=this;if(i.isScoringModelSet&&!i.areScoringValuesFetched){let n,o=i._model.getChildren();(n=t&&t.length>0?t:o.map(t=>e.is(t.getAttributeValue("proxyId"))?t.getAttributeValue("proxyId"):t.getAttributeValue("id"))).length>0&&(p.mask(i.container,_.FETCHING_SCORING_VALUES),i.handlers.getScoringValues(n).then(t=>{i.scoringValuesForBacklogItems=t.scoringValues;for(let t in i.scoringValuesForBacklogItems)if(i.scoringValuesForBacklogItems[t]){let n=t,a=i.scoringValuesForBacklogItems[t],s=o.find(e=>e.getAttributeValue("proxyId")===n||e.getAttributeValue("id")===n);if(e.is(s)){s.prepareUpdate();let e={};e.grid=a,s.updateOptions(e),s.pushUpdate()}}i.areScoringValuesFetched=!0,i.withStatusBar&&i._localChannel.publish({event:"xmodel-list-show-status-bar"}),p.unmask(i.container),i.showNotification(t)}).catch(e=>{p.unmask(i.container),i.showNotification(e)}))}},E.prototype.updateColumnDefinition=function(e,t){let i=[];e&&e.length>0&&e.forEach(e=>{i.push({dataIndex:e,properties:t})}),this._localChannel.publish({event:this.EVENT_UPDATE_COLUMN_DEFINITION,data:i})},E.prototype.setHeaderTextVisibility=function(e){e&&!0===e.visible?(this._listViewHeaderText.removeClassName("hideIt"),e.withFullViewColumnSubHeader&&this._listViewSubHeaderText.removeClassName("hideIt")):(this._listViewHeaderText.addClassName("hideIt"),e.withFullViewColumnSubHeader&&this._listViewSubHeaderText.addClassName("hideIt"))},E.prototype.getListViewContainer=function(){return this._listView._container},E.prototype._creatListViewModel=function(){this._dataModelSet=new d,this._model=new r({shouldAcceptDrop:function(){return!0}})},E.prototype.getTreeModel=function(){return this._model},E.prototype.getContentLength=function(){return this._contentIdsList.length},E.prototype._updateHeaderText=function(){this._listViewHeaderText&&this._listViewHeaderText.setHTML(this._headerTextPartial+" ("+this._contentIdsList.length+")"),this._listViewSubHeaderText&&this.withFullViewColumnSubHeader&&this._listViewSubHeaderText.setHTML(this._subHeaderTextPartial),this.updateChannel.publish({event:"list-view-items-count-updated",data:{itemsCount:this._contentIdsList.length}})},E.prototype.subscribeEvents=function(){var t=this;this._treeModelTokens.push(this._model.subscribe({event:"addChild"},function(e){var i=e&&e.data&&e.data.nodeModel?e.data.nodeModel:void 0;i&&i.options&&i.options.id&&(t._contentIdsList.push(i.options.id),t._updateHeaderText(),!t.compactView&&t.isCurrentViewExpanded&&t.isScoringModelSet&&(t.editBtn.style.display="inline-block"))})),this._treeModelTokens.push(this._model.subscribe({event:"removeChild"},function(e){var i=e&&e.data&&e.data.nodeModel?e.data.nodeModel:void 0;if(i&&i.options&&i.options.id){var n=t._contentIdsList.indexOf(i.options.id);n>=0&&(t._contentIdsList.splice(n,1),t._updateHeaderText())}})),this._eventTokens.push(this.updateChannel.subscribe({event:"list-view-update-header"},function(e){t._listViewHeaderText&&e&&void 0!==e.text&&t._listViewHeaderText.setHTML(e.text)})),this._eventTokens.push(this.updateChannel.subscribe({event:"xmodel-list-view-switch-view"},function(e){e&&(t._localChannel.publish({event:t.EVENT_COLLECTION_TOOLBAR_SWITCH_VIEW,data:e}),t.expandBtn&&(t.expandBtn.classList.remove("fonticon-resize-small"),t.expandBtn.classList.add("fonticon-resize-full")),t.editBtn&&"inline-block"===t.editBtn.style.display&&(t.editBtn.style.display="none"),"LargeThumbnailView"===e&&(t.isCurrentViewExpanded=!1))})),this._eventTokens.push(this.updateChannel.subscribe({event:this.EVENT_UPDATE_MODEL_WITH_LATEST_SCORING_VALUES},function(i){if(t.isCurrentViewExpanded||i.versionId===t.viewId){p.mask(t.container,_.UPDATING_SCORING_VALUES);let n=t._model.getChildren();if(n&&n.length>0){let t=n.find(e=>e.getAttributeValue("proxyId")===i.backlogItemId);e.is(t)&&(t.prepareUpdate(),t.updateOptions({grid:i.scoringValues}),t.pushUpdate())}t.areScoringValuesFetched=!1,p.unmask(t.container)}})),this._eventTokens.push(this.updateChannel.subscribe({event:this.EVENT_UPDATE_CURR_SCORING_MODEL_INFO},function(e){try{if(t.isCurrentViewExpanded&&t.withLaneExpander&&(t.editBtn.style.display=e.isScoringModelSet?"inline-block":"none"),e.isScoringModelSet&&t.selectedScoringModelId!==e.selectedScoringModelId){t.areScoringValuesFetched=!1,Object.keys(t.scoringModelMapping).length>0&&t.scoringModelMapping.attributes.forEach(e=>{let i=t._listView.getColumnIndex(e);t._listView.removeColumnOrGroup(i)});let i=e.scoringModelMapping.columnDefinition.columns,n=JSON.parse(JSON.stringify(i));n.forEach(e=>{e.setCellValue=t._setCellValueHandler.bind(t),e.getCellSemantics=t._getCellSemanticsHandler.bind(t)}),n&&n.length>0&&t._localChannel.publish({event:"xmodel-list-add-columns",data:n}),t.selectedScoringModelId=e.selectedScoringModelId,t.scoringModelMapping=e.scoringModelMapping,t.isScoringModelSet=e.isScoringModelSet,t.scoringModelAttributes=t.scoringModelMapping.attributes,t.editableAttributes=t.scoringModelMapping.editableAttributes,t.getScoringValues(),t.isCurrentViewExpanded&&(t.areScoringValuesFetched=!1,t.updateColumnDefinition(e.scoringModelMapping.attributes,{visibleFlag:!0}))}else e.isScoringModelSet||(Object.keys(t.scoringModelMapping).length>0&&t.scoringModelMapping.attributes.forEach(e=>{let i=t._listView.getColumnIndex(e);t._listView.removeColumnOrGroup(i)}),t.withCommunityPreference?(t.areScoringValuesFetched=!1,t.getScoringValues()):t._localChannel.publish({event:"xmodel-list-hide-status-bar"}));t.selectedScoringModelId=e.selectedScoringModelId,t.scoringModelMapping=e.scoringModelMapping,t.isScoringModelSet=e.isScoringModelSet,t.scoringModelAttributes=t.scoringModelMapping.attributes,t.editableAttributes=t.scoringModelMapping.editableAttributes}catch(e){console.log("Exception occured: "+e.message)}})),this._eventTokens.push(this.updateChannel.subscribe({event:"update-community-list"},function(i){if(t.communityList=i.communityList,"{}"!==widget.getValue("communityPreference")&&g.createCommunityPreference(t.communityList),t.communityList&&t.communityList.length>0){document.getElementsByClassName("wux-ui-3ds-list-filter")[0]&&(document.getElementsByClassName("wux-ui-3ds-list-filter")[0].style.display="block");var n=[];t.communityList.forEach(function(e,i){let o=JSON.parse(widget.getValue("communityPreference"))[e.label];n.push({fonticon:"",id:o.label,text:o.label,parentId:"Ideation_Stream",selectable:!0,type:"CheckItem",title:o.label,selected:o.selected,state:o.selected?"selected":"",context:i,action:{context:i,callback:function(e){t._listView._collectionToolBar._collectionToolBar._options.filterActions[0].actions[1].submenu[e.context].selected?(t._listView._collectionToolBar._collectionToolBar._options.filterActions[0].actions[1].submenu[e.context].selected=!1,t._listView._collectionToolBar._collectionToolBar._options.filterActions[0].actions[1].submenu[e.context].state=""):(t._listView._collectionToolBar._collectionToolBar._options.filterActions[0].actions[1].submenu[e.context].selected=!0,t._listView._collectionToolBar._collectionToolBar._options.filterActions[0].actions[1].submenu[e.context].state="selected");let i={label:t._listView._collectionToolBar._collectionToolBar._options.filterActions[0].actions[1].submenu[e.context].title,parentId:"Ideation_Stream",selected:t._listView._collectionToolBar._collectionToolBar._options.filterActions[0].actions[1].submenu[e.context].selected};g.updateCommunityPreference(i),t.updateChannel.publish({event:"load-backlog-data",data:i})}}})}),t._listView._collectionToolBar._collectionToolBar._options.filterActions[0]&&(g.isMaturedIdeaOnly()?(t._listView._collectionToolBar._collectionToolBar._options.filterActions[0].actions[0].submenu[0].selected=!0,t._listView._collectionToolBar._collectionToolBar._options.filterActions[0].actions[0].submenu[0].state="selected"):(t._listView._collectionToolBar._collectionToolBar._options.filterActions[0].actions[0].submenu[0].selected=!1,t._listView._collectionToolBar._collectionToolBar._options.filterActions[0].actions[0].submenu[0].state=""),t._listView._collectionToolBar._collectionToolBar._options.filterActions[0].actions[1]={id:"Ideation_Stream",text:_.IDEATION_STREAMS,title:_.IDEATION_STREAMS,selectable:!1,isSelected:!0,items:"",multiSelect:!0,state:"selected",submenu:n,type:"PushItem",handler:function(){e.log("isLastRevision")},action:{callback:function(t){e.log("isLastRevision")}}})}else t.updateChannel.publish({event:"load-backlog-data"}),document.getElementsByClassName("wux-ui-3ds-list-filter")[0]&&(document.getElementsByClassName("wux-ui-3ds-list-filter")[0].style.display="none")})),this._eventTokens.push(this._localChannel.subscribe({event:"xmodel-list-collection-toolbar-filter-changed"},function(e){t.viewId&&(g.updateCommunityPreference(e),t.updateChannel.publish({event:"load-backlog-data",data:e}))})),this._eventTokens.push(this.updateChannel.subscribe({event:"roadmap-filter-list-on-search-value"},function(e){if(e){let i=e.searchValue[0]||"";t._localChannel.publish({event:"xmodel-list-context-search-action",context:t._model,data:i})}})),this._eventTokens.push(this.updateChannel.subscribe({event:"roadmap-sort-list"},function(e){e&&(t.withReordering=!1,t.sortActivated=!0,t._localChannel.publish({event:"enox-collection-toolbar-sort-activated",data:e}))})),this._eventTokens.push(this.updateChannel.subscribe({event:"roadmap-clear-sort"},function(){t.withReordering=t.withReorderingFlagOrigValue,t.sortActivated=!1,t._localChannel.publish({event:"enox-collection-toolbar-sort-activated",data:{sortOrder:"asc",sortAttribute:t.orderAttribute}})})),this._eventTokens.push(this.updateChannel.subscribe({event:"xmodel-list-data-item-append-action"},function(e){if(e&&e.viewId&&e.viewId===t.viewId){if(t._localChannel.publish({event:"xmodel-list-data-item-append-action",context:t._model,data:e}),e.shouldFetchScoringValues){t.areScoringValuesFetched=!1;let i=[];e.member.forEach(e=>{let n=t.withProxyManagement?e.proxyId:e.id;i.push(n)}),i.length>0&&t.getScoringValues(t.bItemIds)}!t.compactView&&t.isCurrentViewExpanded&&t.isScoringModelSet&&(e.itemsCount>0?t.editBtn.style.display="inline-block":e.itemsCount<0&&(t.editBtn.style.display="none"))}})),this._eventTokens.push(this.updateChannel.subscribe({event:"xmodel-list-data-on-load-start"},function(e){e&&e.viewId&&e.viewId===t.viewId&&t._localChannel.publish({event:"xmodel-list-data-on-load-start",data:e})})),this._eventTokens.push(this._localChannel.subscribe({event:"xmodel-list-item-on-add-selection"},function(e){t.selectedNodes=e.items;let i={selectedNodes:t.selectedNodes,viewId:t.viewId};g.updateRoadmapWidgetStorage("full","lastSelectedNode",i.selectedNodes[0]._options.grid.proxyId),t.updateChannel.publish({event:"update-selected-nodes-and-info-panel",data:i})})),this._eventTokens.push(this._localChannel.subscribe({event:"xmodel-list-item-on-remove-selection"},function(e){let i=e.model.proxyId;t.selectedNodes.forEach((e,n)=>{e.getAttributeValue("proxyId")===i&&t.selectedNodes.splice(n,1)}),t.updateChannel.publish({event:"update-selected-nodes-and-info-panel",data:{selectedNodes:t.selectedNodes,viewId:t.viewId}})})),this._eventTokens.push(this.updateChannel.subscribe({event:"xmodel-list-data-load-action"},function(e){e&&e.viewId&&e.viewId===t.viewId&&(t._localChannel.publish({event:"xmodel-list-data-load-action",data:e}),t.updateChannel!==t.taggerChannel&&t.taggerChannel.publish({event:"xmodel-list-data-load-action",data:e}))})),this._eventTokens.push(this.updateChannel.subscribe({event:"xmodel-list-data-on-load-complete"},function(e){e&&e.viewId&&e.viewId===t.viewId&&t._localChannel.publish({event:"xmodel-list-data-on-load-complete",data:e})})),this._eventTokens.push(this.updateChannel.subscribe({event:"xmodel-list-data-item-remove-action"},function(e){if(e&&e.viewId&&e.viewId===t.viewId&&e.ids&&e.ids.length>0){let i=e.ids;t.withProxyManagement&&(i=[],t._model.getChildren().forEach(t=>{if(t){let n=t&&t.options.grid.proxyId?t.options.grid.proxyId:t.options.id;n&&-1!==e.ids.indexOf(n)&&i.push(t.options.id)}})),!t.compactView&&t.withLaneExpander&&t._model.getChildren().length===i.length&&(t.editBtn.style.display="none"),t._localChannel.publish({event:"xmodel-list-data-item-remove-action",data:i})}})),this._eventTokens.push(this.updateChannel.subscribe({event:"xmodel-list-data-sort-action"},function(e){e&&e.viewId===t.viewId&&t._model&&t._model.getChildren().length>1&&t._localChannel.publish({event:"xmodel-list-data-sort-action",data:e.sortModel})})),this._eventTokens.push(this.updateChannel.subscribe({event:"listview-update-item-order"},function(e){if(e&&t._model&&t._model.getChildren().length>0&&e.response){let i=e.response;Object.keys(i).forEach(e=>{let n;if(e&&t._model.search({shouldStop:function(i){let o=t.withProxyManagement&&i.options.grid&&i.options.grid.proxyId?i.options.grid.proxyId:i.options.id;return e===o&&(n=i,!0)}}),n){n.prepareUpdate();let o={grid:{}};o.grid[t.orderAttribute]=i[e],n.updateOptions(o),n.pushUpdate()}})}})),this.withTaggerManagement&&(["xmodel-list-tagger-activate-action","xmodel-list-tagger-deactivate-action","xmodel-list-tagger-update-friend-tags-action","xmodel-list-data-on-search-complete","xmodel-list-tagger-update-filtered-item","xmodel-list-tagger-focus-action","xmodel-list-tagger-unfocus-action","xmodel-list-tagger-init-action","xmodel-list-tagger-set-filter-action","xmodel-list-tagger-get-filter-action"].forEach(e=>{t._listViewChannelTokens.push(t._localChannel.subscribe({event:e},function(i){t.taggerChannel.publish({event:e,data:i})}))}),[,"xmodel-list-tagger-on-setup","xmodel-list-data-filter-action","xmodel-list-tagger-on-filter-change"].forEach(e=>{t._taggerChannelTokens.push(t.taggerChannel.subscribe({event:e},function(i){t._localChannel.publish({event:e,data:i})}))}),t._taggerChannelTokens.push(t.taggerChannel.subscribe({event:"roadmap-tagger-on-tag-color"},function(e){t._setDataColor(e)})),t._taggerChannelTokens.push(t.taggerChannel.subscribe({event:"roadmap-tagger-on-tag-de-color"},function(){t._unsetDataColor()})))},E.prototype.activateTags=function(){this._tagActivated||(this._localChannel.publish({event:"xmodel-list-tagger-activate-action"}),this._tagActivated=!0)},E.prototype.deactivateTags=function(){this._tagActivated&&(this._localChannel.publish({event:"xmodel-list-tagger-deactivate-action"}),this._tagActivated=!1)},E.prototype._setupDroppableRegions=function(){var t=this,i=0;this._onMainDivDragEnter=function(e){i++,e.preventDefault(),t.emptyContainer=e.currentTarget.getElement(".mdllv-empty-container");let n=t.emptyContainer.className.includes("displaynone"),a="",s="";"backlogListContainer"===e.currentTarget.className?a=_.DROP_HERE_FOR_BACKLOG:(s=e.currentTarget.getElement(".listViewHeaderText").innerHTML,a=_.DROP_HERE_FOR_PLAN+s),t.droppableArea=e.currentTarget.getElement(".xmodel-list-view"),t.emptyContainer=e.currentTarget.getElement(".mdllv-empty-container"),t.withReordering?n?t.droppableArea.classList.add("enox-drag-over"):(t.droppableArea.classList.add("enox-drag-over"),t.droppableArea.getElement("#dnd-drop-invite")?t.updateDropInviteMessage(a):o(a).inject(t.droppableArea,"top")):t.droppableArea.getElement("#dnd-drop-invite")?t.updateDropInviteMessage(a):o(a).inject(t.droppableArea,"top"),t.droppableArea.getElement("#dnd-drop-invite")&&t.droppableArea.getElement("#dnd-drop-invite").classList.add("hidden")},this.updateDropInviteMessage=function(e){e!==event.currentTarget.getElement(".xmodel-list-view").getElement("#dnd-drop-invite").getElement("#childSection2").getText()&&(event.currentTarget.getElement(".xmodel-list-view").getElement("#dnd-drop-invite").getElement("#childSection2").innerHTML=e),t.droppableArea.getElement("#dnd-drop-invite").classList.remove("hidden")},this._onMainDivDragLeave=function(){i--,!0===t.withReordering&&0!==i||0===i&&(t.emptyContainer.style.display="",n([t.droppableArea]),i=0)},this._onMainDivDrop=function(e){if(!0===t.withReordering)return e.preventDefault(),n([t.droppableArea]),(e.dataTransfer.files.length>0||!t.handlers.isLaneModifiable(t.viewId))&&(t.emptyContainer.style.display="block"),void(i=0);e.preventDefault(),(e.dataTransfer.files.length>0||!t.handlers.isLaneModifiable(t.viewId))&&(t.emptyContainer.style.display="block"),n([t.droppableArea]),i=0},this.container.addEventListener("dragenter",this._onMainDivDragEnter),this.container.addEventListener("dragleave",this._onMainDivDragLeave),this.container.addEventListener("drop",this._onMainDivDrop);var n=function(e){e.forEach(function(e){e.removeEventListener("dragover",t._onMainDivDragEnter),e.removeEventListener("ondragleave",t._onMainDivDragLeave),e.removeEventListener("ondrop",t._onMainDivDrop),e.getElement("#dnd-drop-invite")&&e.getElement("#dnd-drop-invite").classList.add("hidden"),e.classList.remove("enox-drag-over")})},o=function(t){var i=e.createElement("div",{id:"dnd-drop-invite",class:"dropinvite",html:""}),n=e.createElement("div",{id:"childSection1"}),o=e.createElement("div",{id:"childSection2"}),a=e.createElement("div",{id:"childSection3"}),s=e.createElement("div",{id:"childSection4"}),l=e.createElement("span",{html:t||_.DROP_CONTENT_HERE}),r=e.createElement("div",{class:"empty-view-icon empty-view-icon center-block fonticon fonticon-1x fonticon-drag-drop"}),d=e.createElement("p",{}),c=e.createElement("p",{}),u=e.createElement("p",{});return n.appendChild(r),n.appendChild(d),o.appendChild(l),o.appendChild(c),a.appendChild(u),i.appendChild(n),i.appendChild(o),i.appendChild(s),i}},E.prototype.subscribeDNDEvents=function(){var e=this;new h({droppableAreas:[this.container],modelEvents:this._localChannel}),this._setupDroppableRegions(),this._listViewChannelTokens.push(this._localChannel.subscribe({event:"onDrop"},t=>{if(!1===e.withReordering&&t&&t.data.data.fromId===e.viewId)return window.notifs.addNotif({level:"warning",title:_.ERROR_DROP_NOT_SUPPORTED,subtitle:_.ERROR_DROP_IN_SAME_LANE_WITHOUT_ORDERING}),void t.event.stopPropagation();var i=[];let n={};var o=0;let a=t.data.data.items?t.data.data.items:t.data.data.files?t.data.data.files:[],s=a.length;if(s<=0)return void(t.data.data&&e.showNotification({notifDetails:{level:"warning",title:_.ERROR_DROP_NOT_SUPPORTED,subtitle:_.DROP_TYPE_NOT_SUPPORTED}}));a.forEach(function(t){let i=t.objectType;i&&e.allowedTypes.indexOf(i.toLowerCase())<0&&o++});let l=s-o;if(e.withReordering){let o,u=0,p=0,h=1,m=1;if(t&&t.event.toElement&&t.event.toElement.dsModel&&t.event.toElement.dsModel.cellInfos&&t.event.toElement.dsModel.cellInfos.nodeModel){let i=t.event.toElement.dsModel.cellInfos.nodeModel;const n=t.event.toElement.getBoundingClientRect();let a;if(n&&(a=t.event.clientY<n.top+n.height/10?"top":t.event.clientY>=n.top+9*n.height/10?"bottom":"middle"),"top"===a){let t=i.getPreviousBrother();t?(h=u=t.options.grid[e.orderAttribute],p=i.options.grid[e.orderAttribute],o="plus",m=p>u?(p-u)/(l+1):p/(l+1)):(h=p=i.options.grid[e.orderAttribute],o="minus",m=p/(l+1))}else if("bottom"===a){let t=i.getNextBrother();t?(h=u=i.options.grid[e.orderAttribute],p=t.options.grid[e.orderAttribute],o="plus",m=(p-u)/(l+1)):(h=p=i.options.grid[e.orderAttribute],o="plus",m=1)}else"middle"===a&&(h=p=i.options.grid[e.orderAttribute],o="plus",m=1)}else{let t=e._model.getChildren().length;h=p=t<=0?0:t>0?e._model.getChildren()[t-1].options.grid[e.orderAttribute]:1,o="plus",m=1}m=Math.abs(m);let g=1;for(var r=!1,d=0,c=s;d<c&&!(g>l);d++){let t=a[d],s=t.objectType;if(s&&e.allowedTypes.indexOf(s.toLowerCase())>-1){let a=t.grid&&t.grid.proxyId?t.grid.proxyId:"";!e.withCommunityPreference||""!==a||"idea"!==s&&"Idea"!==s&&"swym:Idea"!==s||(r=!0);let l=t.serviceId,d=t.objectId.replace("&lt;","<").replace("&gt;",">");"idea"===s.toLowerCase()&&(s="swym:Idea",l="swym:"+t.envId);let c={id:d,proxyId:a,type:s,title:t.displayName,service:l};if(c[e.orderAttribute]="plus"===o?h+g*m:h-g*m,t.grid){let i=t.grid;i[e.orderAttribute]=c[e.orderAttribute],n[d]=i}i.push(c),g++}}}else a.forEach(function(t){var a=t.objectType;if(a&&e.allowedTypes.indexOf(a.toLowerCase())>-1){let e=t.grid&&t.grid.proxyId?t.grid.proxyId:"",o=t.serviceId,s=t.objectId.replace("&lt;","<").replace("&gt;",">");"idea"===a.toLowerCase()&&(a="swym:Idea",o="swym:"+t.envId);let l={id:s,proxyId:e,type:a,title:t.displayName,service:o};if(t.grid){let e=t.grid;n[s]=e}i.push(l)}else o++});var u=window.notifs&&"function"==typeof window.notifs.addNotif?window.notifs.addNotif:function(){};i.length>0&&e.updateChannel.publish({event:"roadmap-list-add-dropped-content",data:{items:i,itemIdGridMap:n,viewId:e.viewId,fromId:t.data.data.fromId&&!r?t.data.data.fromId:void 0}});let p=e.nlsKeyValueMap&&e.nlsKeyValueMap.SOME_UNSUPPORTED_ITEMS_DROPPED?e.nlsKeyValueMap.SOME_UNSUPPORTED_ITEMS_DROPPED:_.SOME_UNSUPPORTED_ITEMS_DROPPED,h=e.nlsKeyValueMap&&e.nlsKeyValueMap.UNSUPPORTED_ITEMS_DROPPED?e.nlsKeyValueMap.UNSUPPORTED_ITEMS_DROPPED:_.UNSUPPORTED_ITEMS_DROPPED;o>0&&window.notifs&&u.call(window.notifs,{level:i.length>0?"warning":"error",title:_.ERROR_PROCESSING_DROPPED_ITEMS,message:i.length>0?p:h})}))},E.prototype._prepareDragData=function(e,t){for(var i=[],n=void 0!==t&&t.length>0?t:[],o=0;o<n.length;o++){var a=n[o],s=a?a.options.grid:{id:"",type:"",modelID:""},l={envId:widget.getValue("x3dPlatformId"),serviceId:s.sourceid,contextId:"",objectId:s.id,objectType:s["ds6w:what/ds6w:typeValue"]?s["ds6w:what/ds6w:typeValue"]:s.type?s.type:"",objectName:s.name,displayName:s.name,displayType:s["ds6w:what/ds6w:type"]?s["ds6w:what/ds6w:type"]:s.type?s.type:"",grid:a&&a.options&&a.options.grid?a.options.grid:{}};i.push(l)}var r={protocol:"3DXContent",version:"1.1",source:widget.data.appId,widgetId:widget.id,data:{fromId:this.viewId,items:i}};e&&e.dataTransfer&&(e.dataTransfer.setData("text",JSON.stringify(r)),e.dataTransfer.effectAllowed="all")},E.prototype._getViewOptions=function(t){var i=this;let n=[{text:_.TITLE,dataIndex:"title",visibleFlag:!0,sortableFlag:!0}];if(n.push(...i.getDefaultColDef()),this.isScoringModelSet&&this.scoringModelMapping&&Object.keys(this.scoringModelMapping).length>0){let e=JSON.parse(JSON.stringify(this.scoringModelMapping.columnDefinition.columns));e.forEach(function(e){e.setCellValue=i._setCellValueHandler.bind(i),e.getCellSemantics=i._getCellSemanticsHandler.bind(i)}),n.push(...e)}n.push({text:_.ACTIONS,dataIndex:"ContextualMenuColumn",hasCellValue:function(){return!0}}),i.withReordering&&n.push({text:_.ORDER,dataIndex:i.orderAttribute,visibleFlag:!1,sortableFlag:!0});let o={columns:n,typeRepresentations:this.typeRepresentations?this.typeRepresentations:{}},a={id:this.viewId,model:this._model,useDragAndDrop:!0,touchMode:!0,setDragData:this._prepareDragData.bind(this),modelEvents:i._localChannel,showItemCount:!1,showStatusBar:this.withStatusBar,viewOptions:{identifier:"backlogTile"+i.viewId,views:["DataGridView","LargeThumbnailView"],currentView:"LargeThumbnailView",currentSort:void 0,hideView:!0,showSwitchViewAction:!1,filter:!1,useGeneratedToolbar:!0,itemViewMapping:{label:function(e){return e.options.grid.title},subLabel:function(e){let t="";if(e&&e.options&&e.options.grid){let n=e.options.grid;t="swym:Idea"===n["ds6w:what/ds6w:typeValue"]?i.getSubLabel(n):n.subLabel+" | "+i.formatDateAttribute(n.created)}return t},thumbnail:function(e){return e.options.grid.preview_url?e.options.grid.preview_url:e.options.grid.thumbnail},icon:function(e){return e.options.grid.type_icon_url?e.options.grid.type_icon_url:e.options.grid.icon},description:function(e){return"swym:Idea"===e.options.grid["ds6w:what/ds6w:type"]?e.options.grid["ds6w:description"]:e.options.grid.description},customTooltip:function(e){let t="";if(e&&e.options&&e.options.grid){let n=e.options.grid;t=n.customTooltip+"\n"+_.CREATION_DATE+": "+i.formatDateAttribute(n.created)+"\n"+_.MODIFICATION_DATE+": "+i.formatDateAttribute(n.modified)}return t},revision:function(e){return e.options.grid.revision}},editable:!1,grid:o,showContextualMenuColumnFlag:!0,rowDragEnabledFlag:!0,rowReorderEnabledFlag:!0,cellDragEnabledFlag:!0,rowSelection:"multiple",contextualActions:["dummy1","dummy2"],onContextualEvent:function(t){return t&&t.cellInfos?new e.Promise(e=>{var n=[];i.withInformationPanel&&!i.compactView&&n.push({id:"Information",title:_.INFORMATION,text:_.INFORMATION,type:"PushItem",fonticon:{content:"wux-ui-3ds wux-ui-3ds-info",family:"DSFontIcon"},action:{context:t.cellInfos.nodeModel,callback:function(e){i.updateChannel.publish({event:"update-selected-nodes-and-toggle-info-panel",data:{toggleSide:"right",selectedNodes:[e.context],viewId:i.viewId}})}}}),i.isUserAllowedToModify&&n.push({id:"Remove",title:_.REMOVE,text:_.REMOVE,type:"PushItem",fonticon:{content:"wux-ui-3ds wux-ui-3ds-remove",family:"DSFontIcon"},action:{context:t.cellInfos.nodeModel,callback:function(e){i.updateChannel.publish({event:"roadmap-list-remove-selected",data:{fromId:i.viewId,items:[{options:{grid:e.context.options.grid}}]}})}}});var o=t.cellInfos.nodeModel.options.grid;if(o&&o.type){let t;o.resourceid?t=o.resourceid:o["@id"]?t=o["@id"]:o.identifier&&(t=o.identifier),m.getOpenWithMenuForObject({envId:widget.getValue("x3dPlatformId"),contextId:"",objectId:t,objectType:o.typeValue?o.typeValue:o.type?o.type:""}).then(t=>{t&&n.splice(0,0,t),e(n)},()=>{e(n)})}}):t&&t.cellInfos&&void 0!==t.cellInfos.nodeModel.options.contextualMenu?t.cellInfos.nodeModel.options.contextualMenu:void 0}},emptyContentOptions:i._createEmptyView({emptyViewButton:{}}),toolbarOptions:{itemsName:_.BACKLOGS_TITLE,itemName:_.BACKLOGS_TITLE,actions:[],hideView:!0,filter:!1,sort:!1,touchMode:!1},extensions:[l]};if(this.withCommunityPreference&&t.backlogsView){let t=[];t=[{id:"Ideas",text:_.IDEAS,selectable:!1,multiSelect:!0,isSelected:!1,items:[{fonticon:"",id:"Mature_Ideas",parentId:"Ideas",selectable:!0,selected:!0,text:"Mature Ideas"}],handler:function(){e.log("MaturityStateFilterHandler")}}],a.toolbarOptions.filterActions=[{id:"driver-fv-filter",text:_.FILTER_BY,fonticon:"list-filter",multiSelect:!0,selected:!0,isSelected:!0,actions:t}],a.toolbarOptions.showSwitchViewAction=!1,a.toolbarOptions.useGeneratedToolbar=!0,!i.communityList&&document.getElementsByClassName("wux-ui-3ds-list-filter")[0]&&(document.getElementsByClassName("wux-ui-3ds-list-filter")[0].style.display="none")}if(this.withStatusBar&&e.is(i.handlers.getStatusbarContent,"function")&&i.scoringModelDetails.isScoringModelSet||i.withCommunityPreference){let t=i.handlers.getStatusbarContent();a.viewOptions.itemViewMapping.statusBarIcon=function(i){if(e.is(t.statusBarIcon,"function"))return t.statusBarIcon(i)},a.viewOptions.itemViewMapping.statusbarIconsTooltips=function(i){if(e.is(t.statusbarIconsTooltips,"function"))return t.statusbarIconsTooltips(i)},a.viewOptions.itemViewMapping.statusbarLabelsWidthRatios=function(){if(e.is(t.statusbarLabelsWidthRatios,"function"))return t.statusbarLabelsWidthRatios()}}return a},E.prototype.getSubLabel=function(e){return this.buildSpanSubLabel(e)},E.prototype.buildSpanSubLabel=function(t){let i=this,n=[],o=e.createElement("span",{class:"enoxRoadmap-tile-thumbnail-subLabel"});if(t.type){let i=e.createElement("span",{class:"wux-controls-type",text:t.type});n.push(i)}if(n.push(e.createElement("span",{class:"wux-controls-separator",text:" | "})),i.withCommunityPreference&&t["ds6w:dataSource.3DSwym"]){let o=f.getURLForService("3DSwym");if(i.getSwymCommunityId(t["ds6w:dataSource.3DSwym"])||t["ds6w:containerUid"]){let a=t["ds6w:containerUid"]?t["ds6w:containerUid"]:i.getSwymCommunityId(t["ds6w:dataSource.3DSwym"]),s=e.createElement("a",{class:"wux-tweakers-string-label",text:t["ds6w:dataSource.3DSwym"],target:"_blank",href:o+"/v3/community/"+a});n.push(s)}else{let i=e.createElement("span",{class:"wux-controls-community",text:t["ds6w:dataSource.3DSwym"]});n.push(i)}}if(n.push(e.createElement("span",{class:"wux-controls-separator",text:" | "})),t.owner){let i=e.createElement("span",{class:"wux-controls-owner",text:e.is(t.owner,"object")?t.owner.fullName:t.owner});n.push(i)}if(n.push(e.createElement("span",{class:"wux-controls-separator",text:" | "})),t["ds6w:what/ds6w:status"]){let i=e.createElement("span",{class:"wux-controls-status",text:t["ds6w:what/ds6w:status"]});n.push(i)}if(n.push(e.createElement("span",{class:"wux-controls-separator",text:" | "})),t.created){let o=e.createElement("span",{class:"wux-controls-created",text:i.formatDateAttribute(t.created)});n.push(o)}return this.joinHTMLElements(n,o)},E.prototype.joinHTMLElements=function(e,t){t.appendChild(e[0]);for(let i=1;i<e.length;i++)t.appendChild(e[i]);return t},E.prototype._createEmptyView=function(){var t=this,i={sentences:[{type:"drop"}],fontSize:"16px",orderedListType:"none",modelEvents:this._localChannel},n={};if(!t.compactView&&(e.is(this.handlers.getEmptyViewButton,"function")&&(n=this.handlers.getEmptyViewButton()),n)){let o;o=n.nlsKey;let a=e.createElement("div");new u({id:"create-btn-primary",className:"primary",value:n.text,events:{onClick:()=>{if(t.isUserAllowedToModify)n.handler();else{let e=t.nlsKeyValueMap&&t.nlsKeyValueMap.OPERATION_CANNOT_BE_PERFORMED?t.nlsKeyValueMap.OPERATION_CANNOT_BE_PERFORMED:_.OPERATION_CANNOT_BE_PERFORMED;window.notifs.addNotif({level:"error",title:"",subtitle:e})}}}}).inject(a),a.getChildren().forEach(e=>{e.style.margin="5px"}),i={sentences:[{type:"drop"},{type:"dom",DOMelement:a}],fontSize:"16px",orderedListType:"none",modelEvents:this._localChannel}}return i},E.prototype._setCellValueHandler=function(t,i){var n=this;if(n.saveBtn.isDisabled()&&n.saveBtn.setDisabled(!1),e.is(t)&&e.is(t.columnID)&&e.is(t.nodeModel)){let o=t.nodeModel,a=o.getAttributeValue("proxyId");if(!e.is(a)&&n.withCommunityPreference&&this.isItBacklogsView){let e=o.options.grid||{};n.handlers.addBacklogItems({id:n.objectId,items:[{id:e.id,type:e["ds6w:what/ds6w:typeValue"],title:e.title,label:e.label,service:e.sourceid,sequence:e.sequence||1}]}).then(function(e){e&&e.bItems&&e.bItems.length>0&&(t.nodeModel.setAttribute("proxyId",e.bItems[0]["@id"]),n.calculateScoreHelper(t,i))},function(e){n.showNotification(e)})}else n.calculateScoreHelper(t,i)}},E.prototype.calculateScoreHelper=function(t,i){let n=this,o=n._listView.getDataIndexFromColumnIndex(t.columnID),a=t.nodeModel.getAttributeValue("proxyId"),s={};n.scoringModelAttributes&&n.scoringModelAttributes.length>0&&n.scoringModelAttributes.forEach(l=>{e.is(n.scoringValuesForBacklogItems[a])?n.scoringValuesForBacklogItems[a][l]=t.nodeModel.getAttributeValue(l):n.scoringValuesForBacklogItems[a]={[l]:t.nodeModel.getAttributeValue(l)};let r=l!==o?t.nodeModel.getAttributeValue(l):i;s&&Object.keys(s).length>0?s[l]=r:s={[l]:r}});let l={versionId:n.viewId,bItemScores:{bItem:a,scoringValues:s}};var r=this.scoringModelMapping.calculateScore(l);let d;r instanceof e.Promise?r.then(e=>{d=e[a],n.displayScore(t,d,s)}).catch(e=>{n.showNotification(e)}):(d=r,n.displayScore(t,d,s))},E.prototype.displayScore=function(t,i,n){let o=this;try{if(e.is(t)&&e.is(t.nodeModel)){let e=t.nodeModel,a=e.getAttributeValue("proxyId");e.prepareUpdate(),e.updateOptions({grid:i}),e.pushUpdate(),o.scoringValuesToSave&&Object.keys(o.scoringValuesToSave).length>0?o.scoringValuesToSave[a]=n:o.scoringValuesToSave={[a]:n}}}catch(t){e.log("Exception while updating display score")}},E.prototype.startLoader=function(e){if(!this.loaderIsOn){var t=e&&e.container?e.container:this.container;this._loader.on(e&&e.loadingMsg?e.loadingMsg:_.LOADING),this.loaderIsOn=!0,t&&t.style&&(t.style.position="relative"),i.createModal(t,this._loader.elements.container)}},E.prototype.stopLoader=function(e){if(this.loaderIsOn){this._loader.off(),this.loaderIsOn=!1;var t=e&&e.container?e.container:this.container;t&&t.style&&(t.style.position=""),i.removeModal(t)}},E.prototype.getOrderAttributeOfLastNode=function(){let e=this._model?this._model.getChildren():[];if(0===e.length)return 0;{let t=e.length>0?e[e.length-1]:void 0;return t&&t.options&&t.options.grid?t.options.grid[this.orderAttribute]:1}},E.prototype._setDataColor=function(e){this._localChannel.publish({event:"xmodel-list-set-column-visibility-action",data:{dataIndex:"color",visibility:!0}}),this._model.search({match:function(t){return!!e.hasOwnProperty(t.nodeModel.options.id)&&(t.nodeModel.prepareUpdate(),t.nodeModel.updateOptions({color:e[t.nodeModel.options.id]}),t.nodeModel.setAttribute("color",e[t.nodeModel.options.id]),t.nodeModel.pushUpdate(),!0)}})},E.prototype.getDefaultColDef=function(){var t=this;let i=[{text:_.NAME,dataIndex:"name",visibleFlag:!1},{text:_.TYPE,dataIndex:"type",visibleFlag:!1,sortableFlag:!0},{text:_.OWNER,dataIndex:"owner",visibleFlag:!1,sortableFlag:!0},{text:_.CREATION_DATE,dataIndex:"created",typeRepresentation:"datetime",visibleFlag:!1,sortableFlag:!0},{text:_.MODIFICATION_DATE,dataIndex:"modified",typeRepresentation:"datetime",visibleFlag:!1,sortableFlag:!0},{text:_.REQUIREMENT_CLASSIFICATION,dataIndex:"classification",visibleFlag:!1,sortableFlag:!1},{text:_.ENDORSEMENTS,dataIndex:v,visibleFlag:!1,sortableFlag:!0},{text:_.COMMENTS,dataIndex:I,visibleFlag:!1,sortableFlag:!0},{text:_.COMMUNITY,dataIndex:C,visibleFlag:!1,sortableFlag:!0,typeRepresentation:"url",getCellValue:function(e){if(e.nodeModel&&"swym:Idea"===e.nodeModel.options.grid["ds6w:what/ds6w:typeValue"]){let o=f.getURLForService("3DSwym");var i=e.nodeModel.getAttributeValue("icon"),n=e.nodeModel.getAttributeValue("ds6w:dataSource.3DSwym");return{icon:i,label:n,url:o+"/v3/community/"+(e.nodeModel.options.grid["ds6w:containerUid"]?e.nodeModel.options.grid["ds6w:containerUid"]:t.getSwymCommunityId(n))}}},setCellValue:function(e,t){if(e.nodeModel&&"swym:Idea"===e.nodeModel.options.grid["ds6w:what/ds6w:typeValue"]){var i={grid:{}};t.hasOwnProperty("icon")&&(i.grid.Icon=t.icon),t.hasOwnProperty("label")&&(i.grid.SiteName=t.label),t.hasOwnProperty("url")&&(i.grid.Link=t.url),e.nodeModel.updateOptions(i)}}}];return e.is(t.customAttrbColumns,"array")&&(i=i.concat(t.customAttrbColumns)),i},E.prototype.formatDateAttribute=function(t){let i="";try{if(!e.is(this._dateTimeFormat)){let e;widget&&widget.lang?e=widget.lang:navigator&&navigator.language&&(e=navigator.language),this._dateTimeFormat=Intl.DateTimeFormat(e,b)}if(e.is(t))if(e.is(t,"date"))i=this._dateTimeFormat.format(t);else{let e=new Date(t);i=this._dateTimeFormat.format(e)}}catch(i){e.log("Unable to format input date: "+t)}return i},E.prototype._unsetDataColor=function(){this._localChannel.publish({event:"xmodel-list-set-column-visibility-action",data:{dataIndex:"color",visibility:!1}}),this._model.prepareUpdate(),this._model.search({match:function(e){return!!e.nodeModel.options.id&&(e.nodeModel.updateOptions({color:""}),e.nodeModel.setAttribute("color","#00FFFFFF"),!0)}}),this._model.pushUpdate()},E.prototype._getCellSemanticsHandler=function(t){if(this.isCurrentViewExpanded&&e.is(t)&&e.is(t.columnID)&&e.is(t.cellView)){let i=this._listView.getDataIndexFromColumnIndex(t.columnID),n=t.cellView.collectionView.columns.find(e=>{if(e.dataIndex===i)return e});return e.is(n.min)&&e.is(n.max)?{minValue:n.min?n.min:0,maxValue:n.max?n.max:Number.MAX_SAFE_INTEGER,stepValue:n.step?n.step:.1}:t}},E.prototype.getSwymCommunityId=function(e){let t;return this.communityList&&this.communityList.length>0&&this.communityList.forEach(i=>{i.label===e&&(t=i.id)}),t},E.prototype.destroy=function(){var e=this;this._eventTokens.forEach(t=>{e.updateChannel.unsubscribe(t)}),this._listViewChannelTokens.forEach(t=>{e._localChannel.unsubscribe(t)}),this._treeModelTokens.forEach(t=>{e._model.unsubscribe(t)}),this._taggerChannelTokens.forEach(t=>{e.taggerChannel.unsubscribe(t)}),this._eventTokens=this._taggerChannelTokens=this._listViewChannelTokens=this._treeModelTokens=[],this.deactivateTags()},E}),define("DS/ENOXRoadmapPresenter/ENOXRoadmapPresenter",["UWA/Core","UWA/Utils/InterCom","UWA/Class/Model","DS/Utilities/StringUtils","DS/E6WCommonUI/Views/DetailsDisplayView","DS/E6WCommonUI/Views/ObjectCardView","DS/Notifications/NotificationsManagerUXMessages","DS/Notifications/NotificationsManagerViewOnScreen","DS/CoreEvents/ModelEvents","DS/Controls/Accordeon","DS/Windows/ImmersiveFrame","DS/Windows/Dialog","DS/Controls/Button","DS/WUXAutoComplete/AutoComplete","DS/ENOXSplitViewVertical/js/ENOXSplitViewVertical","DS/ENOXCollectionToolBar/js/ENOXCollectionToolBarV2","DS/ENOXDataDragAndDrop/js/ENOXDataDragAndDrop","DS/ENOXRoadmapPresenter/TriptychWrapper","DS/ENOXRoadmapPresenter/ENOXRoadmapSearchController","DS/ENOXRoadmapPresenter/ENOXRoadmapListView","DS/ENOXRoadmapPresenter/SearchIndexService","DS/ENOXRoadmapPresenter/ENOXRoadmapTaggerManager","DS/ENOXRoadmapPresenter/ENOXRoadmapWidgetStorage","DS/ENOXRoadmapPresenter/ENOXRoadmapUtil","DS/UIKIT/SuperModal","DS/Controls/ComboBox","DS/UIKIT/Mask","DS/ENOXPflKanbanView/Kanban","DS/PlatformAPI/PlatformAPI","DS/xPortfolioQueryServices/js/infra/xPortfolioInfra","css!DS/ENOXRoadmapPresenter/assets/css/ENOXRoadmapPresenter.css","i18n!DS/ENOXRoadmapPresenter/assets/nls/ENOXRoadmapPresenter"],function(e,t,i,n,o,a,s,l,r,d,c,u,p,h,m,g,f,w,_,b,v,I,C,E,y,S,T,N,O,M,x,V){"use strict";var A=void 0,P=e.Class.extend({init:function(){this.compassSocketInstance=null,this.socketId="baseAppLauncher_rdmp_"+(new Date).getTime()},getSocketInstance:function(){return this._prepareCommSocketInstance(),this.compassSocketInstance.subscribeServer("com.ds.compass",window.parent),this.compassSocketInstance},_prepareCommSocketInstance:function(){var i=this;this.compassSocketInstance=new t.Socket(this.socketId),this.compassSocketInstance.addListener("launchApp",function(){e.log("Application Launch Successful!!!"),i.compassSocketInstance.unsubscribeServer("com.ds.compass"),i.compassSocketInstance.disconnect()})},getSocketId:function(){return this.socketId}}),D=function(){};return D.prototype.init=function(t){e.is(window.notifs)||(window.notifs=s,l.setNotificationManager(window.notifs));var i=this;if(this.options=t,this.withStatusBar=!!t.withStatusBar&&t.withStatusBar,this.objectId=t.id?t.id:void 0,this.objectTitle=e.is(t.title)?t.title:"",this.objectRevision=e.is(t.revision)?t.revision:"",this.objectType=e.is(t.type)?t.type:"",this.objectTypeNLS=e.is(t.typeNLS)?t.typeNLS:"",this.objectMaturityState=e.is(t.objectMaturityState)?t.objectMaturityState:"",this.objectMaturityStateNLS=e.is(t.objectMaturityStateNLS)?t.objectMaturityStateNLS:"",this.objectResponsibilities=e.is(t.objectResponsibilities)?t.objectResponsibilities:"",this.objectTypeImage=e.is(t.objectTypeImage)?t.objectTypeImage:"",this.parentId=t.parentId,this.allowedTypes=e.is(t.allowedTypes)?t.allowedTypes:[],this.reqSubTypesOptions=e.is(t.reqSubTypesOptions)?t.reqSubTypesOptions:[],this.supportedTypes=t.supportedTypes?t.supportedTypes:[t.type],this.maxColumnsCount=t.maxColumnsCount?t.maxColumnsCount:5,this.handlers=e.is(t.handlers,"object")?t.handlers:{},this.withProxyManagement=!!e.is(t.withProxyManagement,"boolean")&&t.withProxyManagement,this.compactView=!!e.is(t.compactView,"boolean")&&t.compactView,this.withReordering=!!e.is(t.withReordering)&&t.withReordering,this.withRMBOnEmptyArea=!!e.is(t.withRMBOnEmptyArea)&&t.withRMBOnEmptyArea,this.withSingleTaggerManagement=!!e.is(t.withSingleTaggerManagement)&&t.withSingleTaggerManagement,this.withInformationPanel=!!e.is(t.withInformationPanel,"boolean")&&t.withInformationPanel,this.withContentTab=!!e.is(t.withContentTab,"boolean")&&t.withContentTab,this.roadmapSettings=e.is(t.roadmapSettings,"object")?t.roadmapSettings:{},this.withSort=!e.is(t.withSort)||t.withSort,this.orderAttribute=this.withReordering&&e.is(t.orderingAttribute)?t.orderingAttribute:void 0,this.actionContainer=t.actionContainer,this.withLaneExpander=!!t.withLaneExpander&&t.withLaneExpander,this.launchFullViewAsWidget=!!e.is(t.launchFullViewAsWidget)&&t.launchFullViewAsWidget,this.withUniqueBacklog=!!t.withUniqueBacklog&&t.withUniqueBacklog,this.withClassificationColumnVisible=!!t.withClassificationColumnVisible&&t.withClassificationColumnVisible,this.predicates=e.is(t.predicates)?t.predicates:[],this.customAttrbColumns=e.is(t.customAttrbColumns)?t.customAttrbColumns:[],this.serviceId=t.serviceId?t.serviceId:"",this.withFullViewAction=!!t.withFullViewAction&&t.withFullViewAction,this.withFullViewWidgetTitle=!!t.withFullViewWidgetTitle&&t.withFullViewWidgetTitle,this.withFullViewColumnSubHeader=!!t.withFullViewColumnSubHeader&&t.withFullViewColumnSubHeader,this.withChangeContextSupport=!!e.is(t.withChangeContextSupport)&&t.withChangeContextSupport,this.withCommunityPreference=!!e.is(t.withCommunityPreference)&&t.withCommunityPreference,this.scoringModelDefaultValuesMap={},this.maxCommunityAllowed=t.maxCommunityAllowed?t.maxCommunityAllowed:void 0,this.nls_override=e.is(t.nls_override)?t.nls_override:void 0,this.nls_override&&Object.keys(this.nls_override).length>0){Object.keys(this.nls_override).forEach(t=>{t&&e.is(this.nls_override[t],"string")&&(V[t]=this.nls_override[t])})}this.typeIconListCache={},this._channelTokensMap=new Map,this._objectIdListContainerMap=new Map,this.getNLSKeyValueMap(t.keysFromApplications),this._expanderIssueDontProcessExpandEvent=!1,this._container=e.createElement("div",{id:"xpflRoadmapContainer",class:"xpfl-roadmap-container"}),e.is(t.containerForCompactView)&&(this.parentForCompactView=t.containerForCompactView,this.parentForCompactView.addClassName("backlogTab")),e.is(t.containerForFullView)&&(this.parentForFullView=t.containerForFullView),this._withNavigatioButtons=!!e.is(t.withNavigatioButtons,"boolean")&&t.withNavigatioButtons,this.inOutChannel=t.modelEvents,this._backlogEvents=new r,this._contentItemsChannel=new r,this._roadmapChannel=new r,this._channelTokensMap.set(this.inOutChannel,[]),this._channelTokensMap.set(this._backlogEvents,[]),this._channelTokensMap.set(this._contentItemsChannel,[]),this._channelTokensMap.set(this._roadmapChannel,[]),this.withCommunityPreference&&(this.minLengthBeforeSearch=e.is(t.minLengthBeforeSearch)?t.minLengthBeforeSearch:3,this._communityChannel=new r,this._channelTokensMap.set(this._communityChannel,[]),this.selectedCommunities=this.getSelectedCommunities(),this.updateCommunityPreferenceListInfo()),this.searchIndexService=new v,this.EVENT_LIST_VIEW_LAUNCH_SEARCH="roadmap-list-launch-search",this.EVENT_ADD_SELECTIONS_FROM_SEARCH="roadmap-list-add-selected-items-from-search",this.EVENT_REMOVE_BACKLOG="roadmap-list-remove-selected",this.EVENT_LOAD_BACKLOG="itemlist-load-backlog",this.EVENT_UPDATE_CURR_SCORING_MODEL_INFO="update-current-scoring-model-info",this.EVENT_UPDATE_SELECTED_NODES_AND_INFO_PANEL="update-selected-nodes-and-info-panel",this.EVENT_ENABLE_TOOLBAR_ACTION="enox-collection-toolbar-enable-action",this.EVENT_DISABLE_TOOLBAR_ACTION="enox-collection-toolbar-disable-action",this.EVENT_SELECTED_NODES_AND_TOGGLE_INFO_PANEL="update-selected-nodes-and-toggle-info-panel",this.EVENT_UPDATE_MODEL_WITH_LATEST_SCORING_VALUES="update-model-with-latest-scoring-values",this.EVENT_GET_LATEST_INFO_PANEL_STATUS="update-info-panel-status",this.EVENT_UPDATE_KANBAN_COLUMNS_VISIBILITY="update-kanban-columns-visibility",this.EVENT_TRIPTYCH_TOGGLE_PANEL="triptych-toggle-panel",this.EVENT_CLOSE_BACKLOG_PANE="close-backlog-pane",this._taggerProxyId="pflRoadmap_"+Date.parse(new Date),this.listViewsMap={},this.columnList=[],this.availableScoringModelDetails=[],this.communityId_mature_map=[],this.typeRepresentations={},this.isScoringModelSet=!1,this.isBacklogPaneOpen=!0,this._nbBacklogItems=0,this._nbCommitedItems=0,C.JSONRoadMapGlobalStorage||C.initialize(),this.withInformationPanel&&!this.compactView&&require(["DS/ENOXRoadmapPresenter/ENOXRoadmapInformationPanel"],function(e){i.roadmapInfoPanel=new e;let t={roadmapChannel:i._roadmapChannel,withContentTab:i.withContentTab,allowedTypes:i.allowedTypes};i.roadmapSettings&&i.roadmapSettings.withScoringModel&&(t.handlers={getCustomContainerForScoring:i.handlers.getCustomContainerForScoring?i.handlers.getCustomContainerForScoring:{},getScoringValues:i.handlers.getScoringValues?i.handlers.getScoringValues:{},setScoringValues:i.handlers.setScoringValues?i.handlers.setScoringValues:{},getTypeRepresentationMapping:i.handlers.getTypeRepresentationMapping?i.handlers.getTypeRepresentationMapping:{},getContentTabHandlers:i.handlers.getContentTabHandlers?i.handlers.getContentTabHandlers:{}}),i.roadmapInfoPanel.init(t)}),this._initVerticalSplitView(),this.backlogids=[],this._subscribeToEvents(),this._initializeTaggerComponent(),this.compactView?(this._taggerMgr.deactivateTagger(),this.roadmapSettings&&this.roadmapSettings.withScoringModel?(i.availableScoringModels=[{value:"None",label:V.NONE}],this.handlers.getAvailableScoringModels().then(e=>{i.availableScoringModels.push(...e.availableScoringModels),i.availableScoringModelDetails=e.availableScoringModelDetails,i.typeRepresentations=e.typeRepresentation,i.getSelectedScoringModel(t,i.compactView),i.showNotification(e)}).catch(e=>{i.updateScoringModelDetails(),this._initializeCompactView(t),i.showNotification(e)})):this._initializeCompactView(t)):(this.roadmapSettings&&this.roadmapSettings.withScoringModel?(i.availableScoringModels=[{value:"None",label:V.NONE}],this.handlers.getAvailableScoringModels().then(e=>{i.availableScoringModels.push(...e.availableScoringModels),i.availableScoringModelDetails=e.availableScoringModelDetails,i.typeRepresentations=e.typeRepresentation,i.getSelectedScoringModel(t),i.showNotification(e)}).catch(e=>{i.updateScoringModelDetails(),i._initializeCompleteView(t),i.showNotification(e)})):i._initializeCompleteView(t),i.withChangeContextSupport&&i.subscribeDNDEvents())},D.prototype.toggleBacklogPane=function(){this._roadmapChannel.publish({event:this.EVENT_TRIPTYCH_TOGGLE_PANEL,data:"left"}),this.isBacklogPaneOpen=!this.isBacklogPaneOpen;let t=this.isBacklogPaneOpen?"maximize":"minimize",i=e.is(document.getElementsByClassName("wux-ui-3ds-eye"))?document.getElementsByClassName("wux-ui-3ds-eye"):[];i=i.length>0?i[0]:void 0,"minimize"===t?(this.isBcklgPaneExpanded=!1,i&&i.setStyle("color","#77797c"),this._backlogEvents.publish({event:this.EVENT_UPDATE_KANBAN_COLUMNS_VISIBILITY,data:{action:t}}),this._backlogEvents.publish({event:"xmodel-list-view-switch-view",data:"LargeThumbnailView"}),C.updateRoadmapWidgetStorage("full","backlogPanelOpen",!1),this._actionsToolbar._modelEvents.publish({event:"enox-collection-toolbar-change-text-tooltip-action",data:{id:"toggle-bcklg-item",text:V.SHOW_BACKLOG_PANE}})):(C.updateRoadmapWidgetStorage("full","backlogPanelOpen",!0),i&&i.setStyle("color","#368ec4"),this._actionsToolbar._modelEvents.publish({event:"enox-collection-toolbar-change-text-tooltip-action",data:{id:"toggle-bcklg-item",text:V.HIDE_BACKLOG_PANE}}))},D.prototype.backlogColumnPreferences=function(){let e=C.JSONRoadMapGlobalStorage.roadMapFullView.backlogPanelOpen,t=e?"maximize":"minimize";C.JSONRoadMapGlobalStorage&&!e&&(this.isBcklgPaneExpanded=!1,this.isBacklogPaneOpen=!1,this._roadmapChannel.publish({event:this.EVENT_TRIPTYCH_TOGGLE_PANEL,data:"left"}),this._backlogEvents.publish({event:this.EVENT_UPDATE_KANBAN_COLUMNS_VISIBILITY,data:{action:t}}),this._backlogEvents.publish({event:"xmodel-list-view-switch-view",data:"LargeThumbnailView"})),"minimize"===t?this._actionsToolbar._modelEvents.publish({event:"enox-collection-toolbar-change-text-tooltip-action",data:{id:"toggle-bcklg-item",text:V.SHOW_BACKLOG_PANE}}):this._actionsToolbar._modelEvents.publish({event:"enox-collection-toolbar-change-text-tooltip-action",data:{id:"toggle-bcklg-item",text:V.HIDE_BACKLOG_PANE}})},D.prototype.sortPreferences=function(e){if(C.JSONRoadMapGlobalStorage&&e&&("compact"===e||"full"===e)){let t="compact"===e?C.JSONRoadMapGlobalStorage.roadMapCompactView.sort:C.JSONRoadMapGlobalStorage.roadMapFullView.sort,i="compact"===e?this._actionsToolbarCompact:this._actionsToolbar,n=V.SORT_BY;if(""!==t.sortAttribute){let e=i._options.sort.filter(function(e){if(e.id===t.sortAttribute)return n=n+" "+e.text,!0});e[0]?(this._roadmapChannel.publish({event:"enox-collection-toolbar-sort-activated",data:{sortAttribute:e[0].id,sortOrder:t.sortOrder}}),this._roadmapChannel.publish({event:"enox-collection-toolbar-change-text-tooltip-action",data:{id:"iconSortActionBar",text:n}}),this._roadmapChannel.publish({event:"enox-collection-toolbar-update-sort-selection",data:{id:e[0].id,order:t.sortOrder}})):this._roadmapChannel.publish({event:"enox-collection-toolbar-sort-reset"})}}},D.prototype.getNextRank=function(e){return e?e===this.objectId?this._nbCommitedItems+1:e===this.parentId?this._nbBacklogItems+1:void 0:(e=this._getActiveViewId())?this.listViewsMap[e].getContentLength()+1:this._nbBacklogItems+1},D.prototype.getListView=function(e){return e?this._objectIdListContainerMap.get(e):(e=this._getActiveViewId())?this._objectIdListContainerMap.get(e):void 0},D.prototype.accordeonPreferences=function(){if(C.JSONRoadMapGlobalStorage){let e=C.JSONRoadMapGlobalStorage.roadMapCompactView.commitedAccordeonState,t=C.JSONRoadMapGlobalStorage.roadMapCompactView.backlogAccordeonState;"expand"===e&&"collapse"===t?(this.roadmapAccordeon.expandItem(0),this.roadmapAccordeon.getExpanderFromIndex(0).getContent().removeClassName("normalExpander"),this.roadmapAccordeon.getExpanderFromIndex(0).getContent().addClassName("expandedExpander"),this.roadmapAccordeon.getExpanderFromIndex(1).getContent().addClassName("collapsedExpander")):"collapse"===e&&"expand"===t?(this.roadmapAccordeon.getExpanderFromIndex(0).getContent().addClassName("collapsedExpander"),this.roadmapAccordeon.expandItem(1),this.roadmapAccordeon.getExpanderFromIndex(1).getContent().removeClassName("normalExpander"),this.roadmapAccordeon.getExpanderFromIndex(1).getContent().addClassName("expandedExpander")):"collapse"===e&&"collapse"===t?(this.roadmapAccordeon.getExpanderFromIndex(0).getContent().addClassName("collapsedExpander"),this.roadmapAccordeon.getExpanderFromIndex(1).getContent().addClassName("collapsedExpander")):(this.roadmapAccordeon.expandItem(0),this.roadmapAccordeon.getExpanderFromIndex(0).getContent().addClassName("normalExpander"),this.roadmapAccordeon.expandItem(1),this.roadmapAccordeon.getExpanderFromIndex(1).getContent().addClassName("normalExpander"))}},D.prototype.getSelectedScoringModel=function(t,i){var n=this;n.handlers.getScoringModel().then(o=>{if(n.selectedScoringModelId=o.selectedScoringModelId,n.selectedScoringModelId){if(n.selectedScoringModelIndex=n.getSelectedScoringModelIndex(n.selectedScoringModelId),n.isScoringModelSet=!0,e.is(n.handlers.getDefaultScoringValuesForCurrentScoringModel,"function")){let e=n.handlers.getDefaultScoringValuesForCurrentScoringModel();n.scoringModelDefaultValuesMap[n.selectedScoringModelId]=e}}else n.updateScoringModelDetails();n.availableScoringModels[n.selectedScoringModelIndex]&&(n.previousScoringModel=n.availableScoringModels[n.selectedScoringModelIndex].value),n.showNotification(o),i?this._initializeCompactView(t):n._initializeCompleteView(t)}).catch(e=>{n.updateScoringModelDetails(),n._initializeCompleteView(t),n.showNotification(e)})},D.prototype.updateScoringModelDetails=function(){this.selectedScoringModelIndex=0,this.isScoringModelSet=!1,this.selectedScoringModelId="None"},D.prototype._initializeCompleteView=function(){let e=this._container.parentElement;e&&e.removeChild(this._container),this._container.inject(this.parentForFullView),this._initActionsToolbar(),this._prepareDebouncedKanbanResizeHandler(),this._initRoadmapContentContainer(),this._initializeBacklogsView({container:this._roadmapTriptych.getLeftPanelContainer(),showHeader:!0,compactView:!1}),this._taggerMgr.activateTagger({deactivateOthers:!0})},D.prototype._checkContextFilterInjected=function(){let e=document.querySelector(".rdmp_unit_context");if(!e)return!1;if(document.querySelector(".ds-dialog.ds-detail-display.ddv-view"))return!0;let t=e.closest(".wux-button-icon-placeholder");return t?(t.classList.remove("wux-button-icon-placeholder"),t.removeChild(t.firstChild),t.classList.add("wux-tweakers"),t.classList.add("wux-tweakers-string"),t.classList.add("rdmp_unit_context")):e.removeChild(e.firstChild),!1},D.prototype._initializeCompactView=function(){let t=this;try{let o=this._container.parentElement;o&&o.removeChild(this._container),this._container.inject(this.parentForCompactView);var i=new e.Element("div",{class:"committedBacklogItems"}),n=new e.Element("div",{class:"pendingBacklogItems"});this.roadmapAccordeon=new d({items:[{header:V.BACKLOG,content:n},{header:V.COMMITTED,content:i}],exclusive:!1}).inject(this._contentContainer),this.accordeonPreferences(),this.roadmapAccordeon.getContent().addEventListener("expand",function(e){if(e&&!1===t._expanderIssueDontProcessExpandEvent){let t=e.dsModel,i=e.options.expanderIndex,n=0===i?1:0,o=t.getExpanderFromIndex(i),a=t.getExpanderFromIndex(n);a.expandedFlag?(a.getContent().removeClassName("expandedExpander"),a.getContent().addClassName("normalExpander"),o.getContent().addClassName("normalExpander")):(o.getContent().removeClassName("collapsedExpander"),o.getContent().addClassName("expandedExpander")),0===i?C.updateRoadmapWidgetStorage("compact","commitedAccordeonState","expand"):C.updateRoadmapWidgetStorage("compact","backlogAccordeonState","expand")}}),this.roadmapAccordeon.getContent().addEventListener("collapse",function(e){if(e){let t=e.dsModel,i=e.options.expanderIndex,n=0===i?1:0,o=t.getExpanderFromIndex(i),a=t.getExpanderFromIndex(n);o.getContent().removeClassName("normalExpander"),o.getContent().removeClassName("expandedExpander"),o.getContent().addClassName("collapsedExpander"),a.expandedFlag&&(a.getContent().removeClassName("normalExpander"),a.getContent().addClassName("expandedExpander")),0===i?C.updateRoadmapWidgetStorage("compact","commitedAccordeonState","collapse"):C.updateRoadmapWidgetStorage("compact","backlogAccordeonState","collapse")}}),this._initActionsToolbarForCompactView(),this._taggerMgr.updateCountOfViewsToManage(2),this._initializeBacklogsView({container:n,withHeader:!0,showHeader:!1,compactView:!0}),this._prepareListViewForRevisionColumn({item:{id:this.objectId,displayName:this.objectTitle,revision:this.objectRevision},withHeader:!0,showHeader:!1,withCreateAction:!1,container:i,compactView:!0,withCommunityPreference:!!t.withCommunityPreference&&t.withCommunityPreference})}catch(t){e.log((t.message,t.message))}finally{t.inOutChannel.publish({event:"roadmap-container-rendered",data:{isCompactView:t.compactView}})}},D.prototype._initializeTaggerComponent=function(){this.withSingleTaggerManagement&&(this._taggerMgr=new I,this._taggerMgr.initialize({taggerId:this._taggerProxyId,modelEvents:this._contentItemsChannel,queryParam:"[ds6w:resourceUid]"}))},D.prototype._initializeBacklogsView=function(t){if(e.is(t)&&e.is(t.container))if(this._objectIdListContainerMap.has(this.parentId)){let e=this._objectIdListContainerMap.get(this.parentId);e&&t.container&&e.inject(t.container),this.listViewsMap[this.parentId].setHeaderTextVisibility({visible:!!t.showHeader&&t.showHeader})}else{let i=this._getContainerForListView({id:"slide_"+this.parentId,cssClass:"backlogListContainer"});t.container&&i.inject(t.container),this._initializeListView({viewId:this.parentId,objectId:this.objectId,modelEvent:this._backlogEvents,container:i,withHeader:!t||!e.is(t.withHeader,"boolean")||t.withHeader,listHeader:V.BACKLOG_ITEMS,withCreateAction:!this.compactView,withCommunityPreference:this.withCommunityPreference,backlogsView:!0}),this._objectIdListContainerMap.set(this.parentId,i),this.withCommunityPreference||this._getAndLoadBacklogs({viewId:this.parentId}),this.listViewsMap[this.parentId].setHeaderTextVisibility({visible:!!t.showHeader&&t.showHeader})}else e.log("Error! No container provided for Backlog View, returning!")},D.prototype._initVerticalSplitView=function(){if(this.actionContainer)this._contentContainer=this._container,this._topActionsContainer=this.actionContainer;else{var t={withtransition:!1,withoverflowhidden:!0,sizeType:"px",originalTop:65};t.modelEvents=this._roadmapChannel,this._ENOXSplitViewVertical=new m,this._ENOXSplitViewVertical.init(t),this._container.appendChild(this._ENOXSplitViewVertical.getContent()),this._topActionsContainer=e.extendElement(this._ENOXSplitViewVertical.getContent().querySelector(".top-container")),this._contentContainer=this._ENOXSplitViewVertical.getContent().querySelector(".bot-container")}},D.prototype._initRoadmapContentContainer=function(){e.is(this._roadmapTriptych)||(this._contentContainer.innerHTML="",this._roadmapTriptych=new w,this._roadmapTriptych.init(this._roadmapChannel,this._contentContainer,{left:{size:360},right:{size:360}}),this.backlogColumnPreferences())},D.prototype._initializeListView=function(t){let i,n=new b;i=this.getScoringModelMapping(this.selectedScoringModelId);let o={customAttrbColumns:this.customAttrbColumns,allowedTypes:this.allowedTypes,withReordering:this.withReordering,orderAttribute:this.orderAttribute,withProxyManagement:this.withProxyManagement,withTaggerManagement:!0,taggerChannel:this._contentItemsChannel,isUserAllowedToModify:!e.is(this.handlers.isLaneModifiable,"function")||this.handlers.isLaneModifiable(t.viewId),compactView:this.compactView,withLaneExpander:this.withLaneExpander,withStatusBar:this.withStatusBar,withRMBOnEmptyArea:this.withRMBOnEmptyArea,withClassificationColumnVisible:this.withClassificationColumnVisible,withCommunityPreference:this.withCommunityPreference,predicates:this.predicates,scoringModelDetails:{isScoringModelSet:this.isScoringModelSet,selectedScoringModelId:this.selectedScoringModelId,scoringModelMapping:i||{},typeRepresentations:this.typeRepresentations},handlers:{addBacklogItems:this.handlers.addBacklogItems,getScoringValues:this.handlers.getScoringValues,setScoringValues:this.handlers.setScoringValues,isLaneModifiable:this.handlers.isLaneModifiable,getStatusbarContent:this.handlers.getStatusbarContent,getCreateActionMenu:this.handlers.getCreateActionMenu,getEmptyViewButton:this.handlers.getEmptyViewButton,getTypesToShowContentTab:this.handlers.getContentTabHandlers().getTypesToShowContentTab},withFullViewColumnSubHeader:this.withFullViewColumnSubHeader,withFullViewWidgetTitle:this.withFullViewWidgetTitle,nlsKeyValueMap:this.nlsKeyValueMap};t.withInformationPanel=this.withInformationPanel,this.withInformationPanel&&(t.roadmapInfoPanel=this.roadmapInfoPanel),this.withCommunityPreference&&(o.handlers.getSwymCommunitiesFromService=this.handlers.getSwymCommunitiesFromService,o.handlers.getCommunitiesFromPortfolio=this.handlers.getCommunitiesFromPortfolio),e.merge(o,t),n.init(o),this.listViewsMap[o.viewId]=n},D.prototype._prepareDebouncedKanbanResizeHandler=function(){var e,t,i,n,o=this;o._kanbanResizeCaller||(o._kanbanResizeCaller=(e=function(){o.kanbanView&&o.kanbanView.resize()},t=80,function(){var o=this,a=arguments,s=i&&!n;clearTimeout(n),n=setTimeout(function(){n=null,i||e.apply(o,a)},t),s&&e.apply(o,a)}))},D.prototype.getActiveViewId=function(){return this._getActiveViewId()},D.prototype._getActiveViewId=function(){let t;for(const[e,i]of this._objectIdListContainerMap)if(e&&i&&i.hasClassName("containerSelected")){t=e;break}if(!e.is(t))for(let[e,i]of Object.entries(this.listViewsMap))if(i.isCurrentViewExpanded){i.container.addClassName("containerSelected"),t=e;break}return t},D.prototype._initActionsToolbar=function(){var t=this;e.is(this._actionsToolbar)&&(T.mask(this._topActionsContainer,V.UPDATING_TOOLBAR),this._topActionsContainer.getChildren()[0].remove(),e.is(this._actionsToolbar.destroy,"function")&&this._actionsToolbar.destroy(),this._actionsToolbar=void 0);var i=[];if(e.is(t.handlers.updateToolbarOptions,"function")){var n={viewId:t.compactView?0:1};let a=[],s=[],l=[];var o=t.handlers.updateToolbarOptions(n);if(o.actions&&o.actions.length>0&&o.actions.forEach(function(e){"new"===e.category?a.push(e):"destructive"===e.category?s.push(e):l.push(e)}),a.length>0?i=i.concat(a):l.length>0&&(i=i.concat(l)),t.withChangeContextSupport&&e.is(t.handlers.onChangeContext,"function")&&i.push({icon:{className:"rdmp_unit_context"},fonticon:"search",id:"rdmp_unit_context",typeRepresentation:"functionIcon",value:"",allowResetToUndefinedByUIFlag:!0,placeholder:V.SEARCH+" "+t.options.typeNLS}),o.withSelectRevisionAction){let n=V.SELECT_REVISIONS,o="wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-flow-branch-list";if(e.is(t.handlers.filterColumnTextAndIcon,"function")){let e=t.handlers.filterColumnTextAndIcon();n=e.text?e.text:n,o=e.icon?e.icon:o}i.push({id:"filter-columns",category:"lifecycle",text:n,fonticon:o,disabled:!1,handler:function(){let e=[];t._objectIdListContainerMap.forEach((t,i)=>{i&&e.push(i)}),t.inOutChannel.publish({event:"roadmap-launch-revision-explorer",data:{loadedIdList:e}})}})}o.withBacklogPaneToggleAction&&i.push({id:"toggle-bcklg-item",text:V.HIDE_BACKLOG_PANE,fonticon:"eye",category:"settings",disabled:!1,handler:function(){t.toggleBacklogPane()}}),t.withInformationPanel&&i.push({id:"item-information",text:V.INFORMATION,fonticon:"info",disabled:!1,category:"settings",handler:function(){t._roadmapChannel.publish({event:"toggle-info-panel",data:{toggleSide:"right",selectedTab:"propertiesTab",isScoringModelSet:t.isScoringModelSet,selectedScoringModelId:t.selectedScoringModelId,scoringModelMapping:t.getScoringModelMapping(t.selectedScoringModelId)}})}}),t.withFullViewAction&&i.push({id:"launch-full-mode",text:V.OPEN_AS_POPUP,fonticon:"open-in-a-new-window",disabled:!1,category:"destructive",handler:function(){if(t.launchFullViewAsWidget){let e=new P;t.launchParentAppWithRoadmapAsFullView(e)}else t.compactView=!1,t.inOutChannel.publish({event:"roadmap-switching-to-full-view"}),t.switchViewMode("FULL_VIEW"),t.inOutChannel.publish({event:"roadmap-requesting-to-load-revisions"})}}),s.length>0&&(i=i.concat(s)),Object.keys(this.roadmapSettings).length>0&&i.push({id:"roadmap-settings",text:V.MANAGE_ROADMAP_SETTINGS,fonticon:"cog",disabled:!1,category:"destructive",handler:function(){t.openRoadmapSettings()}})}if(!e.is(this._actionsToolbar)){let e={modelEvents:this._roadmapChannel,showItemCount:!1,withmultisel:!1,withClearSort:!0,itemsName:"",itemName:"",filter:{width:350},actions:i,useGeneratedToolbar:!0,touchMode:!0};this.withSort&&(e.sort=this.handlers.getSortModelInfo(this.selectedScoringModelId),this.withCommunityPreference&&(e.sort.push({id:"ds6w:what/ds6w:social/ds6w:endorsements",text:V.ENDORSEMENTS,type:"integer"}),e.sort.push({id:"ds6w:what/ds6w:social/ds6w:comments",text:V.COMMENTS,type:"integer"}),e.sort.push({id:"ds6w:dataSource.3DSwym",text:V.COMMUNITY,type:"string"}))),this._actionsToolbar=new g(e)}this._topActionsContainer.innerHTML="",this._withNavigatioButtons&&this._initNavigationButtons(),this._actionsToolbar.inject(this._topActionsContainer),t.withChangeContextSupport&&t.loadDisplay(),T.isMasked(this._topActionsContainer)&&T.unmask(this._topActionsContainer)},D.prototype.loadDisplay=function(){var t=this;t.backlogContext=new i({canEdit:!0,context:[]});let n="";t.backlogContext.add=function(o,a,s){let l={};l.detailedObject=s.detailedObjects?s.detailedObjects[0]:s.dropObj,s.dropObj&&(l.detailedObject["ds6w:label"]=l.detailedObject.displayName,l.detailedObject["ds6w:type"]=l.detailedObject.objectType),n=l.detailedObject["ds6w:label"]&&l.detailedObject["ds6wg:revision"]?l.detailedObject["ds6w:label"]+" "+l.detailedObject["ds6wg:revision"]:l.detailedObject["ds6w:label"]&&l.detailedObject.revision?l.detailedObject["ds6w:label"]+" "+l.detailedObject.revision:l.detailedObject.label;var r=new i({id:l.detailedObject.id?l.detailedObject.id:l.detailedObject.objectId,physicalId:l.detailedObject.id?l.detailedObject.id:l.detailedObject.objectId,type:l.detailedObject["ds6w:type"],name:n,image:l.detailedObject.preview_url?l.detailedObject.preview_url:l.detailedObject.image,serviceId:t.options.serviceId,tenant:window.widget.getValue("x3dPlatformId")?window.widget.getValue("x3dPlatformId"):"OnPremise"});r.dataForRendering=function(){return this.toJSON()};var d=new e.Class.Collection(r);this.set(o,d),document.getElementsByClassName("actions")[0]&&document.getElementsByClassName("actions")[0].remove(),a&&t._onChangeContext(a)},t.backlogContext.remove=function(e,t,i){},t.backlogContext.dataForRendering=function(){let e=this.toJSON();return this.convertToJSON(e)},t.backlogContext.convertToJSON=function(t){let i=Object.keys(t),n=i.length;for(let o=0;o<n;o++){let n=i[o],a=t[n];if(a instanceof e.Class.Collection){let e=[],i=a.length;if(i)for(let t=0;t<i;t++)e.push(a.at(t).dataForRendering());t[n]=e}}return t.name=t.path||t.name||t.title,t.physicalId=t.id,t.canEdit=this.get("canEdit"),t},t.backlogContext.typeAheadCallback=function(e,i,n,o){t.fetchDataSet(i,t.options.type).then(function(e){let i=t.parseResponse(JSON.parse(e));n(i,o)})},t.backlogContext.getDropDownMenuItems=function(e,t){return[]};let s=this.options.serviceId;this.contextsetting=[{attributeToDisplay:"name",imageAttribute:"image",name:"context",placeHolder:V.SEARCH+" "+t.options.typeNLS,readWrite:"true",disableRemove:"true",singleObjectOnly:!0,type:"object",searchSource:[s],customView:a,minLengthBeforeAutocomplete:1,typeAheadCallback:t.backlogContext.typeAheadCallback,getDropDownMenuItems:t.backlogContext.getDropDownMenuItems,validateSameTenant:!0}],this.contextsetting[0].searchSourceTypes={};let l=[];this.supportedTypes.forEach(function(e){l.push(e)}),this.contextsetting[0].searchSourceTypes[s]=l,this.detailDisplay=new o({model:t.backlogContext,homeView:this,displayMessage:V.ERROR_IN_CONTEXT_SETTINGS}),this.detailDisplay.setConfig(this.contextsetting),void 0===document.getElementsByClassName("object-card-value")[0]&&t.updateContext({id:t.options.id,label:t.options.objectTitle,type:t.options.type,revision:t.options.objectRevision,image:t.options.objectTypeImage})},D.prototype.injectContextSelector=function(){if(!this.compactView){var e=document.querySelector(".rdmp_unit_context");e&&this.detailDisplay&&null!==this.detailDisplay.render()&&this.detailDisplay.render().inject(e)}},D.prototype.updateContext=function(e){this.withChangeContextSupport&&this.backlogContext&&this.backlogContext.add("context",void 0,{detailedObjects:[{"ds6w:label":e.label||e.displayName||"","ds6w:type":e.type||"","ds6wg:revision":e.revision||"",preview_url:e.image||"",objectId:e.id||""}]})},D.prototype.confirmationDialog=function(t,i){var n=new c;n.inject(document.getElementById("roadmap-settings-dialog"));var o=new e.Element("div",{html:"<p><b>"+t+"</b></p>"});this.dialog=new u({title:V.CONFIRMATION,content:o,immersiveFrame:n,closeButtonFlag:!1,touchMode:!0,buttons:{Cancel:new p({onClick:function(){n.destroy()}}),Ok:new p({onClick:function(){i(),n.destroy()}})}})},D.prototype.communititesToAdd=function(){var e=[];let t=this.getPreferedCommunitiesFromSettings(),i=C.getFilteredNotExcludedCommunityIds();for(let n=0;n<t.length;n++){let o=t[n].id;i.includes(o)||e.push(t[n])}return e},D.prototype.communititesToRemove=function(){var e=[];let t=C.getFilteredNotExcludedCommunities(),i=this.getPreferedCommunityIdsFromSettings();for(let n=0;n<t.length;n++){let o=t[n].id;i.includes(o)||e.push(o)}return e},D.prototype.getPreferedCommunitiesFromSettings=function(){var e=[];return A&&A._selectionChips._items&&A._selectionChips._items.forEach(function(t){let i=t.chipOptions.value._options?t.chipOptions.value._options:t.chipOptions;e.push({id:i.value,label:i.label,title:i.label,type:"community",service:"swym"})}),e},D.prototype.getPreferedCommunityIdsFromSettings=function(){var e=[];return A&&A._selectionChips._items&&A._selectionChips._items.forEach(function(t){let i=t.chipOptions.value._options?t.chipOptions.value._options:t.chipOptions;e.push(i.value)}),e},D.prototype.openRoadmapSettings=function(){var t=this,i=new y({renderTo:document.body}),n=e.createElement("div",{id:"roadmap-settings-dialog",styles:{width:"100%",height:"100%"}}),o=[{className:"primary",value:V.SAVE,action:function(i){if(t.withCommunityPreference){t.communititesToAdd().length>0&&e.is(t.handlers.addCommunities,"function")&&t.handlers.addCommunities(t.objectId,t.communititesToAdd(),function(){t.updateCommunityPreferenceListInfo()},function(e){t.showNotification(e)}),t.communititesToRemove().length>0&&e.is(t.handlers.removeCommunitiesFromPortfolio,"function")&&t.handlers.removeCommunitiesFromPortfolio(t.objectId,t.communititesToRemove(),function(){t.updateCommunityPreferenceListInfo()},function(e){t.showNotification(e)})}t.selectedScoringModelId&&t.selectedScoringModelId!==t.previousScoringModel?"None"===t.selectedScoringModelId?t.confirmationDialog(V.REMOVE_SCORING_MODEL_CONFIRMATION,function(){var e={id:t.objectId};T.mask(document.getElementById("roadmap-settings-dialog"),V.SETTING_SCORING_MODEL),t.handlers.removeScoringModel(e).then(e=>{t.previousScoringModel="None",t.isScoringModelSet=!1,T.unmask(document.getElementById("roadmap-settings-dialog")),i.hide(),t._initActionsToolbar(),t.updateScoringModelInfo(),t.showNotification(e)},e=>{T.unmask(document.getElementById("roadmap-settings-dialog")),i.hide(),t.showNotification(e)})}):t.confirmationDialog(V.CHANGE_SCORING_MODEL_CONFIRMATION,function(){var n={id:t.objectId,scoringModelId:t.selectedScoringModelId};T.mask(document.getElementById("roadmap-settings-dialog"),V.SETTING_SCORING_MODEL),t.handlers.setScoringModel(n).then(n=>{if(t.previousScoringModel=t.selectedScoringModelId,t.scoringModelComboBox.selectedIndex=t.getSelectedScoringModelIndex(n.scoringModelId),t.isScoringModelSet=!0,e.is(t.handlers.getDefaultScoringValuesForCurrentScoringModel,"function")){let e=t.handlers.getDefaultScoringValuesForCurrentScoringModel();t.scoringModelDefaultValuesMap[t.selectedScoringModelId]=e}T.unmask(document.getElementById("roadmap-settings-dialog")),i.hide(),t._initActionsToolbar(),t.updateScoringModelInfo(),t.showNotification(n)},e=>{T.unmask(document.getElementById("roadmap-settings-dialog")),i.hide(),t.showNotification(e)})}):i.hide()}},{className:"default",value:V.CANCEL,action:function(e){e.hide()}}];i.dialog({body:n,title:V.ROADMAP_SETTINGS,buttons:o}),this.roadmapSettings.withScoringModel&&this.prepareScoringModalSetting(n),this.withCommunityPreference&&!this.compactView&&this.prepareIdeationStreamSetting(n)},D.prototype.updateScoringModelInfo=function(){let e=this.getScoringModelMapping(this.selectedScoringModelId),t=[this._backlogEvents,this._contentItemsChannel,this._roadmapChannel];for(let i=0;i<t.length;i++)t[i].publish({event:this.EVENT_UPDATE_CURR_SCORING_MODEL_INFO,data:{isScoringModelSet:this.isScoringModelSet,selectedScoringModelId:this.selectedScoringModelId,scoringModelMapping:e||{}}})},D.prototype.updateCommunityPreferenceListInfo=function(){var t=this;let i=[];e.is(t.handlers.getCommunitiesFromPortfolio,"function")&&t.handlers.getCommunitiesFromPortfolio(t.objectId,function(n){if(n.length>0){if(e.is(t.handlers.getSwymCommunitiesFromService,"function")){var o=[];t.communityId_mature_map=[],n.forEach(function(e){o.push(e.proxy_id)}),t.handlers.getSwymCommunitiesFromService(o,function(e){e.length===o.length&&(e.forEach(function(e){t.communityId_mature_map.find(function(t){if(t.id===e.id)return!0})||t.communityId_mature_map.push(e)}),n.forEach(function(e){let n=e.proxy_id,o=i.find(function(e){if(e.id===n)return!0}),a=t.communityId_mature_map.find(function(e){if(e.id===n)return!0});!o&&a&&i.push({id:e.proxy_id,label:e["dskern:nlsLabel"]})}),t.selectedCommunities=i,C.createCommunityPreference(t.selectedCommunities),t._backlogEvents.publish({event:"update-community-list",data:{communityList:i}}),t._getAndLoadBacklogs({viewId:t.parentId}))})}}else t.selectedCommunities=[],t._backlogEvents.publish({event:"update-community-list",data:{communityList:i}})},function(e){t.showNotification(e)})},D.prototype.getSelectedCommunities=function(){var t=this;if(t.selectedCommunities&&0===t.selectedCommunities.length)return t.selectedCommunities;var i=[];return e.is(t.handlers.getCommunitiesFromPortfolio,"function")&&t.handlers.getCommunitiesFromPortfolio(t.objectId,function(e){return e.forEach(function(e){i.push({id:e.proxy_id,label:e["dskern:nlsLabel"]})}),i},function(e){t.showNotification(e)}),i},D.prototype.prepareScoringModalSetting=function(t){var i=this,n=e.createElement("div",{class:"scoring-model",styles:{display:"flex",margin:"5px"}}),o=e.createElement("div",{html:V.SCORING_MODELS,class:"field fieldLabel"}),a=e.createElement("div",{class:"field"});this.scoringModelComboBox=new S({elementsList:this.availableScoringModels,enableSearchFlag:!1,placeholder:V.SCORING_MODEL,touchMode:!0}),o.inject(n),this.scoringModelComboBox.inject(a),a.inject(n),n.inject(t),a.addEventListener("change",function(e){i.selectedScoringModelIndex=e.dsModel.selectedIndex,i.selectedScoringModelId=i.availableScoringModels[e.dsModel.selectedIndex].value}),i.scoringModelComboBox.selectedIndex=i.selectedScoringModelIndex},D.prototype.prepareIdeationStreamSetting=function(t){var i=this,n=e.createElement("div",{class:"ideationstreams",styles:{display:"flex"}}),o=e.createElement("div",{html:V.IDEATION_STREAMS,class:"field fieldLabel"}),a=e.createElement("div",{class:"field"});let s=!1;if(s=!!e.is(i.handlers.isReadOnly,"function")&&i.handlers.isReadOnly(),A=new h({elementsTree:function(t){return new Promise(function(n,o){setTimeout(function(){var a={query:"("+t+'*  AND (type:"Community"))',source:"swym",tenant:window.widget.getValue("x3dPlatformId")?window.widget.getValue("x3dPlatformId"):"OnPremise",with_synthesis:!0,onComplete:function(e){if(i.communityCache=[],e.results){e.results.forEach(function(e){if(!C.getFilteredNotExcludedCommunityIds().includes(e.attributes[0].value)){let t,n,o;e.attributes.forEach(function(e){"resourceid"===e.name&&(t=e.value),"ds6w:label"===e.name&&(o=e.value),"type_icon_url"===e.name&&(n=e.value)}),i.communityCache.push({label:o,value:t})}}),n(i.communityCache)}else n([])},onFailure:function(t){e.log("Error getting communities!"),o(t)}};i.searchIndexService.searchwithQuery(a)},2e3)})},multiSearchMode:!0,disabled:s,minLengthBeforeSearch:i.minLengthBeforeSearch,allowFreeInputFlag:!1,touchMode:!0,placeholder:V.TYPE_IN_SWYM_COMMUNITIES}),o.inject(n),A.inject(a),a.inject(n),n.inject(t),!s){var l=e.createElement("div",{class:"searchButton",styles:{display:"flex"}});e.createElement("span",{class:"fonticon fonticon-search wux-ui-3ds-2x",styles:{display:"flex"}}).inject(l),l.inject(n),l.addEventListener("click",function(e){i._searchCommunities()})}a.addEventListener("onPostRemove",function(e){C.getFilteredNotExcludedCommunityIds().length===e.dsModel._items.length&&A._selectionChips.removeAllChips()}),a.addEventListener("change",function(e){C.getFilteredNotExcludedCommunities().forEach(function(e,t){A._selectionChips.addChip({value:e.id,label:e.label,index:t})});A._selectionChips._items.length===i.maxCommunityAllowed+1&&(A._selectionChips.removeChip(i.maxCommunityAllowed),A.selectedItems.splice(i.maxCommunityAllowed,1),A.value.splice(i.maxCommunityAllowed,1),window.notifs.addNotif({level:"warning",title:V.WARNING,message:V.COMMUNITY_ADD_WARNING.replace("{COMMUNITY_NOS}",i.maxCommunityAllowed)}))}),i.addCommunitiesInIdeationStreamField(i.getAccessableCommunitites())},D.prototype.getAccessableCommunitites=function(){let e=[],t=[],i=C.getFilteredNotExcludedCommunities();return this.communityId_mature_map.forEach(function(t){e.push(t.id)}),i.forEach(function(i){e.includes(i.id)&&t.push(i)}),t},D.prototype.getSelectedScoringModelIndex=function(e){for(let t=0;t<this.availableScoringModels.length;t++)if(this.availableScoringModels[t].value===e)return t},D.prototype._initActionsToolbarForCompactView=function(){var t=this,i=[];if(e.is(t.handlers.updateToolbarOptions,"function")){var n={viewId:t.compactView?0:1},o=t.handlers.updateToolbarOptions(n);o.actions&&o.actions.length>0&&o.actions.forEach(function(e){i.push(e)})}if(i.push({id:"launch-full-mode",text:V.OPEN_AS_POPUP,fonticon:"open-in-a-new-window",disabled:!1,category:"destructive",handler:function(){if(t.launchFullViewAsWidget){let e=new P;t.launchParentAppWithRoadmapAsFullView(e)}else t.compactView=!1,t.inOutChannel.publish({event:"roadmap-switching-to-full-view"}),t.switchViewMode("FULL_VIEW"),t.inOutChannel.publish({event:"roadmap-requesting-to-load-revisions"})}}),!e.is(this._actionsToolbarCompact)){let e={modelEvents:this._roadmapChannel,showItemCount:!1,withClearSort:!0,withmultisel:!1,useGeneratedToolbar:!0,touchMode:!0,itemsName:"",itemName:"",filter:{width:350},actions:i};if(this.withSort&&(e.sort=this.handlers.getSortModelInfo(this.selectedScoringModelId),this.withCommunityPreference)){let t=[];t.push({id:"ds6w:what/ds6w:social/ds6w:endorsements",text:V.ENDORSEMENTS,type:"integer"}),t.push({id:"ds6w:what/ds6w:social/ds6w:comments",text:V.COMMENTS,type:"integer"}),t.push({id:"ds6w:dataSource.3DSwym",text:V.COMMUNITY,type:"string"}),e.sort.concat(t).concat()}this._actionsToolbarCompact=new g(e)}this._topActionsContainer.innerHTML="",this._actionsToolbarCompact.inject(this._topActionsContainer)},D.prototype.switchViewMode=function(e){let t=this;e&&"FULL_VIEW"===e?t._initializeCompleteView():e&&"COMPACT_VIEW"===e&&t._initializeCompactView()},D.prototype._initNavigationButtons=function(){var t=this,i=function(i){return e.createElement("div",{id:"navigate-"+i,title:"home"===i?V.HOME:"left"===i?V.BACK:"",html:"<span class='fonticon fonticon-"+i+"'>",class:"sidebar-icons sidebar-"+i+"-icon",events:{click:function(e){e&&e.currentTarget&&e.currentTarget.id&&t.inOutChannel.publish({event:"navigate-from-roadmap",data:e.currentTarget.id})}}})};e.is(this._roadmapSideBar)||(this._roadmapSideBar=e.createElement("div",{class:"sidebar-navigation"}),i("home").inject(this._roadmapSideBar),i("left").inject(this._roadmapSideBar),this._roadmapSideBar.inject(this._topActionsContainer))},D.prototype._prepareListViewForRevisionColumn=function(t){try{if(t&&t.item){let i=t.item;if(this._objectIdListContainerMap.has(i.id)){let e=this._objectIdListContainerMap.get(i.id);e&&t.container&&e.inject(t.container),this.listViewsMap[i.id].setHeaderTextVisibility({visible:!!t.showHeader&&t.showHeader})}else{let n=this._getContainerForListView({id:"slide_"+i.id,cssClass:"listViewSlideContainer"});if(this._initializeListView({viewId:i.id,modelEvent:this._contentItemsChannel,container:n,withHeader:!e.is(t.withHeader)||t.withHeader,withCreateAction:!e.is(t.withCreateAction)||t.withCreateAction,listHeader:i.displayName+" "+i.revision,listSubHeader:!e.is(this.handlers.getFullViewColumnSubHeader,"function")||this.handlers.getFullViewColumnSubHeader(i),withCommunityPreference:t.withCommunityPreference}),e.is(i.posToInsertRevision)){let e={id:i.id,displayName:i.displayName,revision:i.revision,contentContainer:n,withHeader:!1};this.columnList.splice(i.posToInsertRevision,0,e)}else this.columnList.push({id:i.id,displayName:i.displayName,revision:i.revision,contentContainer:n,withHeader:!1});this._objectIdListContainerMap.set(i.id,n),this._getAndLoadBacklogs({viewId:i.id}),e.is(t.container)&&n.inject(t.container),this.listViewsMap[i.id].setHeaderTextVisibility({visible:!!t.showHeader&&t.showHeader})}}}catch(t){e.log("_prepareListViewForRevisionColumn: Exception Occured!!!")}},D.prototype.getScoringModelMapping=function(e){if(this.availableScoringModelDetails&&this.availableScoringModelDetails.length>0)for(let t=0;t<this.availableScoringModelDetails.length;t++)if(-1!==Object.keys(this.availableScoringModelDetails[t]).indexOf(e))return Object.values(this.availableScoringModelDetails[t])[0]},D.prototype._setupDroppableRegions=function(){var t=this,i=0;this._onMainDivDragEnter=function(e){i++,e.preventDefault(),t.emptyContainer=t._topActionsContainer;t.emptyContainer.className.includes("displaynone");let n=V.DROP_TYPE+" "+t.options.typeNLS+" "+V.TO_OPEN;t.droppableArea=document.getElementsByClassName("top-container withoverflowhidden")[0],t.droppableArea.getElement("#dnd-drop-invite")?t.updateDropInviteMessage(n):o(n).inject(t.droppableArea,"top"),t.droppableArea.getElementsByClassName("enox-generated-toolbar-actions")[0].style.display="none"},this.updateDropInviteMessage=function(e){e!==t._topActionsContainer.getElement("#dnd-drop-invite").getElement("#childSection2").getText()&&(t._topActionsContainer.getElement("#dnd-drop-invite").getElement("#childSection2").innerHTML=e),t.droppableArea.getElement("#dnd-drop-invite").classList.remove("hidden"),t.emptyContainer.style.display="block"},this._onMainDivDragLeave=function(){0===--i&&(t.emptyContainer.style.display="",n([t.droppableArea]),i=0,t.droppableArea.getElementsByClassName("enox-generated-toolbar-actions")[0].style.display="flex")},this._onMainDivDrop=function(e){e.preventDefault(),(e.dataTransfer.files.length>0||!t.handlers.isLaneModifiable(t.viewId))&&(t.emptyContainer.style.display="block"),n([t.droppableArea]),i=0,t.droppableArea.getElementsByClassName("enox-generated-toolbar-actions")[0].style.display="flex"},t._topActionsContainer.addEventListener("dragenter",this._onMainDivDragEnter),t._topActionsContainer.addEventListener("dragleave",this._onMainDivDragLeave),t._topActionsContainer.addEventListener("drop",this._onMainDivDrop);var n=function(e){e.forEach(function(e){e.removeEventListener("dragover",t._onMainDivDragEnter),e.removeEventListener("ondragleave",t._onMainDivDragLeave),e.removeEventListener("ondrop",t._onMainDivDrop),e.getElement("#dnd-drop-invite")&&e.getElement("#dnd-drop-invite").classList.add("hidden"),e.classList.remove("enox-drag-over")})},o=function(t){var i=e.createElement("div",{id:"dnd-drop-invite",class:"dropinvite",html:""}),n=e.createElement("div",{id:"childSection1"}),o=e.createElement("div",{id:"childSection2"}),a=e.createElement("div",{id:"childSection3"}),s=e.createElement("div",{id:"childSection4"}),l=e.createElement("span",{html:t||V.DROP_CONTENT_HERE}),r=e.createElement("div",{class:"empty-view-icon empty-view-icon center-block fonticon fonticon-1x fonticon-drag-drop"}),d=e.createElement("p",{}),c=e.createElement("p",{}),u=e.createElement("p",{});return n.appendChild(r),n.appendChild(d),o.appendChild(l),o.appendChild(c),a.appendChild(u),i.appendChild(n),i.appendChild(o),i.appendChild(s),i}},D.prototype.subscribeDNDEvents=function(){var e=this,t=this._channelTokensMap.get(this._roadmapChannel);new f({droppableAreas:[e._topActionsContainer],modelEvents:this._roadmapChannel}),this._setupDroppableRegions(),t.push(this._roadmapChannel.subscribe({event:"onDrop"},t=>{let i=t.data.data.items?t.data.data.items:t.data.data.files?t.data.data.files:[],n=i.length;if(n<=0||n>1)e.showNotification({notifDetails:{level:"info",title:V.MULTI_DROP_NOT_ALLOWED,subtitle:""}});else{if(e.supportedTypes.indexOf(t.data.data.items[0].objectType)<0&&e.objectType.indexOf(t.data.data.items[0].objectType)<0)return void(t.data.data&&e.showNotification({notifDetails:{level:"info",title:V.TO_OPEN_TYPE.replace("{SUPPORTED_TYPE}",e.options.typeNLS),message:""}}));{let t=i[0];e._onChangeContext(t.objectId)}}}))},D.prototype._onChangeContext=function(t){var i=this;if(e.is(i.handlers.onChangeContext,"function")&&t){if(i.isColumnLoaded(t))return i.showNotification({notifDetails:{level:"info",title:V.INFORMATION,subtitle:V.SAME_BACKLOG_ITEM_LOADED}}),void i.toggleColumnSelection({id:t.replace("<","").replace(">",""),select:!0});T.mask(document.getElementsByClassName("xpfl-roadmap-container")[0],V.LOADING),i.handlers.onChangeContext({objectId:t}).then(n=>{let o={};o.id=-1!==t.indexOf("<")?t.replace("<","").replace(">",""):t,o.parentId=n.id;var a=[];a.push({objectId:"3dspace"===i.serviceId?o.id:"<"+o.id+">",searchQuery:'[ds6w:resourceUid]:"'+o.id+'"'});let s=function(t){var n=[];t.forEach(function(e){var t=e;t.name=e["ds6w:label"],t.revision=e["ds6wg:revision"]?e["ds6wg:revision"]:"",t.maturity=e.maturity?e.maturity:e["ds6w:what/ds6w:status"],n.push(t)}),n.length>0&&(o.objectTitle=n[0].name,o.parentTitle=n[0].name,o.title=n[0].name,o.objectRevision=n[0].revision,o.revision=n[0].revision,o.maturity=n[0].maturity,o.maturityState=n[0].maturity,o.objectTypeImage=e.is(n[0].preview_url)?n[0].preview_url:"",i.setFullViewWidgetTitle(o.objectTitle+" "+o.objectRevision),i.backlogContext.add("context",void 0,{detailedObjects:[{label:o.objectTitle+" "+o.objectRevision,objectType:o.type,objectId:o.id,preview_url:o.objectTypeImage}]}),e.is(i.handlers.loadRoadmapOnChangeContext,"function")&&i.handlers.loadRoadmapOnChangeContext(o))},l=function(){e.log("Unable to find the details of the item selected for roadmapping!")};a.length>0&&i.searchIndexService.searchFullCriterias(a,s,l,"","",i.predicates)})}},D.prototype.addCommunitiesInIdeationStreamField=function(e){let t=e.length,i=void 0;A&&A._selectionChips._items&&(i=t+A._selectionChips._items.length),e&&e&&(i===this.maxCommunityAllowed||i<this.maxCommunityAllowed)?e.forEach(function(e,t){A._selectionChips.addChip({value:e.id,label:e.label,index:t})}):window.notifs.addNotif({level:"warning",title:V.WARNING,message:V.COMMUNITY_ADD_WARNING.replace("{COMMUNITY_NOS}",this.maxCommunityAllowed)})},D.prototype._subscribeToEvents=function(){var t=this,i=this._channelTokensMap.get(this._backlogEvents),n=this._channelTokensMap.get(this._contentItemsChannel),o=this._channelTokensMap.get(this.inOutChannel),a=this._channelTokensMap.get(this._communityChannel),s=this._channelTokensMap.get(this._roadmapChannel);let l=t._roadmapChannel.subscribe({event:"enox-collection-toolbar-filter-search-value"},function(e){e&&e.searchValue&&(t._backlogEvents.publish({event:"roadmap-filter-list-on-search-value",data:e}),t._contentItemsChannel.publish({event:"roadmap-filter-list-on-search-value",data:e}))});s.push(l),!t.compactView&&t.withCommunityPreference&&(l=t._communityChannel.subscribe({event:"roadmap-add-communities-from-search"},function(e){t.addCommunitiesInIdeationStreamField(e)}),a.push(l)),l=t._roadmapChannel.subscribe({event:"roadmap-show-notification"},function(e){e&&e.notifDetails&&t.showNotification(e)}),s.push(l),l=t.inOutChannel.subscribe({event:"roadmap-show-notification"},function(e){e&&e.notifDetails&&t.showNotification(e)}),o.push(l),l=t._roadmapChannel.subscribe({event:"triptych-resized"},function(e){t.isBcklgPaneExpanded&&t.isBacklogPaneOpen&&"left"===e.side&&(t.roadmapInfoPanel.isInfoPanelOpen()?t._contentContainer.getElementsByClassName("triptych-left")[0].style.width="calc(100% - 360px)":t._contentContainer.getElementsByClassName("triptych-left")[0].style.width="100%")}),s.push(l),l=t._roadmapChannel.subscribe({event:t.EVENT_GET_LATEST_INFO_PANEL_STATUS},function(e){t._isInfoPanelOpen=e,t.isBcklgPaneExpanded&&t.isBacklogPaneOpen&&e?t._contentContainer.getElementsByClassName("triptych-left")[0].style.width="calc(100% - 360px)":!e&&t.isBacklogPaneOpen&&t.isBcklgPaneExpanded&&(t._contentContainer.getElementsByClassName("triptych-left")[0].style.width="100%"),e?t._topActionsContainer.getElementsByClassName("wux-ui-3ds-info")[0].setStyle("color","#368ec4"):t._topActionsContainer.getElementsByClassName("wux-ui-3ds-info")[0].setStyle("color","#b4b6ba")}),s.push(l),l=t._roadmapChannel.subscribe({event:"enox-collection-toolbar-sort-activated"},function(i){e.is(i)&&i.sortAttribute&&"clearSort"===i.sortAttribute||(T.mask(t._container,V.SORTING_WILL_DISABLE_REORDERING),setTimeout(function(){if(i&&i.sortOrder&&i.sortAttribute){t._backlogEvents.publish({event:"roadmap-sort-list",data:i}),t._contentItemsChannel.publish({event:"roadmap-sort-list",data:i});let e=!0===t.compactView?"compact":"full";C.updateRoadmapWidgetStorage(e,"sort",i)}T.isMasked(t._container)&&T.unmask(t._container)},1e3))}),s.push(l),l=t._roadmapChannel.subscribe({event:"enox-collection-toolbar-sort-reset"},function(){T.mask(t._container,V.ENABLING_REORDERING_ON_CLEAR_SORT),setTimeout(function(){t._backlogEvents.publish({event:"roadmap-clear-sort",data:{}}),t._contentItemsChannel.publish({event:"roadmap-clear-sort",data:{}});let e=!0===t.compactView?"compact":"full";C.updateRoadmapWidgetStorage(e,"sort",{sortAttribute:"",sortOrder:""}),T.unmask(t._container)},1e3)}),s.push(l),l=t._roadmapChannel.subscribe({event:"enox-collection-toolbar-node-updated"},function(i){if(!t.compactView&&t.withChangeContextSupport){t._checkContextFilterInjected()||t.injectContextSelector()}let n=e.is(document.getElementsByClassName("wux-ui-3ds-eye"))?document.getElementsByClassName("wux-ui-3ds-eye"):[];(n=n.length>0?n[0]:void 0)&&t.isBacklogPaneOpen?n.setStyle("color","#368ec4"):n&&!t.isBacklogPaneOpen&&n.setStyle("color","#77797c")}),s.push(l),l=t._roadmapChannel.subscribe({event:"enox-collection-toolbar-injected"},function(e){if(!t.compactView&&t.withChangeContextSupport){t._checkContextFilterInjected()||t.injectContextSelector()}document.getElementsByClassName("wux-ui-3ds-eye")[0]&&t.isBacklogPaneOpen?document.getElementsByClassName("wux-ui-3ds-eye")[0].setStyle("color","#368ec4"):document.getElementsByClassName("wux-ui-3ds-eye")[0]&&!t.isBacklogPaneOpen&&document.getElementsByClassName("wux-ui-3ds-eye")[0].setStyle("color","#77797c")}),s.push(l),l=t._roadmapChannel.subscribe({event:t.EVENT_UPDATE_MODEL_WITH_LATEST_SCORING_VALUES},function(e){e&&(t._backlogEvents.publish({event:t.EVENT_UPDATE_MODEL_WITH_LATEST_SCORING_VALUES,data:e}),t._contentItemsChannel.publish({event:t.EVENT_UPDATE_MODEL_WITH_LATEST_SCORING_VALUES,data:e}))}),s.push(l),l=t._backlogEvents.subscribe({event:t.EVENT_ADD_SELECTIONS_FROM_SEARCH},function(e){t.withReordering&&t._updateItemsForSequenceNo(e),0===t.backlogids.length?e.noFilterData=!1:e.noFilterData=!0,t._handleBacklogAddMoveOp(e)}),i.push(l),l=t._backlogEvents.subscribe({event:t.EVENT_UPDATE_SELECTED_NODES_AND_INFO_PANEL},function(e){let i=(t._nbBacklogItems>0||t._nbCommitedItems>0)&&e.selectedNodes.length>0?t.EVENT_ENABLE_TOOLBAR_ACTION:t.EVENT_DISABLE_TOOLBAR_ACTION;t.enableORDisableRemoveCommand(i,e.viewId),t._roadmapChannel.publish({event:t.EVENT_UPDATE_SELECTED_NODES_AND_INFO_PANEL,data:e})}),i.push(l),l=t._backlogEvents.subscribe({event:"roadmap-list-add-dropped-content"},function(e){e.noFilterData=!0,t._handleBacklogAddMoveOp(e)}),i.push(l),l=t._backlogEvents.subscribe({event:t.EVENT_REMOVE_BACKLOG},function(e){t._removeBacklogItems(e)}),i.push(l),l=t._contentItemsChannel.subscribe({event:"list-view-items-count-updated"},function(i){t.compactView&&i&&e.is(i.itemsCount)&&(t._expanderIssueDontProcessExpandEvent=!0,t.roadmapAccordeon.updateItem(1,{header:V.COMMITTED+" ("+i.itemsCount+")"}),t._expanderIssueDontProcessExpandEvent=!1),t._nbBacklogItems=i.itemsCount;let n=t._nbBacklogItems>0||t._nbCommitedItems>0?t.EVENT_ENABLE_TOOLBAR_ACTION:t.EVENT_DISABLE_TOOLBAR_ACTION;t.enableORDisableToolbarCommands(n)}),i.push(l),l=t._backlogEvents.subscribe({event:"load-backlog-data"},function(){t._getAndLoadBacklogs({viewId:t.parentId})}),i.push(l),l=t._backlogEvents.subscribe({event:t.EVENT_SELECTED_NODES_AND_TOGGLE_INFO_PANEL},function(e){t.roadmapInfoPanel.isInfoPanelOpen()||t._roadmapChannel.publish({event:"toggle-info-panel",data:{toggleSide:"right",selectedTab:"propertiesTab",isScoringModelSet:t.isScoringModelSet,selectedScoringModelId:t.selectedScoringModelId,scoringModelMapping:t.getScoringModelMapping(t.selectedScoringModelId)}}),t._roadmapChannel.publish({event:t.EVENT_UPDATE_SELECTED_NODES_AND_INFO_PANEL,data:{selectedNodes:e.selectedNodes,viewId:e.viewId}})}),i.push(l),l=t._backlogEvents.subscribe({event:t.EVENT_UPDATE_KANBAN_COLUMNS_VISIBILITY},function(e){let i=t._contentContainer.getElementsByClassName("triptych-left")[0],n=t._contentContainer.getElementsByClassName("triptych-right")[0];"maximize"===e.action?(t.isBcklgPaneExpanded=!0,t.backlogPaneWidth=i.style.width,t.infoPanelWidth=n.style.width,t.roadmapInfoPanel&&t.roadmapInfoPanel._isInfoPanelOpen?i.style.width="calc(100% - "+t.infoPanelWidth+")":i.style.width="100%",document.getElementsByClassName("wux-ui-3ds-eye")[0]&&document.getElementsByClassName("wux-ui-3ds-eye")[0].setStyle("color","#368ec4"),t._actionsToolbar._modelEvents.publish({event:"enox-collection-toolbar-change-text-tooltip-action",data:{id:"toggle-bcklg-item",text:V.SHOW_BACKLOG_PANE}})):(t.isBcklgPaneExpanded=!1,t.isBacklogPaneOpen&&(i.style.width=t.backlogPaneWidth),document.getElementsByClassName("wux-ui-3ds-eye")[0]&&document.getElementsByClassName("wux-ui-3ds-eye")[0].setStyle("color","#77797c"),t._actionsToolbar._modelEvents.publish({event:"enox-collection-toolbar-change-text-tooltip-action",data:{id:"toggle-bcklg-item",text:V.HIDE_BACKLOG_PANE}}))}),i.push(l),l=t._backlogEvents.subscribe({event:t.EVENT_CLOSE_BACKLOG_PANE},function(e){let i=e.viewId,n=[];t.columnList.forEach(e=>{i!==e.id&&n.push(e.id)}),t.kanbanView.showColumns(n),t.isSingleViewExpanded=!1,t.isBacklogPaneOpen=!1,t.isBcklgPaneExpanded=!1,C.updateRoadmapWidgetStorage("full","backlogPanelOpen",!1),t._roadmapChannel.publish({event:t.EVENT_TRIPTYCH_TOGGLE_PANEL,data:"left"}),t._backlogEvents.publish({event:"xmodel-list-view-switch-view",data:"LargeThumbnailView"}),t.listViewsMap[e.viewId].container.getElementsByClassName("listViewPlusAction")[0].style.display="inline-block",document.getElementsByClassName("wux-ui-3ds-eye")[0]&&document.getElementsByClassName("wux-ui-3ds-eye")[0].setStyle("color","#77797c"),t._actionsToolbar._modelEvents.publish({event:"enox-collection-toolbar-change-text-tooltip-action",data:{id:"toggle-bcklg-item",text:V.SHOW_BACKLOG_PANE}})}),i.push(l),l=t._backlogEvents.subscribe({event:t.EVENT_LIST_VIEW_LAUNCH_SEARCH},function(e){t._addBacklogItems(e)}),i.push(l),l=t._contentItemsChannel.subscribe({event:t.EVENT_UPDATE_SELECTED_NODES_AND_INFO_PANEL},function(e){let i=(t._nbBacklogItems>0||t._nbCommitedItems>0)&&e.selectedNodes.length>0?t.EVENT_ENABLE_TOOLBAR_ACTION:t.EVENT_DISABLE_TOOLBAR_ACTION;t.enableORDisableRemoveCommand(i,e.viewId),t._roadmapChannel.publish({event:t.EVENT_UPDATE_SELECTED_NODES_AND_INFO_PANEL,data:e})}),n.push(l),l=t._contentItemsChannel.subscribe({event:t.EVENT_UPDATE_KANBAN_COLUMNS_VISIBILITY},function(e){let i=e.viewId,n=e.action,o=[];t.columnList.forEach(e=>{i!==e.id&&o.push(e.id)}),"maximize"===n?(t.kanbanView.hideColumns(o),t.isSingleViewExpanded=!0,t.isBacklogPaneOpen&&(t._roadmapChannel.publish({event:t.EVENT_TRIPTYCH_TOGGLE_PANEL,data:"left"}),t.isBacklogPaneOpen=!1,document.getElementsByClassName("wux-ui-3ds-eye")[0].setStyle("color","#77797c"),t._actionsToolbar._modelEvents.publish({event:"enox-collection-toolbar-change-text-tooltip-action",data:{id:"toggle-bcklg-item",text:V.SHOW_BACKLOG_PANE}}))):(t.kanbanView.showColumns(o),t.isSingleViewExpanded=!1,t.isBacklogPaneOpen||(t._roadmapChannel.publish({event:t.EVENT_TRIPTYCH_TOGGLE_PANEL,data:"left"}),t.isBacklogPaneOpen=!0,document.getElementsByClassName("wux-ui-3ds-eye")[0].setStyle("color","#368ec4"),t._actionsToolbar._modelEvents.publish({event:"enox-collection-toolbar-change-text-tooltip-action",data:{id:"toggle-bcklg-item",text:V.HIDE_BACKLOG_PANE}})))}),n.push(l),l=t._backlogEvents.subscribe({event:"list-view-items-count-updated"},function(i){t.compactView&&i&&e.is(i.itemsCount)&&(t._expanderIssueDontProcessExpandEvent=!0,t.roadmapAccordeon.updateItem(0,{header:V.BACKLOG+" ("+i.itemsCount+")"}),t._expanderIssueDontProcessExpandEvent=!1),t._nbCommitedItems=i.itemsCount;let n=t._nbBacklogItems>0||t._nbCommitedItems>0?t.EVENT_ENABLE_TOOLBAR_ACTION:t.EVENT_DISABLE_TOOLBAR_ACTION;t.enableORDisableToolbarCommands(n)}),n.push(l),l=t._contentItemsChannel.subscribe({event:"roadmap-list-add-dropped-content"},function(e){t._handleBacklogAddMoveOp(e)}),n.push(l),l=t._contentItemsChannel.subscribe({event:t.EVENT_SELECTED_NODES_AND_TOGGLE_INFO_PANEL},function(e){if(!t.roadmapInfoPanel.isInfoPanelOpen()){let e={toggleSide:"right",selectedTab:"propertiesTab",isScoringModelSet:t.isScoringModelSet,selectedScoringModelId:t.selectedScoringModelId,scoringModelMapping:t.getScoringModelMapping(t.selectedScoringModelId)};t._roadmapChannel.publish({event:"toggle-info-panel",data:e})}t._roadmapChannel.publish({event:t.EVENT_UPDATE_SELECTED_NODES_AND_INFO_PANEL,data:{selectedNodes:e.selectedNodes,viewId:e.viewId}})}),n.push(l),l=t._contentItemsChannel.subscribe({event:t.EVENT_LIST_VIEW_LAUNCH_SEARCH},function(e){t._addBacklogItems(e)}),n.push(l),l=t.inOutChannel.subscribe({event:"roadmap-list-add-existing-item"},function(e){if(e&&e.viewId)t._addBacklogItems(e);else{var i=t._getActiveViewId(),n=i||t.parentId;t._addBacklogItems({viewId:n})}}),o.push(l),l=t.inOutChannel.subscribe({event:"roadmap-list-add-new-item"},function(e){var i=(e&&e.viewId?e.viewId:t._getActiveViewId())||t.parentId;e&&e.items?(e.items.forEach(function(e){e.customTooltip=V.TITLE+": "+e.name+"\n"+V.TYPE+": "+e.type+"\n"+V.MATURITY+": "+e.maturity+(e.revision?"\n"+V.REVISION+": "+e.revision:"")+"\n"+V.OWNER+": "+e.owner,e.subtitle=e.name,e.subLabel=e.type+" | "+e.owner+" | "+e.maturity}),t._handleAddBacklogsInview({viewId:i,items:e.items,shouldFetchScoringValues:!0}),t.showNotification(e),t.inOutChannel.publish({event:"enox-dialog-creation-done"})):e&&e.notifDetails&&t.showNotification(e)}),o.push(l),l=t.inOutChannel.subscribe({event:t.EVENT_REMOVE_BACKLOG},function(e){var i=t._getActiveViewId(),n=i||t.parentId;t._removeBacklogItems({fromId:n})}),o.push(l),l=t._contentItemsChannel.subscribe({event:t.EVENT_REMOVE_BACKLOG},function(e){t._removeBacklogItems(e)}),n.push(l),l=t.inOutChannel.subscribe({event:"roadmap-load-revisions"},function(i){let n=C.JSONRoadMapGlobalStorage.roadMapFullView.visibleColumns,o={},a=[],s=[],l=!1;for(var r in t.allRevisions)s.push(t.allRevisions[r]["@id"]);if(""!==n&&void 0!==n)for(var d in n)n.hasOwnProperty(d)&&-1!==s.indexOf(d)?(o[d]=n[d],a.push(d)):l=!0;l&&window.notifs.addNotif({level:"info",title:V.REVISIONS_NOT_EXISTS,message:""});let c=e.is(i,"array")?(i.length>t.maxColumnsCount?t.maxColumnsCount:i.length)+1:1;t._taggerMgr.updateCountOfViewsToManage(c),t._prepareContentSlidesV2(i),a.length>0?t.inOutChannel.publish({event:"roadmap-load-selected-revisions",data:{selectionsMap:o}}):i.length>t.maxColumnsCount&&window.notifs.addNotif({level:"info",title:V.replace(V.MSG_LOADING_MAX_NO_OF_REVISIONS,{MAX_COLUMNS:t.maxColumnsCount}),message:""}),C.JSONRoadMapGlobalStorage.roadMapFullView.expandedColumn&&t.listViewsMap[C.JSONRoadMapGlobalStorage.roadMapFullView.expandedColumn]&&t.listViewsMap[C.JSONRoadMapGlobalStorage.roadMapFullView.expandedColumn].expandBtn.click(),T.isMasked(document.getElementsByClassName("xpfl-roadmap-container")[0])&&T.unmask(document.getElementsByClassName("xpfl-roadmap-container")[0])}),o.push(l),l=t.inOutChannel.subscribe({event:"roadmap-reset-visiblecolumns-preference"},function(e){C.updateRoadmapWidgetStorage("full","visibleColumns",[])}),o.push(l),l=t.inOutChannel.subscribe({event:"roadmap-update-context-display"},function(e){e=e||{},t.updateContext({id:e.id?e.id:t.options.objectId?t.options.objectId:t.options.id,label:e.displayName?e.displayName:t.options.objectTitle,type:e.type?e.type:t.options.objectType?t.options.objectType:t.options.type?t.options.type:"",revision:e.revision?e.revision:t.options.objectRevision,image:e.image?e.image:t.options.objectTypeImage})}),o.push(l),l=t.inOutChannel.subscribe({event:t.EVENT_UPDATE_MODEL_WITH_LATEST_SCORING_VALUES},function(e){if(e){let i=[t._backlogEvents,t._contentItemsChannel];for(let n=0;n<i.length>0;n++)i[n].publish({event:t.EVENT_UPDATE_MODEL_WITH_LATEST_SCORING_VALUES,data:e})}}),o.push(l),l=t.inOutChannel.subscribe({event:"roadmap-load-selected-revisions"},function(i){if(i&&i.selectionsMap){C.updateRoadmapWidgetStorage("full","visibleColumns",i.selectionsMap);let n=Object.keys(i.selectionsMap);if(n&&n.length>t.maxColumnsCount)return void window.notifs.addNotif({level:"info",title:V.replace(V.MSG_LOADING_MAX_NO_OF_REVISIONS,{MAX_COLUMNS:t.maxColumnsCount}),message:""});let o=!1,a=t._objectIdListContainerMap.size-1;t._objectIdListContainerMap.forEach((e,i)=>{let o=n.indexOf(i);if(i&&-1===o){t._objectIdListContainerMap.delete(i);let e=t.listViewsMap[i];e&&i!==t.parentId&&(e.destroy(),delete t.listViewsMap[i]);let n=t.columnList.findIndex(e=>e.id===i);n>-1&&t.columnList.splice(n,1)}else n.splice(o,1)}),(a!==t._objectIdListContainerMap.size-1||n.length>0)&&(o=!0),n.length>0&&n.forEach(n=>{if(e.is(n)){var o=void 0!==i.selectionsMap[n]?i.selectionsMap[n]:void 0;o&&t._prepareListViewForRevisionColumn({item:o,withCreateAction:!0,withHeader:!0,showHeader:!0,posToInsertRevision:i.selectionsMap[n].posToInsertRevision})}}),o&&(e.log("Number of columns:"+t.columnList.length),t.kanbanView.refresh(t.columnList));let s=n?(n.length>t.maxColumnsCount?t.maxColumnsCount:n.length)+1:1;t._taggerMgr.updateCountOfViewsToManage(s)}}),o.push(l)},D.prototype._handleBacklogAddMoveOp=function(t){var i=this;if(t&&t.viewId&&t.items)if(void 0===t.fromId)this.startLoader({viewId:t.viewId,loadingMsg:V.PROCESSING}),t.viewId===this.parentId?this.handlers.addBacklogItems({id:i.objectId,items:t.items}).then(function(n){e.is(t.useSearchForData)&&!t.useSearchForData&&e.merge(n.bItems[0],t.items[0]),i._helperProcessAddItemResponse({items:n.bItems,viewId:t.viewId,useSearchForData:t.useSearchForData,noFilterData:t.noFilterData});let o=[];n.bItems.length>0&&(o=n.bItems.map(e=>e.id)),i._contentItemsChannel.publish({event:"update-tagger-list-on-items-addition",data:o}),i.showNotification(n)},function(e){i.stopLoader({viewId:t.viewId}),i.showNotification(e)}):this.handlers.addPlannedItems({id:t.viewId,items:t.items}).then(function(n){if(n.bItems.length>0){e.is(t.useSearchForData)&&!t.useSearchForData&&e.merge(n.bItems[0],t.items[0]),i._helperProcessAddItemResponse({items:n.bItems,viewId:t.viewId,useSearchForData:t.useSearchForData}),i.stopLoader({viewId:t.viewId});let o=[];n.bItems.length>0&&(o=n.bItems.map(e=>e.id)),i._contentItemsChannel.publish({event:"update-tagger-list-on-items-addition",data:o})}else i.stopLoader({viewId:t.viewId});i.showNotification(n)},function(e){i.stopLoader({viewId:t.viewId}),i.showNotification(e)});else if(t.fromId&&t.viewId&&t.fromId===t.viewId)this.startLoader({viewId:t.fromId,loadingMsg:V.REORDERING}),this.handlers.reorderRoadmapItems({id:t.fromId,items:t.items}).then(function(n){if(e.is(n.bItems)&&Object.keys(n.bItems).length>0){var o=t.viewId&&t.viewId===i.parentId?i._backlogEvents:i._contentItemsChannel;o.publish({event:"listview-update-item-order",data:{viewId:t.fromId,response:n.bItems,items:t.items}}),o.publish({event:"xmodel-list-data-sort-action",data:{viewId:t.fromId,sortModel:{dataIndex:i.orderAttribute,sort:"asc"}}})}i.stopLoader({viewId:t.fromId}),i.showNotification(n)},function(e){i.stopLoader({viewId:t.fromId}),i.showNotification(e)});else if(t.fromId===this.parentId&&t.viewId!==this.parentId)if(this.handlers.isLaneModifiable(t.viewId)){this.startLoader({viewId:t.fromId,loadingMsg:V.PROMOTING}),this.startLoader({viewId:t.viewId,loadingMsg:V.PROCESSING});let n=this._getIdListFromItems(t.items);this.handlers.moveToPlanned({id:t.viewId,items:t.items}).then(function(o){e.is(o.bItems)&&o.bItems.length>0&&(i._helperProcessAddItemResponse({items:o.bItems,viewId:t.viewId,itemIdGridMap:e.is(t.itemIdGridMap)?t.itemIdGridMap:void 0}),i._backlogEvents.publish({event:"xmodel-list-data-item-remove-action",data:{viewId:t.fromId,ids:n}}),i.withCommunityPreference&&i.updateCommunityPreferenceListInfo()),i.stopLoader({viewId:t.fromId}),i.stopLoader({viewId:t.viewId}),i.showNotification(o)},function(e){i.stopLoader({viewId:t.fromId}),i.stopLoader({viewId:t.viewId}),i.showNotification(e)})}else window.notifs.addNotif({level:"error",title:i.nlsKeyValueMap&&i.nlsKeyValueMap.TITLE_OPERATION_CANNOT_BE_PERFORMED?i.nlsKeyValueMap.TITLE_OPERATION_CANNOT_BE_PERFORMED:"",subtitle:i.nlsKeyValueMap&&i.nlsKeyValueMap.OPERATION_CANNOT_BE_PERFORMED?i.nlsKeyValueMap.OPERATION_CANNOT_BE_PERFORMED:V.OPERATION_CANNOT_BE_PERFORMED}),i.stopLoader({viewId:t.fromId}),i.stopLoader({viewId:t.viewId});else if(t.viewId===this.parentId&&t.fromId!==this.parentId)if(this.handlers.isLaneModifiable(t.fromId)){let n=this._getIdListFromItems(t.items);n.length>0&&(this.startLoader({viewId:t.fromId,loadingMsg:V.DEMOTING}),this.startLoader({viewId:t.viewId,loadingMsg:V.PROCESSING}),this.handlers.moveToBacklog({id:t.fromId,items:t.items}).then(function(o){i._helperProcessAddItemResponse({items:o.bItems,viewId:t.viewId,itemIdGridMap:e.is(t.itemIdGridMap)?t.itemIdGridMap:void 0}),i._contentItemsChannel.publish({event:"xmodel-list-data-item-remove-action",data:{viewId:t.fromId,ids:n}}),i.withCommunityPreference&&i.updateCommunityPreferenceListInfo(),i.stopLoader({viewId:t.fromId}),i.stopLoader({viewId:t.viewId}),i.showNotification(o)},function(e){i.stopLoader({viewId:t.fromId}),i.stopLoader({viewId:t.viewId}),i.showNotification(e)}))}else window.notifs.addNotif({level:"error",title:i.nlsKeyValueMap&&i.nlsKeyValueMap.TITLE_OPERATION_CANNOT_BE_PERFORMED?i.nlsKeyValueMap.TITLE_OPERATION_CANNOT_BE_PERFORMED:"",subtitle:i.nlsKeyValueMap&&i.nlsKeyValueMap.OPERATION_CANNOT_BE_PERFORMED?i.nlsKeyValueMap.OPERATION_CANNOT_BE_PERFORMED:V.OPERATION_CANNOT_BE_PERFORMED}),i.stopLoader({viewId:t.fromId});else if(t.fromId!==t.parentId&&t.parentId!==t.viewId){var n=this._getIdListFromItems(t.items);if(n.length>0)if(this.startLoader({viewId:t.fromId,loadingMsg:V.MOVING}),this.startLoader({viewId:t.viewId,loadingMsg:V.PROCESSING}),this.handlers.isLaneModifiable(t.fromId)&&this.handlers.isLaneModifiable(t.viewId))this.handlers.changePlannedFor({id:t.fromId,toId:t.viewId,items:t.items}).then(function(o){i._helperProcessAddItemResponse({items:o.bItems,viewId:t.viewId,itemIdGridMap:e.is(t.itemIdGridMap)?t.itemIdGridMap:void 0}),i._contentItemsChannel.publish({event:"xmodel-list-data-item-remove-action",data:{viewId:t.fromId,ids:n}});let a=n.length>0?i.EVENT_ENABLE_TOOLBAR_ACTION:i.EVENT_DISABLE_TOOLBAR_ACTION;i.enableORDisableToolbarCommands(a),i.stopLoader({viewId:t.fromId}),i.stopLoader({viewId:t.viewId}),i.showNotification(o)},function(e){i.stopLoader({viewId:t.fromId}),i.stopLoader({viewId:t.viewId}),i.showNotification(e)});else{let e=i.nlsKeyValueMap&&i.nlsKeyValueMap.OPERATION_CANNOT_BE_PERFORMED?i.nlsKeyValueMap.OPERATION_CANNOT_BE_PERFORMED:V.OPERATION_CANNOT_BE_PERFORMED;window.notifs.addNotif({level:"error",title:"",subtitle:e}),i.stopLoader({viewId:t.fromId}),i.stopLoader({viewId:t.viewId})}}},D.prototype._getIdListFromItems=function(e){var t=[];return e.forEach(e=>{e&&e.proxyId&&t.push(e.proxyId)}),t},D.prototype._helperProcessAddItemResponse=function(e){if(e.items)if(e.itemIdGridMap){if(e.items.length>0){let t=[];e.items.forEach(i=>{void 0!==e.itemIdGridMap[i.id]&&t.push(e.itemIdGridMap[i.id])}),this._handleAddBacklogsInview({items:t,viewId:e.viewId,shouldFetchScoringValues:e.shouldFetchScoringValues})}}else this._helperSearchAndLoadItems({items:e.items,append:!0,viewId:e.viewId,useSearchForData:e.useSearchForData,noFilterData:e.noFilterData})},D.prototype._helperSearchAndLoadItems=function(t){var i=this;if(t.items&&t.items.length>0||i.communityId_mature_map){var n=[],o=[],a={};let d=new Map;var s=new Map;if(t.items&&t.items.length>0&&(this.withProxyManagement?t.items.forEach(function(t){t.id&&(s.set(t.id,t["@id"]),d.set(t.id,t),n.push({objectId:t.id,searchQuery:'[ds6w:resourceUid]:"'+t.id+'"'}),a[[t["@id"]]]=e.is(t.scoringValues)?t.scoringValues:{})}):t.items.forEach(function(t){t.id&&(d.set(t.id,t),n.push({objectId:t.id,searchQuery:'[ds6w:resourceUid]:"'+t.id+'"'}),Object.keys(a).length>0?a[[t.id]]=e.is(t.scoringValues)?t.scoringValues:{}:a={[t.id]:e.is(t.scoringValues)?t.scoringValues:{}})})),i.withCommunityPreference&&t.viewId===i.parentId&&!t.noFilterData){let e=[],t=!1,o=function(n){n.forEach(function(t){if("swym:Idea"===t["ds6w:what/ds6w:typeValue"]){e.push(t["ds6w:containerUid"]),i.selectedCommunities.find(function(e){if(e.id===t["ds6w:containerUid"])return!0})||i.selectedCommunities.push({id:t["ds6w:containerUid"],label:t["ds6w:dataSource.3DSwym"],exclude:!0})}}),e.length>0&&(i.handlers.getSwymCommunitiesFromService(e,function(e){e.forEach(function(e){i.communityId_mature_map.includes(e)||i.communityId_mature_map.push(e),i.selectedCommunities.length===i.communityId_mature_map.length&&(t||(t=!0,i._getAndLoadBacklogs({viewId:i.parentId})))})}),C.createCommunityPreference(i.selectedCommunities),i._backlogEvents.publish({event:"update-community-list",data:{communityList:i.selectedCommunities}}))},a=function(){};n.length>0&&i.searchIndexService.searchFullCriterias(n,o,a,"","",i.predicates),i.selectedCommunities&&0===i.selectedCommunities.length&&(i.communityId_mature_map=[]);let s=C.getFilteredExcludedCommunityIds();i.communityId_mature_map.forEach(function(e){s.includes(e.id)||e.ideaList.forEach(function(e){n.push({objectId:e,searchQuery:'[ds6w:resourceUid]:"'+e+'"'})})});var l=!1;widget.getValue("communityPreference")&&"{}"!==widget.getValue("communityPreference")&&(l=C.isMaturedIdeaOnly())}let c=function(n){o=[],i.withCommunityPreference&&(n.length>0?i.listViewsMap[i.parentId]._listView._collectionToolBarContainer.classList.remove("hideIt"):i.listViewsMap[i.parentId]._listView._collectionToolBarContainer.classList.add("hideIt")),n.forEach(function(n){var r=n;let c=n["ds6w:when/ds6w:created"]?n["ds6w:when/ds6w:created"]:n["ds6w:created"],u=n["ds6w:when/ds6w:modified"]?n["ds6w:when/ds6w:modified"]:n["ds6w:modified"],p=(n["ds6w:what/ds6w:status"]?n["ds6w:what/ds6w:status"]:n["ds6w:status"],n["ds6w:what/ds6w:statusNLS"]);if(r.id=n["@id"],r.proxyId=i.withProxyManagement?s.get(n["@id"]):n["@id"],r.name=n["ds6w:label"],r.type=n["ds6w:what/ds6w:type"],r.typeValue=n["ds6w:what/ds6w:typeValue"],r.modified=u,r.created=c,r.owner=n["ds6w:who/ds6w:responsible"]?n["ds6w:who/ds6w:responsible"]:"",r.description="",r.classification=n["ds6w:how/ds6w:classification"]?n["ds6w:how/ds6w:classification"]:"",r.revision=n["ds6wg:revision"]?n["ds6wg:revision"]:"",r.Endorsements=n["ds6w:what/ds6w:social/ds6w:endorsements"]?n["ds6w:what/ds6w:social/ds6w:endorsements"]:"0",r.Comments=n["ds6w:what/ds6w:social/ds6w:comments"]?n["ds6w:what/ds6w:social/ds6w:comments"]:"0",r.Community=n["ds6w:dataSource.3DSwym"]?n["ds6w:dataSource.3DSwym"]:"",i.withCommunityPreference&&C.getFilteredCommunities().length>0&&t.viewId===i.parentId&&!t.noFilterData){if(l&&i.communityId_mature_map&&i.communityId_mature_map.length>0){let e=i.getCommunityId(r.Community),t=i.communityId_mature_map.find(function(t){if(t.id===e)return t.maturedState});if(t&&r["ds6w:what/ds6w:status"]!==t.maturedState)return}if("swym:Idea"===r.typeValue&&(!C.getFilteredCommunities().includes(r.Community)||"Inactive"===r["ds6w:what/ds6w:status"]||"ds6w:status.swym_inactive"===r["ds6w:what/ds6w:status"]))return}if(void 0!==n.preview_url&&(r.thumbnail=r.image=r.icon=n.preview_url),e.is(i.typeIconListCache[r.type])||(i.typeIconListCache[r.type]={thumbnail:r.thumbnail,type_icon_url:n.type_icon_url}),r.subtitle=n["ds6w:label"],r.title=n["ds6w:label"],r.label=n["ds6w:label"],r.thumbnail=n.preview_url,r.subLabel=n["ds6w:what/ds6w:type"]+" | "+n["ds6w:who/ds6w:responsible"]+" | "+p,"swym:Idea"===r.typeValue&&(r.subLabel=n["ds6w:what/ds6w:type"]+" | "+n["ds6w:who/ds6w:responsible"]+" | "+n["ds6w:dataSource.3DSwym"]+" | "+p),r.classification&&(r.subLabel=r.subLabel+" | "+r.classification),r.customTooltip=V.TITLE+": "+n["ds6w:label"]+"\n"+V.TYPE+": "+n["ds6w:what/ds6w:type"]+"\n"+V.MATURITY+": "+p+(r.revision?"\n"+V.REVISION+": "+r.revision:"")+"\n"+V.OWNER+": "+n["ds6w:who/ds6w:responsible"],"swym:Idea"===r.typeValue&&(r.customTooltip=V.TITLE+": "+n["ds6w:label"]+"\n"+V.TYPE+": "+n["ds6w:what/ds6w:type"]+"\nCommmunity: "+n["ds6w:dataSource.3DSwym"]+"\n"+V.MATURITY+": "+p+(r.revision?"\n"+V.REVISION+": "+r.revision:"")+"\n"+V.OWNER+": "+n["ds6w:who/ds6w:responsible"]),i.isScoringModelSet){let t=a[r.proxyId];!e.is(t)&&i.withCommunityPreference&&(t=i.scoringModelDefaultValuesMap[i.selectedScoringModelId]);for(const i in t)e.is(t[i])&&(r[i]=t[i])}i.withReordering&&d.get(n["@id"])&&(r[i.orderAttribute]=void 0!==d.get(n["@id"])[i.orderAttribute]?d.get(n["@id"])[i.orderAttribute]:NaN),-1===i.backlogids.indexOf(n["@id"])&&i.backlogids.push(n["@id"]),o.push(r)}),o.length>0?!0===t.append?i._handleAddBacklogsInview({items:o,viewId:t.viewId,shouldFetchScoringValues:!0}):i._loadBacklogs({items:o,viewId:t.viewId,shouldFetchScoringValues:!0}):(e.log("Error: Search is successful but there are no items!"),i.withCommunityPreference&&t.viewId===i.parentId&&!t.noFilterData&&i._backlogEvents.publish({event:"update-community-list",data:{communityList:i.selectedCommunities}}),i._loadBacklogs({items:o,viewId:t.viewId,shouldFetchScoringValues:!0}),i.stopLoader({viewId:t.viewId}))},u=function(){window.notifs.addNotif({level:"info",title:V.PARTIAL_DATA_ACCESS_DETAILS,message:""}),i.stopLoader({viewId:t.viewId})};if(n.length>0)if(e.is(t.useSearchForData)&&!t.useSearchForData){var r=[];t.items.forEach(t=>{var n={};let o=t,l=o.state;n.id=o.id,n.proxyId=i.withProxyManagement?s.get(n.id):o["@id"],n.sourceId="3dspace",n.name=o.name,n.type=o.type,n.typeValue=o.type,n.modified=o.modified,n.created=o.created,n.owner=o.owner,n.description="",n.revision=o.revision,void 0!==o.thumbnail&&(n.thumbnail=o.thumbnail),void 0!==o.type_icon_url&&(n.type_icon_url=o.type_icon_url),n.subtitle=o.name,n.title=o.name,n.label=o.name,n.thumbnail=o.thumbnail,n.subLabel=o.type+" | "+o.owner+" | "+l,n.customTooltip=V.TITLE+": "+o.name+"\n"+V.TYPE+": "+o.type+"\n"+V.MATURITY+": "+l+(o.revision?"\n"+V.REVISION+": "+o.revision:"")+"\n"+V.OWNER+": "+o.owner;let c=a[o["@id"]];for(const t in c)e.is(c[t])&&(n[t]=c[t]);i.withReordering&&d.get(o.id)&&(n[i.orderAttribute]=void 0!==d.get(o.id)[i.orderAttribute]?d.get(o.id)[i.orderAttribute]:NaN),-1===i.backlogids.indexOf(o.id)&&i.backlogids.push(o.id),r.push(n)}),i._handleAddBacklogsInview({items:r,viewId:t.viewId,shouldFetchScoringValues:!0})}else i.searchIndexService.searchFullCriterias(n,c,u,"","",i.predicates);else i._loadBacklogs({items:o,viewId:t.viewId,shouldFetchScoringValues:!0})}else i.stopLoader({viewId:t.viewId})},D.prototype._handleAddBacklogsInview=function(e){if(e&&e.items){var t=e.viewId&&e.viewId===this.parentId?this._backlogEvents:this._contentItemsChannel;t.publish({event:"xmodel-list-data-item-append-action",data:{member:e.items,viewId:e.viewId,shouldFetchScoringValues:!!e.shouldFetchScoringValues&&e.shouldFetchScoringValues}}),t.publish({event:"xmodel-list-data-sort-action",data:{viewId:e.viewId,sortModel:{dataIndex:this.orderAttribute,sort:"asc"}}});let i=this.compactView?"compact":"full";this.sortPreferences(i),this.stopLoader({viewId:e.viewId})}},D.prototype.destroy=function(){this._channelTokensMap&&this._channelTokensMap.forEach((e,t)=>{t&&e&&e.length>0&&e.forEach(e=>{t.unsubscribe(e)})}),this._container&&(this._container.empty(),this._container.remove(),this._container=void 0),this._taggerMgr&&(this._taggerMgr.destroy(),this._taggerMgr=void 0),this.roadmapInfoPanel&&(this.roadmapInfoPanel.destroy(),this.roadmapInfoPanel=void 0),this._container&&this._container.remove(),this.selectedCommunities&&(this.selectedCommunities=[],this.communityId_mature_map=[])},D.prototype._addBacklogItems=function(e){var t=this,i=function(){var i="",n={};n.allowedTypes=t.allowedTypes,t.backlogids.forEach(function(e){i=i+' NOT ([ds6w:resourceUid]:"'+e+'")'}),n.excludeList=i,n.multiSel=!0,t.roadmapSearchController=new _({modelEvents:t._backlogEvents,viewId:e.viewId}),t.roadmapSearchController._handleAddObjectSearch(n)};t.withUniqueBacklog?t.handlers.getBacklogIdsToExclude({id:t.objectId}).then(function(e){t.backlogids=t.backlogids.concat(e.filter(e=>t.backlogids.indexOf(e)<0)),i()},function(){i()}):i()},D.prototype._searchCommunities=function(){var e="",t={allowedTypes:["Community"]};let i=C.getFilteredNotExcludedCommunityIds();i&&i.length>0&&i.forEach(function(t){e=e+' NOT ([ds6w:resourceUid]:"'+t+'")'}),t.excludeList=e,t.multiSel=!0,this.roadmapSearchController=new _({modelEvents:this._communityChannel}),this.roadmapSearchController._handleSearchCommunities(t)},D.prototype._removeBacklogItems=function(t){var i=this;if(void 0!==t.fromId){var n=[],o=[],a={};let l={};if(t&&t.items&&t.items.length>0)n=t.items;else{var s=this.listViewsMap[t.fromId];s&&(n=s.getTreeModel().getSelectedNodes())}if(n.length>0&&this.startLoader({viewId:t.fromId,loadingMsg:V.REMOVING}),this.withProxyManagement?n.forEach(function(e){let t=e&&e.options&&e.options.grid.proxyId?e.options.grid.proxyId:void 0,i=e&&e.options&&e.options.grid.id?e.options.grid.id:void 0;t&&(a[t]=i,o.push(t),l[i]=e.options.grid)}):n.forEach(function(e){let t=e&&e.options&&e.options.grid.id?e.options.grid.id:void 0;t&&(o.push(t),l[t]=e.options.grid)}),i.withCommunityPreference&&t.fromId===i.parentId&&n.length!==o.length&&window.notifs.addNotif({level:"warning",title:V.NOT_REMOVED_ERROR}),o.length>0)if(t.fromId===i.parentId)this.handlers.removeBacklogItems({id:t.fromId,itemIds:o}).then(function(n){let o=n.bItems;if(o.length>0){i.withCommunityPreference&&i.updateCommunityPreferenceListInfo(),i._backlogEvents.publish({event:"xmodel-list-data-item-remove-action",data:{viewId:t.fromId,ids:o}});let s=[];o.forEach(t=>{let n=e.is(a[t])?a[t]:t;var o=i.backlogids.indexOf(n);-1!==o&&i.backlogids.splice(o,1),s.push(n)}),s.length>0&&i._contentItemsChannel.publish({event:"update-tagger-list-on-items-removal",data:s}),i.showNotification(n),i.stopLoader({viewId:t.fromId})}},function(n){e.log("Error: RemoveBacklog Items"),i.stopLoader({viewId:t.fromId}),i.showNotification(n)});else{let n=[];o.forEach(e=>{n.push({id:e})}),this.handlers.moveToBacklog({id:t.fromId,items:n}).then(function(e){i._helperProcessAddItemResponse({items:e.bItems,viewId:i.parentId,itemIdGridMap:l}),i._contentItemsChannel.publish({event:"xmodel-list-data-item-remove-action",data:{viewId:t.fromId,ids:o}}),i.stopLoader({viewId:t.fromId}),i.showNotification(e)},function(n){e.log("Error: RemoveBacklog Items"),i.stopLoader({viewId:t.fromId}),i.showNotification(n)})}else i.stopLoader({viewId:t.fromId})}},D.prototype._getAndLoadBacklogs=function(e){var t=this,i=e&&e.viewId===this.parentId?"loadBacklogItems":"loadPlannedItems",n=e&&e.viewId===this.parentId?this.objectId:e.viewId;return this.startLoader({viewId:e.viewId,loadingMsg:V.LOADING}),this.handlers[i]({id:n}).then(function(i){t._helperSearchAndLoadItems({items:i.bItems,append:!1,viewId:e.viewId}),t.showNotification(i)},function(i){let n=t.compactView?"compact":"full";t.sortPreferences(n),t.stopLoader({viewId:e.viewId}),t._contentItemsChannel.publish({event:"roadmap-fetch-items-call-is-done",data:{}}),t.showNotification(i)}).finally(()=>{})},D.prototype._loadBacklogs=function(e){if(e&&e.viewId){var t=e.viewId===this.parentId?this._backlogEvents:this._contentItemsChannel;t.publish({event:"xmodel-list-data-on-load-start",data:{viewId:e.viewId}}),t.publish({event:"xmodel-list-data-load-action",data:{member:e.items,viewId:e.viewId}}),t.publish({event:"xmodel-list-data-on-load-complete",data:{viewId:e.viewId}}),t.publish({event:"xmodel-list-data-sort-action",data:{viewId:e.viewId,sortModel:{dataIndex:this.orderAttribute,sort:"asc"}}});let i=this.compactView?"compact":"full";this.sortPreferences(i),this.stopLoader({viewId:e.viewId})}},D.prototype._getContainerForListView=function(t){var i=this;return e.createElement("div",{id:t.id,class:t.cssClass,events:{click:function(e){i._handleClickEventOnListView(e)},contextmenu:function(e){i._handleClickEventOnListView(e)}}})},D.prototype._handleClickEventOnListView=function(t){var i=this,n=t.currentTarget?t.currentTarget:void 0;let o=t.target?t.target:void 0;var a,s=[];i._objectIdListContainerMap.forEach(function(t,l){if(t.id&&n.id){var r=i.listViewsMap[l];let d,c=0;if(r&&(c=(d=r.getTreeModel().getSelectedNodes())?d.length:0),t.id===n.id){if(a=l,!i.compactView&&i.withFullViewWidgetTitle&&i.setFullViewWidgetTitle(i.listViewsMap[a]._headerTextPartial),i._roadmapChannel.publish({event:i.EVENT_UPDATE_SELECTED_NODES_AND_INFO_PANEL,data:{selectedNodes:d,viewId:a}}),c>0)n.classList.add("containerSelected");else if(!1===n.hasClassName("containerSelected"))n.classList.add("containerSelected");else if(n.hasClassName("containerSelected")){if(o&&e.is(o.id)&&"create-btn-primary"===o.id)return;n.classList.remove("containerSelected"),!i.compactView&&i.withFullViewWidgetTitle&&e.is(i.handlers.getFullViewWidgetTitle,"function")&&i.setFullViewWidgetTitle(r._headerTextPartial),a=""}s=d}else t.hasClassName("containerSelected")&&(t.classList.remove("containerSelected"),s=[])}});let l=e.is(a)?a:"",r=!e.is(i.handlers.isLaneModifiable,"function")||i.handlers.isLaneModifiable(l);if(e.is(i.handlers.commandsToRefreshInFullView,"function")){let e=r?i.EVENT_ENABLE_TOOLBAR_ACTION:i.EVENT_DISABLE_TOOLBAR_ACTION,t=i.handlers.commandsToRefreshInFullView();Array.isArray(t)&&t.length>0&&t.forEach(function(t){i._roadmapChannel.publish({event:e,data:t})})}let d=(i._nbBacklogItems>0||i._nbCommitedItems>0)&&s.length>0?i.EVENT_ENABLE_TOOLBAR_ACTION:i.EVENT_DISABLE_TOOLBAR_ACTION;i.enableORDisableRemoveCommand(d,a)},D.prototype._prepareContentSlidesV2=function(t){var i=this;try{if(t&&t.length>0){for(let e=0;e<t.length&&e<this.maxColumnsCount;e++){let n=t[e];i._prepareListViewForRevisionColumn({item:n,withCreateAction:!0,withHeader:!0,showHeader:!0,withCommunityPreference:i.withCommunityPreference})}this._containerForKanban=e.createElement("div",{id:"xpflRoadmapKanbanContainer",class:"xpfl-roadmap-backlog-container"}),this._containerForKanban.inject(this._roadmapTriptych.getMainPanelContainer()),this.kanbanView=new N({settings:{},columnMinWidth:300,columnList:this.columnList}),this.kanbanView.prepareColumns(i.columnList),this.kanbanView.render().inject(this._containerForKanban),this.kanbanView.switchView(),this._containerForKanban.addEvent("resize",function(t){e.log("kanban container resize listener"),e.Event.stop(t),i._kanbanResizeCaller()})}}catch(t){e.log((t.message,t.message))}finally{i.inOutChannel.publish({event:"roadmap-container-rendered",data:{isCompactView:i.compactView}})}},D.prototype._updateItemsForSequenceNo=function(e){var t=this;if(e&&e.viewId&&this.listViewsMap[e.viewId]&&e.items&&e.items.length>0){let i=this.listViewsMap[e.viewId].getOrderAttributeOfLastNode(),n=1;e.items.forEach((e,o)=>{e&&(e[t.orderAttribute]=i+o+n)})}},D.prototype.startLoader=function(e){e&&e.viewId&&this.listViewsMap[e.viewId]&&this.listViewsMap[e.viewId].startLoader({loadingMsg:e.loadingMsg?e.loadingMsg:V.LOADING})},D.prototype.stopLoader=function(e){e&&e.viewId&&this.listViewsMap[e.viewId]&&this.listViewsMap[e.viewId].stopLoader()},D.prototype.showNotification=function(t){if(e.is(t)&&e.is(t.notifDetails)){let e=t.notifDetails;window.notifs.addNotif({level:e.level?e.level:"info",title:e.title?e.title:"",subtitle:e.subtitle?e.subtitle:""})}},D.prototype.launchParentAppWithRoadmapAsFullView=function(e){if(e){let t=e.getSocketInstance(),i={protocol:"3DXContent",version:"1.0",source:this.options.parentAppId,data:{envId:window.widget&&void 0!==window.widget.getValue("x3dPlatformId")?window.widget.getValue("x3dPlatformId"):"OnPremise",serviceId:this.options.serviceId?this.options.serviceId:"",contextId:"",launchRoadmapAsWidget:!0,controllerOptions:{parentId:this.parentId,parentTitle:this.parentTitle?this.parentTitle:"",parentRevision:this.parentRevision?this.parentRevision:"",id:this.objectId?this.objectId:"",objectTitle:this.objectTitle?this.objectTitle:"",revision:this.objectRevision?this.objectRevision:"",objectRevision:this.objectRevision?this.objectRevision:"",objectMaturityState:this.objectMaturityState?this.objectMaturityState:"",objectMaturityStateNLS:this.objectMaturityStateNLS?this.objectMaturityStateNLS:"",objectResponsibilities:this.objectResponsibilities?this.objectResponsibilities:"",objectTypeImage:this.objectTypeImage?this.objectTypeImage:"",type:this.objectType?this.objectType:"",typeNLS:this.objectTypeNLS?this.objectTypeNLS:"",allowedTypes:this.allowedTypes,modelEvents:new r,compactView:!1,withNavigatioButtons:!1,withInformationPanel:this.withInformationPanel,roadmapSettings:this.roadmapSettings,withLaneExpander:this.withLaneExpander,withSingleTaggerManagement:this.withSingleTaggerManagement,withFullViewWidgetTitle:this.withFullViewWidgetTitle,withFullViewColumnSubHeader:this.withFullViewColumnSubHeader,predicates:this.predicates,customAttrbColumns:this.customAttrbColumns,reqSubTypesOptions:this.reqSubTypesOptions},controllerModule:this.options.controllerModule}},n={protocol:"3DXContent",version:"1.0",source:this.options.parentAppId,appId:this.options.parentAppId};localStorage.setItem("launchRoadmapAsWidget","true"),t.dispatchEvent("onSetX3DContent",i,e.getSocketId()),t.dispatchEvent("onLaunchApp",n,e.getSocketId())}},D.prototype.setFullViewWidgetTitle=function(t){if(!this.compactView){let i=this.options.defaultFullViewTitle?this.options.defaultFullViewTitle:"";e.is(t)&&""!=t&&""!=i&&(i=i+" - "+t),widget.setTitle(i)}},D.prototype.enableORDisableToolbarCommands=function(e){this._roadmapChannel.publish({event:e,data:"enox-search"}),this._roadmapChannel.publish({event:e,data:"iconSortActionBar"})},D.prototype.enableORDisableRemoveCommand=function(t,i){var n=this;let o=!e.is(this.handlers.isLaneModifiable,"function")||this.handlers.isLaneModifiable(i);if(e.is(n.handlers.commandsToRefreshWithNoData,"function")&&o){n.handlers.commandsToRefreshWithNoData().forEach(function(e){n._roadmapChannel.publish({event:t,data:e})})}},D.prototype.fetchDataSet=function(t,i){var n={label:"xpfl_app_"+O.getUser().login+"autocomplete"+Date.now(),with_indexing_date:!0,with_synthesis:!1,with_nls:!1,locale:window.widget&&window.widget.lang?window.widget.lang:"en",select_predicate:["physicalid","owner","ds6w:label","ds6w:type","ds6w:responsible","ds6w:state","ds6wg:revision"],refine:{},order_by:"desc",order_field:"relevance",source:[this.options.serviceId],tenant:window.widget.getValue("x3dPlatformId")?window.widget.getValue("x3dPlatformId"):"OnPremise",query:t};return new e.Promise(function(t,i){try{var o={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"}};o.data=JSON.stringify(n),o.onComplete=function(e){t(e)},o.onFailure=function(e){i(e)},o.onTimeout=function(e){i(e)},M.federatedSearchRequest(o)}catch(t){e.log("Exception occured while fetching data"+t.message),i(t.message?t.message:"Exception Occured during fetch!!")}})},D.prototype.parseResponse=function(e){var t=[],i={},n=[];if(e){var o=e.results;if(o&&o.length>0)for(var a=0,s=o.length;a<s;a++)if(o[a]&&o[a].attributes){for(var l=o[a].attributes,r={nlsValues:{}},d=0,c=l.length;d<c;d++)switch(l[d].name){case"resourceid":r.id=l[d].value;break;case"ds6w:label":r.title=l[d].dispValue?l[d].dispValue:l[d].value;break;case"ds6wg:revision":r.revision=l[d].value;break;case"ds6w:type":case"ds6w:what/ds6w:type":r.type=l[d].value;break;case"ds6w:status":case"ds6w:what/ds6w:status":l[d].value.replace(/ /g,"_");l[d].value&&l[d].value.indexOf("Build.")>-1&&(l[d].value=l[d].value.slice(l[d].value.indexOf(".")+1)),r.state=l[d].value;break;case"ds6w:responsible":case"ds6w:who/ds6w:responsible":r.owner=l[d].value;break;case"preview_url":r.image=l[d].value}n.push(r),i={};let e=r.revision?r.title+" "+r.revision:r.title;(this.supportedTypes.indexOf(r.type)>0||this.objectType===r.type)&&(i={"ds6w:type":r.type,value:r.id,label:e,image:r.image,sourceId:this.options.sourceId},t.push(i))}}return t},D.prototype.getItemIdsOfLoadedColumns=function(e){return this.columnList&&this.columnList.length>0?this.columnList.map(e=>e.id):[]},D.prototype.toggleColumnSelection=function(t){if(e.is(t)&&t.id){let e=this.listViewsMap[t.id];e&&e.container&&(t.select&&!e.container.hasClassName("containerSelected")?e.container.click():!t.select&&e.container.hasClassName("containerSelected")&&e.container.click())}},D.prototype.isColumnLoaded=function(e){let t=this,i=!1;if(this.columnList&&this.columnList.length>0){e=e.replace("<","").replace(">","");for(let n=0;n<this.columnList.length;n++){let o=t.columnList[n];if(o&&o.id&&o.id===e){i=!0;break}}}return i},D.prototype.getNLSKeyValueMap=function(t){e.is(this.handlers.getNLSValueForKeys,"function")&&t.length>0&&(this.nlsKeyValueMap=this.handlers.getNLSValueForKeys(t))},D.prototype.getCommunityId=function(e){let t;if(JSON.parse(widget.getValue("communityPreference"))){let i=JSON.parse(widget.getValue("communityPreference"));Object.entries(i).map(n=>{let o=n[0];e===i[o].label&&(t=i[o].id)})}return t},D});